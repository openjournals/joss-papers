<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6441</article-id>
<article-id pub-id-type="doi">10.21105/joss.06441</article-id>
<title-group>
<article-title>MarSwitching.jl: A Julia package for Markov switching
dynamic models</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1791-7611</contrib-id>
<name>
<surname>Dadej</surname>
<given-names>Mateusz</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Phd. student, University of Brescia, Italy</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<volume>9</volume>
<issue>98</issue>
<fpage>6441</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Julia</kwd>
<kwd>Time series</kwd>
<kwd>Econometrics</kwd>
<kwd>Markov processes</kwd>
<kwd>Nonlinear models</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>MarSwitching.jl</monospace> package allows users of the
  Julia programming language
  (<xref alt="Bezanson et al., 2017" rid="ref-bezanson2017julia" ref-type="bibr">Bezanson
  et al., 2017</xref>) to efficiently use Markov switching dynamic
  models. It provides a set of tools for estimation, simulation, and
  forecasting of Markov switching models. This class of models is the
  principal tool for modelling time series with regime changes. The
  time-variation of model parameters is governed by the limited memory
  Markov process. Given the non-trivial nature of the likelihood
  function and the amount of model parameters, Julia is an ideal
  language for implementing this class of models due to its
  computational performance.</p>
  <p>Currently, the package provides model estimation with a combination
  of switching or non-switching intercept, error variance and exogenous
  variables. The transition matrix can be either constant or
  time-varying. The package also provides a set of functions for model
  diagnostics and forecasting. Further development of the package is
  considered, conditional on the interest in thereof.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>The Markov switching regression (also referred to as regime
  switching) was first introduced in the seminal work of Hamilton
  (<xref alt="1989" rid="ref-hamilton89" ref-type="bibr">1989</xref>).
  Since then, it has been extensively used in empirical research.
  Although the model was introduced as an application to economic data,
  the range of applications has expanded significantly since the first
  publication. These fields include finance
  (<xref alt="Buffington &amp; Elliott, 2002" rid="ref-buffington02" ref-type="bibr">Buffington
  &amp; Elliott, 2002</xref>), political science
  (<xref alt="Brandt et al., 2014" rid="ref-Brandt2014" ref-type="bibr">Brandt
  et al., 2014</xref>), hydrology
  (<xref alt="Wang et al., 2023" rid="ref-wang23" ref-type="bibr">Wang
  et al., 2023</xref>), epidemiology
  (<xref alt="Shiferaw, 2021" rid="ref-shiferaw21" ref-type="bibr">Shiferaw,
  2021</xref>) and even bibliometrics
  (<xref alt="Delbianco et al., 2020" rid="ref-delbianco20" ref-type="bibr">Delbianco
  et al., 2020</xref>).</p>
  <p>The popularity of these models among applied scientists and
  industry professionals is reflected in the availability of
  implementations. There are several packages in R
  (<xref alt="R Core Team, 2017" rid="ref-Rlang" ref-type="bibr">R Core
  Team, 2017</xref>) such as <monospace>MSwM</monospace>
  (<xref alt="Josep A. Sanchez-Espigares, 2021" rid="ref-MSwM" ref-type="bibr">Josep
  A. Sanchez-Espigares, 2021</xref>) or <monospace>dynr</monospace>
  (<xref alt="Ou et al., 2019" rid="ref-dynr" ref-type="bibr">Ou et al.,
  2019</xref>). For the Python language, the Markov switching model is
  implemented as part of the <monospace>statsmodels</monospace> package
  (<xref alt="Seabold &amp; Perktold, 2010" rid="ref-statsmodels" ref-type="bibr">Seabold
  &amp; Perktold, 2010</xref>). MATLAB users may also estimate these
  models with the <monospace>MS_Regress</monospace>
  (<xref alt="Perlin, 2012" rid="ref-msregress" ref-type="bibr">Perlin,
  2012</xref>) package. Most of the well-established closed-source
  statistical applications also have their own implementations of Markov
  switching models. These include EViews, Stata, and SAS.</p>
  <p>Despite the popularity of the method,
  <monospace>MarSwitching.jl</monospace> is, at the moment, the only
  package that allows for estimation of Markov switching models with the
  Julia programming language by specifying a minimal set of regime
  switching parameters. At the same time, it is implemented purely in
  this language. For more general modeling with hidden Markov models,
  Julia users may find the <monospace>HiddenMarkovModels.jl</monospace>
  (<xref alt="Dalle, 2024" rid="ref-Dalle2024" ref-type="bibr">Dalle,
  2024</xref>) package useful as well.
  <monospace>HiddenMarkovModels.jl</monospace> offers a more generic
  approach to programming hidden Markov models, albeit requiring
  user-side development of certain estimation algorithms for Markov
  switching models, as well as model inference functions.</p>
</sec>
<sec id="background">
  <title>Background</title>
  <p>Markov switching models are a class of regression models that allow
  for time variation of parameters in an otherwise linear model. More
  specifically, the current state is determined only by the state from
  the previous period, which is described in the transition matrix.</p>
  <p>Consider a general model:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[\mathbf{y}_t = \mathbf{X}_{t,i} \beta_{S, i} + \epsilon_t]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ùê≤</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ùêó</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>Œ≤</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>œµ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></disp-formula>
  <disp-formula><alternatives>
  <tex-math><![CDATA[\epsilon \sim f(0,\Sigma_s)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œµ</mml:mi><mml:mo>‚àº</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>Œ£</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{y}_t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>ùê≤</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is <inline-formula><alternatives>
  <tex-math><![CDATA[N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>-vector
  of the dependent variable indexed by time
  <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{X}_{t,i}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>ùêó</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  is <inline-formula><alternatives>
  <tex-math><![CDATA[N \times M]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>√ó</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  matrix of exogenous regressors, <inline-formula><alternatives>
  <tex-math><![CDATA[\beta_{S, i}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Œ≤</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  is <inline-formula><alternatives>
  <tex-math><![CDATA[K]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>K</mml:mi></mml:math></alternatives></inline-formula>-vector
  of parameters, and <inline-formula><alternatives>
  <tex-math><![CDATA[\epsilon_t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œµ</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is <inline-formula><alternatives>
  <tex-math><![CDATA[N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>-vector
  of errors. The errors are distributed according to some distribution
  <inline-formula><alternatives>
  <tex-math><![CDATA[f(0,\Sigma_s)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>Œ£</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  with zero mean and covariance matrix <inline-formula><alternatives>
  <tex-math><![CDATA[\Sigma_s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Œ£</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  The state <inline-formula><alternatives>
  <tex-math><![CDATA[S]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>S</mml:mi></mml:math></alternatives></inline-formula>
  is a latent (unobservable) variable that can take values from
  <inline-formula><alternatives>
  <tex-math><![CDATA[1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula>
  to <inline-formula><alternatives>
  <tex-math><![CDATA[K]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>K</mml:mi></mml:math></alternatives></inline-formula>.
  Parameters indexed by <inline-formula><alternatives>
  <tex-math><![CDATA[S]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>S</mml:mi></mml:math></alternatives></inline-formula>
  are different for each state.</p>
  <p>The state <inline-formula><alternatives>
  <tex-math><![CDATA[S_t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is governed by the Markov process. The probability of transition from
  state <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  to state <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
  is given by the <inline-formula><alternatives>
  <tex-math><![CDATA[K \times K]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>K</mml:mi><mml:mo>√ó</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  left-stochastic transition matrix <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{P}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ùêè</mml:mi></mml:math></alternatives></inline-formula>:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[\mathbf{P} = P(S_t = i | S_{t-1} = j) = 
      \begin{pmatrix}
      p_{1,1} & p_{1,2} & \cdots & p_{1,k} \\
      p_{2,1} & p_{2,2} & \cdots & p_{2,k} \\
      \vdots  & \vdots  & \ddots & \vdots  \\
      p_{k,1} & p_{k,2} & \cdots & p_{k,k} 
      \end{pmatrix}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ùêè</mml:mi><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mi>‚ãØ</mml:mi></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mi>‚ãØ</mml:mi></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mi>‚ãÆ</mml:mi></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mi>‚ãÆ</mml:mi></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mo>‚ã±</mml:mo></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mi>‚ãÆ</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mi>‚ãØ</mml:mi></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>with standard constraints: <inline-formula><alternatives>
  <tex-math><![CDATA[0 < p_{i,j} < 1, \forall j,i \in \{1,\dots, K\}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>‚àÄ</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>‚àà</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>‚Ä¶</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\sum_{i}^{K} p_{i,j} \forall j \in \{1, \dots, K\}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mo>‚àë</mml:mo><mml:mi>i</mml:mi><mml:mi>K</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>‚àÄ</mml:mo><mml:mi>j</mml:mi><mml:mo>‚àà</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>‚Ä¶</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p>In a standard model, the transition matrix is assumed to be
  constant over time. However, it is possible to allow for time
  variation of the transition matrix itself, as described in
  (<xref alt="Filardo, 1994" rid="ref-filardo94" ref-type="bibr">Filardo,
  1994</xref>) (and as implemented in the package). In this case, each
  of the transition probabilities is modeled as a function of the
  exogenous variables <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{Z}_{t}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>ùêô</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[p_{i,j,t} = \frac{\exp(\mathbf{Z}_t \delta_{i,j})}{\textstyle \sum_{j=1} \exp(\mathbf{Z}_t \delta_{i,j})}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>ùêô</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>Œ¥</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:munder><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>ùêô</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mi>Œ¥</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\delta_{i,j}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Œ¥</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  is a vector of coefficients. The exponentiation and sum division of
  the coefficients ensure that the probabilities are non-negative and
  sum up to one. For this model, the expected duration of the state is
  time-varying as well.</p>
</sec>
<sec id="quick-start">
  <title>Quick start</title>
  <p>The package allows for simulation of data from the Markov switching
  model. The user can specify the number of states, observations, and
  model parameters (both transition and regression parameters). The
  package will return a simulated dataset and the standardized exogenous
  variables.</p>
  <code language="julia">using MarSwitching
using Random
import Statistics: quantile

k = 2            # number of regimes
T = 400          # number of generated observations
Œº = [1.0, -0.5]  # regime-switching intercepts
Œ≤ = [-1.5, 0.0]  # regime-switching coefficient for Œ≤
œÉ = [1.1,  0.8]  # regime-switching standard deviation
P = [0.9 0.05    # transition matrix (left-stochastic)
     0.1 0.95]

Random.seed!(123)

# generate artificial data with given parameters
y, s_t, X = generate_msm(Œº, œÉ, P, T, Œ≤ = Œ≤)</code>
  <p>The model is estimated using <monospace>MSModel()</monospace>
  function. The user needs to specify the dependent variable
  <monospace>y</monospace>, the number of states
  <monospace>k</monospace>. The exogenous variables are passed to either
  the <monospace>exog_vars</monospace> or the
  <monospace>exog_switching_vars</monospace> argument, depending wether
  the variable is expected to have a switching parameter. In a similar
  vein the user may pass an exogenous variable for the time-varying
  transition matrix into <monospace>exog_tvtp</monospace>. However, in
  order to have an intercept the column of ones needs to be added
  explicitly.</p>
  <code language="julia"># estimate the model
model = MSModel(y, k, intercept = &quot;switching&quot;, exog_switching_vars = X[:,2])</code>
  <p>Thanks to Julia‚Äôs multiple dispatch, the
  <monospace>generate_msm()</monospace> function works by either
  providing the parameters as in the first code chunk or using the
  previously estimated model. This is useful, e.g., for assessing the
  statistical properties of the model by Monte Carlo simulation.</p>
  <code language="julia">quantile(generate_msm(model, 1000)[1], 0.05)</code>
  <p>There are several functions for printing statistics of the
  estimated model. Each of the functions has a
  <monospace>digits</monospace> argument specifying a rounding number.
  <monospace>state_coeftable()</monospace> shows model coefficients‚Äô
  statistics for a given state and the expected duration of the state.
  For a standard model with constant transition matrix, the function
  <monospace>transition_mat()</monospace> prints a formatted matrix of
  estimated transition probabilities. For models with time-varying
  transition probabilities, the coefficients can be inspected with
  <monospace>coeftable_tvtp()</monospace>. The function
  <monospace>summary_mars()</monospace> prints all the relevant
  information about the model for each of the states. Additionally, it
  shows basic information about the model and fitness statistics.</p>
  <p>The package also provides functions for filtered transition
  probabilities <inline-formula><alternatives>
  <tex-math><![CDATA[P(S_t = i | \Psi_t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msub><mml:mi>Œ®</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  and smoothed ones <inline-formula><alternatives>
  <tex-math><![CDATA[P(S_t = i | \Psi_T)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msub><mml:mi>Œ®</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  (<xref alt="Kim, 1994" rid="ref-kim94" ref-type="bibr">Kim,
  1994</xref>). The former is estimated using the data available up to
  time <inline-formula><alternatives>
  <tex-math><![CDATA[t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>,
  while the latter is estimated using the full sample information in a
  backward fashion, starting from <inline-formula><alternatives>
  <tex-math><![CDATA[T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[T-1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>T</mml:mi><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[...]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  and so on. The functions to obtain these probability vectors are
  <monospace>filtered_probs()</monospace> and
  <monospace>smoothed_probs()</monospace>, respectively.</p>
  <code language="julia">using Plots

plot(filtered_probs(model),
     label     = [&quot;Regime 1&quot; &quot;Regime 2&quot;],
     title     = &quot;Regime probabilities&quot;, 
     linewidth = 2)</code>
  <p>Figure
  <xref alt="[fig:example]" rid="figU003Aexample">[fig:example]</xref>
  presents the output of the code above.</p>
  <fig>
    <caption><p>Filtered probabilites.
    <styled-content id="figU003Aexample"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="regime_probs.png" />
  </fig>
  <p>The package also provides a function for forecasting the dependent
  variable. However, for the Markov switching models, the prediction is
  not as intuitive as in less complex models. The reason is that the
  model also requires a forecast of state at time
  <inline-formula><alternatives>
  <tex-math><![CDATA[t+1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p><monospace>predict()</monospace> function returns the forecasted
  values either calculated in the instantaneous way:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[\hat{y}_t = \sum_{i=1}^{k} \hat{\xi}_{i,t}X_{t}'\hat{\beta}_{i}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mover><mml:mi>y</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:msub><mml:mover><mml:mi>Œæ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mi>‚Ä≤</mml:mi><mml:msub><mml:mover><mml:mi>Œ≤</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>or as a one step ahead forecast, where the states are predicted
  themselves:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[\hat{y}_{t+1} = \sum_{i=1}^{k} (P\hat{\xi}_{i,t})X_{t+1}'\hat{\beta}_{i}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mover><mml:mi>y</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>P</mml:mi><mml:msub><mml:mover><mml:mi>Œæ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mi>‚Ä≤</mml:mi><mml:msub><mml:mover><mml:mi>Œ≤</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>For more details, the user is referred to the package
  <ext-link ext-link-type="uri" xlink:href="https://m-dadej.github.io/MarSwitching.jl/stable/">documentation</ext-link>.
  Alternatively, in order to inspect the description of a particular
  function, the help operator - <monospace>?</monospace> in Julia‚Äôs REPL
  may come in handy (e.g., <monospace>?MSModel</monospace>).</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This open-source research software project received no financial
  support.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-bezanson2017julia">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bezanson</surname><given-names>Jeff</given-names></name>
        <name><surname>Edelman</surname><given-names>Alan</given-names></name>
        <name><surname>Karpinski</surname><given-names>Stefan</given-names></name>
        <name><surname>Shah</surname><given-names>Viral B</given-names></name>
      </person-group>
      <article-title>Julia: A fresh approach to numerical computing</article-title>
      <source>SIAM review</source>
      <publisher-name>SIAM</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>59</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1137/141000671</uri>
      <pub-id pub-id-type="doi">10.1137/141000671</pub-id>
      <fpage>65</fpage>
      <lpage>98</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hamilton89">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hamilton</surname><given-names>James D.</given-names></name>
      </person-group>
      <article-title>A new approach to the economic analysis of nonstationary time series and the business cycle</article-title>
      <source>Econometrica</source>
      <publisher-name>[Wiley, Econometric Society]</publisher-name>
      <year iso-8601-date="1989">1989</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-10-10">2023</year><month>10</month><day>10</day></date-in-citation>
      <volume>57</volume>
      <issue>2</issue>
      <uri>http://www.jstor.org/stable/1912559</uri>
      <pub-id pub-id-type="doi">10.2307/1912559</pub-id>
      <fpage>357</fpage>
      <lpage>384</lpage>
    </element-citation>
  </ref>
  <ref id="ref-buffington02">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Buffington</surname><given-names>John</given-names></name>
        <name><surname>Elliott</surname><given-names>Robert J.</given-names></name>
      </person-group>
      <article-title>American options with regime switching</article-title>
      <source>International Journal of Theoretical and Applied Finance</source>
      <year iso-8601-date="2002">2002</year>
      <volume>05</volume>
      <issue>05</issue>
      <uri>https://doi.org/10.1142/S0219024902001523</uri>
      <pub-id pub-id-type="doi">10.1142/S0219024902001523</pub-id>
      <fpage>497</fpage>
      <lpage>514</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Brandt2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brandt</surname><given-names>Patrick T.</given-names></name>
        <name><surname>Freeman</surname><given-names>John R.</given-names></name>
        <name><surname>Schrodt</surname><given-names>Philip A.</given-names></name>
      </person-group>
      <article-title>Evaluating forecasts of political conflict dynamics</article-title>
      <source>International Journal of Forecasting</source>
      <year iso-8601-date="2014">2014</year>
      <volume>30</volume>
      <issue>4</issue>
      <issn>0169-2070</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0169207014000612</uri>
      <pub-id pub-id-type="doi">10.1016/j.ijforecast.2014.03.014</pub-id>
      <fpage>944</fpage>
      <lpage>962</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wang23">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wang</surname><given-names>Huimin</given-names></name>
        <name><surname>Song</surname><given-names>Songbai</given-names></name>
        <name><surname>Zhang</surname><given-names>Gengxi</given-names></name>
        <name><surname>Ayantoboc</surname><given-names>Olusola O.</given-names></name>
      </person-group>
      <article-title>Predicting daily streamflow with a novel multi-regime switching ARIMA-MS-GARCH model</article-title>
      <source>Journal of Hydrology: Regional Studies</source>
      <year iso-8601-date="2023">2023</year>
      <volume>47</volume>
      <issn>2214-5818</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S2214581823000617</uri>
      <pub-id pub-id-type="doi">10.1016/j.ejrh.2023.101374</pub-id>
      <fpage>101374</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-shiferaw21">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Shiferaw</surname><given-names>Yegnanew A.</given-names></name>
      </person-group>
      <article-title>Regime shifts in the COVID-19 case fatality rate dynamics: A Markov-switching autoregressive model analysis</article-title>
      <source>Chaos, Solitons &amp; Fractals: X</source>
      <year iso-8601-date="2021">2021</year>
      <volume>6</volume>
      <issn>2590-0544</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S259005442100004X</uri>
      <pub-id pub-id-type="doi">10.1016/j.csfx.2021.100059</pub-id>
      <fpage>100059</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-delbianco20">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Delbianco</surname><given-names>Fernando</given-names></name>
        <name><surname>Fioriti</surname><given-names>Andr√©s</given-names></name>
        <name><surname>Hernandez-Chanto</surname><given-names>Allan</given-names></name>
        <name><surname>Tohm√©</surname><given-names>Fernando</given-names></name>
      </person-group>
      <article-title>A Markov-switching approach to the study of citations in academic journals</article-title>
      <source>Journal of Informetrics</source>
      <year iso-8601-date="2020">2020</year>
      <volume>14</volume>
      <issue>4</issue>
      <issn>1751-1577</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S1751157720301851</uri>
      <pub-id pub-id-type="doi">10.1016/j.joi.2020.101081</pub-id>
      <fpage>101081</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Rlang">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>R Core Team</string-name>
      </person-group>
      <source>R: A language and environment for statistical computing</source>
      <publisher-name>R Foundation for Statistical Computing</publisher-name>
      <publisher-loc>Vienna, Austria</publisher-loc>
      <year iso-8601-date="2017">2017</year>
      <uri>https://www.R-project.org/</uri>
    </element-citation>
  </ref>
  <ref id="ref-MSwM">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Josep A. Sanchez-Espigares</surname><given-names>Alberto Lopez-Moreno</given-names></name>
      </person-group>
      <source>MSwM: Fitting Markov switching models</source>
      <year iso-8601-date="2021">2021</year>
      <uri>https://cran.r-project.org/package=MSwM</uri>
      <pub-id pub-id-type="doi">10.32614/cran.package.mswm</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-dynr">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ou</surname><given-names>Lu</given-names></name>
        <name><surname>Hunter</surname><given-names>Michael D.</given-names></name>
        <name><surname>Chow</surname><given-names>Sy-Miin</given-names></name>
      </person-group>
      <article-title>What‚Äôs for dynr: A package for linear and nonlinear dynamic modeling in R</article-title>
      <source>The R Journal</source>
      <year iso-8601-date="2019">2019</year>
      <volume>11</volume>
      <pub-id pub-id-type="doi">10.32614/rj-2019-012</pub-id>
      <fpage>1</fpage>
      <lpage>20</lpage>
    </element-citation>
  </ref>
  <ref id="ref-statsmodels">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Seabold</surname><given-names>Skipper</given-names></name>
        <name><surname>Perktold</surname><given-names>Josef</given-names></name>
      </person-group>
      <article-title>Statsmodels: Econometric and statistical modeling with Python</article-title>
      <source>9th python in science conference</source>
      <year iso-8601-date="2010">2010</year>
      <pub-id pub-id-type="doi">10.25080/majora-92bf1922-011</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-msregress">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Perlin</surname><given-names>Marcelo</given-names></name>
      </person-group>
      <source>MS_regress - the MATLAB package for Markov regime switching models</source>
      <year iso-8601-date="2012">2012</year>
      <uri>https://github.com/msperlin/MS\_Regress-Matlab</uri>
      <pub-id pub-id-type="doi">10.2139/ssrn.1714016</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Dalle2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dalle</surname><given-names>Guillaume</given-names></name>
      </person-group>
      <article-title>HiddenMarkovModels.jl: Generic, fast and reliable state space modeling</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>9</volume>
      <issue>96</issue>
      <uri>https://doi.org/10.21105/joss.06436</uri>
      <pub-id pub-id-type="doi">10.21105/joss.06436</pub-id>
      <fpage>6436</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-filardo94">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Filardo</surname><given-names>Andrew J.</given-names></name>
      </person-group>
      <article-title>Business-cycle phases and their transitional dynamics</article-title>
      <source>Journal of Business &amp; Economic Statistics</source>
      <publisher-name>[American Statistical Association, Taylor &amp; Francis, Ltd.]</publisher-name>
      <year iso-8601-date="1994">1994</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-10-11">2023</year><month>10</month><day>11</day></date-in-citation>
      <volume>12</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.2307/1392086</pub-id>
      <fpage>299</fpage>
      <lpage>308</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kim94">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kim</surname><given-names>Chang-Jin</given-names></name>
      </person-group>
      <article-title>Dynamic linear models with Markov-switching</article-title>
      <source>Journal of Econometrics</source>
      <year iso-8601-date="1994">1994</year>
      <volume>60</volume>
      <issue>1</issue>
      <issn>0304-4076</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/0304407694900361</uri>
      <pub-id pub-id-type="doi">10.1016/0304-4076(94)90036-1</pub-id>
      <fpage>1</fpage>
      <lpage>22</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
