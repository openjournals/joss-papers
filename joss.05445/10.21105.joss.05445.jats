<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">5445</article-id>
<article-id pub-id-type="doi">10.21105/joss.05445</article-id>
<title-group>
<article-title>lczexplore: an R package to explore Local Climate Zone
classifications</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7106-2677</contrib-id>
<name>
<surname>Gousseff</surname>
<given-names>Matthieu</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4936-7079</contrib-id>
<name>
<surname>Bocher</surname>
<given-names>Erwan</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7374-5722</contrib-id>
<name>
<surname>Bernard</surname>
<given-names>Jérémy</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-4"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2079-8633</contrib-id>
<name>
<surname>Wiederhold</surname>
<given-names>Elisabeth Le Saux</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="corresp" rid="cor-2"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>CNRS, Lab-STICC, UMR 6285, Vannes, France</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>University of Savoie Mont-Blanc, LOCIE, UMR 5271,
France</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Université Bretagne Sud, Lab-STICC, UMR 6285, Vannes,
France</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>University of Gothenburg, Department of Earth Sciences,
Sweden</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
<corresp id="cor-2">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2023-04-01">
<day>1</day>
<month>4</month>
<year>2023</year>
</pub-date>
<volume>8</volume>
<issue>91</issue>
<fpage>5445</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R SOFTWARE</kwd>
<kwd>climate</kwd>
<kwd>environment</kwd>
<kwd>GIS</kwd>
<kwd>spatial analysis</kwd>
<kwd>cities</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Climate change is a growing concern for city planners as Urban Heat
  Islands have an impact on mortality
  (<xref alt="Clarke, 1972" rid="ref-clarke1972some" ref-type="bibr">Clarke,
  1972</xref>), health in general
  (<xref alt="Lowe, 2016" rid="ref-lowe2016energy" ref-type="bibr">Lowe,
  2016</xref>) and consumption of energy for building cooling
  (<xref alt="Malys et al., 2012" rid="ref-malys2012microclimate" ref-type="bibr">Malys
  et al., 2012</xref>) among other effects. A first step towards large
  scale study of urban climate is to define classes based on logical
  division of the landscape, such as Local Climate Zones (LCZ) defined
  by Stewart &amp; Oke
  (<xref alt="2012" rid="ref-stewart2012local" ref-type="bibr">2012</xref>).</p>
  <p>A spatial comparison is performed by producing agreement maps
  between classifications, agreement statistics and a confusion matrix
  to help qualify and quantify the misclassifications.</p>
  <p>The lczexplore package aims at comparing different LCZ
  classifications, but can be used to compare any pair of
  classifications on geographical units.</p>
  <p>This software is available as a free and open source R package.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <sec id="comparing-maps">
    <title>Comparing maps</title>
    <p>As stated in
    (<xref alt="Visser &amp; De Nijs, 2006" rid="ref-visser2006map" ref-type="bibr">Visser
    &amp; De Nijs, 2006</xref>) comparing maps is an important issue in
    environmental research. The four main reasons to compare categorical
    variables on geographical units are:</p>
    <list list-type="bullet">
      <list-item>
        <p>to assess the differences between maps generated by models
        under different scenarios and assumptions,</p>
      </list-item>
      <list-item>
        <p>to detect temporal changes,</p>
      </list-item>
      <list-item>
        <p>to calibrate or validate models,</p>
      </list-item>
      <list-item>
        <p>to perform uncertainty and sensitivity analysis.</p>
      </list-item>
    </list>
  </sec>
  <sec id="comparing-specifically-lcz-maps">
    <title>Comparing specifically LCZ maps</title>
    <p>Climate change is a growing concern for city planners with a
    special focus on Urban Heat Island phenomenons. The terms
    <italic>rural</italic> and <italic>urban</italic> lack of a clear
    definition and different classifications of urban and rural
    landscapes were proposed. Stewart &amp; Oke
    (<xref alt="2012" rid="ref-stewart2012local" ref-type="bibr">2012</xref>)
    defined an approach that complies with criteria of geographical
    classification defined in Grigg
    (<xref alt="1965" rid="ref-grigg1965logic" ref-type="bibr">1965</xref>).
    Their Local Climate Zones (LCZ) are based on a logical segmentation
    of land-use and urban canopy parameters and define 10 urban types
    and 7 land cover types.</p>
    <p>LCZ have gained popularity in the past decade as they sum up
    relevant information and can help, for instance, apprehend the
    intensity of the Urban Heat Island
    (<xref alt="Kotharkar &amp; Bagade, 2018" rid="ref-kotharkar2018evaluating" ref-type="bibr">Kotharkar
    &amp; Bagade, 2018</xref>).</p>
    <p>Several methods aim to classify a territory into LCZ, but only
    few workflows allow an automatic classification for any given area.
    Quan &amp; Bansal
    (<xref alt="2021" rid="ref-quan2021systematic" ref-type="bibr">2021</xref>)
    distinguishes two main streams of production of these LCZ:</p>
    <list list-type="bullet">
      <list-item>
        <p>the raster stream processes remotely sensed information, and
        applies machine learning algorithms trained using local experts’
        knowledge. In this way, the WUDAPT community
        (<xref alt="Ching et al., 2018" rid="ref-chingWUDAPTUrbanWeather2018a" ref-type="bibr">Ching
        et al., 2018</xref>) produced thousands of city-based LCZ maps,
        accessible via the LCZ Generator
        (<xref alt="Demuzere et al., 2021" rid="ref-demuzereLCZGeneratorWeb2021" ref-type="bibr">Demuzere
        et al., 2021</xref>), but also large-scale maps for Europe, the
        continental United States and the whole world
        (<xref alt="Demuzere et al., 2019" rid="ref-demuzere2019mapping" ref-type="bibr">Demuzere
        et al., 2019</xref>,
        <xref alt="2020" rid="ref-demuzere2020combining" ref-type="bibr">2020</xref>,
        <xref alt="2022" rid="ref-demuzere2022global" ref-type="bibr">2022</xref>).</p>
      </list-item>
      <list-item>
        <p>the vector stream uses Geographic Information System (GIS)
        layers that represent the main topographic features, defines
        spatial units, computes urban canopy parameters and uses them to
        classify spatial units into LCZ. For instance, the GeoClimate
        geospatial toolbox produces LCZ classifications from
        OpenStreetMap or french BDTopo data
        (<xref alt="Bocher et al., 2021" rid="ref-bocher2021geoclimate" ref-type="bibr">Bocher
        et al., 2021</xref>).</p>
      </list-item>
    </list>
    <p>The existence of several methods to produce LCZ classifications,
    or the use of a method with different input data, raises the need
    for a tool to quickly get:</p>
    <list list-type="order">
      <list-item>
        <p>Statistics measuring the general agreement between two
        classifications</p>
      </list-item>
      <list-item>
        <p>A spatial representation to allow a fast visual assessment of
        the zones where the classifications agree or disagree.</p>
      </list-item>
      <list-item>
        <p>A confusion matrix, to explore how the levels of one
        classification break up in levels of the other classification,
        shown in a graphical way to help visualize the main differences
        between the classifications.</p>
      </list-item>
    </list>
  </sec>
</sec>
<sec id="state-of-the-field-and-feature-comparison">
  <title>State of the field and feature comparison</title>
  <sec id="state-of-the-field-on-spatial-classification-comparison">
    <title>State of the field on spatial classification
    comparison</title>
    <p>The question of going beyond the simple visual observation of
    differences between maps is not a new one. A first approach would
    be, on raster maps, to simply compute the agreement between two maps
    as the proportion of pixels for which the two maps have the same
    value of the variable of interest. This approach is often sufficient
    to help specialists compare pairs of maps, but it has two main
    drawbacks:</p>
    <list list-type="bullet">
      <list-item>
        <p>two totally random maps won’t have a value of agreement of
        zero, as some pixel values may agree by chance,</p>
      </list-item>
      <list-item>
        <p>only raster maps where pixels match perfectly (same size, not
        translated) can be treated, or some pre-treatment are needed
        (like nearest neighbours interpolation for instance).</p>
      </list-item>
    </list>
    <p>To prevent the first drawback, Monserud &amp; Leemans
    (<xref alt="1992" rid="ref-monserudComparingGlobalVegetation1992" ref-type="bibr">1992</xref>)
    proposed the use of Cohen’s kappa coefficient of agreement for
    nominal scales
    (<xref alt="Cohen, 1960" rid="ref-cohenCoefficientAgreementNominal1960" ref-type="bibr">Cohen,
    1960</xref>). Cohen’s Kappa allow to assess how two raters agree or
    differ in the task of rating individual. In our case, each pixel is
    seen as an individual, each map is seen as a rater and the value of
    the raster at each pixel is seen as the rate.</p>
    <p>The comprehensive Map Comparison kit, which was released in 2001
    by the Netherlands Environmental Assessment Agency
    (<xref alt="Visser &amp; De Nijs, 2006" rid="ref-visser2006map" ref-type="bibr">Visser
    &amp; De Nijs, 2006</xref>), is an example of a tool that provides
    multiple methods to compare raster maps. It includes a fuzzy
    algorithm which allows to tackle small shifts of one map from
    another. It only works on raster maps, only on Windows OS and
    doesn’t allow automation for several pairs of maps.</p>
    <p>To tackle the second drawback, one can rasterize vector files,
    for instance by applying a regular grid to a vector layer and assign
    to each pixel the value of the vector geometry most present in the
    pixel (in terms of area of the intersection). This can produce
    severe effect of smoothing one may want to prevent.</p>
    <p>Other approaches also rely on comparing the distribution of some
    variables of interest. For instance
    (<xref alt="Hammerberg et al., 2018" rid="ref-hammerbergImplicationsEmployingDetailed2018" ref-type="bibr">Hammerberg
    et al., 2018</xref>), rather than comparing the maps, compare some
    model output variables using the data of the map.</p>
  </sec>
  <sec id="state-of-the-field-on-local-climate-zone-maps-comparison.">
    <title>State of the field on Local Climate Zone maps
    comparison.</title>
    <p>As Local Climate Zones emerged as a new standard for
    characterizing urban landscapes
    (<xref alt="Demuzere et al., 2021" rid="ref-demuzereLCZGeneratorWeb2021" ref-type="bibr">Demuzere
    et al., 2021</xref>), specific tools are needed to allow easy
    automation of LCZ maps. As a matter of fact, “ground truth” is hard
    to define in matters of LCZs, and one may want to compare LCZs
    produced by experts and by different algorithms.</p>
    <p>The very definition of LCZs by Stewart &amp; Oke
    (<xref alt="2012" rid="ref-stewart2012local" ref-type="bibr">2012</xref>)
    relies on ranges of values for several indicators, and sometimes
    several LCZ types could be assigned to the corresponding geometries.
    Therefore, one may associate a confidence value to the LCZ type and
    check if filtering pixels (for raster data) or geometries (for
    vector data) accordingly to a confidence threshold has an impact on
    the way maps agree or disagree.</p>
    <p>A comparison of a raster stream result and a GIS vector stream
    approach was proposed by Muhammad et al.
    (<xref alt="2022" rid="ref-muhammad2022inference" ref-type="bibr">2022</xref>).
    This comparison relies on rasterising vector data. It uses several
    tools: QGIS, python scripts and SAGA GIS. As far as we know, the
    scripts and the automation of the method are not publicly
    available.</p>
    <p>The need for automation of map comparison (both raster and
    vector), and specific features (like standard colors or legends for
    LCZs, or sensitivity analysis according to confidence) justified the
    development of <monospace>lczexplore</monospace>.</p>
  </sec>
  <sec id="features">
    <title>Features</title>
    <sec id="general-workflow-and-processing-steps">
      <title>General workflow and processing steps</title>
      <p>The <monospace>lczexplore</monospace> package is a set of
      <monospace>R</monospace> functions to import, visualize, group and
      compare LCZ classifications, even when they don’t use the same
      spatial units to classify the area. These LCZ classifications can
      come from vector layers or raster layers (the latter will be
      vectorized by the dedicated import function)</p>
      <fig>
        <caption><p>Workflow and main functions of the
        package<styled-content id="figU003AWorkflowU0020andU0020mainU0020functionsU0020ofU0020theU0020package"></styled-content></p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="media/workflow.png" />
      </fig>
      <p>Figure 1 describes the general workflow of the package.</p>
      <p>Main functions are presented in plain lines, the dashed boxes
      and arrows represent optional steps. These functions are presented
      in detail in the next section, and they allow the following steps
      of exploration:</p>
      <list list-type="order">
        <list-item>
          <p>The LCZ classifications (or any other qualitative
          variables) are imported from a file (GeoJSON or Shapefile
          format)</p>
        </list-item>
        <list-item>
          <p>Each LCZ classification can then be visualized</p>
        </list-item>
        <list-item>
          <p>Some LCZ levels may be grouped in broader categories</p>
        </list-item>
        <list-item>
          <p>A pair of LCZ classifications (or qualitative variable
          maps) can then be compared:</p>
          <list list-type="bullet">
            <list-item>
              <p>a map of agreement/disagreement is produced,</p>
            </list-item>
            <list-item>
              <p>the general agreement and a pseudo-kappa indicator of
              agreement are computed,</p>
            </list-item>
            <list-item>
              <p>the summed surface of each LCZ type is computed for
              each classification,</p>
            </list-item>
            <list-item>
              <p>a confusion matrix shows how the levels of one LCZ
              classification break up into the levels of the other</p>
            </list-item>
          </list>
        </list-item>
        <list-item>
          <p>Influence of the level of confidence on the agreement
          between classifications is performed (sensitivity
          analysis)</p>
        </list-item>
      </list>
      <p>All the steps of the analysis can be easily automated in R, for
      instance on several cities at a time.</p>
    </sec>
  </sec>
  <sec id="description-of-the-main-functions">
    <title>Description of the main functions</title>
    <p>The main functions are presented in this section. More details
    about their arguments and output can be found in the minimal example
    section.</p>
    <sec id="from-import-to-comparison">
      <title>From import to comparison</title>
      <p>The <monospace>importLCZvect</monospace> function allows to
      import a LCZ classification from a GeoJSON or a Shapefile.
      Geometries and LCZ types are needed, but one can also optionally
      load unique identifiers and a confidence level for the LCZ type of
      each geometry.</p>
      <p>The <monospace>importLCZraster</monospace> function allows the
      import from a raster map, and the user has to feed it a GeoTIFF
      and a bounding box of the area of interest.</p>
      <p>The import functions output objects of class
      <monospace>simple feature</monospace>, as defined by the openGIS
      consortium and as handled by the <monospace>sf</monospace>
      package, an R reference library for Geographical Information
      System Vector Data
      (<xref alt="Pebesma, 2018" rid="ref-RJ-2018-009" ref-type="bibr">Pebesma,
      2018</xref>).</p>
      <p>The <monospace>compareLCZ</monospace> function creates
      intersected geometries on which classifications either totally
      agree or totally disagree, as seen in the figure 2, and this
      prevents artificial rounding effects that may arise with a
      rasterisation approach.</p>
      <fig>
        <caption><p>Intersecting geometries to have full agreement or
        disagreement
        <styled-content id="figU003AAgreementU0020independentU0020ofU0020theU0020shapeU0020ofU0020theU0020geoms"></styled-content></p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="media/intersecDemo.png" />
      </fig>
      <p>Next, the function computes:</p>
      <list list-type="bullet">
        <list-item>
          <p>the area of each LCZ type for each classification,</p>
        </list-item>
        <list-item>
          <p>the percentage of area on which the two classifications
          agree, and a map of this agreement,</p>
        </list-item>
        <list-item>
          <p>a pseudo kappa statistics which evaluates agreement beyond
          how two random maps may agree,</p>
        </list-item>
        <list-item>
          <p>a confusion matrix of how the types of one LCZ
          classification break up in the types of the other, and a
          graphic of this, with an indicator of the summed area for each
          LCZ type (useful if the two classifications disagree on a type
          almost absent of the area).</p>
        </list-item>
      </list>
      <p>The output of these functions are shown in the minimal example
      section.</p>
      <p>With the <monospace>standard</monospace> representation,
      comparing LCZ maps is made easy by a default setting of legends
      and colors. The <monospace>alter</monospace> representation allows
      the user to deal with regrouped LCZ categories or any type of
      qualitative variables. Levels can either be specified by the user
      or deduced from the data, colors can either be defined by the user
      or chosen from a random palette.</p>
    </sec>
    <sec id="class-levels-grouping">
      <title>Class levels grouping</title>
      <p>It is sometimes useful to group some LCZ types, for instance to
      create a broader category for all the urban LCZ types and another
      for landscape LCZ types, or to group the levels with similar
      estimated impact on an urban heat island intensity.</p>
      <p>The <monospace>groupLCZ</monospace> function allows the user to
      specify the LCZ types one wants to group together, the names of
      the new resulting categories and their corresponding colors. One
      can then feed <monospace>compareLCZ</monospace> function these new
      groups, setting <monospace>repr=&quot;alter&quot;</monospace>, and
      specify desired levels and colors.</p>
      <fig>
        <caption><p>Grouping of LCZ types into larger categories
        <styled-content id="figU003AU0020GroupingU0020ofU0020LCZU0020typesU0020intoU0020largerU0020categories"></styled-content></p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="media/fromBrutToGrouped.png" />
      </fig>
    </sec>
    <sec id="sensitivity-analysis">
      <title>Sensitivity analysis</title>
      <p>Some algorithms add a uniqueness value to the LCZ type it
      assigns to a spatial unit. It can measure if another LCZ level
      could have been assigned to this unit. Thus, it can be seen as a
      confidence value of the LCZ type. The
      <monospace>lczexplore</monospace> package allows a sensitivity
      analysis according to this level of confidence, in order to answer
      the question: <bold>does keeping only geometries with a higher
      confidence value make the degree of agreement between two
      classifications higher?</bold></p>
      <p>This sensitivity analysis is performed considering all LCZ
      types and within each individual LCZ type.</p>
      <fig>
        <caption><p>Sensitivity analysis according to confidence for all
        LCZ levels
        <styled-content id="figU003AU0020SensitivityU0020analysisU0020accordingU0020toU0020confidence"></styled-content></p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="media/confidSensibGen.png" />
      </fig>
      <p>The agreement between classifications for the geometries with a
      confidence level higher than the threshold, and their numbers, are
      plotted in blue. The agreement and the numbers of geometries under
      the threshold are plotted in magenta. On this example, one can see
      that ditching geometries that have a confidence level lower than
      0.5 increases the agreement to more than 90%. The curve then tends
      to flatten, and the number of kept geometries decreases a lot
      (from 602 to 122). One also needs to notice that on this example,
      most geometries didn’t have a confidence value (7476 with a
      general agreement of 59.21%)</p>
    </sec>
    <sec id="import-and-explore-categorical-variable-other-than-lcz-classifications">
      <title>Import and explore categorical variable (other than LCZ
      classifications)</title>
      <p>This package focuses on LCZ maps comparison, but more often
      than not, people working on LCZ maps also describe their area of
      interest with other categorical indicators. The workflow of
      comparison of LCZ maps can be used for any pair of maps of
      categorical variables, under certain limitations:</p>
      <list list-type="bullet">
        <list-item>
          <p>there must not be more than 36 levels for the categorical
          variable to explore,</p>
        </list-item>
        <list-item>
          <p>the associated geometries must be (multi) polygons or
          easily converted to them, (typically, the package would not be
          suitable to compare road characterization),</p>
        </list-item>
        <list-item>
          <p>the geometries must be topographically valid (this is also
          true for LCZ).</p>
        </list-item>
      </list>
      <p>The <monospace>importQualVar</monospace> function allows the
      import of such variables on (multi-) polygons maps. It outputs an
      sf object that can be fed to the other main functions of the
      package (<monospace>showLCZ</monospace>,
      <monospace>compareLCZ</monospace>,
      <monospace>groupLCZ</monospace>…).</p>
    </sec>
  </sec>
</sec>
<sec id="coding-implementation">
  <title>Coding implementation</title>
  <p><monospace>lczexplore</monospace> is an R package, all its specific
  functions are coded in R language. It relies on state-of-the art
  packages:</p>
  <list list-type="bullet">
    <list-item>
      <p>geographical computation requires the
      <bold><monospace>sf</monospace></bold> package for vector data and
      the <bold><monospace>terra</monospace></bold> package for raster
      data,</p>
    </list-item>
    <list-item>
      <p>data management mainly requires the following packages:
      <bold><monospace>dplyr, tidyr, forcats, rlang</monospace></bold>
      and <bold><monospace>methods</monospace></bold> packages,</p>
    </list-item>
    <list-item>
      <p>graphical production uses
      <bold><monospace>ggplot2, grDevices, cowplot</monospace></bold>
      and <bold><monospace>RColorBrewer</monospace></bold>,</p>
    </list-item>
    <list-item>
      <p>tests need the <bold><monospace>tinytest</monospace></bold>
      package.</p>
    </list-item>
  </list>
  <p>Every step corresponds to an R function (see the workflow on figure
  1 for the name of the main functions).</p>
  <p>Every function has an associated file for unitary testing.</p>
</sec>
<sec id="a-minimal-example">
  <title>A minimal example</title>
  <sec id="install-and-load">
    <title>Install and load</title>
    <p>The lczexplore package can be downloaded from
    <monospace>https://github.com/orbisgis/lczexplore</monospace> and
    installed with the command
    <monospace>install_github</monospace>:</p>
    <code language="r script">library(devtools)
devtools::install_github(&quot;orbisgis/lczexplore&quot;, build_vignettes = TRUE)
library(lczexplore)</code>
    <p>In order to discover the package, vignettes can be browsed via
    <monospace>browseVignettes(&quot;lczexplore&quot;)</monospace> or by
    calling them directly:</p>
    <code language="r script">vignette(&quot;lczexplore_en&quot;)
vignette(&quot;lczexplore_raster_vector&quot;)
vignette(&quot;lczexplore_alter&quot;)</code>
  </sec>
  <sec id="import-the-data">
    <title>Import the data</title>
    <p>This example uses two LCZ classifications of French Redon city,
    produced using a single LCZ classification method (the GeoClimate
    workflow), with two different input data: OpenStreetMap and the 2.2
    version of the French BDTopo.</p>
    <code language="r script">
# Set the path to the example data folder created once you install the package

dirPath&lt;-paste0(system.file(&quot;extdata&quot;,package=&quot;lczexplore&quot;),&quot;/&quot;)
dirPathOSM&lt;-paste0(dirPath,&quot;osm/2022/Redon&quot;)
dirPathBDT&lt;-paste0(dirPath,&quot;bdtopo_2_2/Redon&quot;)

# Import into an sf object the data produced with GeoClimate and
# the OpenStreetMap data (city of Redon)
redonOSM&lt;-importLCZvect(
  dirPath=dirPathOSM,
  file=&quot;rsu_lcz.geojson&quot;, column = &quot;LCZ_PRIMARY&quot;, geomID=&quot;ID_RSU&quot;,
  confid=&quot;LCZ_UNIQUENESS_VALUE&quot;)

# Import into an sf object the data produced with GeoClimate and
# the french BDTopo V2.2 data (city of Redon)
redonBDT&lt;-importLCZvect(
  dirPath=dirPathBDT,
  file=&quot;rsu_lcz.geojson&quot;, column = &quot;LCZ_PRIMARY&quot;,geomID=&quot;ID_RSU&quot;,
  confid=&quot;LCZ_UNIQUENESS_VALUE&quot;)</code>
  </sec>
  <sec id="visualize-the-data">
    <title>Visualize the data</title>
    <p>To visualize a LCZ classification, use the
    <monospace>showLCZ</monospace> function. Setting
    <monospace>repr</monospace> to
    <monospace>&quot;standard&quot;</monospace> directly deals with
    standard values of LCZ levels and colors.</p>
    <code language="r script">
# Plot the LCZ levels on the Redon Area using the default color set
# from the sf object produced by importLCZvect function
map1&lt;-showLCZ(
  sf=redonOSM, column=&quot;LCZ_PRIMARY&quot;, repr=&quot;standard&quot;,
  title=&quot;LCZ Classification on the French City of Redon&quot;)
    </code>
    <p>The result is a map of the Local Climate Zones on the area:</p>
    <fig>
      <caption><p>Local Climate Zones for Redon city based on the
      GeoClimate workflow applied to OSM data
      <styled-content id="figU003ALCZU0020onU0020RedonU0020spatialU0020units"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="media/showRedonOSM.png" />
    </fig>
  </sec>
  <sec id="compare-the-two-lcz-classifications">
    <title>Compare the two LCZ classifications</title>
    <p>To compare the two loaded LCZ classifications, use the
    <monospace>compareLCZ</monospace> function.</p>
    <list list-type="bullet">
      <list-item>
        <p>the <monospace>sf1</monospace> and
        <monospace>column1</monospace> arguments allow to specify the sf
        dataset of the first map, and the column in which the LCZ levels
        are stored (same for <monospace>sf2</monospace> and
        <monospace>column2</monospace>),</p>
      </list-item>
      <list-item>
        <p>the <monospace>wf1</monospace> and <monospace>wf2</monospace>
        arguments take strings to specify the workflows used to produce
        the input data.</p>
      </list-item>
      <list-item>
        <p>The <monospace>location</monospace> argument allows to name
        the area of interest covered by input datasets. The 3 previous
        arguments will be parsed in the legends of the graphics (except
        if <monospace>title</monospace> is specified) and the name of
        potential csv output files,</p>
      </list-item>
      <list-item>
        <p>when <monospace>exWrite=TRUE</monospace>, the data computed
        to create the confusion matrix will be written in a csv file in
        the working directory,</p>
      </list-item>
      <list-item>
        <p>if <monospace>saveG=TRUE</monospace>, the four plots created
        by the function will be written in a png file in the working
        directory.</p>
      </list-item>
    </list>
    <code language="r script"># Compare how the BDTopo and the OpenStreetMap Data produce different classifications.
# The outputs are stored in a list.

comparison&lt;-compareLCZ(sf1=redonBDT,column1=&quot;LCZ_PRIMARY&quot;, wf1=&quot;BDTopo v2.2&quot;,
           sf2=redonOSM, column2=&quot;LCZ_PRIMARY&quot;, wf2=&quot;OpenStreetMap&quot;,
           ref=1, repr=&quot;standard&quot;, exwrite=F, location=&quot;Redon&quot;)
    </code>
    <p>All graphics are concatenated for a quick glance.</p>
    <fig>
      <caption><p>Local Climate Zones comparison for the French city of
      Redon based on the GeoClimate workflow applied to OpenStreetMap
      and BDTopo data
      <styled-content id="figU003ALCZU0020comparisonU0020onU0020RedonU0020spatialU0020units"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="media/compareRedon.png" />
    </fig>
    <p>The first and second maps show the spatial distribution of the
    first and second LCZ classifications levels, respectively. The third
    map shows where the two classifications agree or disagree. The last
    graphic is a confusion matrix: how the LCZ types of the first
    classification break-up in those of the second, in percentage of the
    surface.</p>
    <p><monospace>CompareLCZ</monospace> outputs a list called
    <monospace>matConfOut</monospace> which contains:</p>
    <list list-type="bullet">
      <list-item>
        <p><monospace>$data</monospace>, intersected geometries, their
        identifiers and associated confidence value (if fed to the
        function), their LCZ type and their area,</p>
      </list-item>
      <list-item>
        <p><monospace>$areas</monospace>, the summed area for each LCZ
        for both classifications,</p>
      </list-item>
      <list-item>
        <p><monospace>$matConfLarge</monospace>, the confusion
        matrix,</p>
      </list-item>
      <list-item>
        <p><monospace>$percAgg</monospace>, the general agreement of the
        two classification on the whole area (as a percentage of the
        global surface of the area),</p>
      </list-item>
      <list-item>
        <p><monospace>$pseudoK</monospace>, the value of a heuristic
        pseudo Cohen’s Kappa coefficient of agreement.</p>
      </list-item>
    </list>
    <p>The value <monospace>pseudoK</monospace> corresponds to a Kappa,
    where the cells of the cross tabulation would be weighted by the
    percentage of the concerned surface.</p>
    <p>One can see in a quick glance, that the BDTopo workflow leads to
    more and smaller Spatial Reference Units (1553 RSU) than the
    OpenStreetMap workflow (521 RSU). The third map shows that while the
    classifications tend to agree on wide vegetation areas, there seem
    to be more some discrepancies in the urban areas. The last graphics
    helps to refine this analysis: one can notice that both workflows
    quite agree for “compact mid” and “low plants” LCZ levels (89% and
    88 % of the concerned areas). On the contrary, only 48% of the areas
    set to “dense trees” by BDTopo workflow are also set to “dense
    trees” by OpenStreetMap workflow, while 37% of these areas are set
    as “low plants.”</p>
    <p>In the same way, 73% of the areas set to “compact low” by BDTopo
    workflow are set to “compact mid” by OpenStreetMap workflow. This is
    coherent with the fact that building heights are often missing on
    OpenStreetMap and that the algorithm that GeoClimate uses to predict
    them is less precise than the available information of BDTopo. One
    may read more in Bernard et al.
    (<xref alt="2023" rid="ref-bernardGenericAlgorithmAutomatically2023" ref-type="bibr">2023</xref>)
    about differences between these workflows.</p>
  </sec>
  <sec id="study-the-impact-of-confidence-on-agreement">
    <title>Study the impact of confidence on agreement</title>
    <p>The <monospace>confidSensib</monospace> function makes a
    sensitivity analysis of the agreement according to the threshold of
    confidence above which one keeps the geometries of the compared
    maps. To perform this analysis, the confidence value and the
    identifier of each geometry must be fed to the comparison function.
    The <monospace>$data</monospace> slot is then passed to
    <monospace>confidSensib</monospace>. The
    <monospace>saveG</monospace> allows to set the path to a folder
    where resulting graphics will be saved.</p>
    <p>The values of confidence for which the agreement will be computed
    are determined by the range of confidence values present in the data
    and by the number of points, set by the
    <monospace>nPoints</monospace> argument.</p>
    <code language="r script"># Path to the folder where compareLCZ stored output data file
# mainPath&lt;-system.file(&quot;extdata&quot;, package = &quot;lczexplore&quot;)
# (not executed to avoid useless files in the package)


# Specification of geomID and confid columns for both dataset,
# as confidSensib needs them in the next step

comparison&lt;-compareLCZ(
  sf1=redonBDT,column1=&quot;LCZ_PRIMARY&quot;, wf1=&quot;BDTopo v2.2&quot;,
  geomID1=&quot;ID_RSU&quot;, confid1=&quot;LCZ_UNIQUENESS_VALUE&quot;,
  sf2=redonOSM, column2=&quot;LCZ_PRIMARY&quot;, wf2=&quot;OpenStreetMap&quot;,
  geomID2=&quot;ID_RSU&quot;, confid2=&quot;LCZ_UNIQUENESS_VALUE&quot;,ref=1,
  repr=&quot;standard&quot;, exwrite=F, location=&quot;Redon&quot;)

testSourceFact&lt;-comparison$data

# Sensitivityanalysis on this compareLCZ output

sensitAnalysis&lt;-confidSensib(inputDf=comparison$data, filePath=&quot;&quot;,
   nPoints=5, wf1=&quot;bdtopo_2_2&quot;, wf2=&quot;osm&quot;,
   geomID1=&quot;ID_RSU&quot;, column1=&quot;LCZ_PRIMARY&quot;, confid1=&quot;LCZ_UNIQUENESS_VALUE&quot;,
   geomID2=&quot;ID_RSU.1&quot;,column2=&quot;LCZ_PRIMARY.1&quot;, confid2=&quot;LCZ_UNIQUENESS_VALUE.1&quot;,
   plot=TRUE, saveG=&quot;&quot;) #  one would use saveG = mainPath to write the results in
   # the mainPath folder
    </code>
    <p>Figure 7 shows the resulting graphics for the agreement per LCZ
    type (types not present in the dataset are excluded).</p>
    <fig>
      <caption><p>Sensitivity analysis according to confidence by LCZ
      levels</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="media/confidSensibByLCZ.png" />
    </fig>
    <p>For each LCZ type, the x-axis shows the minimum confidence
    threshold. The y-axis shows the agreement levels. Each cyan point
    shows the average agreement between classifications for spatial
    units where the minimum confidence value is greater than the x-axis
    value.</p>
    <p>As one wants to be sure the dropped units didn’t have a greater
    agreement, they are showed as magenta triangles. For this particular
    example, it seems that for the “Open Low” LCZ type, the greater the
    confidence, the smaller the agreement!</p>
    <p>This unexpected result is explained by the fact that in our case,
    the confidence qualifies the method, not the data. In this example,
    in the OSM dataset which is compared, the building height are mostly
    estimated using a statistical method
    (<xref alt="Bernard et al., 2022" rid="ref-bernardEstimationMissingBuilding2022" ref-type="bibr">Bernard
    et al., 2022</xref>) as stated above.</p>
  </sec>
  <sec id="group-some-levels-and-perform-the-same-analysis">
    <title>Group some levels and perform the same analysis</title>
    <p>The <monospace>groupLCZ</monospace> function aggregates chosen
    levels into broader categories. For each category, a vector is
    needed, which name is the name of the broader category to create and
    which values are the levels to be grouped in this new category.</p>
    <code language="r script">redonOSMgrouped&lt;-groupLCZ(redonOSM,column=&quot;LCZ_PRIMARY&quot;,
                           urban=c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;),
                           industry=&quot;10&quot;,
                           vegetation=c(&quot;101&quot;,&quot;102&quot;,&quot;103&quot;,&quot;104&quot;),
                           impervious=&quot;105&quot;,
                           pervious=&quot;106&quot;,
                           water=&quot;107&quot;,
                           colors=c(&quot;red&quot;,&quot;black&quot;,&quot;green&quot;,&quot;grey&quot;,&quot;burlywood&quot;,&quot;blue&quot;))

redonBDTgrouped&lt;-groupLCZ(redonBDT,column=&quot;LCZ_PRIMARY&quot;,
                           urban=c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;),
                           industry=&quot;10&quot;,
                           vegetation=c(&quot;101&quot;,&quot;102&quot;,&quot;103&quot;,&quot;104&quot;),
                           impervious=&quot;105&quot;,
                           pervious=&quot;106&quot;,
                           water=&quot;107&quot;,
                           colors=c(&quot;red&quot;,&quot;black&quot;,&quot;green&quot;,&quot;grey&quot;,&quot;burlywood&quot;,&quot;blue&quot;))
    </code>
    <p>By default, the column where the new categories are stored is
    named <monospace>&quot;grouped&quot;</monospace>, but it can be set
    with the argument <monospace>outCol</monospace>.</p>
    <p>It is the possible to perform the same analysis as on standard
    LCZ classifications, as shown in the following example:</p>
    <code language="r script">map2&lt;-showLCZ(redonOSMgrouped, column=&quot;grouped&quot;,repr=&quot;alter&quot;,
        title=&quot;Regrouped Categories for the city of Redon&quot;,
        LCZlevels = c(&quot;urban&quot;,&quot;industry&quot;,&quot;vegetation&quot;,&quot;impervious&quot;,&quot;pervious&quot;,&quot;water&quot;),
        colors=c(&quot;red&quot;,&quot;black&quot;,&quot;green&quot;,&quot;grey&quot;,&quot;burlywood&quot;,&quot;blue&quot;))
compareLCZ(sf1=redonOSMgrouped, column1=&quot;grouped&quot;, wf1=&quot;OpenStreetMap data&quot;,
            sf2=redonBDTgrouped, column2=&quot;grouped&quot;, wf2=&quot;BDTopo data&quot;,ref=1,
           repr=&quot;alter&quot;,exwrite=F,location=&quot;Redon&quot;,saveG=&quot;&quot;,
           LCZlevels = c(&quot;urban&quot;,&quot;industry&quot;,&quot;vegetation&quot;,&quot;impervious&quot;,&quot;pervious&quot;,
           &quot;water&quot;),
           colors=c(&quot;red&quot;,&quot;black&quot;,&quot;green&quot;,&quot;grey&quot;,&quot;burlywood&quot;,&quot;blue&quot;))</code>
    <fig>
      <caption><p>Map of grouped levels on the city of Redon
      <styled-content id="figU003AU0020GroupedU0020LCZU0020onU0020theU0020cityU0020ofU0020Redon"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="media/redonGrouped.png" />
    </fig>
    <p>You can also map any qualitative variable using this grouped
    representation, as long as you specify the expected levels the same
    way.</p>
  </sec>
  <sec id="an-example-of-qualitative-variables">
    <title>An example of qualitative variables</title>
    <p>The function <monospace>importQualVar</monospace> allows you to
    import maps of qualitative variables on (multi)polygons. For
    instance, classifications of urban tissue called Urban Typology by
    Random Forest
    (<xref alt="Bocher et al., 2018" rid="ref-bocherGeoprocessingFrameworkCompute2018" ref-type="bibr">Bocher
    et al., 2018</xref>) are available as examples in this package.</p>
    <p>After the import, the usual functions can be used, as shown in
    the following code:</p>
    <code language="r script">utrfRedonBDT&lt;-importQualVar(dirPath=paste0(
  system.file(&quot;extdata&quot;, package = &quot;lczexplore&quot;), &quot;/bdtopo_2_2/Redon&quot;),
  file=&quot;rsu_utrf_area.geojson&quot;, column=&quot;TYPO_MAJ&quot;)

map3&lt;-showLCZ(sf=utrfRedonBDT, column=&quot;TYPO_MAJ&quot;,repr=&quot;alter&quot;,
        title = &quot; UTRF classification of the French city of Redon&quot;)</code>
    <fig>
      <caption><p>An example of some qualitative variable: Urban
      Typology by Random Forest (UTRF)</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="media/importQualVarUTRF.png" />
    </fig>
    <p>Figure 9 represents the UTRF classification of the French city of
    Redon, as computed by the GeoClimate workflow on BDTopo v2.2 data.
    The colors were not specified and therefore were randomly picked
    from a palette.</p>
    <code language="r script">utrfRedonOSM&lt;-
  importQualVar(
    dirPath=paste0(
      system.file(&quot;extdata&quot;, package = &quot;lczexplore&quot;),
      &quot;/osm/2022/Redon&quot;),
    file=&quot;rsu_utrf_area.geojson&quot;, column=&quot;TYPO_MAJ&quot;,
    geomID=&quot;ID_RSU&quot;, confid=&quot;UNIQUENESS_VALUE&quot;)

utrfComparison&lt;-
    compareLCZ(sf1=utrfRedonBDT, column1=&quot;TYPO_MAJ&quot;,wf1=&quot; UTRF BDTopo&quot;,
               sf2=utrfRedonOSM, column2=&quot;TYPO_MAJ&quot;, wf2 = &quot; UTRF OpenStreetMap&quot;,
  location = &quot; Redon&quot;,exwrite=FALSE,repr=&quot;alter&quot;)
  # Plot the confusion matrix of thes two classifications</code>
    <fig>
      <caption><p>Example of comparison on a qualitative variable
      (UTRF)</p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="media/compareQualVar.png" />
    </fig>
  </sec>
</sec>
<sec id="licensing-availability-and-contribution">
  <title>Licensing, availability and contribution</title>
  <p>lczexplore is licensed under the GNU Lesser General Public License
  (v3.0), with all source code stored at GitHub. In the spirit of honest
  and open science, requests and suggestions for fixes, feature updates,
  as well as general questions and concerns are encouraged via direct
  interaction with contributors and developers by filing an issue while
  respecting Contribution Guidelines.</p>
</sec>
<sec id="research-projects-involving-lczexplore">
  <title>Research projects involving lczexplore</title>
  <p>The lczexplore package was developed thanks to the project PÆNDORA2
  (Pour la gestion du confort estival: Donnees, Outils et
  Recherche-Action) (2022 -2025), funded by ADEME.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-visser2006map">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Visser</surname><given-names>Hans</given-names></name>
        <name><surname>De Nijs</surname><given-names>T</given-names></name>
      </person-group>
      <article-title>The map comparison kit</article-title>
      <source>Environmental Modelling &amp; Software</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2006">2006</year>
      <volume>21</volume>
      <issue>3</issue>
      <fpage>346</fpage>
      <lpage>358</lpage>
    </element-citation>
  </ref>
  <ref id="ref-monserudComparingGlobalVegetation1992">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Monserud</surname><given-names>Robert A.</given-names></name>
        <name><surname>Leemans</surname><given-names>Rik</given-names></name>
      </person-group>
      <article-title>Comparing global vegetation maps with the Kappa statistic</article-title>
      <source>Ecological Modelling</source>
      <year iso-8601-date="1992-08">1992</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-06-30">2023</year><month>06</month><day>30</day></date-in-citation>
      <volume>62</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1016/0304-3800(92)90003-W</pub-id>
      <fpage>275</fpage>
      <lpage>293</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hammerbergImplicationsEmployingDetailed2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hammerberg</surname><given-names>Kris</given-names></name>
        <name><surname>Brousse</surname><given-names>Oscar</given-names></name>
        <name><surname>Martilli</surname><given-names>Alberto</given-names></name>
        <name><surname>Mahdavi</surname><given-names>Ardeshir</given-names></name>
      </person-group>
      <article-title>Implications of employing detailed urban canopy parameters for mesoscale climate modelling: A comparison between WUDAPT and GIS databases over Vienna, Austria</article-title>
      <source>International Journal of Climatology</source>
      <year iso-8601-date="2018-04">2018</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-06-30">2023</year><month>06</month><day>30</day></date-in-citation>
      <volume>38</volume>
      <pub-id pub-id-type="doi">10.1002/joc.5447</pub-id>
      <fpage>e1241</fpage>
      <lpage>e1257</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lowe2016energy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lowe</surname><given-names>Scott A</given-names></name>
      </person-group>
      <article-title>An energy and mortality impact assessment of the urban heat island in the US</article-title>
      <source>Environmental impact assessment review</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>56</volume>
      <pub-id pub-id-type="doi">10.1016/j.eiar.2015.10.004</pub-id>
      <fpage>139</fpage>
      <lpage>144</lpage>
    </element-citation>
  </ref>
  <ref id="ref-clarke1972some">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Clarke</surname><given-names>John F</given-names></name>
      </person-group>
      <article-title>Some effects of the urban structure on heat mortality</article-title>
      <source>Environmental research</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="1972">1972</year>
      <volume>5</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1016/0013-9351(72)90023-0</pub-id>
      <fpage>93</fpage>
      <lpage>104</lpage>
    </element-citation>
  </ref>
  <ref id="ref-malys2012microclimate">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Malys</surname><given-names>L</given-names></name>
        <name><surname>Musy</surname><given-names>M</given-names></name>
        <name><surname>Inard</surname><given-names>C</given-names></name>
      </person-group>
      <article-title>Microclimate and buildings energy consumption: Sensitivity analysis of coupling methods</article-title>
      <source>Eighth international conference on urban climate and 10th symposium on the urban environment</source>
      <year iso-8601-date="2012">2012</year>
      <pub-id pub-id-type="doi">10.1080/17512549.2015.1043643</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-stewart2012local">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Stewart</surname><given-names>Ian D</given-names></name>
        <name><surname>Oke</surname><given-names>Tim R</given-names></name>
      </person-group>
      <article-title>Local climate zones for urban temperature studies</article-title>
      <source>Bulletin of the American Meteorological Society</source>
      <publisher-name>American Meteorological Society</publisher-name>
      <year iso-8601-date="2012">2012</year>
      <volume>93</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1175/bams-d-11-00019.1</pub-id>
      <fpage>1879</fpage>
      <lpage>1900</lpage>
    </element-citation>
  </ref>
  <ref id="ref-quan2021systematic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Quan</surname><given-names>Steven Jige</given-names></name>
        <name><surname>Bansal</surname><given-names>Parth</given-names></name>
      </person-group>
      <article-title>A systematic review of GIS-based local climate zone mapping studies</article-title>
      <source>Building and Environment</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>196</volume>
      <pub-id pub-id-type="doi">10.1016/j.buildenv.2021.107791</pub-id>
      <fpage>107791</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-bocher2021geoclimate">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bocher</surname><given-names>Erwan</given-names></name>
        <name><surname>Bernard</surname><given-names>Jérémy</given-names></name>
        <name><surname>Le Saux Wiederhold</surname><given-names>Elisabeth</given-names></name>
        <name><surname>Leconte</surname><given-names>François</given-names></name>
        <name><surname>Petit</surname><given-names>Gwendall</given-names></name>
        <name><surname>Palominos</surname><given-names>Sylvain</given-names></name>
        <name><surname>Noûs</surname><given-names>Camille</given-names></name>
      </person-group>
      <article-title>GeoClimate: A geospatial processing toolbox for environmental and climate studies</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2021">2021</year>
      <volume>6</volume>
      <issue>65</issue>
      <pub-id pub-id-type="doi">10.21105/joss.03541</pub-id>
      <fpage>3541</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-muhammad2022inference">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Muhammad</surname><given-names>Fadel</given-names></name>
        <name><surname>Xie</surname><given-names>Changkun</given-names></name>
        <name><surname>Vogel</surname><given-names>Julian</given-names></name>
        <name><surname>Afshari</surname><given-names>Afshin</given-names></name>
      </person-group>
      <article-title>Inference of local climate zones from GIS data, and comparison to WUDAPT classification and custom-fit clusters</article-title>
      <source>Land</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>11</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.3390/land11050747</pub-id>
      <fpage>747</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-kotharkar2018evaluating">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kotharkar</surname><given-names>Rajashree</given-names></name>
        <name><surname>Bagade</surname><given-names>Anurag</given-names></name>
      </person-group>
      <article-title>Evaluating urban heat island in the critical local climate zones of an indian city</article-title>
      <source>Landscape and Urban Planning</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>169</volume>
      <pub-id pub-id-type="doi">10.1016/j.landurbplan.2017.08.009</pub-id>
      <fpage>92</fpage>
      <lpage>104</lpage>
    </element-citation>
  </ref>
  <ref id="ref-grigg1965logic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Grigg</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>The logic of regional systems</article-title>
      <source>Annals of the Association of American Geographers</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="1965">1965</year>
      <volume>55</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1111/j.1467-8306.1965.tb00529.x</pub-id>
      <fpage>465</fpage>
      <lpage>491</lpage>
    </element-citation>
  </ref>
  <ref id="ref-chingWUDAPTUrbanWeather2018a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ching</surname><given-names>J.</given-names></name>
        <name><surname>Mills</surname><given-names>G.</given-names></name>
        <name><surname>Bechtel</surname><given-names>B.</given-names></name>
        <name><surname>See</surname><given-names>L.</given-names></name>
        <name><surname>Feddema</surname><given-names>J.</given-names></name>
        <name><surname>Wang</surname><given-names>X.</given-names></name>
        <name><surname>Ren</surname><given-names>C.</given-names></name>
        <name><surname>Brousse</surname><given-names>O.</given-names></name>
        <name><surname>Martilli</surname><given-names>A.</given-names></name>
        <name><surname>Neophytou</surname><given-names>M.</given-names></name>
        <name><surname>Mouzourides</surname><given-names>P.</given-names></name>
        <name><surname>Stewart</surname><given-names>I.</given-names></name>
        <name><surname>Hanna</surname><given-names>A.</given-names></name>
        <name><surname>Ng</surname><given-names>E.</given-names></name>
        <name><surname>Foley</surname><given-names>M.</given-names></name>
        <name><surname>Alexander</surname><given-names>P.</given-names></name>
        <name><surname>Aliaga</surname><given-names>D.</given-names></name>
        <name><surname>Niyogi</surname><given-names>D.</given-names></name>
        <name><surname>Shreevastava</surname><given-names>A.</given-names></name>
        <name><surname>Bhalachandran</surname><given-names>P.</given-names></name>
        <name><surname>Masson</surname><given-names>V.</given-names></name>
        <name><surname>Hidalgo</surname><given-names>J.</given-names></name>
        <name><surname>Fung</surname><given-names>J.</given-names></name>
        <name><surname>Andrade</surname><given-names>M.</given-names></name>
        <name><surname>Baklanov</surname><given-names>A.</given-names></name>
        <name><surname>Dai</surname><given-names>W.</given-names></name>
        <name><surname>Milcinski</surname><given-names>G.</given-names></name>
        <name><surname>Demuzere</surname><given-names>M.</given-names></name>
        <name><surname>Brunsell</surname><given-names>N.</given-names></name>
        <name><surname>Pesaresi</surname><given-names>M.</given-names></name>
        <name><surname>Miao</surname><given-names>S.</given-names></name>
        <name><surname>Mu</surname><given-names>Q.</given-names></name>
        <name><surname>Chen</surname><given-names>F.</given-names></name>
        <name><surname>Theeuwes</surname><given-names>N.</given-names></name>
      </person-group>
      <article-title>WUDAPT: An Urban Weather, Climate, and Environmental Modeling Infrastructure for the Anthropocene</article-title>
      <source>Bulletin of the American Meteorological Society</source>
      <year iso-8601-date="2018-09">2018</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-06-30">2023</year><month>06</month><day>30</day></date-in-citation>
      <volume>99</volume>
      <issue>9</issue>
      <issn>0003-0007</issn>
      <pub-id pub-id-type="doi">10.1175/BAMS-D-16-0236.1</pub-id>
      <fpage>1907</fpage>
      <lpage>1924</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cohenCoefficientAgreementNominal1960">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cohen</surname><given-names>Jacob</given-names></name>
      </person-group>
      <article-title>A Coefficient of Agreement for Nominal Scales</article-title>
      <source>Educational and Psychological Measurement</source>
      <year iso-8601-date="1960-04">1960</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-06-30">2023</year><month>06</month><day>30</day></date-in-citation>
      <volume>20</volume>
      <issue>1</issue>
      <issn>0013-1644</issn>
      <pub-id pub-id-type="doi">10.1177/001316446002000104</pub-id>
      <fpage>37</fpage>
      <lpage>46</lpage>
    </element-citation>
  </ref>
  <ref id="ref-demuzereLCZGeneratorWeb2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Demuzere</surname><given-names>Matthias</given-names></name>
        <name><surname>Kittner</surname><given-names>Jonas</given-names></name>
        <name><surname>Bechtel</surname><given-names>Benjamin</given-names></name>
      </person-group>
      <article-title>LCZ Generator: A Web Application to Create Local Climate Zone Maps</article-title>
      <source>Frontiers in Environmental Science</source>
      <year iso-8601-date="2021-04">2021</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-06-30">2023</year><month>06</month><day>30</day></date-in-citation>
      <volume>9</volume>
      <issn>2296-665X</issn>
      <pub-id pub-id-type="doi">10.3389/fenvs.2021.637455</pub-id>
      <fpage>637455</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-bernardGenericAlgorithmAutomatically2023">
    <element-citation publication-type="report">
      <person-group person-group-type="author">
        <name><surname>Bernard</surname><given-names>Jérémy</given-names></name>
        <name><surname>Bocher</surname><given-names>Erwan</given-names></name>
        <name><surname>Gousseff</surname><given-names>Matthieu</given-names></name>
        <name><surname>Leconte</surname><given-names>François</given-names></name>
        <name><surname>Le Saux Wiederhold</surname><given-names>Elisabeth</given-names></name>
      </person-group>
      <article-title>A generic algorithm to automatically classify urban fabric according to the Local Climate Zone system: Implementation in GeoClimate 0.0.1 and application to French cities</article-title>
      <publisher-name>Climate; Earth system modeling</publisher-name>
      <year iso-8601-date="2023-03">2023</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-07-04">2023</year><month>07</month><day>04</day></date-in-citation>
      <pub-id pub-id-type="doi">10.5194/egusphere-2023-371</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-bernardEstimationMissingBuilding2022">
    <element-citation publication-type="report">
      <person-group person-group-type="author">
        <name><surname>Bernard</surname><given-names>Jérémy</given-names></name>
        <name><surname>Bocher</surname><given-names>Erwan</given-names></name>
        <name><surname>Le Saux Wiederhold</surname><given-names>Elisabeth</given-names></name>
        <name><surname>Leconte</surname><given-names>François</given-names></name>
        <name><surname>Masson</surname><given-names>Valéry</given-names></name>
      </person-group>
      <article-title>Estimation of missing building height in OpenStreetMap data: A French case study using GeoClimate 0.0.1</article-title>
      <publisher-name>Climate; Earth system modeling</publisher-name>
      <year iso-8601-date="2022-04">2022</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-09-05">2022</year><month>09</month><day>05</day></date-in-citation>
      <pub-id pub-id-type="doi">10.5194/gmd-2021-428</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-bocherGeoprocessingFrameworkCompute2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bocher</surname><given-names>Erwan</given-names></name>
        <name><surname>Petit</surname><given-names>Gwendall</given-names></name>
        <name><surname>Bernard</surname><given-names>Jérémy</given-names></name>
        <name><surname>Palominos</surname><given-names>Sylvain</given-names></name>
      </person-group>
      <article-title>A geoprocessing framework to compute urban indicators: The MApUCE tools chain</article-title>
      <source>Urban Climate</source>
      <year iso-8601-date="2018-06">2018</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-07-05">2023</year><month>07</month><day>05</day></date-in-citation>
      <volume>24</volume>
      <pub-id pub-id-type="doi">10.1016/j.uclim.2018.01.008</pub-id>
      <fpage>153</fpage>
      <lpage>174</lpage>
    </element-citation>
  </ref>
  <ref id="ref-RJ-2018-009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pebesma</surname><given-names>Edzer</given-names></name>
      </person-group>
      <article-title>Simple features for r: Standardized support for spatial vector data</article-title>
      <source>The R Journal</source>
      <year iso-8601-date="2018">2018</year>
      <volume>10</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.32614/RJ-2018-009</uri>
      <pub-id pub-id-type="doi">10.32614/RJ-2018-009</pub-id>
      <fpage>439</fpage>
      <lpage>446</lpage>
    </element-citation>
  </ref>
  <ref id="ref-demuzere2019mapping">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Demuzere</surname><given-names>Matthias</given-names></name>
        <name><surname>Bechtel</surname><given-names>Benjamin</given-names></name>
        <name><surname>Middel</surname><given-names>Ariane</given-names></name>
        <name><surname>Mills</surname><given-names>Gerald</given-names></name>
      </person-group>
      <article-title>Mapping europe into local climate zones</article-title>
      <source>PloS one</source>
      <publisher-name>Public Library of Science San Francisco, CA USA</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>14</volume>
      <issue>4</issue>
      <fpage>e0214474</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-demuzere2022global">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Demuzere</surname><given-names>Matthias</given-names></name>
        <name><surname>Kittner</surname><given-names>Jonas</given-names></name>
        <name><surname>Martilli</surname><given-names>Alberto</given-names></name>
        <name><surname>Mills</surname><given-names>Gerald</given-names></name>
        <name><surname>Moede</surname><given-names>Christian</given-names></name>
        <name><surname>Stewart</surname><given-names>Iain D</given-names></name>
        <name><surname>Vliet</surname><given-names>Jasper van</given-names></name>
        <name><surname>Bechtel</surname><given-names>Benjamin</given-names></name>
      </person-group>
      <article-title>A global map of local climate zones to support earth system modelling and urban scale environmental science</article-title>
      <source>Earth System Science Data Discussions</source>
      <publisher-name>Göttingen, Germany</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>2022</volume>
      <pub-id pub-id-type="doi">10.5194/ems2022-83</pub-id>
      <fpage>1</fpage>
      <lpage>57</lpage>
    </element-citation>
  </ref>
  <ref id="ref-demuzere2020combining">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Demuzere</surname><given-names>Matthias</given-names></name>
        <name><surname>Hankey</surname><given-names>Steve</given-names></name>
        <name><surname>Mills</surname><given-names>Gerald</given-names></name>
        <name><surname>Zhang</surname><given-names>Wenwen</given-names></name>
        <name><surname>Lu</surname><given-names>Tianjun</given-names></name>
        <name><surname>Bechtel</surname><given-names>Benjamin</given-names></name>
      </person-group>
      <article-title>Combining expert and crowd-sourced training data to map urban form and functions for the continental US</article-title>
      <source>Scientific data</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>7</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/s41597-020-00605-z</pub-id>
      <fpage>264</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
