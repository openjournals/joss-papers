<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7028</article-id>
<article-id pub-id-type="doi">10.21105/joss.07028</article-id>
<title-group>
<article-title>SpectralModel: a high-resolution framework for
petitRADTRANS 3</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1957-0455</contrib-id>
<name>
<surname>Blain</surname>
<given-names>Doriann</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4096-7067</contrib-id>
<name>
<surname>Mollière</surname>
<given-names>Paul</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9792-3121</contrib-id>
<name>
<surname>Nasedkin</surname>
<given-names>Evert</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Max Planck Institut für Astronomie, Königstuhl 17 D-69117
Heidelberg, Germany</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-05-18">
<day>18</day>
<month>5</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>102</issue>
<fpage>7028</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>astronomy</kwd>
<kwd>exoplanets</kwd>
<kwd>atmospheres</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Atmospheric characterisation from spectroscopic data is a key to
  understand planetary formation. Two types of observations can be
  performed for this kind of analysis. Space-based observations (e.g.,
  using the James Webb Space Telescope, JWST), are not impeded by the
  Earth’s atmosphere, but are currently limited to low resolving powers
  (<inline-formula><alternatives>
  <tex-math><![CDATA[< 3000]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>3000</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>),
  which can lead to ambiguities in some species detections. Ground-based
  observations (e.g., using the Very Large Telescope, VLT), on the other
  hand, can benefit from large resolving powers
  (<inline-formula><alternatives>
  <tex-math><![CDATA[\approx 10^{5}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>≈</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>),
  allowing for unambiguous species detection, but are impacted by
  telluric spectral lines. <monospace>petitRADTRANS</monospace> (pRT) is
  a radiative transfer package used for computing emission or
  transmission spectra of planetary atmospheres
  (<xref alt="Mollière et al., 2019" rid="ref-Molliere2019" ref-type="bibr">Mollière
  et al., 2019</xref>). The package has a non-negligible user base, the
  original article being cited in 264 refereed works at the time of
  writing. pRT is already relatively easy to use on space-based,
  low-resolution observations. However, while the package technically
  has the capacity to analyse high-resolution spectra, thanks to its
  ability to incorporate high-resolution (<inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{R} = 10^{6}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ℛ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>)
  line lists, ground-based observations analysis is a complex and
  challenging task. The new <monospace>SpectralModel</monospace> object
  provides a powerful and flexible framework that streamlines the setup
  necessary to model and retrieve high-resolution spectra.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Calculating a spectrum using pRT’s core object
  <monospace>Radtrans</monospace> is a two-step process in which the
  user first instantiates the object, giving parameters that control the
  loading of opacities. The second step is for the user to call one of
  the <monospace>Radtrans</monospace> function, giving “spectral”
  parameters such as the temperatures or the mass fractions of the
  atmosphere, that will be used in combination with the loaded opacities
  to generate the spectrum.</p>
  <p>However, these two steps are by themselves often insufficient to
  build a spectrum in a real-life scenario. The spectral parameters may
  individually rely on arbitrarily complex models requiring their own
  parameters, and may depend on each other. For example, getting mass
  fractions from equilibrium chemistry requires knowing the temperature
  profile, and the mean molar mass requires knowing the mass fractions
  (see e.g. the built-in pRT functions). Common operations such as
  convolving the spectrum, scaling it to stellar flux, or more
  specifically for high-resolution spectra, Doppler-shifting the
  spectrum and including the transit effect, must be done by
  post-processing the <monospace>Radtrans</monospace>-generated
  spectrum. Finally, using a retrieval requires to code a “retrieval
  model” including all the steps described above. This induces,
  especially for first-time users, a significant setup cost. The
  alternative is to use one of pRT’s built-in models, but this lacks
  flexibility.</p>
  <p>The <monospace>SpectralModel</monospace> object extends the base
  capabilities of the petitRADTRANS package by providing a standardized
  but flexible framework for spectral calculations. It has been
  especially designed to effectively erase the setup cost of modelling
  the spectral Doppler-shift, the transit effect, and of implementing
  the preparation step necessary for ground-based high-resolution
  observations analysis. <monospace>SpectralModel</monospace> is also
  interfaced with pRT’s <monospace>retrieval</monospace> module
  (<xref alt="Nasedkin et al., 2024" rid="ref-Nasedkin2024" ref-type="bibr">Nasedkin
  et al., 2024</xref>), and as such is an easy-to-use tool to perform
  both high- and low-resolution atmospheric retrievals. Compared to
  other commonly used spectral modelling packages, for example
  <ext-link ext-link-type="uri" xlink:href="https://github.com/baptklein/ATMOSPHERIX_DATA_RED">ATMOSPHERIX</ext-link>
  (<xref alt="Klein et al., 2023" rid="ref-Klein2023" ref-type="bibr">Klein
  et al., 2023</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://github.com/substellar/brewster">Brewster</ext-link>
  (<xref alt="Burningham et al., 2021" rid="ref-Burningham2021" ref-type="bibr">Burningham
  et al., 2021</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://github.com/mrline/CHIMERA">CHIMERA</ext-link>
  (<xref alt="Line et al., 2013" rid="ref-Line2013" ref-type="bibr">Line
  et al., 2013</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://psg.gsfc.nasa.gov/">PSG</ext-link>
  (<xref alt="Villanueva et al., 2018" rid="ref-VILLANUEVA2018" ref-type="bibr">Villanueva
  et al., 2018</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://github.com/nemesiscode/radtrancode">NEMESIS</ext-link>
  (<xref alt="Irwin et al., 2008" rid="ref-IRWIN2008" ref-type="bibr">Irwin
  et al., 2008</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://github.com/natashabatalha/picaso">PICASO</ext-link>
  (<xref alt="Batalha et al., 2019" rid="ref-Batalha2019" ref-type="bibr">Batalha
  et al., 2019</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://github.com/ideasrule/platon">PLATON</ext-link>
  (<xref alt="Zhang et al., 2020" rid="ref-Zhang2020" ref-type="bibr">Zhang
  et al., 2020</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MartianColonist/POSEIDON">POSEIDON</ext-link>
  (<xref alt="MacDonald, 2023" rid="ref-MacDonald2023" ref-type="bibr">MacDonald,
  2023</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://github.com/ucl-exoplanets/TauREx3_public">TauREx</ext-link>
  (<xref alt="Al-Refaie et al., 2021" rid="ref-Al-Refaie2021" ref-type="bibr">Al-Refaie
  et al., 2021</xref>), petitRADTRANS is currently, to our knowledge,
  the only one able to both generate time-varying high-resolution
  spectra and retrieve the corresponding data
  out-of-the-box<xref ref-type="fn" rid="fn1">1</xref>.</p>
  <p>The combination of ease-of-use and flexibility offered by
  <monospace>SpectralModel</monospace> makes it a powerful tool for
  high-resolution (but also low-resolution) atmospheric
  characterisation. With the upcoming first light of a new generation of
  ground based telescopes, such as the Extremely Large Telescope,
  <monospace>SpectralModel</monospace> makes petitRADTRANS ready for the
  new scientific discoveries that will be unveiled in the next era of
  high-resolution observations.</p>
</sec>
<sec id="the-spectralmodel-object">
  <title>The <monospace>SpectralModel</monospace> object</title>
  <sec id="spectral-parameter-calculation-framework">
    <title>Spectral parameter calculation framework</title>
    <fig>
      <caption><p><styled-content id="figU003Aflowchart"></styled-content>Flowchart
      of <monospace>SpectralModel.calculate_spectrum</monospace>
      function. The annotation below the model functions represents an
      example of execution order of these function after topological
      sorting, involving the temperature (<inline-formula><alternatives>
      <tex-math><![CDATA[T]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>),
      the metallicity (<inline-formula><alternatives>
      <tex-math><![CDATA[Z]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Z</mml:mi></mml:math></alternatives></inline-formula>),
      the time (<inline-formula><alternatives>
      <tex-math><![CDATA[t]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>),
      the mass fractions (MMR), the mean molar masses (MMW), the orbital
      phases (<inline-formula><alternatives>
      <tex-math><![CDATA[\phi]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ϕ</mml:mi></mml:math></alternatives></inline-formula>),
      the relative velocities (<inline-formula><alternatives>
      <tex-math><![CDATA[v]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>v</mml:mi></mml:math></alternatives></inline-formula>),
      and the transit effect (<inline-formula><alternatives>
      <tex-math><![CDATA[\delta]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>δ</mml:mi></mml:math></alternatives></inline-formula>).
      Additional deformations (<inline-formula><alternatives>
      <tex-math><![CDATA[D]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>D</mml:mi></mml:math></alternatives></inline-formula>)
      and noise (<inline-formula><alternatives>
      <tex-math><![CDATA[N]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>)
      can also be included.</p></caption>
      <graphic mimetype="application" mime-subtype="pdf" xlink:href="flowchart.pdf" />
    </fig>
    <p><monospace>SpectralModel</monospace> provides a framework to
    automatise the calculation of the spectral parameters. Each spectral
    parameter is linked to a function, called here “model function”,
    which calculates its value. This feature can be extended to the
    parameters required for these functions, and so on. Before
    calculating spectra, the function’s execution order is automatically
    determined through a topological sorting
    algorithm<xref ref-type="fn" rid="fn2">2</xref>
    (<xref alt="Kahn, 1962" rid="ref-Kahn1962" ref-type="bibr">Kahn,
    1962</xref>). <monospace>SpectralModel</monospace> comes with
    built-in functions
    (<xref alt="Blain et al., 2024" rid="ref-Blain2024" ref-type="bibr">Blain
    et al., 2024</xref>) for all the spectral parameters, so that the
    object can be used “out-of-the-box”. Parameters that ultimately do
    not depend on any function are called “model parameters”, and must
    be given during instantiation.</p>
    <p>In addition, <monospace>SpectralModel</monospace> provides
    built-in functions
    (<xref alt="Blain et al., 2024" rid="ref-Blain2024" ref-type="bibr">Blain
    et al., 2024</xref>) to scale, convolve, Doppler-shift, rebin,
    include planet transit effect, and prepare a spectrum after it has
    been calculated. Similarly to model functions, these “spectral
    modification functions” must be given, if used, their own model
    parameters during instantiation.</p>
    <p>The spectral calculation is done within the
    <monospace>calculate_spectrum</monospace> function (see
    <xref alt="[fig:flowchart]" rid="figU003Aflowchart">[fig:flowchart]</xref>).
    The spectral mode (emission or transmission), as well as which of
    the spectral modification to activate (i.e. only scaling, or both
    convolving and rebinning, etc.), are controlled through the
    function’s arguments (“spectral modification parameters”).</p>
  </sec>
  <sec id="interface-with-prts-retrieval-module">
    <title>Interface with pRT’s <monospace>retrieval</monospace>
    module</title>
    <p>In order to be able to perform high-resolution data retrievals,
    the <monospace>Retrieval</monospace> object has been extended to
    support spectra with up to 3 dimensions, intended to be spectral
    order, exposure (time), and spectral pixel (wavelength). Several
    improvements to the module have been implemented as well:</p>
    <list list-type="bullet">
      <list-item>
        <p>The retrieved data can now be provided as arrays instead of
        requiring a file.</p>
      </list-item>
      <list-item>
        <p>Custom <monospace>Radtrans</monospace> (or by extension
        <monospace>SpectralModel</monospace>) objects can now be used
        for retrievals.</p>
      </list-item>
    </list>
    <p>In addition, <monospace>SpectralModel</monospace>‘s model
    parameters and spectral modification functions can be advantageously
    used to simplify the retrieval setup compared to
    <monospace>Radtrans</monospace>’. This removes the need for several
    steps:</p>
    <list list-type="bullet">
      <list-item>
        <p>building the <monospace>RetrievalConfig</monospace> object,
        as this has been automated,</p>
      </list-item>
      <list-item>
        <p>declaring the fixed parameters, as all model parameters that
        are not retrieved parameters are <italic>de facto</italic> fixed
        parameters,</p>
      </list-item>
      <list-item>
        <p>writing the retrieval model function, as it is given by the
        <monospace>SpectralModel</monospace> itself.</p>
      </list-item>
    </list>
    <p>Ground-based high-resolution spectra contain telluric and stellar
    lines that must be removed. This is usually done with a “preparing”
    pipeline (also called “detrending” or “pre-processing” pipeline). To
    this end, a new <monospace>retrieval.preparing</monospace>
    sub-module has been implemented, containing the “Polyfit” pipeline
    (<xref alt="Blain et al., 2024" rid="ref-Blain2024" ref-type="bibr">Blain
    et al., 2024</xref>) and the “SysRem” pipeline
    (<xref alt="Tamuz et al., 2005" rid="ref-Tamuz2005" ref-type="bibr">Tamuz
    et al., 2005</xref>). To perform a retrieval when the data are
    prepared with “Polyfit”, the forward model must be prepared in the
    same way
    (<xref alt="Blain et al., 2024" rid="ref-Blain2024" ref-type="bibr">Blain
    et al., 2024</xref>). This forward model preparation step can be
    activated when calculating a spectrum with
    <monospace>SpectralModel</monospace>.</p>
  </sec>
  <sec id="other-features">
    <title>Other features</title>
    <p>Telluric lines, noise, and other deformations can be included in
    a <monospace>SpectralModel</monospace> object. A time-varying
    airmass can be added as model parameter to better model the telluric
    lines.</p>
    <p>A command-line interface (CLI) with ESO’s
    <ext-link ext-link-type="uri" xlink:href="https://www.eso.org/observing/etc/bin/gen/form?INS.MODE=swspectr+INS.NAME=SKYCALC">SKYCALC</ext-link>
    sky model calculator has been implemented, adapting the CLI provided
    on the
    <ext-link ext-link-type="uri" xlink:href="https://www.eso.org/observing/etc/doc/skycalc/helpskycalccli.html">ESO’s
    website</ext-link>.</p>
    <p>SpectralModel comes with a class method which takes into account
    the (uniform) prior range of the radial velocity semi-amplitude
    (<inline-formula><alternatives>
    <tex-math><![CDATA[K_p]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>K</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math></alternatives></inline-formula>),
    the rest frame velocity shift (<inline-formula><alternatives>
    <tex-math><![CDATA[V_\mathrm{rest}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>),
    and the mid transit time offset (<inline-formula><alternatives>
    <tex-math><![CDATA[T_0]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula>)
    to automatically calculate the optimal wavelength range to load,
    reducing memory usage.</p>
  </sec>
</sec>
<sec id="the-petitradtrans-3-update">
  <title>The petitRADTRANS 3 update</title>
  <p>Fully and seamlessly implementing
  <monospace>SpectralModel</monospace> into pRT required major changes
  and refactors to pRT’s code. The changes focus on optimisations (both
  for speed and RAM usage) for high-resolution spectra computing, but
  this also impacts the correlated-k (low-resolution) part of the code.
  Overall, computation times for a typical spectral calculation between
  version 2 and version 3 have been divided by two, and RAM usage
  reduced by 30%. To speed-up “input data” (opacities, pre-calculated
  equilibrium chemistry table, star spectra table) loading times, pRT’s
  loading system has been overhauled and the loaded files have been
  converted from a mix of ASCII, Fortran unformatted and
  <ext-link ext-link-type="uri" xlink:href="https://www.hdfgroup.org/solutions/hdf5/">HDF5</ext-link>
  files to HDF5-only. Opacities now also follow an extended
  <ext-link ext-link-type="uri" xlink:href="https://www.exomol.com/">ExoMol
  database</ext-link> naming and structure convention. The package’s
  installation process has been made compatible with Python
  <inline-formula><alternatives>
  <tex-math><![CDATA[\geq]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>≥</mml:mo></mml:math></alternatives></inline-formula>
  3.12<xref ref-type="fn" rid="fn3">3</xref>. Finally, several
  quality-of-life features (e.g., missing requested opacities can be
  automatically downloaded from the project’s
  <ext-link ext-link-type="uri" xlink:href="https://keeper.mpdl.mpg.de/d/ccf25082fda448c8a0d0/">Keeper
  library</ext-link>, or the <monospace>Planet</monospace> object) have
  been implemented.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We thank the pRT users, who greatly helped improving the package by
  sharing their suggestions and reporting their issues.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-Al-Refaie2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Al-Refaie</surname><given-names>A. F.</given-names></name>
        <name><surname>Changeat</surname><given-names>Q.</given-names></name>
        <name><surname>Waldmann</surname><given-names>I. P.</given-names></name>
        <name><surname>Tinetti</surname><given-names>G.</given-names></name>
      </person-group>
      <article-title>TauREx 3: A fast, dynamic, and extendable framework for retrievals</article-title>
      <source>The Astrophysical Journal</source>
      <publisher-name>The American Astronomical Society</publisher-name>
      <year iso-8601-date="2021-08">2021</year><month>08</month>
      <volume>917</volume>
      <issue>1</issue>
      <uri>https://dx.doi.org/10.3847/1538-4357/ac0252</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/ac0252</pub-id>
      <fpage>37</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Batalha2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Batalha</surname><given-names>Natasha E.</given-names></name>
        <name><surname>Marley</surname><given-names>Mark S.</given-names></name>
        <name><surname>Lewis</surname><given-names>Nikole K.</given-names></name>
        <name><surname>Fortney</surname><given-names>Jonathan J.</given-names></name>
      </person-group>
      <article-title>Exoplanet reflected-light spectroscopy with PICASO</article-title>
      <source>The Astrophysical Journal</source>
      <publisher-name>The American Astronomical Society</publisher-name>
      <year iso-8601-date="2019-06">2019</year><month>06</month>
      <volume>878</volume>
      <issue>1</issue>
      <uri>https://dx.doi.org/10.3847/1538-4357/ab1b51</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/ab1b51</pub-id>
      <fpage>70</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Blain2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Blain</surname><given-names>Doriann</given-names></name>
        <name><surname>Sánchez-López</surname><given-names>Alejandro</given-names></name>
        <name><surname>Mollière</surname><given-names>Paul</given-names></name>
      </person-group>
      <article-title>A formally motivated retrieval framework applied to the high-resolution transmission spectrum of HD 189733 b</article-title>
      <source>The Astronomical Journal</source>
      <publisher-name>The American Astronomical Society</publisher-name>
      <year iso-8601-date="2024-03">2024</year><month>03</month>
      <volume>167</volume>
      <issue>4</issue>
      <uri>https://dx.doi.org/10.3847/1538-3881/ad2c8b</uri>
      <pub-id pub-id-type="doi">10.3847/1538-3881/ad2c8b</pub-id>
      <fpage>179</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Burningham2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Burningham</surname><given-names>Ben</given-names></name>
        <name><surname>Faherty</surname><given-names>Jacqueline K</given-names></name>
        <name><surname>Gonzales</surname><given-names>Eileen C</given-names></name>
        <name><surname>Marley</surname><given-names>Mark S</given-names></name>
        <name><surname>Visscher</surname><given-names>Channon</given-names></name>
        <name><surname>Lupu</surname><given-names>Roxana</given-names></name>
        <name><surname>Gaarn</surname><given-names>Josefine</given-names></name>
        <name><surname>Fabienne Bieger</surname><given-names>Michelle</given-names></name>
        <name><surname>Freedman</surname><given-names>Richard</given-names></name>
        <name><surname>Saumon</surname><given-names>Didier</given-names></name>
      </person-group>
      <article-title>Cloud busting: enstatite and quartz clouds in the atmosphere of 2M2224-0158</article-title>
      <source>Monthly Notices of the Royal Astronomical Society</source>
      <year iso-8601-date="2021-05">2021</year><month>05</month>
      <volume>506</volume>
      <issue>2</issue>
      <issn>0035-8711</issn>
      <uri>https://doi.org/10.1093/mnras/stab1361</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stab1361</pub-id>
      <fpage>1944</fpage>
      <lpage>1961</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Gandhi2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gandhi</surname><given-names>Siddharth</given-names></name>
        <name><surname>Madhusudhan</surname><given-names>Nikku</given-names></name>
        <name><surname>Hawker</surname><given-names>George</given-names></name>
        <name><surname>Piette</surname><given-names>Anjali</given-names></name>
      </person-group>
      <article-title>HyDRA-h: Simultaneous hybrid retrieval of exoplanetary emission spectra</article-title>
      <source>The Astronomical Journal</source>
      <publisher-name>The American Astronomical Society</publisher-name>
      <year iso-8601-date="2019-11">2019</year><month>11</month>
      <volume>158</volume>
      <issue>6</issue>
      <uri>https://dx.doi.org/10.3847/1538-3881/ab4efc</uri>
      <pub-id pub-id-type="doi">10.3847/1538-3881/ab4efc</pub-id>
      <fpage>228</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-IRWIN2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Irwin</surname><given-names>P. G. J.</given-names></name>
        <name><surname>Teanby</surname><given-names>N. A.</given-names></name>
        <name><surname>de Kok</surname><given-names>R.</given-names></name>
        <name><surname>Fletcher</surname><given-names>L. N.</given-names></name>
        <name><surname>Howett</surname><given-names>C. J. A.</given-names></name>
        <name><surname>Tsang</surname><given-names>C. C. C.</given-names></name>
        <name><surname>Wilson</surname><given-names>C. F.</given-names></name>
        <name><surname>Calcutt</surname><given-names>S. B.</given-names></name>
        <name><surname>Nixon</surname><given-names>C. A.</given-names></name>
        <name><surname>Parrish</surname><given-names>P. D.</given-names></name>
      </person-group>
      <article-title>The NEMESIS planetary atmosphere radiative transfer and retrieval tool</article-title>
      <source>Journal of Quantitative Spectroscopy and Radiative Transfer</source>
      <year iso-8601-date="2008">2008</year>
      <volume>109</volume>
      <issue>6</issue>
      <issn>0022-4073</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0022407307003378</uri>
      <pub-id pub-id-type="doi">10.1016/j.jqsrt.2007.11.006</pub-id>
      <fpage>1136</fpage>
      <lpage>1150</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Kahn1962">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kahn</surname><given-names>A. B.</given-names></name>
      </person-group>
      <article-title>Topological sorting of large networks</article-title>
      <source>Commun. ACM</source>
      <publisher-name>Association for Computing Machinery</publisher-name>
      <publisher-loc>New York, NY, USA</publisher-loc>
      <year iso-8601-date="1962-11">1962</year><month>11</month>
      <volume>5</volume>
      <issue>11</issue>
      <issn>0001-0782</issn>
      <uri>https://doi.org/10.1145/368996.369025</uri>
      <pub-id pub-id-type="doi">10.1145/368996.369025</pub-id>
      <fpage>558</fpage>
      <lpage>562</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Klein2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Klein</surname><given-names>Baptiste</given-names></name>
        <name><surname>Debras</surname><given-names>Florian</given-names></name>
        <name><surname>Donati</surname><given-names>Jean-François</given-names></name>
        <name><surname>Hood</surname><given-names>Thea</given-names></name>
        <name><surname>Moutou</surname><given-names>Claire</given-names></name>
        <name><surname>Carmona</surname><given-names>Andres</given-names></name>
        <name><surname>Ould-elkhim</surname><given-names>Merwan</given-names></name>
        <name><surname>Bézard</surname><given-names>Bruno</given-names></name>
        <name><surname>Charnay</surname><given-names>Benjamin</given-names></name>
        <name><surname>Fouqué</surname><given-names>Pascal</given-names></name>
        <name><surname>Masson</surname><given-names>Adrien</given-names></name>
        <name><surname>Vinatier</surname><given-names>Sandrine</given-names></name>
        <name><surname>Baruteau</surname><given-names>Clément</given-names></name>
        <name><surname>Boisse</surname><given-names>Isabelle</given-names></name>
        <name><surname>Bonfils</surname><given-names>Xavier</given-names></name>
        <name><surname>Chiavassa</surname><given-names>Andrea</given-names></name>
        <name><surname>Delfosse</surname><given-names>Xavier</given-names></name>
        <name><surname>Dethier</surname><given-names>William</given-names></name>
        <name><surname>Hebrard</surname><given-names>Guillaume</given-names></name>
        <name><surname>Kiefer</surname><given-names>Flavien</given-names></name>
        <name><surname>Leconte</surname><given-names>Jérémy</given-names></name>
        <name><surname>Martioli</surname><given-names>Eder</given-names></name>
        <name><surname>Parmentier</surname><given-names>Vivien</given-names></name>
        <name><surname>Petit</surname><given-names>Pascal</given-names></name>
        <name><surname>Pluriel</surname><given-names>William</given-names></name>
        <name><surname>Selsis</surname><given-names>Franck</given-names></name>
        <name><surname>Teinturier</surname><given-names>Lucas</given-names></name>
        <name><surname>Tremblin</surname><given-names>Pascal</given-names></name>
        <name><surname>Turbet</surname><given-names>Martin</given-names></name>
        <name><surname>Venot</surname><given-names>Olivia</given-names></name>
        <name><surname>Wyttenbach</surname><given-names>Aurélien</given-names></name>
      </person-group>
      <article-title>ATMOSPHERIX: I- an open source high-resolution transmission spectroscopy pipeline for exoplanets atmospheres with SPIRou</article-title>
      <source>Monthly Notices of the Royal Astronomical Society</source>
      <year iso-8601-date="2023-09">2023</year><month>09</month>
      <volume>527</volume>
      <issue>1</issue>
      <issn>0035-8711</issn>
      <uri>https://doi.org/10.1093/mnras/stad2607</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stad2607</pub-id>
      <fpage>544</fpage>
      <lpage>565</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Line2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Line</surname><given-names>Michael R.</given-names></name>
        <name><surname>Knutson</surname><given-names>Heather</given-names></name>
        <name><surname>Deming</surname><given-names>Drake</given-names></name>
        <name><surname>Wilkins</surname><given-names>Ashlee</given-names></name>
        <name><surname>Desert</surname><given-names>Jean-Michel</given-names></name>
      </person-group>
      <article-title>A near-infrared transmission spectrum for the warm saturn HAT-p-12b</article-title>
      <source>The Astrophysical Journal</source>
      <publisher-name>The American Astronomical Society</publisher-name>
      <year iso-8601-date="2013-11">2013</year><month>11</month>
      <volume>778</volume>
      <issue>2</issue>
      <uri>https://dx.doi.org/10.1088/0004-637X/778/2/183</uri>
      <pub-id pub-id-type="doi">10.1088/0004-637X/778/2/183</pub-id>
      <fpage>183</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-MacDonald2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>MacDonald</surname><given-names>Ryan J.</given-names></name>
      </person-group>
      <article-title>POSEIDON: A multidimensional atmospheric retrieval code for exoplanet spectra</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>8</volume>
      <issue>81</issue>
      <uri>https://doi.org/10.21105/joss.04873</uri>
      <pub-id pub-id-type="doi">10.21105/joss.04873</pub-id>
      <fpage>4873</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Molliere2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mollière</surname><given-names>P.</given-names></name>
        <name><surname>Wardenier</surname><given-names>J. P.</given-names></name>
        <name><surname>Boekel</surname><given-names>R. van</given-names></name>
        <name><surname>Henning</surname><given-names>Th.</given-names></name>
        <name><surname>Molaverdikhani</surname><given-names>K.</given-names></name>
        <name><surname>Snellen</surname><given-names>I. A. G.</given-names></name>
      </person-group>
      <article-title>petitRADTRANS: A Python radiative transfer package for exoplanet characterization and retrieval</article-title>
      <source>Astronomy &amp; Astrophysics</source>
      <year iso-8601-date="2019-07">2019</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2020-11-05">2020</year><month>11</month><day>05</day></date-in-citation>
      <volume>627</volume>
      <issn>0004-6361</issn>
      <uri>https://www.aanda.org/10.1051/0004-6361/201935470</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361/201935470</pub-id>
      <fpage>A67</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Nasedkin2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nasedkin</surname><given-names>Evert</given-names></name>
        <name><surname>Mollière</surname><given-names>Paul</given-names></name>
        <name><surname>Blain</surname><given-names>Doriann</given-names></name>
      </person-group>
      <article-title>Atmospheric retrievals with petitRADTRANS</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>9</volume>
      <issue>96</issue>
      <uri>https://doi.org/10.21105/joss.05875</uri>
      <pub-id pub-id-type="doi">10.21105/joss.05875</pub-id>
      <fpage>5875</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Tamuz2005">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tamuz</surname><given-names>O.</given-names></name>
        <name><surname>Mazeh</surname><given-names>T.</given-names></name>
        <name><surname>Zucker</surname><given-names>S.</given-names></name>
      </person-group>
      <article-title>Correcting systematic effects in a large set of photometric light curves</article-title>
      <source>Monthly Notices of the Royal Astronomical Society</source>
      <year iso-8601-date="2005-02">2005</year><month>02</month>
      <volume>356</volume>
      <issue>4</issue>
      <issn>0035-8711</issn>
      <uri>https://doi.org/10.1111/j.1365-2966.2004.08585.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-2966.2004.08585.x</pub-id>
      <fpage>1466</fpage>
      <lpage>1470</lpage>
    </element-citation>
  </ref>
  <ref id="ref-VILLANUEVA2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Villanueva</surname><given-names>G. L.</given-names></name>
        <name><surname>Smith</surname><given-names>M. D.</given-names></name>
        <name><surname>Protopapa</surname><given-names>S.</given-names></name>
        <name><surname>Faggi</surname><given-names>S.</given-names></name>
        <name><surname>Mandell</surname><given-names>A. M.</given-names></name>
      </person-group>
      <article-title>Planetary spectrum generator: An accurate online radiative transfer suite for atmospheres, comets, small bodies and exoplanets</article-title>
      <source>Journal of Quantitative Spectroscopy and Radiative Transfer</source>
      <year iso-8601-date="2018">2018</year>
      <volume>217</volume>
      <issn>0022-4073</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0022407318301572</uri>
      <pub-id pub-id-type="doi">10.1016/j.jqsrt.2018.05.023</pub-id>
      <fpage>86</fpage>
      <lpage>104</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zhang2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhang</surname><given-names>Michael</given-names></name>
        <name><surname>Chachan</surname><given-names>Yayaati</given-names></name>
        <name><surname>Kempton</surname><given-names>Eliza M.-R.</given-names></name>
        <name><surname>Knutson</surname><given-names>Heather A.</given-names></name>
        <name><surname>Chang</surname><given-names>Wenjun (Happy)</given-names></name>
      </person-group>
      <article-title>PLATON II: New capabilities and a comprehensive retrieval on HD 189733b transit and eclipse data</article-title>
      <source>The Astrophysical Journal</source>
      <publisher-name>The American Astronomical Society</publisher-name>
      <year iso-8601-date="2020-08">2020</year><month>08</month>
      <volume>899</volume>
      <issue>1</issue>
      <uri>https://dx.doi.org/10.3847/1538-4357/aba1e6</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/aba1e6</pub-id>
      <fpage>27</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
<fn-group>
  <fn id="fn1">
    <label>1</label><p>ATMOSPHERIX is able to make cross-correlation
    analysis of high-resolution spectra, but relies on petitRADTRANS to
    generate its templates. HYDRA-H
    (<xref alt="Gandhi et al., 2019" rid="ref-Gandhi2019" ref-type="bibr">Gandhi
    et al., 2019</xref>) is a code able to perform high-resolution data
    retrievals, but is not publicly available. The other cited packages
    may have out-of-the-box single-time high-resolution spectral
    generation capabilities, but no time-varying high-resolution data
    retrieval framework, similarly to petitRADTRANS before the
    implementation of <monospace>SpectralModel</monospace>.</p>
  </fn>
  <fn id="fn2">
    <label>2</label><p>Cyclic dependencies are not supported.</p>
  </fn>
  <fn id="fn3">
    <label>3</label><p>pRT 2 used the
    <ext-link ext-link-type="uri" xlink:href="https://numpy.org/doc/stable/reference/distutils.html"><monospace>numpy.distutils</monospace>
    module</ext-link> to compile its Fortran extensions. This module is
    deprecated and is removed for Python 3.12. pRT 3 uses the
    <ext-link ext-link-type="uri" xlink:href="https://mesonbuild.com/">Meson
    build system</ext-link> instead, with almost unnoticeable changes
    for users.</p>
  </fn>
</fn-group>
</back>
</article>
