<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">4457</article-id>
<article-id pub-id-type="doi">10.21105/joss.04457</article-id>
<title-group>
<article-title>Comrade: Composable Modeling of Radio
Emission</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0003-3826-5648</contrib-id>
<name>
<surname>Tiede</surname>
<given-names>Paul</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Black Hole Initiative at Harvard University</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Center for Astrophysics | Harvard &amp;
Smithsonian</institution>
</institution-wrap>
</aff>
</contrib-group>
<volume>7</volume>
<issue>76</issue>
<fpage>4457</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>julia</kwd>
<kwd>astronomy</kwd>
<kwd>radio astronomy</kwd>
<kwd>vlbi</kwd>
<kwd>black holes</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>Comrade</monospace> is a Bayesian modeling package,
  targeted for very-long-baseline interferometry (VLBI) and written in
  the Julia<xref ref-type="fn" rid="fn1">1</xref> programming language
  (<xref alt="Bezanson et al., 2015" rid="ref-bezanson2015julia" ref-type="bibr">Bezanson
  et al., 2015</xref>). <monospace>Comrade</monospace> aims at producing
  VLBI image of black holes and active galactic nuclei. Furthermore, it
  focuses on providing uncertainty quantification of image and physical
  source properties, such as a black hole’s accretion state. The package
  has already been widely used within the Event Horizon Telescope
  Collaboration and will be useful for expert and novice VLBI
  researchers.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Radio interferometric measurements provide the highest resolution
  images ever produced, culminating in the first image of a black hole
  (<xref alt="Event Horizon Telescope Collaboration, 2019a" rid="ref-EHTCI" ref-type="bibr">Event
  Horizon Telescope Collaboration, 2019a</xref>,
  <xref alt="2019b" rid="ref-EHTCIV" ref-type="bibr">2019b</xref>,
  <xref alt="2019c" rid="ref-EHTCVI" ref-type="bibr">2019c</xref>).
  However, producing VLBI images is not straightforward. An ideal VLBI
  array samples the Fourier transform of the image,
  <inline-formula><alternatives>
  <tex-math><![CDATA[I]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>I</mml:mi></mml:math></alternatives></inline-formula>:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  V(u,v) = \int I(\alpha, \beta) e^{-2\pi i (u\alpha + v\beta)}d\alpha d\beta.
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>∫</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mi>β</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>α</mml:mi><mml:mi>d</mml:mi><mml:mi>β</mml:mi><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>In general, VLBI data sets provide an incomplete sampling of
  <inline-formula><alternatives>
  <tex-math><![CDATA[V(u_i, v_i)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  in the Fourier domain. Therefore, VLBI images are inherently uncertain
  and quantifying this uncertainty is fundamental to the VLBI imaging
  problem. This quantification is especially significant for the Event
  Horizon Telescope, which typically has only 5-8 distinct observing
  sites. To model this uncertainty, <monospace>Comrade</monospace> uses
  Bayesian inference and casts VLBI imaging as a Bayesian inverse
  problem.</p>
  <p>Given the diverse nature of AGN and black holes,
  <monospace>Comrade</monospace> includes geometric models, such as
  Gaussians, disks, rings, crescents to extract relevant features. For
  non-parametric modeling/imaging, <monospace>Comrade</monospace>
  includes a rasterized image model similar to the one described in
  Broderick, Pesce, et al.
  (<xref alt="2020" rid="ref-themaging" ref-type="bibr">2020</xref>).
  Finally, <monospace>Comrade</monospace>’s flexible model interface,
  enables direct physical modeling of an accretion flow in curved
  spacetime.</p>
  <p>Bayesian inference is numerically demanding relative to traditional
  VLBI imaging and modeling methods. Traditionally these computational
  demands have required writing large sections of the code in a
  lower-level language, e.g.,
  <monospace>C</monospace>/<monospace>C++</monospace>. However, this
  approach comes at a productivity cost to the end-user and makes it
  difficult for researchers to add their own models.
  <monospace>Comrade</monospace> solves this problem by using the Julia
  programming language. Julia was designed to solve this two-language
  problem by having <monospace>C</monospace>-like performance while
  maintaining a Python-esque syntax and programming experience
  (<xref alt="Bezanson et al., 2018" rid="ref-juliafast" ref-type="bibr">Bezanson
  et al., 2018</xref>). Julia achieves these features using a
  just-ahead-of-time compiler, and code specialization based on multiple
  dispatch. The effectiveness of this approach has been demonstrated in,
  e.g., the Celeste project
  (<xref alt="Regier et al., 2016" rid="ref-celeste" ref-type="bibr">Regier
  et al., 2016</xref>), where Julia was the first dynamically typed
  language to break the petaflops barrier.</p>
  <p>As Julia is a differentiable programming language, most
  <monospace>Comrade</monospace> models are natively differentiable.
  Utilizing gradient information to explore the parameter space quickly
  will be necessary to find reasonable image structures as image
  complexity grows. For images of the central black hole of AGN, this is
  the norm due to complicated accretion structure.
  <monospace>Comrade</monospace> is therefore well equipped to deal with
  the Bayesian VLBI imaging problem, even for large VLBI arrays.</p>
  <p>To sample from the posterior <monospace>Comrade</monospace> has
  interfaces to nested sampling algorithms,
  <monospace>NestedSamplers</monospace>
  (<xref alt="Lucas et al., 2021" rid="ref-ns" ref-type="bibr">Lucas et
  al., 2021</xref>) and <monospace>AdvancedHMC</monospace>
  (<xref alt="Xu et al., 2020" rid="ref-AHMC" ref-type="bibr">Xu et al.,
  2020</xref>) by default. Moreover, users can specify their own
  samplers. To make it easy to use <monospace>Comrade</monospace> with
  other posterior samplers, the <monospace>Comrade</monospace> includes
  functionality that transforms the posterior density from the parameter
  space to <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbb{R}^n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mstyle mathvariant="double-struck"><mml:mi>ℝ</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msup></mml:math></alternatives></inline-formula>,
  as well as the unit hypercube. This functionality is needed for
  Hamiltonian Monte Carlo and nested sampling respectively.</p>
  <p>As a result of <monospace>Comrade</monospace>’s design, it makes it
  easy to quickly produce posteriors of VLBI data. Here we show an
  example program that reproduces results from Event Horizon Telescope
  Collaboration
  (<xref alt="2019c" rid="ref-EHTCVI" ref-type="bibr">2019c</xref>).
  Namely and produces posterior of the image structure of the black hole
  in M 87<xref ref-type="fn" rid="fn2">2</xref>.</p>
  <code language="julia">using Comrade
using Distributions
using ComradeAHMC
using ComradeOptimization
using OptimizationBBO
using Plots
# load eht-imaging we use this to load eht data
load_ehtim()
# To download the data visit https://doi.org/10.25739/g85n-f134
file = &quot;SR1_M87_2017_096_lo_hops_netcal_StokesI.uvfits&quot;
obs = ehtim.obsdata.load_uvfits(file)
obs.add_scans()
# kill 0-baselines since we don't care about 
# large scale structure and make scan-average data
obs = obs.flag_uvdist(uv_min=0.1e9).avg_coherent(0.0, scan_avg=true)
# extract log closure amplitudes and closure phases
dlcamp = extract_lcamp(obs)
dcphase = extract_cphase(obs)
# form the likelihood
lklhd = RadioLikelihood(dlcamp, dcphase)
# build the model: here we fit a ring with a azimuthal 
# brightness variation and a Gaussian
function model(params)
  (;rad, wid, a, b, f, sig, asy, pa, x, y) = params
  ring = f*smoothed(stretched(MRing((a,), (b,)), rad, rad), wid)
  g = (1-f)*shifted(rotated(stretched(Gaussian(), sig*asy, sig), pa), x, y)
  return ring + g
end
# define the priors
uas2rad = pi/180.0/3600/1e6
prior = (
          rad = Uniform(uas2rad*(10.0), uas2rad*(30.0)),
          wid = Uniform(uas2rad*(1.0), uas2rad*(10.0)),
          a = Uniform(-0.5, 0.5), b = Uniform(-0.5, 0.5),
          f = Uniform(0.0, 1.0),
          sig = Uniform(uas2rad*(1.0), uas2rad*(40.0)),
          asy = Uniform(0.0, 0.75),
          pa = Uniform(0.0, 1pi),
          x = Uniform(-uas2rad*(80.0), uas2rad*(80.0)),
          y = Uniform(-uas2rad*(80.0), uas2rad*(80.0))
        )
# Now form the posterior
post = Posterior(lklhd, prior, model)
# We will use HMC to sample the posterior.
# First we will find a reasonable starting location using Optimization
# to have nice bounds we first transform to the unit hypercube
tpost = ascube(post)
ndim = dimension(tpost)
f = OptimizationFunction(tpost)
prob = OptimizationProblem(
            f, rand(ndim), nothing;
            lb=fill(1e-2, ndim), ub = fill(0.99, ndim)
            )
sol = solve(prob, BBO_adaptive_de_rand_1_bin_radiuslimited(); maxiters=50_000)
# transform the solution back to regular space
xopt = transform(tpost, sol.u)
# Comrade is all about uncertainty quantification so now let's find the posterior!
# To do this we will use the `AdvancedHMC` package or rather its interface to Comrade.
metric = DiagEuclideanMetric(ndim)
chain, stats = sample(post, AHMC(;metric), 3000; nadapts=2000, init_params=xopt)</code>
  <fig>
    <caption><p>Output of the above code. The image is a random
    posterior draw for an image of M 87.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="media/blackhole.png" xlink:title="" />
  </fig>
</sec>
<sec id="similar-packages">
  <title>Similar Packages</title>
  <list list-type="bullet">
    <list-item>
      <p><monospace>eht-imaging</monospace>
      (<xref alt="Chael et al., 2018" rid="ref-chael2018" ref-type="bibr">Chael
      et al., 2018</xref>): Python general purpose EHT imaging package.
      It currently has a modeling submodule.</p>
    </list-item>
    <list-item>
      <p><monospace>eht-dmc</monospace>
      (<xref alt="Pesce, 2021" rid="ref-dmc" ref-type="bibr">Pesce,
      2021</xref>): Python Bayesian polarized imaging package that also
      fits calibration systematics by solving the radio interferometry
      measurement equation
      (<xref alt="Hamaker, J. P. et al., 1996" rid="ref-Hamaker" ref-type="bibr">Hamaker,
      J. P. et al., 1996</xref>).</p>
    </list-item>
    <list-item>
      <p><monospace>Galifray</monospace>
      (<xref alt="Saurabh, 2022" rid="ref-gal" ref-type="bibr">Saurabh,
      2022</xref>): Python modeling package that uses emcee as its
      sampler.</p>
    </list-item>
    <list-item>
      <p><monospace>InterferometricModels</monospace>
      (<xref alt="Plavin, 2022" rid="ref-in" ref-type="bibr">Plavin,
      2022</xref>): Recent Julia radio astronomy package with some
      similar features to <monospace>Comrade</monospace>.</p>
    </list-item>
    <list-item>
      <p><monospace>NIFTy</monospace>(<xref alt="Selig et al., 2013" rid="ref-nifty" ref-type="bibr">Selig
      et al., 2013</xref>): Python-based bayesian imaging only package
      that uses Gaussian processes to model images including VLBI
      images.</p>
    </list-item>
    <list-item>
      <p><sc>Themis</sc>
      (<xref alt="Broderick, Gold, et al., 2020" rid="ref-themis" ref-type="bibr">Broderick,
      Gold, et al., 2020</xref>): A C++ parameter estimation package
      used by the EHT. It is currently a private repository for the
      EHT.</p>
    </list-item>
  </list>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>P.T. thanks Michael Johnson, Dom Pesce, Lindy Blackburn, and Avery
  Broderick for their helpful discussions related to the development of
  this package and VLBI in general.</p>
  <p>This work was supported by the Black Hole Initiative at Harvard
  University, which is funded by grants from the John Templeton
  Foundation and the Gordon and Betty Moore Foundation to Harvard
  University. Additional support was provided by Perimeter Institute for
  Theoretical Physics. Research at Perimeter Institute is supported by
  the Government of Canada through the Department of Innovation, Science
  and Economic Development Canada and by the Province of Ontario through
  the Ministry of Economic Development, Job Creation and Trade. PT’s
  research is also supported by the National Science Foundation
  (AST-1935980 and AST-2034306) and additional financial support from
  the Natural Sciences and Engineering Research Council of Canada
  through a Discovery Grant.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-bezanson2015julia">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Bezanson</surname><given-names>Jeff</given-names></name>
        <name><surname>Edelman</surname><given-names>Alan</given-names></name>
        <name><surname>Karpinski</surname><given-names>Stefan</given-names></name>
        <name><surname>Shah</surname><given-names>Viral B.</given-names></name>
      </person-group>
      <article-title>Julia: A fresh approach to numerical computing</article-title>
      <year iso-8601-date="2015">2015</year>
      <uri>https://arxiv.org/abs/1411.1607</uri>
      <pub-id pub-id-type="doi">10.1137/141000671</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-nifty">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Selig</surname><given-names>M.</given-names></name>
        <name><surname>Bell</surname><given-names>M. R.</given-names></name>
        <name><surname>Junklewitz</surname><given-names>H.</given-names></name>
        <name><surname>Oppermann</surname><given-names>N.</given-names></name>
        <name><surname>Reinecke</surname><given-names>M.</given-names></name>
        <name><surname>Greiner</surname><given-names>M.</given-names></name>
        <name><surname>Pachajoa</surname><given-names>C.</given-names></name>
        <name><surname>Enßlin</surname><given-names>T. A.</given-names></name>
      </person-group>
      <article-title>NIFTY - Numerical Information Field Theory. A versatile PYTHON library for signal inference</article-title>
      <source></source>
      <year iso-8601-date="2013-06">2013</year><month>06</month>
      <volume>554</volume>
      <uri>https://arxiv.org/abs/1301.4499</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361/201321236</pub-id>
      <fpage>A26</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-juliafast">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bezanson</surname><given-names>Jeff</given-names></name>
        <name><surname>Chen</surname><given-names>Jiahao</given-names></name>
        <name><surname>Chung</surname><given-names>Benjamin</given-names></name>
        <name><surname>Karpinski</surname><given-names>Stefan</given-names></name>
        <name><surname>Shah</surname><given-names>Viral B.</given-names></name>
        <name><surname>Vitek</surname><given-names>Jan</given-names></name>
        <name><surname>Zoubritzky</surname><given-names>Lionel</given-names></name>
      </person-group>
      <article-title>Julia: Dynamism and performance reconciled by design</article-title>
      <source>Proc. ACM Program. Lang.</source>
      <publisher-name>Association for Computing Machinery</publisher-name>
      <publisher-loc>New York, NY, USA</publisher-loc>
      <year iso-8601-date="2018-10">2018</year><month>10</month>
      <volume>2</volume>
      <issue>OOPSLA</issue>
      <uri>https://doi.org/10.1145/3276490</uri>
      <pub-id pub-id-type="doi">10.1145/3276490</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-celeste">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Regier</surname><given-names>Jeffrey</given-names></name>
        <name><surname>Pamnany</surname><given-names>Kiran</given-names></name>
        <name><surname>Giordano</surname><given-names>Ryan</given-names></name>
        <name><surname>Thomas</surname><given-names>Rollin</given-names></name>
        <name><surname>Schlegel</surname><given-names>David</given-names></name>
        <name><surname>McAuliffe</surname><given-names>Jon</given-names></name>
        <string-name>Prabhat</string-name>
      </person-group>
      <article-title>Learning an Astronomical Catalog of the Visible Universe through Scalable Bayesian Inference</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2016-11">2016</year><month>11</month>
      <uri>https://arxiv.org/abs/1611.03404</uri>
      <fpage>arXiv:1611.03404</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-themaging">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Broderick</surname><given-names>Avery E.</given-names></name>
        <name><surname>Pesce</surname><given-names>Dominic W.</given-names></name>
        <name><surname>Tiede</surname><given-names>Paul</given-names></name>
        <name><surname>Pu</surname><given-names>Hung-Yi</given-names></name>
        <name><surname>Gold</surname><given-names>Roman</given-names></name>
      </person-group>
      <article-title>Hybrid Very Long Baseline Interferometry Imaging and Modeling with THEMIS</article-title>
      <source></source>
      <year iso-8601-date="2020-07">2020</year><month>07</month>
      <volume>898</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.3847/1538-4357/ab9c1f</pub-id>
      <fpage>9</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-AHMC">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Xu</surname><given-names>Kai</given-names></name>
        <name><surname>Ge</surname><given-names>Hong</given-names></name>
        <name><surname>Tebbutt</surname><given-names>Will</given-names></name>
        <name><surname>Tarek</surname><given-names>Mohamed</given-names></name>
        <name><surname>Trapp</surname><given-names>Martin</given-names></name>
        <name><surname>Ghahramani</surname><given-names>Zoubin</given-names></name>
      </person-group>
      <article-title>AdvancedHMC. Jl: A robust, modular and efficient implementation of advanced HMC algorithms</article-title>
      <source>Symposium on advances in approximate bayesian inference</source>
      <publisher-name>PMLR</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <fpage>1</fpage>
      <lpage>10</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dmc">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pesce</surname><given-names>Dominic W.</given-names></name>
      </person-group>
      <article-title>A D-term Modeling Code (DMC) for Simultaneous Calibration and Full-Stokes Imaging of Very Long Baseline Interferometric Data</article-title>
      <source></source>
      <year iso-8601-date="2021-04">2021</year><month>04</month>
      <volume>161</volume>
      <issue>4</issue>
      <uri>https://arxiv.org/abs/2102.03328</uri>
      <pub-id pub-id-type="doi">10.3847/1538-3881/abe3f8</pub-id>
      <fpage>178</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-chael2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chael</surname><given-names>Andrew A.</given-names></name>
        <name><surname>Johnson</surname><given-names>Michael D.</given-names></name>
        <name><surname>Bouman</surname><given-names>Katherine L.</given-names></name>
        <name><surname>Blackburn</surname><given-names>Lindy L.</given-names></name>
        <name><surname>Akiyama</surname><given-names>Kazunori</given-names></name>
        <name><surname>Narayan</surname><given-names>Ramesh</given-names></name>
      </person-group>
      <article-title>Interferometric Imaging Directly with Closure Phases and Closure Amplitudes</article-title>
      <source></source>
      <year iso-8601-date="2018-04">2018</year><month>04</month>
      <volume>857</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1803.07088</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/aab6a8</pub-id>
      <fpage>23</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Hamaker">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Hamaker, J. P.</string-name>
        <string-name>Bregman, J. D.</string-name>
        <string-name>Sault, R. J.</string-name>
      </person-group>
      <article-title>Understanding radio polarimetry. I. Mathematical foundations</article-title>
      <source>Astron. Astrophys. Suppl. Ser.</source>
      <year iso-8601-date="1996">1996</year>
      <volume>117</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1051/aas:1996146</uri>
      <pub-id pub-id-type="doi">10.1051/aas:1996146</pub-id>
      <fpage>137</fpage>
      <lpage>147</lpage>
    </element-citation>
  </ref>
  <ref id="ref-EHTCI">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Event Horizon Telescope Collaboration</string-name>
      </person-group>
      <article-title>First M87 Event Horizon Telescope Results. I. The Shadow of the Supermassive Black Hole</article-title>
      <source></source>
      <year iso-8601-date="2019-04">2019</year><month>04</month>
      <volume>875</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1906.11238</uri>
      <pub-id pub-id-type="doi">10.3847/2041-8213/ab0ec7</pub-id>
      <fpage>L1</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ns">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Lucas</surname><given-names>Miles</given-names></name>
        <name><surname>Kaur</surname><given-names>Saranjeet</given-names></name>
        <name><surname>Fjelde</surname><given-names>Tor Erlend</given-names></name>
        <name><surname>Alexander</surname></name>
        <name><surname>Ge</surname><given-names>Hong</given-names></name>
        <name><surname>Pfiffer</surname><given-names>Cameron</given-names></name>
      </person-group>
      <source>TuringLang/NestedSamplers.jl: v0.8.1</source>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2021-12">2021</year><month>12</month>
      <uri>https://doi.org/10.5281/zenodo.5808196</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.5808196</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-EHTCIV">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Event Horizon Telescope Collaboration</string-name>
      </person-group>
      <article-title>First M87 Event Horizon Telescope Results. IV. Imaging the Central Supermassive Black Hole</article-title>
      <source></source>
      <year iso-8601-date="2019-04">2019</year><month>04</month>
      <volume>875</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1906.11241</uri>
      <pub-id pub-id-type="doi">10.3847/2041-8213/ab0e85</pub-id>
      <fpage>L4</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-EHTCVI">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Event Horizon Telescope Collaboration</string-name>
      </person-group>
      <article-title>First M87 Event Horizon Telescope Results. VI. The Shadow and Mass of the Central Black Hole</article-title>
      <source></source>
      <year iso-8601-date="2019-04">2019</year><month>04</month>
      <volume>875</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1906.11243</uri>
      <pub-id pub-id-type="doi">10.3847/2041-8213/ab1141</pub-id>
      <fpage>L6</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-gal">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Saurabh</surname></name>
      </person-group>
      <article-title>Galifray: Geometric modelling and parameter estimation using black hole images for EHT including VLBI</article-title>
      <source>GitHub repository</source>
      <publisher-name>GitHub</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <uri>https://github.com/Relativist1/Gallifray</uri>
    </element-citation>
  </ref>
  <ref id="ref-in">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Plavin</surname><given-names>Alexander</given-names></name>
      </person-group>
      <article-title>InterferometricModels</article-title>
      <source>GitLab repository</source>
      <publisher-name>GitLab</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <uri>https://gitlab.com/aplavin/InterferometricModels.jl</uri>
    </element-citation>
  </ref>
  <ref id="ref-themis">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Broderick</surname><given-names>Avery E.</given-names></name>
        <name><surname>Gold</surname><given-names>Roman</given-names></name>
        <name><surname>Karami</surname><given-names>Mansour</given-names></name>
        <name><surname>Preciado-López</surname><given-names>Jorge A.</given-names></name>
        <name><surname>Tiede</surname><given-names>Paul</given-names></name>
        <name><surname>Pu</surname><given-names>Hung-Yi</given-names></name>
        <name><surname>Akiyama</surname><given-names>Kazunori</given-names></name>
        <name><surname>Alberdi</surname><given-names>Antxon</given-names></name>
        <name><surname>Alef</surname><given-names>Walter</given-names></name>
        <name><surname>Asada</surname><given-names>Keiichi</given-names></name>
        <name><surname>Azulay</surname><given-names>Rebecca</given-names></name>
        <name><surname>Baczko</surname><given-names>Anne-Kathrin</given-names></name>
        <name><surname>Baloković</surname><given-names>Mislav</given-names></name>
        <name><surname>Barrett</surname><given-names>John</given-names></name>
        <name><surname>Bintley</surname><given-names>Dan</given-names></name>
        <name><surname>Blackburn</surname><given-names>Lindy</given-names></name>
        <name><surname>Boland</surname><given-names>Wilfred</given-names></name>
        <name><surname>Bouman</surname><given-names>Katherine L.</given-names></name>
        <name><surname>Bower</surname><given-names>Geoffrey C.</given-names></name>
        <name><surname>Bremer</surname><given-names>Michael</given-names></name>
        <name><surname>Brinkerink</surname><given-names>Christiaan D.</given-names></name>
        <name><surname>Brissenden</surname><given-names>Roger</given-names></name>
        <name><surname>Britzen</surname><given-names>Silke</given-names></name>
        <name><surname>Broguiere</surname><given-names>Dominique</given-names></name>
        <name><surname>Bronzwaer</surname><given-names>Thomas</given-names></name>
        <name><surname>Byun</surname><given-names>Do-Young</given-names></name>
        <name><surname>Carlstrom</surname><given-names>John E.</given-names></name>
        <name><surname>Chael</surname><given-names>Andrew</given-names></name>
        <name><surname>Chatterjee</surname><given-names>Shami</given-names></name>
        <name><surname>Chatterjee</surname><given-names>Koushik</given-names></name>
        <name><surname>Chen</surname><given-names>Ming-Tang</given-names></name>
        <name><surname>Chen</surname><given-names>Yongjun</given-names></name>
        <name><surname>Cho</surname><given-names>Ilje</given-names></name>
        <name><surname>Conway</surname><given-names>John E.</given-names></name>
        <name><surname>Cordes</surname><given-names>James M.</given-names></name>
        <name><surname>Crew</surname><given-names>Geoffrey B.</given-names></name>
        <name><surname>Cui</surname><given-names>Yuzhu</given-names></name>
        <name><surname>Davelaar</surname><given-names>Jordy</given-names></name>
        <name><surname>De Laurentis</surname><given-names>Mariafelicia</given-names></name>
        <name><surname>Deane</surname><given-names>Roger</given-names></name>
        <name><surname>Dempsey</surname><given-names>Jessica</given-names></name>
        <name><surname>Desvignes</surname><given-names>Gregory</given-names></name>
        <name><surname>Doeleman</surname><given-names>Sheperd S.</given-names></name>
        <name><surname>Eatough</surname><given-names>Ralph P.</given-names></name>
        <name><surname>Falcke</surname><given-names>Heino</given-names></name>
        <name><surname>Fish</surname><given-names>Vincent L.</given-names></name>
        <name><surname>Fomalont</surname><given-names>Ed</given-names></name>
        <name><surname>Fraga-Encinas</surname><given-names>Raquel</given-names></name>
        <name><surname>Friberg</surname><given-names>Per</given-names></name>
        <name><surname>Fromm</surname><given-names>Christian M.</given-names></name>
        <name><surname>Galison</surname><given-names>Peter</given-names></name>
        <name><surname>Gammie</surname><given-names>Charles F.</given-names></name>
        <name><surname>Garcı́a</surname><given-names>Roberto</given-names></name>
        <name><surname>Gentaz</surname><given-names>Olivier</given-names></name>
        <name><surname>Georgiev</surname><given-names>Boris</given-names></name>
        <name><surname>Goddi</surname><given-names>Ciriaco</given-names></name>
        <name><surname>Gómez</surname><given-names>José L.</given-names></name>
        <name><surname>Gu</surname><given-names>Minfeng</given-names></name>
        <name><surname>Gurwell</surname><given-names>Mark</given-names></name>
        <name><surname>Hada</surname><given-names>Kazuhiro</given-names></name>
        <name><surname>Hecht</surname><given-names>Michael H.</given-names></name>
        <name><surname>Hesper</surname><given-names>Ronald</given-names></name>
        <name><surname>Ho</surname><given-names>Luis C.</given-names></name>
        <name><surname>Ho</surname><given-names>Paul</given-names></name>
        <name><surname>Honma</surname><given-names>Mareki</given-names></name>
        <name><surname>Huang</surname><given-names>Chih-Wei L.</given-names></name>
        <name><surname>Huang</surname><given-names>Lei</given-names></name>
        <name><surname>Hughes</surname><given-names>David H.</given-names></name>
        <name><surname>Inoue</surname><given-names>Makoto</given-names></name>
        <name><surname>Issaoun</surname><given-names>Sara</given-names></name>
        <name><surname>James</surname><given-names>David J.</given-names></name>
        <name><surname>Janssen</surname><given-names>Michael</given-names></name>
        <name><surname>Jeter</surname><given-names>Britton</given-names></name>
        <name><surname>Jiang</surname><given-names>Wu</given-names></name>
        <name><surname>Jiménez-Rosales</surname><given-names>Alejandra</given-names></name>
        <name><surname>Johnson</surname><given-names>Michael D.</given-names></name>
        <name><surname>Jorstad</surname><given-names>Svetlana</given-names></name>
        <name><surname>Jung</surname><given-names>Taehyun</given-names></name>
        <name><surname>Karuppusamy</surname><given-names>Ramesh</given-names></name>
        <name><surname>Kawashima</surname><given-names>Tomohisa</given-names></name>
        <name><surname>Keating</surname><given-names>Garrett K.</given-names></name>
        <name><surname>Kettenis</surname><given-names>Mark</given-names></name>
        <name><surname>Kim</surname><given-names>Jae-Young</given-names></name>
        <name><surname>Kim</surname><given-names>Jongsoo</given-names></name>
        <name><surname>Kino</surname><given-names>Motoki</given-names></name>
        <name><surname>Koay</surname><given-names>Jun Yi</given-names></name>
        <name><surname>Koch</surname><given-names>Patrick M.</given-names></name>
        <name><surname>Koyama</surname><given-names>Shoko</given-names></name>
        <name><surname>Kramer</surname><given-names>Michael</given-names></name>
        <name><surname>Kramer</surname><given-names>Carsten</given-names></name>
        <name><surname>Krichbaum</surname><given-names>Thomas P.</given-names></name>
        <name><surname>Kuo</surname><given-names>Cheng-Yu</given-names></name>
        <name><surname>Lee</surname><given-names>Sang-Sung</given-names></name>
        <name><surname>Li</surname><given-names>Yan-Rong</given-names></name>
        <name><surname>Li</surname><given-names>Zhiyuan</given-names></name>
        <name><surname>Lindqvist</surname><given-names>Michael</given-names></name>
        <name><surname>Lico</surname><given-names>Rocco</given-names></name>
        <name><surname>Liu</surname><given-names>Kuo</given-names></name>
        <name><surname>Liuzzo</surname><given-names>Elisabetta</given-names></name>
        <name><surname>Lo</surname><given-names>Wen-Ping</given-names></name>
        <name><surname>Lobanov</surname><given-names>Andrei P.</given-names></name>
        <name><surname>Loinard</surname><given-names>Laurent</given-names></name>
        <name><surname>Lonsdale</surname><given-names>Colin</given-names></name>
        <name><surname>Lu</surname><given-names>Ru-Sen</given-names></name>
        <name><surname>MacDonald</surname><given-names>Nicholas R.</given-names></name>
        <name><surname>Mao</surname><given-names>Jirong</given-names></name>
        <name><surname>Marscher</surname><given-names>Alan P.</given-names></name>
        <name><surname>Martı́-Vidal</surname><given-names>Iván</given-names></name>
        <name><surname>Matsushita</surname><given-names>Satoki</given-names></name>
        <name><surname>Matthews</surname><given-names>Lynn D.</given-names></name>
        <name><surname>Menten</surname><given-names>Karl M.</given-names></name>
        <name><surname>Mizuno</surname><given-names>Yosuke</given-names></name>
        <name><surname>Mizuno</surname><given-names>Izumi</given-names></name>
        <name><surname>Moran</surname><given-names>James M.</given-names></name>
        <name><surname>Moriyama</surname><given-names>Kotaro</given-names></name>
        <name><surname>Moscibrodzka</surname><given-names>Monika</given-names></name>
        <name><surname>Müller</surname><given-names>Cornelia</given-names></name>
        <name><surname>Nagai</surname><given-names>Hiroshi</given-names></name>
        <name><surname>Nagar</surname><given-names>Neil M.</given-names></name>
        <name><surname>Nakamura</surname><given-names>Masanori</given-names></name>
        <name><surname>Narayan</surname><given-names>Ramesh</given-names></name>
        <name><surname>Narayanan</surname><given-names>Gopal</given-names></name>
        <name><surname>Natarajan</surname><given-names>Iniyan</given-names></name>
        <name><surname>Neri</surname><given-names>Roberto</given-names></name>
        <name><surname>Ni</surname><given-names>Chunchong</given-names></name>
        <name><surname>Noutsos</surname><given-names>Aristeidis</given-names></name>
        <name><surname>Okino</surname><given-names>Hiroki</given-names></name>
        <name><surname>Olivares</surname><given-names>Héctor</given-names></name>
        <name><surname>Ortiz-León</surname><given-names>Gisela N.</given-names></name>
        <name><surname>Oyama</surname><given-names>Tomoaki</given-names></name>
        <name><surname>Palumbo</surname><given-names>Daniel C. M.</given-names></name>
        <name><surname>Park</surname><given-names>Jongho</given-names></name>
        <name><surname>Pen</surname><given-names>Ue-Li</given-names></name>
        <name><surname>Pesce</surname><given-names>Dominic W.</given-names></name>
        <name><surname>Piétu</surname><given-names>Vincent</given-names></name>
        <name><surname>Plambeck</surname><given-names>Richard</given-names></name>
        <name><surname>PopStefanija</surname><given-names>Aleksandar</given-names></name>
        <name><surname>Porth</surname><given-names>Oliver</given-names></name>
        <name><surname>Prather</surname><given-names>Ben</given-names></name>
        <name><surname>Ramakrishnan</surname><given-names>Venkatessh</given-names></name>
        <name><surname>Rao</surname><given-names>Ramprasad</given-names></name>
        <name><surname>Rawlings</surname><given-names>Mark G.</given-names></name>
        <name><surname>Raymond</surname><given-names>Alexander W.</given-names></name>
        <name><surname>Rezzolla</surname><given-names>Luciano</given-names></name>
        <name><surname>Ripperda</surname><given-names>Bart</given-names></name>
        <name><surname>Roelofs</surname><given-names>Freek</given-names></name>
        <name><surname>Rogers</surname><given-names>Alan</given-names></name>
        <name><surname>Ros</surname><given-names>Eduardo</given-names></name>
        <name><surname>Rose</surname><given-names>Mel</given-names></name>
        <name><surname>Rottmann</surname><given-names>Helge</given-names></name>
        <name><surname>Ruszczyk</surname><given-names>Chet</given-names></name>
        <name><surname>Ryan</surname><given-names>Benjamin R.</given-names></name>
        <name><surname>Rygl</surname><given-names>Kazi L. J.</given-names></name>
        <name><surname>Sánchez</surname><given-names>Salvador</given-names></name>
        <name><surname>Sánchez-Arguelles</surname><given-names>David</given-names></name>
        <name><surname>Sasada</surname><given-names>Mahito</given-names></name>
        <name><surname>Savolainen</surname><given-names>Tuomas</given-names></name>
        <name><surname>Schloerb</surname><given-names>F. Peter</given-names></name>
        <name><surname>Schuster</surname><given-names>Karl-Friedrich</given-names></name>
        <name><surname>Shao</surname><given-names>Lijing</given-names></name>
        <name><surname>Shen</surname><given-names>Zhiqiang</given-names></name>
        <name><surname>Small</surname><given-names>Des</given-names></name>
        <name><surname>Sohn</surname><given-names>Bong Won</given-names></name>
        <name><surname>SooHoo</surname><given-names>Jason</given-names></name>
        <name><surname>Tazaki</surname><given-names>Fumie</given-names></name>
        <name><surname>Tilanus</surname><given-names>Remo P. J.</given-names></name>
        <name><surname>Titus</surname><given-names>Michael</given-names></name>
        <name><surname>Toma</surname><given-names>Kenji</given-names></name>
        <name><surname>Torne</surname><given-names>Pablo</given-names></name>
        <name><surname>Traianou</surname><given-names>Efthalia</given-names></name>
        <name><surname>Trippe</surname><given-names>Sascha</given-names></name>
        <name><surname>Tsuda</surname><given-names>Shuichiro</given-names></name>
        <name><surname>van Bemmel</surname><given-names>Ilse</given-names></name>
        <name><surname>van Langevelde</surname><given-names>Huib Jan</given-names></name>
        <name><surname>van Rossum</surname><given-names>Daniel R.</given-names></name>
        <name><surname>Wagner</surname><given-names>Jan</given-names></name>
        <name><surname>Wardle</surname><given-names>John</given-names></name>
        <name><surname>Weintroub</surname><given-names>Jonathan</given-names></name>
        <name><surname>Wex</surname><given-names>Norbert</given-names></name>
        <name><surname>Wharton</surname><given-names>Robert</given-names></name>
        <name><surname>Wielgus</surname><given-names>Maciek</given-names></name>
        <name><surname>Wong</surname><given-names>George N.</given-names></name>
        <name><surname>Wu</surname><given-names>Qingwen</given-names></name>
        <name><surname>Yoon</surname><given-names>Doosoo</given-names></name>
        <name><surname>Young</surname><given-names>André</given-names></name>
        <name><surname>Young</surname><given-names>Ken</given-names></name>
        <name><surname>Younsi</surname><given-names>Ziri</given-names></name>
        <name><surname>Yuan</surname><given-names>Feng</given-names></name>
        <name><surname>Yuan</surname><given-names>Ye-Fei</given-names></name>
        <name><surname>Zensus</surname><given-names>J. Anton</given-names></name>
        <name><surname>Zhao</surname><given-names>Guangyao</given-names></name>
        <name><surname>Zhao</surname><given-names>Shan-Shan</given-names></name>
        <name><surname>Zhu</surname><given-names>Ziyan</given-names></name>
        <string-name>Event Horizon Telescope Collaboration</string-name>
      </person-group>
      <article-title>THEMIS: A Parameter Estimation Framework for the Event Horizon Telescope</article-title>
      <source></source>
      <year iso-8601-date="2020-07">2020</year><month>07</month>
      <volume>897</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.3847/1538-4357/ab91a4</pub-id>
      <fpage>139</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
<fn-group>
  <fn id="fn1">
    <label>1</label><p>https://julialang.org</p>
  </fn>
  <fn id="fn2">
    <label>2</label><p>On an Intel i5-7200U chip, this finishes in
    165s</p>
  </fn>
</fn-group>
</back>
</article>
