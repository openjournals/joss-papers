<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6027</article-id>
<article-id pub-id-type="doi">10.21105/joss.06027</article-id>
<title-group>
<article-title><monospace>prospect</monospace>: an R package to link
leaf optical properties with their chemical and structural properties
with the leaf model PROSPECT</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0151-1334</contrib-id>
<name>
<surname>Féret</surname>
<given-names>Jean-Baptiste</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2185-9952</contrib-id>
<name>
<surname>de Boissieu</surname>
<given-names>Florian</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>TETIS, INRAE, AgroParisTech, CIRAD, CNRS, Université
Montpellier, Montpellier, France</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2023-07-17">
<day>17</day>
<month>7</month>
<year>2023</year>
</pub-date>
<volume>9</volume>
<issue>94</issue>
<fpage>6027</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>leaf spectroscopy</kwd>
<kwd>vegetation biophysical properties</kwd>
<kwd>remote sensing</kwd>
<kwd>physical modeling</kwd>
<kwd>iterative optimization</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>PROSPECT simulates optical properties for a leaf, based on its
  content in absorbing constituents, and a structure parameter
  accounting for light scattering. We present
  <monospace>prospect</monospace>, an R package aiming at providing the
  most recent versions of the model, along with inversion routines to
  assess leaf chemistry from optical properties.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>The capacity to measure, map and monitor vegetation traits
  corresponding to biophysical and chemical properties is crucial to
  better understand ecosystem and agrosystem functions, as well as
  carbon, water and energy budgets. At leaf scale, these vegetation
  traits are linked to their optical properties through absorption and
  scattering mechanisms. Spectroscopic techniques provide rapid,
  accurate and non-destructive assessment of leaf chemical composition.
  Physical models aim at simulating optical properties of leaves from
  their chemical composition. Inversion techniques take advantage of
  these models to assess leaf chemical composition from optical
  properties. The model PROSPECT (leaf optical PROperties SPECtra) is
  currently the most popular physical model for the simulation of leaf
  optical properties. PROSPECT simulates leaf directional-hemispherical
  reflectance and transmittance from a combination of chemical
  constituents and their corresponding specific absorption coefficients.
  It uses a simplified representation of leaf structure through the
  generalised plate model
  (<xref alt="Allen et al., 1970" rid="ref-allen1970" ref-type="bibr">Allen
  et al., 1970</xref>) to account for scattering. PROSPECT can be
  coupled with canopy reflectance models to analyze Earth observation
  data. Hence, it is a key component for remote sensing applications
  dedicated to vegetation monitoring.</p>
  <p>Multiple versions have been released since its first version
  (<xref alt="S. Jacquemoud &amp; Baret, 1990" rid="ref-jacquemoud1990" ref-type="bibr">S.
  Jacquemoud &amp; Baret, 1990</xref>). J.-B. Féret et al.
  (<xref alt="2008" rid="ref-feret2008" ref-type="bibr">2008</xref>)
  introduced carotenoids and J.-B. Féret et al.
  (<xref alt="2017" rid="ref-feret2017" ref-type="bibr">2017</xref>)
  introduced anthocyanins, to simulate leaf optical properties from
  juvenile to mature and senescent development stages. J.-B. Féret et
  al. (<xref alt="2021" rid="ref-feret2021" ref-type="bibr">2021</xref>)
  introduced PROSPECT-PRO, the latest version separating dry matter
  constituents into proteins and carbon based constituents. In parallel
  with updated versions of the model, model inversion strategies have
  been introduced to improve the assessment of leaf chemical
  constituents
  (<xref alt="J.-B. Féret et al., 2019" rid="ref-feret2019" ref-type="bibr">J.-B.
  Féret et al., 2019</xref>;
  <xref alt="Spafford et al., 2021" rid="ref-spafford2021" ref-type="bibr">Spafford
  et al., 2021</xref>).</p>
  <p>PROSPECT implementations since J.-B. Féret et al.
  (<xref alt="2008" rid="ref-feret2008" ref-type="bibr">2008</xref>) can
  be found at
  <ext-link ext-link-type="uri" xlink:href="http://teledetection.ipgp.jussieu.fr/prosail/">this
  webpage</ext-link>. This includes distributions in matlab, R and
  fortran programming languages. PROSPECT is coupled with vegetation
  models, including COSINE dedicated to close-range imaging spectroscopy
  (<xref alt="Jay et al., 2016" rid="ref-jay_physically-based_2016" ref-type="bibr">Jay
  et al., 2016</xref>) and SAIL for canopy reflectance modeling Stéphane
  Jacquemoud et al.
  (<xref alt="2009" rid="ref-jacquemoud_prospectU002B_2009" ref-type="bibr">2009</xref>).
  A version of <monospace>prospect</monospace> coupled with SAIL is
  available in the R package
  <ext-link ext-link-type="uri" xlink:href="https://jbferet.gitlab.io/prosail/index.html"><monospace>prosail</monospace></ext-link>.
  Note that PROSPECT and PROSAIL are also available in packages written
  in
  <ext-link ext-link-type="uri" xlink:href="https://github.com/earth-chris/xleaf">python</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="https://github.com/RemoteSensingTools/CanopyOptics.jl">Julia</ext-link>
  and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/ashiklom/rrtm">R</ext-link>.</p>
</sec>
<sec id="overview">
  <title>Overview</title>
  <sec id="prospect-simulation-in-forward-mode">
    <title>PROSPECT simulation in forward mode</title>
    <p>In forward mode, PROSPECT simulates leaf
    directional-hemispherical reflectance and transmittance from a set
    of chemical constituents and a leaf structure parameter identified
    as <monospace>N</monospace>. <monospace>N</monospace> represents the
    number of homogeneous layers introduced in the generalized plate
    model.</p>
    <p>Two versions of PROSPECT are implemented in
    <monospace>prospect</monospace>: PROSPECT-D
    (<xref alt="J.-B. Féret et al., 2017" rid="ref-feret2017" ref-type="bibr">J.-B.
    Féret et al., 2017</xref>) and PROSPECT-PRO
    (<xref alt="J.-B. Féret et al., 2021" rid="ref-feret2021" ref-type="bibr">J.-B.
    Féret et al., 2021</xref>). PROSPECT-4 and 5 are deprecated. Table
    <xref alt="1" rid="tableU003A1">1</xref> lists the input leaf
    chemical constituents and structure parameter for versions D and PRO
    available with the function <monospace>PROSPECT</monospace>.</p>
    <table-wrap>
      <caption>
        <p>Input variables for the two versions of PROSPECT implemented
        in the <monospace>prospect</monospace> package (CHL:
        chlorophylls; CAR: carotenoids; ANT: anthocyanins; BROWN: brown
        pigments; EWT: equivalent water thickness; LMA: leaf mass per
        area; PROT: proteins; CBC: carbon based constituents; N: leaf
        structure
        parameter).<styled-content id="tableU003A1"></styled-content></p>
      </caption>
      <table>
        <thead>
          <tr>
            <th>Version</th>
            <th align="center"><monospace>D</monospace></th>
            <th align="center"><monospace>PRO</monospace></th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>CHL</td>
            <td align="center"><bold>X</bold></td>
            <td align="center"><bold>X</bold></td>
          </tr>
          <tr>
            <td>CAR</td>
            <td align="center"><bold>X</bold></td>
            <td align="center"><bold>X</bold></td>
          </tr>
          <tr>
            <td>ANT</td>
            <td align="center"><bold>X</bold></td>
            <td align="center"><bold>X</bold></td>
          </tr>
          <tr>
            <td>BROWN</td>
            <td align="center"><bold>X</bold></td>
            <td align="center"><bold>X</bold></td>
          </tr>
          <tr>
            <td>EWT</td>
            <td align="center"><bold>X</bold></td>
            <td align="center"><bold>X</bold></td>
          </tr>
          <tr>
            <td>LMA</td>
            <td align="center"><bold>X</bold></td>
            <td align="center"></td>
          </tr>
          <tr>
            <td>PROT</td>
            <td align="center"></td>
            <td align="center"><bold>X</bold></td>
          </tr>
          <tr>
            <td>CBC</td>
            <td align="center"></td>
            <td align="center"><bold>X</bold></td>
          </tr>
          <tr>
            <td>N</td>
            <td align="center"><bold>X</bold></td>
            <td align="center"><bold>X</bold></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>PROSPECT is a relatively simple and computationally efficient
    model. Hence iterative optimization can be considered to invert
    PROSPECT and assess leaf chemistry and structure from their optical
    properties. Iterative optimization aims at minimizing a merit
    function comparing measured and simulated leaf optical properties.
    This procedure is based on the function
    <monospace>fmincon</monospace> included in the package
    <monospace>pracma</monospace>. It usually takes less than 1 second
    to perform PROSPECT inversion.</p>
    <p>Various inversion strategies using iterative optimization are
    described in the literature J.-B. Féret et al.
    (<xref alt="2019" rid="ref-feret2019" ref-type="bibr">2019</xref>).
    These inversion strategies differ either by the merit function, or
    by the selection of specific spectral domains used to retrieve one
    or several leaf biophysical properties, or by the introduction of
    prior information. The default merit function,
    <monospace>Merit_PROSPECT_RMSE</monospace>, corresponds to the root
    mean square of the mean quadratic difference between measured and
    simulated leaf optical properties (reflectance and/or
    transmittance). Alternative merit functions using the same input and
    output variables as <monospace>Merit_PROSPECT_RMSE</monospace> can
    be defined. The online documentation provides an example of
    alternative merit function.</p>
    <p>Table <xref alt="2" rid="tableU003A2">2</xref> details the
    optimal spectral domains to assess leaf chemical constituents from
    their optical properties
    (<xref alt="J.-B. Féret et al., 2019" rid="ref-feret2019" ref-type="bibr">J.-B.
    Féret et al., 2019</xref>;
    <xref alt="Spafford et al., 2021" rid="ref-spafford2021" ref-type="bibr">Spafford
    et al., 2021</xref>).</p>
    <table-wrap>
      <caption>
        <p>Optimal spectral domains to assess vegetation chemical
        constituents from leaf optical
        properties.<styled-content id="tableU003A2"></styled-content></p>
      </caption>
      <table>
        <colgroup>
          <col width="19%" />
          <col width="58%" />
          <col width="23%" />
        </colgroup>
        <thead>
          <tr>
            <th>Constituent</th>
            <th>Optimal spectral domain</th>
            <th align="center">Versions</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>CHL</td>
            <td>700 – 720</td>
            <td align="center"><monospace>D</monospace>,
            <monospace>PRO</monospace></td>
          </tr>
          <tr>
            <td>CAR</td>
            <td>520 – 560</td>
            <td align="center"><monospace>D</monospace>,
            <monospace>PRO</monospace></td>
          </tr>
          <tr>
            <td>ANT</td>
            <td>400 – 800</td>
            <td align="center"><monospace>D</monospace>,
            <monospace>PRO</monospace></td>
          </tr>
          <tr>
            <td>BROWN</td>
            <td>NA</td>
            <td align="center">NA</td>
          </tr>
          <tr>
            <td>EWT</td>
            <td>1700 – 2400</td>
            <td align="center"><monospace>D</monospace>,
            <monospace>PRO</monospace></td>
          </tr>
          <tr>
            <td>LMA</td>
            <td>1700 – 2400</td>
            <td align="center"><monospace>D</monospace></td>
          </tr>
          <tr>
            <td>PROT</td>
            <td>2100 – 2139; 2160 – 2179</td>
            <td align="center"><monospace>PRO</monospace></td>
          </tr>
          <tr>
            <td>CBC</td>
            <td>1480 – 1499; 1560 – 1579; 1760 – 1799; 2040 – 2059; 2120
            – 2139; 2160 – 2239; 2260 – 2279; 2340 – 2359; 2380 –
            2399</td>
            <td align="center"><monospace>PRO</monospace></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
</sec>
<sec id="example-1-running-prospect-in-forward-mode">
  <title>Example 1: running PROSPECT in forward mode</title>
  <p>Input parameters listed in Table
  <xref alt="1" rid="tableU003A1">1</xref> are required to simulate leaf
  optical properties with PROSPECT. Optical constants corresponding to
  specific absorption coefficients and leaf refractive index are
  identical for all leaves, and are defined over the spectral domain
  ranging from 400 nm to 2500 nm. They are accessible through the
  variable <monospace>SpecPROSPECT_FullRange</monospace>, a data frame
  automatically loaded with the package. Multiple functions in the
  package <monospace>prospect</monospace> expect a variable
  <monospace>SpecPROSPECT</monospace> as input.
  <monospace>SpecPROSPECT_FullRange</monospace> is used as default value
  for this input variable. Simulated spectral characteristics, including
  spectral domain, sampling and sensor-specific spectral response can be
  derived from <monospace>SpecPROSPECT_FullRange</monospace>.</p>
  <p>The function <monospace>PROSPECT</monospace> identifies the version
  to be used: PROSPECT-D is used if LMA is defined, while PROSPECT-PRO
  is used if proteins (PROT) and carbon based constituents (CBC) are
  defined. If LMA, PROT and CBC are defined simultaneously, PROSPECT-PRO
  is used and LMA is set to 0. Figure
  <xref alt="[fig:LOP]" rid="figU003ALOP">[fig:LOP]</xref> compares
  simulated leaf optical properties. Here, the differences between
  PROSPECT-D and PROSPECT-PRO are mainly driven by the different value
  set for the <monospace>N</monospace> structure parameter.</p>
  <code language="r script"># Load prospect package
library(prospect)
# Run PROSPECT-D
LRT_D &lt;- PROSPECT(CHL = 45, CAR = 10, ANT = 0.2, 
                  EWT = 0.012, LMA = 0.010, N = 1.3)
# Run PROSPECT-PRO
LRT_PRO &lt;- PROSPECT(CHL = 45, CAR = 10, ANT = 0.2, 
                    EWT = 0.012, PROT = 0.001, CBC = 0.009, N = 1.7)</code>
  <fig>
    <caption><p>Leaf optical properties simulated with PROSPECT-D and
    PROSPECT-PRO. Different values of N were set to highlight
    differences in simulated leaf optics.
    <styled-content id="figU003ALOP"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="media/compare_RT_PROSPECT_PRO_D.png" />
  </fig>
  <p>The spectral domain covered with PROSPECT simulations can be
  adjusted with the function <monospace>FitSpectralData</monospace>,
  which adjust information from
  <monospace>SpecPROSPECT_FullRange</monospace> to a user-defined
  spectral domain.</p>
  <code language="r script"># define spectral bands for Visible / Near InfraRed (VNIR) simulation
wvlRange_VNIR &lt;- seq(400,1000)
# adjust spectral properties used in PROSPECT to VNIR domain
VNIR &lt;- FitSpectralData(lambda = wvlRange_VNIR)
# Run PROSPECT-D in VNIR domain
LRT_VNIR &lt;- PROSPECT(SpecPROSPECT = VNIR$SpecPROSPECT,
                     N = 1.4, CHL = 30, CAR = 6, EWT = 0.02, LMA = 0.01)</code>
</sec>
<sec id="example-2-prospect-inversion-using-iterative-optimization">
  <title>Example 2: PROSPECT inversion using iterative
  optimization</title>
  <p>Inversion is illustated with the experimental database
  <bold>ANGERS</bold>, a publicly available dataset used to calibrate
  PROSPECT. ANGERS can be downloaded from a gitlab repository with the
  function <monospace>download_LeafDB</monospace>.</p>
  <code language="r script">LeafDB &lt;- download_LeafDB(dbName = 'ANGERS')</code>
  <sec id="prospect-inversion-using-the-full-spectral-information">
    <title>PROSPECT inversion using the full spectral
    information</title>
    <p>The spectral domains covered by
    <monospace>SpecPROSPECT</monospace> and the leaf optical properties
    are expected to match when performing inversion over the full
    spectral domain covered by the leaf optical properties. The function
    <monospace>FitSpectralData</monospace> harmonizes the spectral
    domain for <monospace>SpecPROSPECT</monospace> and the leaf optical
    properties. A vector listing the wavelengths of interest can also be
    provided with <monospace>UserDomain</monospace>. The following R
    code adjusts <monospace>SpecPROSPECT</monospace> to the spectral
    domain of the leaf optical properties.</p>
    <code language="r script"># Adjust spectral domain for SpecPROSPECT to fit leaf optical properties
SubData &lt;- FitSpectralData(SpecPROSPECT = SpecPROSPECT_FullRange,
                           Refl = LeafDB$Refl, 
                           Tran = LeafDB$Tran,
                           lambda = LeafDB$lambda, 
                           UserDomain = LeafDB$lambda)</code>
    <p>The main inversion procedure is called with the function
    <monospace>Invert_PROSPECT</monospace>, which minimizes a merit
    function defined by <monospace>Merit_PROSPECT_RMSE</monospace> as
    default option. Part or all parameters from Table
    <xref alt="1" rid="tableU003A1">1</xref> can be assessed. Parameters
    assessed from PROSPECT inversion are defined with an input list,
    <monospace>Parms2Estimate</monospace>. The default parameterization
    of PROSPECT inversion leads to the assessment of all parameters
    listed in Table <xref alt="1" rid="tableU003A1">1</xref> except
    BROWN. BROWN can be assessed during inversion (if working with
    senescent leaves) by setting
    <monospace>Est_Brown_Pigments = TRUE</monospace> as input for
    <monospace>Invert_PROSPECT</monospace>. The value of unassessed
    parameters is set in <monospace>InitValues</monospace>.</p>
    <code language="r script"># Assess all parameters using PROSPECT inversion applied to full spectral data
res_all_WL &lt;- Invert_PROSPECT(SpecPROSPECT = SubData$SpecPROSPECT, 
                              Refl = SubData$Refl,  
                              Tran = SubData$Tran)</code>
  </sec>
  <sec id="prospect-inversion-using-optimal-spectral-domains-for-each-constituent">
    <title>PROSPECT inversion using optimal spectral domains for each
    constituent</title>
    <p>The function <monospace>Invert_PROSPECT_OPT</monospace> performs
    PROSPECT inversion using optimal spectral domains, specific to each
    constituent
    (<xref alt="J.-B. Féret et al., 2019" rid="ref-feret2019" ref-type="bibr">J.-B.
    Féret et al., 2019</xref>;
    <xref alt="Spafford et al., 2021" rid="ref-spafford2021" ref-type="bibr">Spafford
    et al., 2021</xref>). The function automatically adjusts the
    spectral domain of the leaf optical properties provided as
    input.</p>
    <code language="r script"># Assess a set of parameters using PROSPECT inversion with optimal spectral domains
Parms2Estimate &lt;- c('CHL', 'CAR', 'EWT', 'LMA')
res_opt_WL &lt;- Invert_PROSPECT_OPT(lambda = LeafDB$lambda, 
                                  Refl = LeafDB$Refl, 
                                  Tran = LeafDB$Tran
                                  Parms2Estimate = Parms2Estimate)</code>
  </sec>
  <sec id="performances-of-the-two-types-of-inversion-comparison-with-angers-data">
    <title>Performances of the two types of inversion: Comparison with
    ANGERS data</title>
    <p>Figure
    <xref alt="[fig:scatter]" rid="figU003Ascatter">[fig:scatter]</xref>
    compares lab measurements from CHL, CAR, EWT and LMA with values
    assessed from <monospace>Invert_PROSPECT</monospace> and
    <monospace>Invert_PROSPECT_OPT</monospace> using ANGERS.</p>
    <fig>
      <caption><p>Estimation of chlorophyll content, carotenoid content,
      EWT and LMA from PROSPECT inversion applied on the ANGERS data
      set. <monospace>full WL</monospace> corresponds to the inversion
      performed with the full spectral information (function
      <monospace>Invert_PROSPECT</monospace>);
      <monospace>opt WL</monospace> corresponds to the inversion
      performed with the optimal spectral information (function
      <monospace>Invert_PROSPECT_OPT</monospace>).
      <styled-content id="figU003Ascatter"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="media/PROSPECT_Inversions.png" />
    </fig>
  </sec>
</sec>
<sec id="conclusion">
  <title>Conclusion</title>
  <p>We introduce <monospace>prospect</monospace>, an R package
  dedicated to the PROSPECT leaf model. <monospace>prospect</monospace>
  runs various versions of the model in direct mode to simulate
  directional-hemispherical reflectance and transmittance. It also
  includes inversion routines to assess leaf structure and chemical
  constituent content from reflectance and/or transmittance.
  <monospace>prospect</monospace> provides latest advances in terms of
  model version and inversion procedures to the leaf spectroscopy
  community. <monospace>prospect</monospace> is coupled with the canopy
  model SAIL through the R package
  <ext-link ext-link-type="uri" xlink:href="https://jbferet.gitlab.io/prosail/index.html"><monospace>prosail</monospace></ext-link>.
  <monospace>prosail</monospace> is dedicated to applications focusing
  on Earth observation imagery analysis and allows simulation of canopy
  reflectance for multispectral and hyperspectral sensors. Hybrid
  inversions based on physical modeling and machine learning are also
  implemented in <monospace>prosail</monospace> to assess vegetation
  traits at canopy scale from imagery data.</p>
</sec>
<sec id="availability">
  <title>Availability</title>
  <p>prospect is an open-source software package made available under
  the MIT license. Tutorials are available at
  <ext-link ext-link-type="uri" xlink:href="https://jbferet.gitlab.io/prospect/">https://jbferet.gitlab.io/prospect/</ext-link>.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The authors acknowledge financial support from Agence Nationale de
  la Recherche (BioCop project — ANR-17-CE32-0001). We are grateful to
  Stéphane Jacquemoud and Frédéric Baret for the development of the
  initial version of the PROSPECT model. We warmly thank Luc Bidel,
  Christophe François and Gabriel Pavan who collected the ANGERS data
  set. We warmly thank Christopher Anderson, Alexey Shiklomanov and Neha
  K. Nawandar for their review and the constructive comments and
  suggestions they provided, which greatly helped in improving both
  performances and functionalities of this package.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-allen1970">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Allen</surname><given-names>William A.</given-names></name>
        <name><surname>Gausman</surname><given-names>Harold W.</given-names></name>
        <name><surname>Richardson</surname><given-names>Arthur J.</given-names></name>
      </person-group>
      <article-title>Mean effective optical constants of cotton leaves</article-title>
      <source>Journal of the Optical Society of America</source>
      <year iso-8601-date="1970-04">1970</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2016-01-03">2016</year><month>01</month><day>03</day></date-in-citation>
      <volume>60</volume>
      <issue>4</issue>
      <issn>0030-3941</issn>
      <uri>https://www.osapublishing.org/josa/abstract.cfm?uri=josa-60-4-542</uri>
      <pub-id pub-id-type="doi">10.1364/JOSA.60.000542</pub-id>
      <fpage>542</fpage>
      <lpage>547</lpage>
    </element-citation>
  </ref>
  <ref id="ref-colombo_estimation_2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Colombo</surname><given-names>R</given-names></name>
        <name><surname>Meroni</surname><given-names>M</given-names></name>
        <name><surname>Marchesi</surname><given-names>A</given-names></name>
        <name><surname>Busetto</surname><given-names>L</given-names></name>
        <name><surname>Rossini</surname><given-names>M</given-names></name>
        <name><surname>Giardino</surname><given-names>C</given-names></name>
        <name><surname>Panigada</surname><given-names>C</given-names></name>
      </person-group>
      <article-title>Estimation of leaf and canopy water content in poplar plantations by means of hyperspectral indices and inverse modeling</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2008-04">2008</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2017-07-06">2017</year><month>07</month><day>06</day></date-in-citation>
      <volume>112</volume>
      <issue>4</issue>
      <uri>http://linkinghub.elsevier.com/retrieve/pii/S0034425707004257</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2007.09.005</pub-id>
      <fpage>1820</fpage>
      <lpage>1834</lpage>
    </element-citation>
  </ref>
  <ref id="ref-feret2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Féret</surname><given-names>Jean-Baptiste</given-names></name>
        <name><surname>François</surname><given-names>Christophe</given-names></name>
        <name><surname>Asner</surname><given-names>Gregory P.</given-names></name>
        <name><surname>Gitelson</surname><given-names>Anatoly A.</given-names></name>
        <name><surname>Martin</surname><given-names>Roberta E.</given-names></name>
        <name><surname>Bidel</surname><given-names>Luc P. R.</given-names></name>
        <name><surname>Ustin</surname><given-names>Susan L.</given-names></name>
        <name><surname>Maire</surname><given-names>Guerric le</given-names></name>
        <name><surname>Jacquemoud</surname><given-names>Stéphane</given-names></name>
      </person-group>
      <article-title>PROSPECT-4 and 5: Advances in the leaf optical properties model separating photosynthetic pigments</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2008-06">2008</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2016-01-03">2016</year><month>01</month><day>03</day></date-in-citation>
      <volume>112</volume>
      <issue>6</issue>
      <uri>http://linkinghub.elsevier.com/retrieve/pii/S0034425708000813</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2008.02.012</pub-id>
      <fpage>3030</fpage>
      <lpage>3043</lpage>
    </element-citation>
  </ref>
  <ref id="ref-feret2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Féret</surname><given-names>J.-B.</given-names></name>
        <name><surname>Gitelson</surname><given-names>A. A.</given-names></name>
        <name><surname>Noble</surname><given-names>S. D.</given-names></name>
        <name><surname>Jacquemoud</surname><given-names>S.</given-names></name>
      </person-group>
      <article-title>PROSPECT-D: Towards modeling leaf optical properties through a complete lifecycle</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2017-05">2017</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2017-03-17">2017</year><month>03</month><day>17</day></date-in-citation>
      <volume>193</volume>
      <uri>http://linkinghub.elsevier.com/retrieve/pii/S0034425717300962</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2017.03.004</pub-id>
      <fpage>204</fpage>
      <lpage>215</lpage>
    </element-citation>
  </ref>
  <ref id="ref-feret2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Féret</surname><given-names>J.-B.</given-names></name>
        <name><surname>Le Maire</surname><given-names>G.</given-names></name>
        <name><surname>Jay</surname><given-names>S.</given-names></name>
        <name><surname>Berveiller</surname><given-names>D.</given-names></name>
        <name><surname>Bendoula</surname><given-names>R.</given-names></name>
        <name><surname>Hmimina</surname><given-names>G.</given-names></name>
        <name><surname>Cheraiet</surname><given-names>A.</given-names></name>
        <name><surname>Oliveira</surname><given-names>J. C.</given-names></name>
        <name><surname>Ponzoni</surname><given-names>F. J.</given-names></name>
        <name><surname>Solanki</surname><given-names>T.</given-names></name>
        <name><surname>De Boissieu</surname><given-names>F.</given-names></name>
        <name><surname>Chave</surname><given-names>J.</given-names></name>
        <name><surname>Nouvellon</surname><given-names>Y.</given-names></name>
        <name><surname>Porcar-Castell</surname><given-names>A.</given-names></name>
        <name><surname>Proisy</surname><given-names>C.</given-names></name>
        <name><surname>Soudani</surname><given-names>K.</given-names></name>
        <name><surname>Gastellu-Etchegorry</surname><given-names>J.-P.</given-names></name>
        <name><surname>Lefèvre-Fonollosa</surname><given-names>M.-J.</given-names></name>
      </person-group>
      <article-title>Estimating leaf mass per area and equivalent water thickness based on leaf optical properties: Potential and limitations of physical modeling and machine learning</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2019-09">2019</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-04-25">2023</year><month>04</month><day>25</day></date-in-citation>
      <volume>231</volume>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0034425718305030</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2018.11.002</pub-id>
      <fpage>110959</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-feret2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Féret</surname><given-names>Jean-Baptiste</given-names></name>
        <name><surname>Berger</surname><given-names>Katja</given-names></name>
        <name><surname>Boissieu</surname><given-names>Florian de</given-names></name>
        <name><surname>Malenovský</surname><given-names>Zbyněk</given-names></name>
      </person-group>
      <article-title>PROSPECT-PRO for estimating content of nitrogen-containing leaf proteins and other carbon-based constituents</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2021-01">2021</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2020-11-16">2020</year><month>11</month><day>16</day></date-in-citation>
      <volume>252</volume>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0034425720305460</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2020.112173</pub-id>
      <fpage>112173</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-jacquemoud1990">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jacquemoud</surname><given-names>S.</given-names></name>
        <name><surname>Baret</surname><given-names>F.</given-names></name>
      </person-group>
      <article-title>PROSPECT: A model of leaf optical properties spectra</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="1990-11">1990</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2016-01-03">2016</year><month>01</month><day>03</day></date-in-citation>
      <volume>34</volume>
      <issue>2</issue>
      <uri>http://linkinghub.elsevier.com/retrieve/pii/003442579090100Z</uri>
      <pub-id pub-id-type="doi">10.1016/0034-4257(90)90100-Z</pub-id>
      <fpage>75</fpage>
      <lpage>91</lpage>
    </element-citation>
  </ref>
  <ref id="ref-jacquemoud_prospectU002B_2009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jacquemoud</surname><given-names>Stéphane</given-names></name>
        <name><surname>Verhoef</surname><given-names>Wout</given-names></name>
        <name><surname>Baret</surname><given-names>Frédéric</given-names></name>
        <name><surname>Bacour</surname><given-names>Cédric</given-names></name>
        <name><surname>Zarco-Tejada</surname><given-names>Pablo J.</given-names></name>
        <name><surname>Asner</surname><given-names>Gregory P.</given-names></name>
        <name><surname>François</surname><given-names>Christophe</given-names></name>
        <name><surname>Ustin</surname><given-names>Susan L.</given-names></name>
      </person-group>
      <article-title>PROSPECT+ SAIL models: A review of use for vegetation characterization</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2009">2009</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2016-01-03">2016</year><month>01</month><day>03</day></date-in-citation>
      <volume>113</volume>
      <uri>http://www.sciencedirect.com/science/article/pii/S0034425709000765</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2008.01.026</pub-id>
      <fpage>S56</fpage>
      <lpage>S66</lpage>
    </element-citation>
  </ref>
  <ref id="ref-jay_physically-based_2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jay</surname><given-names>Sylvain</given-names></name>
        <name><surname>Bendoula</surname><given-names>Ryad</given-names></name>
        <name><surname>Hadoux</surname><given-names>Xavier</given-names></name>
        <name><surname>Féret</surname><given-names>Jean-Baptiste</given-names></name>
        <name><surname>Gorretta</surname><given-names>Nathalie</given-names></name>
      </person-group>
      <article-title>A physically-based model for retrieving foliar biochemistry and leaf orientation using close-range imaging spectroscopy</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2016-05">2016</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2016-06-14">2016</year><month>06</month><day>14</day></date-in-citation>
      <volume>177</volume>
      <uri>http://linkinghub.elsevier.com/retrieve/pii/S0034425716300566</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2016.02.029</pub-id>
      <fpage>220</fpage>
      <lpage>236</lpage>
    </element-citation>
  </ref>
  <ref id="ref-li_retrieval_2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Li</surname><given-names>Pingheng</given-names></name>
        <name><surname>Wang</surname><given-names>Quan</given-names></name>
      </person-group>
      <article-title>Retrieval of leaf biochemical parameters using PROSPECT inversion: A new approach for alleviating ill-posed problems</article-title>
      <source>IEEE Transactions on Geoscience and Remote Sensing,</source>
      <year iso-8601-date="2011">2011</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2016-01-03">2016</year><month>01</month><day>03</day></date-in-citation>
      <volume>49</volume>
      <issue>7</issue>
      <uri>http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=5734840</uri>
      <pub-id pub-id-type="doi">10.1109/TGRS.2011.2109390</pub-id>
      <fpage>2499</fpage>
      <lpage>2506</lpage>
    </element-citation>
  </ref>
  <ref id="ref-spafford2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Spafford</surname><given-names>Lynsay</given-names></name>
        <name><surname>Maire</surname><given-names>Guerric le</given-names></name>
        <name><surname>MacDougall</surname><given-names>Andrew</given-names></name>
        <name><surname>Boissieu</surname><given-names>Florian de</given-names></name>
        <name><surname>Féret</surname><given-names>Jean-Baptiste</given-names></name>
      </person-group>
      <article-title>Spectral subdomains and prior estimation of leaf structure improves PROSPECT inversion on reflectance or transmittance alone</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2021-01">2021</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2020-11-16">2020</year><month>11</month><day>16</day></date-in-citation>
      <volume>252</volume>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0034425720305496</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2020.112176</pub-id>
      <fpage>112176</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-verhoef_unified_2007">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Verhoef</surname><given-names>Wout</given-names></name>
        <name><surname>Jia</surname><given-names>Li</given-names></name>
        <name><surname>Xiao</surname><given-names>Qing</given-names></name>
        <name><surname>Su</surname><given-names>Z.</given-names></name>
      </person-group>
      <article-title>Unified optical-thermal four-stream radiative transfer theory for homogeneous vegetation canopies</article-title>
      <source>IEEE Transactions on Geoscience and Remote Sensing</source>
      <year iso-8601-date="2007-06">2007</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2016-01-30">2016</year><month>01</month><day>30</day></date-in-citation>
      <volume>45</volume>
      <issue>6</issue>
      <issn>0196-2892</issn>
      <uri>http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=4215093</uri>
      <pub-id pub-id-type="doi">10.1109/TGRS.2007.895844</pub-id>
      <fpage>1808</fpage>
      <lpage>1822</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
