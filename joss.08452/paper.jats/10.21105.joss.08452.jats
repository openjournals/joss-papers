<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8452</article-id>
<article-id pub-id-type="doi">10.21105/joss.08452</article-id>
<title-group>
<article-title>ATMOS-BUD: A Comprehensive Python Tool for Analyzing
Heat, Vorticity and Water Budgets on the Atmosphere</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4121-7583</contrib-id>
<name>
<surname>de Souza</surname>
<given-names>Danilo Couto</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4051-2962</contrib-id>
<name>
<surname>da Silva Dias</surname>
<given-names>Pedro Leite</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8795-1700</contrib-id>
<name>
<surname>Hallak</surname>
<given-names>Ricardo</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Universidade de São Paulo (USP), Instituto de Astronomia,
Geofísica e Ciências Atmosféricas (IAG), São Paulo, Brazil
&amp;</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Climate Risk Initiative, IRB(re), Rio de Janeiro,
Brazil</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-04-22">
<day>22</day>
<month>4</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>113</issue>
<fpage>8452</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>atmospheric diagnostics</kwd>
<kwd>quasi-geostrophic</kwd>
<kwd>meteorology</kwd>
<kwd>climate</kwd>
<kwd>python</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>ATMOS-BUD</monospace> is a flexible and open-source
  Python package designed to compute and visualize the main components
  of atmospheric heat, vorticity, and water budgets in pressure
  coordinates. It provides a structured and modular pipeline to process
  meteorological datasets, particularly reanalyses such as ERA5 or model
  outputs, and compute budget residuals using a quasi-geostrophic
  framework. The tool supports both fixed and moving computational
  domains (Eulerian and Semi-Lagrangian frameworks), allowing users to
  diagnose and track synoptic and mesoscale systems such as cyclones.
  <monospace>ATMOS-BUD</monospace> facilitates both operational
  diagnostics and academic research, offering clearly documented
  routines and outputs in CSV, NetCDF, and figure formats.</p>
</sec>
<sec id="background">
  <title>Background</title>
  <p>The analysis of heat, vorticity, and water budgets is a powerful
  tool for diagnosing the dynamical and thermodynamical forcings that
  drive the development of various atmospheric systems
  (<xref alt="Shu et al., 2022" rid="ref-shu2022vorticity" ref-type="bibr">Shu
  et al., 2022</xref>;
  <xref alt="Sun et al., 2024" rid="ref-sun2024comparison" ref-type="bibr">Sun
  et al., 2024</xref>), particularly cyclones, whether extratropical
  (<xref alt="Liou &amp; Elsberry, 1987" rid="ref-liou1987heat" ref-type="bibr">Liou
  &amp; Elsberry, 1987</xref>), subtropical
  (<xref alt="Dutra et al., 2017" rid="ref-dutra2017structure" ref-type="bibr">Dutra
  et al., 2017</xref>), or tropical
  (<xref alt="Raymond &amp; López Carrillo, 2011" rid="ref-raymond2011vorticity" ref-type="bibr">Raymond
  &amp; López Carrillo, 2011</xref>). The heat budget describes the
  local temperature tendency as the result of three main processes:
  horizontal advection, adiabatic heating or cooling due to vertical
  motion, and diabatic heating processes such as latent heat release.
  The latter is especially important, as it is associated with
  convection — a key process that fuels the development of systems such
  as tropical cyclones. In the vorticity budget, the local change in
  relative vorticity is governed by several mechanisms: horizontal and
  vertical advection, advection of planetary vorticity, stretching due
  to mass divergence or convergence, tilting of horizontal vorticity
  into the vertical, and frictional effects. Lastly, in the water vapor
  budget, the local change in column-integrated moisture is primarily
  controlled by two processes: horizontal moisture flux convergence, and
  net sources or sinks due to surface evaporation and precipitation.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p><monospace>ATMOS-BUD</monospace> is a Python tool designed to
  compute heat, vorticity, and water budgets for limited atmospheric
  regions. It supports both Eulerian and Semi-Lagrangian frameworks. In
  the former, the user specifies a fixed computational domain for budget
  computations; in the latter, the domain is updated at each time step
  to follow the center of an atmospheric system of interest (e.g., a
  cyclone). This methodology mirrors that adopted in Souza et al.
  (<xref alt="2024" rid="ref-de2024lorenzcycletoolkit" ref-type="bibr">2024</xref>)
  (see their Figure 2). Additionally, computations can be performed
  using an interactive framework, allowing the user to manually define
  the domain for each time step. The program outputs budget terms
  averaged over the selected domain and, for moisture variables,
  provides both layerwise and vertically integrated diagnostics.</p>
  <p><monospace>ATMOS-BUD</monospace> supports academic research,
  operational diagnostics, and case studies in synoptic meteorology. It
  has also been used for several years in the graduate-level courses
  <italic>Synoptic Meteorology III</italic> and <italic>Tropical
  Meteorology</italic> at the Department of Atmospheric Sciences at the
  University of São Paulo. The tool was initially developed using the
  Grid Analysis and Display System (GrADS)
  (<xref alt="Doty &amp; Kinter, 1995" rid="ref-doty1995geophysical" ref-type="bibr">Doty
  &amp; Kinter, 1995</xref>), but over the past three years, it has been
  rewritten in Python to meet pedagogical needs and facilitate
  integration into scientific workflows and publications.</p>
</sec>
<sec id="external-libraries-used">
  <title>External Libraries Used</title>
  <p>The input file must be in NetCDF format
  (<xref alt="Rew &amp; Davis, 1990" rid="ref-rew1990netcdf" ref-type="bibr">Rew
  &amp; Davis, 1990</xref>), which is processed using
  <monospace>xarray</monospace>
  (<xref alt="Hoyer &amp; Hamman, 2017" rid="ref-hoyer2017xarray" ref-type="bibr">Hoyer
  &amp; Hamman, 2017</xref>) and <monospace>dask</monospace>
  (<xref alt="Daniel, 2019" rid="ref-daniel2019data" ref-type="bibr">Daniel,
  2019</xref>) to support efficient memory management and scalable
  processing of large datasets. Results are managed with
  <monospace>pandas</monospace>
  (<xref alt="Reback et al., 2020" rid="ref-reback2020pandas" ref-type="bibr">Reback
  et al., 2020</xref>) for tabular manipulation and exported in CSV
  format. Numerical computations are performed using
  <monospace>numpy</monospace>
  (<xref alt="Harris et al., 2020" rid="ref-harris2020array" ref-type="bibr">Harris
  et al., 2020</xref>), while <monospace>metpy</monospace>
  (<xref alt="May et al., 2022" rid="ref-may2022metpy" ref-type="bibr">May
  et al., 2022</xref>) is used to handle meteorological constants,
  units, and atmospheric diagnostics.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This study was partly financed by the Coordenação de
  Aperfeiçoamento de Pessoal de Nível Superior – Brasil (CAPES) under
  Finance Code 001. The authors would like to acknowledge the Laboratory
  of Applied Meteorology for Regional Meteorological Systems (MASTER)
  for the data processing infrastructure. Special thanks are extended to
  Jean Peres and Djalma Vieira for their invaluable technical assistance
  and support in the laboratory.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-liou1987heat">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Liou</surname><given-names>Chi-Sann</given-names></name>
        <name><surname>Elsberry</surname><given-names>Russel L</given-names></name>
      </person-group>
      <article-title>Heat budgets of analyses and forecasts of an explosively deepening maritime cyclone</article-title>
      <source>Monthly weather review</source>
      <year iso-8601-date="1987">1987</year>
      <volume>115</volume>
      <issue>9</issue>
      <pub-id pub-id-type="doi">10.1175/1520-0493(1987)115&lt;1809:HBOAAF&gt;2.0.CO;2</pub-id>
      <fpage>1809</fpage>
      <lpage>1824</lpage>
    </element-citation>
  </ref>
  <ref id="ref-rew1990netcdf">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rew</surname><given-names>Russ</given-names></name>
        <name><surname>Davis</surname><given-names>Glenn</given-names></name>
      </person-group>
      <article-title>NetCDF: An interface for scientific data access</article-title>
      <source>IEEE computer graphics and applications</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="1990">1990</year>
      <volume>10</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1109/38.56302</pub-id>
      <fpage>76</fpage>
      <lpage>82</lpage>
    </element-citation>
  </ref>
  <ref id="ref-doty1995geophysical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Doty</surname><given-names>Brian E</given-names></name>
        <name><surname>Kinter</surname><given-names>JLI</given-names></name>
      </person-group>
      <article-title>Geophysical data analysis and visualization using the grid analysis and display system</article-title>
      <source>National Aeronautics and Space Administration, Washington, DC, USA</source>
      <year iso-8601-date="1995">1995</year>
    </element-citation>
  </ref>
  <ref id="ref-raymond2011vorticity">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Raymond</surname><given-names>DJ</given-names></name>
        <name><surname>López Carrillo</surname><given-names>C</given-names></name>
      </person-group>
      <article-title>The vorticity budget of developing typhoon nuri (2008)</article-title>
      <source>Atmospheric Chemistry and Physics</source>
      <publisher-name>Copernicus Publications Göttingen, Germany</publisher-name>
      <year iso-8601-date="2011">2011</year>
      <volume>11</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.5194/acp-11-147-2011</pub-id>
      <fpage>147</fpage>
      <lpage>163</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dutra2017structure">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dutra</surname><given-names>Lı́via Márcia Mosso</given-names></name>
        <name><surname>Rocha</surname><given-names>Rosmeri Porfı́rio da</given-names></name>
        <name><surname>Lee</surname><given-names>Robert William</given-names></name>
        <name><surname>Peres</surname><given-names>Jean Rafael Romão</given-names></name>
        <name><surname>Camargo</surname><given-names>Ricardo de</given-names></name>
      </person-group>
      <article-title>Structure and evolution of subtropical cyclone anita as evaluated by heat and vorticity budgets</article-title>
      <source>Quarterly Journal of the Royal Meteorological Society</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>143</volume>
      <issue>704</issue>
      <pub-id pub-id-type="doi">10.1002/qj.3024</pub-id>
      <fpage>1539</fpage>
      <lpage>1553</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hoyer2017xarray">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hoyer</surname><given-names>Stephan</given-names></name>
        <name><surname>Hamman</surname><given-names>Joe</given-names></name>
      </person-group>
      <article-title>xarray: ND Labeled Arrays and Datasets in Python</article-title>
      <source>Journal of Open Research Software</source>
      <year iso-8601-date="2017">2017</year>
      <volume>5</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.5334/jors.148</pub-id>
      <fpage>10</fpage>
      <lpage>10</lpage>
    </element-citation>
  </ref>
  <ref id="ref-daniel2019data">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Daniel</surname><given-names>Jesse</given-names></name>
      </person-group>
      <source>Data Science with Python and Dask</source>
      <publisher-name>Simon; Schuster</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <isbn>9781638353546</isbn>
    </element-citation>
  </ref>
  <ref id="ref-harris2020array">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harris</surname><given-names>Charles R</given-names></name>
        <name><surname>Millman</surname><given-names>K Jarrod</given-names></name>
        <name><surname>Van Der Walt</surname><given-names>Stéfan J</given-names></name>
        <name><surname>Gommers</surname><given-names>Ralf</given-names></name>
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>Cournapeau</surname><given-names>David</given-names></name>
        <name><surname>Wieser</surname><given-names>Eric</given-names></name>
        <name><surname>Taylor</surname><given-names>Julian</given-names></name>
        <name><surname>Berg</surname><given-names>Sebastian</given-names></name>
        <name><surname>Smith</surname><given-names>Nathaniel J</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Array Programming with NumPy</article-title>
      <source>Nature</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>585</volume>
      <issue>7825</issue>
      <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
      <fpage>357</fpage>
      <lpage>362</lpage>
    </element-citation>
  </ref>
  <ref id="ref-reback2020pandas">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Reback</surname><given-names>Jeff</given-names></name>
        <name><surname>McKinney</surname><given-names>Wes</given-names></name>
        <name><surname>Van Den Bossche</surname><given-names>Joris</given-names></name>
        <name><surname>Augspurger</surname><given-names>Tom</given-names></name>
        <name><surname>Cloud</surname><given-names>Phillip</given-names></name>
        <name><surname>Klein</surname><given-names>Adam</given-names></name>
        <name><surname>Hawkins</surname><given-names>Simon</given-names></name>
        <name><surname>Roeschke</surname><given-names>Matthew</given-names></name>
        <name><surname>Tratner</surname><given-names>Jeff</given-names></name>
        <name><surname>She</surname><given-names>Chang</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Pandas-dev/pandas: Pandas 1.0. 5</article-title>
      <source>Zenodo</source>
      <year iso-8601-date="2020">2020</year>
      <pub-id pub-id-type="doi">10.5281/zenodo.3509134</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-shu2022vorticity">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Shu</surname><given-names>Yu</given-names></name>
        <name><surname>Sun</surname><given-names>Jisong</given-names></name>
        <name><surname>Jin</surname><given-names>Chenlu</given-names></name>
        <name><surname>Zhuang</surname><given-names>Bingliang</given-names></name>
      </person-group>
      <article-title>Vorticity budget and formation mechanisms of a mesoscale convective vortex in a heavy-rainstorm episode</article-title>
      <source>Atmosphere</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>13</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.3390/atmos13040556</pub-id>
      <fpage>556</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-may2022metpy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>May</surname><given-names>Ryan M</given-names></name>
        <name><surname>Goebbert</surname><given-names>Kevin H</given-names></name>
        <name><surname>Thielen</surname><given-names>Jonathan E</given-names></name>
        <name><surname>Leeman</surname><given-names>John R</given-names></name>
        <name><surname>Camron</surname><given-names>M Drew</given-names></name>
        <name><surname>Bruick</surname><given-names>Zachary</given-names></name>
        <name><surname>Bruning</surname><given-names>Eric C</given-names></name>
        <name><surname>Manser</surname><given-names>Russell P</given-names></name>
        <name><surname>Arms</surname><given-names>Sean C</given-names></name>
        <name><surname>Marsh</surname><given-names>Patrick T</given-names></name>
      </person-group>
      <article-title>MetPy: A Meteorological Python Library for Data Analysis and Visualization</article-title>
      <source>Bulletin of the American Meteorological Society</source>
      <year iso-8601-date="2022">2022</year>
      <volume>103</volume>
      <issue>10</issue>
      <pub-id pub-id-type="doi">10.1175/BAMS-D-21-0125.1</pub-id>
      <fpage>E2273</fpage>
      <lpage>E2284</lpage>
    </element-citation>
  </ref>
  <ref id="ref-sun2024comparison">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sun</surname><given-names>Zhihong</given-names></name>
        <name><surname>Gao</surname><given-names>Si</given-names></name>
        <name><surname>Jian</surname><given-names>Maoqiu</given-names></name>
      </person-group>
      <article-title>Comparison of the water vapor budget evolution of developing and non-developing disturbances over the western north pacific</article-title>
      <source>Remote Sensing</source>
      <publisher-name>MDPI</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>16</volume>
      <issue>13</issue>
      <pub-id pub-id-type="doi">10.3390/rs16132396</pub-id>
      <fpage>2396</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-de2024lorenzcycletoolkit">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Souza</surname><given-names>Danilo Couto de</given-names></name>
        <name><surname>Dias</surname><given-names>Pedro Leite Silva da</given-names></name>
        <name><surname>Silva</surname><given-names>Matheus Bonjour Laviola da</given-names></name>
        <name><surname>Camargo</surname><given-names>Ricardo de</given-names></name>
      </person-group>
      <article-title>LorenzCycleToolkit: A comprehensive python tool for analyzing atmospheric energy cycles</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2024">2024</year>
      <volume>9</volume>
      <issue>101</issue>
      <pub-id pub-id-type="doi">10.21105/joss.07139</pub-id>
      <fpage>7139</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
