<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8207</article-id>
<article-id pub-id-type="doi">10.21105/joss.08207</article-id>
<title-group>
<article-title>hsi-wizard: A magical open-source Python package for
medical hyperspectral imaging applications</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4821-8549</contrib-id>
<name>
<surname>Wühler</surname>
<given-names>Felix</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3382-7608</contrib-id>
<name>
<surname>Rädle</surname>
<given-names>Matthias</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>CeMOS Research and Transfer Center, University of Applied
Science Mannheim, Germany</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-11-18">
<day>18</day>
<month>11</month>
<year>2024</year>
</pub-date>
<volume>10</volume>
<issue>113</issue>
<fpage>8207</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>hyperspectral imaging</kwd>
<kwd>DataCubes</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>hsi-wizard</monospace> is an open-source Python package
  designed for processing, analysing, and visualising hyperspectral
  datasets, primarily in medical applications. Hyperspectral data refers
  to images where each pixel contains multiple intensity values at
  different wavelengths, with the number of spectral bands ranging from
  only a few to well over a thousand. These datasets vary in resolution
  and structure, making analysis difficult due to inconsistent formats
  and limited reproducibility. To address these challenges,
  <monospace>hsi-wizard</monospace> provides a standardised data
  representation and analysis protocols that enhance reproducibility.
  The package features the <monospace>DataCube</monospace>, a
  standardised class for representing hyperspectral data, which
  simplifies data manipulation compared to traditional array-based tools
  like NumPy. The <monospace>DataCube</monospace> includes built-in
  methods tailored specifically for hyperspectral data, facilitating
  quicker exploration and reducing complexity for users.</p>
  <p>A notable feature of the <monospace>DataCube</monospace> class is
  its protocol functionality, which records the methods used from the
  <monospace>hsi-wizard</monospace> library. This protocol acts as a
  reusable template for other datasets, allowing researchers, including
  those without programming experience, to replicate analyses accurately
  and effortlessly. Additionally, <monospace>hsi-wizard</monospace>
  allows users to merge <monospace>DataCubes</monospace> due to its
  standardised representation. This capability enables researchers, for
  example, to easily combine near-infrared (IR) and Raman spectroscopy
  datasets, resulting in more comprehensive and detailed tissue
  analyses. Such multimodal analysis simplifies the process and provides
  greater insights from combined data.</p>
  <p>Overall, <monospace>hsi-wizard</monospace> streamlines the workflow
  for processing, analysing, and visualising hyperspectral data. It
  caters to both beginners and experts. Students can utilise
  straightforward methods for educational purposes, while researchers
  can leverage advanced functions for professional studies, ensuring
  that results are reproducible and transparently documented.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Hyperspectral imaging (HSI) allows for an in-depth analysis of the
  electromagnetic spectrum across multiple wavelengths for each pixel in
  an image. Initially developed for NASA applications, HSI is now
  applied in various fields, including medicine, agriculture,
  environmental monitoring and more
  (<xref alt="Bhargava et al., 2024" rid="ref-Bhargava" ref-type="bibr">Bhargava
  et al., 2024</xref>). In medical research, for example, HSI is
  instrumental in distinguishing healthy tissue from cancerous areas or
  detecting early-stage diseases.</p>
  <p>The evolution of these fields has led to a variety of methods for
  acquiring hyperspectral data, encompassing different measurement
  techniques such as reflection, transmission, and fluorescence, as well
  as varying wavelength ranges (ultraviolet, visible, infrared) and
  scanning methods (e.g., point scanning, line scanning, Fourier
  transform infrared imaging (FTIR))
  (<xref alt="Lu &amp; Fei, 2014" rid="ref-Guolan" ref-type="bibr">Lu
  &amp; Fei, 2014</xref>). Consequently, datasets exhibit diverse
  formats, resolutions, and spectral ranges, which complicates analysis
  workflows and can hinder efficiency and reproducibility.</p>
  <p>The <monospace>hsi-wizard</monospace> package addresses these
  challenges by standardising data representation through its
  <monospace>DataCube</monospace> class, enabling consistent analysis
  across diverse hyperspectral datasets and enabling data fusion across
  different scanning processes. Unlike traditional software tools like
  NumPy or specialised applications such as ENVI or SPy, which often
  require extensive programming or manual adjustments to manage
  variability, <monospace>hsi-wizard</monospace> streamlines data
  handling and integrates multimodal datasets seamlessly. It also
  promotes reproducibility through automated protocol logging.</p>
  <p>Moreover, the extensibility of <monospace>hsi-wizard</monospace>
  allows users to incorporate new analysis methods or customise existing
  workflows easily, ensuring adaptability to evolving research needs.
  This flexibility guarantees that <monospace>hsi-wizard</monospace>
  remains relevant across various research scenarios, significantly
  reducing barriers to hyperspectral data analysis while promoting
  transparency and reproducibility in scientific research.</p>
  <sec id="comparison-with-existing-tools">
    <title>Comparison with Existing Tools</title>
    <p>A variety of open-source and commercial tools exist for
    hyperspectral imaging, but most are tailored to geospatial tasks,
    low-level preprocessing, or GUI-driven workflows. Libraries like
    PySptools and SPy focus on raster I/O and classification for remote
    sensing, while tools such as HyDe provide GPU-based denoising but
    lack biomedical integration. Commercial options like ENVI or
    Spectronon offer user-friendly interfaces but are often tied to
    hardware and limited in scripting or batch automation.</p>
    <p>In contrast, <monospace>hsi-wizard</monospace> is designed
    specifically for biomedical use. It supports multimodal fusion,
    protocol logging, and scripting within a unified Python environment.
    It handles formats like ENVI, CSV, NRRD, and TDMS and integrates
    cleanly into programmatic workflows. Unlike GUI-centric tools,
    hsi-wizard enables reproducible, automated processing for diverse
    spectral datasets, filling a gap between algorithm libraries and
    rigid GUI systems.</p>
    <p>This makes <monospace>hsi-wizard</monospace> especially suitable
    for clinical imaging and research, combining flexibility,
    transparency, and domain-specific functionality in one open-source
    tool.</p>
  </sec>
</sec>
<sec id="example-usage">
  <title>Example Usage</title>
  <p>This snippet demonstrates the use of the
  <monospace>hsi-wizard</monospace> package for processing and
  visualising hyperspectral data, using a real sample from the
  HeiPorSPECTRAL dataset
  (<xref alt="Studier‑Fischer et al., 2023" rid="ref-Studier-Fischer2023" ref-type="bibr">Studier‑Fischer
  et al., 2023</xref>). The focus is on the <italic>spleen</italic>
  example (P086#2021_04_15_09_22_02). <monospace>hsi-wizard</monospace>
  handles the entire pipeline: from reading the raw
  <monospace>.dat</monospace> hyperspectral
  <monospace>DataCube</monospace>, managing metadata like wavelengths,
  to applying PCA and agglomerative spatial clustering. It enables
  concise and structured exploration of spectral information in
  biomedical imaging. The full example is visible in the
  documentation.</p>
  <preformat>import numpy as np
import wizard
from wizard._processing.cluster import (
    pca, spatial_agglomerative_clustering, smooth_cluster
)

# Define Custom reader
def read_spectral_cube(path) -&gt; wizard.DataCube:
    shape = np.fromfile(path, dtype=&quot;&gt;i&quot;, count=3)
    cube = np.fromfile(path, dtype=&quot;&gt;f&quot;, offset=12).reshape(*shape)
    cube = np.swapaxes(np.flip(cube, axis=1), 0, 1).astype(np.float32)
    wavelengths = np.linspace(500, 1000, cube.shape[2], dtype='int')
    return wizard.DataCube(
        cube.transpose(2, 0, 1),
        wavelengths=wavelengths,
        notation='nm',
        name='HeiProSpectral',
    )

# Initialise dc and read data
dc = wizard.DataCube()
dc.set_custom_reader(read_spectral_cube)
dc.custom_read('2021_04_15_09_22_02_SpecCube.dat')

# Inspect Data
wizard.plotter(dc)</preformat>
  <fig>
    <caption><p>ROI-based spectral analysis with the interactive
    plotting interface of <monospace>hsi-wizard</monospace>. The left
    panel shows selected tissue regions at 696 nm, while the right panel
    displays corresponding normalised spectra of the ROIs.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="wizard_output.png" />
  </fig>
  <preformat># Clustering
dc_pca = pca(dc, n_components=10)
agglo = spatial_agglomerative_clustering(dc_pca, n_clusters=5)
agglo = smooth_cluster(agglo, n_iter=10, sigma=0.5)</preformat>
  <fig>
    <caption><p>Comparison between manual annotation (top-right) from
    Studier‑Fischer et al.
    (<xref alt="2023" rid="ref-Studier-Fischer2023" ref-type="bibr">2023</xref>)
    and automated segmentation (bottom-left) using spatial agglomerative
    clustering (k = 5) on PCA-reduced hyperspectral data. The original
    RGB image (top-left) and the resulting cluster map (bottom-right)
    provide visual context and output structure.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="Example_output.png" />
  </fig>
</sec>
<sec id="future-work">
  <title>Future Work</title>
  <p>Additional publications are currently in preparation, focusing on
  workflows for merging complementary datasets in more detail. The
  development of <monospace>hsi-wizard</monospace> is ongoing, with
  future goals that include expanding support for additional data
  formats and integrating advanced data analytics. We encourage
  feedback, contributions, and ideas from the community. All versions of
  <monospace>hsi-wizard</monospace> are available on the Python Package
  Index (PyPI) or on GitHub
  (<xref alt="Wuehler, 2025" rid="ref-github_wizard" ref-type="bibr">Wuehler,
  2025</xref>).</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The development of <monospace>hsi-wizard</monospace> was funded by
  the CeMOS Research &amp; Transfer Center and the Technical University
  of Applied Sciences Mannheim. The software was developed based on
  practical requirements and datasets provided by our research group:
  Kümmel
  (<xref alt="Kuemmel et al., 2021" rid="ref-kummel" ref-type="bibr">Kuemmel
  et al., 2021</xref>) shaped the mid-infrared data handling and
  clustering through his work on brain tissue imaging; Heintz
  (<xref alt="Heintz et al., 2021" rid="ref-heintz" ref-type="bibr">Heintz
  et al., 2021</xref>) provided multimodal Raman and VIS use cases;
  Manser
  (<xref alt="Manser et al., 2023" rid="ref-manser" ref-type="bibr">Manser
  et al., 2023</xref>) contributed workflows for Raman light sheet
  microscopy; Nachtmann
  (<xref alt="Nachtmann et al., 2024" rid="ref-nachtmann" ref-type="bibr">Nachtmann
  et al., 2024</xref>) validated complex 3D Raman pipelines; and van
  Marwick
  (<xref alt="van Marwick et al., 2024" rid="ref-vanmarwick" ref-type="bibr">van
  Marwick et al., 2024</xref>) influenced preprocessing through chemical
  segmentation tasks.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-github_wizard">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Wuehler</surname><given-names>Felix</given-names></name>
      </person-group>
      <article-title>HSI-wizard</article-title>
      <year iso-8601-date="2025">2025</year>
      <uri>https://github.com/BlueSpacePotato/hsi-wizard</uri>
    </element-citation>
  </ref>
  <ref id="ref-Bhargava">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bhargava</surname><given-names>Anuja</given-names></name>
        <name><surname>Sachdeva</surname><given-names>Ashish</given-names></name>
        <name><surname>Sharma</surname><given-names>Kulbhushan</given-names></name>
        <name><surname>Alsharif</surname><given-names>Mohammed H.</given-names></name>
        <name><surname>Uthansakul</surname><given-names>Peerapong</given-names></name>
        <name><surname>Uthansakul</surname><given-names>Monthippa</given-names></name>
      </person-group>
      <article-title>Hyperspectral imaging and its applications: A review</article-title>
      <source>Heliyon</source>
      <year iso-8601-date="2024">2024</year>
      <volume>10</volume>
      <issue>12</issue>
      <issn>2405-8440</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S2405844024092399</uri>
      <pub-id pub-id-type="doi">10.1016/j.heliyon.2024.e33208</pub-id>
      <fpage>e33208</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Guolan">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lu</surname><given-names>Guolan</given-names></name>
        <name><surname>Fei</surname><given-names>Baowei</given-names></name>
      </person-group>
      <article-title>Medical hyperspectral imaging: a review</article-title>
      <source>Journal of Biomedical Optics</source>
      <publisher-name>SPIE</publisher-name>
      <year iso-8601-date="2014">2014</year>
      <volume>19</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1117/1.JBO.19.1.010901</uri>
      <pub-id pub-id-type="doi">10.1117/1.JBO.19.1.010901</pub-id>
      <fpage>010901</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-heintz">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Heintz</surname><given-names>Annabell</given-names></name>
        <name><surname>Sold</surname><given-names>Sebastian</given-names></name>
        <name><surname>Wuehler</surname><given-names>Felix</given-names></name>
        <name><surname>Dyckow</surname><given-names>Julia</given-names></name>
        <name><surname>Schirmer</surname><given-names>Lucas</given-names></name>
        <name><surname>Beuermann</surname><given-names>Thomas</given-names></name>
        <name><surname>Raedle</surname><given-names>Matthias</given-names></name>
      </person-group>
      <article-title>Design of a multimodal imaging system and its first application to distinguish grey and white matter of brain tissue. A proof-of-concept-study</article-title>
      <source>Applied Sciences</source>
      <year iso-8601-date="2021">2021</year>
      <volume>11</volume>
      <issue>11</issue>
      <issn>2076-3417</issn>
      <uri>https://www.mdpi.com/2076-3417/11/11/4777</uri>
      <pub-id pub-id-type="doi">10.3390/app11114777</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-nachtmann">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nachtmann</surname><given-names>Marcel</given-names></name>
        <name><surname>Feger</surname><given-names>Daniel</given-names></name>
        <name><surname>Wuehler</surname><given-names>Felix</given-names></name>
        <name><surname>Scholl</surname><given-names>Stephan</given-names></name>
        <name><surname>Raedle</surname><given-names>Matthias</given-names></name>
      </person-group>
      <article-title>Three-dimensional, molecule-sensitive mapping of structured falling liquid films using Raman scanning</article-title>
      <source>Chemie Ingenieur Technik</source>
      <year iso-8601-date="2024">2024</year>
      <volume>96</volume>
      <issue>3</issue>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1002/cite.202300048</uri>
      <pub-id pub-id-type="doi">10.1002/cite.202300048</pub-id>
      <fpage>286</fpage>
      <lpage>290</lpage>
    </element-citation>
  </ref>
  <ref id="ref-manser">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Manser</surname><given-names>Steffen</given-names></name>
        <name><surname>Keck</surname><given-names>Shaun</given-names></name>
        <name><surname>Vitacolonna</surname><given-names>Mario</given-names></name>
        <name><surname>Wuehler</surname><given-names>Felix</given-names></name>
        <name><surname>Rudolf</surname><given-names>Ruediger</given-names></name>
        <name><surname>Raedle</surname><given-names>Matthias</given-names></name>
      </person-group>
      <article-title>Innovative imaging techniques: A conceptual exploration of multi-modal Raman light sheet microscopy</article-title>
      <source>Micromachines</source>
      <year iso-8601-date="2023">2023</year>
      <volume>14</volume>
      <issue>9</issue>
      <issn>2072-666X</issn>
      <uri>https://www.mdpi.com/2072-666X/14/9/1739</uri>
      <pub-id pub-id-type="doi">10.3390/mi14091739</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-kummel">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kuemmel</surname><given-names>Tim</given-names></name>
        <name><surname>van Marwick</surname><given-names>Bjoern</given-names></name>
        <name><surname>Rittel</surname><given-names>Miriam</given-names></name>
        <name><surname>Ramallo Guevara</surname><given-names>Carina</given-names></name>
        <name><surname>Wuehler</surname><given-names>Fekux</given-names></name>
        <name><surname>Teumer</surname><given-names>Tobias</given-names></name>
        <name><surname>Waengler</surname><given-names>Bjoern</given-names></name>
        <name><surname>Hopf</surname><given-names>Carsten</given-names></name>
        <name><surname>Raedle</surname><given-names>Matthias</given-names></name>
      </person-group>
      <article-title>Rapid brain structure and tumour margin detection on whole frozen tissue sections by fast multiphotometric mid-infrared scanning</article-title>
      <source>Scientific Reports</source>
      <publisher-name>Nature Publishing Group</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>11</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/s41598-021-90777-4</pub-id>
      <fpage>11307</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-vanmarwick">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>van Marwick</surname><given-names>Bjoern</given-names></name>
        <name><surname>Kuemmel</surname><given-names>Tim</given-names></name>
        <name><surname>Wuehler</surname><given-names>Felix</given-names></name>
        <name><surname>Lauer</surname><given-names>Felix</given-names></name>
        <name><surname>Hoffmann</surname><given-names>Jan</given-names></name>
        <name><surname>Raedle</surname><given-names>Matthias</given-names></name>
      </person-group>
      <article-title>Rapid chemical detection and segmentation of latent fingerprints by means of a novel middle-infrared scanning method</article-title>
      <source>Analyst</source>
      <publisher-name>The Royal Society of Chemistry</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>149</volume>
      <uri>http://dx.doi.org/10.1039/D4AN00367E</uri>
      <pub-id pub-id-type="doi">10.1039/D4AN00367E</pub-id>
      <fpage>5768</fpage>
      <lpage>5783</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Studier-Fischer2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Studier‑Fischer</surname><given-names>Alexander</given-names></name>
        <name><surname>Seidlitz</surname><given-names>Silvia</given-names></name>
        <name><surname>Sellner</surname><given-names>Jan</given-names></name>
        <name><surname>Bressan</surname><given-names>Marc</given-names></name>
        <name><surname>Oezdemir</surname><given-names>Berkin</given-names></name>
        <name><surname>Ayala</surname><given-names>Leonardo</given-names></name>
        <name><surname>Odenthal</surname><given-names>Jan</given-names></name>
        <name><surname>Knoedler</surname><given-names>Samuel</given-names></name>
        <name><surname>Kowalewski</surname><given-names>Karl‑Friedrich</given-names></name>
        <name><surname>Haney</surname><given-names>Caelan Max</given-names></name>
        <name><surname>Salg</surname><given-names>Gabriel</given-names></name>
        <name><surname>Dietrich</surname><given-names>Maximilian</given-names></name>
        <name><surname>Kenngott</surname><given-names>Hannes</given-names></name>
        <name><surname>Gockel</surname><given-names>Ines</given-names></name>
        <name><surname>Hackert</surname><given-names>Thilo</given-names></name>
        <name><surname>Mueller‑Stich</surname><given-names>Beat Peter</given-names></name>
        <name><surname>Maier‑Hein</surname><given-names>Lena</given-names></name>
        <name><surname>Nickel</surname><given-names>Felix</given-names></name>
      </person-group>
      <article-title>HeiPorSPECTRAL - the Heidelberg porcine HyperSPECTRAL imaging dataset of 20 physiological organs</article-title>
      <source>Scientific Data</source>
      <year iso-8601-date="2023-06-24">2023</year><month>06</month><day>24</day>
      <volume>10</volume>
      <issue>1</issue>
      <issn>2052-4463</issn>
      <uri>https://doi.org/10.1038/s41597-023-02315-8</uri>
      <pub-id pub-id-type="doi">10.1038/s41597-023-02315-8</pub-id>
      <fpage>414</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
