<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7916</article-id>
<article-id pub-id-type="doi">10.21105/joss.07916</article-id>
<title-group>
<article-title>BREADR: An R Package for the Bayesian Estimation of
Genetic Relatedness from Low-coverage Genotype Data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4204-5018</contrib-id>
<name>
<surname>Rohrlach</surname>
<given-names>Adam B.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1688-8951</contrib-id>
<name>
<surname>Tuke</surname>
<given-names>Jonathan</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0305-6427</contrib-id>
<name>
<surname>Popli</surname>
<given-names>Divya Ratan</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2475-2007</contrib-id>
<name>
<surname>Haak</surname>
<given-names>Wolfgang</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Archaeogenetics, Max Planck Institute for
Evolutionary Anthropology, Leipzig, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>School of Biological Sciences, University of Adelaide,
Adelaide, South Australia, Australia</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>School of Computer and Mathematical Sciences, University of
Adelaide, Adelaide, South Australia, Australia</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-12-23">
<day>23</day>
<month>12</month>
<year>2024</year>
</pub-date>
<volume>10</volume>
<issue>108</issue>
<fpage>7916</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>kinship</kwd>
<kwd>genetic relatedness</kwd>
<kwd>pairwise mismatch rate</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Robust and reliable estimates of how individuals are biologically
  related to each other are a key source of information when
  reconstructing pedigrees. In combination with contextual data,
  reconstructed pedigrees can be used to infer possible kinship
  practices in prehistoric populations. However, standard methods to
  estimate biological relatedness from genome sequence data cannot be
  applied to low coverage sequence data, such as are common in ancient
  DNA (aDNA) studies. Critically, a statistically robust method for
  assessing and quantifying the confidence of a classification of a
  specific degree of relatedness for a pair of individuals, using low
  coverage genome data, is lacking.</p>
  <p>In this paper we present the R-package
  <monospace>BREADR</monospace> (<bold>B</bold>iological
  <bold>RE</bold>latedness from <bold>A</bold>ncient <bold>D</bold>NA in
  <bold>R</bold>), which leverages the so-called pairwise mismatch rate,
  calculated on optimally-filtered genome-wide pseudo-haploid sequence
  data, to estimate genetic relatedness up to the second degree,
  assuming an underlying binomial distribution.
  <monospace>BREADR</monospace> also returns a posterior probability for
  each degree of relatedness, from identical twins/same individual,
  first-degree, second-degree or “unrelated” pairs, allowing researchers
  to quantify and report the uncertainty, even for very low-coverage
  data. We show that this method accurately recovers degrees of
  relatedness for sequence data with coverage as low as 0.04X using
  simulated data (produced as in Popli et
  al.(<xref alt="Popli et al., 2023" rid="ref-popliU003A2023" ref-type="bibr">Popli
  et al., 2023</xref>)).</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p><monospace>BREADR</monospace> is an R package for use in ancient
  DNA studies, and any studies estimating genetic kinship with extremely
  low-coverage DNA sequence data, such as in the forensic sciences.
  <monospace>BREADR</monospace> is designed to be a user-friendly
  software package, using as input pseudo-haploid genotype data in the
  Eigenstrat format, common in aDNA studies, and allowing for
  pre-processing quality control by researchers.</p>
</sec>
<sec id="state-of-the-field">
  <title>State of the Field</title>
  <p>Most software packages for estimating genetic relatedness from aDNA
  sequence data leverage some measure of pairwise genetic dissimilarity,
  often calculated on pseudo-haploid data, where a random call is
  sampled for each site, to avoid the issue of phasing.</p>
  <p>lcMLkin uses genotype likelihoods to estimate identity-by-descent
  coefficients (<inline-formula><alternatives>
  <tex-math><![CDATA[k_0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[k_1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[k_2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>),
  from which the co-ancestry coefficient can be calculated, such that
  <inline-formula><alternatives>
  <tex-math><![CDATA[theta = k_{1}/4+k_{2}/2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>/</mml:mi><mml:mn>4</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  (<xref alt="Lipatov et al., 2015" rid="ref-lipatovU003A2015" ref-type="bibr">Lipatov
  et al., 2015</xref>). This method requires a reference panel to
  estimate the genotype likelihoods, and for sites to be unlinked. This
  method is exploratory in nature, and does not return hard
  classifications of degrees of relatedness, and is (currently) not
  peer-reviewed.</p>
  <p>TKGWV2 instead estimates relatedness via the method of moments
  estimator from Queller and Goodnight, denoted
  <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{r}_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mover><mml:mi>r</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  (<xref alt="Fernandes et al., 2021" rid="ref-fernandesU003A2021" ref-type="bibr">Fernandes
  et al., 2021</xref>). This asymmetric estimator assumes no inbreeding
  in the population and that all sites are unlinked
  (<xref alt="Queller &amp; Goodnight, 1989" rid="ref-quellerU003A1989" ref-type="bibr">Queller
  &amp; Goodnight, 1989</xref>). Hence, TKGWV2 cannot be applied to SNP
  capture data, or data from populations where inbreeding has occurred.
  This method returns hard classifications of the degree of relatedness
  based on which expected value of <inline-formula><alternatives>
  <tex-math><![CDATA[rˆij]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>r</mml:mi><mml:mi>ˆ</mml:mi><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  the observed value is closest to.</p>
  <p>KIN
  (<xref alt="Popli et al., 2023" rid="ref-popliU003A2023" ref-type="bibr">Popli
  et al., 2023</xref>) and ancIBD
  (<xref alt="Ringbauer et al., 2024" rid="ref-ringbauerU003A2023" ref-type="bibr">Ringbauer
  et al., 2024</xref>) instead use the spatial distribution of
  identical-by-descent segments (IBDs). Like lcMLkin, KIN estimates the
  identity-by-descent coefficients, using IBDs instead of weighted
  genotype likelihoods, and can identify degrees of relatedness up to
  the third degree. Conversely, ancIBD uses imputation to increase the
  resolution of the method up to the seventh-degree. However, this
  additional resolution comes at the cost of requiring relatively
  high-coverage sequence data, approximately 0.25X for whole genome
  sequencing, compared to 0.05X, 0.026X or 0.04X for KIN, TKGV2 and
  BREADR, respectively.</p>
  <p>READ and READv2 use the so-called pairwise-mismatch rate (PMR) to
  estimate the proportion of overlapping sites for which two individuals
  have non-matching genotype calls
  (<xref alt="Alaçamlı et al., 2024" rid="ref-alaccamliU003A2024" ref-type="bibr">Alaçamlı
  et al., 2024</xref>;
  <xref alt="Monroy Kuhn et al., 2018" rid="ref-monroyU003A2018" ref-type="bibr">Monroy
  Kuhn et al., 2018</xref>). The PMR was first introduced to overcome
  the limitations of low-coverage aDNA, however, the publication from
  Kennett <italic>et al.</italic> did not include a hard-classification
  method
  (<xref alt="Kennett et al., 2017" rid="ref-kennettU003A2017" ref-type="bibr">Kennett
  et al., 2017</xref>). Where Kennett <italic>et al.</italic> used all
  of the available overlapping sites to estimate the PMR, READ uses a
  1MB windowed approach to sample from the distribution of the PMR, but
  also to account for the effects of linkage disequilibrium (LD),
  allowing for the automated hard classification of degrees of
  relatedness. READv2, however, uses a genome-wide estimate in place of
  the windowed approach of READ.</p>
  <p>Like READ and READv2, BREARD estimates the PMR, but instead thins
  the data to reduce the effects of LD. The PMR on this thinned data can
  now be reasonably expected to follow a binomial distribution, and
  theoretical expectations of the PMR are derived and compared to the
  observed value. From this, statistically rigorous measures of
  uncertainty are derived, and informative diagnostic plots of the
  degree of related for pairs of individuals can be produced. Finally,
  although BREADR only classifies degrees of related up to the
  second-degree, we also allow for tests of any degree up to the
  tenth-degree to be formally tested when considering potential pedigree
  reconstructions.</p>
</sec>
<sec id="current-applications">
  <title>Current Applications</title>
  <p><monospace>BREADR</monospace> produces ready-for-publication
  results and diagnostic plots, and has already seen use in a number of
  publications
  (<xref alt="Ghalichi et al., 2024" rid="ref-ghalichiU003A2024" ref-type="bibr">Ghalichi
  et al., 2024</xref>;
  <xref alt="Gretzinger et al., 2024" rid="ref-gretzingerU003A2024" ref-type="bibr">Gretzinger
  et al., 2024</xref>;
  <xref alt="Penske et al., 2024" rid="ref-penskeU003A2024" ref-type="bibr">Penske
  et al., 2024</xref>;
  <xref alt="Pilli et al., 2024" rid="ref-pilliU003A2024" ref-type="bibr">Pilli
  et al., 2024</xref>;
  <xref alt="Rivollat et al., 2023" rid="ref-rivollatU003A2023" ref-type="bibr">Rivollat
  et al., 2023</xref>).</p>
</sec>
<sec id="estimating-degrees-of-relatedness">
  <title>Estimating Degrees of Relatedness</title>
  <p>Consider two individuals, <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>,
  with <inline-formula><alternatives>
  <tex-math><![CDATA[N_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  overlapping sites (without missingness), where sites are thinned
  (default value <inline-formula><alternatives>
  <tex-math><![CDATA[1\times 10^{5}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>)
  such that the effects of LD are reduced. We then look at the number of
  pseudo-haploid genotype calls that do not match, denoted
  <inline-formula><alternatives>
  <tex-math><![CDATA[X_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.
  Hence we have that <inline-formula><alternatives>
  <tex-math><![CDATA[X_{ij} \sim \text{Bin}(N_{ij} , p_{ij})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext mathvariant="normal">Bin</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  and that the maximum likelihood estimator for
  <inline-formula><alternatives>
  <tex-math><![CDATA[p_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  is <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{p}_{ij} = X_{ij} /N_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>/</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p>Once all PMRs are calculated, we must account for background
  relatedness, which can be thought of as the expected PMR for a pair of
  unrelated individuals, which will differ between populations and
  sequencing types (such as capture versus shotgun sequencing). Many
  choices exist for this value, but assuming that a sampled dataset is
  made up of mostly unrelated pairs (to the second degree), then the
  median PMR, denoted <inline-formula><alternatives>
  <tex-math><![CDATA[\bar{p}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">‾</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
  will be a reliable estimate
  (<xref alt="Monroy Kuhn et al., 2018" rid="ref-monroyU003A2018" ref-type="bibr">Monroy
  Kuhn et al., 2018</xref>). However, we also allow
  <inline-formula><alternatives>
  <tex-math><![CDATA[\bar{p}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">‾</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
  to be a user-supplied parameter, which may be known from previous
  studies, or can be varied for sensitivity analyses.</p>
  <p>Borrowing from the insights of READ, we now define the expected
  mean PMR for a relationship of degree <inline-formula><alternatives>
  <tex-math><![CDATA[k = 0, 1, 2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  to be</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  p_k = \bar{p}\left(1 - \frac{1}{k+1} \right).
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">‾</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>Hence, if we assume that the degree of relatedness for individuals
  <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
  is truly of the <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>th
  degree, then <inline-formula><alternatives>
  <tex-math><![CDATA[X_{ij} \sim \text{Bin}(N_{ij} , p_{k})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext mathvariant="normal">Bin</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p>Hence, the likelihood function for relatedness degree
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>,
  for individuals <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>,
  is</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
      L\left( X_{ij} \big| K=k, N_{ij} \right) = \binom{N_{ij}}{X_{ij}} p_k^{X_{ij}}(1-p_k)^{N_{ij}-X_{ij}}.
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac linethickness="0"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>If we let <inline-formula><alternatives>
  <tex-math><![CDATA[k = \infty]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  be the case that two individuals are “unrelated” (i.e. more than
  second-degree related), but then we also have that</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  \begin{aligned}
  P\left(  X_{ij} \big| K \geq 3, N_{ij}\right) &= \sum_{k=3}^{\infty} P\left(K=k \big| X_{ij},N_{ij} \right) P\left( K=k \right)\\
  &= \binom{N_{ij}}{X_{ij}} p_k^{X_{ij}}(1-p_k)^{N_{ij}-X_{ij}} f_{\lambda}(k),
  \end{aligned}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mml:mo><mml:mi>K</mml:mi><mml:mo>≥</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow><mml:mo accent="false">∞</mml:mo></mml:munderover><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac linethickness="0"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>p</mml:mi><mml:mi>k</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msub><mml:mi>f</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[f_{\lambda}(k)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is the 3-truncated Poisson distribution of the form</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
      f_{\lambda}(k) = \frac{1}{\sum_{\ell=0}^{2} \frac{\lambda^\ell e^{-\lambda}}{\ell!}}\left( \frac{\lambda^ke^{-\lambda}}{k!}  \right).
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>λ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>ℓ</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:mfrac><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mo>ℓ</mml:mo></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>−</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mo>ℓ</mml:mo><mml:mi>!</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>−</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mi>!</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>We choose the 3-truncated Poisson distribution with
  <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda=10]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  as it represents well the unlikelihood of individuals always being
  closely related once they are more than second-degree related, but
  also captures the diminishing probabilities of being too
  distantly-related due to the finite size of populations.</p>
  <p>It is then possible to calculate the normalised posterior
  probabilities of individuals <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>
  being <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>th
  degree related as</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  P\left( K=k \big| X_{ij}, N_{ij} \right) = \frac{L\left( X_ij | K=k,N_{ij} \right)P\left(K=k\right)}{\left[ \sum_{\ell=0}^{2} L\left( X_{ij} \big| K = \ell, N_{ij} \right) \right] + L\left(X_{ij}  \big| K\geq 3, N_{ij} \right)}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>j</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mo>ℓ</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:munderover><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mo>ℓ</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mml:mo><mml:mi>K</mml:mi><mml:mo>≥</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>for which the denominator equals one, by construction. Hence,</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
      P\left( K=k \big| X_{ij}, N_{ij} \right) = L\left( X_ij | K=k,N_{ij} \right)P\left(K=k\right).
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>j</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>However, the prior probabilities for the degrees of relatedness are
  unclear, and will vary from study to study, and so these are given as
  an uninformative uniform distribution by default. Since these are user
  inputs, they should be thought about carefully, and can be explored
  via sensitivity analyses to explore if the prior probabilities are
  driving the relatedness classifications.</p>
  <p>Finally, while we do not include third-degree or higher
  relationships in the possible classifications, we do include a method
  for a statistical test for retaining or rejecting the possibility of a
  kth-degree relationship, for <inline-formula><alternatives>
  <tex-math><![CDATA[0 \leq k \leq 10]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
  For this, we perform a binomial test for the observed number of
  mismatches <inline-formula><alternatives>
  <tex-math><![CDATA[X_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
  and the expected probability of pairwise mismatches, as defined in
  Equation 1, returning a two-sided p-value and the estimated
  (non-integer) degree of relatedness, found by setting
  <inline-formula><alternatives>
  <tex-math><![CDATA[p_k = p_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[k = \hat{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mover><mml:mi>k</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>
  into Equation 2, and solving for <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>,
  i.e.,</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
      \hat{k} = \frac{ln(1-p_{ij}/\hat{p})}{ln(1/2)},
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mover><mml:mi>k</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>/</mml:mi><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>if <inline-formula><alternatives>
  <tex-math><![CDATA[p_{ij}<\hat{p}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>,
  and set <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{k} = \infty]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mover><mml:mi>k</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  otherwise, with <inline-formula><alternatives>
  <tex-math><![CDATA[k=\infty]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  denoting “unrelated”.</p>
</sec>
<sec id="example-usage">
  <title>Example Usage</title>
  <p>To show an example of how one might use
  <monospace>BREADR</monospace> to analyse some data, we simulated
  genotype data from a pedigree of individuals as shown in
  <xref alt="[fig:pedigree]" rid="figU003Apedigree">[fig:pedigree]</xref>.
  This pedigree has 2 genetically identical pairs of individuals, 19
  first-degree relatives, 12 second-degree relatives (2 of which are
  half-siblings) and 87 unrelated pairs of individuals. The pedigree
  also contains a further 9, 6 and 1 third-, fourth- and fifth-degree
  relatives, respectively, although our method does not attempt to
  directly identify these deeper relationships. The simulated data
  resulted in genotypes being called for 29,767,814 segregating sites,
  at an average of 0.04X coverage.</p>
  <fig>
    <caption><p>Pedigree for the simulated data. Individuals 0 and 15,
    and 1 and 16, are genetically identical, respectively. Females are
    represented by circles, males are represented by squares. Dashed
    lines indicate identical individuals (such as twins or samples taken
    from the same
    individual).<styled-content id="figU003Apedigree"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="jpeg" xlink:href="./Images/pedigree.jpeg" />
  </fig>
  <p>The package <monospace>BREADR</monospace> is available under the
  MIT license from the Comprehensive R Archive Network (CRAN) at
  <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=BREADR">https://CRAN.R-project.org/package=BREADR</ext-link>.
  The package can also be installed and loaded using the following
  commands:</p>
  <preformat>&gt; devtools::install_github(&quot;jonotuke/BREADR&quot;)
&gt; require(BREADR)</preformat>
  <p>The package contains the functions for a full analysis of the
  genetic relatedness for a large number of individuals, and the
  visualisation of the overall genetic relatedness, as well as pairwise
  diagnostic plots to make informed pedigree reconstructions. The raw
  input data is genotype data called in the Eigenstrat format, and this
  allows for user pre-processing for data characteristics such as:
  removing ancient DNA damage, minimum allele frequency cut-offs, random
  versus majority genotype calls, read and mapping quality scores,
  etc.</p>
  <p>The analysis begins with a processing step where genotype data is
  converted into count data for each pair of individuals. As this is the
  most computationally intensive step in the analysis, all downstream
  analyses are performed on the output of this first step. From this
  data we calculate the genetic relatedness statistics, calculate
  posterior probabilities, and make highest posterior probability
  assignments, for the degrees of genetic relatedness. Lastly, we
  provide functions for visualising the genetic relatedness estimates
  and classifications, and for performing ad hoc tests for user defined
  degrees of relatedness via a binomial test.</p>
  <sec id="preprocessing-the-eigenstrat-data-for-analysis">
    <title>Preprocessing the Eigenstrat data for analysis</title>
    <p>All downstream functions in the <monospace>BREADR</monospace>
    package require preprocessing of the three standard Eigenstrat
    files: so-called ind, snp and geno files. During this first step, we
    take the list of sites on the genome of interest, with the
    chromosome name and (integer) site position, and the pseudo-haploid
    genotype calls for all individuals (of interest). Then, for each
    pair, we take only sites which have overlapping, non-missing calls,
    and are at least some user-defined number (by default
    <inline-formula><alternatives>
    <tex-math><![CDATA[5\times 10^5]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>)
    of positions apart (within chromosomes). Using these site positions,
    we record the number of filtered, overlapping sites, as well as the
    number of mismatches per pair.</p>
    <p>To generate these required genetic pairwise comparisons for all
    individuals, users apply the
    <monospace>processEigenstrat()</monospace> function. This function
    requires three input string parameters: the paths to the three
    Eigenstrat files. At this stage of pre-processing, users have four
    additional parameters that can be set, and cannot be reset
    downstream.</p>
    <p>First, the <italic>filter_length</italic> parameter (default
    <inline-formula><alternatives>
    <tex-math><![CDATA[1\times10^{5}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>)
    allows the user to define the minimum number of positions between
    sites that can be considered. By removing sites which are close to
    one another, the assumption of independence for each site-wise
    comparison is best attained by lowering or removing the effects of
    linkage disequilibrium.</p>
    <p>Second, the <italic>pop_pattern</italic> parameter (default
    exclude nothing) allows the user to define a set of population names
    so that only a subset of the individuals is compared. Third, the
    <italic>filter_deam</italic> parameter (default NO) filters C to T
    or G to A SNPs from the possible list of sites if the potential
    effects of post-mortem deamination have not been accounted for in
    the genotyping process.</p>
    <p>Last, since pre-processing is the most computationally expensive
    step of the analysis, the <italic>outfile</italic> parameter
    (default NO) is a path-string that allows the user to automatically
    save the post-processed data as a TSV file.</p>
    <fig>
      <caption><p>The first 6 rows of the tibble produced by running
      <monospace>processEigenstrat()</monospace> on the simulated data
      set.<styled-content id="figU003APE"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Images/PE.png" />
    </fig>
    <p>The resulting (see
    <xref alt="[fig:PE]" rid="figU003APE">[fig:PE]</xref>) tibble has
    four columns: the names of the samples/individuals which were
    compared (pair), the number of overlapping SNPs (nsnps) per pair,
    the number of overlapping sites for which the pair did not match
    (mismatch) and the pairwise-mismatch rate (pmr).</p>
  </sec>
  <sec id="analysing-the-post-processed-data">
    <title>Analysing the post-processed data</title>
    <p>Following the pre-processing step, the
    <monospace>callRelatedness()</monospace> function calls a
    relationship of Same_Twins, First_Degree , Second_Degree or
    Unrelated, with additional information, from the output of the
    <monospace>processEigenstrat()</monospace> function. Additional
    parameters can be set to allow the user to customise the
    analysis.</p>
    <p>The <italic>class_prior</italic> parameter (default Uniform)
    defines the prior probabilities of each relatedness class. The
    <italic>average_relatedness</italic> parameter defines what the
    background relatedness should be estimated via (default is the
    median from the filtered estimates). This can be either: (a)
    estimated directly from the median PMR from the data, (b) a single
    value (which is useful for sensitivity analyses when the user is
    uncertain), or (c) a vector of values equal to the number of rows in
    the input tibble (which can be useful if different populations have
    different background relatedness levels). The
    <italic>median_co</italic> parameter (default 500) defines the
    minimum number of overlapping SNPs a pair of individuals must share
    for their PMR to be used in estimating the median PMR, if the user
    has elected to use the median PMR. Finally, the
    <italic>filter_n</italic> parameter (default 1) is used to simply
    remove any pairs of individuals from the analysis if they share
    fewer overlapping SNPs than this value.</p>
    <fig>
      <caption><p>The first 6 rows of the tibble produced by running
      <monospace>callRelatedness()</monospace> on the simulated data set
      as in
      <xref alt="[fig:PE]" rid="figU003APE">[fig:PE]</xref>.<styled-content id="figU003ACR"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Images/CR.png" />
    </fig>
    <p>The resulting tibble (see Figure
    <xref alt="[fig:CR]" rid="figU003ACR">[fig:CR]</xref>) has an
    additional 9 columns: the row number (pair which is useful for
    additional functions, the highest-posterior genetic relationship
    (relationship), the standard error of the estimate of the PMR (sd),
    the median used in the calculations (med), and the normalised
    posterior probabilities for each of the four relatedness categories
    (Same_Twins, First_Degree, Second_Degree and Unrelated)).</p>
  </sec>
  <sec id="visually-interpreting-results">
    <title>Visually interpreting results</title>
    <p>Once posterior probabilities of degrees of relatedness have been
    calculated, the results can visualised in two ways.</p>
    <p>First, an overall picture of the relatedness can be obtained
    using the <monospace>plotLOAF()</monospace> function which plots the
    first <inline-formula><alternatives>
    <tex-math><![CDATA[N]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>
    (default <inline-formula><alternatives>
    <tex-math><![CDATA[N = 50]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)
    pairs of individuals, sorted by ascending PMR value (see
    <xref alt="[fig:plotLoaf]" rid="figU003AplotLoaf">[fig:plotLoaf]</xref>).
    The shape and colour of the point estimates of the PMR indicate the
    highest posterior degree of relatedness assigned for each pair, with
    an associated 95% confidence interval represented by the vertical
    error bars. The dashed coloured lines indicated the expected PMR for
    each degree of relatedness (given the background relatedness). Note
    that if we have <inline-formula><alternatives>
    <tex-math><![CDATA[n]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>
    individuals, then we will have <inline-formula><alternatives>
    <tex-math><![CDATA[\frac{n(n-1)}{2}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:math></alternatives></inline-formula>
    pairs of individuals, which grows factorially as
    <inline-formula><alternatives>
    <tex-math><![CDATA[n]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>
    gets larger. Hence, plotting all pairs of individuals will be
    infeasible in many cases, and since the majority of pairs will
    likely be unrelated, users may only wish to plot the closely related
    pairs of individuals for ease of visualisation. From
    <xref alt="[fig:plotLoaf]" rid="figU003AplotLoaf">[fig:plotLoaf]</xref>
    we can observe two genetically identical individuals, and we also
    get a scale of the number of first- and second-degree related
    individuals.</p>
    <fig>
      <caption><p>The first 50 ordered pairwise-mismatch rates (PMRs)
      from the simulated data. Colours indicate classification, dashed
      lines indicate the expected PMR for each degree of relatedness,
      and the error bars indicate two standard
      errors.<styled-content id="figU003AplotLoaf"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Images/PL.png" />
    </fig>
    <p>Second, a diagnostic plot for the analysis of a single pair of
    individuals can be obtained using the
    <monospace>callSLICE()</monospace> function (see
    <xref alt="[fig:plotSlice]" rid="figU003AplotSlice">[fig:plotSlice]</xref>).
    By default, this function produces a two panel plot. Panel A
    displays the distribution of the PMR for each of the degrees of
    relatedness (given the number of overlapping sites), as well as the
    observed PMR (and 95% confidence interval) plotted below these
    densities. Panel B displays the normalised posterior probabilities
    for each possible degree of relatedness, both visually and
    numerically. The user can choose to return just one of these plots,
    or both. In
    <xref alt="[fig:plotSlice]" rid="figU003AplotSlice">[fig:plotSlice]</xref>,
    we misclassify the true second-degree relationship as unrelated,
    however, the posterior probabilities should lead a researcher to
    consider a second-degree relationship plausible.</p>
    <fig>
      <caption><p>The diagnostic plot for the analysis of the genetic
      relationship Ind1 and Ind12. Panel A indicates the observed PMR
      falls between the expected distributions for a second- degree
      relationship (blue) and an unrelated pair (purple). This is
      uncertainty is quantified in panel B where the normalised
      posterior probability assigned to a second-degree relationship is
      0.4488, and 0.5512 for
      unrelated.<styled-content id="figU003AplotSlice"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Images/PS.png" />
    </fig>
    <p>Finally, the <monospace>savesSLICES()</monospace> function allows
    the user to save all possible pairwise diagnosticplots (as produced
    by <monospace>plotSLICE()</monospace>) as PDFs to an output
    path.</p>
  </sec>
  <sec id="testing-for-departure-from-refined-degrees-of-relatedness">
    <title>Testing for departure from refined degrees of
    relatedness</title>
    <p>The resolution of the <monospace>BREADR</monospace> method only
    allows degrees of relatedness of up to the second degree to be
    assigned. However, once can in principle test to see if the observed
    PMR is consistent with any degree of relatedness using a simple
    binomial test.</p>
    <fig>
      <caption><p>The output from the binomial test for whether the PMR
      observed for Ind1 and Ind12 is consistent with a third-degree
      relationship. We correctly classified the relationship as
      “unrelated”, as we only report degrees of relatedness to the
      resolution of the second-degree. However, the binomial test
      reveals that the observed data is not inconsistent with a third-
      degree relationship (p = 0.9025), with an estimated degree of
      <inline-formula><alternatives>
      <tex-math><![CDATA[\hat{k}=2.9268]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mover><mml:mi>k</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>2.9268</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.<styled-content id="figU003AplotBtest"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="./Images/TD.png" />
    </fig>
    <p>The <monospace>test_degree(</monospace>) function allows the user
    to test any degree of relatedness up to the tenth degree. If the
    <italic>printResults</italic> option is set to TRUE, then all of the
    information about the binomial test is displayed (see Figure 6).
    From this the null hypothesis, the expected and observed PMR, the
    estimate of the degree of relatedness, the associated p-value and
    the decision (at significance level <inline-formula><alternatives>
    <tex-math><![CDATA[\alpha = 0.05]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)
    are given. Figure
    <xref alt="[fig:plotBtest]" rid="figU003AplotBtest">[fig:plotBtest]</xref>
    shows a case where we are able to correctly identify that a
    third-degree relationship is reasonable for Ind1 and Ind12.</p>
  </sec>
</sec>
<sec id="conclusion">
  <title>Conclusion</title>
  <p>This article describes the usage and functionality of the R package
  <monospace>BREADR</monospace>. Based on the well-understood metric of
  the PMR, BREADR can infer pairwise genetic relatedness between
  individuals up to the second degree, and use binomial tests for
  consistency with PMRs of higher degrees of relatedness.
  <monospace>BREADR</monospace> can calculate Bayesian posterior
  probabilities for the classification of genetic relationships on even
  very low-coverage, pseudohaploid sequence data, in the Eigenstrat data
  format, common in aDNA studies. Additionally,
  <monospace>BREADR</monospace> provides functionality for plotting the
  overall genetic relatedness, as well as single plots for specific
  pairs when a need for exploring the strength of evidence for
  alternative potential genetic relationships is required. Finally, by
  allowing for researchers to explore the possibility of other potential
  levels of genetic relatedness in a statistically rigorous framework,
  quality control analyses and pedigree reconstructions can be performed
  with more flexibility.</p>
  <p>We concede that <monospace>BREADR</monospace> has the same
  limitations of any method that relies on estimating the
  pairwise-mismatch: namely that estimating the average
  pairwise-mismatch rate for two unrelated individuals is both difficult
  to do (and to assess), and is not likely to be constant over large
  pedigrees, or across populations. We also identify a need to consider
  the empirical variability of the expected pairwise-mismatch rate for
  k-degree relatives that can be observed in large modern datasets.
  However, we encourage researchers to consider these limitations when
  using <monospace>BREADR</monospace>, as well as to use multiple
  methods for estimating relatedness.</p>
  <p>The usefulness for researchers to be able assign statistical
  confidence to each and every estimated degree of relatedness, even in
  cases when coverage is extremely low, is critical when reconstructing
  a pedigree. We have also shown that when <monospace>BREADR</monospace>
  misclassifies genetic relationships, it is due to a true closer
  genetic relationship (third-degree genetic relationships were
  misclassified as unrelated). The easy-to-use R-implementation of our
  method makes <monospace>BREADR</monospace> an attractive, and
  statistically rigorous tool for researchers in archaeogenetics to
  employ.</p>
</sec>
<sec id="data-description">
  <title>Data Description</title>
  <p>The genetic data is real, but anonymised, ancient DNA data produced
  in house at the Max Planck Institute for Evolutionary Anthropology, in
  Leipzig, Germany. The data comes from a site dated to 2350 BCE. The
  data was produced using the Illumina sequencing platform, and after
  adapter trimming, reads were aligned to the human reference genome
  GRCh37 using
  BWA(<xref alt="Li &amp; Durbin, 2009" rid="ref-li2009fast" ref-type="bibr">Li
  &amp; Durbin, 2009</xref>) as implemented in
  EAGER(<xref alt="Peltzer et al., 2016" rid="ref-peltzer2016eager" ref-type="bibr">Peltzer
  et al., 2016</xref>). Sequence reads were filtered for a minimum
  sequence length of 35 and a mapping quality of at least 25. Data was
  genotyped using
  pileupCaller[https://github.com/stschiff/sequenceTools/tree/master/src/SequenceTools]
  using a random pseudohaploid call for each position on the 1240k
  capture
  assay(<xref alt="Mathieson et al., 2015" rid="ref-mathieson2015genome" ref-type="bibr">Mathieson
  et al., 2015</xref>). The processed genotype data can be found at:
  https://github.com/jonotuke/BREADR/tree/master/data-raw/.</p>
</sec>
<sec id="author-contributions">
  <title>Author Contributions</title>
  <p>Adam B. Rohrlach conceived, designed and implemented the method,
  wrote the paper, prepared the figures, performed the computation work,
  reviewed drafts of the paper and edited submissions.</p>
  <p>Jonathan Tuke conceived the method, created and submitted the
  package to CRAN, reviewed drafts of the paper and edited
  submissions.</p>
  <p>Divya Ratan Popli created and implemented the computations for
  benchmarking the accuracy and performance of the method, reviewed
  drafts of the paper and edited submissions.</p>
  <p>Wolfgang Haak conceived the method, reviewed drafts of the paper
  and edited submissions.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We thank Harald Ringbauer, Nigel Bean and Vincent Braunack-Mayer
  for important and enlightening discussions regarding the
  manuscript.</p>
</sec>
<sec id="funding">
  <title>Funding</title>
  <p>This research was financed by the Max Planck Society and the
  European Research Council under the European Union’s Horizon 2020
  research and innovation programme (grant agreement numbers
  771234-PALEoRIDER, W.H.; 101141408-ROAMANCE, W.H.).</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-alaccamliU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Alaçamlı</surname><given-names>Erkin</given-names></name>
        <name><surname>Naidoo</surname><given-names>Thijessen</given-names></name>
        <name><surname>Güler</surname><given-names>Merve N</given-names></name>
        <name><surname>Sağlıcan</surname><given-names>Ekin</given-names></name>
        <name><surname>Aktürk</surname><given-names>Şevval</given-names></name>
        <name><surname>Mapelli</surname><given-names>Igor</given-names></name>
        <name><surname>Vural</surname><given-names>Kıvılcım Başak</given-names></name>
        <name><surname>Somel</surname><given-names>Mehmet</given-names></name>
        <name><surname>Malmström</surname><given-names>Helena</given-names></name>
        <name><surname>Günther</surname><given-names>Torsten</given-names></name>
      </person-group>
      <article-title>READv2: Advanced and user-friendly detection of biological relatedness in archaeogenomics</article-title>
      <source>Genome Biology</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>25</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1186/s13059-024-03350-3</pub-id>
      <fpage>216</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-fernandesU003A2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fernandes</surname><given-names>Daniel M</given-names></name>
        <name><surname>Cheronet</surname><given-names>Olivia</given-names></name>
        <name><surname>Gelabert</surname><given-names>Pere</given-names></name>
        <name><surname>Pinhasi</surname><given-names>Ron</given-names></name>
      </person-group>
      <article-title>TKGWV2: An ancient DNA relatedness pipeline for ultra-low coverage whole genome shotgun data</article-title>
      <source>Scientific Reports</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>11</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/s41598-021-00581-3</pub-id>
      <fpage>21262</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ghalichiU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ghalichi</surname><given-names>Ayshin</given-names></name>
        <name><surname>Reinhold</surname><given-names>Sabine</given-names></name>
        <name><surname>Rohrlach</surname><given-names>Adam B</given-names></name>
        <name><surname>Kalmykov</surname><given-names>Alexey A</given-names></name>
        <name><surname>Childebayeva</surname><given-names>Ainash</given-names></name>
        <name><surname>Yu</surname><given-names>He</given-names></name>
        <name><surname>Aron</surname><given-names>Franziska</given-names></name>
        <name><surname>Semerau</surname><given-names>Lena</given-names></name>
        <name><surname>Bastert-Lamprichs</surname><given-names>Katrin</given-names></name>
        <name><surname>Belinskiy</surname><given-names>Andrey B</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>The rise and transformation of bronze age pastoralists in the caucasus</article-title>
      <source>Nature</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <pub-id pub-id-type="doi">10.1038/s41586-024-08113-5</pub-id>
      <fpage>1</fpage>
      <lpage>9</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gretzingerU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gretzinger</surname><given-names>Joscha</given-names></name>
        <name><surname>Schmitt</surname><given-names>Felicitas</given-names></name>
        <name><surname>Mötsch</surname><given-names>Angela</given-names></name>
        <name><surname>Carlhoff</surname><given-names>Selina</given-names></name>
        <name><surname>Lamnidis</surname><given-names>Thiseas Christos</given-names></name>
        <name><surname>Huang</surname><given-names>Yilei</given-names></name>
        <name><surname>Ringbauer</surname><given-names>Harald</given-names></name>
        <name><surname>Knipper</surname><given-names>Corina</given-names></name>
        <name><surname>Francken</surname><given-names>Michael</given-names></name>
        <name><surname>Mandt</surname><given-names>Franziska</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Evidence for dynastic succession among early Celtic elites in Central Europe</article-title>
      <source>Nature Human Behaviour</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <pub-id pub-id-type="doi">10.1038/s41562-024-01888-7</pub-id>
      <fpage>1</fpage>
      <lpage>14</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kennettU003A2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kennett</surname><given-names>Douglas J</given-names></name>
        <name><surname>Plog</surname><given-names>Stephen</given-names></name>
        <name><surname>George</surname><given-names>Richard J</given-names></name>
        <name><surname>Culleton</surname><given-names>Brendan J</given-names></name>
        <name><surname>Watson</surname><given-names>Adam S</given-names></name>
        <name><surname>Skoglund</surname><given-names>Pontus</given-names></name>
        <name><surname>Rohland</surname><given-names>Nadin</given-names></name>
        <name><surname>Mallick</surname><given-names>Swapan</given-names></name>
        <name><surname>Stewardson</surname><given-names>Kristin</given-names></name>
        <name><surname>Kistler</surname><given-names>Logan</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Archaeogenomic evidence reveals prehistoric matrilineal dynasty</article-title>
      <source>Nature communications</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>8</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/ncomms14115</pub-id>
      <fpage>14115</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-li2009fast">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Li</surname><given-names>Heng</given-names></name>
        <name><surname>Durbin</surname><given-names>Richard</given-names></name>
      </person-group>
      <article-title>Fast and accurate short read alignment with Burrows–Wheeler transform</article-title>
      <source>bioinformatics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2009">2009</year>
      <volume>25</volume>
      <issue>14</issue>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
      <fpage>1754</fpage>
      <lpage>1760</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lipatovU003A2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lipatov</surname><given-names>Mikhail</given-names></name>
        <name><surname>Sanjeev</surname><given-names>Komal</given-names></name>
        <name><surname>Patro</surname><given-names>Rob</given-names></name>
        <name><surname>Veeramah</surname><given-names>Krishna R</given-names></name>
      </person-group>
      <article-title>Maximum likelihood estimation of biological relatedness from low coverage sequencing data</article-title>
      <source>BioRxiv</source>
      <publisher-name>Cold Spring Harbor Laboratory</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <pub-id pub-id-type="doi">10.1101/023374</pub-id>
      <fpage>023374</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-mathieson2015genome">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mathieson</surname><given-names>Iain</given-names></name>
        <name><surname>Lazaridis</surname><given-names>Iosif</given-names></name>
        <name><surname>Rohland</surname><given-names>Nadin</given-names></name>
        <name><surname>Mallick</surname><given-names>Swapan</given-names></name>
        <name><surname>Patterson</surname><given-names>Nick</given-names></name>
        <name><surname>Roodenberg</surname><given-names>Songül Alpaslan</given-names></name>
        <name><surname>Harney</surname><given-names>Eadaoin</given-names></name>
        <name><surname>Stewardson</surname><given-names>Kristin</given-names></name>
        <name><surname>Fernandes</surname><given-names>Daniel</given-names></name>
        <name><surname>Novak</surname><given-names>Mario</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Genome-wide patterns of selection in 230 ancient Eurasians</article-title>
      <source>Nature</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>528</volume>
      <issue>7583</issue>
      <pub-id pub-id-type="doi">10.1038/nature16152</pub-id>
      <fpage>499</fpage>
      <lpage>503</lpage>
    </element-citation>
  </ref>
  <ref id="ref-monroyU003A2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Monroy Kuhn</surname><given-names>José Manuel</given-names></name>
        <name><surname>Jakobsson</surname><given-names>Mattias</given-names></name>
        <name><surname>Günther</surname><given-names>Torsten</given-names></name>
      </person-group>
      <article-title>Estimating genetic kin relationships in prehistoric populations</article-title>
      <source>PloS one</source>
      <publisher-name>Public Library of Science San Francisco, CA USA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>13</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1371/journal.pone.0195491</pub-id>
      <fpage>e0195491</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-peltzer2016eager">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Peltzer</surname><given-names>Alexander</given-names></name>
        <name><surname>Jäger</surname><given-names>Günter</given-names></name>
        <name><surname>Herbig</surname><given-names>Alexander</given-names></name>
        <name><surname>Seitz</surname><given-names>Alexander</given-names></name>
        <name><surname>Kniep</surname><given-names>Christian</given-names></name>
        <name><surname>Krause</surname><given-names>Johannes</given-names></name>
        <name><surname>Nieselt</surname><given-names>Kay</given-names></name>
      </person-group>
      <article-title>EAGER: Efficient ancient genome reconstruction</article-title>
      <source>Genome biology</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>17</volume>
      <pub-id pub-id-type="doi">10.1186/s13059-016-0918-z</pub-id>
      <fpage>1</fpage>
      <lpage>14</lpage>
    </element-citation>
  </ref>
  <ref id="ref-penskeU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Penske</surname><given-names>Sandra</given-names></name>
        <name><surname>Küßner</surname><given-names>Mario</given-names></name>
        <name><surname>Rohrlach</surname><given-names>Adam B</given-names></name>
        <name><surname>Knipper</surname><given-names>Corina</given-names></name>
        <name><surname>Nováček</surname><given-names>Jan</given-names></name>
        <name><surname>Childebayeva</surname><given-names>Ainash</given-names></name>
        <name><surname>Krause</surname><given-names>Johannes</given-names></name>
        <name><surname>Haak</surname><given-names>Wolfgang</given-names></name>
      </person-group>
      <article-title>Kinship practices at the early bronze age site of leubingen in Central Germany</article-title>
      <source>Scientific Reports</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>14</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/s41598-024-54462-6</pub-id>
      <fpage>3871</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-popliU003A2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Popli</surname><given-names>Divyaratan</given-names></name>
        <name><surname>Peyrégne</surname><given-names>Stéphane</given-names></name>
        <name><surname>Peter</surname><given-names>Benjamin M</given-names></name>
      </person-group>
      <article-title>KIN: A method to infer relatedness from low-coverage ancient DNA</article-title>
      <source>Genome Biology</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>24</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1186/s13059-023-02847-7</pub-id>
      <fpage>10</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-pilliU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pilli</surname><given-names>Elena</given-names></name>
        <name><surname>Vai</surname><given-names>Stefania</given-names></name>
        <name><surname>Moses</surname><given-names>Victoria C</given-names></name>
        <name><surname>Morelli</surname><given-names>Stefania</given-names></name>
        <name><surname>Lari</surname><given-names>Martina</given-names></name>
        <name><surname>Modi</surname><given-names>Alessandra</given-names></name>
        <name><surname>Diroma</surname><given-names>Maria Angela</given-names></name>
        <name><surname>Amoretti</surname><given-names>Valeria</given-names></name>
        <name><surname>Zuchtriegel</surname><given-names>Gabriel</given-names></name>
        <name><surname>Osanna</surname><given-names>Massimo</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Ancient DNA challenges prevailing interpretations of the Pompeii plaster casts</article-title>
      <source>Current Biology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>34</volume>
      <issue>22</issue>
      <pub-id pub-id-type="doi">10.1016/j.cub.2024.10.007</pub-id>
      <fpage>5307</fpage>
      <lpage>5318</lpage>
    </element-citation>
  </ref>
  <ref id="ref-quellerU003A1989">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Queller</surname><given-names>David C</given-names></name>
        <name><surname>Goodnight</surname><given-names>Keith F</given-names></name>
      </person-group>
      <article-title>Estimating relatedness using genetic markers</article-title>
      <source>Evolution</source>
      <publisher-name>Blackwell Publishing Inc Malden, USA</publisher-name>
      <year iso-8601-date="1989">1989</year>
      <volume>43</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1111/j.1558-5646.1989.tb04226.x</pub-id>
      <fpage>258</fpage>
      <lpage>275</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ringbauerU003A2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ringbauer</surname><given-names>Harald</given-names></name>
        <name><surname>Huang</surname><given-names>Yilei</given-names></name>
        <name><surname>Akbari</surname><given-names>Ali</given-names></name>
        <name><surname>Mallick</surname><given-names>Swapan</given-names></name>
        <name><surname>Olalde</surname><given-names>Iñigo</given-names></name>
        <name><surname>Patterson</surname><given-names>Nick</given-names></name>
        <name><surname>Reich</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>Accurate detection of identity-by-descent segments in human ancient DNA</article-title>
      <source>Nature Genetics</source>
      <publisher-name>Nature Publishing Group US New York</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>56</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/s41588-023-01582-w</pub-id>
      <fpage>143</fpage>
      <lpage>151</lpage>
    </element-citation>
  </ref>
  <ref id="ref-rivollatU003A2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rivollat</surname><given-names>Maı̈té</given-names></name>
        <name><surname>Rohrlach</surname><given-names>Adam Benjamin</given-names></name>
        <name><surname>Ringbauer</surname><given-names>Harald</given-names></name>
        <name><surname>Childebayeva</surname><given-names>Ainash</given-names></name>
        <name><surname>Mendisco</surname><given-names>Fanny</given-names></name>
        <name><surname>Barquera</surname><given-names>Rodrigo</given-names></name>
        <name><surname>Szolek</surname><given-names>András</given-names></name>
        <name><surname>Le Roy</surname><given-names>Mélie</given-names></name>
        <name><surname>Colleran</surname><given-names>Heidi</given-names></name>
        <name><surname>Tuke</surname><given-names>Jonathan</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Extensive pedigrees reveal the social organization of a neolithic community</article-title>
      <source>Nature</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>620</volume>
      <issue>7974</issue>
      <pub-id pub-id-type="doi">10.1038/s41586-023-06350-8</pub-id>
      <fpage>600</fpage>
      <lpage>606</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
