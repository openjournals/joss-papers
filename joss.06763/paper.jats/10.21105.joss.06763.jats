<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6763</article-id>
<article-id pub-id-type="doi">10.21105/joss.06763</article-id>
<title-group>
<article-title>GeophysicalModelGenerator.jl: A Julia package to
visualise geoscientific data and create numerical model
setups</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0247-8660</contrib-id>
<name>
<surname>Kaus</surname>
<given-names>Boris J. P.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1185-3730</contrib-id>
<name>
<surname>Thielmann</surname>
<given-names>Marcel</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0008-9039-5646</contrib-id>
<name>
<surname>Aellig</surname>
<given-names>Pascal</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1694-3735</contrib-id>
<name>
<surname>de Montserrat</surname>
<given-names>Albert</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3615-5923</contrib-id>
<name>
<surname>de Siena</surname>
<given-names>Luca</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0002-5049-4259</contrib-id>
<name>
<surname>Frasukiewicz</surname>
<given-names>Jacob</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9165-6384</contrib-id>
<name>
<surname>Fuchs</surname>
<given-names>Lukas</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3074-6041</contrib-id>
<name>
<surname>Piccolo</surname>
<given-names>Andrea</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3456-2277</contrib-id>
<name>
<surname>Ranocha</surname>
<given-names>Hendrik</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5037-5519</contrib-id>
<name>
<surname>Riel</surname>
<given-names>Nicolas</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0004-9873-9774</contrib-id>
<name>
<surname>Schuler</surname>
<given-names>Christian</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6107-0403</contrib-id>
<name>
<surname>Spang</surname>
<given-names>Arne</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0005-8182-0565</contrib-id>
<name>
<surname>Weiler</surname>
<given-names>Tatjana</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Johannes Gutenberg-University Mainz, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>University of Bayreuth, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>ETH ZÃ¼rich, Switzerland</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Alma Mater Studiorum Bologna University,
Italy</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Goethe University Frankfurt, Germany</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-03-14">
<day>14</day>
<month>3</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>103</issue>
<fpage>6763</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>julia</kwd>
<kwd>geosciences</kwd>
<kwd>geodynamics</kwd>
<kwd>tectonics</kwd>
<kwd>geophysics</kwd>
<kwd>computational geosciences</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Geoscientific data exists in a wide variety of formats. Yet, to
  make a consistent interpretation of a certain region, it is often
  helpful to jointly visualise all this data using the same coordinates
  and compare, for example, seismic tomography, surface geology, Moho
  (crust-mantle transition) depth, Earthquake locations, and GPS surface
  velocities. If one wishes to create mechanical or thermo-mechanical
  numerical models of the region, creating an input setup that honors
  these constraints is crucial. And since most numerical codes work in
  Cartesian boxes, it is helpful to have tools to project the data from
  geographic to Cartesian coordinates.</p>
  <p>A significant challenge in doing this is that there is no standard
  format for geoscientific data. Seismic tomography, for example, may
  come in the form of ASCII data with
  <monospace>lon/lat/depth</monospace> axes or as NetCDF files, with the
  ordering of the data typically differing from one dataset to the
  other. In ideal cases, geological surfaces may be provided as GeoTIFF
  images. In many cases, however, the underlying data discussed in
  publications are not available in digital format and are only shown as
  figures in the paper. It is nevertheless still helpful to visualise
  these in 3D in the correct coordinates, along with more recent,
  digitally available datasets.</p>
  <p>The aim of the <monospace>GeophysicalModelGenerator.jl</monospace>
  package is therefore twofold:</p>
  <list list-type="order">
    <list-item>
      <label>1)</label>
      <p>Simplify collecting and visualising a wide variety of
      geoscientific data that is provided as point (e.g., earthquake
      locations), surface (e.g., topography) or volumetric data (e.g.,
      seismic tomography).
      </p>
    </list-item>
    <list-item>
      <label>2)</label>
      <p>Create input setups for 2D or 3D numerical models.</p>
    </list-item>
  </list>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p><monospace>GeophysicalModelGenerator.jl</monospace> is a Julia
  (<xref alt="Bezanson et al., 2017" rid="ref-bezanson2017julia" ref-type="bibr">Bezanson
  et al., 2017</xref>) package that helps collect and visualise a wide
  variety of geophysical and geoscientific data coherently. It also
  simplifies the process of generating 2D or 3D models that can, for
  example, be used as input models in geodynamic simulations. It
  provides functions that transfer data from one format to the other, or
  project them from geographic
  <monospace>Longitude/Latitude/Depth</monospace> or
  <monospace>UTM</monospace> coordinates to Cartesian coordinates
  (<monospace>kilometers</monospace>). It allows performing tasks such
  as creating cross-sections through volumetric data, importing
  screenshots from published papers, downloading digital elevation data
  and saving the resulting data in <monospace>VTK</monospace> format,
  which can, for instance, be visualised with open source tools such as
  <ext-link ext-link-type="uri" xlink:href="www.paraview.org">Paraview</ext-link>.</p>
  <p>Most geoscientists tend to have their own Python/MATLAB/Bash
  visualisation, and many perform part of this job on a daily basis.
  Yet, having all functionality in one place in an easy-to-use package
  makes this more extendable and will likely facilitate sharing data
  along with their interpretations.</p>
</sec>
<sec id="related-software-packages">
  <title>Related software packages</title>
  <p>Perhaps the most widely used package in geophysics to create
  figures or maps is the Generic Mapping Tools package
  (<ext-link ext-link-type="uri" xlink:href="https://www.generic-mapping-tools.org"><monospace>GMT</monospace></ext-link>),
  which also provides a Julia interface
  <ext-link ext-link-type="uri" xlink:href="https://github.com/GenericMappingTools/GMT.jl">GMT.jl</ext-link>
  (<xref alt="Wessel et al., 2019" rid="ref-Wessel_Luis_Uieda_Scharroo_Wobbe_Smith_Tian_2019" ref-type="bibr">Wessel
  et al., 2019</xref>). It mostly focuses on generating maps and
  postscript/pdf images and is therefore not ideally suited for
  interactive 3D data visualisation, or to generate input models for
  numerical codes.</p>
  <p>The
  <ext-link ext-link-type="uri" xlink:href="https://github.com/GeodynamicWorldBuilder/WorldBuilder"><monospace>Geodynamic World Builder</monospace></ext-link>
  is a C++ library to create model setups
  (<xref alt="Fraters et al., 2019" rid="ref-se-10-1785-2019" ref-type="bibr">Fraters
  et al., 2019</xref>). The focus is on generating input models for
  geodynamic simulations, such as subduction zones and related thermal
  structures. It has C and Fortran wrappers and can thus be embedded in
  geodynamic codes. Users of the
  <monospace>Geodynamic World Builder</monospace> have to generate JSON
  files to define the model geometry, which is less interactive than by
  using the Julia <monospace>REPL</monospace>. There is no
  straightforward way to integrate existing geophysical/geological data
  in the workflow and compare model results with them.</p>
  <p><ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/geomio/geomio/src">geomIO</ext-link>
  is a MATLAB-based toolbox that allows creating geodynamic input setups
  by drawing several cross-sections using vector software such as
  Inkscape, which is put together into 3D volumes
  (<xref alt="Bauville &amp; Baumann, 2019" rid="ref-Bauville_Baumann_2019" ref-type="bibr">Bauville
  &amp; Baumann, 2019</xref>). While it does allow the creation of
  sophisticated setups, data can only be taken into account by adding
  them as screenshots to Inkscape while drawing cross-sections. Its
  reliance on commercial software may be problematic for some users.</p>
  <p><ext-link ext-link-type="uri" xlink:href="https://www.gempy.org">GemPy</ext-link>
  is a Python-based, open-source geomodeling library that can construct
  3D geological models of folded structures, fault networks and
  unconformities while taking uncertainties into account
  (<xref alt="De La Varga et al., 2019" rid="ref-DeLaVarga_Schaaf_Wellmann_2019" ref-type="bibr">De
  La Varga et al., 2019</xref>). It focuses on creating geometric models
  with uncertainties rather than on integrating a wide variety of
  geoscientific datasets.</p>
  <p>There are also a number of commercial software solutions:</p>
  <list list-type="bullet">
    <list-item>
      <p><ext-link ext-link-type="uri" xlink:href="https://www.software.slb.com/products/petrel">Petrel
      subsurface software</ext-link> (by Schlumberger), which is mostly
      used by the hydrocarbon industry and is particularly powerful in
      integrating seismic reflection and well-data.</p>
    </list-item>
    <list-item>
      <p><ext-link ext-link-type="uri" xlink:href="https://www.mirageoscience.com/mining-industry-software/gocad-mining-suite/">GOCAD
      Mining Suite</ext-link> (by MiraGeoscience) helps to generate
      geometric models of the subsurface in the vicinity of mines based
      on sparse geological measurements and drill hole data.</p>
    </list-item>
    <list-item>
      <p><ext-link ext-link-type="uri" xlink:href="https://www.intrepid-geophysics.com/products/geomodeller/">GeoModeller</ext-link>
      (by Intrepid Geophysics) creates surface-near geometric geological
      models by implicit modelling of surface measurements while taking
      geophysical constraints into account.</p>
    </list-item>
  </list>
  <p>In all cases, the commercial license fees are far beyond what most
  researchers can afford, even if reduced license fees are often
  available for academia. The closed-source nature of the software
  packages makes them non-extendable by the community.</p>
  <p>The <monospace>GeophysicalModelGenerator.jl</monospace> package is
  already used to generate input models for the geodynamic codes
  <ext-link ext-link-type="uri" xlink:href="https://github.com/UniMainzGeo/LaMEM">LaMEM</ext-link>
  (<xref alt="Kaus et al., 2016" rid="ref-Kaus_Popov_Baumann_Pusok_Bauville_Fernandez_Collignon_2016" ref-type="bibr">Kaus
  et al., 2016</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://github.com/PTsolvers/JustRelax.jl">JustRelax.jl</ext-link>,
  and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/boriskaus/MagmaThermoKinematics.jl">MagmaThermokinematics.jl</ext-link>.
  It is also used in a number of short courses and lectures at the
  Universities of Mainz, Heidelberg, Jena and Bologna, in hands-on
  tutorials during various workshops and in a number of recent
  publications to highlight 3D
  (<xref alt="Gabrielli et al., 2023" rid="ref-gabrielli2023scattering" ref-type="bibr">Gabrielli
  et al., 2023</xref>;
  <xref alt="Napolitano et al., 2023" rid="ref-napolitano2023imaging" ref-type="bibr">Napolitano
  et al., 2023</xref>) and 4D
  (<xref alt="De Siena et al., 2024" rid="ref-desiena2024geophysical" ref-type="bibr">De
  Siena et al., 2024</xref>) geophysical and geological data.</p>
</sec>
<sec id="basic-usage">
  <title>Basic usage</title>
  <p>The core of the package consists of the
  <monospace>GeoData</monospace>, <monospace>UTMData</monospace>,
  <monospace>ParaviewData</monospace>, and
  <monospace>CartData</monospace> structures which hold the 3D data
  along with coordinates (and potentially metadata) information.
  <monospace>GeophysicalModelGenerator.jl</monospace> can be installed
  using the built-in Julia package manager:</p>
  <code language="julia">julia&gt; ]
(@v1.10) pkg&gt; add GeophysicalModelGenerator</code>
  <p>which comes with a test-suite:</p>
  <code language="julia">(@v1.10) pkg&gt; test GeophysicalModelGenerator</code>
  <p>and can be loaded with:</p>
  <code language="julia">julia&gt; using GeophysicalModelGenerator</code>
  <p>As a first example, we will download a 3D seismic tomography
  dataset for the Alpine region (from
  (<xref alt="Paffrath et al., 2021" rid="ref-Paffrath_Friederich_Schmid_Handy_2021" ref-type="bibr">Paffrath
  et al., 2021</xref>)):</p>
  <code language="julia">julia&gt; Tomo_Alps_full = load_GMG(
  &quot;https://zenodo.org/records/10738510/files/Paffrath_2021_SE_Pwave.jld2?download=1&quot;);</code>
  <p>We can download the topography of the Alpine region with:</p>
  <code language="julia">julia&gt; Topo_Alps = load_GMG(
  &quot;https://zenodo.org/records/10738510/files/AlpsTopo.jld2?download=1&quot;);</code>
  <p>The seismic data covers a much wider region than the Alps itself,
  but in much of that region there is poor data coverage. We can,
  therefore, extract a part of the data that has coverage:</p>
  <code language="julia">julia&gt; Tomo_Alps = extract_subvolume(Tomo_Alps_full, Lon_level=(4,20), 
                        Lat_level=(36,50), Depth_level=(-600,-10));</code>
  <p>At this stage, we can save the data to <monospace>VTK</monospace>
  format:</p>
  <code language="julia">julia&gt; write_paraview(Tomo_Alps,&quot;Tomo_Alps&quot;);
julia&gt; write_paraview(Topo_Alps,&quot;Topo_Alps&quot;);</code>
  <p>and open it with Paraview (see
  <xref alt="[fig:basic]" rid="figU003Abasic">[fig:basic]</xref>a). We
  can create vertical and horizontal cross-sections through the data
  with:</p>
  <code language="julia">julia&gt; Cross_200km = cross_section(Tomo_Alps, Depth_level=-200, Interpolate=true);
julia&gt; Cross_vert  = cross_section(Tomo_Alps, Start=(5,47), End=(15,44));
julia&gt; write_paraview(Cross_vert, &quot;Cross_vert&quot;);
julia&gt; write_paraview(Cross_200km,&quot;Cross_200km&quot;);</code>
  <p>and visualise them along with the volumetric data
  (<xref alt="[fig:basic]" rid="figU003Abasic">[fig:basic]</xref>a).</p>
  <fig>
    <caption><p>Example of visualising 3D seismic data of the Alps,
    using a) geographic coordinates (<monospace>GeoData</monospace>) or
    b) Cartesian coordinates (<monospace>CartData</monospace>) projected
    from geographic coordinates. The topography and several slices
    through the 3D seismic tomography P-wave model of
    (<xref alt="Paffrath et al., 2021" rid="ref-Paffrath_Friederich_Schmid_Handy_2021" ref-type="bibr">Paffrath
    et al., 2021</xref>) are shown.
    <styled-content id="figU003Abasic"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="Basic_Tutorial.png" />
  </fig>
  <p>One complication with geographic data is that Paraview does not
  have native support for geographic coordinates; accordingly, it is not
  always straightforward to use the built-in tools, for example, to
  create slices through the data. In addition, many numerical models
  work in (orthogonal) Cartesian rather than in spherical coordinates,
  which appears to be a good first-order approximation for many
  geodynamic applications
  (<xref alt="Macherel et al., 2024" rid="ref-Macherel_RÃ¤ss_Schmalholz_2024" ref-type="bibr">Macherel
  et al., 2024</xref>).</p>
  <p><monospace>GeophysicalModelGenerator.jl</monospace> includes tools
  to transfer the data from geographic to Cartesian coordinates, which
  requires defining a projection point along which the projection is
  performed:</p>
  <code language="julia">julia&gt; proj = ProjectionPoint(Lon=12.0,Lat =43)
ProjectionPoint(43.0, 12.0, 255466.98055255096, 4.765182932801006e6, 33, true)</code>
  <p>We can now project the topography with:</p>
  <code language="julia">julia&gt; Topo_cart = convert2CartData(Topo_Alps, proj);</code>
  <p>which returns a <monospace>CartData</monospace> (Cartesian data)
  structure. The disadvantage of doing this projection is that the
  resulting Cartesian grid is no longer strictly orthogonal, which is a
  problem for some Cartesian numerical models (e.g., those using a
  finite difference discretisation). We can project the data on an
  orthogonal grid as well, by first creating appropriately sized
  orthogonal grids for the tomography and topography:</p>
  <code language="julia">julia&gt; Tomo_rect = CartData(xyz_grid(-550.0:10:600, -500.0:10:700, -600.0:5:-17));
julia&gt; Topo_rect = CartData(xyz_grid(-550.0:1:600, -500.0:1:700, 0)); </code>
  <p>Next, we can project the data to the orthogonal grids with:</p>
  <code language="julia">julia&gt; Topo_rect = project_CartData(Topo_rect, Topo_Alps, proj);
julia&gt; Tomo_rect = project_CartData(Tomo_rect, Tomo_Alps, proj);
julia&gt; write_paraview(Tomo_rect,&quot;Tomo_rect&quot;);
julia&gt; write_paraview(Topo_rect,&quot;Topo_rect&quot;);</code>
  <p>We can now use the built-in tools of Paraview to visualise the data
  (see <xref alt="[fig:basic]" rid="figU003Abasic">[fig:basic]</xref>
  b), and use this as inspiration to create an initial numerical model
  setup. It is also possible to interpolate other seismic tomography
  datasets to the same grid and subsequently compute a
  <italic>votemap</italic> to count how many tomographic models contain
  a specific seismic anomaly (see, e.g.,
  <xref alt="Shephard et al., 2017" rid="ref-Shephard_Matthews_Hosseini_Domeier_2017" ref-type="bibr">Shephard
  et al., 2017</xref>).</p>
</sec>
<sec id="examples-of-usage">
  <title>Examples of usage</title>
  <p><monospace>GeophysicalModelGenerator.jl</monospace> comes with
  build-in (CI/CD) tests and
  <ext-link ext-link-type="uri" xlink:href="https://juliageodynamics.github.io/GeophysicalModelGenerator.jl/dev">tutorials</ext-link>
  that explain the most important use cases, from importing data to
  generating input model setups for numerical simulations. In the
  following, we present a number of examples that illustrate various
  aspects of the package. Many additional tutorials are available in the
  online documentation.</p>
  <sec id="visualise-data-from-the-alps">
    <title>Visualise data from the Alps</title>
    <p>The European Alps are among the best-studied mountain belts on
    the planet and have therefore been the focus of numerous geological
    and geophysical studies. Different seismic tomography models have
    been published (using different parameterisations and datasets), but
    those do not necessarily agree with each other.</p>
    <p>In
    <ext-link ext-link-type="uri" xlink:href="https://juliageodynamics.github.io/GeophysicalModelGenerator.jl/dev/man/Tutorial_AlpineData/"><monospace>Tutorial_AlpineData.jl</monospace></ext-link>,
    users learn how to load the topography of the region, import Moho
    data, load and visualise GPS vectors, import and plot earthquake
    locations, along with cross-sections through the model
    (<xref alt="[fig:alps]" rid="figU003Aalps">[fig:alps]</xref>).</p>
    <fig>
      <caption><p>Example of combined data of the Alps, which shows the
      GPS surface velocity (arrows), topography, earthquake locations
      (colored dots) and cross-sections through a recent anisotropic
      P-wave tomography model by
      (<xref alt="Rappisi et al., 2022" rid="ref-Rappisi_VanderBeek_Faccenda_Morelli_Molinari_2022" ref-type="bibr">Rappisi
      et al., 2022</xref>).
      <styled-content id="figU003Aalps"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="../src/assets/img/GMG_AlpineData.png" />
    </fig>
  </sec>
  <sec id="la-palma-volcanic-eruption">
    <title>La Palma volcanic eruption</title>
    <p>The 2019 Cumbre Viejo eruption in La Palma, Canary Islands, was
    accompanied by seismic activity. In
    <ext-link ext-link-type="uri" xlink:href="https://juliageodynamics.github.io/GeophysicalModelGenerator.jl/dev/man/Tutorial_LaPalma/"><monospace>Tutorial_LaPalma.jl</monospace></ext-link>,
    users learn to generate a Cartesian block model of the island,
    import seismicity and use that to generate a 3D volumetric seismic
    activity map
    (<xref alt="[fig:lapalma]" rid="figU003Alapalma">[fig:lapalma]</xref>).</p>
    <fig>
      <caption><p>Example of a model of La Palma that shows seismicity
      during the 2019 Cumbre Viejo eruption.
      <styled-content id="figU003Alapalma"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="../src/assets/img/Tutorial_LaPalma.png" />
    </fig>
  </sec>
  <sec id="jura-mountains">
    <title>Jura mountains</title>
    <p>The Jura mountains are a small-scale fold and thrust belt located
    in Switzerland and France. Thanks to seismic cross-sections and
    boreholes, a lot of information is available about its structure at
    depth. This information was used to generate extensive 3D models of
    the subsurface, including thickness maps of various geological
    units, generate a new geological map of the region, and create
    balanced reconstructions
    (<xref alt="Schori, 2021" rid="ref-Schori_2021" ref-type="bibr">Schori,
    2021</xref>).</p>
    <p>In
    <ext-link ext-link-type="uri" xlink:href="https://juliageodynamics.github.io/GeophysicalModelGenerator.jl/dev/man/Tutorial_Jura/"><monospace>Tutorial_Jura.jl</monospace></ext-link>,
    users learn how to drape the geological map over the topography,
    import surfaces from GeoTIFF images (such as basement topography),
    and include screenshots from geological cross-sections. The data is
    rotated and transferred to Cartesian coordinates such that we obtain
    a 3D block model that is perpendicular to the strike of the mountain
    range
    (<xref alt="[fig:jura]" rid="figU003Ajura">[fig:jura]</xref>).</p>
    <fig>
      <caption><p>Example of creating a 3D Cartesian block model that
      runs perpendicular to the Jura mountains, combining surface
      geology, with screenshots from interpreted cross-sections (in the
      center right), and digital data of the the basement topography
      (using data of
      <xref alt="Schori, 2021" rid="ref-Schori_2021" ref-type="bibr">Schori,
      2021</xref>).
      <styled-content id="figU003Ajura"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="../src/assets/img/Jura_2.png" />
    </fig>
  </sec>
  <sec id="slab-model-setup">
    <title>Slab model setup</title>
    <p>In <monospace>Tutorial_NumericalModel_3D.jl</monospace>, users
    learn how to generate a 3D geodynamic model setup with subducting
    slabs, a mid-oceanic ridge and an overriding cratonic lithosphere.
    The thermal structure of the oceanic slab increases away from the
    ridge until the trench, following a halfspace cooling analytical
    solution. In contrast, the thermal structure of the subducted part
    of the slab is based on an analytical solution that takes heating
    from the surrounding hot mantle into account (after
    <xref alt="McKenzie, 1969" rid="ref-McKenzie_1969" ref-type="bibr">McKenzie,
    1969</xref>). Between the mantle and the trench, the slab uses a
    mixture of these two thermal models. A weak zone is added above the
    slab (to facilitate subduction in numerical models). A sedimentary
    wedge is situated at the continental margin, and a grid-like pattern
    is put on top of the oceanic slab to simplify tracking deformation
    throughout the simulation
    (<xref alt="[fig:slab3d]" rid="figU003Aslab3d">[fig:slab3d]</xref>).</p>
    <fig>
      <caption><p>Example of a geodynamic setup of a subducting oceanic
      plate beneath a continental lithosphere with a smoothly bending
      slab.
      <styled-content id="figU003Aslab3d"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="../src/assets/img/Mechanical3D_Tutorial_2.png" />
    </fig>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We acknowledge funding by 1) the European Research Council as part
  of Consolidator Grant 771143 (MAGMA), 2) the German Research
  Foundation through DFG grants KA3367/10-1, TH2076/7-1 (both part of
  the SPP 2017 4D-MB project) and Emmy Noether grant TH2076/8-1, 3) the
  German Ministry of Science and Education (BMBF) through project
  DEGREE, and 4) by the CHEESE-2p Center of Excellence, co-funded by
  both EuroHPC-JU and the BMBF.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-se-10-1785-2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fraters</surname><given-names>M.</given-names></name>
        <name><surname>Thieulot</surname><given-names>C.</given-names></name>
        <name><surname>Berg</surname><given-names>A. van den</given-names></name>
        <name><surname>Spakman</surname><given-names>W.</given-names></name>
      </person-group>
      <article-title>The Geodynamic World Builder: A solution for complex initial conditions in numerical modeling</article-title>
      <source>Solid Earth</source>
      <year iso-8601-date="2019">2019</year>
      <volume>10</volume>
      <issue>5</issue>
      <uri>https://se.copernicus.org/articles/10/1785/2019/</uri>
      <pub-id pub-id-type="doi">10.5194/se-10-1785-2019</pub-id>
      <fpage>1785</fpage>
      <lpage>1807</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Wessel_Luis_Uieda_Scharroo_Wobbe_Smith_Tian_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wessel</surname><given-names>P.</given-names></name>
        <name><surname>Luis</surname><given-names>J. F.</given-names></name>
        <name><surname>Uieda</surname><given-names>L.</given-names></name>
        <name><surname>Scharroo</surname><given-names>R.</given-names></name>
        <name><surname>Wobbe</surname><given-names>F.</given-names></name>
        <name><surname>Smith</surname><given-names>W. H. F.</given-names></name>
        <name><surname>Tian</surname><given-names>D.</given-names></name>
      </person-group>
      <article-title>The Generic Mapping Tools Version 6</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2019-11">2019</year><month>11</month>
      <volume>20</volume>
      <issue>11</issue>
      <issn>1525-2027</issn>
      <pub-id pub-id-type="doi">10.1029/2019GC008515</pub-id>
      <fpage>5556</fpage>
      <lpage>5564</lpage>
    </element-citation>
  </ref>
  <ref id="ref-DeLaVarga_Schaaf_Wellmann_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>De La Varga</surname><given-names>Miguel</given-names></name>
        <name><surname>Schaaf</surname><given-names>Alexander</given-names></name>
        <name><surname>Wellmann</surname><given-names>Florian</given-names></name>
      </person-group>
      <article-title>GemPy 1.0: Open-source stochastic geological modeling and inversion</article-title>
      <source>Geoscientific Model Development</source>
      <year iso-8601-date="2019-01">2019</year><month>01</month>
      <volume>12</volume>
      <issue>1</issue>
      <issn>1991-9603</issn>
      <pub-id pub-id-type="doi">10.5194/gmd-12-1-2019</pub-id>
      <fpage>1</fpage>
      <lpage>32</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Paffrath_Friederich_Schmid_Handy_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Paffrath</surname><given-names>Marcel</given-names></name>
        <name><surname>Friederich</surname><given-names>Wolfgang</given-names></name>
        <name><surname>Schmid</surname><given-names>Stefan M.</given-names></name>
        <name><surname>Handy</surname><given-names>Mark R.</given-names></name>
        <name><surname>AlpArray</surname></name>
        <name><surname>Group</surname><given-names>AlpArray-Swath D Working</given-names></name>
      </person-group>
      <article-title>Imaging structure and geometry of slabs in the greater Alpine area â a P-wave travel-time tomography using AlpArray Seismic Network data</article-title>
      <source>Solid Earth</source>
      <year iso-8601-date="2021-11">2021</year><month>11</month>
      <volume>12</volume>
      <issue>11</issue>
      <issn>1869-9529</issn>
      <pub-id pub-id-type="doi">10.5194/se-12-2671-2021</pub-id>
      <fpage>2671</fpage>
      <lpage>2702</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Macherel_RÃ¤ss_Schmalholz_2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Macherel</surname><given-names>Emilie</given-names></name>
        <name><surname>RÃ¤ss</surname><given-names>Ludovic</given-names></name>
        <name><surname>Schmalholz</surname><given-names>Stefan M.</given-names></name>
      </person-group>
      <article-title>3D stresses and velocities caused by continental plateaus: Scaling analysis and numerical calculations with application to the Tibetan plateau</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2024-03">2024</year><month>03</month>
      <volume>25</volume>
      <issue>3</issue>
      <issn>1525-2027</issn>
      <pub-id pub-id-type="doi">10.1029/2023GC011356</pub-id>
      <fpage>e2023GC011356</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Rappisi_VanderBeek_Faccenda_Morelli_Molinari_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rappisi</surname><given-names>F.</given-names></name>
        <name><surname>VanderBeek</surname><given-names>B. P.</given-names></name>
        <name><surname>Faccenda</surname><given-names>M.</given-names></name>
        <name><surname>Morelli</surname><given-names>A.</given-names></name>
        <name><surname>Molinari</surname><given-names>I.</given-names></name>
      </person-group>
      <article-title>Slab geometry and upper mantle flow patterns in the Central Mediterranean from 3D anisotropic Pâwave tomography</article-title>
      <source>Journal of Geophysical Research: Solid Earth</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <volume>127</volume>
      <issue>5</issue>
      <issn>2169-9313</issn>
      <pub-id pub-id-type="doi">10.1029/2021JB023488</pub-id>
      <fpage>e2021JB023488</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Schori_2021">
    <element-citation publication-type="thesis">
      <person-group person-group-type="author">
        <name><surname>Schori</surname><given-names>Marc</given-names></name>
      </person-group>
      <article-title>The Development of the Jura Fold-and-Thrust Belt: Pre-existing Basement Structures and the Formation of Ramps</article-title>
      <publisher-name>University of Fribourg (Switzerland)</publisher-name>
      <year iso-8601-date="2021-10">2021</year><month>10</month>
      <uri>https://folia.unifr.ch/unifr/documents/313053</uri>
      <pub-id pub-id-type="doi">10.51363/unifr.sth.2022.001</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-McKenzie_1969">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>McKenzie</surname><given-names>D. P.</given-names></name>
      </person-group>
      <article-title>Speculations on the consequences and causes of plate motions</article-title>
      <source>Geophysical Journal International</source>
      <year iso-8601-date="1969-09">1969</year><month>09</month>
      <volume>18</volume>
      <issue>1</issue>
      <issn>0956-540X</issn>
      <pub-id pub-id-type="doi">10.1111/j.1365-246X.1969.tb00259.x</pub-id>
      <fpage>1</fpage>
      <lpage>32</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bezanson2017julia">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bezanson</surname><given-names>Jeff</given-names></name>
        <name><surname>Edelman</surname><given-names>Alan</given-names></name>
        <name><surname>Karpinski</surname><given-names>Stefan</given-names></name>
        <name><surname>Shah</surname><given-names>Viral B</given-names></name>
      </person-group>
      <article-title>Julia: A fresh approach to numerical computing</article-title>
      <source>SIAM Review</source>
      <publisher-name>SIAM</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>59</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1411.1607</uri>
      <pub-id pub-id-type="doi">10.1137/141000671</pub-id>
      <fpage>65</fpage>
      <lpage>98</lpage>
    </element-citation>
  </ref>
  <ref id="ref-desiena2024geophysical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>De Siena</surname><given-names>L</given-names></name>
        <name><surname>Amoruso</surname><given-names>A</given-names></name>
        <name><surname>Petrosino</surname><given-names>S</given-names></name>
        <name><surname>Crescentini</surname><given-names>L</given-names></name>
      </person-group>
      <article-title>Geophysical responses to an environmentally-boosted volcanic unrest</article-title>
      <source>Geophysical Research Letters</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>51</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.1029/2023GL104895</pub-id>
      <fpage>e2023GL104895</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-gabrielli2023scattering">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gabrielli</surname><given-names>Simona</given-names></name>
        <name><surname>Akinci</surname><given-names>Aybige</given-names></name>
        <name><surname>De Siena</surname><given-names>Luca</given-names></name>
        <name><surname>Del Pezzo</surname><given-names>Edoardo</given-names></name>
        <name><surname>Buttinelli</surname><given-names>Mauro</given-names></name>
        <name><surname>Maesano</surname><given-names>Francesco Emanuele</given-names></name>
        <name><surname>Maffucci</surname><given-names>Roberta</given-names></name>
      </person-group>
      <article-title>Scattering attenuation images of the control of thrusts and fluid overpressure on the 2016â2017 Central Italy seismic sequence</article-title>
      <source>Geophysical Research Letters</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>50</volume>
      <issue>8</issue>
      <pub-id pub-id-type="doi">10.1029/2023GL103132</pub-id>
      <fpage>e2023GL103132</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Kaus_Popov_Baumann_Pusok_Bauville_Fernandez_Collignon_2016">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Kaus</surname><given-names>Boris JP</given-names></name>
        <name><surname>Popov</surname><given-names>Anton A.</given-names></name>
        <name><surname>Baumann</surname><given-names>T.</given-names></name>
        <name><surname>PÃ¼sÃ¶k</surname><given-names>A.</given-names></name>
        <name><surname>Bauville</surname><given-names>Arthur</given-names></name>
        <name><surname>Fernandez</surname><given-names>Naiara</given-names></name>
        <name><surname>Collignon</surname><given-names>Marine</given-names></name>
      </person-group>
      <article-title>Forward and inverse modelling of lithospheric deformation on geological timescales</article-title>
      <source>NIC series</source>
      <year iso-8601-date="2016">2016</year>
      <volume>48</volume>
      <isbn>978-3-95806-109-5</isbn>
      <uri>https://juser.fz-juelich.de/record/507751/files/nic_2016_kaus.pdf</uri>
      <fpage>299</fpage>
      <lpage>306</lpage>
    </element-citation>
  </ref>
  <ref id="ref-napolitano2023imaging">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Napolitano</surname><given-names>Ferdinando</given-names></name>
        <name><surname>Gabrielli</surname><given-names>Simona</given-names></name>
        <name><surname>De Siena</surname><given-names>Luca</given-names></name>
        <name><surname>Amoroso</surname><given-names>Ortensia</given-names></name>
        <name><surname>Capuano</surname><given-names>Paolo</given-names></name>
      </person-group>
      <article-title>Imaging overpressurised fracture networks and geological barriers hindering fluid migrations across a slow-deformation seismic gap</article-title>
      <source>Scientific Reports</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>13</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/s41598-023-47104-w</pub-id>
      <fpage>19680</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Bauville_Baumann_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bauville</surname><given-names>A.</given-names></name>
        <name><surname>Baumann</surname><given-names>T. S.</given-names></name>
      </person-group>
      <article-title>geomIO: An openâsource MATLAB toolbox to create the initial configuration of 2âD/3âD thermoâmechanical simulations from 2âD vector drawings</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2019-03">2019</year><month>03</month>
      <volume>20</volume>
      <issue>3</issue>
      <issn>1525-2027</issn>
      <pub-id pub-id-type="doi">10.1029/2018GC008057</pub-id>
      <fpage>1665</fpage>
      <lpage>1675</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Shephard_Matthews_Hosseini_Domeier_2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Shephard</surname><given-names>G. E.</given-names></name>
        <name><surname>Matthews</surname><given-names>K. J.</given-names></name>
        <name><surname>Hosseini</surname><given-names>K.</given-names></name>
        <name><surname>Domeier</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>On the consistency of seismically imaged lower mantle slabs</article-title>
      <source>Scientific Reports</source>
      <year iso-8601-date="2017-09">2017</year><month>09</month>
      <volume>7</volume>
      <issue>1</issue>
      <issn>2045-2322</issn>
      <pub-id pub-id-type="doi">10.1038/s41598-017-11039-w</pub-id>
      <fpage>10976</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
