<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7873</article-id>
<article-id pub-id-type="doi">10.21105/joss.07873</article-id>
<title-group>
<article-title><monospace>FluidSF</monospace>: A Python package for
calculating turbulent flow statistics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1186-2082</contrib-id>
<name>
<surname>Wagner</surname>
<given-names>Cassidy M.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0003-6042-5203</contrib-id>
<name>
<surname>Lee</surname>
<given-names>Ara</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0202-0481</contrib-id>
<name>
<surname>Pearson</surname>
<given-names>Brodie</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>College of Earth, Ocean, and Atmospheric Sciences, Oregon
State University, Corvallis, OR, USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-08-05">
<day>5</day>
<month>8</month>
<year>2024</year>
</pub-date>
<volume>10</volume>
<issue>114</issue>
<fpage>7873</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>fluid dynamics</kwd>
<kwd>turbulence</kwd>
<kwd>structure functions</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Fluid systems are everywhere, from small-scale engineering problems
  to planetary- and larger-scale systems (atmosphere, ocean, galactic
  gas clouds). These systems are often turbulent, where motion is
  chaotic, unpredictable, and can only be characterized through
  statistical analyses. Structure functions (SFs) are one such
  statistical analysis technique for turbulence that requires the
  calculation of spatial differences in properties as a function of
  their separation distance. By combining and then averaging these
  spatial differences, various types of SF can be constructed to measure
  physical properties of fluid flow, such as heat and energy transfers,
  energy density, intermittency, etc. However, calculating SFs is often
  a cumbersome and computationally-intensive task tailored to the
  specific format of a given fluid dataset.
  <monospace>FluidSF</monospace> is a flexible
  <monospace>Python</monospace> package that can be used to diagnose and
  analyze various physically-informative SFs from one-, two-, or
  three-dimensional fluid data sets.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p><monospace>FluidSF</monospace> can construct an array of
  traditional and modern structure functions, and can be easily modified
  to calculate user-defined SFs that utilize general fluid properties,
  including scalars (e.g., vorticity, density) and vectors (e.g.,
  velocity, magnetic field). <monospace>FluidSF</monospace> also
  includes several tools to process data (e.g., array shifting, binning)
  and diagnose useful properties (e.g., advection) for SF analysis. The
  flexibility of this package enables geophysical, astrophysical, and
  engineering applications such as: quantifying the energy cycles within
  Earth’s ocean
  (<xref alt="Balwada et al., 2022" rid="ref-balwada2022" ref-type="bibr">Balwada
  et al., 2022</xref>;
  <xref alt="J. Pearson et al., 2019" rid="ref-pearson2019" ref-type="bibr">J.
  Pearson et al., 2019</xref>), Earth’s atmosphere
  (<xref alt="Lindborg, 1999" rid="ref-lindborgU003A1999" ref-type="bibr">Lindborg,
  1999</xref>), and Jupiter’s atmosphere
  (<xref alt="Young &amp; Read, 2017" rid="ref-youngU003A2017" ref-type="bibr">Young
  &amp; Read, 2017</xref>), diagnosing the intermittency of
  magnetohydrodynamic plasma turbulence
  (<xref alt="Wan et al., 2016" rid="ref-wanU003A2016" ref-type="bibr">Wan
  et al., 2016</xref>) and the scaling laws of idealized 3D turbulence
  (<xref alt="Iyer et al., 2020" rid="ref-iyerU003A2020" ref-type="bibr">Iyer
  et al., 2020</xref>), or measuring the characteristics of ocean
  surface temperature
  (<xref alt="Schloesser et al., 2016" rid="ref-schloesserU003A2016" ref-type="bibr">Schloesser
  et al., 2016</xref>) or the anistropy of flow over rough beds
  (<xref alt="Coscarella et al., 2020" rid="ref-coscarellaU003A2020" ref-type="bibr">Coscarella
  et al., 2020</xref>).</p>
  <p>Structure functions are constructed by averaging the correlations
  between spatial differences of properties. For example, given an
  arbitrary scalar field (<inline-formula><alternatives>
  <tex-math><![CDATA[\phi]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ϕ</mml:mi></mml:math></alternatives></inline-formula>),
  we could calculate SFs such as this,</p>
  <p><named-content id="eqU003Aeq1" content-type="equation"><disp-formula><alternatives>
  <tex-math><![CDATA[
  SF_{\phi \phi}(\mathbf{r}) = \overline{\delta\phi \delta \phi} = \overline{\left[ \phi(\mathbf{x} + \mathbf{r}) - \phi(\mathbf{x})\right] \left[ \phi(\mathbf{x} + \mathbf{r}) - \phi(\mathbf{x})\right] }]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:mi>δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mi>δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐱</mml:mi><mml:mo>+</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐱</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐱</mml:mi><mml:mo>+</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐱</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></disp-formula></named-content></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{x}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐱</mml:mi></mml:math></alternatives></inline-formula>
  denotes the position of a data point, <inline-formula><alternatives>
  <tex-math><![CDATA[\delta \phi]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>δ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  denotes the spatial variation of <inline-formula><alternatives>
  <tex-math><![CDATA[\phi]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ϕ</mml:mi></mml:math></alternatives></inline-formula>,
  and the overline denotes an average over all positions
  (<inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{x}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐱</mml:mi></mml:math></alternatives></inline-formula>).
  Structure functions depend on the separation vector
  (<inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐫</mml:mi></mml:math></alternatives></inline-formula>),
  and are often analyzed with an assumption of isotropic flow statistics
  [<inline-formula><alternatives>
  <tex-math><![CDATA[SF(\mathbf{r})\rightarrow SF(r=|\mathbf{r}|)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>→</mml:mo><mml:mi>S</mml:mi><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>].
  There are many types of physically useful structure functions. The
  example above is a second-order scalar SF (i.e., it contains two
  <inline-formula><alternatives>
  <tex-math><![CDATA[\delta]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>δ</mml:mi></mml:math></alternatives></inline-formula>
  terms of the scalar <inline-formula><alternatives>
  <tex-math><![CDATA[\phi]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ϕ</mml:mi></mml:math></alternatives></inline-formula>),
  but additional physical insight can be gained from third-order and
  higher-order scalar SFs (three or more <inline-formula><alternatives>
  <tex-math><![CDATA[\delta]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>δ</mml:mi></mml:math></alternatives></inline-formula>
  terms), SFs that depend on vector fields such as velocity, and SFs
  that blend information from multiple fields.</p>
  <p><monospace>FluidSF</monospace> can utilize a variety of fluid data,
  including datasets with one-, two-, and three-dimensional spatial
  data, as well as data from domains with periodic or non-periodic
  boundary conditions. In addition to regular Cartesian-gridded data,
  the software also has some support for non-uniform latitude-longitude
  grids (1D or 2D) but not for general curvilinear coordinates. When
  computing SFs that blend information from multiple fields,
  <monospace>FluidSF</monospace> assumes all variables are co-located,
  so care must be taken with staggered grids. Since
  <monospace>FluidSF</monospace> is written in
  <monospace>Python</monospace>, any fluid data initialized and loaded
  as <monospace>NumPy</monospace>
  (<xref alt="Harris et al., 2020" rid="ref-harrisU003A2020" ref-type="bibr">Harris
  et al., 2020</xref>) arrays can be used to calculate SFs. To
  demonstrate the flexibility of input data,
  <xref alt="[fig:fig1]" rid="figU003Afig1">[fig:fig1]</xref> shows
  several types of SF calculated using <monospace>FluidSF</monospace>
  for a simulation of quasi-geostrophic turbulence in a periodic domain
  using <monospace>GeophysicalFlows.jl</monospace>
  (<xref alt="Constantinou et al., 2021" rid="ref-constantinouU003A2021" ref-type="bibr">Constantinou
  et al., 2021</xref>), while
  <xref alt="[fig:fig2]" rid="figU003Afig2">[fig:fig2]</xref> shows SFs
  calculated from satellite observations of the ocean surface made by
  the NASA SWOT (Surface Waves and Ocean Topography) satellite mission
  (<xref alt="Morrow et al., 2018" rid="ref-morrowU003A2018" ref-type="bibr">Morrow
  et al., 2018</xref>).</p>
  <fig>
    <caption><p>Various structure functions (SFs) calculated from a
    simulated 2D turbulent flow, visualized through snapshots of the
    vorticity field (top left) and velocity field (bottom left). The
    right panels show various SFs based on velocity (red lines) and
    vorticity (blue lines), including third-order and advective SFs (top
    right) and traditional second-order SFs (bottom right). The results
    are from the top layer snapshot of an anisotropic two-layer
    quasi-geostrophic simulation conducted with GeophysicalFlows.jl.
    <styled-content id="figU003Afig1"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="fig1.png" />
  </fig>
  <p>As demonstrated in
  <xref alt="[fig:fig1]" rid="figU003Afig1">[fig:fig1]</xref> and
  <xref alt="[fig:fig2]" rid="figU003Afig2">[fig:fig2]</xref>,
  <monospace>FluidSF</monospace> can calculate a wide array of
  traditional structure functions, including
  <inline-formula><alternatives>
  <tex-math><![CDATA[SF_{\phi \phi}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mi>ϕ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  (<xref alt="Equation 1" rid="eqU003Aeq1">Equation 1</xref>; where the
  scalar field in this case is vorticity <inline-formula><alternatives>
  <tex-math><![CDATA[\omega]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ω</mml:mi></mml:math></alternatives></inline-formula>),
  second- and third-order SFs of longitudinal velocity
  (<inline-formula><alternatives>
  <tex-math><![CDATA[SF_{LL}=\overline{(\delta u_L)^2}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[SF_{LLL}=\overline{(\delta u_L)^3}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>δ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>;
  where <inline-formula><alternatives>
  <tex-math><![CDATA[u_L=\mathbf{u}\cdot\hat{\mathbf{r}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>𝐮</mml:mi><mml:mo>⋅</mml:mo><mml:mover><mml:mi>𝐫</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>)
  and transverse velocity (<inline-formula><alternatives>
  <tex-math><![CDATA[SF_{TT}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[SF_{TTT}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>T</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>),
  and blended velocity-scalar third-order SFs
  (<inline-formula><alternatives>
  <tex-math><![CDATA[SF_{L\omega\omega}=\overline{\delta u_L \delta \omega \delta \omega}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mrow><mml:mi>L</mml:mi><mml:mi>ω</mml:mi><mml:mi>ω</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:mi>δ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mi>δ</mml:mi><mml:mi>ω</mml:mi><mml:mi>δ</mml:mi><mml:mi>ω</mml:mi></mml:mrow><mml:mo accent="true">¯</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>),
  in addition to novel advective SFs of velocity
  (<inline-formula><alternatives>
  <tex-math><![CDATA[ASF_{V}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>A</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>V</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>),
  vorticity (<inline-formula><alternatives>
  <tex-math><![CDATA[ASF_{\omega}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>A</mml:mi><mml:mi>S</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi>ω</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>)
  and scalars
  (<xref alt="B. Pearson et al., 2021" rid="ref-pearsonU003A2021" ref-type="bibr">B.
  Pearson et al., 2021</xref>,
  <xref alt="2025" rid="ref-pearsonU003A2025" ref-type="bibr">2025</xref>).
  Advective SFs require fields of the local advection, and
  <monospace>FluidSF</monospace> has a built-in function to compute
  these advection terms. <monospace>FluidSF</monospace> can calculate
  SFs in specific separation directions (i.e., aligned with the
  Cartesian co-ordinates, shown in
  <xref alt="[fig:fig2]" rid="figU003Afig2">[fig:fig2]</xref>), and for
  2D data it can diagnose maps showing how SFs vary with the magnitude
  and orientation of the separation vector
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐫</mml:mi></mml:math></alternatives></inline-formula>
  (<xref alt="[fig:fig3]" rid="figU003Afig3">[fig:fig3]</xref>).
  <monospace>FluidSF</monospace> also includes tools to make the
  calculation and processing of SFs easier, such as array shifting,
  diagnosis of the advection terms for novel SFs, decomposition of
  velocity into longitudinal (along-<inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐫</mml:mi></mml:math></alternatives></inline-formula>;
  <inline-formula><alternatives>
  <tex-math><![CDATA[u_L]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>u</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:math></alternatives></inline-formula>)
  and transverse (across-<inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐫</mml:mi></mml:math></alternatives></inline-formula>;
  <inline-formula><alternatives>
  <tex-math><![CDATA[u_T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>u</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:math></alternatives></inline-formula>)
  components, and data binning based on separation distance.</p>
  <fig>
    <caption><p>Velocity-based SFs calculated from satellite
    observations of the ocean surface in the North Atlantic. Maps of the
    inferred surface velocity from a satellite swath are shown in the
    top left. The region of data used for SF calculations is indicated
    by the red box and magnified on the top right. The bottom panel
    shows the advective (red) and third-order (blue) velocity structure
    functions calculated with separation vectors across the satellite
    swath (dashed) and along the swath (solid). Note that the velocity
    fields are estimated from satellite sea surface height measurements
    assuming geostrophic balance.
    <styled-content id="figU003Afig2"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="fig2.png" />
  </fig>
  <fig>
    <caption><p>Maps showing the 2D spatial variation of various
    velocity structure functions. The left panel shows the advective
    velocity SF, the middle panel shows the third-order velocity SF, and
    the right panel shows the second-order velocity SF. These SFs were
    calculated from the same data as
    <xref alt="[fig:fig1]" rid="figU003Afig1">[fig:fig1]</xref>.
    <styled-content id="figU003Afig3"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="fig3.png" />
  </fig>
  <sec id="related-work">
    <title>Related Work</title>
    <p><monospace>FluidSF</monospace> uniquely contributes to the field
    through a combination of expanded data support, the ability to
    diagnose a wide array of structure functions (including advective
    and blended SFs), and tools for analyzing spatial variations in SFs.
    <monospace>FluidSF</monospace> was used to develop new methods for
    estimating inter-scale geophysical energy fluxes
    (<xref alt="B. Pearson et al., 2025" rid="ref-pearsonU003A2025" ref-type="bibr">B.
    Pearson et al., 2025</xref>). There are several open source software
    packages available that calculate aspects of spatial SFs.
    <monospace>fastSF</monospace> is a parallelized C++ code designed to
    compute arbitrary-order SFs of velocity or scalars (but not blended)
    from Cartesian grids of data
    (<xref alt="Sadhukhan et al., 2021" rid="ref-sadhukhanU003A2021" ref-type="bibr">Sadhukhan
    et al., 2021</xref>). Fuchs et al.
    (<xref alt="2022" rid="ref-fuchs2022" ref-type="bibr">2022</xref>)
    created an open-source MATLAB toolkit that performs a variety of
    turbulence analyses, including arbitrary-order longitudinal-velocity
    SFs. A complementary and alternative method to structure functions
    for analyzing turbulence data is coarse-graining.
    <monospace>FlowSieve</monospace> is a primarily C++ package that
    uses coarse-graining to estimate ocean and atmospheric turbulence
    properties from Global Climate Model data
    (<xref alt="Storer &amp; Aluie, 2023" rid="ref-storer2023" ref-type="bibr">Storer
    &amp; Aluie, 2023</xref>).</p>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The development of <monospace>FluidSF</monospace> was primarily
  supported by the National Science Foundation (NSF) under Grant
  No. 2023721 (Wagner &amp; Pearson) with additional support from the
  NSF under Grant No. 2146910 (Lee).</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-pearsonU003A2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pearson</surname><given-names>Brodie</given-names></name>
        <name><surname>Pearson</surname><given-names>Jenna</given-names></name>
        <name><surname>Fox-Kemper</surname><given-names>Baylor</given-names></name>
      </person-group>
      <article-title>Advective structure functions in anisotropic two-dimensional turbulence</article-title>
      <source>Journal of Fluid Mechanics</source>
      <year iso-8601-date="2021">2021</year>
      <volume>916</volume>
      <pub-id pub-id-type="doi">10.1017/jfm.2021.247</pub-id>
      <fpage>49</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-wanU003A2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wan</surname><given-names>M</given-names></name>
        <name><surname>Matthaeus</surname><given-names>WH</given-names></name>
        <name><surname>Roytershteyn</surname><given-names>V</given-names></name>
        <name><surname>Parashar</surname><given-names>TN</given-names></name>
        <name><surname>Wu</surname><given-names>P</given-names></name>
        <name><surname>Karimabadi</surname><given-names>H</given-names></name>
      </person-group>
      <article-title>Intermittency, coherent structures and dissipation in plasma turbulence</article-title>
      <source>Physics of Plasmas</source>
      <publisher-name>AIP Publishing</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>23</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1063/1.4945631</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-coscarellaU003A2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Coscarella</surname><given-names>Francesco</given-names></name>
        <name><surname>Penna</surname><given-names>Nadia</given-names></name>
        <name><surname>Servidio</surname><given-names>Sergio</given-names></name>
        <name><surname>Gaudio</surname><given-names>Roberto</given-names></name>
      </person-group>
      <article-title>Turbulence anisotropy and intermittency in open-channel flows on rough beds</article-title>
      <source>Physics of Fluids</source>
      <publisher-name>AIP Publishing</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>32</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.1063/5.0028119</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-schloesserU003A2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schloesser</surname><given-names>Fabian</given-names></name>
        <name><surname>Cornillon</surname><given-names>Peter</given-names></name>
        <name><surname>Donohue</surname><given-names>Kathleen</given-names></name>
        <name><surname>Boussidi</surname><given-names>Brahim</given-names></name>
        <name><surname>Iskin</surname><given-names>Emily</given-names></name>
      </person-group>
      <article-title>Evaluation of thermosalinograph and VIIRS data for the characterization of near-surface temperature fields</article-title>
      <source>Journal of Atmospheric and Oceanic Technology</source>
      <publisher-name>American Meteorological Society</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>33</volume>
      <issue>9</issue>
      <pub-id pub-id-type="doi">10.1175/jtech-d-15-0180.1</pub-id>
      <fpage>1843</fpage>
      <lpage>1858</lpage>
    </element-citation>
  </ref>
  <ref id="ref-balwada2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Balwada</surname><given-names>Dhruv</given-names></name>
        <name><surname>Xie</surname><given-names>Jin-Han</given-names></name>
        <name><surname>Marino</surname><given-names>Raffaele</given-names></name>
        <name><surname>Feraco</surname><given-names>Fabio</given-names></name>
      </person-group>
      <article-title>Direct observational evidence of an oceanic dual kinetic energy cascade and its seasonality</article-title>
      <source>Science Advances</source>
      <publisher-name>American Association for the Advancement of Science</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>8</volume>
      <issue>41</issue>
      <pub-id pub-id-type="doi">10.1126/sciadv.abq2566</pub-id>
      <fpage>eabq2566</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-lindborgU003A1999">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lindborg</surname><given-names>Erik</given-names></name>
      </person-group>
      <article-title>Can the atmospheric kinetic energy spectrum be explained by two-dimensional turbulence?</article-title>
      <source>Journal of Fluid Mechanics</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="1999">1999</year>
      <volume>388</volume>
      <pub-id pub-id-type="doi">10.1017/s0022112099004851</pub-id>
      <fpage>259</fpage>
      <lpage>288</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pearson2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pearson</surname><given-names>Jenna</given-names></name>
        <name><surname>Fox-Kemper</surname><given-names>Baylor</given-names></name>
        <name><surname>Barkan</surname><given-names>Roy</given-names></name>
        <name><surname>Choi</surname><given-names>Jun</given-names></name>
        <name><surname>Bracco</surname><given-names>Annalisa</given-names></name>
        <name><surname>McWilliams</surname><given-names>James C</given-names></name>
      </person-group>
      <article-title>Impacts of convergence on structure functions from surface drifters in the gulf of mexico</article-title>
      <source>Journal of Physical Oceanography</source>
      <publisher-name>American Meteorological Society</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>49</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1175/jpo-d-18-0029.1</pub-id>
      <fpage>675</fpage>
      <lpage>690</lpage>
    </element-citation>
  </ref>
  <ref id="ref-youngU003A2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Young</surname><given-names>Roland MB</given-names></name>
        <name><surname>Read</surname><given-names>Peter L</given-names></name>
      </person-group>
      <article-title>Forward and inverse kinetic energy cascades in jupiter’s turbulent weather layer</article-title>
      <source>Nature Physics</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>13</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.1038/nphys4227</pub-id>
      <fpage>1135</fpage>
      <lpage>1140</lpage>
    </element-citation>
  </ref>
  <ref id="ref-iyerU003A2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Iyer</surname><given-names>Kartik P</given-names></name>
        <name><surname>Sreenivasan</surname><given-names>Katepalli R</given-names></name>
        <name><surname>Yeung</surname><given-names>PK</given-names></name>
      </person-group>
      <article-title>Scaling exponents saturate in three-dimensional isotropic turbulence</article-title>
      <source>Physical Review Fluids</source>
      <publisher-name>APS</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>5</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.1103/physrevfluids.5.054605</pub-id>
      <fpage>054605</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-sadhukhanU003A2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sadhukhan</surname><given-names>Shubhadeep</given-names></name>
        <name><surname>Bhattacharya</surname><given-names>Shashwat</given-names></name>
        <name><surname>Verma</surname><given-names>Mahendra K.</given-names></name>
      </person-group>
      <article-title>fastSF: A parallel code for computing the structure functions of turbulence</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2021-01">2021</year><month>01</month>
      <volume>6</volume>
      <issue>57</issue>
      <issn>2475-9066</issn>
      <pub-id pub-id-type="doi">10.21105/joss.02185</pub-id>
      <fpage>2185</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-storer2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Storer</surname><given-names>Benjamin A.</given-names></name>
        <name><surname>Aluie</surname><given-names>Hussein</given-names></name>
      </person-group>
      <article-title>FlowSieve: A Coarse-Graining Utility for Geophysical Flows on the Sphere</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2023-04">2023</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-07-12">2024</year><month>07</month><day>12</day></date-in-citation>
      <volume>8</volume>
      <issue>84</issue>
      <issn>2475-9066</issn>
      <pub-id pub-id-type="doi">10.21105/joss.04277</pub-id>
      <fpage>4277</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-fuchs2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fuchs</surname><given-names>André</given-names></name>
        <name><surname>Kharche</surname><given-names>Swapnil</given-names></name>
        <name><surname>Patil</surname><given-names>Aakash</given-names></name>
        <name><surname>Friedrich</surname><given-names>Jan</given-names></name>
        <name><surname>Wächter</surname><given-names>Matthias</given-names></name>
        <name><surname>Peinke</surname><given-names>Joachim</given-names></name>
      </person-group>
      <article-title>An open source package to perform basic and advanced statistical analysis of turbulence data and other complex systems</article-title>
      <source>Physics of Fluids</source>
      <year iso-8601-date="2022-10">2022</year><month>10</month>
      <volume>34</volume>
      <issue>10</issue>
      <issn>1070-6631</issn>
      <pub-id pub-id-type="doi">10.1063/5.0107974</pub-id>
      <fpage>101801</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-morrowU003A2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Morrow</surname><given-names>Rosemary</given-names></name>
        <name><surname>Blurmstein</surname><given-names>Dennis</given-names></name>
        <name><surname>Dibarboure</surname><given-names>Gerald</given-names></name>
      </person-group>
      <article-title>Fine-scale altimetry and the future SWOT mission</article-title>
      <source>New frontiers in operational oceanography</source>
      <year iso-8601-date="2018">2018</year>
      <pub-id pub-id-type="doi">10.17125/gov2018.ch08</pub-id>
      <fpage>191</fpage>
      <lpage>226</lpage>
    </element-citation>
  </ref>
  <ref id="ref-constantinouU003A2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Constantinou</surname><given-names>Navid</given-names></name>
        <name><surname>Wagner</surname><given-names>Gregory</given-names></name>
        <name><surname>Siegelman</surname><given-names>Lia</given-names></name>
        <name><surname>Pearson</surname><given-names>Brodie</given-names></name>
        <name><surname>Palóczy</surname><given-names>André</given-names></name>
      </person-group>
      <article-title>GeophysicalFlows. Jl: Solvers for geophysical fluid dynamics problems in periodic domains on CPUs GPUs</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2021">2021</year>
      <volume>6</volume>
      <issue>60</issue>
      <pub-id pub-id-type="doi">10.21105/joss.03053</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-harrisU003A2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harris</surname><given-names>Charles R.</given-names></name>
        <name><surname>Millman</surname><given-names>K. Jarrod</given-names></name>
        <name><surname>Walt</surname><given-names>Stéfan J. van der</given-names></name>
        <name><surname>Gommers</surname><given-names>Ralf</given-names></name>
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>Cournapeau</surname><given-names>David</given-names></name>
        <name><surname>Wieser</surname><given-names>Eric</given-names></name>
        <name><surname>Taylor</surname><given-names>Julian</given-names></name>
        <name><surname>Berg</surname><given-names>Sebastian</given-names></name>
        <name><surname>Smith</surname><given-names>Nathaniel J.</given-names></name>
        <name><surname>Kern</surname><given-names>Robert</given-names></name>
        <name><surname>Picus</surname><given-names>Matti</given-names></name>
        <name><surname>Hoyer</surname><given-names>Stephan</given-names></name>
        <name><surname>Kerkwijk</surname><given-names>Marten H. van</given-names></name>
        <name><surname>Brett</surname><given-names>Matthew</given-names></name>
        <name><surname>Haldane</surname><given-names>Allan</given-names></name>
        <name><surname>Río</surname><given-names>Jaime Fernández del</given-names></name>
        <name><surname>Wiebe</surname><given-names>Mark</given-names></name>
        <name><surname>Peterson</surname><given-names>Pearu</given-names></name>
        <name><surname>Gérard-Marchant</surname><given-names>Pierre</given-names></name>
        <name><surname>Sheppard</surname><given-names>Kevin</given-names></name>
        <name><surname>Reddy</surname><given-names>Tyler</given-names></name>
        <name><surname>Weckesser</surname><given-names>Warren</given-names></name>
        <name><surname>Abbasi</surname><given-names>Hameer</given-names></name>
        <name><surname>Gohlke</surname><given-names>Christoph</given-names></name>
        <name><surname>Oliphant</surname><given-names>Travis E.</given-names></name>
      </person-group>
      <article-title>Array programming with NumPy</article-title>
      <source>Nature</source>
      <publisher-name>Springer Science; Business Media LLC</publisher-name>
      <year iso-8601-date="2020-09">2020</year><month>09</month>
      <volume>585</volume>
      <issue>7825</issue>
      <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
      <fpage>357</fpage>
      <lpage>362</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pearsonU003A2025">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pearson</surname><given-names>Brodie</given-names></name>
        <name><surname>Wagner</surname><given-names>Cassidy</given-names></name>
        <name><surname>Fox-Kemper</surname><given-names>Baylor</given-names></name>
        <name><surname>Samelson</surname><given-names>Roger</given-names></name>
      </person-group>
      <article-title>Estimating spectral fluxes in quasi-two-dimensional flows with advective structure functions and bessel functions</article-title>
      <source>Journal of Physical Oceanography</source>
      <publisher-name>American Meteorological Society</publisher-name>
      <year iso-8601-date="2025">2025</year>
      <volume>55</volume>
      <issue>9</issue>
      <pub-id pub-id-type="doi">10.1175/JPO-D-24-0211.1</pub-id>
      <fpage>1335</fpage>
      <lpage>1352</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
