<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">3780</article-id>
<article-id pub-id-type="doi">10.21105/joss.03780</article-id>
<title-group>
<article-title>RandomForestsGLS: An R package for Random Forests for
dependent data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Saha</surname>
<given-names>Arkajyoti</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Basu</surname>
<given-names>Sumanta</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Datta</surname>
<given-names>Abhirup</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Departments of Statistics, University of
Washington</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Department of Statistics and Data Science, Cornell
University</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Department of Biostatistics, Johns Hopkins Bloomberg School
of Public Health</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2022-02-23">
<day>23</day>
<month>2</month>
<year>2022</year>
</pub-date>
<volume>7</volume>
<issue>71</issue>
<fpage>3780</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>spatial statistics</kwd>
<kwd>Gaussian Processes</kwd>
<kwd>Random forests</kwd>
<kwd>generalized least-squares</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>With the modern advances in geographical information systems,
  remote sensing technologies, and low-cost sensors, we are increasingly
  encountering datasets where we need to account for spatial or serial
  dependence. Dependent observations <inline-formula><alternatives>
  <tex-math><![CDATA[(y_1, y_2, \cdots, y_n)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>‚ãØ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  with covariates <inline-formula><alternatives>
  <tex-math><![CDATA[(\mathbf x_1,\ldots,\mathbf x_n)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê±</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>‚Ä¶</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê±</mml:mi></mml:mstyle><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  can be modeled non-parametrically as <inline-formula><alternatives>
  <tex-math><![CDATA[y_i = m(\mathbf x_i) + \epsilon_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê±</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>œµ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[m(\mathbf x_i)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê±</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is mean component and <inline-formula><alternatives>
  <tex-math><![CDATA[\epsilon_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œµ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  accounts for the dependency in data. We assume that dependence is
  captured through a covariance function of the correlated stochastic
  process <inline-formula><alternatives>
  <tex-math><![CDATA[\epsilon_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œµ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  (second order dependence). The correlation is typically a function of
  ‚Äúspatial distance‚Äù or ‚Äútime-lag‚Äù between two observations.</p>
  <p>Unlike linear regression, non-linear Machine Learning (ML) methods
  for estimating the regression function <inline-formula><alternatives>
  <tex-math><![CDATA[m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>
  can capture complex interactions among the variables. However, they
  often fail to account for the dependence structure, resulting in
  sub-optimal estimation. On the other hand, specialized software for
  spatial/temporal data properly models data correlation but lacks
  flexibility in modeling the mean function
  <inline-formula><alternatives>
  <tex-math><![CDATA[m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>
  by only focusing on linear models.
  <monospace>RandomForestsGLS</monospace> bridges the gap through a
  novel rendition of Random Forests (RF) ‚Äì namely, RF-GLS ‚Äì by
  explicitly modeling the spatial/serial data correlation in the RF
  fitting procedure to substantially improve the estimation of the mean
  function. Additionally, <monospace>RandomForestsGLS</monospace>
  leverages kriging to perform predictions at new locations for
  geo-spatial data.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p><monospace>RandomForestsGLS</monospace> is a statistical machine
  learning oriented
  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org">R</ext-link>
  package for fitting RF-GLS on dependent data. The RF-GLS algorithm
  described in
  (<xref alt="Saha et al., 2021" rid="ref-saha2021random" ref-type="bibr">Saha
  et al., 2021</xref>) involves computationally intensive linear algebra
  operations in nested loops which are especially slow in an interpreted
  language like <monospace>R</monospace>.
  <monospace>RandomForestsGLS</monospace> efficiently implements RF-GLS
  algorithm in a low-level language with a user-friendly interface in
  <monospace>R</monospace>, a popular computational software (free under
  GNU General Public License) in the statistics community.
  <monospace>RandomForestsGLS</monospace> focuses on fast,
  parallelizable implementations of RF-GLS for spatial and time series
  data, which includes popular choices for covariance functions for both
  spatial (Mat√©rn GP) and time series (autoregressive) data. The package
  is primarily designed to be used by researchers associated with the
  fields of statistical machine learning, spatial statistics, time
  series analysis, and their scientific applications. A significant part
  of the code has already been used in Saha et al.
  (<xref alt="2021" rid="ref-saha2021random" ref-type="bibr">2021</xref>).
  With the combination of speed and ease-of-use that
  <monospace>RandomForestsGLS</monospace> brings to the table regarding
  non-linear regression analysis for dependent data, we hope to see this
  package being used in a plethora of future scientific and
  methodological explorations.</p>
</sec>
<sec id="state-of-the-field">
  <title>State of the field</title>
  <p>Several <monospace>R</monospace> packages implement classical RF.
  Most notable of them being
  <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=randomForest">randomForest</ext-link>,
  which implements Breiman‚Äôs Random Forests
  (<xref alt="Breiman, 2001" rid="ref-breiman2001random" ref-type="bibr">Breiman,
  2001</xref>) for Classification and Regression using the
  <ext-link ext-link-type="uri" xlink:href="https://fortran-lang.org/">Fortran</ext-link>.
  Some of the other packages are
  <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=xgboost">xgboost</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=randomForestSRC">randomForestSRC</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=ranger">ranger</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=Rborist">Rborist</ext-link>.
  For a detailed overview of it, we refer the reader to
  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/views/MachineLearning.html">CRAN
  Task View: Machine Learning &amp; Statistical Learning</ext-link>. To
  the best of our knowledge, none of these packages explicitly account
  for spatial and/or temporal correlation.</p>
  <p>Classical RF has been used in geo-spatial and temporal applications
  (see Saha et al.
  (<xref alt="2021" rid="ref-saha2021random" ref-type="bibr">2021</xref>)
  for references) without making methodological adjustments to account
  for spatial dependencies.
  (<ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/views/Spatial.html">CRAN
  Task View: Analysis of Spatial Data</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/views/TimeSeries.html">CRAN
  Task View: Time Series Analysis</ext-link>). Two recent works that
  attempt to explicitly use spatial information in RF for prediction
  purposes, are Hengl et al.
  (<xref alt="2018" rid="ref-hengl2018random" ref-type="bibr">2018</xref>)
  (
  <ext-link ext-link-type="uri" xlink:href="https://github.com/thengl/GeoMLA">GeoMLA</ext-link>)
  and Georganos et al.
  (<xref alt="2019" rid="ref-georganos2019geographical" ref-type="bibr">2019</xref>)
  (
  <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=SpatialML">SpatialML</ext-link>)
  (see Saha et al.
  (<xref alt="2021" rid="ref-saha2021random" ref-type="bibr">2021</xref>)
  for details). Both approaches try to account for the dependence
  structure by incorporating additional spatial covariates, which
  adversely affect the prediction performance in the presence of a
  dominant covariate effect (Saha et al.
  (<xref alt="2021" rid="ref-saha2021random" ref-type="bibr">2021</xref>)).
  Additionally, unlike RF-GLS, they cannot estimate covariate effects
  separately from the spatial effect, which can be of independent
  interest. The RF for temporal data, proposed in Basak et al.
  (<xref alt="2019" rid="ref-BASAK2019552" ref-type="bibr">2019</xref>),
  suffers from similar shortcomings.</p>
</sec>
<sec id="the-randomforestsgls-package">
  <title>The RandomForestsGLS package</title>
  <p>We provide a brief overview of the functionality of the package.
  The package
  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/RandomForestsGLS/vignettes/RandomForestsGLS_user_guide.pdf">vignette</ext-link>
  demonstrates with example how to use the package for non-linear
  regression analysis of dependent data. Specific functions are
  discussed in detail in the documentation of the package.</p>
  <sec id="rf-to-rf-gls-accounting-for-correlation-structure">
    <title>RF to RF-GLS: Accounting for correlation structure</title>
    <p>In classical RF, which is an average of many regression trees,
    each node in a regression tree is split by optimizing the CART split
    criterion in Breiman et al.
    (<xref alt="1984" rid="ref-breiman1984classification" ref-type="bibr">1984</xref>).
    It can be rewritten in the following way:
    <disp-formula><alternatives>
    <tex-math><![CDATA[
    v_{n}^{CART}((d,c)) =  \frac{1}{n} \left( \|\mathbf{Y} - \mathbf Z^{(0)}\boldsymbol{\hat{\beta}}(\mathbf Z^{(0)})\|_2^2 - \|\mathbf Y - \mathbf Z \boldsymbol{\hat{\beta}}(\mathbf Z)\|_2^2 \right).
    ]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mo stretchy="false" form="postfix">‚à•</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêò</mml:mi></mml:mstyle><mml:mo>‚àí</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msup><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mo stretchy="false" form="postfix">‚à•</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>‚àí</mml:mo><mml:mo stretchy="false" form="postfix">‚à•</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêò</mml:mi></mml:mstyle><mml:mo>‚àí</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mo stretchy="false" form="postfix">‚à•</mml:mo><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
    <p>where <inline-formula><alternatives>
    <tex-math><![CDATA[\mathbf Z^{(0)}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\mathbf Z]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
    are the binary membership matrices for the leaf nodes of the tree
    before and after the potential node split.
    <inline-formula><alternatives>
    <tex-math><![CDATA[(d,c)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
    denotes a potential cut (location of the split), with
    <inline-formula><alternatives>
    <tex-math><![CDATA[d]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>d</mml:mi></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[c]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>
    being the cut direction (choice of the covariate) and cutoff point
    (value of the covariate) respectively,
    <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{\hat{\beta}} (\mathbf Z)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    are the leaf node representatives given by OLS estimates
    corresponding to a design matrix <inline-formula><alternatives>
    <tex-math><![CDATA[\mathbf Z]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
    and can be written as:</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{\hat{\beta}} (\mathbf Z) = \left(\mathbf Z ^\top \mathbf Z \right)^{-1} \mathbf Z ^\top \mathbf y]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mi>‚ä§</mml:mi></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mi>‚ä§</mml:mi></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùê≤</mml:mi></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula></p>
    <p>We observe that the split criterion is the difference of OLS loss
    functions before and after the cut with the respective design
    matrices of membership of the leaf nodes. We can incorporate the
    correlation structure of the data in the split criterion by
    replacing the OLS loss with GLS loss as is traditionally done in
    linear models. The modified split criterion can be rewritten as:</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[
    \begin{aligned}
    v_{n,\mathbf Q}^{DART}((d,c)) = 
    &\frac{1}{n} \Bigg[\left(\mathbf{Y} - \mathbf{Z}^{(0)}\boldsymbol{\hat{\beta}}_{GLS}(\mathbf Z^{(0)}) \right)^\top \mathbf Q\left(\mathbf{Y} - \mathbf{Z}^{(0)}\boldsymbol{\hat{\beta}}_{GLS}(\mathbf Z^{(0)}) \right)\\ &-\left(\mathbf{Y} - \mathbf{Z}\boldsymbol{\hat{\beta}}_{GLS}(\mathbf Z) \right)^\top \mathbf Q\left(\mathbf{Y} - \mathbf{Z}\boldsymbol{\hat{\beta}}_{GLS}(\mathbf Z) \right) \Bigg].
    \end{aligned}
    ]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêê</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mi>A</mml:mi><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mfrac><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mfrac><mml:mo minsize="3.0" maxsize="3.0" stretchy="false" form="prefix">[</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêò</mml:mi></mml:mstyle><mml:mo>‚àí</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>G</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>‚ä§</mml:mi></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêê</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêò</mml:mi></mml:mstyle><mml:mo>‚àí</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msup><mml:msub><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>G</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"></mml:mtd><mml:mtd columnalign="left"><mml:mo>‚àí</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêò</mml:mi></mml:mstyle><mml:mo>‚àí</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>G</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>‚ä§</mml:mi></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêê</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêò</mml:mi></mml:mstyle><mml:mo>‚àí</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:msub><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>G</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo minsize="3.0" maxsize="3.0" stretchy="false" form="postfix">]</mml:mo><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    <p>where <inline-formula><alternatives>
    <tex-math><![CDATA[\mathbf Q]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="bold"><mml:mi>ùêê</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
    is the inverse of the working covariance matrix that models the
    spatial/serial dependence and <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{\hat{\beta}}_{GLS} (\mathbf Z)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>G</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    are the leaf node representatives given by the GLS estimates
    corresponding to a design matrix <inline-formula><alternatives>
    <tex-math><![CDATA[\mathbf Z]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
    and can be written as follows:</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{\hat{\beta}}_{GLS} (\mathbf Z) = \left(\mathbf Z ^\top \mathbf Q \mathbf Z \right)^{-1} \mathbf Z ^\top \mathbf Q \mathbf y.]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mstyle mathvariant="bold"><mml:mover><mml:mi>ùõÉ</mml:mi><mml:mo accent="true">ÃÇ</mml:mo></mml:mover></mml:mstyle><mml:mrow><mml:mi>G</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mi>‚ä§</mml:mi></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêê</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêô</mml:mi></mml:mstyle><mml:mi>‚ä§</mml:mi></mml:msup><mml:mstyle mathvariant="bold"><mml:mi>ùêê</mml:mi></mml:mstyle><mml:mstyle mathvariant="bold"><mml:mi>ùê≤</mml:mi></mml:mstyle><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  </sec>
  <sec id="spatial-data">
    <title>Spatial Data</title>
    <sec id="model">
      <title>Model</title>
      <p>We consider spatial point-referenced data with the following
      mixed model:</p>
      <p><disp-formula><alternatives>
      <tex-math><![CDATA[
      y_i = m(\mathbf{x}_i) + w(\mathbf{s}_i) + \epsilon_i;
      ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê±</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê¨</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>œµ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[y_i, \mathbf{x}_i]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê±</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      respectively denotes the observed response and the covariate
      corresponding to the <inline-formula><alternatives>
      <tex-math><![CDATA[i^{th}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
      observed location <inline-formula><alternatives>
      <tex-math><![CDATA[\mathbf{s}_i]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê¨</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
      <inline-formula><alternatives>
      <tex-math><![CDATA[m(\mathbf{x}_i)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê±</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      denotes the covariate effect; spatial random effect,
      <inline-formula><alternatives>
      <tex-math><![CDATA[w (\mathbf{s})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>w</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="bold"><mml:mi>ùê¨</mml:mi></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      accounts for spatial dependence beyond covariates modeled using a
      GP, and <inline-formula><alternatives>
      <tex-math><![CDATA[\mathbf{\epsilon}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="bold"><mml:mi>ùõú</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
      accounts for independent and identically distributed random
      Gaussian noise.</p>
    </sec>
    <sec id="fitting-prediction">
      <title>Fitting &amp; Prediction</title>
      <p>Spatial random effects are modeled using a Gaussian process
      (GP) as is the practice. We use the computationally convenient
      Nearest Neighbor GP (NNGP)
      (<xref alt="Datta et al., 2016" rid="ref-nngp" ref-type="bibr">Datta
      et al., 2016</xref>). Model parameters, if unknown, are estimated
      from the data (Saha et al.
      (<xref alt="2021" rid="ref-saha2021random" ref-type="bibr">2021</xref>)).
      Alongside predicting covariate effects for a new covariate value,
      we also offer spatial prediction at new locations with non-linear
      kriging by combining the non-linear mean estimate and spatial
      kriging estimate from the
      <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=BRISC">BRISC</ext-link>
      (<xref alt="Saha &amp; Datta, 2018" rid="ref-brisc" ref-type="bibr">Saha
      &amp; Datta, 2018</xref>) package.</p>
    </sec>
  </sec>
  <sec id="autoregressive-ar-time-series-data">
    <title>Autoregressive (AR) Time Series Data</title>
    <sec id="model-1">
      <title>Model</title>
      <p>RF-GLS can also be used for function estimation in a time
      series setting under autoregressive (AR) errors. We consider time
      series data with errors from an AR(<inline-formula><alternatives>
      <tex-math><![CDATA[q]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>)
      (autoregressive process of lag <inline-formula><alternatives>
      <tex-math><![CDATA[q]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>)
      process as follows:</p>
      <p><disp-formula><alternatives>
      <tex-math><![CDATA[
      y_t = m(\mathbf{x}_t) + e_t;\: e_t = \sum_{i = 1}^q\rho_i e_{t-i} + \eta_t
      ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê±</mml:mi></mml:mstyle><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mo>‚àë</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>q</mml:mi></mml:munderover><mml:msub><mml:mi>œÅ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>‚àí</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>Œ∑</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>where <inline-formula><alternatives>
      <tex-math><![CDATA[y_i, \mathbf{x}_i]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùê±</mml:mi></mml:mstyle><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      denote the response and the covariate corresponding to the
      <inline-formula><alternatives>
      <tex-math><![CDATA[t^{th}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>t</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
      time point, respectively, <inline-formula><alternatives>
      <tex-math><![CDATA[e_t]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      is an AR(q) process, <inline-formula><alternatives>
      <tex-math><![CDATA[\eta_t]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Œ∑</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      denotes i.i.d. white noise and <inline-formula><alternatives>
      <tex-math><![CDATA[(\rho_1, \cdots, \rho_q)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>œÅ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>‚ãØ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>œÅ</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      are the model parameters that capture the dependence of
      <inline-formula><alternatives>
      <tex-math><![CDATA[e_t]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
      on <inline-formula><alternatives>
      <tex-math><![CDATA[(e_{t - 1}, \cdots, e_{t-q})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>‚ãØ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>‚àí</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
    </sec>
    <sec id="fitting-prediction-1">
      <title>Fitting &amp; Prediction</title>
      <p>RF-GLS exploits the sparsity of the closed form precision
      matrix of the AR process for model fitting and prediction of the
      mean function <inline-formula><alternatives>
      <tex-math><![CDATA[m(.)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>.</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
      If the AR model parameters (coefficients and order of
      autoregressive process) are unknown, the code automatically
      estimates them from AR models with specified lags. The prediction
      of covariate effect for time series data is like that of spatial
      data.</p>
    </sec>
  </sec>
</sec>
<sec id="discussion">
  <title>Discussion</title>
  <p>This package provides an efficient, parallel implementation of the
  RF-GLS method proposed in Saha et al.
  (<xref alt="2021" rid="ref-saha2021random" ref-type="bibr">2021</xref>)
  which accounts for correlated data with modified node splitting
  criteria and node representative update rule. The package accounts for
  spatial correlation via Mat√©rn GP or serial autocorrelation. It
  provides parameter estimation for both covariance structures.
  Efficient implementation through C/C++ takes advantage of the NNGP
  approximation and scalable node splitting update rules which reduces
  the execution time. More details on package features, parameter
  estimation, and parallelization can be found in the package
  <ext-link ext-link-type="uri" xlink:href="https://github.com/ArkajyotiSaha/RandomForestsGLS#readme">README</ext-link>.
  Since the computational complexity of evaluating potential splits is
  cubic in the number of leaf nodes for RF-GLS, but constant for
  standard RF, improving the computational complexity of the algorithm
  is of independent research interest. We also plan to implement and
  validate additional forms of time series dependency.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>AS and AD were supported by NSF award DMS-1915803. AD was supported
  by NIEHS award R01ES033739. SB was supported by an NSF award
  DMS-1812128, and an NIH award R01GM135926.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-saha2021random">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Saha</surname><given-names>Arkajyoti</given-names></name>
          <name><surname>Basu</surname><given-names>Sumanta</given-names></name>
          <name><surname>Datta</surname><given-names>Abhirup</given-names></name>
        </person-group>
        <article-title>Random forests for spatially dependent data</article-title>
        <source>Journal of the American Statistical Association</source>
        <publisher-name>Taylor &amp; Francis</publisher-name>
        <year iso-8601-date="2021">2021</year>
        <issue>just-accepted</issue>
        <pub-id pub-id-type="doi">10.1080/01621459.2021.1950003</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-breiman2001random">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Breiman</surname><given-names>Leo</given-names></name>
        </person-group>
        <article-title>Random forests</article-title>
        <source>Machine learning</source>
        <publisher-name>Springer</publisher-name>
        <year iso-8601-date="2001">2001</year>
        <volume>45</volume>
        <issue>1</issue>
        <pub-id pub-id-type="doi">10.1023/A:1010933404324</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-hengl2018random">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Hengl</surname><given-names>Tomislav</given-names></name>
          <name><surname>Nussbaum</surname><given-names>Madlene</given-names></name>
          <name><surname>Wright</surname><given-names>Marvin N</given-names></name>
          <name><surname>Heuvelink</surname><given-names>Gerard BM</given-names></name>
          <name><surname>Gr√§ler</surname><given-names>Benedikt</given-names></name>
        </person-group>
        <article-title>Random forest as a generic framework for predictive modeling of spatial and spatio-temporal variables</article-title>
        <source>PeerJ</source>
        <publisher-name>PeerJ Inc.</publisher-name>
        <year iso-8601-date="2018">2018</year>
        <volume>6</volume>
        <pub-id pub-id-type="doi">10.7717/peerj.5518</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-georganos2019geographical">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Georganos</surname><given-names>Stefanos</given-names></name>
          <name><surname>Grippa</surname><given-names>Tais</given-names></name>
          <name><surname>Niang Gadiaga</surname><given-names>Assane</given-names></name>
          <name><surname>Linard</surname><given-names>Catherine</given-names></name>
          <name><surname>Lennert</surname><given-names>Moritz</given-names></name>
          <name><surname>Vanhuysse</surname><given-names>Sabine</given-names></name>
          <name><surname>Mboga</surname><given-names>Nicholus</given-names></name>
          <name><surname>Wolff</surname><given-names>El√©onore</given-names></name>
          <name><surname>Kalogirou</surname><given-names>Stamatis</given-names></name>
        </person-group>
        <article-title>Geographical random forests: A spatial extension of the random forest algorithm to address spatial heterogeneity in remote sensing and population modelling</article-title>
        <source>Geocarto International</source>
        <publisher-name>Taylor &amp; Francis</publisher-name>
        <year iso-8601-date="2019">2019</year>
        <pub-id pub-id-type="doi">10.1080/10106049.2019.1595177</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-BASAK2019552">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Basak</surname><given-names>Suryoday</given-names></name>
          <name><surname>Kar</surname><given-names>Saibal</given-names></name>
          <name><surname>Saha</surname><given-names>Snehanshu</given-names></name>
          <name><surname>Khaidem</surname><given-names>Luckyson</given-names></name>
          <name><surname>Dey</surname><given-names>Sudeepa Roy</given-names></name>
        </person-group>
        <article-title>Predicting the direction of stock market prices using tree-based classifiers</article-title>
        <source>The North American Journal of Economics and Finance</source>
        <year iso-8601-date="2019">2019</year>
        <volume>47</volume>
        <issn>1062-9408</issn>
        <uri>http://www.sciencedirect.com/science/article/pii/S106294081730400X</uri>
        <pub-id pub-id-type="doi">10.1016/j.najef.2018.06.013</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-nngp">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Datta</surname><given-names>Abhirup</given-names></name>
          <name><surname>Banerjee</surname><given-names>Sudipto</given-names></name>
          <name><surname>Finley</surname><given-names>Andrew O.</given-names></name>
          <name><surname>Gelfand</surname><given-names>Alan E.</given-names></name>
        </person-group>
        <article-title>Hierarchical nearest-neighbor gaussian process models for large geostatistical datasets</article-title>
        <source>Journal of the American Statistical Association</source>
        <year iso-8601-date="2016">2016</year>
        <volume>111</volume>
        <issue>514</issue>
        <uri>http://dx.doi.org/10.1080/01621459.2015.1044091</uri>
        <pub-id pub-id-type="doi">10.1080/01621459.2015.1044091</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-brisc">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Saha</surname><given-names>Arkajyoti</given-names></name>
          <name><surname>Datta</surname><given-names>Abhirup</given-names></name>
        </person-group>
        <source>BRISC: Fast inference for large spatial datasets using BRISC</source>
        <year iso-8601-date="2018">2018</year>
        <uri>https://CRAN.R-project.org/package=BRISC</uri>
      </element-citation>
    </ref>
    <ref id="ref-breiman1984classification">
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name><surname>Breiman</surname><given-names>Leo</given-names></name>
          <name><surname>Friedman</surname><given-names>Jerome</given-names></name>
          <name><surname>Stone</surname><given-names>Charles J</given-names></name>
          <name><surname>Olshen</surname><given-names>Richard A</given-names></name>
        </person-group>
        <source>Classification and regression trees</source>
        <publisher-name>CRC press</publisher-name>
        <year iso-8601-date="1984">1984</year>
        <pub-id pub-id-type="doi">10.1201/9781315139470</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
