<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7313</article-id>
<article-id pub-id-type="doi">10.21105/joss.07313</article-id>
<title-group>
<article-title>PeakPerformance - A tool for Bayesian inference-based
fitting of LC-MS/MS peaks</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5397-0682</contrib-id>
<name>
<surname>Nießer</surname>
<given-names>Jochen</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2734-7624</contrib-id>
<name>
<surname>Osthege</surname>
<given-names>Michael</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0309-8408</contrib-id>
<name>
<surname>von Lieres</surname>
<given-names>Eric</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8501-0694</contrib-id>
<name>
<surname>Wiechert</surname>
<given-names>Wolfgang</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9784-3626</contrib-id>
<name>
<surname>Noack</surname>
<given-names>Stephan</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Institute for Bio- and Geosciences (IBG-1),
Forschungszentrum Jülich GmbH, Jülich, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>RWTH Aachen University, Aachen, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Computational Systems Biotechnology, RWTH Aachen
University, Aachen, Germany</institution>
</institution-wrap>
</aff>
</contrib-group>
<volume>9</volume>
<issue>104</issue>
<fpage>7313</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Peak fitting</kwd>
<kwd>Bayesian inference</kwd>
<kwd>Chromatography</kwd>
<kwd>LC-MS/MS</kwd>
<kwd>Python</kwd>
<kwd>Uncertainty quantification</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>A major bottleneck of chromatography-based analytics has been the
  elusive fully automated identification and integration of peak data
  without the need of extensive human supervision. The presented Python
  package <inline-formula><alternatives>
  <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>
  applies Bayesian inference to chromatographic peak fitting, and
  provides an automated approach featuring model selection and
  uncertainty quantification. Regarding peak acceptance, it improves on
  vendor software solutions with more sophisticated, multi-layered
  metrics for decision making based on convergence of the parameter
  estimation as well as the uncertainties of peak parameters. Currently,
  its application is focused on data from targeted liquid chromatography
  tandem mass spectrometry (LC-MS/MS), but its design allows for an
  expansion to other chromatographic techniques and accommodates users
  with little programming experience by supplying convenience functions
  and relying on Microsoft Excel for data input and reporting.
  <inline-formula><alternatives>
  <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>
  is implemented in Python, its source code is available on
  <ext-link ext-link-type="uri" xlink:href="https://github.com/JuBiotech/peak-performance">GitHub</ext-link>,
  and a thorough documentation is available under
  <ext-link ext-link-type="uri" xlink:href="https://peak-performance.rtfd.io">https://peak-performance.rtfd.io</ext-link>.
  It is unit-tested on Linux and Windows and accompanied by example
  notebooks.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>In biotechnological research and industrial applications,
  chromatographic techniques are ubiquitously used to analyze samples
  from fermentations, e.g. to determine the concentration of substrates
  and products. Over the course of a regular lab-scale bioreactor
  fermentation, hundreds of samples and subsequently thousands of
  chromatographic peaks may accrue. This is exacerbated by the spread of
  microbioreactors causing a further increase in the amount of samples
  per time
  (<xref alt="Hemmerich et al., 2018" rid="ref-RN149" ref-type="bibr">Hemmerich
  et al., 2018</xref>;
  <xref alt="Kostov et al., 2001" rid="ref-RN148" ref-type="bibr">Kostov
  et al., 2001</xref>). While the recognition and integration of peaks
  by vendor software is – in theory – automated, it typically requires
  visual inspection and occasional manual re-integration by the user due
  to a large number of false positives, false negatives or incorrectly
  determined baselines, ultimately downgrading it to a semi-automated
  process. Since this is a time-consuming, not to mention tedious,
  procedure and introduces the problem of comparability between purely
  manual and algorithm-based integration as well as user-specific
  differences, we instead propose a peak fitting solution based on
  Bayesian inference. The advantage of this approach is the complete
  integration of all relevant parameters – i.e. baseline, peak area and
  height, mean, signal-to-noise ratio etc. – into one single model
  through which all parameters are estimated simultaneously.
  Furthermore, Bayesian inference comes with uncertainty quantification
  for all peak model parameters, and thus does not merely yield a point
  estimate as would commonly be the case. It also grants access to novel
  metrics for avoiding false positives and negatives by rejecting
  signals where a) a convergence criterion of the peak fitting procedure
  was not fulfilled or b) the uncertainty of the estimated parameters
  exceeded a user-defined threshold. By employing peak fitting to
  uncover peak parameters – most importantly the area – this approach
  thus differs from recent applications of Bayesian statistics to
  chromatographic peak data which e.g. focused on peak detection
  (<xref alt="Vivó-Truyols, 2012" rid="ref-vivo2012bayesian" ref-type="bibr">Vivó-Truyols,
  2012</xref>;
  <xref alt="Woldegebriel &amp; Vivó-Truyols, 2015" rid="ref-woldegebriel2015probabilistic" ref-type="bibr">Woldegebriel
  &amp; Vivó-Truyols, 2015</xref>), method optimization
  (<xref alt="Wiczling &amp; Kaliszan, 2016" rid="ref-wiczling2016much" ref-type="bibr">Wiczling
  &amp; Kaliszan, 2016</xref>) and simulations of chromatography
  (<xref alt="Briskot et al., 2019" rid="ref-briskot2019prediction" ref-type="bibr">Briskot
  et al., 2019</xref>;
  <xref alt="Yamamoto et al., 2021" rid="ref-yamamoto2021uncertainty" ref-type="bibr">Yamamoto
  et al., 2021</xref>). The first studies to be published about this
  topic contain perhaps the technique most similar in spirit to the
  present one since functions made of an idealized peak shape and a
  noise term are fitted but beyond this common starting point the
  methodology is quite distinct
  (<xref alt="Kelly &amp; Harris, 1971b" rid="ref-kelly1971estimation" ref-type="bibr">Kelly
  &amp; Harris, 1971b</xref>,
  <xref alt="1971a" rid="ref-kelly1971application" ref-type="bibr">1971a</xref>).</p>
</sec>
<sec id="materials-and-methods">
  <title>Materials and Methods</title>
  <sec id="implementation">
    <title>Implementation</title>
    <p><inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>
    is an open source Python package compatible with Windows and
    Linux/Unix platforms. At the time of manuscript submission, it
    features three modules: <monospace>pipeline</monospace>,
    <monospace>models</monospace>, and <monospace>plotting</monospace>.
    Due to its modular design, <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>
    can easily be expanded by adding e.g. additional models for
    deviating peak shapes or different plots. Currently, the featured
    peak models describe peaks in the shape of normal or skew normal
    distributions, as well as double peaks of normal or skewed normal
    shape. The normal distribution is regarded as the ideal peak shape
    and common phenomena like tailing and fronting can be expressed by
    the skew normal distribution
    (<xref alt="Azzalini, 1985" rid="ref-RN144" ref-type="bibr">Azzalini,
    1985</xref>). Bayesian inference is conducted utilizing the PyMC
    package
    (<xref alt="Abril-Pla et al., 2023" rid="ref-RN150" ref-type="bibr">Abril-Pla
    et al., 2023</xref>) with the external sampler
    <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{nutpie}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝚗𝚞𝚝𝚙𝚒𝚎</mml:mtext></mml:math></alternatives></inline-formula>
    for improved performance
    (<xref alt="Seyboldt &amp; PyMC Developers, 2022" rid="ref-nutpie" ref-type="bibr">Seyboldt
    &amp; PyMC Developers, 2022</xref>). Both model selection and
    analysis of inference data objects are realized with the ArviZ
    package
    (<xref alt="Kumar et al., 2019" rid="ref-RN147" ref-type="bibr">Kumar
    et al., 2019</xref>). Since the inference data is stored alongside
    graphs and report sheets, users may employ the ArviZ package or
    others for further analysis of the results if necessary.</p>
  </sec>
</sec>
<sec id="results-and-discussion">
  <title>Results and Discussion</title>
  <sec id="peakperformance-workflow">
    <title>PeakPerformance workflow</title>
    <p><inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>
    accommodates the use of a pre-manufactured data pipeline for
    standard applications (Fig. 1) as well as the creation of custom
    data pipelines using only its core functions. The provided data
    analysis pipeline was designed in a user-friendly way and is covered
    by multiple example notebooks.</p>
    <p>Before using <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>,
    the user has to supply raw data files containing a NumPy array with
    time in the first and intensity in the second dimension for each
    peak as described in detail in the documentation. Using the
    <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{prepare\_model\_selection()}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝚙𝚛𝚎𝚙𝚊𝚛𝚎_𝚖𝚘𝚍𝚎𝚕_𝚜𝚎𝚕𝚎𝚌𝚝𝚒𝚘𝚗()</mml:mtext></mml:math></alternatives></inline-formula>
    method, an Excel template file (“Template.xlsx”) for inputting user
    information is prepared and stored in the raw data directory.</p>
    <p>Since targeted LC-MS/MS analyses essentially cycle through a list
    of mass traces for every sample, a model type has to be assigned to
    each mass trace. If this is not done by the user, an optional
    automated model selection step will be performed, where one
    exemplary peak per mass trace is analyzed with all models to
    identify the most appropriate one. Its results for each model are
    ranked based on Pareto-smoothed importance sampling leave-one-out
    cross-validation (LOO-PIT)
    (<xref alt="Vehtari et al., 2016" rid="ref-RN145" ref-type="bibr">Vehtari
    et al., 2016</xref>;
    <xref alt="Watanabe, 2010" rid="ref-RN146" ref-type="bibr">Watanabe,
    2010</xref>).</p>
    <p><inline-graphic mimetype="image" mime-subtype="png" xlink:href="./Fig3_PP-standalone.png" />
    <bold>Figure 1:</bold> Overview of the pre-manufactured data
    analysis pipeline featured in <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>.</p>
    <p>Subsequently, the peak analysis pipeline can be started with the
    function <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{pipeline()}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝚙𝚒𝚙𝚎𝚕𝚒𝚗𝚎()</mml:mtext></mml:math></alternatives></inline-formula>
    from the <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{pipeline}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝚙𝚒𝚙𝚎𝚕𝚒𝚗𝚎</mml:mtext></mml:math></alternatives></inline-formula>
    module. Depending on whether the “pre-filtering” option was
    selected, an optional filtering step will be executed to reject
    signals where clearly no peak is present before sampling, thus
    saving computation time. Upon passing the first filter, a Markov
    chain Monte Carlo (MCMC) simulation is conducted using a No-U-Turn
    Sampler (NUTS)
    (<xref alt="Hoffmann &amp; Gelman, 2014" rid="ref-RN173" ref-type="bibr">Hoffmann
    &amp; Gelman, 2014</xref>), preferably - if installed in the Python
    environment - the <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{nutpie}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝚗𝚞𝚝𝚙𝚒𝚎</mml:mtext></mml:math></alternatives></inline-formula>
    sampler
    (<xref alt="Seyboldt &amp; PyMC Developers, 2022" rid="ref-nutpie" ref-type="bibr">Seyboldt
    &amp; PyMC Developers, 2022</xref>) due to its highly increased
    performance compared to the default sampler of PyMC. When a
    posterior distribution has been obtained, the main filtering step is
    next in line checking the convergence of the Markov chains via the
    potential scale reduction factor
    (<xref alt="Gelman &amp; Rubin, 1992" rid="ref-RN152" ref-type="bibr">Gelman
    &amp; Rubin, 1992</xref>) or <inline-formula><alternatives>
    <tex-math><![CDATA[\hat{R}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>R</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
    statistic and based on the uncertainty of the determined peak
    parameters. If a signal was accepted as a peak, a posterior
    predictive check is conducted and added to the inference data object
    resulting from the model simulation. Regarding the performance of
    the simulation, in our tests an analysis of a single peak took 20 s
    to 30 s and of a double peak 25 s to 90 s. This is of course
    dependent on the type of sampler, the power of the computer as well
    as whether an additional simulation with an increased number of
    samples needs to be conducted.</p>
  </sec>
  <sec id="peak-fitting-results-and-diagnostic-plots">
    <title>Peak fitting results and diagnostic plots</title>
    <p>The most complete report created after completing a cycle of the
    data pipeline is found in an Excel file called
    “peak_data_summary.xlsx”. Here, each analyzed time series has
    multiple rows (one per peak parameter) with the columns containing
    estimation results in the form of mean and standard deviation (sd)
    of the marginal posterior distribution, highest density interval
    (HDI), and the <inline-formula><alternatives>
    <tex-math><![CDATA[\hat{R}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>R</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
    statistic among other metrics. The second Excel file created is
    denominated as “area_summary.xlsx” and is a more handy version of
    “peak_data_summary.xlsx” with a reduced degree of detail since
    subsequent data analyses will most likely rely on the peak area. The
    most valuable result, however, are the inference data objects saved
    to disk for each signal for which a peak function was successfully
    fitted. Conveniently, the inference data objects saved as
    <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{*.nc}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">*.𝚗𝚌</mml:mtext></mml:math></alternatives></inline-formula>
    files contain all data and metadata related to the Bayesian
    parameter estimation, enabling the user to perform diagnostics or
    create custom visualizations not already provided by
    <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>.
    Regarding data visualization with the matplotlib package
    (<xref alt="Hunter, 2007" rid="ref-matplotlib" ref-type="bibr">Hunter,
    2007</xref>;
    <xref alt="The Matplotlib Development Team, 2024" rid="ref-matplotlibzenodo" ref-type="bibr">The
    Matplotlib Development Team, 2024</xref>),
    <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>’s
    <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{plots}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝚙𝚕𝚘𝚝𝚜</mml:mtext></mml:math></alternatives></inline-formula>
    module offers the generation of two diagram types for each
    successfully fitted peak. The posterior plot presents the fit of the
    intensity function alongside the raw data points. The first row of
    Figure 2 presents two such examples where the single peak diagram
    shows the histidine (His) fragment with a m/z ratio of 110 Da and
    the double peak diagram the leucine (Leu) and isoleucine (Ile)
    fragments with a m/z ratio of 86 Da.</p>
    <p><inline-graphic mimetype="image" mime-subtype="png" xlink:href="./Fig4_peak_results.png" />
    <bold>Figure 2:</bold> Results plots for a single His peak and a
    double Leu and Ile peak depicting the peak fit (first row) and the
    posterior predictive checks (second row) alongside the raw data. The
    numerical results are listed in Table 2.</p>
    <p>The posterior predictive plots in the second row of Figure 4 are
    provided for visual posterior predictive checks, namely the
    comparison of observed and predicted data distribution. Since a
    posterior predictive check is based on drawing samples from the
    likelihood function, the result represents the theoretical range of
    values encompassed by the model. Accordingly, this plot enables
    users to judge whether the selected model can accurately explain the
    data. To complete the example, Table 2 shows the results of the fit
    in the form of mean, standard deviation, and HDI of each parameter’s
    marginal posterior.</p>
    <p><bold>Table 2:</bold> Depiction of the results for the most
    important peak parameters of a single peak fit with the skew normal
    model and a double peak fit with the double normal model. Mean,
    area, and height have been highlighted in bold print as they
    constitute the most relevant parameters for further data evaluation
    purposes. The results correspond to the fits exhibited in Figure
    2.</p>
    <graphic mimetype="image" mime-subtype="svg+xml" xlink:href="./summary_joint.svg" />
    <p>In this case, the fits were successful and convergence was
    reached for all parameters. Most notably and for the first time, the
    measurement noise was taken into account when determining the peak
    area as represented by its standard deviation and as can be observed
    in the posterior predictive plots where the noisy data points fall
    within the boundary of the 95 % HDI. In the documentation, there is
    a study featuring simulated and experimental data to validate
    <inline-formula><alternatives>
    <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>’s
    results against a commercially available vendor software for peak
    integration showing that comparable results are indeed obtained.</p>
    <sec id="author-contributions">
      <title>Author contributions</title>
      <p><inline-formula><alternatives>
      <tex-math><![CDATA[\texttt{PeakPerformance}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtext mathvariant="monospace">𝙿𝚎𝚊𝚔𝙿𝚎𝚛𝚏𝚘𝚛𝚖𝚊𝚗𝚌𝚎</mml:mtext></mml:math></alternatives></inline-formula>
      was conceptualized by JN and MO. Software implementation was
      conducted by JN with code review by MO. The original draft was
      written by JN with review and editing by MO, SN, EvL, and WW. The
      work was supervised by SN and funding was acquired by SN, EvL, and
      WW.</p>
    </sec>
    <sec id="acknowledgements">
      <title>Acknowledgements</title>
      <p>The authors thank Tobias Latour for providing experimental
      LC-MS/MS data for the comparison with the vendor software
      MultiQuant. Funding was received from the German Federal Ministry
      of Education and Research (BMBF) (grant number 031B1134A) as part
      of the innovation lab “AutoBioTech” within the project
      “Modellregion, BioRevierPLUS: BioökonomieREVIER Innovationscluster
      Biotechnologie &amp; Kunststofftechnik”.</p>
    </sec>
    <sec id="competing-interests">
      <title>Competing interests</title>
      <p>No competing interest is declared.</p>
    </sec>
    <sec id="data-availability">
      <title>Data availability</title>
      <p>The datasets generated during and/or analyzed during the
      current study are available in version 0.7.1 of the
      <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/11189842">Zenodo
      record</ext-link>.</p>
    </sec>
  </sec>
</sec>
</body>
<back>
<ref-list>
  <title>Bibliography</title>
  <ref id="ref-nutpie">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Seyboldt</surname><given-names>Adrian</given-names></name>
        <string-name>PyMC Developers</string-name>
      </person-group>
      <article-title>nutpie</article-title>
      <year iso-8601-date="2022">2022</year>
      <uri>https://github.com/pymc-devs/nutpie</uri>
    </element-citation>
  </ref>
  <ref id="ref-matplotlib">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hunter</surname><given-names>J. D.</given-names></name>
      </person-group>
      <article-title>Matplotlib: A 2D graphics environment</article-title>
      <source>Computing in Science &amp; Engineering</source>
      <publisher-name>IEEE COMPUTER SOC</publisher-name>
      <year iso-8601-date="2007">2007</year>
      <volume>9</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      <fpage>90</fpage>
      <lpage>95</lpage>
    </element-citation>
  </ref>
  <ref id="ref-matplotlibzenodo">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>The Matplotlib Development Team</string-name>
      </person-group>
      <article-title>Matplotlib: Visualization with Python</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2024-05">2024</year><month>05</month>
      <uri>https://doi.org/10.5281/zenodo.11201097</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.11201097</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-RN173">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hoffmann</surname><given-names>Matthew D.</given-names></name>
        <name><surname>Gelman</surname><given-names>Andrew</given-names></name>
      </person-group>
      <article-title>The No-U-Turn Sampler: Adaptively Setting Path Lengths in Hamiltonian Monte Carlo</article-title>
      <source>Journal of Machine Learning Research</source>
      <year iso-8601-date="2014">2014</year>
      <volume>15</volume>
    </element-citation>
  </ref>
  <ref id="ref-RN150">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Abril-Pla</surname><given-names>O.</given-names></name>
        <name><surname>Andreani</surname><given-names>V.</given-names></name>
        <name><surname>Carroll</surname><given-names>C.</given-names></name>
        <name><surname>Dong</surname><given-names>L.</given-names></name>
        <name><surname>Fonnesbeck</surname><given-names>C. J.</given-names></name>
        <name><surname>Kochurov</surname><given-names>M.</given-names></name>
        <name><surname>Kumar</surname><given-names>R.</given-names></name>
        <name><surname>Lao</surname><given-names>J.</given-names></name>
        <name><surname>Luhmann</surname><given-names>C. C.</given-names></name>
        <name><surname>Martin</surname><given-names>O. A.</given-names></name>
        <name><surname>Osthege</surname><given-names>M.</given-names></name>
        <name><surname>Vieira</surname><given-names>R.</given-names></name>
        <name><surname>Wiecki</surname><given-names>T.</given-names></name>
        <name><surname>Zinkov</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>PyMC: A modern, and comprehensive probabilistic programming framework in Python</article-title>
      <source>PeerJ Computer Science</source>
      <year iso-8601-date="2023">2023</year>
      <volume>9</volume>
      <issn>2376-5992</issn>
      <uri>https://www.ncbi.nlm.nih.gov/pubmed/37705656</uri>
      <pub-id pub-id-type="doi">10.7717/peerj-cs.1516</pub-id>
      <fpage>e1516</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-RN144">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Azzalini</surname><given-names>A.</given-names></name>
      </person-group>
      <article-title>A class of distributions which includes the normal ones</article-title>
      <source>Scandinavian Journal of Statistics</source>
      <year iso-8601-date="1985">1985</year>
      <volume>12</volume>
      <uri>http://www.jstor.org/stable/4615982</uri>
      <fpage>171</fpage>
      <lpage>178</lpage>
    </element-citation>
  </ref>
  <ref id="ref-RN152">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gelman</surname><given-names>Andrew</given-names></name>
        <name><surname>Rubin</surname><given-names>Donald B.</given-names></name>
      </person-group>
      <article-title>Inference from Iterative Simulation Using Multiple Sequences</article-title>
      <source>Statistical Science</source>
      <year iso-8601-date="1992">1992</year>
      <volume>7</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1214/ss/1177011136</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-RN149">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hemmerich</surname><given-names>J.</given-names></name>
        <name><surname>Noack</surname><given-names>S.</given-names></name>
        <name><surname>Wiechert</surname><given-names>W.</given-names></name>
        <name><surname>Oldiges</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>Microbioreactor Systems for Accelerated Bioprocess Development</article-title>
      <source>Biotechnology Journal</source>
      <year iso-8601-date="2018">2018</year>
      <volume>13</volume>
      <issue>4</issue>
      <issn>1860-7314</issn>
      <uri>https://www.ncbi.nlm.nih.gov/pubmed/29283217</uri>
      <pub-id pub-id-type="doi">10.1002/biot.201700141</pub-id>
      <fpage>e1700141</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-RN148">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kostov</surname><given-names>Y.</given-names></name>
        <name><surname>Harms</surname><given-names>P.</given-names></name>
        <name><surname>Randers-Eichhorn</surname><given-names>L.</given-names></name>
        <name><surname>Rao</surname><given-names>G.</given-names></name>
      </person-group>
      <article-title>Low-cost microbioreactor for high-throughput bioprocessing</article-title>
      <source>Biotechnology and Bioengineering</source>
      <year iso-8601-date="2001">2001</year>
      <volume>72</volume>
      <issue>3</issue>
      <issn>0006-3592</issn>
      <uri>https://www.ncbi.nlm.nih.gov/pubmed/11135205</uri>
      <pub-id pub-id-type="doi">10.1002/1097-0290(20010205)72:3&lt;346::aid-bit12&gt;3.0.co;2-x</pub-id>
      <fpage>346</fpage>
      <lpage>52</lpage>
    </element-citation>
  </ref>
  <ref id="ref-RN145">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vehtari</surname><given-names>Aki</given-names></name>
        <name><surname>Gelman</surname><given-names>Andrew</given-names></name>
        <name><surname>Gabry</surname><given-names>Jonah</given-names></name>
      </person-group>
      <article-title>Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC</article-title>
      <source>Statistics and Computing</source>
      <year iso-8601-date="2016">2016</year>
      <volume>27</volume>
      <issue>5</issue>
      <issn>0960-3174</issn>
      <pub-id pub-id-type="doi">10.1007/s11222-016-9696-4</pub-id>
      <fpage>1413</fpage>
      <lpage>1432</lpage>
    </element-citation>
  </ref>
  <ref id="ref-RN146">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Watanabe</surname><given-names>Sumio</given-names></name>
      </person-group>
      <article-title>Asymptotic Equivalence of Bayes Cross Validation and Widely Applicable Information Criterion in Singular Learning Theory</article-title>
      <source>Journal of Machine Learning Research</source>
      <year iso-8601-date="2010">2010</year>
      <volume>11</volume>
      <fpage>3571</fpage>
      <lpage>3594</lpage>
    </element-citation>
  </ref>
  <ref id="ref-RN147">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kumar</surname><given-names>Ravin</given-names></name>
        <name><surname>Carroll</surname><given-names>Colin</given-names></name>
        <name><surname>Hartikainen</surname><given-names>Ari</given-names></name>
        <name><surname>Martin</surname><given-names>Osvaldo</given-names></name>
      </person-group>
      <article-title>ArviZ a unified library for exploratory analysis of Bayesian models in Python</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>33</issue>
      <issn>2475-9066</issn>
      <pub-id pub-id-type="doi">10.21105/joss.01143</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-vivo2012bayesian">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vivó-Truyols</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Bayesian approach for peak detection in two-dimensional chromatography</article-title>
      <source>Analytical Chemistry</source>
      <publisher-name>ACS Publications</publisher-name>
      <year iso-8601-date="2012">2012</year>
      <volume>84</volume>
      <issue>6</issue>
      <pub-id pub-id-type="doi">10.1021/ac202124t</pub-id>
      <fpage>2622</fpage>
      <lpage>2630</lpage>
    </element-citation>
  </ref>
  <ref id="ref-woldegebriel2015probabilistic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Woldegebriel</surname><given-names>Michael</given-names></name>
        <name><surname>Vivó-Truyols</surname><given-names>Gabriel</given-names></name>
      </person-group>
      <article-title>Probabilistic model for untargeted peak detection in LC–MS using Bayesian statistics</article-title>
      <source>Analytical Chemistry</source>
      <publisher-name>ACS Publications</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>87</volume>
      <issue>14</issue>
      <pub-id pub-id-type="doi">10.1021/acs.analchem.5b01521</pub-id>
      <fpage>7345</fpage>
      <lpage>7355</lpage>
    </element-citation>
  </ref>
  <ref id="ref-briskot2019prediction">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Briskot</surname><given-names>Till</given-names></name>
        <name><surname>Stückler</surname><given-names>Ferdinand</given-names></name>
        <name><surname>Wittkopp</surname><given-names>Felix</given-names></name>
        <name><surname>Williams</surname><given-names>Christopher</given-names></name>
        <name><surname>Yang</surname><given-names>Jessica</given-names></name>
        <name><surname>Konrad</surname><given-names>Susanne</given-names></name>
        <name><surname>Doninger</surname><given-names>Katharina</given-names></name>
        <name><surname>Griesbach</surname><given-names>Jan</given-names></name>
        <name><surname>Bennecke</surname><given-names>Moritz</given-names></name>
        <name><surname>Hepbildikler</surname><given-names>Stefan</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Prediction uncertainty assessment of chromatography models using Bayesian inference</article-title>
      <source>Journal of Chromatography A</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>1587</volume>
      <pub-id pub-id-type="doi">10.1016/j.chroma.2018.11.076</pub-id>
      <fpage>101</fpage>
      <lpage>110</lpage>
    </element-citation>
  </ref>
  <ref id="ref-yamamoto2021uncertainty">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yamamoto</surname><given-names>Yota</given-names></name>
        <name><surname>Yajima</surname><given-names>Tomoyuki</given-names></name>
        <name><surname>Kawajiri</surname><given-names>Yoshiaki</given-names></name>
      </person-group>
      <article-title>Uncertainty quantification for chromatography model parameters by Bayesian inference using sequential Monte Carlo method</article-title>
      <source>Chemical Engineering Research and Design</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>175</volume>
      <pub-id pub-id-type="doi">10.1016/j.cherd.2021.09.003</pub-id>
      <fpage>223</fpage>
      <lpage>237</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wiczling2016much">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wiczling</surname><given-names>Paweł</given-names></name>
        <name><surname>Kaliszan</surname><given-names>Roman</given-names></name>
      </person-group>
      <article-title>How much can we learn from a single chromatographic experiment? A Bayesian perspective</article-title>
      <source>Analytical Chemistry</source>
      <publisher-name>ACS Publications</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>88</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1021/acs.analchem.5b03859</pub-id>
      <fpage>997</fpage>
      <lpage>1002</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kelly1971estimation">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kelly</surname><given-names>PC</given-names></name>
        <name><surname>Harris</surname><given-names>WE</given-names></name>
      </person-group>
      <article-title>Estimation of chromatographic peaks with particular consideration of effects of base-line noise</article-title>
      <source>Analytical Chemistry</source>
      <publisher-name>ACS Publications</publisher-name>
      <year iso-8601-date="1971">1971</year>
      <volume>43</volume>
      <issue>10</issue>
      <pub-id pub-id-type="doi">10.1021/ac60304a011</pub-id>
      <fpage>1170</fpage>
      <lpage>1183</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kelly1971application">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kelly</surname><given-names>PC</given-names></name>
        <name><surname>Harris</surname><given-names>WE</given-names></name>
      </person-group>
      <article-title>Application of method of maximum posterior probability to estimation of gas-chromatographic peak parameters</article-title>
      <source>Analytical Chemistry</source>
      <publisher-name>ACS Publications</publisher-name>
      <year iso-8601-date="1971">1971</year>
      <volume>43</volume>
      <issue>10</issue>
      <pub-id pub-id-type="doi">10.1021/ac60304a005</pub-id>
      <fpage>1184</fpage>
      <lpage>1195</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
