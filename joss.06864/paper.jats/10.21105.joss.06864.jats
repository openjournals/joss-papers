<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6864</article-id>
<article-id pub-id-type="doi">10.21105/joss.06864</article-id>
<title-group>
<article-title>VOTCA: multiscale frameworks for quantum and classical
simulations in soft matter</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6077-0467</contrib-id>
<name>
<surname>Baumeier</surname>
<given-names>Björn</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1203-5000</contrib-id>
<name>
<surname>Wehner</surname>
<given-names>Jens</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9589-2694</contrib-id>
<name>
<surname>Renaud</surname>
<given-names>Nicolas</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8286-677X</contrib-id>
<name>
<surname>Ruiz</surname>
<given-names>Felipe Zapata</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4895-3762</contrib-id>
<name>
<surname>Halver</surname>
<given-names>Rene</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3658-3685</contrib-id>
<name>
<surname>Madhikar</surname>
<given-names>Pranav</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0738-8952</contrib-id>
<name>
<surname>Gerritsen</surname>
<given-names>Ruben</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6641-0761</contrib-id>
<name>
<surname>Tirimbo</surname>
<given-names>Gianluca</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sijen</surname>
<given-names>Javier</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-6620-6499</contrib-id>
<name>
<surname>Rosenberger</surname>
<given-names>David</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1227-6429</contrib-id>
<name>
<surname>Brown</surname>
<given-names>Joshua S.</given-names>
</name>
<xref ref-type="aff" rid="aff-6"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9986-8461</contrib-id>
<name>
<surname>Sundaram</surname>
<given-names>Vivek</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9372-6975</contrib-id>
<name>
<surname>Krajniak</surname>
<given-names>Jakub</given-names>
</name>
<xref ref-type="aff" rid="aff-7"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-6520-5208</contrib-id>
<name>
<surname>Bernhardt</surname>
<given-names>Marvin</given-names>
</name>
<xref ref-type="aff" rid="aff-8"/>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0925-1458</contrib-id>
<name>
<surname>Junghans</surname>
<given-names>Christoph</given-names>
</name>
<xref ref-type="aff" rid="aff-9"/>
<xref ref-type="corresp" rid="cor-2"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Mathematics and Computer Science, Eindhoven
University of Technology, the Netherlands</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Institute for Complex Molecular Systems, Eindhoven
University of Technology, the Netherlands</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Netherlands eScience Center, the Netherlands</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Forschungszentrum Jülich, Jülich, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Freie Universität Berlin, Berlin, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-6">
<institution-wrap>
<institution>Oak Ridge National Laboratory, Oak Ridge, TN,
USA</institution>
</institution-wrap>
</aff>
<aff id="aff-7">
<institution-wrap>
<institution>Independent researcher, Poznań, Poland</institution>
</institution-wrap>
</aff>
<aff id="aff-8">
<institution-wrap>
<institution>Technische Universität Darmstadt, Darmstadt,
Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-9">
<institution-wrap>
<institution>Los Alamos National Laboratory, Los Alamos, New Mexico,
USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
<corresp id="cor-2">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-05-10">
<day>10</day>
<month>5</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>99</issue>
<fpage>6864</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>coarse-graining</kwd>
<kwd>DFT</kwd>
<kwd>Quantum calculations</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Many physical phenomena in liquids and soft matter are multiscale
  by nature and can involve processes with quantum and classical degrees
  of freedom occurring over a vast range of length- and timescales.
  Examples range from structure formation processes of complex polymers
  or even polymer blends
  (<xref alt="Svaneborg &amp; Everaers, 2023" rid="ref-Svaneborg2023" ref-type="bibr">Svaneborg
  &amp; Everaers, 2023</xref>) on the classical side to charge and
  energy transport and conversion processes
  (<xref alt="Lee et al., 2019" rid="ref-Lee2019" ref-type="bibr">Lee et
  al., 2019</xref>) involving explicit electronic and, therefore,
  quantum information.</p>
  <p>The Versatile Object-oriented Toolkit for Coarse-graining
  Applications (VOTCA) provides multiscale frameworks built on a
  comprehensive set of methods for the development of classical
  coarse-grained potentials (VOTCA-CSG) as well as state-of-the art
  excited state electronic structure methods based on density-functional
  and many-body Green’s function theories, coupled in mixed
  quantum-classical models and used in kinetic network models
  (VOTCA-XTP).</p>
  <fig>
    <caption><p>Overview of the different VOTCA modules and external
    interfaces. The trajectory reader of VOTCA-CSG in the dashed line
    box are reused by
    VOTCA-XTP.<styled-content id="figU003AVOTCA_graph"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="VOTCA_graph.pdf" />
  </fig>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>VOTCA was originally developed as a platform for development and
  comparison of coarse-graining (CSG) methods. Since the last software
  publication in 2015, VOTCA-CSG was strengthened by adding more
  methods, more examples, and involving more developers. Many users have
  used VOTCA to compare different coarse-graining strategies on a
  neutral ground and, if needed, proceeded with a more specialized
  package based on the gained insight
  (<xref alt="Rudzinski et al., 2021" rid="ref-Rudzinski_2021" ref-type="bibr">Rudzinski
  et al., 2021</xref>). Such other coarse-graining packages include,
  among others, BOCS
  (<xref alt="Dunn et al., 2018" rid="ref-bocs" ref-type="bibr">Dunn et
  al., 2018</xref>), DeePCG
  (<xref alt="Zhang et al., 2018" rid="ref-deepcg" ref-type="bibr">Zhang
  et al., 2018</xref>), IBIsCO
  (<xref alt="Karimi-Varzaneh et al., 2011" rid="ref-ibisco" ref-type="bibr">Karimi-Varzaneh
  et al., 2011</xref>), MagiC
  (<xref alt="Mirzoev &amp; Lyubartsev, 2013" rid="ref-magic" ref-type="bibr">Mirzoev
  &amp; Lyubartsev, 2013</xref>) and OpenMSCG
  (<xref alt="Peng et al., 2023" rid="ref-openmscg" ref-type="bibr">Peng
  et al., 2023</xref>), some of which are not open-source or specialized
  in one method. Others are no longer being maintained or lack
  contributions from the greater community. It is difficult to build an
  all-inclusive community package for coarse-graining as it is sometimes
  hard to consolidate different development styles and constantly
  changing priorities from sponsors that leave little time for good
  software engineering practices. In this context we would like to point
  out that there is a fork of the VOTCA package
  (<xref alt="Andrienko et al., 2023" rid="ref-mpip-votca" ref-type="bibr">Andrienko
  et al., 2023</xref>) that contains some feature, e.g., kernel-based
  machine learning methods
  (<xref alt="Scherer et al., 2020" rid="ref-mlpot" ref-type="bibr">Scherer
  et al., 2020</xref>), that has not been merged.</p>
  <p>Next to strengthening the coarse-graining functionality of VOTCA,
  another major development direction taken since 2015 is the addition
  of explicit quantum-mechanical modules aiming at the simulation of
  static and dynamic properties of electronically excited states in
  complex molecular environments using multiscale frameworks.
  Specifically, the VOTCA-XTP part provides an open-source
  implementation of many-body Green’s functions methods (known as
  <inline-formula><alternatives>
  <tex-math><![CDATA[GW]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>G</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>-BSE)
  with the capability of linking this quantum-mechanical description of
  a molecular system to a classical (microelectrostatic) environment
  model, and to perform rate-based dynamic simulations with kinetic
  Monte-Carlo. Basic <inline-formula><alternatives>
  <tex-math><![CDATA[GW]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>G</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>-BSE
  functionality in molecular settings has also more recently been
  supported in other packages, such as Turbomole
  (<xref alt="Balasubramani et al., 2020" rid="ref-turbomole" ref-type="bibr">Balasubramani
  et al., 2020</xref>), ADF
  (<xref alt="Velde et al., 2001" rid="ref-ADF2001" ref-type="bibr">Velde
  et al., 2001</xref>), PySCF
  (<xref alt="Sun et al., 2020" rid="ref-pyscf" ref-type="bibr">Sun et
  al., 2020</xref>), or MOLGW
  (<xref alt="Bruneval et al., 2016" rid="ref-molgw" ref-type="bibr">Bruneval
  et al., 2016</xref>), but these are either commercial or do not
  provide links to a multiscale framework for complex environments and
  dynamics.</p>
  <sec id="coarse-graining">
    <title>Coarse-Graining</title>
    <p>In the coarse-graining part of VOTCA, VOTCA-CSG, we made a lot of
    improvements to the inverse Monte Carlo (IMC) method and have added
    a new iterative approach, the so-called iterative integral equation
    (IIE) method, which are both described in detail below and in
    reference therein.</p>
    <sec id="inverse-monte-carlo-updates">
      <title>Inverse Monte Carlo updates</title>
      <p>The inverse Monte Carlo Method introduced by Lyubartsev &amp;
      Laaksonen
      (<xref alt="1995" rid="ref-lyubartsev_calculation_1995" ref-type="bibr">1995</xref>)
      is a structure-based coarse graining method, whose goal it is to
      find an effective pair potential between particles, which
      reproduces the radial distribution function (RDF) of a reference
      system (ref) at the coarse grained (CG) resolution. IMC has been
      part of VOTCA since its first release. In the original
      implementation the pair potential was determined by iteratively
      solving a set of linear equations:
      <named-content id="solve_imc_orig" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[
      (A^TA)\Delta U_{ij} = A^T(g_{ij}^{n-1} - g_{ij}^{ref}),]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>A</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      where <inline-formula><alternatives>
      <tex-math><![CDATA[g_{ij}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
      is the RDF between particles <inline-formula><alternatives>
      <tex-math><![CDATA[i]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[j]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>,
      <inline-formula><alternatives>
      <tex-math><![CDATA[n]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>
      indicates the iteration counter, <inline-formula><alternatives>
      <tex-math><![CDATA[\Delta U_{ij}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
      is the potential update term, and <inline-formula><alternatives>
      <tex-math><![CDATA[A]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>A</mml:mi></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[A^T]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></alternatives></inline-formula>
      are the Jacobian and its corresponding transpose. The Jacobian
      <inline-formula><alternatives>
      <tex-math><![CDATA[A]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>A</mml:mi></mml:math></alternatives></inline-formula>
      is defined as:
      <named-content id="eqn_A" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[
      A = \frac{\partial g_{ij}}{\partial U_{ij}},]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      where <inline-formula><alternatives>
      <tex-math><![CDATA[U_{ij}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
      is the pair potential between particles i and j.</p>
      <p>Rosenberger et al.
      (<xref alt="2016" rid="ref-rosenberger_comparison_2016" ref-type="bibr">2016</xref>),
      among others
      (<xref alt="Lyubartsev et al., 2010" rid="ref-lyubartsev_systematic_2010" ref-type="bibr">Lyubartsev
      et al., 2010</xref>;
      <xref alt="Murtola et al., 2007" rid="ref-murtola_coarse-grained_2007" ref-type="bibr">Murtola
      et al., 2007</xref>;
      <xref alt="Tóth, 2003" rid="ref-toth_iterative_2003" ref-type="bibr">Tóth,
      2003</xref>), demonstrated that the standard IMC method can suffer
      from numerical instabilities and/or slow convergence. Therefore, a
      Tikhonov regularization
      (<xref alt="Engl &amp; Ramlau, 2015" rid="ref-engl2000regularization" ref-type="bibr">Engl
      &amp; Ramlau, 2015</xref>) for IMC has been implemented in VOTCA.
      This regularization changes the linear equations according to
      Rosenberger et al.
      (<xref alt="2016" rid="ref-rosenberger_comparison_2016" ref-type="bibr">2016</xref>):
      <named-content id="solve_imc" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[
      (A^TA + \lambda I)\Delta U_{ij} = A^T(g_{ij}^{n-1} - g_{ij}^{ref}),]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>A</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mi>I</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>Δ</mml:mi><mml:msub><mml:mi>U</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msubsup><mml:mi>g</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      where <inline-formula><alternatives>
      <tex-math><![CDATA[\lambda]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
      determines the strength of the regularization and
      <inline-formula><alternatives>
      <tex-math><![CDATA[I]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>I</mml:mi></mml:math></alternatives></inline-formula>
      is the identity matrix. One can perform a singular value
      decomposition of the Jacobian <inline-formula><alternatives>
      <tex-math><![CDATA[A]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>A</mml:mi></mml:math></alternatives></inline-formula>
      to determine an initial value for <inline-formula><alternatives>
      <tex-math><![CDATA[\lambda]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
      (<xref alt="Rosenberger et al., 2016" rid="ref-rosenberger_comparison_2016" ref-type="bibr">Rosenberger
      et al., 2016</xref>). As a rule of thumb
      <inline-formula><alternatives>
      <tex-math><![CDATA[\lambda]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
      should at least be at the order of the smallest singular values
      squared.</p>
    </sec>
    <sec id="iterative-integral-equation-method">
      <title>Iterative Integral Equation method</title>
      <p>The iterative integral equation methods are similar to IMC in
      that they also aim at reconstructing the RDF of a fine-grained
      reference system with an effective pair potential. The main
      difference is in the construction of the Jacobian, which is
      approximated in IIE methods from integral equation theory
      (<xref alt="Delbary et al., 2020" rid="ref-delbaryGeneralizedNewtonIteration2020" ref-type="bibr">Delbary
      et al., 2020</xref>). For a molecular fluid, where each molecule
      is mapped to a single bead, using the Ornstein-Zernicke equation
      and the hypernetted-chain closure, one arrives at the Jacobian
      inverse with the form of
      <named-content id="eqU003Adudg" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[
      A^{-1} = \frac{dU}{dg} = \frac{1}{\beta} \left( 1 - \frac{1}{g} - \mathcal{F}^{-1} \left( \frac{1}{(1 + \rho \hat{h})^2}\right) \mathcal{F} \right) .]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mi>−</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>g</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>β</mml:mi></mml:mfrac><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>g</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:msup><mml:mi>ℱ</mml:mi><mml:mrow><mml:mi>−</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:mover><mml:mi>h</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>ℱ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      Here, <inline-formula><alternatives>
      <tex-math><![CDATA[\hat{h}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>h</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
      is the Fourier transform of <inline-formula><alternatives>
      <tex-math><![CDATA[h = g - 1]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[\mathcal{F}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ℱ</mml:mi></mml:math></alternatives></inline-formula>
      is the Fourier operator. This approximate Jacobian works well for
      systems with single-bead molecule representations with convergence
      as fast as IMC, whereas in the general case, convergence is half
      as fast as IMC
      (<xref alt="Bernhardt et al., 2023" rid="ref-bernhardt_stability_2023" ref-type="bibr">Bernhardt
      et al., 2023</xref>). The costly sampling of the IMC matrix is not
      needed, only an RDF which is calculated on twice the range as the
      potential
      (<xref alt="Bernhardt et al., 2021" rid="ref-bernhardt_iterative_2021" ref-type="bibr">Bernhardt
      et al., 2021</xref>).</p>
    </sec>
    <sec id="constraints">
      <title>Constraints</title>
      <p>When using the IMC or IIE methods described above to find pair
      potentials, that best reproduce a reference RDF, one can use the
      Gauss-Newton algorithm and formulate the problem of finding a
      potential update <inline-formula><alternatives>
      <tex-math><![CDATA[\Delta U]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>U</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      as a minimization
      <named-content id="eqU003AGN" content-type="equation"><disp-formula><tex-math><![CDATA[
      \underset{\Delta U}{\text{arg\,min}} \lvert\lvert \Delta g + A \Delta U \lvert\lvert_2]]></tex-math></disp-formula></named-content>
      where <inline-formula><alternatives>
      <tex-math><![CDATA[\Delta g = g - g_\mathrm{target}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">g</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.
      In that case, additional constraints can be introduced. For
      example, it is possible to describe the pressure of a system in
      terms of the RDF <inline-formula><alternatives>
      <tex-math><![CDATA[g]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>g</mml:mi></mml:math></alternatives></inline-formula>
      and the pair potential <inline-formula><alternatives>
      <tex-math><![CDATA[U]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>U</mml:mi></mml:math></alternatives></inline-formula>.
      From a target pressure and the current pressure at each iteration,
      a constraint of the form <inline-formula><alternatives>
      <tex-math><![CDATA[B \Delta U = d]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>B</mml:mi><mml:mi>Δ</mml:mi><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      can be described and the constraint is enforced by elimination
      (<xref alt="Bernhardt et al., 2021" rid="ref-bernhardt_iterative_2021" ref-type="bibr">Bernhardt
      et al., 2021</xref>).</p>
    </sec>
  </sec>
  <sec id="electronic-excitations">
    <title>Electronic Excitations</title>
    <p>The most substantial new feature in the VOTCA package is the
    addition of explicit quantum-mechanical functionalities in the
    VOTCA-XTP part. The added methods aim at a first-principles-based
    multiscale modeling of electronically excited states and their
    dynamics in complex molecular systems. We very briefly describe the
    three main modules of XTP in the following.</p>
    <sec id="density-functional-theory">
      <title>Density-Functional Theory</title>
      <p>Excited state calculations require a reference ground state
      calculation within density-functional theory. VOTCA-XTP provides
      both an automated interface to the ORCA package
      (<xref alt="Neese, 2012" rid="ref-neeseORCAProgramSystem2012" ref-type="bibr">Neese,
      2012</xref>) and a lightweight internal density-fucntional theory
      (DFT) engine based on atom-centered Gaussian-type orbitals for
      method developing and testing. It solves the Kohn-Sham (KS)
      Equations for the molecular orbitals
      <inline-formula><alternatives>
      <tex-math><![CDATA[\phi_n^\textrm{KS}(\mathbf{r})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      with orbital energies <inline-formula><alternatives>
      <tex-math><![CDATA[\varepsilon_n^\textrm{KS}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>
      <named-content id="equU003AKS" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\left\{ -\frac{\hbar^2}{2m}\nabla^2 + V_\mathrm{ext}(\mathbf{r}) + V_\textrm{H}(\mathbf{r}) +V_\textrm{xc}(\mathbf{r})\right\}\phi_n^\textrm{KS}(\mathbf{r})  =\varepsilon_n^\textrm{KS} \phi_n^\textrm{KS}(\mathbf{r}) ,
      ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:mi>−</mml:mi><mml:mfrac><mml:msup><mml:mi>ℏ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>∇</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">x</mml:mi><mml:mi mathvariant="normal">t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext mathvariant="normal">H</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext mathvariant="normal">xc</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      where <inline-formula><alternatives>
      <tex-math><![CDATA[V_\textrm{ext}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>V</mml:mi><mml:mtext mathvariant="normal">ext</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
      is the external potential, <inline-formula><alternatives>
      <tex-math><![CDATA[V_\textrm{H}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>V</mml:mi><mml:mtext mathvariant="normal">H</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
      the Hartree potential, and <inline-formula><alternatives>
      <tex-math><![CDATA[V_\textrm{xc}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>V</mml:mi><mml:mtext mathvariant="normal">xc</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
      the exchange-correlation potential. VOTCA-XTP also contains
      functionality for projector-based-embedding DFT-in-DFT ground
      state calculations
      (<xref alt="Manby et al., 2012" rid="ref-manby2012simple" ref-type="bibr">Manby
      et al., 2012</xref>), in which a chosen active subregion of a
      molecular system is embedded into an inactive one, reproducing the
      total energy of the full system ground state exactly.</p>
    </sec>
    <sec id="many-body-greens-functions-and-the-bethe-salpeter-equation">
      <title>Many-Body Green’s Functions and the Bethe-Salpeter
      Equation</title>
      <p>Using the ground-state reference, many-body Green’s functions
      theory with the <inline-formula><alternatives>
      <tex-math><![CDATA[GW]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>G</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      approximation first calculayes <italic>single-particle
      excitations</italic> (electron addition or removal) as solutions
      to the <italic>quasiparticle</italic> (QP) equations
      <named-content id="equU003AQP" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\left\{ -\frac{\hbar^2}{2m}\nabla^2 + V_\textrm{ext}(\mathbf{r}) +
          V_\textrm{H}(\mathbf{r})\right\}\phi_n^\textrm{QP}(\mathbf{r}) +
        \int{\Sigma(\mathbf{r},\mathbf{r}',\varepsilon_n^\textrm{QP})\phi_n^\textrm{QP}(\mathbf{r}')d\mathbf{r}'}
        = \varepsilon_n^\textrm{QP} \phi_n^\textrm{QP}(\mathbf{r}) .
      ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:mi>−</mml:mi><mml:mfrac><mml:msup><mml:mi>ℏ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>∇</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext mathvariant="normal">ext</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext mathvariant="normal">H</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">QP</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>∫</mml:mo><mml:mrow><mml:mi>Σ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>𝐫</mml:mi><mml:mi>′</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">QP</mml:mtext></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">QP</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mi>′</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>𝐫</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">QP</mml:mtext></mml:msubsup><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">QP</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      In place of the exchange-correlation potential in Eq.
      <xref alt="6" rid="equU003AKS">6</xref>, the energy-dependent
      self-energy operator <inline-formula><alternatives>
      <tex-math><![CDATA[\Sigma(\mathbf{r},\mathbf{r}',E)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Σ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>𝐫</mml:mi><mml:mi>′</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      occurs in the QP equations. This operator is evaluated using the
      one-body Green’s function in quasi-particle approximation
      <named-content id="equU003AGreen" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[G(\mathbf{r},\mathbf{r}',\omega) = \sum_n{\frac{\phi_n(\mathbf{r})\phi_n^*(\mathbf{r}')}{\omega-\varepsilon_n+i0^+\textrm{sgn}(\varepsilon_n -\mu)}}
      ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>𝐫</mml:mi><mml:mi>′</mml:mi><mml:mo>,</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>n</mml:mi></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mi>′</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup><mml:mtext mathvariant="normal">sgn</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      as
      <named-content id="equU003Asigma" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\Sigma(\mathbf{r},\mathbf{r}',E) = \frac{i}{2\pi} \int{e^{-i\omega 0^+}G(\mathbf{r},\mathbf{r}',E-\omega)W(\mathbf{r},\mathbf{r}',\omega)\,d\omega},
        ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Σ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>𝐫</mml:mi><mml:mi>′</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mi>i</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo>∫</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>−</mml:mi><mml:mi>i</mml:mi><mml:mi>ω</mml:mi><mml:msup><mml:mn>0</mml:mn><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>𝐫</mml:mi><mml:mi>′</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>−</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐫</mml:mi><mml:mo>,</mml:mo><mml:mi>𝐫</mml:mi><mml:mi>′</mml:mi><mml:mo>,</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mspace width="0.167em"></mml:mspace><mml:mi>d</mml:mi><mml:mi>ω</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      where <inline-formula><alternatives>
      <tex-math><![CDATA[W]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>
      denotes the dynamically screened Coulomb interaction. Assuming
      that <inline-formula><alternatives>
      <tex-math><![CDATA[\phi^\textrm{QP}_n\approx \phi^\textrm{KS}_n]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">QP</mml:mtext></mml:msubsup><mml:mo>≈</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>,
      the quasiparticle energies can be evaluated perturbatively
      according to
      <named-content id="equU003AtheoryU003Agw_sc" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\varepsilon_n^\textrm{QP}= \varepsilon_n^\textrm{KS} + \Delta \varepsilon_n^{GW} =
        \varepsilon_n^\textrm{KS} + \left\langle\phi^\textrm{KS}_n\left\vert
        \Sigma(\varepsilon_n^\textrm{QP})-V_\text{xc} \right\vert\phi^\textrm{KS}_n\right\rangle .
        ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">QP</mml:mtext></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">⟨</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>Σ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">QP</mml:mtext></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mtext mathvariant="normal">xc</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">KS</mml:mtext></mml:msubsup><mml:mo stretchy="true" form="postfix">⟩</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      As the correction <inline-formula><alternatives>
      <tex-math><![CDATA[\Delta \varepsilon_n^{GW}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mi>G</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>
      itself depends on <inline-formula><alternatives>
      <tex-math><![CDATA[\varepsilon_n^\textrm{QP}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>ε</mml:mi><mml:mi>n</mml:mi><mml:mtext mathvariant="normal">QP</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>,
      Eq. <xref alt="10" rid="equU003AtheoryU003Agw_sc">10</xref> needs
      to be solved self-consistently.</p>
      <p>Neutral excitations with a conserved number of electrons can be
      obtained from the Bethe-Salpeter Equation (BSE) by expressing
      coupled electron-hole amplitudes of excitation
      <inline-formula><alternatives>
      <tex-math><![CDATA[S]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>S</mml:mi></mml:math></alternatives></inline-formula>
      in a product basis of single-particle orbitals, i.e.,
      <named-content id="equU003Absewf" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\chi_S(\mathbf{r}_\textrm{e},\mathbf{r}_\textrm{h})=\sum_{v}^{\mathrm{occ}}\sum_c^{\mathrm{unocc}}A_{vc}^S\phi_{c}(\mathbf{r}_\textrm{e})\phi^*_{v}(\mathbf{r}_\textrm{h})
        +B_{vc}^S\phi_{v}(\mathbf{r}_\textrm{e})\phi^{*}_{c}(\mathbf{r}_\textrm{h}),
        ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>χ</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mi>v</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:munderover><mml:munderover><mml:mo>∑</mml:mo><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">c</mml:mi><mml:mi mathvariant="normal">c</mml:mi></mml:mrow></mml:munderover><mml:msubsup><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>v</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>B</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>c</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      where <inline-formula><alternatives>
      <tex-math><![CDATA[\mathbf{r}_\textrm{e}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
      (<inline-formula><alternatives>
      <tex-math><![CDATA[\mathbf{r}_\textrm{h}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>)
      is for the electron (hole) coordinate and
      <inline-formula><alternatives>
      <tex-math><![CDATA[A_{vc}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
      (<inline-formula><alternatives>
      <tex-math><![CDATA[B_{vc})]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
      are the expansion coefficients of the excited state wave function
      in terms of resonant (anti-resonant) transitions between occupied
      <inline-formula><alternatives>
      <tex-math><![CDATA[v]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>v</mml:mi></mml:math></alternatives></inline-formula>
      and unoccupied <inline-formula><alternatives>
      <tex-math><![CDATA[c]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>
      states, respectively. In this basis, the BSE turns into an
      effective two-particle Hamiltonian problem of the form
      <named-content id="equU003AtheoryU003Abseeigenvalue" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[
      \begin{pmatrix}
        \underline{\mathbf{H}}^{\text{res}}&\underline{\mathbf{K}} \\
        -\underline{\mathbf{K}} & -\underline{\mathbf{H}}^{\text{res}}
       \end{pmatrix}
       \begin{pmatrix}
       \mathbf{A}^S\\ \mathbf{B}^S
       \end{pmatrix}
      =\Omega_S
      \begin{pmatrix}
       \mathbf{A}^S\\ \mathbf{B}^S
      \end{pmatrix}
       .
      ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msup><mml:munder><mml:mi>𝐇</mml:mi><mml:mo accent="true">_</mml:mo></mml:munder><mml:mtext mathvariant="normal">res</mml:mtext></mml:msup></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:munder><mml:mi>𝐊</mml:mi><mml:mo accent="true">_</mml:mo></mml:munder></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mi>−</mml:mi><mml:munder><mml:mi>𝐊</mml:mi><mml:mo accent="true">_</mml:mo></mml:munder></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mi>−</mml:mi><mml:msup><mml:munder><mml:mi>𝐇</mml:mi><mml:mo accent="true">_</mml:mo></mml:munder><mml:mtext mathvariant="normal">res</mml:mtext></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msup><mml:mi>𝐀</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msup><mml:mi>𝐁</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>Ω</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msup><mml:mi>𝐀</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msup><mml:mi>𝐁</mml:mi><mml:mi>S</mml:mi></mml:msup></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></named-content></p>
      <p>Specifically, the matrix elements of the blocks
      <inline-formula><alternatives>
      <tex-math><![CDATA[\underline{\mathbf{H}}^{\text{res}}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:munder><mml:mi>𝐇</mml:mi><mml:mo accent="true">_</mml:mo></mml:munder><mml:mtext mathvariant="normal">res</mml:mtext></mml:msup></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[\underline{\mathbf{K}}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:munder><mml:mi>𝐊</mml:mi><mml:mo accent="true">_</mml:mo></mml:munder></mml:math></alternatives></inline-formula>
      are calculated as
      <named-content id="equU003AtheoryU003AbseblockK" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\begin{aligned}
       H^{\text{res}}_{vc,v'c'}&=D_{vc,v'c'}+\eta K^\mathrm{x}_{vc,v'c'}+K^\mathrm{d}_{vc,v'c'}\label{equ:theory:bseblockH}\\
       K_{cv,v'c'}&=\eta K^\mathrm{x}_{cv,v'c'}+K^\mathrm{d}_{cv,v'c'}\, ,
      \end{aligned}]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msubsup><mml:mi>H</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mtext mathvariant="normal">res</mml:mtext></mml:msubsup></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:mi>η</mml:mi><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mi mathvariant="normal">x</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mi mathvariant="normal">d</mml:mi></mml:msubsup><mml:mspace width="0.167em"></mml:mspace><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></named-content>
      with
      <named-content id="equU003AtheoryU003AKd" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\begin{aligned}
      D_{vc,v'c'}&=(\varepsilon_c-\varepsilon_v)\delta_{vv'}\delta_{cc'}\label{equ:theory:D},\\
      K^\text{x}_{vc,v'c'}&=\iint  \phi_c^*(\mathbf{r}_\textrm{e})\phi_v(\mathbf{r}_\textrm{e})v_{\mathrm{C}}(\mathbf{r}_\textrm{e},\mathbf{r}_\textrm{h}) \phi_{c'}(\mathbf{r}_\textrm{h})\phi_{v'}^*(\mathbf{r}_\textrm{h}) d^3\mathbf{r}_\textrm{e} d^3\mathbf{r}_\textrm{h}\\
      K^\text{d}_{vc,v'c'}&=-\iint
                     \phi_c^*(\mathbf{r}_\textrm{e})\phi_{c'}(\mathbf{r}_\textrm{e})W(\mathbf{r}_\textrm{e},\mathbf{r}_\textrm{h},\omega=0) \phi_v(\mathbf{r}_\textrm{h})\phi_{v'}^*(\mathbf{r}_\textrm{h})d^3\mathbf{r}_\textrm{e} d^3\mathbf{r}_\textrm{h}
                     \, .
      \end{aligned}]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>ε</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>v</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mtext mathvariant="normal">x</mml:mtext></mml:msubsup></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:mo>∬</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>c</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msubsup><mml:mi>K</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mi>′</mml:mi><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mtext mathvariant="normal">d</mml:mtext></mml:msubsup></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:mi>−</mml:mi><mml:mo>∬</mml:mo><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mi>c</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>ϕ</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">e</mml:mtext></mml:msub><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msub><mml:mi>𝐫</mml:mi><mml:mtext mathvariant="normal">h</mml:mtext></mml:msub><mml:mspace width="0.167em"></mml:mspace><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></named-content>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[\eta=2]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
      (<inline-formula><alternatives>
      <tex-math><![CDATA[\eta=0]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>η</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)
      for singlet (triplet) excitations. Here,
      <inline-formula><alternatives>
      <tex-math><![CDATA[K^\text{x}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>K</mml:mi><mml:mtext mathvariant="normal">x</mml:mtext></mml:msup></mml:math></alternatives></inline-formula>
      is the repulsive exchange interaction originating from the bare
      Coulomb term <inline-formula><alternatives>
      <tex-math><![CDATA[v_\mathrm{C}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">C</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
      while the direct interaction <inline-formula><alternatives>
      <tex-math><![CDATA[K^\text{d}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>K</mml:mi><mml:mtext mathvariant="normal">d</mml:mtext></mml:msup></mml:math></alternatives></inline-formula>
      contains the attractive, but screened, interaction
      <inline-formula><alternatives>
      <tex-math><![CDATA[W]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>
      between electron and hole, causing the binding of the
      electron-hole pair. In Eq.
      <xref alt="14" rid="equU003AtheoryU003AKd">14</xref> it is assumed
      that the dynamic properties of <inline-formula><alternatives>
      <tex-math><![CDATA[W(\omega)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      are negligible, and the computationally less demanding static
      approximation <inline-formula><alternatives>
      <tex-math><![CDATA[\omega=0]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
      is employed.</p>
    </sec>
    <sec id="quantum-classical-embedding">
      <title>Quantum-Classical Embedding</title>
      <p>Polarization effects of an environment can have significant
      impact on electronic excitations. As polarization effects are
      long-ranged accounting for them requires the treatment of large
      systems which is infeasible with explicit quantum methods such as
      DFT-<inline-formula><alternatives>
      <tex-math><![CDATA[GW]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>G</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>-BSE.
      Instead, the system is split into a small part with to
      electronically active subsystem to be treated at quantum (QM)
      level and a large environment part in which electrostatic and
      polarization effects are accounted for in classical models (MM).
      In VOTCA-XTP the QM/MM scheme employs distributed atomic multipole
      representations for molecules in the MM region, which allows
      treatment of both the effects of static electric fields and the
      polarization response as a self-consistent reaction field.
      Specifically, this classical MM energy for the system is evaluated
      as
      <named-content id="equU003AEMM" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[E_\text{MM} = \frac{1}{2}\sum_{\substack{A,B\\A\neq B}}\sum_{a\in A}\sum_{b\in B}\sum_{tu}{(Q_t^{a} + \Delta Q_t^{a}) T_{tu}^{ab} Q_u^{b}}, 
        ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext mathvariant="normal">MM</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mrow><mml:mi>A</mml:mi><mml:mo>≠</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      where <inline-formula><alternatives>
      <tex-math><![CDATA[A]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>A</mml:mi></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[B]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>B</mml:mi></mml:math></alternatives></inline-formula>
      indicate individual molecules in the system,
      <inline-formula><alternatives>
      <tex-math><![CDATA[a]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>a</mml:mi></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[b]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>b</mml:mi></mml:math></alternatives></inline-formula>
      atoms in the respective molecules, <inline-formula><alternatives>
      <tex-math><![CDATA[Q^a_t]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
      are the static atomic multipole moments of rank
      <inline-formula><alternatives>
      <tex-math><![CDATA[t]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>
      associated to atom <inline-formula><alternatives>
      <tex-math><![CDATA[a]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>a</mml:mi></mml:math></alternatives></inline-formula>,
      and <inline-formula><alternatives>
      <tex-math><![CDATA[T_{tu}^{ab}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>
      is the tensor describing the interactions between the multipoles
      moments <inline-formula><alternatives>
      <tex-math><![CDATA[Q^{a}_{t}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[Q^b_u]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
      (<xref alt="Stone, 2005" rid="ref-stone_distributed_2005" ref-type="bibr">Stone,
      2005</xref>). The induced moments <inline-formula><alternatives>
      <tex-math><![CDATA[\Delta Q_t^a]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>
      are generated by the electric field created by moments
      <inline-formula><alternatives>
      <tex-math><![CDATA[t']]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>t</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      of atom <inline-formula><alternatives>
      <tex-math><![CDATA[a' \neq a]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>a</mml:mi><mml:mi>′</mml:mi><mml:mo>≠</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      in molecule <inline-formula><alternatives>
      <tex-math><![CDATA[A]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>A</mml:mi></mml:math></alternatives></inline-formula>
      and the one generated by the moment <inline-formula><alternatives>
      <tex-math><![CDATA[u]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>u</mml:mi></mml:math></alternatives></inline-formula>
      of atom <inline-formula><alternatives>
      <tex-math><![CDATA[b]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>b</mml:mi></mml:math></alternatives></inline-formula>
      in molecule <inline-formula><alternatives>
      <tex-math><![CDATA[B]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>B</mml:mi></mml:math></alternatives></inline-formula>:
      <named-content id="equU003Ainduced" content-type="equation"><disp-formula><alternatives>
      <tex-math><![CDATA[\Delta Q_{t}^{a} = - \sum_{\substack{A,B \in \mathcal{S}\\A\neq B}} \sum_{b \, \in B}\sum_{\substack{a' \in A\\a'\neq a}} \sum_{tt'u}\alpha_{tt'}^{aa'}  T_{t'u}^{a'b} (Q_u^{b} + \Delta Q_u^{b}),
      ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>−</mml:mi><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mrow><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo>∈</mml:mo><mml:mi>𝒮</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mrow><mml:mi>A</mml:mi><mml:mo>≠</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mspace width="0.167em"></mml:mspace><mml:mo>∈</mml:mo><mml:mi>B</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mrow><mml:mi>a</mml:mi><mml:mi>′</mml:mi><mml:mo>∈</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mrow><mml:mi>a</mml:mi><mml:mi>′</mml:mi><mml:mo>≠</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>′</mml:mi><mml:mi>u</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>T</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>′</mml:mi><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>′</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>Q</mml:mi><mml:mi>u</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
      with <inline-formula><alternatives>
      <tex-math><![CDATA[\alpha_{tt'}^{aa'}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>t</mml:mi><mml:mi>′</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi><mml:mi>′</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>
      the isotropic atomic polarizability on each site. To avoid effects
      of spurious overpolarization, a damped version of the interaction
      tensor (Thole damping
      (<xref alt="Stone, 2005" rid="ref-stone_distributed_2005" ref-type="bibr">Stone,
      2005</xref>)) is used. Then, the static and induced multipoles in
      the MM region also interact with the electron density in QM region
      via an additional external potential to
      Eq.<xref alt="6" rid="equU003AKS">6</xref>. At the same time, the
      explicit electrostatic field from the QM density is included in
      polarizing the MM region.</p>
    </sec>
  </sec>
</sec>
<sec id="code-structure">
  <title>Code Structure</title>
  <p>For the last couple of years, we have also focused on code
  hardening and the introduction of better software engineering
  practices. Original VOTCA was designed as modules in separate
  repositories, but as many other projects, this turned out to be quite
  cumbersome hence we switched to a mono-repo. With recent performance
  improvements in the git tools, the benefits of a single repository by
  far out-weigh the downside of the very complex workflow of multiple
  repositories. The module structure still exists in the source
  code.</p>
  <p>Additionally, we have added continuous integration testing through
  GitHub action for 50+ different compiler and operating system
  combinations. The also perform continous deployment to the GitHub
  Docker registry. And releases get rolled into all major linux
  distributions, HomeBrew, Spack and FreeBSD.</p>
  <sec id="code-modernization">
    <title>Code Modernization</title>
    <p>We did a lot of code refactoring and bumped the C++ standard to
    17. We also modernized our usage of CMake and switched to a mostly
    target-base scheme. An attempt to port our particle structure on top
    of Cabana
    (<xref alt="Slattery et al., 2022" rid="ref-cabana" ref-type="bibr">Slattery
    et al., 2022</xref>) was made, due to incompatibilties between
    Kokkos
    (<xref alt="Trott et al., 2022" rid="ref-kokkos" ref-type="bibr">Trott
    et al., 2022</xref>) and Eigen, we will delay this effort.</p>
  </sec>
  <sec id="updates-in-votca-csg">
    <title>Updates in VOTCA-CSG</title>
    <p>The particle and molecule data structure were refactored, and we
    add support of the H5MD format, which is described below in
    details.</p>
    <sec id="h5md-support">
      <title>H5MD support</title>
      <p>The recent version of VOTCA supports the
      <monospace>H5MD</monospace>
      (<xref alt="de Buyl et al., 2014" rid="ref-debuyl2014h5md" ref-type="bibr">de
      Buyl et al., 2014</xref>) file format, which internally uses
      <monospace>HDF5</monospace>
      (<xref alt="Koranne, 2011" rid="ref-hdf5" ref-type="bibr">Koranne,
      2011</xref>) storage. This is a very fast and scalable method for
      storing molecular trajectories, already implemented in simulation
      packages such as <monospace>LAMMPS</monospace>
      (<xref alt="Thompson et al., 2022" rid="ref-LAMMPS" ref-type="bibr">Thompson
      et al., 2022</xref>), <monospace>ESPResSo++</monospace>
      (<xref alt="Guzman et al., 2019" rid="ref-GUZMAN201966" ref-type="bibr">Guzman
      et al., 2019</xref>), and <monospace>ESPResSo</monospace>
      (<xref alt="Weik et al., 2019" rid="ref-weik2019espresso" ref-type="bibr">Weik
      et al., 2019</xref>). VOTCA recognizes the trajectory file format
      by the extension. In the case of H5MD, it expects a
      <monospace>.h5</monospace> extension. Following the H5MD concepts,
      the particle trajectories are organized in the
      <monospace>particles</monospace> container. This container can
      handle multiple subsets of the studied system. Therefore, we must
      define <monospace>h5md_particle_group</monospace> in the XML
      topology file to declare which subset of particles to use. The
      reader handles both coordinates (if present), forces, and
      velocities.</p>
    </sec>
  </sec>
  <sec id="design-of-votca-xtp">
    <title>Design of VOTCA-XTP</title>
    <p>Data structures related to atomistic properties (topology,
    molecules, segments, fragments, atoms) in XTP are reused or build
    upon those of CSG. Linear algebra related structures and
    functionalities are handled by Eigen
    (<xref alt="Guennebaud et al., 2010" rid="ref-eigenweb" ref-type="bibr">Guennebaud
    et al., 2010</xref>) which can be accelerated by internally calling
    the Intel Math Kernel Library
    (<xref alt="Wang et al., 2014" rid="ref-intelMKL" ref-type="bibr">Wang
    et al., 2014</xref>). Exchange-correlation functionals are provided
    by the Library of eXchange-Correlation
    (<monospace>LIBXC</monospace>) functionals
    (<xref alt="Lehtola et al., 2018" rid="ref-Lehtola2018" ref-type="bibr">Lehtola
    et al., 2018</xref>), while <monospace>libint</monospace>
    (<xref alt="Valeev, 2024" rid="ref-Libint2" ref-type="bibr">Valeev,
    2024</xref>) and <monospace>libecpint</monospace>
    (<xref alt="Shaw &amp; Hill, 2017" rid="ref-Shaw2017" ref-type="bibr">Shaw
    &amp; Hill, 2017</xref>) are used for the evaluation of molecular
    integrals of many-body operators over Gaussian functions.</p>
    <p>VOTCA–XTP is designed as a library, which is linked to very thin
    executables. These executables provide a variety of calculators by
    adding keywords on the command line. Virtual interfaces and factory
    patterns make the addition of new calculators simple. The same
    architecture is used for external DFT and MD codes, making VOTCA–XTP
    easily extensible. Lower-level data structures make use of template
    metaprogramming to support a variety of data types. VOTCA-XTP
    provides different functionalities in three types of
    <italic>calculator</italic> classes:</p>
    <list list-type="bullet">
      <list-item>
        <p>a collection of tools that do not require information of a
        mapped MD trajectory, including a specific
        DFT-<inline-formula><alternatives>
        <tex-math><![CDATA[GW]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>G</mml:mi><mml:mi>W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>-BSE
        calculator in <monospace>tools</monospace> callable by
        <monospace>xtp_tools</monospace></p>
      </list-item>
      <list-item>
        <p>analysis and not-high-throughput applications that require a
        mapped MD trajectory in <monospace>calculators</monospace>
        callable by <monospace>xtp_run</monospace></p>
      </list-item>
      <list-item>
        <p>high-throughput, high-performance applications that require a
        mapped MD trajectory in <monospace>jobcalculators</monospace>
        callable by <monospace>xtp_parallel</monospace></p>
      </list-item>
    </list>
    <p>In general, VOTCA-XTP uses shared-memory parallelization in the
    heavy calculations involving the quantum methods, with the
    possibility to seamlessly offload matrix-matrix and matrix-vector
    operations to GPU via <monospace>CUDA</monospace>.</p>
    <sec id="pyxtp">
      <title>PyXTP</title>
      <p>The PyXTP python package distributed with VOTCA, contains
      python bindings to the main functionalities of VOTCA-XTP. These
      python bindings were created using pybind11
      (<xref alt="Jakob et al., 2017" rid="ref-pybind11" ref-type="bibr">Jakob
      et al., 2017</xref>) and provide users with a dedicated Atomistic
      Simulation Environment (ASE)
      (<xref alt="Larsen et al., 2017" rid="ref-ase" ref-type="bibr">Larsen
      et al., 2017</xref>) calculator. The use of this calculator not
      only facilitates the adoption of VOTCA-XTP by non-experts users,
      but they also allow integrating VOTCA-XTP in the broader ASE
      ecosystem.</p>
      <p>The following snippet of code illustrate the use of PyXTP. This
      small code optimize the geometry of a CO molecule in the first
      excited singlet states. As seen in the code, the XTP calculator is
      used to compute the forces on the nuclei while the geometry
      optimization itself is driven by ASE functionalities.</p>
      <code language="python">from pyxtp import xtp
from ase.io import write
from ase.build import molecule
from ase.optimize import QuasiNewton

# create a distorted CO molecule
atoms = molecule('CO')
atoms.rattle()

# instantiate the calculator
calc = xtp(nthreads=2)

# select the state for which to compute the forces 
calc.select_force(energy='singlets', level=0, dynamic=False)

# this allows to change all options
calc.options.dftpackage.functional = 'PBE'
calc.options.dftpackage.basisset = 'def2-svp'
calc.options.dftpackage.auxbasisset = 'aux-def2-svp'

# set up the logger
calc.options.logging_file = 'CO_forces.log'

# set the calculator
atoms.calc = calc

# optimize the geometry
dyn = QuasiNewton(atoms, trajectory='test.traj')
dyn.run(fmax=0.01)
write('final.xyz', atoms)</code>
    </sec>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We acknowledge contributions from Brigitta Sipocz, Syrtis Major,
  and Semyeong Oh, and support from Kathryn Johnston during the genesis
  of this project. We acknowledge support by the Innovational Research
  Incentives Scheme Vidi of the Netherlands Organisation for Scientific
  Research (NWO) with project number 723.016.002. Funding is also
  provided by NWO and the Netherlands eScience Center for funding
  through project number 027.017.G15, within the Joint CSER and eScience
  program for Energy Research (JCER 2017). Los Alamos National
  Laboratory (LANL) is operated by Triad National Security, LLC, for the
  National Nuclear Security Administration of US Department of Energy
  (Contract No. 89233218CNA000001). This work is approved for unlimited
  release with report number LA-UR-24-25313.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-pyscf">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sun</surname><given-names>Qiming</given-names></name>
        <name><surname>Zhang</surname><given-names>Xing</given-names></name>
        <name><surname>Banerjee</surname><given-names>Samragni</given-names></name>
        <name><surname>Bao</surname><given-names>Peng</given-names></name>
        <name><surname>Barbry</surname><given-names>Marc</given-names></name>
        <name><surname>Blunt</surname><given-names>Nick S.</given-names></name>
        <name><surname>Bogdanov</surname><given-names>Nikolay A.</given-names></name>
        <name><surname>Booth</surname><given-names>George H.</given-names></name>
        <name><surname>Chen</surname><given-names>Jia</given-names></name>
        <name><surname>Cui</surname><given-names>Zhi-Hao</given-names></name>
        <name><surname>Eriksen</surname><given-names>Janus J.</given-names></name>
        <name><surname>Gao</surname><given-names>Yang</given-names></name>
        <name><surname>Guo</surname><given-names>Sheng</given-names></name>
        <name><surname>Hermann</surname><given-names>Jan</given-names></name>
        <name><surname>Hermes</surname><given-names>Matthew R.</given-names></name>
        <name><surname>Koh</surname><given-names>Kevin</given-names></name>
        <name><surname>Koval</surname><given-names>Peter</given-names></name>
        <name><surname>Lehtola</surname><given-names>Susi</given-names></name>
        <name><surname>Li</surname><given-names>Zhendong</given-names></name>
        <name><surname>Liu</surname><given-names>Junzi</given-names></name>
        <name><surname>Mardirossian</surname><given-names>Narbe</given-names></name>
        <name><surname>McClain</surname><given-names>James D.</given-names></name>
        <name><surname>Motta</surname><given-names>Mario</given-names></name>
        <name><surname>Mussard</surname><given-names>Bastien</given-names></name>
        <name><surname>Pham</surname><given-names>Hung Q.</given-names></name>
        <name><surname>Pulkin</surname><given-names>Artem</given-names></name>
        <name><surname>Purwanto</surname><given-names>Wirawan</given-names></name>
        <name><surname>Robinson</surname><given-names>Paul J.</given-names></name>
        <name><surname>Ronca</surname><given-names>Enrico</given-names></name>
        <name><surname>Sayfutyarova</surname><given-names>Elvira R.</given-names></name>
        <name><surname>Scheurer</surname><given-names>Maximilian</given-names></name>
        <name><surname>Schurkus</surname><given-names>Henry F.</given-names></name>
        <name><surname>Smith</surname><given-names>James E. T.</given-names></name>
        <name><surname>Sun</surname><given-names>Chong</given-names></name>
        <name><surname>Sun</surname><given-names>Shi-Ning</given-names></name>
        <name><surname>Upadhyay</surname><given-names>Shiv</given-names></name>
        <name><surname>Wagner</surname><given-names>Lucas K.</given-names></name>
        <name><surname>Wang</surname><given-names>Xiao</given-names></name>
        <name><surname>White</surname><given-names>Alec</given-names></name>
        <name><surname>Whitfield</surname><given-names>James Daniel</given-names></name>
        <name><surname>Williamson</surname><given-names>Mark J.</given-names></name>
        <name><surname>Wouters</surname><given-names>Sebastian</given-names></name>
        <name><surname>Yang</surname><given-names>Jun</given-names></name>
        <name><surname>Yu</surname><given-names>Jason M.</given-names></name>
        <name><surname>Zhu</surname><given-names>Tianyu</given-names></name>
        <name><surname>Berkelbach</surname><given-names>Timothy C.</given-names></name>
        <name><surname>Sharma</surname><given-names>Sandeep</given-names></name>
        <name><surname>Sokolov</surname><given-names>Alexander Yu.</given-names></name>
        <name><surname>Chan</surname><given-names>Garnet Kin-Lic</given-names></name>
      </person-group>
      <article-title>Recent developments in the PySCF program package</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2020-07">2020</year><month>07</month>
      <volume>153</volume>
      <issue>2</issue>
      <issn>0021-9606</issn>
      <uri>https://doi.org/10.1063/5.0006074</uri>
      <pub-id pub-id-type="doi">10.1063/5.0006074</pub-id>
      <fpage>024109</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Lee2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lee</surname><given-names>Changyeon</given-names></name>
        <name><surname>Lee</surname><given-names>Seungjin</given-names></name>
        <name><surname>Kim</surname><given-names>Geon-U</given-names></name>
        <name><surname>Lee</surname><given-names>Wonho</given-names></name>
        <name><surname>Kim</surname><given-names>Bumjoon J.</given-names></name>
      </person-group>
      <article-title>Recent advances, design guidelines, and prospects of all-polymer solar cells</article-title>
      <source>Chemical Reviews</source>
      <year iso-8601-date="2019">2019</year>
      <volume>119</volume>
      <issue>13</issue>
      <uri>https://doi.org/10.1021/acs.chemrev.9b00044</uri>
      <pub-id pub-id-type="doi">10.1021/acs.chemrev.9b00044</pub-id>
      <fpage>8028</fpage>
      <lpage>8086</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Svaneborg2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Svaneborg</surname><given-names>Carsten</given-names></name>
        <name><surname>Everaers</surname><given-names>Ralf</given-names></name>
      </person-group>
      <article-title>Multiscale equilibration of highly entangled isotropic model polymer melts</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2023-02">2023</year><month>02</month>
      <volume>158</volume>
      <issue>5</issue>
      <issn>0021-9606</issn>
      <uri>https://doi.org/10.1063/5.0123431</uri>
      <pub-id pub-id-type="doi">10.1063/5.0123431</pub-id>
      <fpage>054903</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Rudzinski_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rudzinski</surname><given-names>Joseph F</given-names></name>
        <name><surname>Kloth</surname><given-names>Sebastian</given-names></name>
        <name><surname>Wörner</surname><given-names>Svenja</given-names></name>
        <name><surname>Pal</surname><given-names>Tamisra</given-names></name>
        <name><surname>Kremer</surname><given-names>Kurt</given-names></name>
        <name><surname>Bereau</surname><given-names>Tristan</given-names></name>
        <name><surname>Vogel</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>Dynamical properties across different coarse-grained models for ionic liquids</article-title>
      <source>Journal of Physics: Condensed Matter</source>
      <publisher-name>IOP Publishing</publisher-name>
      <year iso-8601-date="2021-05">2021</year><month>05</month>
      <volume>33</volume>
      <issue>22</issue>
      <uri>https://dx.doi.org/10.1088/1361-648X/abe6e1</uri>
      <pub-id pub-id-type="doi">10.1088/1361-648X/abe6e1</pub-id>
      <fpage>224001</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-engl2000regularization">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Engl</surname><given-names>Heinz W.</given-names></name>
        <name><surname>Ramlau</surname><given-names>Ronny</given-names></name>
      </person-group>
      <article-title>Regularization of inverse problems</article-title>
      <source>Encyclopedia of applied and computational mathematics</source>
      <person-group person-group-type="editor">
        <name><surname>Engquist</surname><given-names>Björn</given-names></name>
      </person-group>
      <publisher-name>Springer Berlin Heidelberg</publisher-name>
      <publisher-loc>Berlin, Heidelberg</publisher-loc>
      <year iso-8601-date="2015">2015</year>
      <isbn>978-3-540-70529-1</isbn>
      <uri>https://doi.org/10.1007/978-3-540-70529-1_52</uri>
      <pub-id pub-id-type="doi">10.1007/978-3-540-70529-1_52</pub-id>
      <fpage>1233</fpage>
      <lpage>1241</lpage>
    </element-citation>
  </ref>
  <ref id="ref-turbomole">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Balasubramani</surname><given-names>Sree Ganesh</given-names></name>
        <name><surname>Chen</surname><given-names>Guo P.</given-names></name>
        <name><surname>Coriani</surname><given-names>Sonia</given-names></name>
        <name><surname>Diedenhofen</surname><given-names>Michael</given-names></name>
        <name><surname>Frank</surname><given-names>Marius S.</given-names></name>
        <name><surname>Franzke</surname><given-names>Yannick J.</given-names></name>
        <name><surname>Furche</surname><given-names>Filipp</given-names></name>
        <name><surname>Grotjahn</surname><given-names>Robin</given-names></name>
        <name><surname>Harding</surname><given-names>Michael E.</given-names></name>
        <name><surname>Hättig</surname><given-names>Christof</given-names></name>
        <name><surname>Hellweg</surname><given-names>Arnim</given-names></name>
        <name><surname>Helmich-Paris</surname><given-names>Benjamin</given-names></name>
        <name><surname>Holzer</surname><given-names>Christof</given-names></name>
        <name><surname>Huniar</surname><given-names>Uwe</given-names></name>
        <name><surname>Kaupp</surname><given-names>Martin</given-names></name>
        <name><surname>Marefat Khah</surname><given-names>Alireza</given-names></name>
        <name><surname>Karbalaei Khani</surname><given-names>Sarah</given-names></name>
        <name><surname>Müller</surname><given-names>Thomas</given-names></name>
        <name><surname>Mack</surname><given-names>Fabian</given-names></name>
        <name><surname>Nguyen</surname><given-names>Brian D.</given-names></name>
        <name><surname>Parker</surname><given-names>Shane M.</given-names></name>
        <name><surname>Perlt</surname><given-names>Eva</given-names></name>
        <name><surname>Rappoport</surname><given-names>Dmitrij</given-names></name>
        <name><surname>Reiter</surname><given-names>Kevin</given-names></name>
        <name><surname>Roy</surname><given-names>Saswata</given-names></name>
        <name><surname>Rückert</surname><given-names>Matthias</given-names></name>
        <name><surname>Schmitz</surname><given-names>Gunnar</given-names></name>
        <name><surname>Sierka</surname><given-names>Marek</given-names></name>
        <name><surname>Tapavicza</surname><given-names>Enrico</given-names></name>
        <name><surname>Tew</surname><given-names>David P.</given-names></name>
        <name><surname>Wüllen</surname><given-names>Christoph van</given-names></name>
        <name><surname>Voora</surname><given-names>Vamsee K.</given-names></name>
        <name><surname>Weigend</surname><given-names>Florian</given-names></name>
        <name><surname>Wodyński</surname><given-names>Artur</given-names></name>
        <name><surname>Yu</surname><given-names>Jason M.</given-names></name>
      </person-group>
      <article-title>TURBOMOLE: Modular program suite for ab initio quantum-chemical and condensed-matter simulations</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2020-05">2020</year><month>05</month>
      <volume>152</volume>
      <issue>18</issue>
      <issn>0021-9606</issn>
      <uri>https://doi.org/10.1063/5.0004635</uri>
      <pub-id pub-id-type="doi">10.1063/5.0004635</pub-id>
      <fpage>184107</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ADF2001">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Velde</surname><given-names>G. te</given-names></name>
        <name><surname>Bickelhaupt</surname><given-names>F. M.</given-names></name>
        <name><surname>Baerends</surname><given-names>E. J.</given-names></name>
        <name><surname>Fonseca Guerra</surname><given-names>C.</given-names></name>
        <name><surname>Gisbergen</surname><given-names>S. J. A. van</given-names></name>
        <name><surname>Snijders</surname><given-names>J. G.</given-names></name>
        <name><surname>Ziegler</surname><given-names>T.</given-names></name>
      </person-group>
      <article-title>Chemistry with ADF</article-title>
      <source>J. Comput. Chem.</source>
      <publisher-name>John Wiley &amp; Sons, Inc.</publisher-name>
      <year iso-8601-date="2001">2001</year>
      <volume>22</volume>
      <issue>9</issue>
      <issn>1096-987X</issn>
      <uri>http://dx.doi.org/10.1002/jcc.1056</uri>
      <pub-id pub-id-type="doi">10.1002/jcc.1056</pub-id>
      <fpage>931</fpage>
      <lpage>967</lpage>
    </element-citation>
  </ref>
  <ref id="ref-molgw">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bruneval</surname><given-names>Fabien</given-names></name>
        <name><surname>Rangel</surname><given-names>Tonatiuh</given-names></name>
        <name><surname>Hamed</surname><given-names>Samia M.</given-names></name>
        <name><surname>Shao</surname><given-names>Meiyue</given-names></name>
        <name><surname>Yang</surname><given-names>Chao</given-names></name>
        <name><surname>Neaton</surname><given-names>Jeffrey B.</given-names></name>
      </person-group>
      <article-title>Molgw 1: Many-body perturbation theory software for atoms, molecules, and clusters</article-title>
      <source>Computer Physics Communications</source>
      <year iso-8601-date="2016">2016</year>
      <volume>208</volume>
      <issn>0010-4655</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0010465516301990</uri>
      <pub-id pub-id-type="doi">10.1016/j.cpc.2016.06.019</pub-id>
      <fpage>149</fpage>
      <lpage>161</lpage>
    </element-citation>
  </ref>
  <ref id="ref-manby2012simple">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Manby</surname><given-names>F. R.</given-names></name>
        <name><surname>Stella</surname><given-names>M.</given-names></name>
        <name><surname>Goodpaster</surname><given-names>J. D.</given-names></name>
        <name><surname>Miller</surname><given-names>T. F.</given-names></name>
      </person-group>
      <article-title>A simple, exact density-functional-theory embedding scheme</article-title>
      <source>J. Chem. Theory Comput.</source>
      <year iso-8601-date="2012">2012</year>
      <volume>8</volume>
      <pub-id pub-id-type="doi">10.1021/ct300544e</pub-id>
      <fpage>2564</fpage>
      <lpage>2568</lpage>
    </element-citation>
  </ref>
  <ref id="ref-intelMKL">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Wang</surname><given-names>Endong</given-names></name>
        <name><surname>Zhang</surname><given-names>Qing</given-names></name>
        <name><surname>Shen</surname><given-names>Bo</given-names></name>
        <name><surname>Zhang</surname><given-names>Guangyong</given-names></name>
        <name><surname>Lu</surname><given-names>Xiaowei</given-names></name>
        <name><surname>Wu</surname><given-names>Qing</given-names></name>
        <name><surname>Wang</surname><given-names>Yajuan</given-names></name>
      </person-group>
      <article-title>Intel math kernel library</article-title>
      <source>High-performance computing on the intel® xeon phi: How to fully exploit MIC architectures</source>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
      <year iso-8601-date="2014">2014</year>
      <isbn>978-3-319-06486-4</isbn>
      <uri>https://doi.org/10.1007/978-3-319-06486-4_7</uri>
      <pub-id pub-id-type="doi">10.1007/978-3-319-06486-4_7</pub-id>
      <fpage>167</fpage>
      <lpage>188</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Shaw2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Shaw</surname><given-names>Robert A.</given-names></name>
        <name><surname>Hill</surname><given-names>J. Grant</given-names></name>
      </person-group>
      <article-title>Prescreening and efficiency in the evaluation of integrals over ab initio effective core potentials</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2017-08">2017</year><month>08</month>
      <volume>147</volume>
      <issue>7</issue>
      <issn>0021-9606</issn>
      <uri>http://aip.scitation.org/doi/10.1063/1.4986887</uri>
      <pub-id pub-id-type="doi">10.1063/1.4986887</pub-id>
      <fpage>074108</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Libint2">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Valeev</surname><given-names>E. F.</given-names></name>
      </person-group>
      <article-title>Libint: A library for the evaluation of molecular integrals of many-body operators over gaussian functions</article-title>
      <publisher-name>http://libint.valeyev.net/</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <pub-id pub-id-type="doi">10.5281/zenodo.10780719</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Lehtola2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lehtola</surname><given-names>Susi</given-names></name>
        <name><surname>Steigemann</surname><given-names>Conrad</given-names></name>
        <name><surname>Oliveira</surname><given-names>Micael J. T.</given-names></name>
        <name><surname>Marques</surname><given-names>Miguel A. L.</given-names></name>
      </person-group>
      <article-title>Recent developments in LIBXC — A comprehensive library of functionals for density functional theory</article-title>
      <source>SoftwareX</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2018-01">2018</year><month>01</month>
      <volume>7</volume>
      <uri>https://www.sciencedirect.com/science/article/pii/S2352711017300602?via%3Dihub</uri>
      <pub-id pub-id-type="doi">10.1016/j.softx.2017.11.002</pub-id>
      <fpage>1</fpage>
      <lpage>5</lpage>
    </element-citation>
  </ref>
  <ref id="ref-eigenweb">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Guennebaud</surname><given-names>Gaël</given-names></name>
        <name><surname>Jacob</surname><given-names>Benoît</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Eigen v3</article-title>
      <publisher-name>http://eigen.tuxfamily.org</publisher-name>
      <year iso-8601-date="2010">2010</year>
    </element-citation>
  </ref>
  <ref id="ref-stone_distributed_2005">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Stone</surname><given-names>Anthony J.</given-names></name>
      </person-group>
      <article-title>Distributed Multipole Analysis: Stability for Large Basis Sets</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2005-11">2005</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2021-05-04">2021</year><month>05</month><day>04</day></date-in-citation>
      <volume>1</volume>
      <issue>6</issue>
      <issn>1549-9618</issn>
      <pub-id pub-id-type="doi">10.1021/ct050190+</pub-id>
      <fpage>1128</fpage>
      <lpage>1132</lpage>
    </element-citation>
  </ref>
  <ref id="ref-neeseORCAProgramSystem2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Neese</surname><given-names>Frank</given-names></name>
      </person-group>
      <article-title>The ORCA program system</article-title>
      <source>WIREs Computational Molecular Science</source>
      <year iso-8601-date="2012">2012</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-01-05">2022</year><month>01</month><day>05</day></date-in-citation>
      <volume>2</volume>
      <issue>1</issue>
      <issn>1759-0884</issn>
      <pub-id pub-id-type="doi">10.1002/wcms.81</pub-id>
      <fpage>73</fpage>
      <lpage>78</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lyubartsev_calculation_1995">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lyubartsev</surname><given-names>Alexander P.</given-names></name>
        <name><surname>Laaksonen</surname><given-names>Aatto</given-names></name>
      </person-group>
      <article-title>Calculation of effective interaction potentials from radial distribution functions: A reverse Monte Carlo approach</article-title>
      <source>Physical Review E</source>
      <year iso-8601-date="1995-10">1995</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2017-08-15">2017</year><month>08</month><day>15</day></date-in-citation>
      <volume>52</volume>
      <issue>4</issue>
      <issn>1063-651X</issn>
      <uri>https://link.aps.org/doi/10.1103/PhysRevE.52.3730</uri>
      <pub-id pub-id-type="doi">10.1103/PhysRevE.52.3730</pub-id>
      <fpage>3730</fpage>
      <lpage>3737</lpage>
    </element-citation>
  </ref>
  <ref id="ref-rosenberger_comparison_2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rosenberger</surname><given-names>David</given-names></name>
        <name><surname>Hanke</surname><given-names>Martin</given-names></name>
        <name><surname>Vegt</surname><given-names>Nico F. A. van der</given-names></name>
      </person-group>
      <article-title>Comparison of iterative inverse coarse-graining methods</article-title>
      <source>The European Physical Journal Special Topics</source>
      <year iso-8601-date="2016-10">2016</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2017-08-15">2017</year><month>08</month><day>15</day></date-in-citation>
      <volume>225</volume>
      <issue>8-9</issue>
      <issn>1951-6355</issn>
      <uri>http://link.springer.com/10.1140/epjst/e2016-60120-1</uri>
      <pub-id pub-id-type="doi">10.1140/epjst/e2016-60120-1</pub-id>
      <fpage>1323</fpage>
      <lpage>1345</lpage>
    </element-citation>
  </ref>
  <ref id="ref-murtola_coarse-grained_2007">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Murtola</surname><given-names>Teemu</given-names></name>
        <name><surname>Falck</surname><given-names>Emma</given-names></name>
        <name><surname>Karttunen</surname><given-names>Mikko</given-names></name>
        <name><surname>Vattulainen</surname><given-names>Ilpo</given-names></name>
      </person-group>
      <article-title>Coarse-grained model for phospholipid/cholesterol bilayer employing inverse Monte Carlo with thermodynamic constraints</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2007-02">2007</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2017-08-15">2017</year><month>08</month><day>15</day></date-in-citation>
      <volume>126</volume>
      <issue>7</issue>
      <issn>0021-9606</issn>
      <uri>http://aip.scitation.org/doi/10.1063/1.2646614</uri>
      <pub-id pub-id-type="doi">10.1063/1.2646614</pub-id>
      <fpage>075101</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-lyubartsev_systematic_2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lyubartsev</surname><given-names>Alexander P.</given-names></name>
        <name><surname>Mirzoev</surname><given-names>Alexander</given-names></name>
        <name><surname>Chen</surname><given-names>LiJun</given-names></name>
        <name><surname>Laaksonen</surname><given-names>Aatto</given-names></name>
      </person-group>
      <article-title>Systematic coarse-graining of molecular models by the Newton inversion method</article-title>
      <source>Faraday Discuss.</source>
      <year iso-8601-date="2010">2010</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-20">2024</year><month>02</month><day>20</day></date-in-citation>
      <volume>144</volume>
      <issn>1359-6640</issn>
      <uri>http://xlink.rsc.org/?DOI=B901511F</uri>
      <pub-id pub-id-type="doi">10.1039/B901511F</pub-id>
      <fpage>43</fpage>
      <lpage>56</lpage>
    </element-citation>
  </ref>
  <ref id="ref-toth_iterative_2003">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tóth</surname><given-names>Gergely</given-names></name>
      </person-group>
      <article-title>An iterative scheme to derive pair potentials from structure factors and its application to liquid mercury</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2003-03">2003</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-20">2024</year><month>02</month><day>20</day></date-in-citation>
      <volume>118</volume>
      <issue>9</issue>
      <issn>0021-9606</issn>
      <uri>https://pubs.aip.org/jcp/article/118/9/3949/535605/An-iterative-scheme-to-derive-pair-potentials-from</uri>
      <pub-id pub-id-type="doi">10.1063/1.1543142</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-bernhardt_stability_2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bernhardt</surname><given-names>Marvin P.</given-names></name>
        <name><surname>Hanke</surname><given-names>Martin</given-names></name>
        <name><surname>Van Der Vegt</surname><given-names>Nico F. A.</given-names></name>
      </person-group>
      <article-title>Stability, speed, and constraints for structural coarse-graining in VOTCA</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2023-01-24">2023</year><month>01</month><day>24</day>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-02-27">2024</year><month>02</month><day>27</day></date-in-citation>
      <volume>19</volume>
      <issue>2</issue>
      <issn>1549-9618</issn>
      <uri>https://pubs.acs.org/doi/10.1021/acs.jctc.2c00665</uri>
      <pub-id pub-id-type="doi">10.1021/acs.jctc.2c00665</pub-id>
      <fpage>580</fpage>
      <lpage>595</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bernhardt_iterative_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bernhardt</surname><given-names>Marvin P.</given-names></name>
        <name><surname>Hanke</surname><given-names>Martin</given-names></name>
        <name><surname>Vegt</surname><given-names>Nico F. A. van der</given-names></name>
      </person-group>
      <article-title>Iterative integral equation methods for structural coarse-graining</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2021-02-28">2021</year><month>02</month><day>28</day>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-08-30">2022</year><month>08</month><day>30</day></date-in-citation>
      <volume>154</volume>
      <issue>8</issue>
      <issn>0021-9606</issn>
      <uri>https://aip.scitation.org/doi/10.1063/5.0038633</uri>
      <pub-id pub-id-type="doi">10.1063/5.0038633</pub-id>
      <fpage>084118</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-delbaryGeneralizedNewtonIteration2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Delbary</surname><given-names>Fabrice</given-names></name>
        <name><surname>Hanke</surname><given-names>Martin</given-names></name>
        <name><surname>Ivanizki</surname><given-names>Dmitry</given-names></name>
      </person-group>
      <article-title>A generalized newton iteration for computing the solution of the inverse henderson problem</article-title>
      <source>Inverse Problems in Science and Engineering</source>
      <year iso-8601-date="2020-08-02">2020</year><month>08</month><day>02</day>
      <date-in-citation content-type="access-date"><year iso-8601-date="2020-10-29">2020</year><month>10</month><day>29</day></date-in-citation>
      <volume>28</volume>
      <issue>8</issue>
      <issn>1741-5977</issn>
      <uri>https://doi.org/10.1080/17415977.2019.1710504</uri>
      <pub-id pub-id-type="doi">10.1080/17415977.2019.1710504</pub-id>
      <fpage>1166</fpage>
      <lpage>1190</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pybind11">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Jakob</surname><given-names>Wenzel</given-names></name>
        <name><surname>Rhinelander</surname><given-names>Jason</given-names></name>
        <name><surname>Moldovan</surname><given-names>Dean</given-names></name>
      </person-group>
      <article-title>pybind11 – seamless operability between c++11 and python</article-title>
      <year iso-8601-date="2017">2017</year>
      <pub-id pub-id-type="doi">10.5281/zenodo.5807779</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-ase">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Larsen</surname><given-names>Ask Hjorth</given-names></name>
        <name><surname>Mortensen</surname><given-names>Jens Jørgen</given-names></name>
        <name><surname>Blomqvist</surname><given-names>Jakob</given-names></name>
        <name><surname>Castelli</surname><given-names>Ivano E</given-names></name>
        <name><surname>Christensen</surname><given-names>Rune</given-names></name>
        <name><surname>Dułak</surname><given-names>Marcin</given-names></name>
        <name><surname>Friis</surname><given-names>Jesper</given-names></name>
        <name><surname>Groves</surname><given-names>Michael N</given-names></name>
        <name><surname>Hammer</surname><given-names>Bjørk</given-names></name>
        <name><surname>Hargus</surname><given-names>Cory</given-names></name>
        <name><surname>Hermes</surname><given-names>Eric D</given-names></name>
        <name><surname>Jennings</surname><given-names>Paul C</given-names></name>
        <name><surname>Jensen</surname><given-names>Peter Bjerre</given-names></name>
        <name><surname>Kermode</surname><given-names>James</given-names></name>
        <name><surname>Kitchin</surname><given-names>John R</given-names></name>
        <name><surname>Kolsbjerg</surname><given-names>Esben Leonhard</given-names></name>
        <name><surname>Kubal</surname><given-names>Joseph</given-names></name>
        <name><surname>Kaasbjerg</surname><given-names>Kristen</given-names></name>
        <name><surname>Lysgaard</surname><given-names>Steen</given-names></name>
        <name><surname>Maronsson</surname><given-names>Jón Bergmann</given-names></name>
        <name><surname>Maxson</surname><given-names>Tristan</given-names></name>
        <name><surname>Olsen</surname><given-names>Thomas</given-names></name>
        <name><surname>Pastewka</surname><given-names>Lars</given-names></name>
        <name><surname>Peterson</surname><given-names>Andrew</given-names></name>
        <name><surname>Rostgaard</surname><given-names>Carsten</given-names></name>
        <name><surname>Schiøtz</surname><given-names>Jakob</given-names></name>
        <name><surname>Schütt</surname><given-names>Ole</given-names></name>
        <name><surname>Strange</surname><given-names>Mikkel</given-names></name>
        <name><surname>Thygesen</surname><given-names>Kristian S</given-names></name>
        <name><surname>Vegge</surname><given-names>Tejs</given-names></name>
        <name><surname>Vilhelmsen</surname><given-names>Lasse</given-names></name>
        <name><surname>Walter</surname><given-names>Michael</given-names></name>
        <name><surname>Zeng</surname><given-names>Zhenhua</given-names></name>
        <name><surname>Jacobsen</surname><given-names>Karsten W</given-names></name>
      </person-group>
      <article-title>The atomic simulation environment—a python library for working with atoms</article-title>
      <source>Journal of Physics: Condensed Matter</source>
      <year iso-8601-date="2017">2017</year>
      <volume>29</volume>
      <issue>27</issue>
      <uri>http://stacks.iop.org/0953-8984/29/i=27/a=273002</uri>
      <pub-id pub-id-type="doi">10.1088/1361-648X/aa680e</pub-id>
      <fpage>273002</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-debuyl2014h5md">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>de Buyl</surname><given-names>Pierre</given-names></name>
        <name><surname>Colberg</surname><given-names>Peter H.</given-names></name>
        <name><surname>Höfling</surname><given-names>Felix</given-names></name>
      </person-group>
      <article-title>H5MD: A structured, efficient, and portable file format for molecular data</article-title>
      <source>Computer Physics Communications</source>
      <year iso-8601-date="2014">2014</year>
      <volume>185</volume>
      <issue>6</issue>
      <issn>0010-4655</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0010465514000447</uri>
      <pub-id pub-id-type="doi">10.1016/j.cpc.2014.01.018</pub-id>
      <fpage>1546</fpage>
      <lpage>1553</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hdf5">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Koranne</surname><given-names>Sandeep</given-names></name>
      </person-group>
      <article-title>Hierarchical data format 5 : HDF5</article-title>
      <source>Handbook of open source tools</source>
      <publisher-name>Springer US</publisher-name>
      <publisher-loc>Boston, MA</publisher-loc>
      <year iso-8601-date="2011">2011</year>
      <isbn>978-1-4419-7719-9</isbn>
      <uri>https://doi.org/10.1007/978-1-4419-7719-9_10</uri>
      <pub-id pub-id-type="doi">10.1007/978-1-4419-7719-9_10</pub-id>
      <fpage>191</fpage>
      <lpage>200</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bocs">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dunn</surname><given-names>Nicholas J. H.</given-names></name>
        <name><surname>Lebold</surname><given-names>Kathryn M.</given-names></name>
        <name><surname>DeLyser</surname><given-names>Michael R.</given-names></name>
        <name><surname>Rudzinski</surname><given-names>Joseph F.</given-names></name>
        <name><surname>Noid</surname><given-names>W. G.</given-names></name>
      </person-group>
      <article-title>BOCS: Bottom-up open-source coarse-graining software</article-title>
      <source>The Journal of Physical Chemistry B</source>
      <year iso-8601-date="2018">2018</year>
      <volume>122</volume>
      <issue>13</issue>
      <uri> https://doi.org/10.1021/acs.jpcb.7b09993 </uri>
      <pub-id pub-id-type="doi">10.1021/acs.jpcb.7b09993</pub-id>
      <fpage>3363</fpage>
      <lpage>3377</lpage>
    </element-citation>
  </ref>
  <ref id="ref-deepcg">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhang</surname><given-names>Linfeng</given-names></name>
        <name><surname>Han</surname><given-names>Jiequn</given-names></name>
        <name><surname>Wang</surname><given-names>Han</given-names></name>
        <name><surname>Car</surname><given-names>Roberto</given-names></name>
        <name><surname>E</surname><given-names>Weinan</given-names></name>
      </person-group>
      <article-title>DeePCG: Constructing coarse-grained models via deep neural networks</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2018-07">2018</year><month>07</month>
      <volume>149</volume>
      <issue>3</issue>
      <issn>0021-9606</issn>
      <uri>https://doi.org/10.1063/1.5027645</uri>
      <pub-id pub-id-type="doi">10.1063/1.5027645</pub-id>
      <fpage>034101</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ibisco">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Karimi-Varzaneh</surname><given-names>Hossein Ali</given-names></name>
        <name><surname>Qian</surname><given-names>Hu-Jun</given-names></name>
        <name><surname>Chen</surname><given-names>Xiaoyu</given-names></name>
        <name><surname>Carbone</surname><given-names>Paola</given-names></name>
        <name><surname>Müller-Plathe</surname><given-names>Florian</given-names></name>
      </person-group>
      <article-title>IBIsCO: A molecular dynamics simulation package for coarse-grained simulation</article-title>
      <source>Journal of Computational Chemistry</source>
      <year iso-8601-date="2011">2011</year>
      <volume>32</volume>
      <issue>7</issue>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1002/jcc.21717</uri>
      <pub-id pub-id-type="doi">10.1002/jcc.21717</pub-id>
      <fpage>1475</fpage>
      <lpage>1487</lpage>
    </element-citation>
  </ref>
  <ref id="ref-magic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mirzoev</surname><given-names>Alexander</given-names></name>
        <name><surname>Lyubartsev</surname><given-names>Alexander P.</given-names></name>
      </person-group>
      <article-title>MagiC: Software package for multiscale modeling</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2013">2013</year>
      <volume>9</volume>
      <issue>3</issue>
      <uri> https://doi.org/10.1021/ct301019v </uri>
      <pub-id pub-id-type="doi">10.1021/ct301019v</pub-id>
      <fpage>1512</fpage>
      <lpage>1520</lpage>
    </element-citation>
  </ref>
  <ref id="ref-openmscg">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Peng</surname><given-names>Yuxing</given-names></name>
        <name><surname>Pak</surname><given-names>Alexander J.</given-names></name>
        <name><surname>Durumeric</surname><given-names>Aleksander E. P.</given-names></name>
        <name><surname>Sahrmann</surname><given-names>Patrick G.</given-names></name>
        <name><surname>Mani</surname><given-names>Sriramvignesh</given-names></name>
        <name><surname>Jin</surname><given-names>Jaehyeok</given-names></name>
        <name><surname>Loose</surname><given-names>Timothy D.</given-names></name>
        <name><surname>Beiter</surname><given-names>Jeriann</given-names></name>
        <name><surname>Voth</surname><given-names>Gregory A.</given-names></name>
      </person-group>
      <article-title>OpenMSCG: A software tool for bottom-up coarse-graining</article-title>
      <source>The Journal of Physical Chemistry B</source>
      <year iso-8601-date="2023">2023</year>
      <volume>127</volume>
      <issue>40</issue>
      <uri> https://doi.org/10.1021/acs.jpcb.3c04473 </uri>
      <pub-id pub-id-type="doi">10.1021/acs.jpcb.3c04473</pub-id>
      <fpage>8537</fpage>
      <lpage>8550</lpage>
    </element-citation>
  </ref>
  <ref id="ref-mpip-votca">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Andrienko</surname><given-names>Denis</given-names></name>
        <name><surname>Scherer</surname><given-names>Christoph</given-names></name>
        <name><surname>Stanisic</surname><given-names>Luka</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>MPI-p fork of VOTCA</article-title>
      <year iso-8601-date="2023-12-07">2023</year><month>12</month><day>07</day>
      <uri>https://gitlab.mpcdf.mpg.de/votca/votca</uri>
    </element-citation>
  </ref>
  <ref id="ref-mlpot">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Scherer</surname><given-names>Christoph</given-names></name>
        <name><surname>Scheid</surname><given-names>René</given-names></name>
        <name><surname>Andrienko</surname><given-names>Denis</given-names></name>
        <name><surname>Bereau</surname><given-names>Tristan</given-names></name>
      </person-group>
      <article-title>Kernel-based machine learning for efficient simulations of molecular liquids</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2020">2020</year>
      <volume>16</volume>
      <issue>5</issue>
      <uri> https://doi.org/10.1021/acs.jctc.9b01256 </uri>
      <pub-id pub-id-type="doi">10.1021/acs.jctc.9b01256</pub-id>
      <fpage>3194</fpage>
      <lpage>3204</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kokkos">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Trott</surname><given-names>Christian R.</given-names></name>
        <name><surname>Lebrun-Grandié</surname><given-names>Damien</given-names></name>
        <name><surname>Arndt</surname><given-names>Daniel</given-names></name>
        <name><surname>Ciesko</surname><given-names>Jan</given-names></name>
        <name><surname>Dang</surname><given-names>Vinh</given-names></name>
        <name><surname>Ellingwood</surname><given-names>Nathan</given-names></name>
        <name><surname>Gayatri</surname><given-names>Rahulkumar</given-names></name>
        <name><surname>Harvey</surname><given-names>Evan</given-names></name>
        <name><surname>Hollman</surname><given-names>Daisy S.</given-names></name>
        <name><surname>Ibanez</surname><given-names>Dan</given-names></name>
        <name><surname>Liber</surname><given-names>Nevin</given-names></name>
        <name><surname>Madsen</surname><given-names>Jonathan</given-names></name>
        <name><surname>Miles</surname><given-names>Jeff</given-names></name>
        <name><surname>Poliakoff</surname><given-names>David</given-names></name>
        <name><surname>Powell</surname><given-names>Amy</given-names></name>
        <name><surname>Rajamanickam</surname><given-names>Sivasankaran</given-names></name>
        <name><surname>Simberg</surname><given-names>Mikael</given-names></name>
        <name><surname>Sunderland</surname><given-names>Dan</given-names></name>
        <name><surname>Turcksin</surname><given-names>Bruno</given-names></name>
        <name><surname>Wilke</surname><given-names>Jeremiah</given-names></name>
      </person-group>
      <article-title>Kokkos 3: Programming model extensions for the exascale era</article-title>
      <source>IEEE Transactions on Parallel and Distributed Systems</source>
      <year iso-8601-date="2022">2022</year>
      <volume>33</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1109/TPDS.2021.3097283</pub-id>
      <fpage>805</fpage>
      <lpage>817</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cabana">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Slattery</surname><given-names>Stuart</given-names></name>
        <name><surname>Reeve</surname><given-names>Samuel Temple</given-names></name>
        <name><surname>Junghans</surname><given-names>Christoph</given-names></name>
        <name><surname>Lebrun-Grandié</surname><given-names>Damien</given-names></name>
        <name><surname>Bird</surname><given-names>Robert</given-names></name>
        <name><surname>Chen</surname><given-names>Guangye</given-names></name>
        <name><surname>Fogerty</surname><given-names>Shane</given-names></name>
        <name><surname>Qiu</surname><given-names>Yuxing</given-names></name>
        <name><surname>Schulz</surname><given-names>Stephan</given-names></name>
        <name><surname>Scheinberg</surname><given-names>Aaron</given-names></name>
        <name><surname>Isner</surname><given-names>Austin</given-names></name>
        <name><surname>Chong</surname><given-names>Kwitae</given-names></name>
        <name><surname>Moore</surname><given-names>Stan</given-names></name>
        <name><surname>Germann</surname><given-names>Timothy</given-names></name>
        <name><surname>Belak</surname><given-names>James</given-names></name>
        <name><surname>Mniszewski</surname><given-names>Susan</given-names></name>
      </person-group>
      <article-title>Cabana: A performance portable library for particle-based simulations</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>7</volume>
      <issue>72</issue>
      <uri>https://doi.org/10.21105/joss.04115</uri>
      <pub-id pub-id-type="doi">10.21105/joss.04115</pub-id>
      <fpage>4115</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-LAMMPS">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Thompson</surname><given-names>A. P.</given-names></name>
        <name><surname>Aktulga</surname><given-names>H. M.</given-names></name>
        <name><surname>Berger</surname><given-names>R.</given-names></name>
        <name><surname>Bolintineanu</surname><given-names>D. S.</given-names></name>
        <name><surname>Brown</surname><given-names>W. M.</given-names></name>
        <name><surname>Crozier</surname><given-names>P. S.</given-names></name>
        <name><surname>Veld</surname><given-names>P. J. in ’t</given-names></name>
        <name><surname>Kohlmeyer</surname><given-names>A.</given-names></name>
        <name><surname>Moore</surname><given-names>S. G.</given-names></name>
        <name><surname>Nguyen</surname><given-names>T. D.</given-names></name>
        <name><surname>Shan</surname><given-names>R.</given-names></name>
        <name><surname>Stevens</surname><given-names>M. J.</given-names></name>
        <name><surname>Tranchida</surname><given-names>J.</given-names></name>
        <name><surname>Trott</surname><given-names>C.</given-names></name>
        <name><surname>Plimpton</surname><given-names>S. J.</given-names></name>
      </person-group>
      <article-title>LAMMPS - a flexible simulation tool for particle-based materials modeling at the atomic, meso, and continuum scales</article-title>
      <source>Comp. Phys. Comm.</source>
      <year iso-8601-date="2022">2022</year>
      <volume>271</volume>
      <pub-id pub-id-type="doi">10.1016/j.cpc.2021.108171</pub-id>
      <fpage>108171</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-GUZMAN201966">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Guzman</surname><given-names>Horacio V.</given-names></name>
        <name><surname>Tretyakov</surname><given-names>Nikita</given-names></name>
        <name><surname>Kobayashi</surname><given-names>Hideki</given-names></name>
        <name><surname>Fogarty</surname><given-names>Aoife C.</given-names></name>
        <name><surname>Kreis</surname><given-names>Karsten</given-names></name>
        <name><surname>Krajniak</surname><given-names>Jakub</given-names></name>
        <name><surname>Junghans</surname><given-names>Christoph</given-names></name>
        <name><surname>Kremer</surname><given-names>Kurt</given-names></name>
        <name><surname>Stuehn</surname><given-names>Torsten</given-names></name>
      </person-group>
      <article-title>ESPResSo++ 2.0: Advanced methods for multiscale molecular simulation</article-title>
      <source>Computer Physics Communications</source>
      <year iso-8601-date="2019">2019</year>
      <volume>238</volume>
      <issn>0010-4655</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0010465518304399</uri>
      <pub-id pub-id-type="doi">10.1016/j.cpc.2018.12.017</pub-id>
      <fpage>66</fpage>
      <lpage>76</lpage>
    </element-citation>
  </ref>
  <ref id="ref-weik2019espresso">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Weik</surname><given-names>Florian</given-names></name>
        <name><surname>Weeber</surname><given-names>Rudolf</given-names></name>
        <name><surname>Szuttor</surname><given-names>Kai</given-names></name>
        <name><surname>Breitsprecher</surname><given-names>Konrad</given-names></name>
        <name><surname>Graaf</surname><given-names>Joost de</given-names></name>
        <name><surname>Kuron</surname><given-names>Michael</given-names></name>
        <name><surname>Landsgesell</surname><given-names>Jonas</given-names></name>
        <name><surname>Menke</surname><given-names>Henri</given-names></name>
        <name><surname>Sean</surname><given-names>David</given-names></name>
        <name><surname>Holm</surname><given-names>Christian</given-names></name>
      </person-group>
      <article-title>ESPResSo 4.0–an extensible software package for simulating soft matter systems</article-title>
      <source>The European Physical Journal Special Topics</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>227</volume>
      <pub-id pub-id-type="doi">10.1140/epjst/e2019-800186-9</pub-id>
      <fpage>1789</fpage>
      <lpage>1816</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
