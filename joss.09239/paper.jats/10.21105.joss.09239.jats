<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">9239</article-id>
<article-id pub-id-type="doi">10.21105/joss.09239</article-id>
<title-group>
<article-title>solposx: A Python package for determining solar position
and atmospheric refraction</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5554-9856</contrib-id>
<name>
<surname>Jensen</surname>
<given-names>Adam R.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0933-2952</contrib-id>
<name>
<surname>Sifnaios</surname>
<given-names>Ioannis</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1166-7957</contrib-id>
<name>
<surname>Anderson</surname>
<given-names>Kevin S.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0009-0253-267X</contrib-id>
<name>
<surname>Luis</surname>
<given-names>Echedey</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Technical University of Denmark (DTU),
Denmark</institution>
<institution-id institution-id-type="ROR">04qtj9h94</institution-id>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Sandia National Laboratories, USA</institution>
<institution-id institution-id-type="ROR">01apwpt12</institution-id>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Universidad Politécnica de Madrid (UPM),
Spain</institution>
<institution-id institution-id-type="ROR">03n6nwv02</institution-id>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-08-13">
<day>13</day>
<month>8</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>115</issue>
<fpage>9239</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>solar energy</kwd>
<kwd>photovoltaics</kwd>
<kwd>solar position</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>solposx</monospace> is a Python package of reference
  algorithms for calculating the sun’s position and atmospheric
  refraction. The package includes 11 solar position algorithms and 6
  refraction models from the past 50 years. All functions follow a
  standardized design pattern, making it easy to compare different
  algorithms. The provided algorithm implementations have been
  thoroughly vetted, making the package a valuable research tool and a
  reliable reference for implementing solar position algorithms in other
  programming languages or applications.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Calculating the sun’s position is a fundamental task in solar
  energy research, for example, when modeling solar irradiance,
  estimating the yield of photovoltaic (PV) systems, or determining
  rotation angles for solar trackers. For this reason, the literature
  contains numerous solar position algorithms (SPAs)
  (<xref alt="Blanco et al., 2020" rid="ref-blanco2020" ref-type="bibr">Blanco
  et al., 2020</xref>;
  <xref alt="Michalsky, 1988" rid="ref-michalsky1988" ref-type="bibr">Michalsky,
  1988</xref>;
  <xref alt="Reda &amp; Andreas, 2004" rid="ref-reda2004" ref-type="bibr">Reda
  &amp; Andreas, 2004</xref>;
  <xref alt="Spencer, 1971" rid="ref-spencer1971" ref-type="bibr">Spencer,
  1971</xref>;
  <xref alt="Walraven, 1978" rid="ref-walraven1978" ref-type="bibr">Walraven,
  1978</xref>).</p>
  <p>Existing SPAs vary in accuracy, computational speed, and period of
  validity. These characteristics are usually tradeoffs, and thus the
  choice of algorithm depends on the specific application. Some
  algorithms have been developed to be computationally lightweight for
  use in solar tracker microcontrollers, and as a tradeoff, are
  inaccurate for past and future years. In contrast, high-accuracy
  algorithms may consist of several hundred mathematical operations to
  retain validity for hundreds or even thousands of years. One example
  of such an algorithm is the SPA from NREL, whose high accuracy and
  extensive period of validity come at the cost of being computationally
  expensive and impractical to implement.</p>
  <p>Solar position algorithms are already available in several open
  source software packages, such as the PV modeling software packages
  <monospace>pvlib-python</monospace>
  (<xref alt="Anderson et al., 2023" rid="ref-anderson2023" ref-type="bibr">Anderson
  et al., 2023</xref>) and <monospace>pysolar</monospace>
  (<xref alt="Stafford, 2007" rid="ref-stafford2025" ref-type="bibr">Stafford,
  2007</xref>), the astronomy packages <monospace>pyephem</monospace>
  (<xref alt="Rhodes, 2011" rid="ref-rhodes2011" ref-type="bibr">Rhodes,
  2011</xref>) and <monospace>skyfield</monospace>
  (<xref alt="Rhodes, 2019" rid="ref-rhodes2019" ref-type="bibr">Rhodes,
  2019</xref>), and the sun physics package <monospace>sunpy</monospace>
  (<xref alt="The SunPy Community et al., 2020" rid="ref-sunpy2020" ref-type="bibr">The
  SunPy Community et al., 2020</xref>). These packages are tailored to
  very specific purposes and only contain one or a few different solar
  position algorithms. Consequently, there are many solar position
  algorithms for which an open source reference implementation is not
  available. This makes it difficult to evaluate the tradeoffs of the
  various solar position algorithms, which is necessary in order to make
  informed decisions on which algorithm to choose for a specific
  application.</p>
  <p><bold>Sol</bold>ar<bold>Pos</bold>ition<bold>X</bold>
  (<monospace>solposx</monospace>) is a Python package for calculating
  solar position angles and atmospheric refraction corrections. The
  package provides reference implementations of a large number of solar
  position and refraction correction algorithms spanning 50 years of the
  scientific literature. The SPAs range from simple algorithms based on
  fitted equations to research-grade astronomy algorithms based on
  complex ephemerides. As of <monospace>solposx</monospace> version
  v1.0.0, the package includes 11 different solar position algorithms
  and 6 algorithms for estimating atmospheric refraction. The “X” in
  <monospace>solposx</monospace> refers to the modular design of the
  package, allowing users to seamlessly switch between a variety of
  algorithms depending on their desired needs. An overview of the
  modules and functions is provided in
  <xref alt="[fig:package]" rid="figU003Apackage">[fig:package]</xref>.</p>
  <p>The solar position functions follow a standard pattern, taking
  three main input parameters (times, latitude, and longitude) and
  returning a <monospace>Pandas</monospace>
  <monospace>DataFrame</monospace> with solar elevation, zenith, and
  azimuth angles. This makes it extremely easy to compare and switch
  between SPAs, regardless of whether the functions execute code from
  within the <monospace>solposx</monospace> package, rely on external
  Python packages (which is the case for the
  <monospace>skyfield</monospace> and <monospace>sg2</monospace>
  functions), or retrieve data remotely (which is the case for NASA’s
  Horizons service
  (<xref alt="NASA Jet Propulsion Laboratory, California Institute of Technology, 2025" rid="ref-nasa2025" ref-type="bibr">NASA
  Jet Propulsion Laboratory, California Institute of Technology,
  2025</xref>)). The refraction correction models also follow a
  standardized pattern where the main input is an array or series of
  solar elevation angles and the output is the atmospheric refraction
  correction angles.</p>
  <fig>
    <caption><p>Overview of modules and functions in the
    <monospace>solposx</monospace>
    package.<styled-content id="figU003Apackage"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="solposx_package_structure.png" />
  </fig>
  <p>The package relies heavily on the <monospace>Pandas</monospace>
  Python package
  (<xref alt="McKinney, 2010" rid="ref-mckinney2010" ref-type="bibr">McKinney,
  2010</xref>), due to its convenient
  <monospace>DatetimeIndex</monospace> class. The reason for this choice
  is that it offers a very convenient way to handle timestamps,
  including timezone information and conversion between timezones.</p>
  <p>Besides direct applications of calculating solar position, one of
  the main use cases of the package is providing verified reference
  implementations to users who are implementing algorithms in other
  languages or applications. Access to verified reference
  implementations is an essential tool as solar position algorithms tend
  to be sensitive to small implementation details. For example, a small
  detail such as using an incorrect rounding convention, e.g., rounding
  towards zero vs. rounding down, can result in solar position angles
  being off by more than 0.1 degrees, an error much larger than the
  claimed accuracy of most SPAs. Such subtle but serious implementation
  errors are, in the authors’ experience, almost inevitable when
  implementing SPAs, creating a need for correct and accessible
  reference implementations. With access to vetted and tested reference
  implementations of these SPAs, users can generate reliable test values
  for validating and debugging their own implementations. Notably, the
  <monospace>solposx</monospace> package has already been used for
  research purposes, most recently in a study comparing the performance
  of solar position algorithms for PV applications
  (<xref alt="Jensen et al., 2025" rid="ref-jensen2025" ref-type="bibr">Jensen
  et al., 2025</xref>).</p>
  <p><monospace>solposx</monospace> is developed openly on GitHub and
  released under a BSD 3-clause license, allowing permissive use with
  attribution. The package is extensively tested, ensuring that the
  algorithms work for a large range of inputs and remain consistent. In
  general, <monospace>solposx</monospace> has been developed following
  modern best practices for packaging, documentation, and testing.
  Additional algorithms are expected to be added as new algorithms are
  developed or if additional historical algorithms of interest are
  identified.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>Adam R. Jensen and Ioannis Sifnaios were supported by the Danish
  Energy Agency through grant no. 134232-510237.</p>
  <p>This work was supported in part by the U.S. Department of Energy’s
  Office of Energy Efficiency and Renewable Energy (EERE) under the
  Solar Energy Technologies Office Award Number 52788. Sandia National
  Laboratories is a multimission laboratory managed and operated by
  National Technology &amp; Engineering Solutions of Sandia, LLC, a
  wholly owned subsidiary of Honeywell International Inc., for the U.S.
  Department of Energy’s National Nuclear Security Administration under
  contract DE-NA0003525. This paper describes objective technical
  results and analysis. Any subjective views or opinions that might be
  expressed in the paper do not necessarily represent the views of the
  U.S. Department of Energy or the United States Government.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-spencer1971">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Spencer</surname><given-names>JW</given-names></name>
      </person-group>
      <article-title>Fourier series representation of the position of the sun</article-title>
      <source>Search</source>
      <year iso-8601-date="1971">1971</year>
      <volume>2</volume>
      <issue>5</issue>
      <fpage>172</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-walraven1978">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Walraven</surname><given-names>Robert</given-names></name>
      </person-group>
      <article-title>Calculating the position of the sun</article-title>
      <source>Solar Energy</source>
      <year iso-8601-date="1978">1978</year>
      <volume>20</volume>
      <issue>5</issue>
      <issn>0038-092X</issn>
      <pub-id pub-id-type="doi">10.1016/0038-092X(78)90155-X</pub-id>
      <fpage>393</fpage>
      <lpage>397</lpage>
    </element-citation>
  </ref>
  <ref id="ref-michalsky1988">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Michalsky</surname><given-names>Joseph J.</given-names></name>
      </person-group>
      <article-title>The astronomical almanac’s algorithm for approximate solar position (1950–2050)</article-title>
      <source>Solar Energy</source>
      <publisher-name>Elsevier BV</publisher-name>
      <year iso-8601-date="1988">1988</year>
      <volume>40</volume>
      <issue>3</issue>
      <issn>0038-092X</issn>
      <pub-id pub-id-type="doi">10.1016/0038-092x(88)90045-x</pub-id>
      <fpage>227</fpage>
      <lpage>235</lpage>
    </element-citation>
  </ref>
  <ref id="ref-reda2004">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Reda</surname><given-names>Ibrahim</given-names></name>
        <name><surname>Andreas</surname><given-names>Afshin</given-names></name>
      </person-group>
      <article-title>Solar position algorithm for solar radiation applications</article-title>
      <source>Solar Energy</source>
      <publisher-name>Elsevier BV</publisher-name>
      <year iso-8601-date="2004">2004</year>
      <volume>76</volume>
      <issue>5</issue>
      <issn>0038-092X</issn>
      <pub-id pub-id-type="doi">10.1016/j.solener.2003.12.003</pub-id>
      <fpage>577</fpage>
      <lpage>589</lpage>
    </element-citation>
  </ref>
  <ref id="ref-blanco2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Blanco</surname><given-names>Manuel J.</given-names></name>
        <name><surname>Milidonis</surname><given-names>Kypros</given-names></name>
        <name><surname>Bonanos</surname><given-names>Aristides M.</given-names></name>
      </person-group>
      <article-title>Updating the PSA sun position algorithm</article-title>
      <source>Solar Energy</source>
      <publisher-name>Elsevier BV</publisher-name>
      <year iso-8601-date="2020-12">2020</year><month>12</month>
      <volume>212</volume>
      <issn>0038-092X</issn>
      <pub-id pub-id-type="doi">10.1016/j.solener.2020.10.084</pub-id>
      <fpage>339</fpage>
      <lpage>341</lpage>
    </element-citation>
  </ref>
  <ref id="ref-anderson2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Anderson</surname><given-names>Kevin S.</given-names></name>
        <name><surname>Hansen</surname><given-names>Clifford W.</given-names></name>
        <name><surname>Holmgren</surname><given-names>William F.</given-names></name>
        <name><surname>Jensen</surname><given-names>Adam R.</given-names></name>
        <name><surname>Mikofski</surname><given-names>Mark A.</given-names></name>
        <name><surname>Driesse</surname><given-names>Anton</given-names></name>
      </person-group>
      <article-title>Pvlib python: 2023 project update</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2023-12">2023</year><month>12</month>
      <volume>8</volume>
      <issue>92</issue>
      <issn>2475-9066</issn>
      <pub-id pub-id-type="doi">10.21105/joss.05994</pub-id>
      <fpage>5994</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-rhodes2019">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Rhodes</surname><given-names>Brandon</given-names></name>
      </person-group>
      <article-title>Skyfield: High precision research-grade positions for planets and Earth satellites generator</article-title>
      <publisher-name>Astrophysics Source Code Library, record ascl:1907.024</publisher-name>
      <year iso-8601-date="2019-07">2019</year><month>07</month>
    </element-citation>
  </ref>
  <ref id="ref-rhodes2011">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Rhodes</surname><given-names>Brandon</given-names></name>
      </person-group>
      <article-title>PyEphem: Astronomical Ephemeris for Python</article-title>
      <publisher-name>Astrophysics Source Code Library, ascl:1112.014</publisher-name>
      <year iso-8601-date="2011">2011</year>
      <uri>https://rhodesmill.org/pyephem/</uri>
    </element-citation>
  </ref>
  <ref id="ref-mckinney2010">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>McKinney</surname></name>
      </person-group>
      <article-title>Data Structures for Statistical Computing in Python</article-title>
      <source>Proceedings of the 9th Python in Science Conference</source>
      <person-group person-group-type="editor">
        <name><surname>Walt</surname></name>
        <name><surname>Millman</surname></name>
      </person-group>
      <year iso-8601-date="2010">2010</year>
      <pub-id pub-id-type="doi">10.25080/Majora-92bf1922-00a</pub-id>
      <fpage>56 </fpage>
      <lpage> 61</lpage>
    </element-citation>
  </ref>
  <ref id="ref-stafford2025">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Stafford</surname><given-names>Brandon</given-names></name>
      </person-group>
      <article-title>Pysolar: Python libraries for simulating solar irradiation</article-title>
      <year iso-8601-date="2007">2007</year>
      <uri>https://pypi.org/project/pysolar/</uri>
    </element-citation>
  </ref>
  <ref id="ref-jensen2025">
    <element-citation publication-type="manuscript">
      <person-group person-group-type="author">
        <name><surname>Jensen</surname><given-names>Adam R.</given-names></name>
        <name><surname>Sifnaios</surname><given-names>Ioannis</given-names></name>
        <name><surname>Anderson</surname><given-names>Kevin S.</given-names></name>
      </person-group>
      <article-title>Solar Position Algorithms</article-title>
      <year iso-8601-date="2025">2025</year>
      <uri>https://pvpmc.sandia.gov/download/8943/?tmstv=1754599268</uri>
    </element-citation>
  </ref>
  <ref id="ref-sunpy2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>The SunPy Community</string-name>
        <name><surname>Barnes</surname><given-names>Will T.</given-names></name>
        <name><surname>Bobra</surname><given-names>Monica G.</given-names></name>
        <name><surname>Christe</surname><given-names>Steven D.</given-names></name>
        <name><surname>Freij</surname><given-names>Nabil</given-names></name>
        <name><surname>Hayes</surname><given-names>Laura A.</given-names></name>
        <name><surname>Ireland</surname><given-names>Jack</given-names></name>
        <name><surname>Mumford</surname><given-names>Stuart</given-names></name>
        <name><surname>Perez-Suarez</surname><given-names>David</given-names></name>
        <name><surname>Ryan</surname><given-names>Daniel F.</given-names></name>
        <name><surname>Shih</surname><given-names>Albert Y.</given-names></name>
        <name><surname>Chanda</surname><given-names>Prateek</given-names></name>
        <name><surname>Glogowski</surname><given-names>Kolja</given-names></name>
        <name><surname>Hewett</surname><given-names>Russell</given-names></name>
        <name><surname>Hughitt</surname><given-names>V. Keith</given-names></name>
        <name><surname>Hill</surname><given-names>Andrew</given-names></name>
        <name><surname>Hiware</surname><given-names>Kaustubh</given-names></name>
        <name><surname>Inglis</surname><given-names>Andrew</given-names></name>
        <name><surname>Kirk</surname><given-names>Michael S. F.</given-names></name>
        <name><surname>Konge</surname><given-names>Sudarshan</given-names></name>
        <name><surname>Mason</surname><given-names>James Paul</given-names></name>
        <name><surname>Maloney</surname><given-names>Shane Anthony</given-names></name>
        <name><surname>Murray</surname><given-names>Sophie A.</given-names></name>
        <name><surname>Panda</surname><given-names>Asish</given-names></name>
        <name><surname>Park</surname><given-names>Jongyeob</given-names></name>
        <name><surname>Pereira</surname><given-names>Tiago M. D.</given-names></name>
        <name><surname>Reardon</surname><given-names>Kevin</given-names></name>
        <name><surname>Savage</surname><given-names>Sabrina</given-names></name>
        <name><surname>Sipőcz</surname><given-names>Brigitta M.</given-names></name>
        <name><surname>Stansby</surname><given-names>David</given-names></name>
        <name><surname>Jain</surname><given-names>Yash</given-names></name>
        <name><surname>Taylor</surname><given-names>Garrison</given-names></name>
        <name><surname>Yadav</surname><given-names>Tannmay</given-names></name>
        <name><surname>Rajul</surname></name>
        <name><surname>Dang</surname><given-names>Trung Kien</given-names></name>
      </person-group>
      <article-title>The SunPy project: Open source development and status of the version 1.0 core package</article-title>
      <source>The Astrophysical Journal</source>
      <publisher-name>American Astronomical Society</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>890</volume>
      <pub-id pub-id-type="doi">10.3847/1538-4357/ab4f7a</pub-id>
      <fpage>68</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-nasa2025">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>NASA Jet Propulsion Laboratory, California Institute of Technology</string-name>
      </person-group>
      <article-title>Horizons - solar system dynamics</article-title>
      <year iso-8601-date="2025">2025</year>
      <uri>https://ssd.jpl.nasa.gov</uri>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
