<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7852</article-id>
<article-id pub-id-type="doi">10.21105/joss.07852</article-id>
<title-group>
<article-title>PyRASA - Spectral parametrization in python based on
IRASA</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9839-1614</contrib-id>
<name>
<surname>Schmidt</surname>
<given-names>Fabian</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7816-0037</contrib-id>
<name>
<surname>Weisz</surname>
<given-names>Nathan</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8298-8125</contrib-id>
<name>
<surname>Hartmann</surname>
<given-names>Thomas</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Paris-Lodron-University of Salzburg, Department of
Psychology, Centre for Cognitive Neuroscience, Salzburg,
Austria</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Neuroscience Institute, Christian Doppler University
Hospital, Paracelsus Medical University, Salzburg, Austria</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-10-14">
<day>14</day>
<month>10</month>
<year>2024</year>
</pub-date>
<volume>10</volume>
<issue>109</issue>
<fpage>7852</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>spectral parametrization</kwd>
<kwd>1/f</kwd>
<kwd>aperiodic</kwd>
<kwd>oscillations</kwd>
<kwd>electrophysiology</kwd>
<kwd>time frequency analysis</kwd>
<kwd>electroencephalography</kwd>
<kwd>EEG</kwd>
<kwd>magnetoencephalography</kwd>
<kwd>MEG</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>The electric signals generated by physiological activity exhibit
  both activity patterns that are regularly repeating over time
  (i.e. periodic) and activity patterns that are temporally irregular
  (i.e. aperiodic). In recent years several algorithms have been
  proposed to separate the periodic from the aperiodic parts of the
  signal, such as the irregular-resampling auto-spectral analysis
  (IRASA,
  (<xref alt="Wen &amp; Liu, 2016" rid="ref-wen2016separating" ref-type="bibr">Wen
  &amp; Liu, 2016</xref>)). IRASA separates periodic and aperiodic
  components by up-/downsampling time domain signals and computing their
  respective auto-power spectra. Finally, the aperiodic component is
  isolated by averaging over the resampled auto-power spectra removing
  any frequency-specific activity. The aperiodic component can then be
  subtracted from the original power spectrum yielding the residual
  periodic component. <monospace>PyRASA</monospace> is a package that is
  built upon and extends the IRASA algorithm
  (<xref alt="Wen &amp; Liu, 2016" rid="ref-wen2016separating" ref-type="bibr">Wen
  &amp; Liu, 2016</xref>). The package not only allows its users to
  separate power spectra, but also contains functionality to further
  parametrize the periodic and aperiodic spectra, by means of peak
  detection and several slope fitting options (eg. spectral knees).
  Furthermore, we implemented a function to use the IRASA algorithm in
  the time-frequency domain allowing for a time-resolved spectral
  parametrization using IRASA.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p><monospace>PyRASA</monospace> is an open-source Python package for
  the parametrization of (neural) power spectra.
  <monospace>PyRASA</monospace> has a lightweight architecture that
  allows users to directly apply the respective functions to separate
  power spectra to numpy arrays containing time series data
  (<xref alt="Harris et al., 2020" rid="ref-harris2020array" ref-type="bibr">Harris
  et al., 2020</xref>). However, <monospace>PyRASA</monospace> can also
  be optionally extended with functionality to be used in conjunction
  with <monospace>MNE Python</monospace> (a popular beginner-friendly
  tool for the analysis of electrophysiological data,
  (<xref alt="Gramfort et al., 2014" rid="ref-gramfort2014mne" ref-type="bibr">Gramfort
  et al., 2014</xref>)), thus offering both beginners in (neural) time
  series analysis and more advanced users a tool to easily analyze their
  data. The IRASA algorithm per se has been implemented in a couple of
  other software packages
  (<xref alt="Cole et al., 2019" rid="ref-cole2019neurodsp" ref-type="bibr">Cole
  et al., 2019</xref>;
  <xref alt="Oostenveld et al., 2011" rid="ref-oostenveld2011fieldtrip" ref-type="bibr">Oostenveld
  et al., 2011</xref>;
  <xref alt="Vallat &amp; Walker, 2021" rid="ref-vallat2021open" ref-type="bibr">Vallat
  &amp; Walker, 2021</xref>), but these implementations of IRASA largely
  lack functionality to further parametrize periodic and aperiodic
  spectra in their respective components. We close this gap by offering
  such functionality for both periodic and aperiodic spectra. For
  periodic spectra users can extract peak height, bandwidth and center
  frequency of putative oscillations. Aperiodic spectra can be further
  analyzed by means of several slope fitting options that allow not only
  for the assessment of Goodness of fit by several metrics (R2, mean
  squared error), but also for model comparison using information
  criteria (BIC/AIC). Additionally, users can easily implement their own
  custom functions to model aperiodic activity. Furthermore, we
  implemented a function to use the IRASA algorithm in the
  time-frequency domain, by computing IRASA over up-/downsampled
  versions of spectrograms instead of power spectra thereby also
  allowing for a time-resolved spectral parametrization of (neural) time
  series data.</p>
</sec>
<sec id="related-projects">
  <title>Related Projects</title>
  <p><monospace>PyRASA’s</monospace> functionality is inspired by
  specparam (formerly <monospace>FOOOF</monospace>,
  (<xref alt="Donoghue et al., 2020" rid="ref-donoghue2020parameterizing" ref-type="bibr">Donoghue
  et al., 2020</xref>)), a popular tool for spectral parametrization
  built upon a different algorithm that separates power spectra by first
  flattening the spectrum and then sequentially modelling peaks as
  gaussians followed by a final fit of the aperiodic component. Each
  algorithm (IRASA vs. specparam) comes with their specific advantages
  and disadvantages that are also discussed by Gerster et al.
  (<xref alt="2022" rid="ref-gerster2022separating" ref-type="bibr">2022</xref>).</p>
  <p>The IRASA algorithm has also been implemented as part of software
  packages <monospace>NeuroDSP</monospace>
  (<xref alt="Cole et al., 2019" rid="ref-cole2019neurodsp" ref-type="bibr">Cole
  et al., 2019</xref>), <monospace>YASA</monospace>
  (<xref alt="Vallat &amp; Walker, 2021" rid="ref-vallat2021open" ref-type="bibr">Vallat
  &amp; Walker, 2021</xref>) and <monospace>FieldTrip</monospace>
  (<xref alt="Oostenveld et al., 2011" rid="ref-oostenveld2011fieldtrip" ref-type="bibr">Oostenveld
  et al., 2011</xref>).</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We want to thank Gianpaolo Demarchi, Patrick Reisinger and Mohammed
  Ameen for beta testing PyRASA and helpful comments that improved its
  development. This project received financial support from the Land
  Salzburg through the BrainAge project (20102/F2400537-FPR).</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-cole2019neurodsp">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cole</surname><given-names>Scott</given-names></name>
        <name><surname>Donoghue</surname><given-names>Thomas</given-names></name>
        <name><surname>Gao</surname><given-names>Richard</given-names></name>
        <name><surname>Voytek</surname><given-names>Bradley</given-names></name>
      </person-group>
      <article-title>NeuroDSP: A package for neural digital signal processing</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>36</issue>
      <pub-id pub-id-type="doi">10.21105/joss.01272</pub-id>
      <fpage>1272</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-donoghue2020parameterizing">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Donoghue</surname><given-names>Thomas</given-names></name>
        <name><surname>Haller</surname><given-names>Matar</given-names></name>
        <name><surname>Peterson</surname><given-names>Erik J</given-names></name>
        <name><surname>Varma</surname><given-names>Paroma</given-names></name>
        <name><surname>Sebastian</surname><given-names>Priyadarshini</given-names></name>
        <name><surname>Gao</surname><given-names>Richard</given-names></name>
        <name><surname>Noto</surname><given-names>Torben</given-names></name>
        <name><surname>Lara</surname><given-names>Antonio H</given-names></name>
        <name><surname>Wallis</surname><given-names>Joni D</given-names></name>
        <name><surname>Knight</surname><given-names>Robert T</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Parameterizing neural power spectra into periodic and aperiodic components</article-title>
      <source>Nature neuroscience</source>
      <publisher-name>Nature Publishing Group US New York</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>23</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1038/s41593-020-00744-x</pub-id>
      <fpage>1655</fpage>
      <lpage>1665</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gerster2022separating">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gerster</surname><given-names>Moritz</given-names></name>
        <name><surname>Waterstraat</surname><given-names>Gunnar</given-names></name>
        <name><surname>Litvak</surname><given-names>Vladimir</given-names></name>
        <name><surname>Lehnertz</surname><given-names>Klaus</given-names></name>
        <name><surname>Schnitzler</surname><given-names>Alfons</given-names></name>
        <name><surname>Florin</surname><given-names>Esther</given-names></name>
        <name><surname>Curio</surname><given-names>Gabriel</given-names></name>
        <name><surname>Nikulin</surname><given-names>Vadim</given-names></name>
      </person-group>
      <article-title>Separating neural oscillations from aperiodic 1/f activity: Challenges and recommendations</article-title>
      <source>Neuroinformatics</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>20</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1007/s12021-022-09581-8</pub-id>
      <fpage>991</fpage>
      <lpage>1012</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gramfort2014mne">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gramfort</surname><given-names>Alexandre</given-names></name>
        <name><surname>Luessi</surname><given-names>Martin</given-names></name>
        <name><surname>Larson</surname><given-names>Eric</given-names></name>
        <name><surname>Engemann</surname><given-names>Denis A</given-names></name>
        <name><surname>Strohmeier</surname><given-names>Daniel</given-names></name>
        <name><surname>Brodbeck</surname><given-names>Christian</given-names></name>
        <name><surname>Parkkonen</surname><given-names>Lauri</given-names></name>
        <name><surname>Hämäläinen</surname><given-names>Matti S</given-names></name>
      </person-group>
      <article-title>MNE software for processing MEG and EEG data</article-title>
      <source>neuroimage</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2014">2014</year>
      <volume>86</volume>
      <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.10.027</pub-id>
      <fpage>446</fpage>
      <lpage>460</lpage>
    </element-citation>
  </ref>
  <ref id="ref-harris2020array">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harris</surname><given-names>Charles R</given-names></name>
        <name><surname>Millman</surname><given-names>K Jarrod</given-names></name>
        <name><surname>Van Der Walt</surname><given-names>Stéfan J</given-names></name>
        <name><surname>Gommers</surname><given-names>Ralf</given-names></name>
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>Cournapeau</surname><given-names>David</given-names></name>
        <name><surname>Wieser</surname><given-names>Eric</given-names></name>
        <name><surname>Taylor</surname><given-names>Julian</given-names></name>
        <name><surname>Berg</surname><given-names>Sebastian</given-names></name>
        <name><surname>Smith</surname><given-names>Nathaniel J</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Array programming with NumPy</article-title>
      <source>Nature</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>585</volume>
      <issue>7825</issue>
      <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
      <fpage>357</fpage>
      <lpage>362</lpage>
    </element-citation>
  </ref>
  <ref id="ref-oostenveld2011fieldtrip">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Oostenveld</surname><given-names>Robert</given-names></name>
        <name><surname>Fries</surname><given-names>Pascal</given-names></name>
        <name><surname>Maris</surname><given-names>Eric</given-names></name>
        <name><surname>Schoffelen</surname><given-names>Jan-Mathijs</given-names></name>
      </person-group>
      <article-title>FieldTrip: Open source software for advanced analysis of MEG, EEG, and invasive electrophysiological data</article-title>
      <source>Computational intelligence and neuroscience</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2011">2011</year>
      <volume>2011</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1155/2011/156869</pub-id>
      <fpage>156869</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-wen2016separating">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wen</surname><given-names>Haiguang</given-names></name>
        <name><surname>Liu</surname><given-names>Zhongming</given-names></name>
      </person-group>
      <article-title>Separating fractal and oscillatory components in the power spectrum of neurophysiological signal</article-title>
      <source>Brain topography</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>29</volume>
      <pub-id pub-id-type="doi">10.1007/s10548-015-0448-0</pub-id>
      <fpage>13</fpage>
      <lpage>26</lpage>
    </element-citation>
  </ref>
  <ref id="ref-vallat2021open">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vallat</surname><given-names>Raphael</given-names></name>
        <name><surname>Walker</surname><given-names>Matthew P</given-names></name>
      </person-group>
      <article-title>An open-source, high-performance tool for automated sleep staging</article-title>
      <source>Elife</source>
      <publisher-name>eLife Sciences Publications Limited</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>10</volume>
      <pub-id pub-id-type="doi">10.7554/eLife.70092</pub-id>
      <fpage>e70092</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
