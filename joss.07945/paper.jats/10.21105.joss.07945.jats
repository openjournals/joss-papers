<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7945</article-id>
<article-id pub-id-type="doi">10.21105/joss.07945</article-id>
<title-group>
<article-title>BioMAC-Sim-Toolbox: A MATLAB toolbox for biomechanical
motion analysis and creation through simulation</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1867-0374</contrib-id>
<name>
<surname>Koelewijn</surname>
<given-names>Anne D.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7318-9578</contrib-id>
<name>
<surname>Nitschke</surname>
<given-names>Marlies</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8708-0426</contrib-id>
<name>
<surname>Dorschky</surname>
<given-names>Eva</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4096-2354</contrib-id>
<name>
<surname>Gambietz</surname>
<given-names>Markus</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0003-1604-6679</contrib-id>
<name>
<surname>Weiss</surname>
<given-names>Alexander</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0417-0336</contrib-id>
<name>
<surname>Eskofier</surname>
<given-names>Bjoern M.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3791-3749</contrib-id>
<name>
<surname>van den Bogert</surname>
<given-names>Antonie J.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Friedrich-Alexander-UniversitÃ¤t Erlangen-NÃ¼rnberg,
Erlangen, Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Cleveland State University, Cleveland, Ohio, United States
of America</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-08-13">
<day>13</day>
<month>8</month>
<year>2024</year>
</pub-date>
<volume>10</volume>
<issue>115</issue>
<fpage>7945</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>MATLAB</kwd>
<kwd>Biomechanics</kwd>
<kwd>Movement Simulation</kwd>
<kwd>Movement Analysis</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>We present a MATLAB toolbox for human movement simulation and
  analysis. The toolboxâ€™s focus is on creating simulations of human
  walking and running by solving trajectory optimization problems. In
  these problems, the muscle excitations and initial state are found
  that minimize an objective related to energy expenditure. To solve the
  trajectory optimization problems, we have implemented a direct
  collocation framework. Different objectives have been implemented that
  represent energy or effort minimization. We have also included
  different objectives for data tracking, including tracking of joint
  angles, ground reaction forces, accelerometer data, gyroscope data,
  and marker positions. We have implemented two different
  two-dimensional (2D) musculoskeletal models and one three-dimensional
  (3D) musculoskeletal model. To show how the toolbox can be used, we
  include a tutorial, a 2D and a 3D introductory example, as well as
  different applications that are based on previous publications. The
  toolbox is versatile due to its object-oriented design, such that
  different dynamics models can be easily combined with different
  problem classes. In the future, we aim to implement different other
  problem classes as well, such as inverse kinematics and dynamics to
  process experimental data, static and dynamic optimizations to find
  muscle simulations from joint moments, while also forward shooting can
  be used to investigate neural control of gait.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Movements of humans and other animals are extremely versatile,
  while our efficiency is unmatched by human-made machines, even though
  humans seemingly have inaccurate and inefficient controllers.
  Therefore, a better understanding of human movement can have a large
  impact for persons with movement disabilities, sports performance
  optimization, and design of human-made devices. Movement simulations
  are a key tool for creating this understanding. On the one hand, we
  can use so-called predictive simulations
  (<xref alt="Ackermann &amp; Van den Bogert, 2010" rid="ref-ackermannU003A2010" ref-type="bibr">Ackermann
  &amp; Van den Bogert, 2010</xref>;
  <xref alt="Falisse et al., 2019" rid="ref-falisseU003A2019" ref-type="bibr">Falisse
  et al., 2019</xref>;
  <xref alt="Koelewijn et al., 2018" rid="ref-koelewijnU003A2018" ref-type="bibr">Koelewijn
  et al., 2018</xref>) to investigate unseen movements by replicating
  the optimization in the central nervous system
  (<xref alt="Zarrugh et al., 1974" rid="ref-zarrughU003A1974" ref-type="bibr">Zarrugh
  et al., 1974</xref>) in a computer optimization. Such simulations can
  help us decipher fundamentals of movement in humans and other animals.
  On the other hand, we can use so-called reconstructive simulations to
  estimate variables that cannot or were not measured directly by
  minimizing a data tracking error
  (<xref alt="Dorschky, Nitschke, et al., 2019" rid="ref-dorsckyU003A2019a" ref-type="bibr">Dorschky,
  Nitschke, et al., 2019</xref>;
  <xref alt="Nitschke et al., 2023" rid="ref-nitschkeU003A2023" ref-type="bibr">Nitschke
  et al., 2023</xref>,
  <xref alt="2024" rid="ref-nitschkeU003A2024" ref-type="bibr">2024</xref>).
  These reconstructive simulations do not necessarily require laboratory
  equipment, instead allowing biomechanical variables to be estimated
  accurately from wearable or contactless sensors, such as inertial
  sensors. Widespread measurement of movements and their biomechanical
  analysis are vital to be able to reach a deep understanding of human
  movement.</p>
</sec>
<sec id="biomac-sim-toolbox">
  <title>BioMAC-Sim-Toolbox</title>
  <p>Here, we present the <monospace>BioMAC-Sim-Toolbox</monospace>, a
  MATLAB toolbox that can be used to simulate and analyse human
  movements. This toolbox is released under an Apache-2.0 license and
  can be accessed on GitHub:
  <ext-link ext-link-type="uri" xlink:href="https://github.com/mad-lab-fau/BioMAC-Sim-Toolbox">https://github.com/mad-lab-fau/BioMAC-Sim-Toolbox</ext-link>.
  The main functionality of the toolbox is that it solves trajectory
  optimization problems, or optimal control problems, for human
  musculoskeletal dynamics models. These dynamics models combine
  multibody dynamics to model the movements of the skeleton with muscle
  dynamics models to model the dynamics of muscular contraction and
  activation. In the trajectory optimization problem, the muscle
  excitations and initial state, as well as possibly other gait
  variables such as speed or duration, are found that minimize an
  objective. This objective generally includes terms to minimize
  muscular effort and to minimize a tracking error with respect to
  measured movement data
  (<xref alt="Dorschky, Nitschke, et al., 2019" rid="ref-dorsckyU003A2019a" ref-type="bibr">Dorschky,
  Nitschke, et al., 2019</xref>;
  <xref alt="Dorschky, KrÃ¼ger, et al., 2019" rid="ref-dorschkyU003A2019b" ref-type="bibr">Dorschky,
  KrÃ¼ger, et al., 2019</xref>;
  <xref alt="Koelewijn &amp; Selinger, 2022" rid="ref-koelewijnU003A2022" ref-type="bibr">Koelewijn
  &amp; Selinger, 2022</xref>;
  <xref alt="Koelewijn &amp; Van den Bogert, 2016" rid="ref-koelewijnU003A2016" ref-type="bibr">Koelewijn
  &amp; Van den Bogert, 2016</xref>;
  <xref alt="Nitschke et al., 2023" rid="ref-nitschkeU003A2023" ref-type="bibr">Nitschke
  et al., 2023</xref>,
  <xref alt="2024" rid="ref-nitschkeU003A2024" ref-type="bibr">2024</xref>),
  but several additional objectives have been implemented as well, such
  as minimization of metabolic energy expenditure
  (<xref alt="Koelewijn et al., 2018" rid="ref-koelewijnU003A2018" ref-type="bibr">Koelewijn
  et al., 2018</xref>). The optimization problem can be described
  mathematically as follows:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \underset{\mathbf{x}(0),\mathbf{u}(t), T} {\text{minimize}} \quad J(\mathbf{x}, \mathbf{u}) =  \sum_{j=1}^{N_W} W_{j} \int_{t=0}^T c_{j}(x(t),u(t)) \mathrm{d} t + c_f(x(T),u(T)) ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:munder><mml:mtext mathvariant="normal">minimize</mml:mtext><mml:mrow><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mspace width="1.0em"></mml:mspace><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ±</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>W</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>W</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:msubsup><mml:mo>âˆ«</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>u</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \text{subject to} \quad  \mathbf{f}(\mathbf{x}(t), \mathbf{\dot{x}}(t), \mathbf{u}(t)) = \mathbf{0} \ \text{for }0 \leq t \leq T \ \text{(system dynamics)} ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">subject to</mml:mtext><mml:mspace width="1.0em"></mml:mspace><mml:mi>ğŸ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mover><mml:mi>ğ±</mml:mi><mml:mo accent="true">Ì‡</mml:mo></mml:mover><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>ğŸ</mml:mn><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mtext mathvariant="normal">for </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mn>0</mml:mn><mml:mo>â‰¤</mml:mo><mml:mi>t</mml:mi><mml:mo>â‰¤</mml:mo><mml:mi>T</mml:mi><mml:mspace width="0.222em"></mml:mspace><mml:mtext mathvariant="normal">(system dynamics)</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \mathbf{x_L} \leq \mathbf{x}(t) \leq \mathbf{x_U} \ \text{for }0 \leq t \leq T \quad \text{(bounds on states)} ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ğ±</mml:mi><mml:mi>ğ‹</mml:mi></mml:msub><mml:mo>â‰¤</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>â‰¤</mml:mo><mml:msub><mml:mi>ğ±</mml:mi><mml:mi>ğ”</mml:mi></mml:msub><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mtext mathvariant="normal">for </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mn>0</mml:mn><mml:mo>â‰¤</mml:mo><mml:mi>t</mml:mi><mml:mo>â‰¤</mml:mo><mml:mi>T</mml:mi><mml:mspace width="1.0em"></mml:mspace><mml:mtext mathvariant="normal">(bounds on states)</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \mathbf{u_L} \leq \mathbf{u}(t) \leq \mathbf{u_U} \ \text{for }0 \leq t \leq T \quad \text{(bounds on controls)} ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>ğ‹</mml:mi></mml:msub><mml:mo>â‰¤</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>â‰¤</mml:mo><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>ğ”</mml:mi></mml:msub><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mtext mathvariant="normal">for </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mn>0</mml:mn><mml:mo>â‰¤</mml:mo><mml:mi>t</mml:mi><mml:mo>â‰¤</mml:mo><mml:mi>T</mml:mi><mml:mspace width="1.0em"></mml:mspace><mml:mtext mathvariant="normal">(bounds on controls)</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>for a musculoskeletal model with state
  <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  and input <inline-formula><alternatives>
  <tex-math><![CDATA[u]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>u</mml:mi></mml:math></alternatives></inline-formula>.
  Here, the goal is to find the initial state,
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{x}(0)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  control inputs, <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{u}(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  and duration, <inline-formula><alternatives>
  <tex-math><![CDATA[T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>,
  that minimize the cost function, <inline-formula><alternatives>
  <tex-math><![CDATA[J(\mathbf{x}, \mathbf{u})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ±</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  while following the system dynamics <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{f}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğŸ</mml:mi></mml:math></alternatives></inline-formula>.
  The cost function consists of <inline-formula><alternatives>
  <tex-math><![CDATA[c_{j}(\mathbf{x}(t),\mathbf{u}(t))]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  which describes the cost functions that are evaluated over time, which
  are multiplied with associated weight <inline-formula><alternatives>
  <tex-math><![CDATA[W_{j}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>W</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  and of a final cost function <inline-formula><alternatives>
  <tex-math><![CDATA[c_f(\mathbf{x}(T),\mathbf{u}(T))]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  which is only evaluated at the end of the trajectory, at time
  <inline-formula><alternatives>
  <tex-math><![CDATA[T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>.
  We normally do not include a final cost function. The subscript
  <inline-formula><alternatives>
  <tex-math><![CDATA[L]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>L</mml:mi></mml:math></alternatives></inline-formula>
  defines the lower bounds, while <inline-formula><alternatives>
  <tex-math><![CDATA[U]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>U</mml:mi></mml:math></alternatives></inline-formula>
  defines the upper bounds. When speed or duration is known, we commonly
  still include them into the optimization variables, while making the
  lower and upper bound equal to the desired value.</p>
  <p>For walking and running, we include a periodicity constraint to the
  full gait cycle or a single step, in case of a symmetric motion. This
  constraint can be defined for straight and curved running and walking
  (<xref alt="Nitschke et al., 2020" rid="ref-nitschkeU003A2020" ref-type="bibr">Nitschke
  et al., 2020</xref>) through the displacement in the horizontal plane.
  This periodicity constraint ensures that the states are the same at
  the end of the trajectory as at the beginning, while applying a
  horizontal displacement to the states in
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{x}_{hor}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>ğ±</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \mathbf{x}(T) = \mathbf{x}(0) + v T \mathbf{x}_{hor} \quad \text{(periodicity)} ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>ğ±</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mspace width="1.0em"></mml:mspace><mml:mtext mathvariant="normal">(periodicity)</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>So far, we have created the problem class
  <monospace>Collocation</monospace>, which creates a trajectory
  optimization problem using direct collocation
  (<xref alt="Betts, 2010" rid="ref-bettsU003A2010" ref-type="bibr">Betts,
  2010</xref>). In direct collocation, the numerical integration of the
  differential equations that represent the dynamics are solved as
  equality constraints during the optimization. To do so, collocation
  nodes, or time nodes, need to be predefined, and the integration
  method should be selected. We have currently implemented a backward
  Euler and a midpoint Euler integration method. Backward Euler has been
  more stable and has therefore been used for publications. A direct
  collocation approach creates a large-scale nonlinear optimization
  problem, for which the derivatives of the objectives and all
  constraint can be derived analytically. An optimization problem
  including a periodicity constraint could be transcribed as follows
  after applying direct collocation with backward Euler integration:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \underset{\mathbf{x}(i),\mathbf{u}(i), v, T} {\text{minimize}} \quad J(\mathbf{x}, \mathbf{u}) =  \sum_{j=1}^{N_W} W_{j} \sum_{i=0}^N c_{j}(\mathbf{x}(i),\mathbf{u}(i)) + c_f(\mathbf{x}(N),\mathbf{u}(N)) ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:munder><mml:mtext mathvariant="normal">minimize</mml:mtext><mml:mrow><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mspace width="1.0em"></mml:mspace><mml:mi>J</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ±</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>W</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>W</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \text{subject to} \quad  \mathbf{f}(\mathbf{x}(i+1), \frac{\mathbf{{x}}(i+1)-\mathbf{x}(i)}{\Delta t}, \mathbf{u}(i)) = \mathbf{0} \ \text{for }i=1,\dots,N \quad \text{(system dynamics)} ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">subject to</mml:mtext><mml:mspace width="1.0em"></mml:mspace><mml:mi>ğŸ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>âˆ’</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>Î”</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>ğŸ</mml:mn><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mtext mathvariant="normal">for </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mspace width="1.0em"></mml:mspace><mml:mtext mathvariant="normal">(system dynamics)</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \mathbf{x_L} \leq \mathbf{x}(i) \leq \mathbf{x_U} \ \text{for }i=1,\dots,N \quad \text{(bounds on states)} ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ğ±</mml:mi><mml:mi>ğ‹</mml:mi></mml:msub><mml:mo>â‰¤</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>â‰¤</mml:mo><mml:msub><mml:mi>ğ±</mml:mi><mml:mi>ğ”</mml:mi></mml:msub><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mtext mathvariant="normal">for </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mspace width="1.0em"></mml:mspace><mml:mtext mathvariant="normal">(bounds on states)</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \mathbf{u_L} \leq \mathbf{u}(i) \leq \mathbf{u_U} \ \text{for }i=1,\dots,N \quad \text{(bounds on controls)} ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>ğ‹</mml:mi></mml:msub><mml:mo>â‰¤</mml:mo><mml:mi>ğ®</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>â‰¤</mml:mo><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>ğ”</mml:mi></mml:msub><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mtext mathvariant="normal">for </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mspace width="1.0em"></mml:mspace><mml:mtext mathvariant="normal">(bounds on controls)</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \mathbf{x}(N+1) = \mathbf{x}(0) + v T \mathbf{x}_{hor} \quad \text{(periodicity)} ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>ğ±</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mi>T</mml:mi><mml:msub><mml:mi>ğ±</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mspace width="1.0em"></mml:mspace><mml:mtext mathvariant="normal">(periodicity)</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>for <inline-formula><alternatives>
  <tex-math><![CDATA[N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>
  collocation points <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>.
  Compared to the description of the optimization problem in continuous
  time, there are only subtile changes. The integral in the objective
  has changed into a sum, and we have used the backward Euler
  transcription in the dynamics. Furthermore, the bounds and the
  periodicity constraint are now applied to discrete variables.</p>
  <p>Problems can be solved using the solvers that are implemented in
  the class <monospace>solver</monospace>. So far, we have implemented
  an interface to IPOPT
  (<xref alt="WÃ¤chter &amp; Biegler, 2006" rid="ref-WachterU003A2006" ref-type="bibr">WÃ¤chter
  &amp; Biegler, 2006</xref>) to solve the resulting optimization
  problem. This algorithm can solve optimal control problems transcribed
  with direct collocation in less than 10 minutes for a 2D model, for
  example on a computer with an Intel Core i5-3210M CPU at 2.5 GHz clock
  speed
  (<xref alt="Koelewijn &amp; Selinger, 2022" rid="ref-koelewijnU003A2022" ref-type="bibr">Koelewijn
  &amp; Selinger, 2022</xref>;
  <xref alt="Koelewijn &amp; Van den Bogert, 2016" rid="ref-koelewijnU003A2016" ref-type="bibr">Koelewijn
  &amp; Van den Bogert, 2016</xref>) and less than one hour for a 3D
  model on a single core of a workstation with a 3.2GHz Xeon E5-1660v4
  processor
  (<xref alt="Nitschke et al., 2020" rid="ref-nitschkeU003A2020" ref-type="bibr">Nitschke
  et al., 2020</xref>). Different solvers could easily be integrated
  into this solver class.</p>
  <p>As most analysis is specific to the problem type, most code for
  analysis can be found in the respective problem class. For example,
  metabolic cost requires an integration over time, which is dependent
  on the problem type that is being used. In addition, general methods,
  e.g., to calculate a correlation or root mean squared error between
  two variables, or to write results into an OpenSim file format, can be
  found in the function <monospace>HelperFunctions</monospace>
  folder.</p>
  <p>We have implemented different human dynamics models (see Table 1).
  All implemented models are musculoskeletal models, but they can also
  be used as skeletal models, such that the input is generated using
  joint moments instead of muscle excitations. We have implemented a 3D
  model version (<monospace>gait3d</monospace>) and two 2D model
  versions in c, which are compiled as mex functions. The model dynamics
  can be tested using the test cases coded in the
  <monospace>tests</monospace> folder. The model parameters of the 3D
  model and two 2D model (<monospace>gait2d_osim</monospace> and
  <monospace>gait10dof18musc</monospace>) are loaded from OpenSim, but
  use our own muscle dynamics model described in
  (<xref alt="Nitschke et al., 2020" rid="ref-nitschkeU003A2020" ref-type="bibr">Nitschke
  et al., 2020</xref>), while the other 2D model
  (<monospace>gait2dc</monospace>) is used and described in our own
  previous work
  (<xref alt="Dorschky, Nitschke, et al., 2019" rid="ref-dorsckyU003A2019a" ref-type="bibr">Dorschky,
  Nitschke, et al., 2019</xref>;
  <xref alt="Dorschky, KrÃ¼ger, et al., 2019" rid="ref-dorschkyU003A2019b" ref-type="bibr">Dorschky,
  KrÃ¼ger, et al., 2019</xref>;
  <xref alt="Koelewijn &amp; Selinger, 2022" rid="ref-koelewijnU003A2022" ref-type="bibr">Koelewijn
  &amp; Selinger, 2022</xref>;
  <xref alt="Koelewijn &amp; Van den Bogert, 2016" rid="ref-koelewijnU003A2016" ref-type="bibr">Koelewijn
  &amp; Van den Bogert, 2016</xref>). The model parameters are defined
  in the .osim file for the OpenSim models, and defined in an Excel file
  for model gait2dc (gait2dc_par.xlsx). The models can be personalized
  by directly adjusting the parameters in the .osim model or Excel file,
  such that, for example, OpenSim scaling can be used
  (<xref alt="Seth et al., 2018" rid="ref-sethU003A2018" ref-type="bibr">Seth
  et al., 2018</xref>). They can also still be adjusted in MATLAB, for
  example to investigate virtual participants
  (<xref alt="Dorschky, Nitschke, et al., 2019" rid="ref-dorsckyU003A2019a" ref-type="bibr">Dorschky,
  Nitschke, et al., 2019</xref>;
  <xref alt="Koelewijn &amp; Selinger, 2022" rid="ref-koelewijnU003A2022" ref-type="bibr">Koelewijn
  &amp; Selinger, 2022</xref>). The model dynamics are explained further
  in Koelewijn &amp; Selinger
  (<xref alt="2022" rid="ref-koelewijnU003A2022" ref-type="bibr">2022</xref>);
  Dorschky, Nitschke, et al.
  (<xref alt="2019" rid="ref-dorsckyU003A2019a" ref-type="bibr">2019</xref>);
  Dorschky, KrÃ¼ger, et al.
  (<xref alt="2019" rid="ref-dorschkyU003A2019b" ref-type="bibr">2019</xref>)
  for <monospace>gait2dc</monospace> and in Nitschke et al.
  (<xref alt="2020" rid="ref-nitschkeU003A2020" ref-type="bibr">2020</xref>)
  for <monospace>gait3d</monospace>. The
  <monospace>gait2d_osim model</monospace> has been used in Gambietz et
  al.
  (<xref alt="2024" rid="ref-gambietzU003A2024" ref-type="bibr">2024</xref>).
  It is based on the <monospace>gait10dof18musc.osim</monospace> model
  (<xref alt="Seth et al., 2018" rid="ref-sethU003A2018" ref-type="bibr">Seth
  et al., 2018</xref>), and can be loaded in two ways: the original
  version, called <monospace>gait10dof18musc</monospace>, and a version
  with the lumbar joint locked, called
  <monospace>gait2d_osim</monospace>.</p>
  <p><bold>Table 1:</bold> Overview of dynamics models implemented in
  the BioMAC-Sim-Toolbox</p>
  <table-wrap>
    <table>
      <colgroup>
        <col width="22%" />
        <col width="13%" />
        <col width="15%" />
        <col width="15%" />
        <col width="15%" />
        <col width="21%" />
      </colgroup>
      <thead>
        <tr>
          <th>Model name</th>
          <th>Dimension</th>
          <th>Degrees of freedom</th>
          <th>Number of muscles</th>
          <th>Arm torque actuators</th>
          <th>Source</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>gait2dc</td>
          <td>2D</td>
          <td>9</td>
          <td>16</td>
          <td>-</td>
          <td>(<xref alt="Dorschky, Nitschke, et al., 2019" rid="ref-dorsckyU003A2019a" ref-type="bibr">Dorschky,
          Nitschke, et al., 2019</xref>;
          <xref alt="Dorschky, KrÃ¼ger, et al., 2019" rid="ref-dorschkyU003A2019b" ref-type="bibr">Dorschky,
          KrÃ¼ger, et al., 2019</xref>;
          <xref alt="Koelewijn &amp; Selinger, 2022" rid="ref-koelewijnU003A2022" ref-type="bibr">Koelewijn
          &amp; Selinger, 2022</xref>;
          <xref alt="Koelewijn &amp; Van den Bogert, 2016" rid="ref-koelewijnU003A2016" ref-type="bibr">Koelewijn
          &amp; Van den Bogert, 2016</xref>)</td>
        </tr>
        <tr>
          <td>gait2d_osim</td>
          <td>2D</td>
          <td>9</td>
          <td>18</td>
          <td>-</td>
          <td>(<xref alt="Seth et al., 2018" rid="ref-sethU003A2018" ref-type="bibr">Seth
          et al., 2018</xref>)</td>
        </tr>
        <tr>
          <td>gait10dof18musc</td>
          <td>2D</td>
          <td>10</td>
          <td>18</td>
          <td>-</td>
          <td>(<xref alt="Seth et al., 2018" rid="ref-sethU003A2018" ref-type="bibr">Seth
          et al., 2018</xref>)</td>
        </tr>
        <tr>
          <td>gait3d</td>
          <td>3D</td>
          <td>33</td>
          <td>92</td>
          <td>10</td>
          <td>(<xref alt="Nitschke et al., 2020" rid="ref-nitschkeU003A2020" ref-type="bibr">Nitschke
          et al., 2020</xref>,
          <xref alt="2023" rid="ref-nitschkeU003A2023" ref-type="bibr">2023</xref>,
          <xref alt="2024" rid="ref-nitschkeU003A2024" ref-type="bibr">2024</xref>)</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="using-the-toolbox">
  <title>Using the Toolbox</title>
  <p>To get started, we recommend that users first look at the tutorial
  in the folder <monospace>Tutorial</monospace> and the folder
  <monospace>IntroductionExamples</monospace> in
  <monospace>ExampleScripts</monospace>. The tutorial is created to help
  users become familiar with the inputs and outputs of the simulations,
  as well as create and run simulations. To perform the tutorial, users
  should start by looking at the file TutorialInTheWild.PDF. In
  addition, we have added an introductory example for 2D simulations
  (<monospace>script2D.m</monospace>) and 3D simulations
  (<monospace>script3D.m</monospace>), which is based on Nitschke et al.
  (<xref alt="2020" rid="ref-nitschkeU003A2020" ref-type="bibr">2020</xref>),
  in the folder <monospace>IntroductionExamples</monospace>. The goal of
  these introductory examples is to show how the toolbox works, and
  highlight different options in the implementation. Therefore, these
  functions, and those called inside them, have a lot of comments. We
  recommend running them line by line to follow along with the
  example.</p>
  <p>Besides the introductory examples, we have included several other
  examples in the folder <monospace>ExampleScripts</monospace>. Each
  example can be run independently through a function in respective
  folder of which the name starts with <monospace>script</monospace>.
  They should produce a relevant graph or movie at the end. These
  examples are added to highlight different ways that the code can be
  used. The code in the folder <monospace>ExoPaper</monospace> can be
  used to generate predictive simulations of walking with an
  exoskeleton, based on the paper by Koelewijn &amp; Selinger
  (<xref alt="2022" rid="ref-koelewijnU003A2022" ref-type="bibr">2022</xref>).
  The example is added to show how models can be extended by assistive
  devices, in this case an exoskeleton, and to show how predictive
  simulations can be generated with the
  <monospace>BioMAC-Sim-Toolbox</monospace>. The code in the folder
  <monospace>IMUTracking2D</monospace> can be used to generate tracking
  simulations based on inertial sensor data. This example is added to
  show how inertial sensor data can be tracked in a 2D musculoskeletal
  model, and is based on the publications by Dorschky, Nitschke, et al.
  (<xref alt="2019" rid="ref-dorsckyU003A2019a" ref-type="bibr">2019</xref>)
  and Dorschky et al.
  (<xref alt="2025" rid="ref-dorschkynitschkeU003A2025" ref-type="bibr">2025</xref>).
  The code in <monospace>MarkerTracking3D</monospace> can also be used
  to generate tracking simulations, but from marker and ground reaction
  force data. This example is added as an example of how the 3D
  musculoskeletal model has been used and is based on the publication by
  Nitschke et al.
  (<xref alt="2024" rid="ref-nitschkeU003A2024" ref-type="bibr">2024</xref>).
  The code in <monospace>Treadmill</monospace> can be used to generate
  simulations of walking on the treadmill. This example is not based on
  published work, but was added to show how a treadmill can be
  implemented in the ground contact model and how the
  <monospace>gait2d_osim</monospace> model can be used in the
  <monospace>BioMAC-Sim-Toolbox</monospace>.</p>
  <p>Currently, the toolbox can be used to solve trajectory optimization
  problems and create predictive and reconstructive simulations. We have
  implemented code to track marker positions, joint angles,
  translations, ground reaction forces, accelerations, angular
  velocities, movement duration, and movement speed. We have further
  implemented objectives to minimize muscular effort, metabolic cost,
  squared torque, joint accelerations, passive joint moments, ground
  reaction force impact, and head stability. By combining these
  different objectives, many different types of simulations can be
  generated and the movement kinematics and kinetics investigated. To
  generate new simulations, it is necessary to write scripts in MATLAB.
  We recommend to use functions, as done in the examples, to set up the
  different problems. Currently, it is not possible to use the software
  in a GUI. Due to these limitations, the learning curve is steep for
  new users. To help new users, we have added slides that were presented
  in a tutorial at the 2025 Conference of the International Society of
  Biomechanics to explain the concepts that are used in the toolbox.</p>
  <p>Several software suits exist with similar functionality, such as
  OpenSim Moco
  (<xref alt="Dembia et al., 2020" rid="ref-dembiaU003A2020" ref-type="bibr">Dembia
  et al., 2020</xref>), Bioptim
  (<xref alt="Michaud et al., 2022" rid="ref-michaudU003A2022" ref-type="bibr">Michaud
  et al., 2022</xref>), and PredSim
  (<xref alt="Dâ€™hondt et al., 2024" rid="ref-dhondtU003A2024" ref-type="bibr">Dâ€™hondt
  et al., 2024</xref>). In OpenSim Moco, more time is required to solve,
  e.g., a tracking problem required 130 minutes
  (<xref alt="Dembia et al., 2020" rid="ref-dembiaU003A2020" ref-type="bibr">Dembia
  et al., 2020</xref>), where a similar problem takes 8 minutes with the
  <monospace>BioMAC-Sim-Toolbox</monospace>
  (<xref alt="Koelewijn &amp; Van den Bogert, 2016" rid="ref-koelewijnU003A2016" ref-type="bibr">Koelewijn
  &amp; Van den Bogert, 2016</xref>). Furthermore, Bioptim and PredSim
  do not include functionality to track experimental measurement data
  and therefore are limited to predictive simulations, while the
  <monospace>BioMAC-Sim-Toolbox</monospace> can be used for both
  tracking and predictive simulations. A disadvantage of the
  <monospace>BioMAC-Sim-Toolbox</monospace> is that we have, so far,
  only implemented one-step discretization schemes, which are not as
  accurate as higher-order schemes, which are implemented in the other
  toolboxes. We are currently working on an implementation of higher
  order collocation schemes as well, and plan to add methods up to the
  fifth order, which are two-step and three-step. Another disadvantage
  is that we have currently only implemented IPOPT as a solver. In the
  future, we aim to add other open-source solvers, such as, for example
  WORHP
  (<xref alt="BÃ¼skens &amp; Wassel, 2013" rid="ref-bueskensU003A2013" ref-type="bibr">BÃ¼skens
  &amp; Wassel, 2013</xref>).</p>
</sec>
<sec id="future-work">
  <title>Future Work</title>
  <p>In future, the toolbox could be expanded. We invite users to
  suggest new features by creating issues and also to help implement
  them through pull requests. We encourage users to add models,
  objective and constraint functions to the toolbox to expand the range
  of optimal control problems that can be solved. Furthermore, new
  problem classes can be defined, for example for inverse kinematics and
  inverse dynamics, or to solve muscle activations and excitations
  statically or dynamically. It would also be possible to implement a
  single-shooting approach, which would allow for models with
  discontinuous dynamics or control to be investigated, such as a reflex
  model
  (<xref alt="Geyer &amp; Herr, 2010" rid="ref-GeyerU003A2010" ref-type="bibr">Geyer
  &amp; Herr, 2010</xref>). Through these expansions, the
  <monospace>BioMAC-Sim-Toolbox</monospace> would also allow users to
  implement and compare different movement simulation and analysis
  approaches and ensure that the outcomes are as good as possible for
  their research questions.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We acknowledge contributions from Marko Ackermann, Dieter Heinrich,
  Maria Eleni Athanasiadou, Chuyi Wang, Christopher LÃ¶ffelmann, Linus
  HÃ¶tzel, Utkarsha Shukla, Arne Kuederle, Tobias Luckfiel, Heiko
  Schlarb. The development of the BioMAC-Sim-Toolbox was supported by
  adidas AG and by the Deutsche Forschungsgemeinschaft (DFG, German
  Research Foundation) through Project-ID442419336, SFB 1483 - EmpkinS
  and through Project-ID520189992</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-bettsU003A2010">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Betts</surname><given-names>JT</given-names></name>
      </person-group>
      <source>Practical methods for optimal control and estimation using nonlinear programming</source>
      <publisher-name>SIAM</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>19</volume>
      <pub-id pub-id-type="doi">10.1137/1.9780898718577</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-zarrughU003A1974">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zarrugh</surname><given-names>MY</given-names></name>
        <name><surname>Todd</surname><given-names>FN</given-names></name>
        <name><surname>Ralston</surname><given-names>HJ</given-names></name>
      </person-group>
      <article-title>Optimization of energy expenditure during level walking</article-title>
      <source>European Journal of Applied Physiology and Occupational Physiology</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="1974">1974</year>
      <volume>33</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1007/BF00430237</pub-id>
      <fpage>293</fpage>
      <lpage>306</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gambietzU003A2024">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Gambietz</surname><given-names>Markus</given-names></name>
        <name><surname>DrÃ¶ge</surname><given-names>Anne</given-names></name>
        <name><surname>SchÃ¼ÃŸler</surname><given-names>Christian</given-names></name>
        <name><surname>Stahlke</surname><given-names>Maximilian</given-names></name>
        <name><surname>Wirth</surname><given-names>Vanessa</given-names></name>
        <name><surname>Miehling</surname><given-names>JÃ¶rg</given-names></name>
        <name><surname>Vossiek</surname><given-names>Martin</given-names></name>
        <name><surname>Koelewijn</surname><given-names>Anne D</given-names></name>
      </person-group>
      <article-title>Unobtrusive gait reconstructions using radar-based optimal control simulations</article-title>
      <source>2024 58th asilomar conference on signals, systems, and computers</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <pub-id pub-id-type="doi">10.1109/ieeeconf60004.2024.10942908</pub-id>
      <fpage>1505</fpage>
      <lpage>1509</lpage>
    </element-citation>
  </ref>
  <ref id="ref-sethU003A2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Seth</surname><given-names>Ajay</given-names></name>
        <name><surname>Hicks</surname><given-names>Jennifer L</given-names></name>
        <name><surname>Uchida</surname><given-names>Thomas K</given-names></name>
        <name><surname>Habib</surname><given-names>Ayman</given-names></name>
        <name><surname>Dembia</surname><given-names>Christopher L</given-names></name>
        <name><surname>Dunne</surname><given-names>James J</given-names></name>
        <name><surname>Ong</surname><given-names>Carmichael F</given-names></name>
        <name><surname>DeMers</surname><given-names>Matthew S</given-names></name>
        <name><surname>Rajagopal</surname><given-names>Apoorva</given-names></name>
        <name><surname>Millard</surname><given-names>Matthew</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>OpenSim: Simulating musculoskeletal dynamics and neuromuscular control to study human and animal movement</article-title>
      <source>PLoS computational biology</source>
      <publisher-name>Public Library of Science San Francisco, CA USA</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>14</volume>
      <issue>7</issue>
      <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006223</pub-id>
      <fpage>e1006223</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-bueskensU003A2013">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>BÃ¼skens</surname><given-names>Christof</given-names></name>
        <name><surname>Wassel</surname><given-names>Dennis</given-names></name>
      </person-group>
      <article-title>The ESA NLP solver WORHP</article-title>
      <source>Modeling and optimization in space engineering</source>
      <person-group person-group-type="editor">
        <name><surname>Fasano</surname><given-names>Giorgio</given-names></name>
        <name><surname>PintÃ©r</surname><given-names>JÃ¡nos D.</given-names></name>
      </person-group>
      <publisher-name>Springer New York</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>73</volume>
      <pub-id pub-id-type="doi">10.1007/978-1-4614-4469-5_4</pub-id>
      <fpage>85</fpage>
      <lpage>110</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ackermannU003A2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ackermann</surname><given-names>Marko</given-names></name>
        <name><surname>Van den Bogert</surname><given-names>Antonie J</given-names></name>
      </person-group>
      <article-title>Optimality principles for model-based prediction of human gait</article-title>
      <source>Journal of biomechanics</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>43</volume>
      <issue>6</issue>
      <pub-id pub-id-type="doi">10.1016/j.jbiomech.2009.12.012</pub-id>
      <fpage>1055</fpage>
      <lpage>1060</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dhondtU003A2024">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Dâ€™hondt</surname><given-names>Lars</given-names></name>
        <name><surname>Falisse</surname><given-names>Antoine</given-names></name>
        <name><surname>Gupta</surname><given-names>Dhruv</given-names></name>
        <name><surname>Van Den Bosch</surname><given-names>Bram</given-names></name>
        <name><surname>Buurke</surname><given-names>Tom JW</given-names></name>
        <name><surname>Febrer-NafrÄ±Ìa</surname><given-names>MÄ±Ìriam</given-names></name>
        <name><surname>Vandekerckhove</surname><given-names>Ines</given-names></name>
        <name><surname>Afschrift</surname><given-names>Maarten</given-names></name>
        <name><surname>De Groote</surname><given-names>Friedl</given-names></name>
      </person-group>
      <article-title>PredSim: A framework for rapid predictive simulations of locomotion</article-title>
      <source>2024 10th IEEE RAS/EMBS international conference for biomedical robotics and biomechatronics (BioRob)</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <pub-id pub-id-type="doi">10.1109/biorob60516.2024.10719735</pub-id>
      <fpage>1208</fpage>
      <lpage>1213</lpage>
    </element-citation>
  </ref>
  <ref id="ref-michaudU003A2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Michaud</surname><given-names>Benjamin</given-names></name>
        <name><surname>Bailly</surname><given-names>FranÃ§ois</given-names></name>
        <name><surname>Charbonneau</surname><given-names>Eve</given-names></name>
        <name><surname>Ceglia</surname><given-names>Amedeo</given-names></name>
        <name><surname>Sanchez</surname><given-names>LÃ©a</given-names></name>
        <name><surname>Begon</surname><given-names>Mickael</given-names></name>
      </person-group>
      <article-title>Bioptim, a python framework for musculoskeletal optimal control in biomechanics</article-title>
      <source>IEEE Transactions on Systems, Man, and Cybernetics: Systems</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>53</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1109/tsmc.2022.3183831</pub-id>
      <fpage>321</fpage>
      <lpage>332</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dembiaU003A2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dembia</surname><given-names>Christopher L</given-names></name>
        <name><surname>Bianco</surname><given-names>Nicholas A</given-names></name>
        <name><surname>Falisse</surname><given-names>Antoine</given-names></name>
        <name><surname>Hicks</surname><given-names>Jennifer L</given-names></name>
        <name><surname>Delp</surname><given-names>Scott L</given-names></name>
      </person-group>
      <article-title>Opensim moco: Musculoskeletal optimal control</article-title>
      <source>PLOS Computational Biology</source>
      <publisher-name>Public Library of Science San Francisco, CA USA</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>16</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008493</pub-id>
      <fpage>e1008493</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-nitschkeU003A2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nitschke</surname><given-names>Marlies</given-names></name>
        <name><surname>Marzilger</surname><given-names>Robert</given-names></name>
        <name><surname>Leyendecker</surname><given-names>Sigrid</given-names></name>
        <name><surname>Eskofier</surname><given-names>Bjoern M</given-names></name>
        <name><surname>Koelewijn</surname><given-names>Anne D</given-names></name>
      </person-group>
      <article-title>Change the direction: 3D optimal control simulation by directly tracking marker and ground reaction force data</article-title>
      <source>PeerJ</source>
      <publisher-name>PeerJ Inc.</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>11</volume>
      <pub-id pub-id-type="doi">10.7717/peerj.14852</pub-id>
      <fpage>e14852</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-koelewijnU003A2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Koelewijn</surname><given-names>Anne D</given-names></name>
        <name><surname>Dorschky</surname><given-names>Eva</given-names></name>
        <name><surname>Van den Bogert</surname><given-names>Antonie J</given-names></name>
      </person-group>
      <article-title>A metabolic energy expenditure model with a continuous first derivative and its application to predictive simulations of gait</article-title>
      <source>Computer methods in biomechanics and biomedical engineering</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>21</volume>
      <issue>8</issue>
      <pub-id pub-id-type="doi">10.1080/10255842.2018.1490954</pub-id>
      <fpage>521</fpage>
      <lpage>531</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nitschkeU003A2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nitschke</surname><given-names>Marlies</given-names></name>
        <name><surname>Dorschky</surname><given-names>Eva</given-names></name>
        <name><surname>Heinrich</surname><given-names>Dieter</given-names></name>
        <name><surname>Schlarb</surname><given-names>Heiko</given-names></name>
        <name><surname>Eskofier</surname><given-names>Bjoern M</given-names></name>
        <name><surname>Koelewijn</surname><given-names>Anne D</given-names></name>
        <name><surname>Bogert</surname><given-names>Antonie J van den</given-names></name>
      </person-group>
      <article-title>Efficient trajectory optimization for curved running using a 3D musculoskeletal model with implicit dynamics</article-title>
      <source>Scientific reports</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>10</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/s41598-020-73856-w</pub-id>
      <fpage>17655</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-nitschkeU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nitschke</surname><given-names>Marlies</given-names></name>
        <name><surname>Dorschky</surname><given-names>Eva</given-names></name>
        <name><surname>Leyendecker</surname><given-names>Sigrid</given-names></name>
        <name><surname>Eskofier</surname><given-names>Bjoern M</given-names></name>
        <name><surname>Koelewijn</surname><given-names>Anne D</given-names></name>
      </person-group>
      <article-title>Estimating 3D kinematics and kinetics from virtual inertial sensor data through musculoskeletal movement simulations</article-title>
      <source>Frontiers in Bioengineering and Biotechnology</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>12</volume>
      <pub-id pub-id-type="doi">10.3389/fbioe.2024.1285845</pub-id>
      <fpage>1285845</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-dorsckyU003A2019a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dorschky</surname><given-names>Eva</given-names></name>
        <name><surname>Nitschke</surname><given-names>Marlies</given-names></name>
        <name><surname>Seifer</surname><given-names>Ann-Kristin</given-names></name>
        <name><surname>Van den Bogert</surname><given-names>Antonie J.</given-names></name>
        <name><surname>Eskofier</surname><given-names>Bjoern M.</given-names></name>
      </person-group>
      <article-title>Estimation of gait kinematics and kinetics from inertial sensor data using optimal control of musculoskeletal models</article-title>
      <source>Journal of biomechanics</source>
      <year iso-8601-date="2019">2019</year>
      <volume>95</volume>
      <pub-id pub-id-type="doi">10.1016/j.jbiomech.2019.07.022</pub-id>
      <fpage>109278</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-koelewijnU003A2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Koelewijn</surname><given-names>Anne D</given-names></name>
        <name><surname>Selinger</surname><given-names>Jessica C</given-names></name>
      </person-group>
      <article-title>Predictive simulations to replicate human gait adaptations and energetics with exoskeletons</article-title>
      <source>IEEE Trans Neur Sys Rehab Eng</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>30</volume>
      <pub-id pub-id-type="doi">10.1109/TNSRE.2022.3189038</pub-id>
      <fpage>1931</fpage>
      <lpage>1940</lpage>
    </element-citation>
  </ref>
  <ref id="ref-GeyerU003A2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Geyer</surname><given-names>Hartmut</given-names></name>
        <name><surname>Herr</surname><given-names>Hugh</given-names></name>
      </person-group>
      <article-title>A muscle-reflex model that encodes principles of legged mechanics produces human walking dynamics and muscle activities</article-title>
      <source>IEEE Transactions on neural systems and rehabilitation engineering</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>18</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1109/tnsre.2010.2047592</pub-id>
      <fpage>263</fpage>
      <lpage>273</lpage>
    </element-citation>
  </ref>
  <ref id="ref-WachterU003A2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>WÃ¤chter</surname><given-names>A</given-names></name>
        <name><surname>Biegler</surname><given-names>LT</given-names></name>
      </person-group>
      <article-title>On the implementation of an interior-point filter line-search algorithm for large-scale nonlinear programming</article-title>
      <source>Mathematical Programming</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2006">2006</year>
      <volume>106</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1007/s10107-004-0559-y</pub-id>
      <fpage>25</fpage>
      <lpage>57</lpage>
    </element-citation>
  </ref>
  <ref id="ref-koelewijnU003A2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Koelewijn</surname><given-names>Anne D</given-names></name>
        <name><surname>Van den Bogert</surname><given-names>Antonie J</given-names></name>
      </person-group>
      <article-title>Joint contact forces can be reduced by improving joint moment symmetry in below-knee amputee gait simulations</article-title>
      <source>Gait &amp; Posture</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>49</volume>
      <pub-id pub-id-type="doi">10.1016/j.gaitpost.2016.07.007</pub-id>
      <fpage>219</fpage>
      <lpage>225</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dorschkynitschkeU003A2025">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dorschky</surname><given-names>Eva</given-names></name>
        <name><surname>Nitschke</surname><given-names>Marlies</given-names></name>
        <name><surname>Mayer</surname><given-names>Matthias</given-names></name>
        <name><surname>Weygers</surname><given-names>Ive</given-names></name>
        <name><surname>Gassner</surname><given-names>Heiko</given-names></name>
        <name><surname>Seel</surname><given-names>Thomas</given-names></name>
        <name><surname>Eskofier</surname><given-names>Bjoern M</given-names></name>
        <name><surname>Koelewijn</surname><given-names>Anne D</given-names></name>
      </person-group>
      <article-title>Comparing sparse inertial sensor setups for sagittal-plane walking and running reconstructions</article-title>
      <source>Frontiers in Bioengineering and Biotechnology</source>
      <publisher-name>Frontiers Media SA</publisher-name>
      <year iso-8601-date="2025">2025</year>
      <volume>13</volume>
      <pub-id pub-id-type="doi">10.3389/fbioe.2025.1507162</pub-id>
      <fpage>1507162</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-dorschkyU003A2019b">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dorschky</surname><given-names>Eva</given-names></name>
        <name><surname>KrÃ¼ger</surname><given-names>Daniel</given-names></name>
        <name><surname>Kurfess</surname><given-names>Nicolai</given-names></name>
        <name><surname>Schlarb</surname><given-names>Heiko</given-names></name>
        <name><surname>Wartzack</surname><given-names>Sandro</given-names></name>
        <name><surname>Eskofier</surname><given-names>Bjoern M</given-names></name>
        <name><surname>Bogert</surname><given-names>Antonie J van den</given-names></name>
      </person-group>
      <article-title>Optimal control simulation predicts effects of midsole materials on energy cost of running</article-title>
      <source>Com Meth Biomech Biomed Eng</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>22</volume>
      <issue>8</issue>
      <pub-id pub-id-type="doi">10.1080/10255842.2019.1601179</pub-id>
      <fpage>869</fpage>
      <lpage>879</lpage>
    </element-citation>
  </ref>
  <ref id="ref-falisseU003A2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Falisse</surname><given-names>Antoine</given-names></name>
        <name><surname>SerrancolÄ±Ì</surname><given-names>Gil</given-names></name>
        <name><surname>Dembia</surname><given-names>Christopher L</given-names></name>
        <name><surname>Gillis</surname><given-names>Joris</given-names></name>
        <name><surname>Jonkers</surname><given-names>Ilse</given-names></name>
        <name><surname>De Groote</surname><given-names>Friedl</given-names></name>
      </person-group>
      <article-title>Rapid predictive simulations with complex musculoskeletal models suggest that diverse healthy and pathological human gaits can emerge from similar control strategies</article-title>
      <source>Journal of The Royal Society Interface</source>
      <publisher-name>The Royal Society</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>16</volume>
      <issue>157</issue>
      <pub-id pub-id-type="doi">10.1098/rsif.2019.0402</pub-id>
      <fpage>20190402</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
