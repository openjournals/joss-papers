<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7481</article-id>
<article-id pub-id-type="doi">10.21105/joss.07481</article-id>
<title-group>
<article-title>constrained_manipulability: A ROS 2 library to Compute
and Visualize Constrained Capacities for Robotic
Manipulators</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7672-940X</contrib-id>
<name>
<surname>Zolotas</surname>
<given-names>Mark</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0784-8720</contrib-id>
<name>
<surname>Long</surname>
<given-names>Philip</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0008-5414</contrib-id>
<name>
<surname>Sagar</surname>
<given-names>Keerthi</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5123-5801</contrib-id>
<name>
<surname>Padir</surname>
<given-names>Taskin</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Northeastern University, USA (at the time of this
work)</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Atlantic Technological University, Ireland</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Irish Manufacturing Research Limited, Mullingar,
Ireland</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Amazon Robotics, USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-01-20">
<day>20</day>
<month>1</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>108</issue>
<fpage>7481</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>ros</kwd>
<kwd>robotics</kwd>
<kwd>kinematics</kwd>
<kwd>manipulability polytopes</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>This paper presents
  <monospace>constrained_manipulability</monospace>, a C++ library to
  compute and visualize a robot manipulator’s constrained motion
  capacities. Manipulability polytopes provide a geometrical tool to
  evaluate the volume of free space surrounding the robotic arm when
  considering both environmental and intrinsic robot constraints, such
  as collisions and joint limits, respectively. Moreover, the polytopes
  defined by these convex constraints represent feasible configurations
  for the whole robot, that can be utilized in inverse kinematics (IK)
  optimization algorithms to produce collision-free motion
  trajectories.</p>
  <p>The library is encapsulated in a Robot Operating System (ROS)
  package
  (<xref alt="Quigley et al., 2009" rid="ref-Quigley2009ROS" ref-type="bibr">Quigley
  et al., 2009</xref>). We include ROS 1 and ROS 2
  (<xref alt="Macenski et al., 2022" rid="ref-Macenski2022ROS2" ref-type="bibr">Macenski
  et al., 2022</xref>) implementations of the core C++ library. The
  <monospace>constrained_manipulability</monospace> package also heavily
  depends on our <monospace>robot_collision_checking</monospace> package
  (<xref alt="Zolotas et al., 2025" rid="ref-Zolotas2025ROSFCL" ref-type="bibr">Zolotas
  et al., 2025</xref>), a ROS interface for collision checking via the
  Flexible Collision Library (FCL)
  (<xref alt="Pan et al., 2012" rid="ref-Pan2012FCL" ref-type="bibr">Pan
  et al., 2012</xref>).</p>
  <p>The main program of the
  <monospace>constrained_manipulability</monospace> package reads a
  Unified Robot Description Format (URDF) kinematic chain from a
  user-defined root of the robot (e.g., the robot’s base frame) to a tip
  (e.g., the end-effector or tool). Joint position and velocity limits
  are also read from the URDF, while a collision world is maintained to
  express environmental constraints on the robot’s motion. A variety of
  collision objects can be added or removed using common ROS message
  types, such as OctoMaps
  (<xref alt="Hornung et al., 2013" rid="ref-Hornung2013Octomap" ref-type="bibr">Hornung
  et al., 2013</xref>), mesh files, or solid primitives. These joint
  limit and obstacle constraints are then stacked together to define
  different polytopes, such as the allowable motion polytope
  (<xref alt="Long et al., 2019" rid="ref-Long2019Optimization" ref-type="bibr">Long
  et al., 2019</xref>) and the constrained velocity polytope
  (<xref alt="Long &amp; Padır, 2018" rid="ref-Long2018Humanoids" ref-type="bibr">Long
  &amp; Padır, 2018</xref>).</p>
  <p>Polytopes computed by
  <monospace>constrained_manipulability</monospace> are published using
  ROS messages from the <monospace>visualization_msgs::msg</monospace>
  namespace. The primary type is <monospace>MarkerArray</monospace>,
  which utilizes <monospace>Marker::TRIANGLE_LIST</monospace> markers
  for facets and <monospace>Marker::SPHERE_LIST</monospace> markers for
  vertices. As a result, the manipulability polytopes calculated by our
  package for a given robot manipulator can also be visualized using
  standard RViz
  (<xref alt="Kam et al., 2015" rid="ref-kam2015rviz" ref-type="bibr">Kam
  et al., 2015</xref>) tools. Additionally, the generated polytopes are
  published in vertex and hyperplane form, which is easily interpretable
  by third-party libraries.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Generating complex constraint geometries efficiently is a
  significant challenge for real-time robot manipulation. For
  applications, like motion planning or remote teleoperation, being able
  to represent the space of obstacle-free allowable motion around an
  end-effector is vital. Given such a representation a collision-free IK
  solution can be obtained to maximize the free space of a robot moving
  in a constrained environment. Manipulability polytopes represent
  manipulability capacities, e.g., the capacity for the robot to
  transmit velocities and forces from the configuration space to the
  task space. The benefit of using convex polytopes is that they capture
  exact velocity bounds, rather than the approximation provided by for
  example ellipsoids
  (<xref alt="Yoshikawa, 1984" rid="ref-Yoshikawa1984Analysis" ref-type="bibr">Yoshikawa,
  1984</xref>). While the aforementionned ellipsoids have been the
  dominant paradigm due to historic computational constraints, more
  efficient polytope generation methods
  (<xref alt="Sagar et al., 2023" rid="ref-Sagar2023" ref-type="bibr">Sagar
  et al., 2023</xref>;
  <xref alt="Skuric et al., 2023" rid="ref-Skuric2023" ref-type="bibr">Skuric
  et al., 2023</xref>) coupled with more computation availability has
  led to an increased usage. Furthermore, since a polytope is defined by
  a set of inequality constraints, additional constraints can be easily
  incorporated into existing polytopes, e.g., mobile robot toppling
  constraints
  (<xref alt="Rasheed et al., 2018" rid="ref-rasheed2018tension" ref-type="bibr">Rasheed
  et al., 2018</xref>), friction cones
  (<xref alt="Caron et al., 2016" rid="ref-caron2016zmp" ref-type="bibr">Caron
  et al., 2016</xref>), and maximum danger values.</p>
  <p>The <monospace>constrained_manipulability</monospace> ROS 2 package
  aims to fulfil this need for constrained robot capacity calculation by
  supplying the robotics community with a fast C++ implementation that
  computes various types of polytopes. These geometrical constructs can
  also be visualized for workspace analysis or to guide an operator
  through the Cartesian motions available due to joint limits, kinematic
  constraints, and obstacles in the workspace, as illustrated in
  <xref alt="[fig:traj_planning]" rid="figU003Atraj_planning">[fig:traj_planning]</xref>.
  The utility of these visualizations has proven advantageous in remote
  teleoperation scenarios involving virtual reality headsets
  (<xref alt="Zolotas et al., 2021" rid="ref-Zolotas2021Motion" ref-type="bibr">Zolotas
  et al., 2021</xref>). Moreover, the package interfaces with the
  <monospace>robot_collision_checking</monospace> package
  (<xref alt="Zolotas et al., 2025" rid="ref-Zolotas2025ROSFCL" ref-type="bibr">Zolotas
  et al., 2025</xref>) to perform distance and collision checking
  between a robot manipulator and the environment.</p>
  <p>There are currently few software libraries capable of computing
  robot manipulator capacities as polytopes while seamlessly interfacing
  with popular robotics middleware, such as ROS. Among them, the one
  most similar to <monospace>constrained_manipulability</monospace> is
  <monospace>pycapacity</monospace>
  (<xref alt="Skuric et al., 2023" rid="ref-Skuric2023" ref-type="bibr">Skuric
  et al., 2023</xref>), which is implemented in Python rather than C++.
  Unlike <monospace>pycapacity</monospace>, where velocity and force
  polytopes are solely computed based on the intrinsic constraints of a
  kinematic chain, our package accounts for additional constraints, such
  as positional joint limits and environmental obstacles, to represent
  the constrained motion space.</p>
  <fig>
    <caption><p>Collision-free path for a robot manipulator visualized
    as a trajectory of polytopes generated by maximizing the volume of
    allowable motion around the robot’s
    end-effector.<styled-content id="figU003Atraj_planning"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="trajplanning.png" />
  </fig>
  <sec id="polytope-and-manipulator-model">
    <title>Polytope and Manipulator Model</title>
    <p>A polytope, <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{P}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝒫</mml:mi></mml:math></alternatives></inline-formula>,
    can be represented as the convex hull of its vertex set, or as a
    volume bounded by a finite number of half-spaces, known as the
    <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{V}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝒱</mml:mi></mml:math></alternatives></inline-formula>-representation
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{H}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ℋ</mml:mi></mml:math></alternatives></inline-formula>-representation,
    which are denoted as <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{P}^{V}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>𝒫</mml:mi><mml:mi>V</mml:mi></mml:msup></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{P}^{H}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>𝒫</mml:mi><mml:mi>H</mml:mi></mml:msup></mml:math></alternatives></inline-formula>,
    respectively. Converting between the <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{V}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝒱</mml:mi></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{H}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ℋ</mml:mi></mml:math></alternatives></inline-formula>
    representations can be carried out in several ways, however the
    <monospace>constrained_manipulability</monospace> package uses the
    double description method
    (<xref alt="Fukuda &amp; Prodon, 1996" rid="ref-Fukuda1996Double" ref-type="bibr">Fukuda
    &amp; Prodon, 1996</xref>).</p>
    <p>The <monospace>constrained_manipulability</monospace> provides
    two types of polytope representations: 1. constrained motion
    polytopes, which modify the classic manipulability velocity polytope
    (<xref alt="Kokkinis &amp; Paden, 1989" rid="ref-kokkinis1989kinetostatic" ref-type="bibr">Kokkinis
    &amp; Paden, 1989</xref>) to include joint limits and capacity
    reductions due to nearby obstacles; and 2. allowable motion
    polytopes, which are a linearization of their constrained
    counterpart used to generate a measure of free space or allowable
    motion in which a robot can move while satisfying all
    constraints.</p>
    <p>In both cases, the polytope is constructed as follows. First, a
    system of linear inequalities is constructed in joint space, for
    instance based on joint velocity limits:
    <named-content id="eqU003Aqh_repr" content-type="equation"><disp-formula><alternatives>
    <tex-math><![CDATA[
    \begin{split} 
    \mathcal{Q}^{H}=
    \left[\begin{array}{ccc} 
    \mathbb{I}_{n}\\ -\mathbb{I}_{n}\\
    \end{array} \right]   \dot{\mathbf{q}} \leq 
    \left[\begin{array}{ccc} 
    \dot{\mathbf{q}}^{max}\\ -\dot{\mathbf{q}}^{min}\\
    \end{array} \right], 
    \end{split}]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msup><mml:mi>𝒬</mml:mi><mml:mi>H</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>𝕀</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mi>−</mml:mi><mml:msub><mml:mi>𝕀</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mo>≤</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mi>−</mml:mi><mml:msup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></named-content>
    where <inline-formula><alternatives>
    <tex-math><![CDATA[\dot{\mathbf{q}}^{max}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\dot{\mathbf{q}}^{min}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    are the robot’s maximum and minimum joint velocities. Using the
    double description method, an equivalent polytope in the
    <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{V}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝒱</mml:mi></mml:math></alternatives></inline-formula>-representation
    (i.e., defined by its vertices) is written as:
    <named-content id="eqU003Aqv_repr" content-type="equation"><disp-formula><alternatives>
    <tex-math><![CDATA[
    \mathcal{Q}^{V}=
    \{ \begin{array}{cccc} 
    \dot{\mathbf{q}}^{v}_{1}, \ \dot{\mathbf{q}}^{v}_{2}, \ \ldots, \ \dot{\mathbf{q}}^{v}_{q} 
    \end{array}  \},]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>𝒬</mml:mi><mml:mi>V</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msubsup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mi>v</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:msubsup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mn>2</mml:mn><mml:mi>v</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:msubsup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mi>q</mml:mi><mml:mi>v</mml:mi></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
    where <inline-formula><alternatives>
    <tex-math><![CDATA[\dot{\mathbf{q}}^{v}_{i}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>v</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
    denotes the <inline-formula><alternatives>
    <tex-math><![CDATA[i^{th}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>i</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    vertex of the polytope <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{Q}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝒬</mml:mi></mml:math></alternatives></inline-formula>,
    given <inline-formula><alternatives>
    <tex-math><![CDATA[q]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>
    vertices in <inline-formula><alternatives>
    <tex-math><![CDATA[n]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>-dimensional
    space. A Cartesian polytope, denoted as
    <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{MP}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ℳ</mml:mi><mml:mi>𝒫</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
    can then be obtained by transforming the vertices of
    <xref alt="Equation 2" rid="eqU003Aqv_repr">Equation 2</xref> to
    Cartesian space using the forward kinematics.
    <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{MP}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ℳ</mml:mi><mml:mi>𝒫</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>’s
    vertex set representation of <inline-formula><alternatives>
    <tex-math><![CDATA[p]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>p</mml:mi></mml:math></alternatives></inline-formula>
    vertices in 3-dimensional space is given as:
    <named-content id="eqU003Ampv_task_repr" content-type="equation"><disp-formula><alternatives>
    <tex-math><![CDATA[
    \mathcal{MP}^{V}=
    \{ \begin{array}{ccc} 
    \boldsymbol{\nu}^{v}_{1}, \ \ldots, \ \boldsymbol{\nu}^{v}_{p} \\
    \end{array} \}
    =
    \{ \begin{array}{ccc} 
    \mathbf{J}_{n} \dot{\mathbf{q}}^{v}_{1}, \ \ldots, \ \mathbf{J}_{n}\dot{\mathbf{q}}^{v}_{p}
    \end{array} \},]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mrow><mml:mi>ℳ</mml:mi><mml:mi>𝒫</mml:mi></mml:mrow><mml:mi>V</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msubsup><mml:mi>𝛎</mml:mi><mml:mn>1</mml:mn><mml:mi>v</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:msubsup><mml:mi>𝛎</mml:mi><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>𝐉</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msubsup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mi>v</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:msub><mml:mi>𝐉</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msubsup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mi>p</mml:mi><mml:mi>v</mml:mi></mml:msubsup></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
    with <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{\nu}^{v}_{j} = \mathbf{J}_{n} \dot{\mathbf{q}}^{v}_{j}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>𝛎</mml:mi><mml:mi>j</mml:mi><mml:mi>v</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>𝐉</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msubsup><mml:mover><mml:mi>𝐪</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mi>v</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[p \leq q]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>p</mml:mi><mml:mo>≤</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
    The convexity of a polytope is preserved under affine
    transformation, thus a bounded volume of
    <inline-formula><alternatives>
    <tex-math><![CDATA[\mathcal{MP}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ℳ</mml:mi><mml:mi>𝒫</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    that represents the system’s manipulability can easily be obtained
    to serve as an exact indicator of robot performance.</p>
    <p>For constrained motion polytopes, the following constraints are
    supported: joint velocity limits, joint velocity damping due to
    positional joint limits, and joint velocity damping due to obstacle
    proximity to the kinematic chain. For allowable motion polytopes the
    following constraints are supported: positional joint limits,
    positional limits due to obstacle proximity to the kinematic chain,
    and linearization limits. Increasing the values of the linearization
    expands the free space virtual fixture at a cost of reduced
    fidelity. Our implementation uses a scalar linearization limit for
    all joints that can also be altered at run time, e.g., could be
    increased to enlarge the solution or shrunk to guide the user
    towards a defined goal configuration, as defined in Eq. 20 of
    Zolotas et al.
    (<xref alt="2021" rid="ref-Zolotas2021Motion" ref-type="bibr">2021</xref>).
    Finally, in our implementation, we select at every instant the point
    along each link nearest to all environmental obstacles. Hence, the
    system considers the set of instantaneous collision-free joint
    motion for each link along the robot’s kinematic chain, considering
    all surrounding obstacles.</p>
    <p>A more detailed formulation of the polytopes discussed here is
    available in Section II.B of Long et al.
    (<xref alt="2019" rid="ref-Long2019Optimization" ref-type="bibr">2019</xref>).</p>
  </sec>
  <sec id="block-diagram">
    <title>Block Diagram</title>
    <p>Any joint position and velocity limits are extracted from the
    robot’s URDF description via ROS 2 parameter operations. Polytopes
    are calculated as described above using these limits and by
    obtaining the minimum distance from each link on the robot to
    objects in the collision world. FCL
    (<xref alt="Pan et al., 2012" rid="ref-Pan2012FCL" ref-type="bibr">Pan
    et al., 2012</xref>) is required to compute these distances and is
    accessible via the interface package:
    <monospace>robot_collision_checking</monospace>
    (<xref alt="Zolotas et al., 2025" rid="ref-Zolotas2025ROSFCL" ref-type="bibr">Zolotas
    et al., 2025</xref>). Polytopes in Cartesian space can then be
    returned from getter functions:</p>
    <preformat>Polytope getConstrainedAllowableMotionPolytope(
  const sensor_msgs::msg::JointState&amp; joint_state,
  bool show_polytope,
  Eigen::MatrixXd&amp; AHrep,
  Eigen::VectorXd&amp; bHrep,
  Eigen::Vector3d&amp; offset_position,
  const std::vector&lt;double&gt;&amp; color_pts,
  const std::vector&lt;double&gt;&amp; color_line);</preformat>
    <p>where <monospace>AHrep</monospace> and
    <monospace>bHrep</monospace> represent joint space polytope
    constraints.</p>
    <p>A diagram summarizing the
    <monospace>constrained_manipulability</monospace> package
    architecture and ROS 2 communication flow is displayed in
    <xref alt="[fig:block_diagram]" rid="figU003Ablock_diagram">[fig:block_diagram]</xref>.</p>
    <fig>
      <caption><p>Block diagram for the constrained_manipulability ROS 2
      package.<styled-content id="figU003Ablock_diagram"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="jpeg" xlink:href="cm_block_diagram.jpg" />
    </fig>
  </sec>
</sec>
<sec id="future-work">
  <title>Future Work</title>
  <p>The <monospace>constrained_manipulability</monospace> package will
  continue to be maintained as a ROS 2 library for computing and
  vizualizing a robot manipulator’s constrained capacities as polytopes.
  To extend the widespread utility of this package, future work could
  also involve creating a standalone library that is independent of ROS.
  For example, by creating Python bindings for the core C++ library and
  its underlying algorithms. This would enable easier interfacing with
  other popular robotics software, such as Pinocchio
  (<xref alt="Carpentier et al., 2021" rid="ref-Carpentier2021Proximal" ref-type="bibr">Carpentier
  et al., 2021</xref>).</p>
</sec>
<sec id="conflict-of-interest">
  <title>Conflict of Interest</title>
  <p>The authors declare that the research was conducted in the absence
  of any commercial or financial relationships that could be constructed
  as a potential conflict of interest.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>Mark Zolotas is currently at Toyota Research Institute (TRI),
  Cambridge, MA, USA. This paper describes work performed at
  Northeastern University and is not associated with TRI.</p>
  <p>Taskin Padir holds concurrent appointments as a Professor of
  Electrical and Computer Engineering at Northeastern University and as
  an Amazon Scholar. This paper describes work performed at Northeastern
  University and is not associated with Amazon.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-Quigley2009ROS">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Quigley</surname><given-names>Morgan</given-names></name>
        <name><surname>Conley</surname><given-names>Ken</given-names></name>
        <name><surname>Gerkey</surname><given-names>Brian</given-names></name>
        <name><surname>Faust</surname><given-names>Josh</given-names></name>
        <name><surname>Foote</surname><given-names>Tully</given-names></name>
        <name><surname>Leibs</surname><given-names>Jeremy</given-names></name>
        <name><surname>Wheeler</surname><given-names>Rob</given-names></name>
        <name><surname>Ng</surname><given-names>Andrew</given-names></name>
      </person-group>
      <article-title>ROS: An open-source robot operating system</article-title>
      <source>ICRA Workshop on Open Source Software</source>
      <year iso-8601-date="2009-01">2009</year><month>01</month>
      <volume>3</volume>
      <fpage></fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-kokkinis1989kinetostatic">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Kokkinis</surname><given-names>T</given-names></name>
        <name><surname>Paden</surname><given-names>B</given-names></name>
      </person-group>
      <article-title>Kinetostatic performance limits of cooperating robot manipulators using force-velocity polytopes</article-title>
      <source>Proceedings of the ASME winter annual meeting</source>
      <year iso-8601-date="1989">1989</year>
      <fpage>151</fpage>
      <lpage>155</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Macenski2022ROS2">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Macenski</surname><given-names>Steven</given-names></name>
        <name><surname>Foote</surname><given-names>Tully</given-names></name>
        <name><surname>Gerkey</surname><given-names>Brian</given-names></name>
        <name><surname>Lalancette</surname><given-names>Chris</given-names></name>
        <name><surname>Woodall</surname><given-names>William</given-names></name>
      </person-group>
      <article-title>Robot operating system 2: Design, architecture, and uses in the wild</article-title>
      <source>Science Robotics</source>
      <year iso-8601-date="2022">2022</year>
      <volume>7</volume>
      <issue>66</issue>
      <pub-id pub-id-type="doi">10.1126/scirobotics.abm6074</pub-id>
      <fpage>eabm6074</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Pan2012FCL">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Pan</surname><given-names>Jia</given-names></name>
        <name><surname>Chitta</surname><given-names>Sachin</given-names></name>
        <name><surname>Manocha</surname><given-names>Dinesh</given-names></name>
      </person-group>
      <article-title>FCL: A general purpose library for collision and proximity queries</article-title>
      <source>IEEE international conference on robotics and automation</source>
      <year iso-8601-date="2012">2012</year>
      <volume></volume>
      <pub-id pub-id-type="doi">10.1109/ICRA.2012.6225337</pub-id>
      <fpage>3859</fpage>
      <lpage>3866</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Yoshikawa1984Analysis">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Yoshikawa</surname><given-names>Tsuneo</given-names></name>
      </person-group>
      <article-title>Analysis and control of robot manipulators with redundancy</article-title>
      <source>International symposium on robotics research</source>
      <year iso-8601-date="1984">1984</year>
      <fpage>735</fpage>
      <lpage>747</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zolotas2021Motion">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zolotas</surname><given-names>Mark</given-names></name>
        <name><surname>Wonsick</surname><given-names>Murphy</given-names></name>
        <name><surname>Long</surname><given-names>Philip</given-names></name>
        <name><surname>Padır</surname><given-names>Taşkın</given-names></name>
      </person-group>
      <article-title>Motion Polytopes in Virtual Reality for Shared Control in Remote Manipulation Applications</article-title>
      <source>Frontiers in Robotics and AI</source>
      <year iso-8601-date="2021">2021</year>
      <volume>8</volume>
      <issn>2296-9144</issn>
      <pub-id pub-id-type="doi">10.3389/frobt.2021.730433</pub-id>
      <fpage>286</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Long2019Optimization">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Long</surname><given-names>Philip</given-names></name>
        <name><surname>Keleştemur</surname><given-names>Tarik</given-names></name>
        <name><surname>Önol</surname><given-names>Aykut Özgün</given-names></name>
        <name><surname>Padir</surname><given-names>Taşkin</given-names></name>
      </person-group>
      <article-title>Optimization-based human-in-the-loop manipulation using joint space polytopes</article-title>
      <source>International conference on robotics and automation</source>
      <year iso-8601-date="2019">2019</year>
      <pub-id pub-id-type="doi">10.1109/ICRA.2019.8794071</pub-id>
      <fpage>204</fpage>
      <lpage>210</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Long2018Humanoids">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Long</surname><given-names>Philip</given-names></name>
        <name><surname>Padır</surname><given-names>Taşkın</given-names></name>
      </person-group>
      <article-title>Evaluating robot manipulability in constrained environments by velocity polytope reduction</article-title>
      <source>IEEE-RAS international conference on humanoid robots</source>
      <year iso-8601-date="2018">2018</year>
      <pub-id pub-id-type="doi">10.1109/HUMANOIDS.2018.8624962</pub-id>
      <fpage>497</fpage>
      <lpage>502</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Fukuda1996Double">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Fukuda</surname><given-names>Komei</given-names></name>
        <name><surname>Prodon</surname><given-names>Alain</given-names></name>
      </person-group>
      <article-title>Double description method revisited</article-title>
      <source>Combinatorics and computer science</source>
      <publisher-name>Springer Science &amp; Business Media</publisher-name>
      <year iso-8601-date="1996">1996</year>
      <volume>1120</volume>
      <pub-id pub-id-type="doi">10.1007/3-540-61576-8_77</pub-id>
      <fpage>91</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Hornung2013Octomap">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hornung</surname><given-names>Armin</given-names></name>
        <name><surname>Wurm</surname><given-names>Kai M</given-names></name>
        <name><surname>Bennewitz</surname><given-names>Maren</given-names></name>
        <name><surname>Stachniss</surname><given-names>Cyrill</given-names></name>
        <name><surname>Burgard</surname><given-names>Wolfram</given-names></name>
      </person-group>
      <article-title>OctoMap: An efficient probabilistic 3D mapping framework based on octrees</article-title>
      <source>Autonomous robots</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>34</volume>
      <pub-id pub-id-type="doi">10.1007/s10514-012-9321-0</pub-id>
      <fpage>189</fpage>
      <lpage>206</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Skuric2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Skuric</surname><given-names>Antun</given-names></name>
        <name><surname>Padois</surname><given-names>Vincent</given-names></name>
        <name><surname>Daney</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>Pycapacity: A real-time task-space capacity calculation package for robotics and biomechanics</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>8</volume>
      <issue>89</issue>
      <uri>https://doi.org/10.21105/joss.05670</uri>
      <pub-id pub-id-type="doi">10.21105/joss.05670</pub-id>
      <fpage>5670</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Sagar2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sagar</surname><given-names>Keerthi</given-names></name>
        <name><surname>Caro</surname><given-names>Stéphane</given-names></name>
        <name><surname>Padır</surname><given-names>Taşkın</given-names></name>
        <name><surname>Long</surname><given-names>Philip</given-names></name>
      </person-group>
      <article-title>Polytope-based continuous scalar performance measure with analytical gradient for effective robot manipulation</article-title>
      <source>IEEE Robotics and Automation Letters</source>
      <year iso-8601-date="2023">2023</year>
      <volume>8</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.1109/LRA.2023.3313926</pub-id>
      <fpage>7289</fpage>
      <lpage>7296</lpage>
    </element-citation>
  </ref>
  <ref id="ref-caron2016zmp">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Caron</surname><given-names>Stéphane</given-names></name>
        <name><surname>Pham</surname><given-names>Quang-Cuong</given-names></name>
        <name><surname>Nakamura</surname><given-names>Yoshihiko</given-names></name>
      </person-group>
      <article-title>Zmp support areas for multicontact mobility under frictional constraints</article-title>
      <source>IEEE Transactions on Robotics</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>33</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1109/tro.2016.2623338</pub-id>
      <fpage>67</fpage>
      <lpage>80</lpage>
    </element-citation>
  </ref>
  <ref id="ref-rasheed2018tension">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Rasheed</surname><given-names>Tahir</given-names></name>
        <name><surname>Long</surname><given-names>Philip</given-names></name>
        <name><surname>Marquez-Gamez</surname><given-names>David</given-names></name>
        <name><surname>Caro</surname><given-names>Stéphane</given-names></name>
      </person-group>
      <article-title>Tension distribution algorithm for planar mobile cable-driven parallel robots</article-title>
      <source>Cable-driven parallel robots: Proceedings of the third international conference on cable-driven parallel robots</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <pub-id pub-id-type="doi">10.1007/978-3-319-61431-1_23</pub-id>
      <fpage>268</fpage>
      <lpage>279</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kam2015rviz">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kam</surname><given-names>Hyeong Ryeol</given-names></name>
        <name><surname>Lee</surname><given-names>Sung-Ho</given-names></name>
        <name><surname>Park</surname><given-names>Taejung</given-names></name>
        <name><surname>Kim</surname><given-names>Chang-Hun</given-names></name>
      </person-group>
      <article-title>Rviz: A toolkit for real domain data visualization</article-title>
      <source>Telecommunication Systems</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>60</volume>
      <pub-id pub-id-type="doi">10.1007/s11235-015-0034-5</pub-id>
      <fpage>337</fpage>
      <lpage>345</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zolotas2025ROSFCL">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zolotas</surname><given-names>Mark</given-names></name>
        <name><surname>Long</surname><given-names>Philip</given-names></name>
        <name><surname>Padir</surname><given-names>Taskin</given-names></name>
      </person-group>
      <article-title>Robot_collision_checking: A lightweight ROS 2 interface to FCL (flexible collision library)</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2025">2025</year>
      <volume>10</volume>
      <issue>105</issue>
      <uri>https://doi.org/10.21105/joss.07473</uri>
      <pub-id pub-id-type="doi">10.21105/joss.07473</pub-id>
      <fpage>7473</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Carpentier2021Proximal">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Carpentier</surname><given-names>Justin</given-names></name>
        <name><surname>Budhiraja</surname><given-names>Rohan</given-names></name>
        <name><surname>Mansard</surname><given-names>Nicolas</given-names></name>
      </person-group>
      <article-title>Proximal and Sparse Resolution of Constrained Dynamic Equations</article-title>
      <source>Robotics: Science and Systems 2021</source>
      <publisher-loc>Austin / Virtual, United States</publisher-loc>
      <year iso-8601-date="2021-07">2021</year><month>07</month>
      <uri>https://hal.inria.fr/hal-03271811</uri>
      <pub-id pub-id-type="doi">10.15607/rss.2021.xvii.017</pub-id>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
