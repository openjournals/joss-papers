<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7066</article-id>
<article-id pub-id-type="doi">10.21105/joss.07066</article-id>
<title-group>
<article-title>Back to sequences: Find the origin of
<inline-formula><alternatives>
<tex-math><![CDATA[k]]></tex-math>
<mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Baire</surname>
<given-names>Anthony</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6694-6873</contrib-id>
<name>
<surname>Marijon</surname>
<given-names>Pierre</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0008-0566-200X</contrib-id>
<name>
<surname>Andreace</surname>
<given-names>Francesco</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0776-6407</contrib-id>
<name>
<surname>Peterlongo</surname>
<given-names>Pierre</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Univ. Rennes, Inria, CNRS, IRISA - UMR 6074, Rennes,
F-35000 France</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Laboratoire de Biologie Médicale Multisites SeqOIA, Paris,
France</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Department of Computational Biology, Institut Pasteur,
Université Paris Cité, Paris, F-75015, France</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-06-10">
<day>10</day>
<month>6</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>101</issue>
<fpage>7066</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>rust</kwd>
<kwd>kmer</kwd>
<kwd>indexing</kwd>
<kwd>genomic sequencing data</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="abstract">
  <title>Abstract</title>
  <p>A vast majority of bioinformatics tools dedicated to the treatment
  of raw sequencing data heavily use the concept of
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers,
  which are words of length <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>.
  This enables us to reduce the redundancy of data (and thus the memory
  pressure), to discard sequencing errors, and to dispose of objects of
  fixed size that can be easily manipulated and compared to each other.
  A drawback is that the link between each
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer
  and the original set of sequences to which it belongs is lost. Given
  the volume of data considered in this context, recovering this
  association is costly. In this work, we present
  “<monospace>back_to_sequences</monospace>”, a simple tool designed to
  index a set of <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  of interest and to stream a set of sequences, extracting those
  containing at least one of the indexed <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer.
  In addition, the occurrence positions of
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  in the sequences can be provided. Our results show that
  <monospace>back_to_sequences</monospace> streams
  <inline-formula><alternatives>
  <tex-math><![CDATA[\approx200]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  short reads per millisecond, allowing to search
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  in hundreds of millions of reads in a matter of a few minutes.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>In the 2010s, following the emergence of next-generation sequencing
  technology, read assembly strategies based on the
  overlap-layout-consensus paradigm (OLC) were unable to scale to tens
  of millions of reads or more, prompting the usage of the <italic>de
  Bruijn</italic> graph (dBG) data
  structure (<xref alt="Flicek &amp; Birney, 2009" rid="ref-flicek2009sense" ref-type="bibr">Flicek
  &amp; Birney, 2009</xref>;
  <xref alt="Schatz et al., 2010" rid="ref-schatz2010assembly" ref-type="bibr">Schatz
  et al., 2010</xref>). The success of dBG was due to the fact that the
  main difficulties associated with the nature of the sequencing data
  (read redundancy, nonuniform coverage and nonuniform overlap between
  reads, sequencing errors, unknown sequencing strand) were complex to
  handle with OLC while being easy to handle or simply solved with the
  dBG
  approach (<xref alt="Li et al., 2012" rid="ref-li2012comparison" ref-type="bibr">Li
  et al., 2012</xref>).</p>
  <p>Recall that in the dBG assembly approach, 1. All
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  (words oflength <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>)
  from a set of reads are counted; 2. Those with an abundance lower than
  a threshold are considered to contain sequencing errors and are
  discarded; 3. The remaining <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  are organized in a dBG; 4. The paths of the dBG form the basis of the
  assembly, later improved thanks to scaffolding
  tools (<xref alt="Huson et al., 2002" rid="ref-huson2002greedy" ref-type="bibr">Huson
  et al., 2002</xref>) such as the tools provided, for instance, by the
  Spades
  assembler (<xref alt="Bankevich et al., 2012" rid="ref-bankevich2012spades" ref-type="bibr">Bankevich
  et al., 2012</xref>).</p>
  <p>The usefulness of <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  did not end with their use in dBGs. A large and redundant set of
  sequences, such as a sequencing read set, can be summarized by its set
  of <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers.
  Among multiple fundamental tasks, this has been the basis for
  metagenome
  comparisons (<xref alt="Benoit et al., 2016" rid="ref-benoit2016multiple" ref-type="bibr">Benoit
  et al., 2016</xref>), for taxonomy
  characterization (<xref alt="Wood et al., 2019" rid="ref-wood2019improved" ref-type="bibr">Wood
  et al., 2019</xref>), for indexing
  purposes (<xref alt="Cracco &amp; Tomescu, 2023" rid="ref-cracco2023extremely" ref-type="bibr">Cracco
  &amp; Tomescu, 2023</xref>;
  <xref alt="Lemane, Medvedev, et al., 2022" rid="ref-lemane2022kmtricks" ref-type="bibr">Lemane,
  Medvedev, et al., 2022</xref>), for
  genotyping (<xref alt="Grytten et al., 2022" rid="ref-grytten2022kage" ref-type="bibr">Grytten
  et al., 2022</xref>), for species
  identification (<xref alt="Sarmashghi et al., 2019" rid="ref-sarmashghi2019skmer" ref-type="bibr">Sarmashghi
  et al., 2019</xref>), for transcript expression
  estimation (<xref alt="Zhang &amp; Wang, 2014" rid="ref-zhang2014rna" ref-type="bibr">Zhang
  &amp; Wang, 2014</xref>), or for variant
  discovery (<xref alt="Uricaru et al., 2015" rid="ref-uricaru2015reference" ref-type="bibr">Uricaru
  et al., 2015</xref>) to cite only a few examples.</p>
  <p>One of the keys to the success of the use of
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  is its low resource needs. Whatever the sequencing coverage, once
  filtered, the number of distinct <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  is at most equal to the original genome size. This offers a minimal
  impact on random access memory (RAM) and/or disk needs. However, this
  comes at the cost of losing the link between each
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer
  and the sequence(s) from which it originates. Storing these links
  explicitly would reintroduce the problem associated with the abundance
  of original reads, as the link between each original read and each of
  its <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  would have to be stored. For instance, considering
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  from a sequencing experiment of a human genome
  (<inline-formula><alternatives>
  <tex-math><![CDATA[\approx 3]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>≈</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  billion nucleotides) with a coverage of 50x (each
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer
  occurs on average in 50 distinct reads) would require more than 2TB of
  space considering 64 bits for storing each link and 64 bits for
  storing the associated read identifier. This is not acceptable.</p>
  <p>There are many situations in which finding the origin of
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  from a set in a set of reads is informative. For instance, this is the
  case in studies in which the output is composed of
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  associated with biological knowledge such as biological
  variants (<xref alt="Uricaru et al., 2015" rid="ref-uricaru2015reference" ref-type="bibr">Uricaru
  et al., 2015</xref>), or <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  specific to a phenotypic
  trait (<xref alt="Lemane, Chikhi, et al., 2022" rid="ref-lemane2022k" ref-type="bibr">Lemane,
  Chikhi, et al., 2022</xref>). This approach can also be used for
  quality
  control (<xref alt="Plaza Onate et al., 2015" rid="ref-plaza2015quality" ref-type="bibr">Plaza
  Onate et al., 2015</xref>) or contamination
  removal (<xref alt="González et al., 2023" rid="ref-gonzalez2023akmerbroom" ref-type="bibr">González
  et al., 2023</xref>) for instance.</p>
  <p>Recovering the link between a <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer
  and each original read in which it occurs can be performed by indexing
  the
  reads (<xref alt="Marchet et al., 2020" rid="ref-marchet2020resource" ref-type="bibr">Marchet
  et al., 2020</xref>) which is too costly for hundreds of millions
  reads. One may also apply <italic>grep-like</italic> evolved pattern
  matching approaches such as
  <monospace>pt</monospace> (<xref alt="Monochromegane, 2018" rid="ref-pt" ref-type="bibr">Monochromegane,
  2018</xref>). However, even though they have been highly optimized in
  recent decades, these approaches cannot efficiently detect thousands
  of <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  in millions of reads. The approaches that use
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  for genotyping such as
  <monospace>kage</monospace> (<xref alt="Grytten et al., 2022" rid="ref-grytten2022kage" ref-type="bibr">Grytten
  et al., 2022</xref>) may find the number of occurrences of
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  but do not extract the sequences from which they originate.</p>
  <p>In this context, we propose
  <monospace>back_to_sequences</monospace>, a tool specifically
  dedicated to extracting from <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{S}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝒮</mml:mi></mml:math></alternatives></inline-formula>,
  a set of sequences (e.g. reads), those that contain some of the
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  from a set <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{K}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝒦</mml:mi></mml:math></alternatives></inline-formula>
  given as input. The occurrence positions of
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  in each sequence of the queried set <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{S}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝒮</mml:mi></mml:math></alternatives></inline-formula>
  can also be output.</p>
</sec>
<sec id="possible-alternatives">
  <title>Possible Alternatives</title>
  <p>To the best of our knowledge, there exists no tool specifically
  dedicated to this task, while indexing the set of
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{K}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝒦</mml:mi></mml:math></alternatives></inline-formula>.</p>
  <p>Genotypers as
  <monospace>kage</monospace> (<xref alt="Grytten et al., 2022" rid="ref-grytten2022kage" ref-type="bibr">Grytten
  et al., 2022</xref>), using
  <monospace>kmer mapper</monospace> (<xref alt="Ivar Grytten, 2020" rid="ref-kmermapper" ref-type="bibr">Ivar
  Grytten, 2020</xref>), provide a way to count the number of
  occurrences of each <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer
  from a set of reference <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  in a read file. However, they do not offer a feature for extracting
  reads that contain any reference <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer.</p>
  <p>Finding one unique <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer
  of interest in a set of sequences can be done using the classical
  <monospace>grep</monospace> or more recent pattern-matching tools such
  as “<italic>The Platinum
  Searcher</italic>” (<xref alt="Monochromegane, 2018" rid="ref-pt" ref-type="bibr">Monochromegane,
  2018</xref>) or “<italic>The Silver
  Searcher</italic>” (<xref alt="Greer, 2020" rid="ref-ag" ref-type="bibr">Greer,
  2020</xref>).</p>
  <p>As for testing, we queried one <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer
  (with <inline-formula><alternatives>
  <tex-math><![CDATA[k=31]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>31</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)
  in a dataset composed of 100 million sequences, each of length 100
  nucleotides (see the
  <ext-link ext-link-type="uri" xlink:href="https://b2s-doc.readthedocs.io/en/latest/results.html">documentation</ext-link>
  for details), using these three tools.</p>
  <list list-type="bullet">
    <list-item>
      <p><monospace>grep</monospace> required 44 seconds. Thus, by
      simple extrapolation, searching for one million
      <inline-formula><alternatives>
      <tex-math><![CDATA[k]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
      on a single computer would require approximately 500 days, to be
      compared to less than a minute using
      <monospace>back_to_sequences</monospace>.</p>
    </list-item>
    <list-item>
      <p><monospace>pt</monospace> (<italic>The Platinum
      Searcher</italic>) required 15 seconds, which can be extrapolated
      to approximately 175 days if searching for one million
      <inline-formula><alternatives>
      <tex-math><![CDATA[k]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers.</p>
    </list-item>
    <list-item>
      <p><monospace>ag</monospace> (<italic>The Silver
      Searcher</italic>) did not finish after 400 seconds.</p>
    </list-item>
  </list>
  <p>Summing up, we find these alternative tools are not appropriate for
  querying numerous patterns at the same time and do not scale to large
  problem instances.</p>
  <p>Note also that these alternative tools are not specialized for
  genomic data in which one is interested in searching for a
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mer
  and potentially its reverse complement. Finally, these tools do not
  easily provide the number of occurrences or occurrence positions of
  each of the searched patterns when there are many.</p>
</sec>
<sec id="conclusion">
  <title>Conclusion</title>
  <p>We believe that <monospace>back_to_sequences</monospace> is a
  generic and handy tool that will be beneficial for building pipelines
  that require manipulating <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>-mers
  and recovering the sequences from which they originate and/or counting
  their number of occurrences in a set of genomic sequences. We also
  believe that <monospace>back_to_sequences</monospace> will have other
  straightforward applications, in such areas as quality control,
  contamination removal, or genotyping known pieces of sequences in raw
  sequencing datasets. Because of the efficiency of our approach, such
  applications could be executed in real time during the sequencing
  process.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We acknowledge the GenOuest core facility
  (<ext-link ext-link-type="uri" xlink:href="https://www.genouest.org">https://www.genouest.org</ext-link>)
  for providing the computing infrastructure. The work was funded by ANR
  SeqDigger (ANR-19-CE45-0008), and by the Inria Challenge “OmicFinder”
  (<ext-link ext-link-type="uri" xlink:href="https://project.inria.fr/omicfinder/">https://project.inria.fr/omicfinder/</ext-link>).</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-pt">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Monochromegane</surname></name>
      </person-group>
      <article-title>The Platinum Searcher</article-title>
      <publisher-name>https://github.com/monochromegane/the_platinum_searcher</publisher-name>
      <year iso-8601-date="2018">2018</year>
    </element-citation>
  </ref>
  <ref id="ref-ag">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Greer</surname><given-names>Geoff</given-names></name>
      </person-group>
      <article-title>The Silver Searcher</article-title>
      <publisher-name>https://github.com/ggreer/the_silver_searcher</publisher-name>
      <year iso-8601-date="2020">2020</year>
    </element-citation>
  </ref>
  <ref id="ref-kmermapper">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Ivar Grytten</surname><given-names>Knut Dagestad Rand</given-names></name>
      </person-group>
      <article-title>Kmer Mapper</article-title>
      <publisher-name>https://github.com/ivargr/kmer_mapper</publisher-name>
      <year iso-8601-date="2020">2020</year>
    </element-citation>
  </ref>
  <ref id="ref-grytten2022kage">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Grytten</surname><given-names>Ivar</given-names></name>
        <name><surname>Dagestad Rand</surname><given-names>Knut</given-names></name>
        <name><surname>Sandve</surname><given-names>Geir Kjetil</given-names></name>
      </person-group>
      <article-title>KAGE: Fast alignment-free graph-based genotyping of SNPs and short indels</article-title>
      <source>Genome Biology</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>23</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1186/s13059-022-02771-2</pub-id>
      <fpage>209</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-flicek2009sense">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Flicek</surname><given-names>Paul</given-names></name>
        <name><surname>Birney</surname><given-names>Ewan</given-names></name>
      </person-group>
      <article-title>Sense from sequence reads: Methods for alignment and assembly</article-title>
      <source>Nature methods</source>
      <publisher-name>Nature Publishing Group US New York</publisher-name>
      <year iso-8601-date="2009">2009</year>
      <volume>6</volume>
      <issue>Suppl 11</issue>
      <pub-id pub-id-type="doi">10.1038/nmeth.1376</pub-id>
      <fpage>S6</fpage>
      <lpage>S12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-schatz2010assembly">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schatz</surname><given-names>Michael C</given-names></name>
        <name><surname>Delcher</surname><given-names>Arthur L</given-names></name>
        <name><surname>Salzberg</surname><given-names>Steven L</given-names></name>
      </person-group>
      <article-title>Assembly of large genomes using second-generation sequencing</article-title>
      <source>Genome research</source>
      <publisher-name>Cold Spring Harbor Lab</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>20</volume>
      <issue>9</issue>
      <pub-id pub-id-type="doi">10.1101/gr.101360.109</pub-id>
      <fpage>1165</fpage>
      <lpage>1173</lpage>
    </element-citation>
  </ref>
  <ref id="ref-benoit2016multiple">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Benoit</surname><given-names>Gaëtan</given-names></name>
        <name><surname>Peterlongo</surname><given-names>Pierre</given-names></name>
        <name><surname>Mariadassou</surname><given-names>Mahendra</given-names></name>
        <name><surname>Drezen</surname><given-names>Erwan</given-names></name>
        <name><surname>Schbath</surname><given-names>Sophie</given-names></name>
        <name><surname>Lavenier</surname><given-names>Dominique</given-names></name>
        <name><surname>Lemaitre</surname><given-names>Claire</given-names></name>
      </person-group>
      <article-title>Multiple comparative metagenomics using multiset k-mer counting</article-title>
      <source>PeerJ Computer Science</source>
      <publisher-name>PeerJ Inc.</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>2</volume>
      <pub-id pub-id-type="doi">10.7717/peerj-cs.94</pub-id>
      <fpage>e94</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-li2012comparison">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Li</surname><given-names>Zhenyu</given-names></name>
        <name><surname>Chen</surname><given-names>Yanxiang</given-names></name>
        <name><surname>Mu</surname><given-names>Desheng</given-names></name>
        <name><surname>Yuan</surname><given-names>Jianying</given-names></name>
        <name><surname>Shi</surname><given-names>Yujian</given-names></name>
        <name><surname>Zhang</surname><given-names>Hao</given-names></name>
        <name><surname>Gan</surname><given-names>Jun</given-names></name>
        <name><surname>Li</surname><given-names>Nan</given-names></name>
        <name><surname>Hu</surname><given-names>Xuesong</given-names></name>
        <name><surname>Liu</surname><given-names>Binghang</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Comparison of the two major classes of assembly algorithms: Overlap–layout–consensus and de-bruijn-graph</article-title>
      <source>Briefings in functional genomics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2012">2012</year>
      <volume>11</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1093/bfgp/elr035</pub-id>
      <fpage>25</fpage>
      <lpage>37</lpage>
    </element-citation>
  </ref>
  <ref id="ref-sarmashghi2019skmer">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sarmashghi</surname><given-names>Shahab</given-names></name>
        <name><surname>Bohmann</surname><given-names>Kristine</given-names></name>
        <name><surname>P. Gilbert</surname><given-names>M Thomas</given-names></name>
        <name><surname>Bafna</surname><given-names>Vineet</given-names></name>
        <name><surname>Mirarab</surname><given-names>Siavash</given-names></name>
      </person-group>
      <article-title>Skmer: Assembly-free and alignment-free sample identification using genome skims</article-title>
      <source>Genome biology</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>20</volume>
      <pub-id pub-id-type="doi">10.1186/s13059-019-1632-4</pub-id>
      <fpage>1</fpage>
      <lpage>20</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhang2014rna">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhang</surname><given-names>Zhaojun</given-names></name>
        <name><surname>Wang</surname><given-names>Wei</given-names></name>
      </person-group>
      <article-title>RNA-skim: A rapid method for RNA-seq quantification at transcript level</article-title>
      <source>Bioinformatics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2014">2014</year>
      <volume>30</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/btu288</pub-id>
      <fpage>i283</fpage>
      <lpage>i292</lpage>
    </element-citation>
  </ref>
  <ref id="ref-uricaru2015reference">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Uricaru</surname><given-names>Raluca</given-names></name>
        <name><surname>Rizk</surname><given-names>Guillaume</given-names></name>
        <name><surname>Lacroix</surname><given-names>Vincent</given-names></name>
        <name><surname>Quillery</surname><given-names>Elsa</given-names></name>
        <name><surname>Plantard</surname><given-names>Olivier</given-names></name>
        <name><surname>Chikhi</surname><given-names>Rayan</given-names></name>
        <name><surname>Lemaitre</surname><given-names>Claire</given-names></name>
        <name><surname>Peterlongo</surname><given-names>Pierre</given-names></name>
      </person-group>
      <article-title>Reference-free detection of isolated SNPs</article-title>
      <source>Nucleic acids research</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>43</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1093/nar/gku1187</pub-id>
      <fpage>e11</fpage>
      <lpage>e11</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lemane2022kmtricks">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lemane</surname><given-names>Téo</given-names></name>
        <name><surname>Medvedev</surname><given-names>Paul</given-names></name>
        <name><surname>Chikhi</surname><given-names>Rayan</given-names></name>
        <name><surname>Peterlongo</surname><given-names>Pierre</given-names></name>
      </person-group>
      <article-title>Kmtricks: Efficient and flexible construction of bloom filters for large sequencing data collections</article-title>
      <source>Bioinformatics Advances</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>2</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1093/bioadv/vbac029</pub-id>
      <fpage>vbac029</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-cracco2023extremely">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cracco</surname><given-names>Andrea</given-names></name>
        <name><surname>Tomescu</surname><given-names>Alexandru I</given-names></name>
      </person-group>
      <article-title>Extremely fast construction and querying of compacted and colored de bruijn graphs with GGCAT</article-title>
      <source>Genome Research</source>
      <publisher-name>Cold Spring Harbor Lab</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <pub-id pub-id-type="doi">10.1101/gr.277615.122</pub-id>
      <fpage>gr</fpage>
      <lpage>277615</lpage>
    </element-citation>
  </ref>
  <ref id="ref-huson2002greedy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Huson</surname><given-names>Daniel H</given-names></name>
        <name><surname>Reinert</surname><given-names>Knut</given-names></name>
        <name><surname>Myers</surname><given-names>Eugene W</given-names></name>
      </person-group>
      <article-title>The greedy path-merging algorithm for contig scaffolding</article-title>
      <source>Journal of the ACM (JACM)</source>
      <publisher-name>ACM New York, NY, USA</publisher-name>
      <year iso-8601-date="2002">2002</year>
      <volume>49</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.1145/585265.585267</pub-id>
      <fpage>603</fpage>
      <lpage>615</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bankevich2012spades">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bankevich</surname><given-names>Anton</given-names></name>
        <name><surname>Nurk</surname><given-names>Sergey</given-names></name>
        <name><surname>Antipov</surname><given-names>Dmitry</given-names></name>
        <name><surname>Gurevich</surname><given-names>Alexey A</given-names></name>
        <name><surname>Dvorkin</surname><given-names>Mikhail</given-names></name>
        <name><surname>Kulikov</surname><given-names>Alexander S</given-names></name>
        <name><surname>Lesin</surname><given-names>Valery M</given-names></name>
        <name><surname>Nikolenko</surname><given-names>Sergey I</given-names></name>
        <name><surname>Pham</surname><given-names>Son</given-names></name>
        <name><surname>Prjibelski</surname><given-names>Andrey D</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>SPAdes: A new genome assembly algorithm and its applications to single-cell sequencing</article-title>
      <source>Journal of computational biology</source>
      <publisher-name>Mary Ann Liebert, Inc. 140 Huguenot Street, 3rd Floor New Rochelle, NY 10801 USA</publisher-name>
      <year iso-8601-date="2012">2012</year>
      <volume>19</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.1089/cmb.2012.0021</pub-id>
      <fpage>455</fpage>
      <lpage>477</lpage>
    </element-citation>
  </ref>
  <ref id="ref-marchet2020resource">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Marchet</surname><given-names>Camille</given-names></name>
        <name><surname>Lecompte</surname><given-names>Lolita</given-names></name>
        <name><surname>Limasset</surname><given-names>Antoine</given-names></name>
        <name><surname>Bittner</surname><given-names>Lucie</given-names></name>
        <name><surname>Peterlongo</surname><given-names>Pierre</given-names></name>
      </person-group>
      <article-title>A resource-frugal probabilistic dictionary and applications in bioinformatics</article-title>
      <source>Discrete Applied Mathematics</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>274</volume>
      <pub-id pub-id-type="doi">10.1016/j.dam.2018.03.035</pub-id>
      <fpage>92</fpage>
      <lpage>102</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wood2019improved">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wood</surname><given-names>Derrick E</given-names></name>
        <name><surname>Lu</surname><given-names>Jennifer</given-names></name>
        <name><surname>Langmead</surname><given-names>Ben</given-names></name>
      </person-group>
      <article-title>Improved metagenomic analysis with kraken 2</article-title>
      <source>Genome biology</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>20</volume>
      <pub-id pub-id-type="doi">10.1186/s13059-019-1891-0</pub-id>
      <fpage>1</fpage>
      <lpage>13</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lemane2022k">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lemane</surname><given-names>Téo</given-names></name>
        <name><surname>Chikhi</surname><given-names>Rayan</given-names></name>
        <name><surname>Peterlongo</surname><given-names>Pierre</given-names></name>
      </person-group>
      <article-title>Kmdiff, large-scale and user-friendly differential k-mer analyses</article-title>
      <source>Bioinformatics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>38</volume>
      <issue>24</issue>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/btac689</pub-id>
      <fpage>5443</fpage>
      <lpage>5445</lpage>
    </element-citation>
  </ref>
  <ref id="ref-plaza2015quality">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Plaza Onate</surname><given-names>Florian</given-names></name>
        <name><surname>Batto</surname><given-names>Jean-Michel</given-names></name>
        <name><surname>Juste</surname><given-names>Catherine</given-names></name>
        <name><surname>Fadlallah</surname><given-names>Jehane</given-names></name>
        <name><surname>Fougeroux</surname><given-names>Cyrielle</given-names></name>
        <name><surname>Gouas</surname><given-names>Doriane</given-names></name>
        <name><surname>Pons</surname><given-names>Nicolas</given-names></name>
        <name><surname>Kennedy</surname><given-names>Sean</given-names></name>
        <name><surname>Levenez</surname><given-names>Florence</given-names></name>
        <name><surname>Dore</surname><given-names>Joel</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Quality control of microbiota metagenomics by k-mer analysis</article-title>
      <source>BMC genomics</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>16</volume>
      <pub-id pub-id-type="doi">10.1186/s12864-015-1406-7</pub-id>
      <fpage>1</fpage>
      <lpage>10</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gonzalez2023akmerbroom">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>González</surname><given-names>Camila Duitama</given-names></name>
        <name><surname>Rangavittal</surname><given-names>Samarth</given-names></name>
        <name><surname>Vicedomini</surname><given-names>Riccardo</given-names></name>
        <name><surname>Chikhi</surname><given-names>Rayan</given-names></name>
        <name><surname>Richard</surname><given-names>Hugues</given-names></name>
      </person-group>
      <article-title>aKmerBroom: Ancient oral DNA decontamination using bloom filters on k-mer sets</article-title>
      <source>Iscience</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>26</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.1016/j.isci.2023.108057</pub-id>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
