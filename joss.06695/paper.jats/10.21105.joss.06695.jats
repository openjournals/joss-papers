<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6695</article-id>
<article-id pub-id-type="doi">10.21105/joss.06695</article-id>
<title-group>
<article-title>movement_primitives: Imitation Learning of Cartesian
Motion with Movement Primitives</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2824-7956</contrib-id>
<name>
<surname>Fabisch</surname>
<given-names>Alexander</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Robotics Innovation Center, German Research Center for
Artificial Intelligence (DFKI GmbH), Bremen, Germany</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-03-21">
<day>21</day>
<month>3</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>97</issue>
<fpage>6695</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>robotics</kwd>
<kwd>imitation learning</kwd>
<kwd>dynamical movement primitive</kwd>
<kwd>probabilistic movement primitive</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Movement primitives are a common representation of movements in
  robotics
  (<xref alt="Maeda et al., 2017" rid="ref-Maeda2017" ref-type="bibr">Maeda
  et al., 2017</xref>) for imitation learning, reinforcement learning,
  and black-box optimization of behaviors. There are many types and
  variations. The Python library <italic>movement_primitives</italic>
  focuses on imitation learning (see
  <xref alt="[fig:summary]" rid="figU003Asummary">[fig:summary]</xref>),
  generalization, and adaptation of movement primitives in Cartesian
  space. It implements dynamical movement primitives, probabilistic
  movement primitives, as well as Cartesian and dual Cartesian movement
  primitives with coupling terms to constrain relative movements in
  bimanual manipulation. They are implemented in Cython to speed up
  online execution and batch processing in an offline setting. In
  addition, the library provides tools for data analysis and movement
  evaluation.</p>
  <fig>
    <caption><p>Illustration of imitation learning processes supported
    by movement_primitives. The photo was extracted from Mronga
    (<xref alt="2022" rid="ref-Mronga2022" ref-type="bibr">2022</xref>)
    under
    <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">CC
    BY 4.0
    DEED</ext-link>.<styled-content id="figU003Asummary"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="summary.pdf" />
  </fig>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Movement primitives are a common group of policy representations in
  robotics. They are able to represent complex movement patterns, allow
  temporal and spatial modification, offer stability guarantees, and are
  suitable for imitation learning without complicated hyperparameter
  tuning, which are advantages over general function approximators like
  neural networks. Movement primitives are white-box models for movement
  generation and allow to control several aspects of the movement. There
  are types of dynamical movement primitives that allow to directly
  control the goal in state space, the final velocity, or the relative
  pose of two robotic end-effectors. Probabilistic movement primitives
  capture distributions of movements adequately and allow conditioning
  in state space and blending of multiple movements. The main
  disadvantage of movement primitives in comparison to general function
  approximators is that they are limited in their capacity to represent
  behavior that takes into account complex sensor data during execution.
  Nevertheless, various types of movement primitives have proven to be a
  reliable and effective tool in robot learning. A reliable tool
  deserves a similarly reliable open source implementation. However,
  there are only a few actively maintained, documented, and easy to use
  implementations. One of these is the library
  <italic>movement_primitives</italic>. It combines several types of
  dynamical movement primitives and probabilistic movement primitives in
  a single library with a focus on Cartesian and bimanual movements.</p>
</sec>
<sec id="movement-primitives">
  <title>Movement Primitives</title>
  <sec id="dynamical-movement-primitives">
    <title>Dynamical Movement Primitives</title>
    <p>Dynamical Movement Primitives (DMPs) are the most prominent
    example of movement primitives
    (<xref alt="Ijspeert et al., 2002" rid="ref-Ijspeert2002" ref-type="bibr">Ijspeert
    et al., 2002</xref>,
    <xref alt="2013" rid="ref-Ijspeert2013" ref-type="bibr">2013</xref>).
    From a high-level perspective
    (<xref alt="Fabisch &amp; Metzen, 2014" rid="ref-Fabisch2014" ref-type="bibr">Fabisch
    &amp; Metzen, 2014</xref>), a DMP is a policy
    <disp-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{x}_{t+1} = \pi_{\boldsymbol{w}, \boldsymbol{v}}(\boldsymbol{x}_t, t),]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>𝐱</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>𝐰</mml:mi><mml:mo>,</mml:mo><mml:mi>𝐯</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐱</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
    where <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{x}_t]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐱</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is the state of an agent (position, velocity, and acceleration) at
    time <inline-formula><alternatives>
    <tex-math><![CDATA[t]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>t</mml:mi></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{w}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐰</mml:mi></mml:math></alternatives></inline-formula>
    are the weights (parameters) that define the shape of the movement,
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{v}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐯</mml:mi></mml:math></alternatives></inline-formula>
    are meta-parameters. The exact definition of the meta-parameters
    <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{v}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐯</mml:mi></mml:math></alternatives></inline-formula>
    depends on the DMP type, but most types allow to set the initial
    state <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{x}_0]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐱</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula>,
    the final state <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{g}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐠</mml:mi></mml:math></alternatives></inline-formula>,
    and the duration of the movement <inline-formula><alternatives>
    <tex-math><![CDATA[\tau]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>τ</mml:mi></mml:math></alternatives></inline-formula>.
    A DMP generates a trajectory in state space so that a controller
    that translates states <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{x}_t, \boldsymbol{x}_{t+1}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>𝐱</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>𝐱</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    to control commands is required.</p>
    <p>DMPs have been used for imitation learning, in which one
    demonstration is enough to learn a DMP. DMPs can also be used in a
    reinforcement learning setting, in which the weights of the DMP or
    the meta-parameters can be learned. Saveriano et al.
    (<xref alt="2023" rid="ref-Saveriano2023" ref-type="bibr">2023</xref>)
    provide a survey of DMPs and how they can be used.</p>
    <p>In the <italic>movement_primitives</italic> library, we implement
    several types that are important for Cartesian movement generation:
    an extension that includes the final velocity as a meta-parameter
    (<xref alt="Mülling et al., 2013" rid="ref-Muelling2013" ref-type="bibr">Mülling
    et al., 2013</xref>), DMPs for Cartesian poses in three dimensions
    with unit quaternions
    (<xref alt="Ude et al., 2014" rid="ref-Ude2014" ref-type="bibr">Ude
    et al., 2014</xref>), and DMPs that define bimanual movements by
    introducing a coupling term that controls the relative motion of two
    arms
    (<xref alt="Gams et al., 2013" rid="ref-Gams2013" ref-type="bibr">Gams
    et al., 2013</xref>).</p>
  </sec>
  <sec id="probabilistic-movement-primitives">
    <title>Probabilistic Movement Primitives</title>
    <p>Another type of movement primitives implemented in this library
    are Probabilistic Movement Primitives (ProMPs)
    (<xref alt="Paraschos et al., 2013" rid="ref-Paraschos2013" ref-type="bibr">Paraschos
    et al., 2013</xref>) that capture the distribution of multiple
    demonstrations. Their probabilistic formulation allows to modify
    movements by conditioning, for instance, on viapoints.</p>
  </sec>
</sec>
<sec id="implementations-of-movement-primitives">
  <title>Implementations of Movement Primitives</title>
  <p>The <italic>movement_primitives</italic> library is a
  reimplementation and extension of the movement primitive features of
  BOLeRo
  (<xref alt="Fabisch et al., 2020" rid="ref-Fabisch2020" ref-type="bibr">Fabisch
  et al., 2020</xref>). BOLeRo is a C++/Python framework for behavior
  learning and optimization. However, the focus is very broad and more
  on reinforcement learning and behavior parameter optimization than on
  imitation learning.</p>
  <p>Another similar library is dmpbbo
  (<xref alt="Stulp &amp; Raiola, 2019" rid="ref-Stulp2019" ref-type="bibr">Stulp
  &amp; Raiola, 2019</xref>), which has a general DMP implementation and
  additional components to optimize the parameters of DMPs in
  reinforcement learning settings. The library is designed to train DMPs
  in Python and execute them in C++. Both implementations are not
  well-suited for imitation learning because additional tooling for data
  analysis and deployment is required. Switching between C++ and Python
  is also not convenient for various reasons: building and installing
  these packages is complicated, continuous integration is hard to set
  up, code maintenance is complicated, and it does not integrate easily
  with the Python scientific ecosystem.</p>
  <p>There are more implementations listed by Saveriano et al.
  (<xref alt="2023" rid="ref-Saveriano2023" ref-type="bibr">2023</xref>)
  (available at
  https://gitlab.com/dmp-codes-collection/third-party-dmp). A lot of
  these are examplary Matlab scripts and not maintained anymore, or only
  implementations of specific papers. Other libraries do not support
  Cartesian movement primitives, which are only available in BOLeRo and
  <italic>movement_primitives</italic>. The latter also supports
  bimanual movements through dual Cartesian DMPs.</p>
</sec>
<sec id="design-and-features">
  <title>Design and Features</title>
  <p>The main contributions of <italic>movement_primitives</italic> are
  (1) a fast Python-only library for movement primitives, and (2) robust
  implementations of several types of movement primitives (see
  <xref alt="Table 1" rid="tabU003Afeatures">Table 1</xref>). Our focus
  is on Cartesian movement primitives that are used to control one or
  two robotic arms and offer exemplary implementations of coupling terms
  for Cartesian (bimanual) DMPs. These can be used for obstacle
  avoidance and to constrain dual arm motions to relative positions
  and/or orientations.</p>
  <table-wrap>
    <caption>
      <p>Overview of implemented movement
      primitives.<styled-content id="tabU003Afeatures"></styled-content></p>
    </caption>
    <table>
      <thead>
        <tr>
          <th>Class</th>
          <th>Description</th>
          <th>Publication</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>DMP</td>
          <td>Standard DMP</td>
          <td>Ijspeert et al.
          (<xref alt="2013" rid="ref-Ijspeert2013" ref-type="bibr">2013</xref>)</td>
        </tr>
        <tr>
          <td>DMP</td>
          <td>Smooth spatial scaling</td>
          <td>Pastor et al.
          (<xref alt="2009" rid="ref-Pastor2009" ref-type="bibr">2009</xref>)</td>
        </tr>
        <tr>
          <td>DMPWithFinalVelocity</td>
          <td>Allows final velocity</td>
          <td>Mülling et al.
          (<xref alt="2013" rid="ref-Muelling2013" ref-type="bibr">2013</xref>)</td>
        </tr>
        <tr>
          <td>CartesianDMP</td>
          <td>DMP of Cartesian poses</td>
          <td>Ude et al.
          (<xref alt="2014" rid="ref-Ude2014" ref-type="bibr">2014</xref>)</td>
        </tr>
        <tr>
          <td>DualCartesianDMP</td>
          <td>DMP of two Cartesian poses</td>
          <td>Gams et al.
          (<xref alt="2013" rid="ref-Gams2013" ref-type="bibr">2013</xref>)</td>
        </tr>
        <tr>
          <td>ProMP</td>
          <td>Standard ProMP</td>
          <td>Paraschos et al.
          (<xref alt="2013" rid="ref-Paraschos2013" ref-type="bibr">2013</xref>)</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p>Furthermore, <italic>movement_primitives</italic> supports the
  whole imitation learning pipeline, including data analysis through
  plotting and visualization (based on pytransform3d
  (<xref alt="Fabisch, 2019" rid="ref-Fabisch2019" ref-type="bibr">Fabisch,
  2019</xref>) and Open3D
  (<xref alt="Zhou et al., 2018" rid="ref-Zhou2018" ref-type="bibr">Zhou
  et al., 2018</xref>)), data preprocessing for imitation learning, good
  integration with the scientific ecosystem in Python, simulation of
  learned movement primitives (in PyBullet
  (<xref alt="Coumans &amp; Bai, 2016--2021" rid="ref-Coumans2021" ref-type="bibr">Coumans
  &amp; Bai, 2016--2021</xref>)), export to permanent data formats
  (pickle, JSON, YAML), and analysis of kinematic feasibility. Although
  it has several dependencies and requires compilation because of its
  Cython
  (<xref alt="Dalcin et al., 2011" rid="ref-Dalcin2011" ref-type="bibr">Dalcin
  et al., 2011</xref>) components, it is possible to simply install it
  with pip from PyPI.</p>
</sec>
<sec id="example-rotating-a-compact-solar-panel-with-a-humanoid">
  <title>Example: Rotating a Compact Solar Panel with a Humanoid</title>
  <p><xref alt="[fig:rh5]" rid="figU003Arh5">[fig:rh5]</xref> and
  <xref alt="[fig:rh5_viz]" rid="figU003Arh5_viz">[fig:rh5_viz]</xref>
  show a humanoid robot rotating an object with two hands. The movement
  is generated by a dual Cartesian DMP trained on a demonstrated
  rotation movement. The width of the object is known. Hence, it can
  easily be adapted for similar objects with a different size through a
  coupling term defined by Gams et al.
  (<xref alt="2013" rid="ref-Gams2013" ref-type="bibr">2013</xref>).</p>
  <fig>
    <caption><p>RH5 Manus
    (<xref alt="Boukheddimi et al., 2022" rid="ref-Boukheddimi2022" ref-type="bibr">Boukheddimi
    et al., 2022</xref>) rotating a compact solar
    panel.<styled-content id="figU003Arh5"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="rh5_panel_0.png" />
  </fig>
  <fig>
    <caption><p>Visualization of similar rotation trajectory with
    another humanoid
    robot.<styled-content id="figU003Arh5_viz"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="dual_cart_dmps_rh5_open3d.png" />
  </fig>
  <p>A similar task has been solved by Mronga &amp; Kirchner
  (<xref alt="2021" rid="ref-Mronga2021" ref-type="bibr">2021</xref>)
  with two Kuka iiwa arms. They record a dataset for different panel
  sizes via kinesthetic teaching and use Gaussian mixture regression to
  represent the distribution of solutions and condition it on the object
  width to generalize. This is easier with ProMPs: for each
  demonstration, we compute ProMP weights, concatenate them with the
  task parameters over which we want to generalize, and learn a Gaussian
  mixture model, which we can condition on task parameters to generate
  ProMPs that define trajectory distributions to solve these tasks
  (<xref alt="[fig:kuka_mean]" rid="figU003Akuka_mean">[fig:kuka_mean]</xref>
  and
  <xref alt="[fig:kuka_ellipsoids]" rid="figU003Akuka_ellipsoids">[fig:kuka_ellipsoids]</xref>).</p>
  <fig>
    <caption><p>Mean trajectories for conditional ProMPs and panel
    widths 30/40/50
    cm.<styled-content id="figU003Akuka_mean"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="contextual_promps_kuka_panel_width_open3d.png" />
  </fig>
  <fig>
    <caption><p>At each step, the position distribution defined by the
    conditioned ProMP is indicated by an equiprobable ellipsoid. The
    arms are at the mean start position for width 50
    cm.<styled-content id="figU003Akuka_ellipsoids"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="contextual_promps_kuka_panel_width_open3d2.png" />
  </fig>
</sec>
<sec id="benchmark-of-dmp-implementations">
  <title>Benchmark of DMP Implementations</title>
  <p>Since execution speed of DMPs is relevant in robotics, we compare
  several DMP implementations from dmpbbo and
  <italic>movement_primitives</italic>. For this purpose, we create a
  minimum jerk trajectory of <inline-formula><alternatives>
  <tex-math><![CDATA[N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>
  dimensions that moves from <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{0} \in \mathbb{R}^N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>𝟎</mml:mn><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  to <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{1} \in \mathbb{R}^N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>𝟏</mml:mn><mml:mo>∈</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  in one second, train a DMP on it, and execute the DMP step by step. We
  use <inline-formula><alternatives>
  <tex-math><![CDATA[M]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula>
  weights per dimension, and step through the DMP with
  <inline-formula><alternatives>
  <tex-math><![CDATA[\Delta t = 0.001 s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
  The concept of dmpbbo is to train in Python and run DMPs in C++. We
  still analyze the Python version and the C++ version of dmpbbo as well
  as <italic>movement_primitives</italic> with various implementations
  of the integration (Euler integration with
  <inline-formula><alternatives>
  <tex-math><![CDATA[h=0.1 \cdot \Delta t]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn><mml:mo>⋅</mml:mo><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  and RK4 integration, both in Python and Cython). The default
  integration method of dmpbbo is RK4. Results for varying
  configurations of <inline-formula><alternatives>
  <tex-math><![CDATA[N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[M]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula>
  are summarized in
  <xref alt="[fig:timing_execution_weights]" rid="figU003Atiming_execution_weights">[fig:timing_execution_weights]</xref>,
  <xref alt="[fig:timing_execution_dims]" rid="figU003Atiming_execution_dims">[fig:timing_execution_dims]</xref>
  and
  <xref alt="Table 2" rid="tabU003Abenchmark_results">Table 2</xref>.
  While the number of weights per dimension and the number of dimensions
  have a considerable influence on the runtime of dmpbbo, the influence
  on the runtime of <italic>movement_primitives</italic> is negligible
  because NumPy
  (<xref alt="Harris et al., 2020" rid="ref-Harris2020" ref-type="bibr">Harris
  et al., 2020</xref>) vectorization is used. More specifically,
  computing all steps of a DMP with 1 s duration at 1 kHz
  (<inline-formula><alternatives>
  <tex-math><![CDATA[\Delta t = 0.001 s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>)
  with <inline-formula><alternatives>
  <tex-math><![CDATA[N=50]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  dimensions and <inline-formula><alternatives>
  <tex-math><![CDATA[M=60]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  weights per dimension takes <inline-formula><alternatives>
  <tex-math><![CDATA[0.0822 \pm 0.0015 s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>0.0822</mml:mn><mml:mo>±</mml:mo><mml:mn>0.0015</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  with the <italic>movement_primitives</italic> library and RK4
  integration in Cython, which means <inline-formula><alternatives>
  <tex-math><![CDATA[8.51\%]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>8.51</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  of the DMP’s runtime is spent on computing steps. This allows online
  adaptation of the trajectory. dmpbbo’s C++ implementation is the best
  candidate for a low number of dimensions and weights per dimension. In
  this domain it outperforms all other implementations by a considerable
  margin. However, it scales linearly with these numbers. Hence, it is
  considerably slower for <inline-formula><alternatives>
  <tex-math><![CDATA[N=50]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[M=60]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>60</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  than any RK4 implementation of <italic>movement_primitives</italic>.
  The Python version of dmpbbo is not able to run some configurations in
  real time. For example, <inline-formula><alternatives>
  <tex-math><![CDATA[N=6, M=30]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  needs <inline-formula><alternatives>
  <tex-math><![CDATA[5.9292 \pm 0.0955 s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5.9292</mml:mn><mml:mo>±</mml:mo><mml:mn>0.0955</mml:mn><mml:mi>s</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  to compute.</p>
  <fig>
    <caption><p>Benchmark of execution speed for various DMP
    implementations and configurations. Each bar shows an average over
    100 stepwise executions of a DMP. Varying number of weights per
    dimension <inline-formula><alternatives>
    <tex-math><![CDATA[M]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula>,
    number of dimensions <inline-formula><alternatives>
    <tex-math><![CDATA[N=6]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.<styled-content id="figU003Atiming_execution_weights"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="timing_execution_weights.pdf" />
  </fig>
  <fig>
    <caption><p>Benchmark of execution speed for various DMP
    implementations and configurations. Each bar shows an average over
    100 stepwise executions of a DMP. Varying number of dimensions
    <inline-formula><alternatives>
    <tex-math><![CDATA[N]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>,
    number of weights per dimension <inline-formula><alternatives>
    <tex-math><![CDATA[M=30]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mn>30</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.<styled-content id="figU003Atiming_execution_dims"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="timing_execution_dimensions.pdf" />
  </fig>
  <table-wrap>
    <caption>
      <p>Benchmark results for DMP execution. Best performance per setup
      in
      <bold>bold</bold>.<styled-content id="tabU003Abenchmark_results"></styled-content></p>
    </caption>
    <table>
      <colgroup>
        <col width="28%" />
        <col width="22%" />
        <col width="7%" />
        <col width="7%" />
        <col width="36%" />
      </colgroup>
      <thead>
        <tr>
          <th>Library</th>
          <th>Implementation</th>
          <th><inline-formula><alternatives>
          <tex-math><![CDATA[N]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula></th>
          <th><inline-formula><alternatives>
          <tex-math><![CDATA[M]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula></th>
          <th>Time <inline-formula><alternatives>
          <tex-math><![CDATA[\mu \pm \sigma]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>±</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
          [s]</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>dmpbbo</td>
          <td>C++</td>
          <td>3</td>
          <td>10</td>
          <td><bold>0.0027</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0001</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td><bold>0.0077</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0001</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td><bold>0.0144</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0004</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>6</td>
          <td>10</td>
          <td><bold>0.0049</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0001</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td><bold>0.0146</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0002</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td><bold>0.0300</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0052</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>15</td>
          <td>10</td>
          <td><bold>0.0129</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0028</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td><bold>0.0376</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0059</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td><bold>0.0729</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0103</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>50</td>
          <td>10</td>
          <td><bold>0.0401</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0068</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>0.1236 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0174</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>0.2405 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0308</td>
        </tr>
        <tr>
          <td>dmpbbo</td>
          <td>Python</td>
          <td>3</td>
          <td>10</td>
          <td>0.8137 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0164</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>1.6986 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0319</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>3.0244 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0454</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>6</td>
          <td>10</td>
          <td>1.3946 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0228</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>3.1676 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0746</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>5.9292 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0955</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>15</td>
          <td>10</td>
          <td>3.2079 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0593</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>7.4972 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.1366</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>14.2590 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.2811</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>50</td>
          <td>10</td>
          <td>9.7134 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0448</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>24.6018 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          2.0579</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>47.4420 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          2.0075</td>
        </tr>
        <tr>
          <td>movement_primitives</td>
          <td>euler-cython</td>
          <td>3</td>
          <td>10</td>
          <td>0.1946 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0019</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>0.2223 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0070</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>0.2234 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0031</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>6</td>
          <td>10</td>
          <td>0.1912 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0033</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>0.2301 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0043</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>0.2306 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0060</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>15</td>
          <td>10</td>
          <td>0.2117 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0067</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>0.2334 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0041</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>0.2310 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0013</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>50</td>
          <td>10</td>
          <td>0.2260 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0009</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>0.2547 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0273</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>0.2529 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0044</td>
        </tr>
        <tr>
          <td>movement_primitives</td>
          <td>rk4-cython</td>
          <td>3</td>
          <td>10</td>
          <td>0.0447 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0006</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>0.0737 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0018</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>0.0760 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0003</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>6</td>
          <td>10</td>
          <td>0.0471 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0036</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>0.0733 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0003</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>0.0761 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0003</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>15</td>
          <td>10</td>
          <td>0.0468 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0022</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td>0.0754 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0005</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td>0.0776 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0002</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td>50</td>
          <td>10</td>
          <td>0.0752 <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0002</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>30</td>
          <td><bold>0.0794</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0063</td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td>60</td>
          <td><bold>0.0822</bold> <inline-formula><alternatives>
          <tex-math><![CDATA[\pm]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>±</mml:mo></mml:math></alternatives></inline-formula>
          0.0015</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="conclusion">
  <title>Conclusion</title>
  <p>Although movement primitives are a popular tool in robot learning,
  there is a lack of well maintained implementations in particular for
  bimanual and Cartesian movements. <italic>movement_primitives</italic>
  provides a well-tested, robust implementation of various movement
  primitives with the goal of generating Cartesian robot movements. It
  integrates well with the existing Python scientific ecosystem.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work was supported by a grant of the German Federal Ministry
  of Economic Affairs and Energy (BMWi, FKZ 50 RA 1701) and by the
  European Commission under the Horizon 2020 framework program for
  Research and Innovation (project acronym: APRIL, project number:
  870142).</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-Ijspeert2002">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Ijspeert</surname><given-names>Auke Jan</given-names></name>
        <name><surname>Nakanishi</surname><given-names>Jun</given-names></name>
        <name><surname>Schaal</surname><given-names>Stefan</given-names></name>
      </person-group>
      <article-title>Movement imitation with nonlinear dynamical systems in humanoid robots</article-title>
      <source>Proceedings 2002 IEEE international conference on robotics and automation</source>
      <year iso-8601-date="2002">2002</year>
      <volume>2</volume>
      <pub-id pub-id-type="doi">10.1109/ROBOT.2002.1014739</pub-id>
      <fpage>1398</fpage>
      <lpage>1403</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Pastor2009">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Pastor</surname><given-names>Peter</given-names></name>
        <name><surname>Hoffmann</surname><given-names>Heiko</given-names></name>
        <name><surname>Asfour</surname><given-names>Tamim</given-names></name>
        <name><surname>Schaal</surname><given-names>Stefan</given-names></name>
      </person-group>
      <article-title>Learning and generalization of motor skills by learning from demonstration</article-title>
      <source>2009 IEEE international conference on robotics and automation</source>
      <year iso-8601-date="2009">2009</year>
      <volume></volume>
      <pub-id pub-id-type="doi">10.1109/ROBOT.2009.5152385</pub-id>
      <fpage>763</fpage>
      <lpage>768</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Ijspeert2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ijspeert</surname><given-names>Auke Jan</given-names></name>
        <name><surname>Nakanishi</surname><given-names>Jun</given-names></name>
        <name><surname>Hoffmann</surname><given-names>Heiko</given-names></name>
        <name><surname>Pastor</surname><given-names>Peter</given-names></name>
        <name><surname>Schaal</surname><given-names>Stefan</given-names></name>
      </person-group>
      <article-title>Dynamical movement primitives: Learning attractor models for motor behaviors</article-title>
      <source>Neural Computation</source>
      <year iso-8601-date="2013">2013</year>
      <volume>25</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1162/NECO_a_00393</pub-id>
      <fpage>328</fpage>
      <lpage>373</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Muelling2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mülling</surname><given-names>Katharina</given-names></name>
        <name><surname>Kober</surname><given-names>Jens</given-names></name>
        <name><surname>Kroemer</surname><given-names>Oliver</given-names></name>
        <name><surname>Peters</surname><given-names>Jan</given-names></name>
      </person-group>
      <article-title>Learning to select and generalize striking movements in robot table tennis</article-title>
      <source>The International Journal of Robotics Research</source>
      <year iso-8601-date="2013">2013</year>
      <volume>32</volume>
      <issue>3</issue>
      <uri>https://doi.org/10.1177/0278364912472380</uri>
      <pub-id pub-id-type="doi">10.1177/0278364912472380</pub-id>
      <fpage>263</fpage>
      <lpage>279</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Gams2013">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Gams</surname><given-names>Andrej</given-names></name>
        <name><surname>Nemec</surname><given-names>Bojan</given-names></name>
        <name><surname>Zlajpah</surname><given-names>Leon</given-names></name>
        <name><surname>Wächter</surname><given-names>Mirko</given-names></name>
        <name><surname>Ijspeert</surname><given-names>Auke</given-names></name>
        <name><surname>Asfour</surname><given-names>Tamim</given-names></name>
        <name><surname>Ude</surname><given-names>Ales</given-names></name>
      </person-group>
      <article-title>Modulation of motor primitives using force feedback: Interaction with the environment and bimanual tasks</article-title>
      <source>2013 IEEE/RSJ international conference on intelligent robots and systems</source>
      <year iso-8601-date="2013">2013</year>
      <pub-id pub-id-type="doi">10.1109/IROS.2013.6697172</pub-id>
      <fpage>5629</fpage>
      <lpage>5635</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Ude2014">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Ude</surname><given-names>Aleš</given-names></name>
        <name><surname>Nemec</surname><given-names>Bojan</given-names></name>
        <name><surname>Petrić</surname><given-names>Tadej</given-names></name>
        <name><surname>Morimoto</surname><given-names>Jun</given-names></name>
      </person-group>
      <article-title>Orientation in cartesian space dynamic movement primitives</article-title>
      <source>2014 IEEE international conference on robotics and automation (ICRA)</source>
      <year iso-8601-date="2014">2014</year>
      <volume></volume>
      <pub-id pub-id-type="doi">10.1109/ICRA.2014.6907291</pub-id>
      <fpage>2997</fpage>
      <lpage>3004</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Fabisch2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fabisch</surname><given-names>Alexander</given-names></name>
        <name><surname>Metzen</surname><given-names>Jan Hendrik</given-names></name>
      </person-group>
      <article-title>Active contextual policy search</article-title>
      <source>Journal of Machine Learning Research</source>
      <year iso-8601-date="2014">2014</year>
      <volume>15</volume>
      <issue>97</issue>
      <uri>http://jmlr.org/papers/v15/fabisch14a.html</uri>
      <fpage>3371</fpage>
      <lpage>3399</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Paraschos2013">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Paraschos</surname><given-names>Alexandros</given-names></name>
        <name><surname>Daniel</surname><given-names>Christian</given-names></name>
        <name><surname>Peters</surname><given-names>Jan R</given-names></name>
        <name><surname>Neumann</surname><given-names>Gerhard</given-names></name>
      </person-group>
      <article-title>Probabilistic movement primitives</article-title>
      <source>Advances in neural information processing systems</source>
      <person-group person-group-type="editor">
        <name><surname>Burges</surname><given-names>C. J.</given-names></name>
        <name><surname>Bottou</surname><given-names>L.</given-names></name>
        <name><surname>Welling</surname><given-names>M.</given-names></name>
        <name><surname>Ghahramani</surname><given-names>Z.</given-names></name>
        <name><surname>Weinberger</surname><given-names>K. Q.</given-names></name>
      </person-group>
      <publisher-name>Curran Associates, Inc.</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>26</volume>
      <uri>https://proceedings.neurips.cc/paper_files/paper/2013/file/e53a0a2978c28872a4505bdb51db06dc-Paper.pdf</uri>
      <fpage></fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Maeda2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Maeda</surname><given-names>Guilherme J.</given-names></name>
        <name><surname>Neumann</surname><given-names>Gerhard</given-names></name>
        <name><surname>Ewerton</surname><given-names>Marco</given-names></name>
        <name><surname>Lioutikov</surname><given-names>Rudolf</given-names></name>
        <name><surname>Kroemer</surname><given-names>Oliver</given-names></name>
        <name><surname>Peters</surname><given-names>Jan</given-names></name>
      </person-group>
      <article-title>Probabilistic movement primitives for coordination of multiple human–robot collaborative tasks</article-title>
      <source>Autonomous Robots</source>
      <year iso-8601-date="2017">2017</year>
      <volume>41</volume>
      <pub-id pub-id-type="doi">10.1007/s10514-016-9556-2</pub-id>
      <fpage>593</fpage>
      <lpage>612</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Fabisch2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fabisch</surname><given-names>Alexander</given-names></name>
      </person-group>
      <article-title>pytransform3d: 3D transformations for python</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>33</issue>
      <uri>https://doi.org/10.21105/joss.01159</uri>
      <pub-id pub-id-type="doi">10.21105/joss.01159</pub-id>
      <fpage>1159</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zhou2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhou</surname><given-names>Qian-Yi</given-names></name>
        <name><surname>Park</surname><given-names>Jaesik</given-names></name>
        <name><surname>Koltun</surname><given-names>Vladlen</given-names></name>
      </person-group>
      <article-title>Open3D: A modern library for 3D data processing</article-title>
      <source>arXiv:1801.09847</source>
      <year iso-8601-date="2018">2018</year>
    </element-citation>
  </ref>
  <ref id="ref-Saveriano2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Saveriano</surname><given-names>Matteo</given-names></name>
        <name><surname>Abu-Dakka</surname><given-names>Fares J</given-names></name>
        <name><surname>Kramberger</surname><given-names>Aljaž</given-names></name>
        <name><surname>Peternel</surname><given-names>Luka</given-names></name>
      </person-group>
      <article-title>Dynamic movement primitives in robotics: A tutorial survey</article-title>
      <source>The International Journal of Robotics Research</source>
      <year iso-8601-date="2023">2023</year>
      <pub-id pub-id-type="doi">10.1177/02783649231201196</pub-id>
      <fpage>02783649231201196</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Stulp2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Stulp</surname><given-names>Freek</given-names></name>
        <name><surname>Raiola</surname><given-names>Gennaro</given-names></name>
      </person-group>
      <article-title>DmpBbo: A versatile python/c++ library for function approximation, dynamical movement primitives, and black-box optimization</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>37</issue>
      <uri>https://doi.org/10.21105/joss.01225</uri>
      <pub-id pub-id-type="doi">10.21105/joss.01225</pub-id>
      <fpage>1225</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Fabisch2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fabisch</surname><given-names>Alexander</given-names></name>
        <name><surname>Langosz</surname><given-names>Malte</given-names></name>
        <name><surname>Kirchner</surname><given-names>Frank</given-names></name>
      </person-group>
      <article-title>BOLeRo: Behavior optimization and learning for robots</article-title>
      <source>International Journal of Advanced Robotic Systems</source>
      <year iso-8601-date="2020">2020</year>
      <volume>17</volume>
      <issue>3</issue>
      <uri>https://doi.org/10.1177/1729881420913741</uri>
      <pub-id pub-id-type="doi">10.1177/1729881420913741</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Coumans2021">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Coumans</surname><given-names>Erwin</given-names></name>
        <name><surname>Bai</surname><given-names>Yunfei</given-names></name>
      </person-group>
      <article-title>PyBullet, a python module for physics simulation for games, robotics and machine learning</article-title>
      <publisher-name>http://pybullet.org</publisher-name>
    </element-citation>
  </ref>
  <ref id="ref-Mronga2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mronga</surname><given-names>Dennis</given-names></name>
        <name><surname>Kirchner</surname><given-names>Frank</given-names></name>
      </person-group>
      <article-title>Learning context-adaptive task constraints for robotic manipulation</article-title>
      <source>Robotics and Autonomous Systems</source>
      <year iso-8601-date="2021">2021</year>
      <volume>141</volume>
      <issn>0921-8890</issn>
      <pub-id pub-id-type="doi">10.1016/j.robot.2021.103779</pub-id>
      <fpage>103779</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Mronga2022">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Mronga</surname><given-names>Dennis</given-names></name>
      </person-group>
      <article-title>Learning task constraints for whole-body control of robotic systems</article-title>
      <year iso-8601-date="2022">2022</year>
      <pub-id pub-id-type="doi">10.26092/elib/1547</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Harris2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harris</surname><given-names>Charles R.</given-names></name>
        <name><surname>Millman</surname><given-names>K. Jarrod</given-names></name>
        <name><surname>Walt</surname><given-names>Stéfan J. van der</given-names></name>
        <name><surname>Gommers</surname><given-names>Ralf</given-names></name>
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>Cournapeau</surname><given-names>David</given-names></name>
        <name><surname>Wieser</surname><given-names>Eric</given-names></name>
        <name><surname>Taylor</surname><given-names>Julian</given-names></name>
        <name><surname>Berg</surname><given-names>Sebastian</given-names></name>
        <name><surname>Smith</surname><given-names>Nathaniel J.</given-names></name>
        <name><surname>Kern</surname><given-names>Robert</given-names></name>
        <name><surname>Picus</surname><given-names>Matti</given-names></name>
        <name><surname>Hoyer</surname><given-names>Stephan</given-names></name>
        <name><surname>Kerkwijk</surname><given-names>Marten H. van</given-names></name>
        <name><surname>Brett</surname><given-names>Matthew</given-names></name>
        <name><surname>Haldane</surname><given-names>Allan</given-names></name>
        <name><surname>Río</surname><given-names>Jaime Fernández del</given-names></name>
        <name><surname>Wiebe</surname><given-names>Mark</given-names></name>
        <name><surname>Peterson</surname><given-names>Pearu</given-names></name>
        <name><surname>Gérard-Marchant</surname><given-names>Pierre</given-names></name>
        <name><surname>Sheppard</surname><given-names>Kevin</given-names></name>
        <name><surname>Reddy</surname><given-names>Tyler</given-names></name>
        <name><surname>Weckesser</surname><given-names>Warren</given-names></name>
        <name><surname>Abbasi</surname><given-names>Hameer</given-names></name>
        <name><surname>Gohlke</surname><given-names>Christoph</given-names></name>
        <name><surname>Oliphant</surname><given-names>Travis E.</given-names></name>
      </person-group>
      <article-title>Array programming with NumPy</article-title>
      <source>Nature</source>
      <publisher-name>Springer Science; Business Media LLC</publisher-name>
      <year iso-8601-date="2020-09">2020</year><month>09</month>
      <volume>585</volume>
      <issue>7825</issue>
      <uri>https://doi.org/10.1038/s41586-020-2649-2</uri>
      <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
      <fpage>357</fpage>
      <lpage>362</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Boukheddimi2022">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Boukheddimi</surname><given-names>Melya</given-names></name>
        <name><surname>Kumar</surname><given-names>Shivesh</given-names></name>
        <name><surname>Peters</surname><given-names>Heiner</given-names></name>
        <name><surname>Mronga</surname><given-names>Dennis</given-names></name>
        <name><surname>Budhiraja</surname><given-names>Rohan</given-names></name>
        <name><surname>Kirchner</surname><given-names>Frank</given-names></name>
      </person-group>
      <article-title>Introducing RH5 manus: A powerful humanoid upper body design for dynamic movements</article-title>
      <source>2022 international conference on robotics and automation (ICRA)</source>
      <year iso-8601-date="2022">2022</year>
      <volume></volume>
      <pub-id pub-id-type="doi">10.1109/ICRA46639.2022.9811843</pub-id>
      <fpage>01</fpage>
      <lpage>07</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Dalcin2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dalcin</surname><given-names>L.</given-names></name>
        <name><surname>Bradshaw</surname><given-names>R.</given-names></name>
        <name><surname>Smith</surname><given-names>K.</given-names></name>
        <name><surname>Citro</surname><given-names>C.</given-names></name>
        <name><surname>Behnel</surname><given-names>S.</given-names></name>
        <name><surname>Seljebotn</surname><given-names>D.</given-names></name>
      </person-group>
      <article-title>Cython: The best of both worlds</article-title>
      <source>Computing in Science &amp; Engineering</source>
      <publisher-name>IEEE Computer Society</publisher-name>
      <publisher-loc>Los Alamitos, CA, USA</publisher-loc>
      <year iso-8601-date="2011-03">2011</year><month>03</month>
      <volume>13</volume>
      <issue>02</issue>
      <issn>1558-366X</issn>
      <pub-id pub-id-type="doi">10.1109/MCSE.2010.118</pub-id>
      <fpage>31</fpage>
      <lpage>39</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
