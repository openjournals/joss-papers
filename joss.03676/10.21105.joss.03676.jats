<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">3676</article-id>
<article-id pub-id-type="doi">10.21105/joss.03676</article-id>
<title-group>
<article-title><monospace>WODEN</monospace>: A CUDA-enabled package to
simulate low-frequency radio interferometric data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-9130-5920</contrib-id>
<name>
<surname>Line</surname>
<given-names>Jack L. B.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>International Centre for Radio Astronomy Research, Curtin
Institute of Radio Astronomy, Perth, WA 6102, Australia</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>ARC Centre of Excellence for All Sky Astrophysics in 3
Dimensions (ASTRO 3D)</institution>
</institution-wrap>
</aff>
</contrib-group>
<volume>7</volume>
<issue>69</issue>
<fpage>3676</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>C</kwd>
<kwd>CUDA</kwd>
<kwd>radio astronomy</kwd>
<kwd>interferometers</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>WODEN</monospace> is designed to simulate the response
  of a class of telescope known as an interferometer, producing output
  ‚Äúvisibilities‚Äù for a given astrophysical sky model. Simulated
  observations allow us to test other software packages that are
  designed to calibrate and analyse real interferometric data, including
  verifying expected behaviour with known inputs, and testing new sky
  modelling techniques. The <monospace>WODEN</monospace> sky model can
  be specified in Dirac-delta like functions on the sky (known in the
  field as ‚Äúpoint sources‚Äù), elliptical Gaussian models, or built out of
  ‚Äúshapelet‚Äù basis functions, allowing complicated morphologies to be
  created. Users are able to input a bespoke layout for the
  interferometer, vary a number of observational parameters including
  time of day, length of observation and frequency coverage, and select
  from a number of predefined primary beams which encode the response of
  the receiving elements of an interferometer. This allows simulations
  of a number of telescopes to be undertaken.
  <monospace>WODEN</monospace> works with input Stokes
  <inline-formula><alternatives>
  <tex-math><![CDATA[I,Q,U,V]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  polarisations as a sky model, simulating telescopes with dual linear
  polarisations, and outputting linear Stokes polarisations.</p>
  <p>The core functionality of <monospace>WODEN</monospace> is written
  in CUDA as interferometric simulations are computationally intensive
  but embarrassingly parallel. The performance of CUDA allows for
  large-scale simulations to be run including emission from all
  directions in the sky. This is paramount for interferometers with a
  wide field of view such as the Murchison Widefield Array (MWA,
  <xref alt="Tingay et al., 2013" rid="ref-Tingay2013" ref-type="bibr">Tingay
  et al., 2013</xref>). A Python wrapper is used to take advantage of
  community packages such as
  <ext-link ext-link-type="uri" xlink:href="https://www.astropy.org/">astropy</ext-link>
  (<xref alt="Astropy Collaboration et al., 2018" rid="ref-astropy2018" ref-type="bibr">Astropy
  Collaboration et al., 2018</xref>,
  <xref alt="2013" rid="ref-astropy2013" ref-type="bibr">2013</xref>)
  and
  <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/pyerfa/">pyerfa</ext-link>
  (<xref alt="van Kerkwijk et al., 2020" rid="ref-pyerfa" ref-type="bibr">van
  Kerkwijk et al., 2020</xref>) and to present a user-friendly interface
  to <monospace>WODEN</monospace>. Those simulating MWA observations can
  use the MWA <monospace>metafits</monospace> file to quickly feed in
  observational parameters to <monospace>WODEN</monospace> to match real
  data.</p>
  <p><monospace>WODEN</monospace> can be run to two levels of precision:
  a <monospace>woden_float</monospace> precision (which uses a mix of 32
  and 64 bit floating precision), and a
  <monospace>woden_double</monospace> (which uses nearly entirely 64 bit
  precision). In the section titled ‚ÄúEstimation of accuracy and
  computational speed‚Äù below, <monospace>WODEN</monospace> is shown to
  produce visibilities to within 0.2% of the expected values when
  running in <monospace>woden_float</monospace> mode, and 0.000002% in
  <monospace>woden_double</monospace> mode, for baselines of length
  <inline-formula><alternatives>
  <tex-math><![CDATA[\le 10]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚â§</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>km.</p>
</sec>
<sec id="underlying-methodolgy">
  <title>Underlying methodolgy</title>
  <p>An interferometer creates visibilities
  <inline-formula><alternatives>
  <tex-math><![CDATA[V]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>V</mml:mi></mml:math></alternatives></inline-formula>
  by cross-correlating signals detected between pairs of antennas or
  dishes (baselines), described by coordinates
  <inline-formula><alternatives>
  <tex-math><![CDATA[u,v,w]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
  Each visibility is sensitive to the entire sky, directions of which we
  describe by the direction cosines <inline-formula><alternatives>
  <tex-math><![CDATA[l,m,n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
  Ignoring the antenna response, the full integral over the sky can be
  discretised as</p>
  <p><named-content id="eqU003ARIME" content-type="equation"><disp-formula><tex-math><![CDATA[
  V_s(u_i,v_i,w_i) = \\ \sum_j \mathcal{S}_s(l_j,m_j) \exp[-2\pi i(u_il_j + v_im_j + w_i(n_j-1))],]]></tex-math></disp-formula></named-content></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[u_i,v_i,w_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  are the visibility coordinates of the <inline-formula><alternatives>
  <tex-math><![CDATA[i^{\mathrm{th}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>i</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mstyle></mml:msup></mml:math></alternatives></inline-formula>
  baseline, <inline-formula><alternatives>
  <tex-math><![CDATA[l_j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[m_j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[n_j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the sky position of the <inline-formula><alternatives>
  <tex-math><![CDATA[j^{\mathrm{th}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>j</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mstyle></mml:msup></mml:math></alternatives></inline-formula>
  component in the sky model, and <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{S}(l_j,m_j)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="script"><mml:mi>ùíÆ</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is the flux density of that component in a given Stokes polarisation
  <inline-formula><alternatives>
  <tex-math><![CDATA[s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>s</mml:mi></mml:math></alternatives></inline-formula>.
  <monospace>WODEN</monospace> simulates dual-linear polarisation
  antennas, with each antenna/station having its own primary beam shape.
  I can define the response of a dual polarisation antenna to direction
  <inline-formula><alternatives>
  <tex-math><![CDATA[l,m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  as</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  \mathbf{J}(l,m) =
  \begin{bmatrix}
  g_{\mathrm{ns}}(l,m) & D_{\mathrm{ns}}(l,m) \\
  D_{\mathrm{ew}}(l,m) & g_{\mathrm{ew}}(l,m)
  \end{bmatrix},
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ùêâ</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>g</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>D</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>D</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>g</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[g]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>g</mml:mi></mml:math></alternatives></inline-formula>
  are gain terms, <inline-formula><alternatives>
  <tex-math><![CDATA[D]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>D</mml:mi></mml:math></alternatives></inline-formula>
  are leakage terms, and <inline-formula><alternatives>
  <tex-math><![CDATA[\mathrm{ns}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
  refers to north-south and <inline-formula><alternatives>
  <tex-math><![CDATA[\mathrm{ew}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="normal"><mml:mi>e</mml:mi><mml:mi>w</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
  east-west aligned antennas. When calculating the cross-correlation
  responses from antennas 1 and 2 towards direction
  <inline-formula><alternatives>
  <tex-math><![CDATA[l,m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  to produce linear polarisation visibilities, these gains and leakages
  interact with the four Stokes polarisations
  <inline-formula><alternatives>
  <tex-math><![CDATA[I,Q,U,V]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>U</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  as</p>
  <p><named-content id="eqU003ARIME_full" content-type="equation"><disp-formula><alternatives>
  <tex-math><![CDATA[
  \begin{bmatrix}
  V_{12\,XX}(l,m) \\
  V_{12\,XY}(l,m) \\
  V_{12\,YX}(l,m) \\
  V_{12\,YY}(l,m)
  \end{bmatrix} =
  \mathbf{J}_1(l,m) \otimes \mathbf{J}_2^*(l,m)
  \begin{bmatrix}
  1 & 1 & 0 & 0 \\
  0 & 0 & 1 & i \\
  0 & 0 & 1 & -i \\
  1 & -1 & 0 & 0
  \end{bmatrix}
  \begin{bmatrix}
  V_{12\,I}(l,m) \\
  V_{12\,Q}(l,m) \\
  V_{12\,U}(l,m) \\
  V_{12\,V}(l,m)
  \end{bmatrix}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mspace width="0.167em"></mml:mspace><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mspace width="0.167em"></mml:mspace><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mspace width="0.167em"></mml:mspace><mml:mi>Y</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mspace width="0.167em"></mml:mspace><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathvariant="bold"><mml:mi>ùêâ</mml:mi></mml:mstyle><mml:mn>1</mml:mn></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>‚äó</mml:mo><mml:msubsup><mml:mstyle mathvariant="bold"><mml:mi>ùêâ</mml:mi></mml:mstyle><mml:mn>2</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mi>i</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>‚àí</mml:mo><mml:mi>i</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mspace width="0.167em"></mml:mspace><mml:mi>I</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mspace width="0.167em"></mml:mspace><mml:mi>Q</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mspace width="0.167em"></mml:mspace><mml:mi>U</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mn>12</mml:mn><mml:mspace width="0.167em"></mml:mspace><mml:mi>V</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></named-content></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[*]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>*</mml:mo></mml:math></alternatives></inline-formula>
  denotes a complex conjugate, and <inline-formula><alternatives>
  <tex-math><![CDATA[\otimes]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mo>‚äó</mml:mo></mml:math></alternatives></inline-formula>
  an outer product (the result of this outer product is written
  explicitly in the <monospace>WODEN</monospace> documentation
  <ext-link ext-link-type="uri" xlink:href="https://woden.readthedocs.io/en/joss_review/operating_principles/visibility_calcs.html">here</ext-link>).
  For each baseline, frequency, and time step,
  <monospace>WODEN</monospace> calculates all four linear Stokes
  polarisations (<inline-formula><alternatives>
  <tex-math><![CDATA[V_{XX}, V_{XY}, V_{YX}, V_{YY}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>X</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>Y</mml:mi><mml:mi>Y</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>)
  as defined above for all <inline-formula><alternatives>
  <tex-math><![CDATA[l_j,m_j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  in the sky model, and then sums over <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>,
  to produce four full-sky linear Stokes polarisation visibilities per
  baseline/frequency/time.</p>
  <p>For a telescope like the MWA, the primary beam
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{J}(l,m)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mi>ùêâ</mml:mi></mml:mstyle><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is a complicated pattern on the sky, which is sensitive to emission
  from directly overhead to all the way down to the horizon. To truly
  capture the effects of astrophysical foregrounds we therefore have to
  simulate the entire sky. The MWA Fully Embedded Element (FEE,
  <xref alt="Sokolowski et al., 2017" rid="ref-Sokolowski2017" ref-type="bibr">Sokolowski
  et al., 2017</xref>) model is currently the most accurate
  representation of the MWA primary beam, and is incorporated into
  <monospace>WODEN</monospace>.</p>
  <p>As the sky model of <monospace>WODEN</monospace> is a list of Right
  Ascension and Declinations with associated flux densities, the user
  has full control over the projection of the sky into visibilities. To
  simulate discrete foregrounds, one can simply input any sky catalogue
  specified in RA/Dec.¬†For diffuse sky models, one could for example
  input a list of point source/elliptical Gaussians following the
  HEALPix projection
  (<xref alt="G√≥rski et al., 2005" rid="ref-HEALPix2005" ref-type="bibr">G√≥rski
  et al., 2005</xref>), or employ a TAN or SIN FITS
  (<xref alt="Calabretta &amp; Greisen, 2002" rid="ref-FITS2002" ref-type="bibr">Calabretta
  &amp; Greisen, 2002</xref>) projection. <monospace>WODEN</monospace>
  will simply calculate the measurement equation for all directions in
  the sky model.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Under this discrete sky formalism, upwards of
  <inline-formula><alternatives>
  <tex-math><![CDATA[j\ge25\times10^6]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>j</mml:mi><mml:mo>‚â•</mml:mo><mml:mn>25</mml:mn><mml:mo>√ó</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  components can be required to achieve the angular resolution required.
  Furthermore, <inline-formula><alternatives>
  <tex-math><![CDATA[u,v,w]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  are time and frequency dependent, so to sample in frequency of order
  500 times and 100 samples in time, there are of order
  <inline-formula><alternatives>
  <tex-math><![CDATA[10^{12}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mn>10</mml:mn><mml:mn>12</mml:mn></mml:msup></mml:math></alternatives></inline-formula>
  visibility calculations to make. This makes CUDA acceleration
  paramount.</p>
  <p>Alternative approaches to interferometric simulations exist, such
  as
  <ext-link ext-link-type="uri" xlink:href="https://github.com/RadioAstronomySoftwareGroup/pyuvsim">pyuvsim</ext-link>
  (<xref alt="Lanman et al., 2019" rid="ref-Lanman2019" ref-type="bibr">Lanman
  et al., 2019</xref>), which sacrifices speed for excellent precision,
  and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/upenneor/rimez">RIMEz</ext-link>,
  which decomposes the sky into spherical harmonics rather than discrete
  points. <monospace>WODEN</monospace> was designed with the Australian
  MWA Epoch of Reionisation (EoR) processing pipeline in mind, which
  uses a calibration and foreground removal software called the
  <monospace>RTS</monospace>
  (<xref alt="Mitchell et al., 2008" rid="ref-Mitchell2008" ref-type="bibr">Mitchell
  et al., 2008</xref>) in search of signals from the very first stars
  (see
  <xref alt="Yoshiura et al., 2021" rid="ref-Yoshiura2021" ref-type="bibr">Yoshiura
  et al., 2021</xref> for a recent use of this pipeline). The
  <monospace>RTS</monospace> creates a sky model using the same
  formalism above, however the code is not optimised enough to handle
  the volume of sources to simulate the entire sky. To test the
  <monospace>RTS</monospace> method of sky generation, we therefore
  needed a fast and discretised method. Another excellent CUDA
  accelerated simulation package,
  <ext-link ext-link-type="uri" xlink:href="https://github.com/OxfordSKA/OSKAR">OSKAR</ext-link>
  (<xref alt="Mort et al., 2010" rid="ref-OSKAR" ref-type="bibr">Mort et
  al., 2010</xref>), addresses these two points. However, the
  <monospace>RTS</monospace> also generates parts of the sky model via
  shapelets (see
  <xref alt="Line et al., 2020" rid="ref-Line2020" ref-type="bibr">Line
  et al., 2020</xref> for an overview), which
  <monospace>OSKAR</monospace> cannot. Furthermore, in real data, the
  precession/nutation of the Earth‚Äôs rotational axis causes sources to
  move from the sky coordinates as specified in the RA, DEC J2000
  coordinate system. The <monospace>RTS</monospace> is designed to undo
  this precession/nutation, and so a simulation fed into the
  <monospace>RTS</monospace> should <italic>contain</italic> precession.
  <monospace>WODEN</monospace> adds in this precession using the same
  method as the <monospace>RTS</monospace> to be consistent. This unique
  combination of CUDA, shapelet foregrounds, the MWA FEE primary beam,
  along with source precession, created the need for
  <monospace>WODEN</monospace>. These effects should not preclude other
  calibration packages from using <monospace>WODEN</monospace> outputs
  however, meaning <monospace>WODEN</monospace> is not limited to
  feeding data into the <monospace>RTS</monospace> alone.</p>
</sec>
<sec id="estimation-of-accuracy-and-computational-speed">
  <title>Estimation of accuracy and computational speed</title>
  <p>The goal of this section is to test the accuracy of the
  functionality of <monospace>WODEN</monospace>, including reading of
  inputs, the array coordinate calculations, the precession/nutation
  correction, <inline-formula><alternatives>
  <tex-math><![CDATA[l,m,n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[u,v,w]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  calculations, flux density frequency extrapolation via spectral index,
  calculation of Equation <xref alt="2" rid="eqU003ARIME_full">2</xref>,
  and writing out of the data to <monospace>uvfits</monospace>
  files.</p>
  <p>To test the absolute accuracy of <monospace>WODEN</monospace>, we
  first need a set of input parameters that have an analytically
  predictable outcome. If we ignore the beam response and polarisation,
  set the flux density of a source to one, and consider a single
  baseline and sky direction, the measurement equation (Equation
  <xref alt="1" rid="eqU003ARIME">1</xref>)
  becomes<xref ref-type="fn" rid="fn1">1</xref></p>
  <p><named-content id="eqU003ARIME_simple" content-type="equation"><disp-formula><alternatives>
  <tex-math><![CDATA[
  V(u,v,w) = \exp[2\pi i(ul + vm + w(n-1))].]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></named-content></p>
  <p>We can use Euler‚Äôs formula to split <inline-formula><alternatives>
  <tex-math><![CDATA[V]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>V</mml:mi></mml:math></alternatives></inline-formula>
  into real and imaginary components. If I label the phase for a
  particular source and baseline as</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
    \phi = 2\pi \left( ul + vm + w(n-1)\right)
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œï</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>v</mml:mi><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>w</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>then the real and imaginary parts of the visibility
  <inline-formula><alternatives>
  <tex-math><![CDATA[V_{re}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[V_{im}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  are</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
    V_{re} = \cos(\phi), \quad V_{im} = \sin(\phi).
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>œï</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="1.0em"></mml:mspace><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>œï</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>If we can therefore set <inline-formula><alternatives>
  <tex-math><![CDATA[\phi]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>œï</mml:mi></mml:math></alternatives></inline-formula>
  to a number of values which produce known sine and cosine outputs, by
  selecting specific combinations of <inline-formula><alternatives>
  <tex-math><![CDATA[u,v,w]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[l,m,n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
  we can simulate visibilities with predictable outputs. First of all,
  consider the simplified case <inline-formula><alternatives>
  <tex-math><![CDATA[\phi_{\mathrm{simple}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub></mml:math></alternatives></inline-formula>
  when <inline-formula><alternatives>
  <tex-math><![CDATA[u,v,w = 1,1,1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
  In that case,</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
    \frac{\phi_{\mathrm{simple}}}{2\pi} = l + m + (n-1).
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mfrac><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>If we further set <inline-formula><alternatives>
  <tex-math><![CDATA[l = m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
  we end up with</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  \begin{aligned}
    \frac{\phi_{\mathrm{simple}}}{2\pi} = 2l + (n-1), \\
    l = \sqrt{\left( \frac{1 - n^2}{2} \right)}
  \end{aligned}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mrow><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>‚àí</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msqrt></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
  <p>It can be shown (via
  <ext-link ext-link-type="uri" xlink:href="https://www.wolframalpha.com/widgets/view.jsp?id=c07cc70f1e81887dfd0971d3fe17cfcd">Wolfram
  Alpha</ext-link>) that a solution for <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>
  is</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
    n = \frac{\sqrt{2}\sqrt{-\phi_{\mathrm{simple}}^2 - 4\pi\phi_{\mathrm{simple}} + 8\pi^2} + \phi_{\mathrm{simple}} + 2\pi}{6\pi}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:msqrt><mml:mrow><mml:mo>‚àí</mml:mo><mml:msubsup><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle><mml:mn>2</mml:mn></mml:msubsup><mml:mo>‚àí</mml:mo><mml:mn>4</mml:mn><mml:mi>œÄ</mml:mi><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mo>+</mml:mo><mml:mn>8</mml:mn><mml:msup><mml:mi>œÄ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt><mml:mo>+</mml:mo><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi></mml:mrow><mml:mrow><mml:mn>6</mml:mn><mml:mi>œÄ</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>which we can then use to calculate values for
  <inline-formula><alternatives>
  <tex-math><![CDATA[l,m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  through</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
    l = m = \sqrt{\frac{1 - n^2}{2}}.
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:msqrt><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>‚àí</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:msqrt><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>Practically then, if we input the following combinations of
  <inline-formula><alternatives>
  <tex-math><![CDATA[l,m,n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  into Equation <xref alt="3" rid="eqU003ARIME_simple">3</xref> our
  output visibilities should exactly match the
  <inline-formula><alternatives>
  <tex-math><![CDATA[\cos(\phi)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>œï</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[\sin(\phi)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>œï</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  values.</p>
  <boxed-text>
    <boxed-text id="tabU003Almn_combos">
      <table-wrap>
        <caption>
          <p><inline-formula><alternatives>
          <tex-math><![CDATA[l,m,n]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
          combinations used in accuracy test</p>
        </caption>
        <table>
          <thead>
            <tr>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\phi_{\mathrm{simple}}]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub></mml:math></alternatives></inline-formula></th>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[l,m]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></th>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[n]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula></th>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\cos(\phi)]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>œï</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></th>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\sin(\phi)]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>sin</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>œï</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[0]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula></td>
              <td align="center">0.0</td>
              <td align="center">1.0</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[1.0]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>1.0</mml:mn></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[0]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi/6]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">0.0425737516338956</td>
              <td align="center">0.9981858300655398</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\sqrt{3}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[0.5]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0.5</mml:mn></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi/4]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">0.0645903244635131</td>
              <td align="center">0.9958193510729726</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\sqrt{2}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\sqrt{2}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi/3]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">0.0871449863555500</td>
              <td align="center">0.9923766939555675</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[0.5]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0.5</mml:mn></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\sqrt{3}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">0.1340695840364469</td>
              <td align="center">0.9818608319271057</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[0.0]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0.0</mml:mn></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[1.0]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>1.0</mml:mn></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[2\pi/3]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">0.1838657911209207</td>
              <td align="center">0.9656017510914922</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[-0.5]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚àí</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\sqrt{3}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[3\pi/4]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>3</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">0.2100755148372292</td>
              <td align="center">0.9548489703255412</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[-\sqrt{2}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚àí</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\sqrt{2}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[5\pi/6]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">0.2373397982598921</td>
              <td align="center">0.9419870701468823</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[-\sqrt{3}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚àí</mml:mo><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[0.5]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0.5</mml:mn></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>œÄ</mml:mi></mml:math></alternatives></inline-formula></td>
              <td align="center">0.2958758547680685</td>
              <td align="center">0.9082482904638630</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[-1.0]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚àí</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[0.0]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0.0</mml:mn></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[7\pi/6]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>7</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">0.3622725654470420</td>
              <td align="center">0.8587882024392495</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[-\sqrt{3}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚àí</mml:mo><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[-0.5]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚àí</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[5\pi/4]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">0.4003681253515569</td>
              <td align="center">0.8242637492968862</td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[-\sqrt{2}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚àí</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[-\sqrt{2}/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚àí</mml:mo><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
  </boxed-text>
  <p>To test for a range of baseline lengths, we can make a
  simplification where we set all baseline coordinates to be equal,
  i.e.¬†<inline-formula><alternatives>
  <tex-math><![CDATA[u = v = w = b]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[b]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>b</mml:mi></mml:math></alternatives></inline-formula>
  is some length in units of wavelength. In this form, the phase
  including the baseline length <inline-formula><alternatives>
  <tex-math><![CDATA[\phi_{b}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œï</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
    \phi_{b} = 2\pi b\left( l + m + n - 1 \right) = b\phi_{\mathrm{simple}}.
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>œï</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:mo>‚àí</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>As sine/cosine are periodic functions, the following is true:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
    \phi_{\mathrm{simple}} = \phi_{\mathrm{simple}} + 2\pi \mathrm{n}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\mathrm{n}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
  is some integer. This means for a given <inline-formula><alternatives>
  <tex-math><![CDATA[\phi_{\mathrm{simple}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub></mml:math></alternatives></inline-formula>,
  we can find an appropriate <inline-formula><alternatives>
  <tex-math><![CDATA[b]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>b</mml:mi></mml:math></alternatives></inline-formula>
  that should still result in the expected sine and cosine outputs by
  setting</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[\begin{gathered}
    b\phi_{\mathrm{simple}} = \phi_{\mathrm{simple}} + 2\pi \mathrm{n}, \\
    b = \frac{\phi_{\mathrm{simple}} + 2\pi \mathrm{n}}{\phi_{\mathrm{simple}}}
  \end{gathered}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mi>b</mml:mi><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi></mml:mstyle><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center"><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi></mml:mstyle></mml:mrow><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
  <p>for a range of <inline-formula><alternatives>
  <tex-math><![CDATA[\mathrm{n}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
  values. The values of <inline-formula><alternatives>
  <tex-math><![CDATA[\mathrm{n}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>
  and the resultant size of b that I use in testing are shown in Table
  <xref alt="[tab:b_values]" rid="tabU003Ab_values">[tab:b_values]</xref>.</p>
  <boxed-text>
    <boxed-text id="tabU003Ab_values">
      <table-wrap>
        <caption>
          <p>Range of baseline lengths used in conjunction with the
          <inline-formula><alternatives>
          <tex-math><![CDATA[l,m,n]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
          coordinates in
          Table¬†<xref alt="[tab:lmn_combos]" rid="tabU003Almn_combos">[tab:lmn_combos]</xref>.</p>
        </caption>
        <table>
          <thead>
            <tr>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\phi_{\mathrm{simple}}]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi></mml:mstyle></mml:msub></mml:math></alternatives></inline-formula></th>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[b(\mathrm{n=1})]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></th>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[b(\mathrm{n=10})]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></th>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[b(\mathrm{n=100})]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>100</mml:mn></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></th>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[b(\mathrm{n=1000})]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1000</mml:mn></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></th>
              <th align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[b(\mathrm{n=10000})]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mstyle mathvariant="normal"><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>10000</mml:mn></mml:mstyle><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[0]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula></td>
              <td align="center">6.3</td>
              <td align="center">62.8</td>
              <td align="center">628.3</td>
              <td align="center">6283.2</td>
              <td align="center">62831.9</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi/6]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">13.0</td>
              <td align="center">121.0</td>
              <td align="center">1201.0</td>
              <td align="center">12001.0</td>
              <td align="center">120001.0</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi/4]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">9.0</td>
              <td align="center">81.0</td>
              <td align="center">801.0</td>
              <td align="center">8001.0</td>
              <td align="center">80001.0</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi/3]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">7.0</td>
              <td align="center">61.0</td>
              <td align="center">601.0</td>
              <td align="center">6001.0</td>
              <td align="center">60001.0</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi/2]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">5.0</td>
              <td align="center">41.0</td>
              <td align="center">401.0</td>
              <td align="center">4001.0</td>
              <td align="center">40001.0</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[2\pi/3]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>2</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">4.0</td>
              <td align="center">31.0</td>
              <td align="center">301.0</td>
              <td align="center">3001.0</td>
              <td align="center">30001.0</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[3\pi/4]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>3</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">3.7</td>
              <td align="center">27.7</td>
              <td align="center">267.7</td>
              <td align="center">2667.7</td>
              <td align="center">26667.7</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[5\pi/6]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">3.4</td>
              <td align="center">25.0</td>
              <td align="center">241.0</td>
              <td align="center">2401.0</td>
              <td align="center">24001.0</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[\pi]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>œÄ</mml:mi></mml:math></alternatives></inline-formula></td>
              <td align="center">3.0</td>
              <td align="center">21.0</td>
              <td align="center">201.0</td>
              <td align="center">2001.0</td>
              <td align="center">20001.0</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[7\pi/6]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>7</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>6</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">2.7</td>
              <td align="center">18.1</td>
              <td align="center">172.4</td>
              <td align="center">1715.3</td>
              <td align="center">17143.9</td>
            </tr>
            <tr>
              <td align="center"><inline-formula><alternatives>
              <tex-math><![CDATA[5\pi/4]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>5</mml:mn><mml:mi>œÄ</mml:mi><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
              <td align="center">2.6</td>
              <td align="center">17.0</td>
              <td align="center">161.0</td>
              <td align="center">1601.0</td>
              <td align="center">16001.0</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
  </boxed-text>
  <p><monospace>WODEN</monospace> reads in an input array layout
  specified in local east, north, height <inline-formula><alternatives>
  <tex-math><![CDATA[E,N,H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  coordinates. It then converts those into local
  <inline-formula><alternatives>
  <tex-math><![CDATA[X,Y,Z]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  coordinates via the equations</p>
  <p>
    <disp-formula>
      <alternatives>
        <tex-math>
  <![CDATA[\begin{gathered}
    X = -\sin(\phi_{\mathrm{lat}})N + \cos(\phi_{\mathrm{lat}})H \label{eq:xyz_calc1} \\
    Y = E \label{eq:xyz_calc2} \\
    Z = \cos(\phi_{\mathrm{lat}})N + \sin(\phi_{\mathrm{lat}})H \label{eq:xyz_calc3}
  \end{gathered}]]>
        </tex-math>
        <mml:math display="block"
        xmlns:mml="http://www.w3.org/1998/Math/MathML">
          <mml:mtable>
            <mml:mtr id="eqU003Axyz_calc1">
              <mml:mtd columnalign="center">
                <mml:mi>X</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mo>‚àí</mml:mo>
                <mml:mo>sin</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                  <mml:msub>
                    <mml:mi>œï</mml:mi>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>l</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mstyle>
                  </mml:msub>
                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                </mml:mrow>
                <mml:mi>N</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mo>cos</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                  <mml:msub>
                    <mml:mi>œï</mml:mi>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>l</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mstyle>
                  </mml:msub>
                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                </mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr id="eqU003Axyz_calc2">
              <mml:mtd columnalign="center">
                <mml:mi>Y</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mi>E</mml:mi>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr id="eqU003Axyz_calc3">
              <mml:mtd columnalign="center">
                <mml:mi>Z</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mo>cos</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                  <mml:msub>
                    <mml:mi>œï</mml:mi>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>l</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mstyle>
                  </mml:msub>
                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                </mml:mrow>
                <mml:mi>N</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mo>sin</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                  <mml:msub>
                    <mml:mi>œï</mml:mi>
                    <mml:mstyle mathvariant="normal">
                      <mml:mi>l</mml:mi>
                      <mml:mi>a</mml:mi>
                      <mml:mi>t</mml:mi>
                    </mml:mstyle>
                  </mml:msub>
                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                </mml:mrow>
                <mml:mi>H</mml:mi>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </alternatives>
    </disp-formula>
  </p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\phi_{\mathrm{lat}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:msub></mml:math></alternatives></inline-formula>
  is the latitude of the array. <inline-formula><alternatives>
  <tex-math><![CDATA[X,Y,Z]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>Z</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  are used to calculate the <inline-formula><alternatives>
  <tex-math><![CDATA[u,v,w]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  coodinates (c.f. Chapter 4 in Thompson et al.
  (<xref alt="2017" rid="ref-TMSthird" ref-type="bibr">2017</xref>)). If
  we place our interferometer at a <inline-formula><alternatives>
  <tex-math><![CDATA[\phi_{\mathrm{lat}} = 0.0^\circ]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mn>0.0</mml:mn><mml:mo>‚àò</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  and set the local sidereal time (LST) to zero, the calculation of
  <inline-formula><alternatives>
  <tex-math><![CDATA[u,v,w]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  becomes</p>
  <p><named-content id="eqU003Auvw_simple" content-type="equation"><disp-formula><alternatives>
  <tex-math><![CDATA[
  u = E; \, v = N; \, w = H;]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>;</mml:mo><mml:mspace width="0.167em"></mml:mspace><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mo>;</mml:mo><mml:mspace width="0.167em"></mml:mspace><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo>;</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content></p>
  <p>allowing us to set <inline-formula><alternatives>
  <tex-math><![CDATA[E, N, H = b]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>=</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  for our values on <inline-formula><alternatives>
  <tex-math><![CDATA[b]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>b</mml:mi></mml:math></alternatives></inline-formula>
  in Table
  <xref alt="[tab:b_values]" rid="tabU003Ab_values">[tab:b_values]</xref>.
  Furthermore, we can convert our <inline-formula><alternatives>
  <tex-math><![CDATA[l,m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  values from Table
  <xref alt="[tab:lmn_combos]" rid="tabU003Almn_combos">[tab:lmn_combos]</xref>
  into RA,Dec (<inline-formula><alternatives>
  <tex-math><![CDATA[\alpha, \delta]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Œ±</mml:mi><mml:mo>,</mml:mo><mml:mi>Œ¥</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>)
  via:</p>
  <p>
    <disp-formula>
      <alternatives>
        <tex-math>
  <![CDATA[\begin{gathered}
  \delta = \arcsin(l)  \label{eq:dec_simple} \\
  \alpha = \arcsin \left( \frac{l}{\cos(\arcsin(l))} \right) \label{eq:ra_simple}
  \end{gathered}]]>
        </tex-math>
        <mml:math display="block"
        xmlns:mml="http://www.w3.org/1998/Math/MathML">
          <mml:mtable>
            <mml:mtr id="eqU003Adec_simple">
              <mml:mtd columnalign="center">
                <mml:mi>Œ¥</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mo>arcsin</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                  <mml:mi>l</mml:mi>
                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr id="eqU003Ara_simple">
              <mml:mtd columnalign="center">
                <mml:mi>Œ±</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mo>arcsin</mml:mo>
                <mml:mrow>
                  <mml:mo stretchy="true" form="prefix">(</mml:mo>
                  <mml:mfrac>
                    <mml:mi>l</mml:mi>
                    <mml:mrow>
                      <mml:mo>cos</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="true" form="prefix">
                        (</mml:mo>
                        <mml:mo>arcsin</mml:mo>
                        <mml:mrow>
                          <mml:mo stretchy="true" form="prefix">
                          (</mml:mo>
                          <mml:mi>l</mml:mi>
                          <mml:mo stretchy="true" form="postfix">
                          )</mml:mo>
                        </mml:mrow>
                        <mml:mo stretchy="true" form="postfix">
                        )</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo stretchy="true" form="postfix">)</mml:mo>
                </mml:mrow>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </alternatives>
    </disp-formula>
  </p>
  <p>Following the <monospace>RTS</monospace>,
  <monospace>WODEN</monospace> first of all calculates
  <italic>X,Y,Z</italic> using the array latitude at the time of the
  observation. It then uses the <monospace>PAL</monospace>
  (<xref alt="Jenness &amp; Berry, 2013" rid="ref-PAL2013" ref-type="bibr">Jenness
  &amp; Berry, 2013</xref>)
  <ext-link ext-link-type="uri" xlink:href="https://github.com/Starlink/pal/blob/master/palPrenut.c">palPrenut</ext-link>
  function to generate a rotation matrix to rotate the local
  <italic>X,Y,Z</italic> coordinates back to the J2000 epoch, as well as
  the LST and latitude of the array. This accounts for the
  precession/nutation of the Earth with respect to the J2000 RA/Dec
  coordinates that the sky model is specified in. To manifest the
  outcomes of Equations <xref alt="4" rid="eqU003Auvw_simple">4</xref>,
  <xref alt="[eq:dec_simple]" rid="eqU003Adec_simple">[eq:dec_simple]</xref>,
  and
  <xref alt="[eq:ra_simple]" rid="eqU003Ara_simple">[eq:ra_simple]</xref>,
  we have to apply the opposite rotation about
  <inline-formula><alternatives>
  <tex-math><![CDATA[\phi_{\mathrm{lat}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>œï</mml:mi><mml:mstyle mathvariant="normal"><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mstyle></mml:msub></mml:math></alternatives></inline-formula>
  as defined by Equations
  <xref alt="[eq:xyz_calc1]" rid="eqU003Axyz_calc1">[eq:xyz_calc1]</xref>,
  <xref alt="[eq:xyz_calc2]" rid="eqU003Axyz_calc2">[eq:xyz_calc2]</xref>,
  and
  <xref alt="[eq:xyz_calc3]" rid="eqU003Axyz_calc3">[eq:xyz_calc3]</xref>,
  as well as the rotations applied via
  <ext-link ext-link-type="uri" xlink:href="https://github.com/Starlink/pal/blob/master/palPrenut.c">palPrenut</ext-link>
  to account for precession/nutation, to our input
  <inline-formula><alternatives>
  <tex-math><![CDATA[E,N,H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  coordinates.</p>
  <p>Figure <xref alt="1" rid="figU003AWODEN_accuracy">1</xref> shows
  the result of running multiple simulations, each with: an array layout
  with a single baseline; a single time step and frequency channel; a
  single point source sky model; a primary beam model with gains of one
  and zero leakage. All possible combinations of
  <inline-formula><alternatives>
  <tex-math><![CDATA[l,m,n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[b]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>b</mml:mi></mml:math></alternatives></inline-formula>
  as listed in Tables
  <xref alt="[tab:lmn_combos]" rid="tabU003Almn_combos">[tab:lmn_combos]</xref>
  and
  <xref alt="[tab:b_values]" rid="tabU003Ab_values">[tab:b_values]</xref>
  are run. Each simulation is run with the parameters specified in Table
  <xref alt="[tab:acc_sim_settings]" rid="tabU003Aacc_sim_settings">[tab:acc_sim_settings]</xref>.</p>
  <boxed-text>
    <boxed-text id="tabU003Aacc_sim_settings">
      <table-wrap>
        <caption>
          <p>Common settings for the simulations run to produce the
          results in Figure
          <xref alt="1" rid="figU003AWODEN_accuracy">1</xref></p>
        </caption>
        <table>
          <colgroup>
            <col width="25%" />
            <col width="15%" />
            <col width="50%" />
          </colgroup>
          <thead>
            <tr>
              <th align="left">Parameter</th>
              <th align="left">Value</th>
              <th align="left">Manifestation in simulation</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Date (UTC)</td>
              <td align="left">2020-01-01 12:00:00.0</td>
              <td align="left"><monospace>WODEN</monospace> must correct
              for precession and nutation</td>
            </tr>
            <tr>
              <td align="left">Latitude (deg)</td>
              <td align="left">0.1095074</td>
              <td align="left">After precess/nut correction, latitude is
              0.0<inline-formula><alternatives>
              <tex-math><![CDATA[^\circ]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi></mml:mi><mml:mo>‚àò</mml:mo></mml:msup></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="left">Longitude (deg)</td>
              <td align="left">79.6423588</td>
              <td align="left">After precess/nut correction, LST is
              0.0<inline-formula><alternatives>
              <tex-math><![CDATA[^\circ]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi></mml:mi><mml:mo>‚àò</mml:mo></mml:msup></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="left">Frequency (MHz)</td>
              <td align="left">299.792458</td>
              <td align="left">Means <inline-formula><alternatives>
              <tex-math><![CDATA[\lambda = 1]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Œª</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
              so wavelength scaled <inline-formula><alternatives>
              <tex-math><![CDATA[u,v,w = E,N,H]]></tex-math>
              <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td>
            </tr>
            <tr>
              <td align="left">Reference frequency for sky model
              (MHz)</td>
              <td align="left">150</td>
              <td align="left"><monospace>WODEN</monospace> has to
              extrapolate the flux density</td>
            </tr>
            <tr>
              <td align="left">Spectral Index</td>
              <td align="left">-0.8</td>
              <td align="left">Needed to extrapolate flux density</td>
            </tr>
            <tr>
              <td align="left">Reference Stokes I flux density (Jy)</td>
              <td align="left">1.7401375</td>
              <td align="left">Should be extrapolated to a flux of 1.0
              at the simulation frequency</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
  </boxed-text>
  <fig>
    <caption><p>The absolute fractional difference (in percent) of
    visibilities calculated by <monospace>WODEN</monospace>, compared to
    their expected values, with the real component shown on the left,
    and the imaginary shown on the right. The green triangles show an
    older version of <monospace>WODEN</monospace> which used only 32 bit
    precision; the orange square show the v1.1
    <monospace>woden_float</monospace> version which uses a mixture of
    32 and 64 bit precision; the blue crosses show the
    <monospace>woden_double</monospace> mode which uses nearly entirely
    64 bit
    precision.<styled-content id="figU003AWODEN_accuracy"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="media/quantify_woden_accuracy.png" xlink:title="" />
  </fig>
  <p>All array layouts, sky models, and simulations are run by
  <monospace>WODEN/test_installation/absolute_accuracy/run_the_absolute_accuracy_test.sh</monospace>,
  which can be run as part of a test suite bundled with
  <monospace>WODEN</monospace>. This script reads the values out of the
  output <monospace>uvfits</monospace> files, and produces the plot in
  Figure <xref alt="1" rid="figU003AWODEN_accuracy">1</xref>.</p>
  <p><ext-link ext-link-type="uri" xlink:href="https://github.com/JLBLine/WODEN/releases/tag/v1.0.0">Version
  1.0</ext-link> of <monospace>WODEN</monospace> was fully 32 bit, which
  produced the green triangles in Figure
  <xref alt="1" rid="figU003AWODEN_accuracy">1</xref>, with longer
  baselines consistently a few percent off expectations. A two time
  processing slow down by moving to a combined 32 and 64 bit
  <monospace>woden_float</monospace> mode (orange squares) improves the
  accuracy to <inline-formula><alternatives>
  <tex-math><![CDATA[\le 0.2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>‚â§</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>%
  on the longer baselines. The entirely 64 bit
  <monospace>woden_double</monospace> precision mode is consistent in
  precision across baseline length, sitting at &lt; 2e-6% accuracy. The
  <monospace>woden_float</monospace> and
  <monospace>woden_double</monospace> executables are available in
  <ext-link ext-link-type="uri" xlink:href="https://github.com/JLBLine/WODEN/releases/tag/v1.1.0">Version
  1.1</ext-link>, and can be switched between via a command line option
  in <monospace>run_woden.py</monospace>. It should be noted that these
  offset errors are deterministic, meaning comparison between different
  simulations out of
  <ext-link ext-link-type="uri" xlink:href="https://github.com/JLBLine/WODEN/releases/tag/v1.0.0">Version
  1.0</ext-link> <monospace>WODEN</monospace> are consistent; these
  errors matter most when comparing to real data.</p>
  <p>As 32 and 64 bit precision calculations are performed in physically
  different parts of an NVIDIA GPU, with cards typically having less
  double precision hardware that single, the
  <monospace>woden_double</monospace> version is slower that the
  <monospace>woden_float</monospace>. Each card will show a different
  slow-down between the two modes. As a test, I ran a simulation using a
  catalogue of over 300,000 sources. The number of sources above the
  horizon and the simulation settings used are listed in Table
  <xref alt="[tab:benchmark_sim]" rid="tabU003Abenchmark_sim">[tab:benchmark_sim]</xref>,
  along with the speed difference between the
  <monospace>woden_float</monospace> and
  <monospace>woden_double</monospace> executables for two different
  NVIDIA GPU cards.</p>
  <boxed-text>
    <boxed-text id="tabU003Abenchmark_sim">
      <table-wrap>
        <caption>
          <p>Benchmark simulation to compare
          <monospace>woden_float</monospace> and
          <monospace>woden_double</monospace> speeds. Each shapelet
          component can have several basis function calculations, each
          more expensive that a point source component calculation. The
          MWA FEE is the most computationally expensive beam model
          included with <monospace>WODEN</monospace>.</p>
        </caption>
        <table>
          <thead>
            <tr>
              <th align="left">Parameters</th>
              <th align="left">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Time steps</td>
              <td align="left">14</td>
            </tr>
            <tr>
              <td align="left">Frequency channels</td>
              <td align="left">80</td>
            </tr>
            <tr>
              <td align="left">Point sources components</td>
              <td align="left">207673</td>
            </tr>
            <tr>
              <td align="left">Gaussian components</td>
              <td align="left">1182</td>
            </tr>
            <tr>
              <td align="left">Shapelet components (basis
              functions)</td>
              <td align="left">62 (10400)</td>
            </tr>
            <tr>
              <td align="left">Primary beam model</td>
              <td align="left">MWA FEE</td>
            </tr>
            <tr>
              <td align="left">GTX 1080 Ti
              <monospace>woden_float</monospace> simulation time</td>
              <td align="left">10min 39sec</td>
            </tr>
            <tr>
              <td align="left">GTX 1080 Ti
              <monospace>woden_double</monospace> simulation time</td>
              <td align="left">55min 46sec</td>
            </tr>
            <tr>
              <td align="left">V100 <monospace>woden_float</monospace>
              simulation time</td>
              <td align="left">4min 35sec</td>
            </tr>
            <tr>
              <td align="left">V100 <monospace>woden_double</monospace>
              simulation time</td>
              <td align="left">5min 55sec</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </boxed-text>
  </boxed-text>
  <p>Given this &gt; 5 times slow down on a desktop card, having the
  option to toggle between <monospace>woden_float</monospace> and
  <monospace>woden_double</monospace> allows quick experimentation using
  <monospace>woden_float</monospace> and longer science-quality runs
  with <monospace>woden_double</monospace>. Luckily, for cards like the
  V100, the slowdown is around 1.3. Note that these simulations can
  easily be broken up and run across multiple GPUs if available,
  reducing the real time taken to complete the simulations.</p>
</sec>
<sec id="example-application">
  <title>Example application</title>
  <p>In Line et al.
  (<xref alt="2020" rid="ref-Line2020" ref-type="bibr">2020</xref>), we
  compared two methods to model Fornax A: a combination of point and
  elliptical Gaussians, compared to shapelets (see Figure
  <xref alt="2" rid="figU003AForA">2</xref>). We were able to quickly
  compare the computational efficiency of the methods using a desktop,
  and comment on their respective strengths and weaknesses in regard to
  foreground removal for EoR purposes. Furthermore, as we could control
  the simulations, we could compare the methods in the absence of other
  processing systematics that are present in the real data from the MWA,
  which dominated the comparison when using the
  <monospace>RTS</monospace> alone.</p>
  <fig>
    <caption><p>Two methods to simulate Fornax A visibilities are
    compared here (both imaged using <monospace>WSClean</monospace>
    <xref alt="Offringa et al., 2014" rid="ref-Offringa2014" ref-type="bibr">Offringa
    et al., 2014</xref>;
    <xref alt="Offringa &amp; Smirnov, 2017" rid="ref-Offringa2017" ref-type="bibr">Offringa
    &amp; Smirnov, 2017</xref>), with point and elliptical Gaussians on
    the left, and shapelets on the
    right.<styled-content id="figU003AForA"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="media/FornaxA_model_comparison.png" xlink:title="" />
  </fig>
</sec>
<sec id="documentation">
  <title>Documentation</title>
  <p>The documentation for <monospace>WODEN</monospace> can be found on
  Read the Docs at
  <ext-link ext-link-type="uri" xlink:href="https://woden.readthedocs.io/en/latest/">woden.readthedocs.io</ext-link>,
  including a detailed installation guide, ways to test a local
  installation, details of the calculations <monospace>WODEN</monospace>
  makes under the hood, and worked examples, which are also included in
  the <monospace>GitHub</monospace> repo.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>I acknowledge direct contributions from Tony Farlie (who taught me
  how pointer arithmetic works in <monospace>C</monospace>) and
  contributions from Bart Pindor and Daniel Mitchell (through their work
  in the <monospace>RTS</monospace> and through advising me on
  <monospace>CUDA</monospace>). I would like to thank Chris Jordan who
  acted as a sounding board as I learned <monospace>C</monospace> and
  <monospace>CUDA</monospace>. Finally, I would like to thank both
  Matthew Kolopanis and Paul La Plante for reviewing the code and giving
  useful suggestions on how to improve the code.</p>
  <p>This research was supported by the Australian Research Council
  Centre of Excellence for All Sky Astrophysics in 3 Dimensions (ASTRO
  3D), through project number CE170100013. The International Centre for
  Radio Astronomy Research (ICRAR) is a Joint Venture of Curtin
  University and The University of Western Australia, funded by the
  Western Australian State government. This work was supported by
  resources provided by the Pawsey Supercomputing Centre with funding
  from the Australian Government and the Government of Western
  Australia.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-Mitchell2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mitchell</surname><given-names>Daniel A.</given-names></name>
        <name><surname>Greenhill</surname><given-names>Lincoln J.</given-names></name>
        <name><surname>Wayth</surname><given-names>Randall B.</given-names></name>
        <name><surname>Sault</surname><given-names>Robert J.</given-names></name>
        <name><surname>Lonsdale</surname><given-names>Colin J.</given-names></name>
        <name><surname>Cappallo</surname><given-names>Roger J.</given-names></name>
        <name><surname>Morales</surname><given-names>Miguel F.</given-names></name>
        <name><surname>Ord</surname><given-names>Stephen M.</given-names></name>
      </person-group>
      <article-title>Real-Time Calibration of the Murchison Widefield Array</article-title>
      <source>IEEE Journal of Selected Topics in Signal Processing</source>
      <year iso-8601-date="2008-10">2008</year><month>10</month>
      <volume>2</volume>
      <issue>5</issue>
      <issn>1932-4553</issn>
      <uri>http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=4703504</uri>
      <pub-id pub-id-type="doi">10.1109/JSTSP.2008.2005327</pub-id>
      <fpage>707</fpage>
      <lpage>717</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Tingay2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tingay</surname><given-names>S. J.</given-names></name>
        <name><surname>Goeke</surname><given-names>R.</given-names></name>
        <name><surname>Bowman</surname><given-names>J. D.</given-names></name>
        <name><surname>Emrich</surname><given-names>D.</given-names></name>
        <name><surname>Ord</surname><given-names>S. M.</given-names></name>
        <name><surname>Mitchell</surname><given-names>D. A.</given-names></name>
        <name><surname>Morales</surname><given-names>M. F.</given-names></name>
        <name><surname>Booler</surname><given-names>T.</given-names></name>
        <name><surname>Crosse</surname><given-names>B.</given-names></name>
        <name><surname>Wayth</surname><given-names>R. B.</given-names></name>
        <name><surname>Lonsdale</surname><given-names>C. J.</given-names></name>
        <name><surname>Tremblay</surname><given-names>S.</given-names></name>
        <name><surname>Pallot</surname><given-names>D.</given-names></name>
        <name><surname>Colegate</surname><given-names>T.</given-names></name>
        <name><surname>Wicenec</surname><given-names>A.</given-names></name>
        <name><surname>Kudryavtseva</surname><given-names>N.</given-names></name>
        <name><surname>Arcus</surname><given-names>W.</given-names></name>
        <name><surname>Barnes</surname><given-names>D.</given-names></name>
        <name><surname>Bernardi</surname><given-names>G.</given-names></name>
        <name><surname>Briggs</surname><given-names>F.</given-names></name>
        <name><surname>Burns</surname><given-names>S.</given-names></name>
        <name><surname>Bunton</surname><given-names>J. D.</given-names></name>
        <name><surname>Cappallo</surname><given-names>R. J.</given-names></name>
        <name><surname>Corey</surname><given-names>B. E.</given-names></name>
        <name><surname>Deshpande</surname><given-names>A.</given-names></name>
        <name><surname>Desouza</surname><given-names>L.</given-names></name>
        <name><surname>Gaensler</surname><given-names>B. M.</given-names></name>
        <name><surname>Greenhill</surname><given-names>L. J.</given-names></name>
        <name><surname>Hall</surname><given-names>P. J.</given-names></name>
        <name><surname>Hazelton</surname><given-names>B. J.</given-names></name>
        <name><surname>Herne</surname><given-names>D.</given-names></name>
        <name><surname>Hewitt</surname><given-names>J. N.</given-names></name>
        <name><surname>Johnston-Hollitt</surname><given-names>M.</given-names></name>
        <name><surname>Kaplan</surname><given-names>D. L.</given-names></name>
        <name><surname>Kasper</surname><given-names>J. C.</given-names></name>
        <name><surname>Kincaid</surname><given-names>B. B.</given-names></name>
        <name><surname>Koenig</surname><given-names>R.</given-names></name>
        <name><surname>Kratzenberg</surname><given-names>E.</given-names></name>
        <name><surname>Lynch</surname><given-names>M. J.</given-names></name>
        <name><surname>Mckinley</surname><given-names>B.</given-names></name>
        <name><surname>Mcwhirter</surname><given-names>S. R.</given-names></name>
        <name><surname>Morgan</surname><given-names>E.</given-names></name>
        <name><surname>Oberoi</surname><given-names>D.</given-names></name>
        <name><surname>Pathikulangara</surname><given-names>J.</given-names></name>
        <name><surname>Prabu</surname><given-names>T.</given-names></name>
        <name><surname>Remillard</surname><given-names>R. A.</given-names></name>
        <name><surname>Rogers</surname><given-names>A. E. E.</given-names></name>
        <name><surname>Roshi</surname><given-names>A.</given-names></name>
        <name><surname>Salah</surname><given-names>J. E.</given-names></name>
        <name><surname>Sault</surname><given-names>R. J.</given-names></name>
        <name><surname>Udaya-Shankar</surname><given-names>N.</given-names></name>
        <name><surname>Schlagenhaufer</surname><given-names>F.</given-names></name>
        <name><surname>Srivani</surname><given-names>K. S.</given-names></name>
        <name><surname>Stevens</surname><given-names>J.</given-names></name>
        <name><surname>Subrahmanyan</surname><given-names>R.</given-names></name>
        <name><surname>Waterson</surname><given-names>M.</given-names></name>
        <name><surname>Webster</surname><given-names>R. L.</given-names></name>
        <name><surname>Whitney</surname><given-names>A. R.</given-names></name>
        <name><surname>Williams</surname><given-names>A.</given-names></name>
        <name><surname>Williams</surname><given-names>C. L.</given-names></name>
        <name><surname>Wyithe</surname><given-names>J. S. B.</given-names></name>
      </person-group>
      <article-title>The Murchison Widefield Array: The Square Kilometre Array Precursor at Low Radio Frequencies</article-title>
      <source>Publications of the Astronomical Society Australia</source>
      <year iso-8601-date="2013-01">2013</year><month>01</month>
      <volume>30</volume>
      <issn>1323-3580</issn>
      <pub-id pub-id-type="doi">10.1017/pasa.2012.007</pub-id>
      <fpage>e007</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Line2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Line</surname><given-names>J. L. B.</given-names></name>
        <name><surname>Mitchell</surname><given-names>D. A.</given-names></name>
        <name><surname>Pindor</surname><given-names>B.</given-names></name>
        <name><surname>Riding</surname><given-names>J. L.</given-names></name>
        <name><surname>McKinley</surname><given-names>B.</given-names></name>
        <name><surname>Webster</surname><given-names>R. L.</given-names></name>
        <name><surname>Trott</surname><given-names>C. M.</given-names></name>
        <name><surname>Hurley-Walker</surname><given-names>N.</given-names></name>
        <name><surname>Offringa</surname><given-names>A. R.</given-names></name>
      </person-group>
      <article-title>Modelling and peeling extended sources with shapelets: A Fornax A case study</article-title>
      <source>Publications of the Astronomical Society Australia</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>37</volume>
      <issn>1323-3580</issn>
      <uri>https://www.cambridge.org/core/journals/publications-of-the-astronomical-society-of-australia/article/modelling-and-peeling-extended-sources-with-shapelets-a-fornax-a-case-study/40EDEBCB4306C6B713CBC60D12A27AAA</uri>
      <pub-id pub-id-type="doi">10.1017/PASA.2020.18</pub-id>
      <fpage>15</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Yoshiura2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yoshiura</surname><given-names>S</given-names></name>
        <name><surname>Pindor</surname><given-names>B</given-names></name>
        <name><surname>Line</surname><given-names>J L B</given-names></name>
        <name><surname>Barry</surname><given-names>N</given-names></name>
        <name><surname>Trott</surname><given-names>C M</given-names></name>
        <name><surname>Beardsley</surname><given-names>A</given-names></name>
        <name><surname>Bowman</surname><given-names>J</given-names></name>
        <name><surname>Byrne</surname><given-names>R</given-names></name>
        <name><surname>Chokshi</surname><given-names>A</given-names></name>
        <name><surname>Hazelton</surname><given-names>B J</given-names></name>
        <name><surname>Hasegawa</surname><given-names>K</given-names></name>
        <name><surname>Howard</surname><given-names>E</given-names></name>
        <name><surname>Greig</surname><given-names>B</given-names></name>
        <name><surname>Jacobs</surname><given-names>D</given-names></name>
        <name><surname>Jordan</surname><given-names>C H</given-names></name>
        <name><surname>Joseph</surname><given-names>R</given-names></name>
        <name><surname>Kolopanis</surname><given-names>M</given-names></name>
        <name><surname>Lynch</surname><given-names>C</given-names></name>
        <name><surname>McKinley</surname><given-names>B.</given-names></name>
        <name><surname>Mitchell</surname><given-names>D A</given-names></name>
        <name><surname>Morales</surname><given-names>M F</given-names></name>
        <name><surname>Murray</surname><given-names>S G</given-names></name>
        <name><surname>Pober</surname><given-names>J C</given-names></name>
        <name><surname>Rahimi</surname><given-names>M</given-names></name>
        <name><surname>Takahashi</surname><given-names>K</given-names></name>
        <name><surname>Tingay</surname><given-names>S J</given-names></name>
        <name><surname>Wayth</surname><given-names>R B</given-names></name>
        <name><surname>Webster</surname><given-names>R L</given-names></name>
        <name><surname>Wilensky</surname><given-names>M</given-names></name>
        <name><surname>Wyithe</surname><given-names>J S B</given-names></name>
        <name><surname>Zhang</surname><given-names>Z</given-names></name>
        <name><surname>Zheng</surname><given-names>Q</given-names></name>
      </person-group>
      <article-title>A new MWA limit on the 21 cm power spectrum at redshifts ‚àº13‚Äì17</article-title>
      <source>Monthly Notices to the Royal Astronomical Society</source>
      <year iso-8601-date="2021-06">2021</year><month>06</month>
      <volume>505</volume>
      <issue>4</issue>
      <uri>https://academic.oup.com/mnras/article/505/4/4775/6290509</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stab1560</pub-id>
      <fpage>4775</fpage>
      <lpage>4790</lpage>
    </element-citation>
  </ref>
  <ref id="ref-astropy2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Astropy Collaboration</string-name>
        <name><surname>Price-Whelan</surname><given-names>A. M.</given-names></name>
        <name><surname>Sip≈ëcz</surname><given-names>B. M.</given-names></name>
        <name><surname>G√ºnther</surname><given-names>H. M.</given-names></name>
        <name><surname>Lim</surname><given-names>P. L.</given-names></name>
        <name><surname>Crawford</surname><given-names>S. M.</given-names></name>
        <name><surname>Conseil</surname><given-names>S.</given-names></name>
        <name><surname>Shupe</surname><given-names>D. L.</given-names></name>
        <name><surname>Craig</surname><given-names>M. W.</given-names></name>
        <name><surname>Dencheva</surname><given-names>N.</given-names></name>
        <name><surname>Ginsburg</surname><given-names>A.</given-names></name>
        <name><surname>Vand erPlas</surname><given-names>J. T.</given-names></name>
        <name><surname>Bradley</surname><given-names>L. D.</given-names></name>
        <name><surname>P√©rez-Su√°rez</surname><given-names>D.</given-names></name>
        <name><surname>de Val-Borro</surname><given-names>M.</given-names></name>
        <name><surname>Aldcroft</surname><given-names>T. L.</given-names></name>
        <name><surname>Cruz</surname><given-names>K. L.</given-names></name>
        <name><surname>Robitaille</surname><given-names>T. P.</given-names></name>
        <name><surname>Tollerud</surname><given-names>E. J.</given-names></name>
        <name><surname>Ardelean</surname><given-names>C.</given-names></name>
        <name><surname>Babej</surname><given-names>T.</given-names></name>
        <name><surname>Bach</surname><given-names>Y. P.</given-names></name>
        <name><surname>Bachetti</surname><given-names>M.</given-names></name>
        <name><surname>Bakanov</surname><given-names>A. V.</given-names></name>
        <name><surname>Bamford</surname><given-names>S. P.</given-names></name>
        <name><surname>Barentsen</surname><given-names>G.</given-names></name>
        <name><surname>Barmby</surname><given-names>P.</given-names></name>
        <name><surname>Baumbach</surname><given-names>A.</given-names></name>
        <name><surname>Berry</surname><given-names>K. L.</given-names></name>
        <name><surname>Biscani</surname><given-names>F.</given-names></name>
        <name><surname>Boquien</surname><given-names>M.</given-names></name>
        <name><surname>Bostroem</surname><given-names>K. A.</given-names></name>
        <name><surname>Bouma</surname><given-names>L. G.</given-names></name>
        <name><surname>Brammer</surname><given-names>G. B.</given-names></name>
        <name><surname>Bray</surname><given-names>E. M.</given-names></name>
        <name><surname>Breytenbach</surname><given-names>H.</given-names></name>
        <name><surname>Buddelmeijer</surname><given-names>H.</given-names></name>
        <name><surname>Burke</surname><given-names>D. J.</given-names></name>
        <name><surname>Calderone</surname><given-names>G.</given-names></name>
        <name><surname>Cano Rodrƒ±ÃÅguez</surname><given-names>J. L.</given-names></name>
        <name><surname>Cara</surname><given-names>M.</given-names></name>
        <name><surname>Cardoso</surname><given-names>J. V. M.</given-names></name>
        <name><surname>Cheedella</surname><given-names>S.</given-names></name>
        <name><surname>Copin</surname><given-names>Y.</given-names></name>
        <name><surname>Corrales</surname><given-names>L.</given-names></name>
        <name><surname>Crichton</surname><given-names>D.</given-names></name>
        <name><surname>D‚ÄôAvella</surname><given-names>D.</given-names></name>
        <name><surname>Deil</surname><given-names>C.</given-names></name>
        <name><surname>Depagne</surname><given-names>√â.</given-names></name>
        <name><surname>Dietrich</surname><given-names>J. P.</given-names></name>
        <name><surname>Donath</surname><given-names>A.</given-names></name>
        <name><surname>Droettboom</surname><given-names>M.</given-names></name>
        <name><surname>Earl</surname><given-names>N.</given-names></name>
        <name><surname>Erben</surname><given-names>T.</given-names></name>
        <name><surname>Fabbro</surname><given-names>S.</given-names></name>
        <name><surname>Ferreira</surname><given-names>L. A.</given-names></name>
        <name><surname>Finethy</surname><given-names>T.</given-names></name>
        <name><surname>Fox</surname><given-names>R. T.</given-names></name>
        <name><surname>Garrison</surname><given-names>L. H.</given-names></name>
        <name><surname>Gibbons</surname><given-names>S. L. J.</given-names></name>
        <name><surname>Goldstein</surname><given-names>D. A.</given-names></name>
        <name><surname>Gommers</surname><given-names>R.</given-names></name>
        <name><surname>Greco</surname><given-names>J. P.</given-names></name>
        <name><surname>Greenfield</surname><given-names>P.</given-names></name>
        <name><surname>Groener</surname><given-names>A. M.</given-names></name>
        <name><surname>Grollier</surname><given-names>F.</given-names></name>
        <name><surname>Hagen</surname><given-names>A.</given-names></name>
        <name><surname>Hirst</surname><given-names>P.</given-names></name>
        <name><surname>Homeier</surname><given-names>D.</given-names></name>
        <name><surname>Horton</surname><given-names>A. J.</given-names></name>
        <name><surname>Hosseinzadeh</surname><given-names>G.</given-names></name>
        <name><surname>Hu</surname><given-names>L.</given-names></name>
        <name><surname>Hunkeler</surname><given-names>J. S.</given-names></name>
        <name><surname>Iveziƒá</surname><given-names>≈Ω.</given-names></name>
        <name><surname>Jain</surname><given-names>A.</given-names></name>
        <name><surname>Jenness</surname><given-names>T.</given-names></name>
        <name><surname>Kanarek</surname><given-names>G.</given-names></name>
        <name><surname>Kendrew</surname><given-names>S.</given-names></name>
        <name><surname>Kern</surname><given-names>N. S.</given-names></name>
        <name><surname>Kerzendorf</surname><given-names>W. E.</given-names></name>
        <name><surname>Khvalko</surname><given-names>A.</given-names></name>
        <name><surname>King</surname><given-names>J.</given-names></name>
        <name><surname>Kirkby</surname><given-names>D.</given-names></name>
        <name><surname>Kulkarni</surname><given-names>A. M.</given-names></name>
        <name><surname>Kumar</surname><given-names>A.</given-names></name>
        <name><surname>Lee</surname><given-names>A.</given-names></name>
        <name><surname>Lenz</surname><given-names>D.</given-names></name>
        <name><surname>Littlefair</surname><given-names>S. P.</given-names></name>
        <name><surname>Ma</surname><given-names>Z.</given-names></name>
        <name><surname>Macleod</surname><given-names>D. M.</given-names></name>
        <name><surname>Mastropietro</surname><given-names>M.</given-names></name>
        <name><surname>McCully</surname><given-names>C.</given-names></name>
        <name><surname>Montagnac</surname><given-names>S.</given-names></name>
        <name><surname>Morris</surname><given-names>B. M.</given-names></name>
        <name><surname>Mueller</surname><given-names>M.</given-names></name>
        <name><surname>Mumford</surname><given-names>S. J.</given-names></name>
        <name><surname>Muna</surname><given-names>D.</given-names></name>
        <name><surname>Murphy</surname><given-names>N. A.</given-names></name>
        <name><surname>Nelson</surname><given-names>S.</given-names></name>
        <name><surname>Nguyen</surname><given-names>G. H.</given-names></name>
        <name><surname>Ninan</surname><given-names>J. P.</given-names></name>
        <name><surname>N√∂the</surname><given-names>M.</given-names></name>
        <name><surname>Ogaz</surname><given-names>S.</given-names></name>
        <name><surname>Oh</surname><given-names>S.</given-names></name>
        <name><surname>Parejko</surname><given-names>J. K.</given-names></name>
        <name><surname>Parley</surname><given-names>N.</given-names></name>
        <name><surname>Pascual</surname><given-names>S.</given-names></name>
        <name><surname>Patil</surname><given-names>R.</given-names></name>
        <name><surname>Patil</surname><given-names>A. A.</given-names></name>
        <name><surname>Plunkett</surname><given-names>A. L.</given-names></name>
        <name><surname>Prochaska</surname><given-names>J. X.</given-names></name>
        <name><surname>Rastogi</surname><given-names>T.</given-names></name>
        <name><surname>Reddy Janga</surname><given-names>V.</given-names></name>
        <name><surname>Sabater</surname><given-names>J.</given-names></name>
        <name><surname>Sakurikar</surname><given-names>P.</given-names></name>
        <name><surname>Seifert</surname><given-names>M.</given-names></name>
        <name><surname>Sherbert</surname><given-names>L. E.</given-names></name>
        <name><surname>Sherwood-Taylor</surname><given-names>H.</given-names></name>
        <name><surname>Shih</surname><given-names>A. Y.</given-names></name>
        <name><surname>Sick</surname><given-names>J.</given-names></name>
        <name><surname>Silbiger</surname><given-names>M. T.</given-names></name>
        <name><surname>Singanamalla</surname><given-names>S.</given-names></name>
        <name><surname>Singer</surname><given-names>L. P.</given-names></name>
        <name><surname>Sladen</surname><given-names>P. H.</given-names></name>
        <name><surname>Sooley</surname><given-names>K. A.</given-names></name>
        <name><surname>Sornarajah</surname><given-names>S.</given-names></name>
        <name><surname>Streicher</surname><given-names>O.</given-names></name>
        <name><surname>Teuben</surname><given-names>P.</given-names></name>
        <name><surname>Thomas</surname><given-names>S. W.</given-names></name>
        <name><surname>Tremblay</surname><given-names>G. R.</given-names></name>
        <name><surname>Turner</surname><given-names>J. E. H.</given-names></name>
        <name><surname>Terr√≥n</surname><given-names>V.</given-names></name>
        <name><surname>van Kerkwijk</surname><given-names>M. H.</given-names></name>
        <name><surname>de la Vega</surname><given-names>A.</given-names></name>
        <name><surname>Watkins</surname><given-names>L. L.</given-names></name>
        <name><surname>Weaver</surname><given-names>B. A.</given-names></name>
        <name><surname>Whitmore</surname><given-names>J. B.</given-names></name>
        <name><surname>Woillez</surname><given-names>J.</given-names></name>
        <name><surname>Zabalza</surname><given-names>V.</given-names></name>
        <string-name>Astropy Contributors</string-name>
      </person-group>
      <article-title>The Astropy Project: Building an Open-science Project and Status of the v2.0 Core Package</article-title>
      <source>The Astronomical Journal</source>
      <year iso-8601-date="2018-09">2018</year><month>09</month>
      <volume>156</volume>
      <issue>3</issue>
      <uri>https://arxiv.org/abs/1801.02634</uri>
      <pub-id pub-id-type="doi">10.3847/1538-3881/aabc4f</pub-id>
      <fpage>123</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-astropy2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Astropy Collaboration</string-name>
        <name><surname>Robitaille</surname><given-names>Thomas P.</given-names></name>
        <name><surname>Tollerud</surname><given-names>Erik J.</given-names></name>
        <name><surname>Greenfield</surname><given-names>Perry</given-names></name>
        <name><surname>Droettboom</surname><given-names>Michael</given-names></name>
        <name><surname>Bray</surname><given-names>Erik</given-names></name>
        <name><surname>Aldcroft</surname><given-names>Tom</given-names></name>
        <name><surname>Davis</surname><given-names>Matt</given-names></name>
        <name><surname>Ginsburg</surname><given-names>Adam</given-names></name>
        <name><surname>Price-Whelan</surname><given-names>Adrian M.</given-names></name>
        <name><surname>Kerzendorf</surname><given-names>Wolfgang E.</given-names></name>
        <name><surname>Conley</surname><given-names>Alexander</given-names></name>
        <name><surname>Crighton</surname><given-names>Neil</given-names></name>
        <name><surname>Barbary</surname><given-names>Kyle</given-names></name>
        <name><surname>Muna</surname><given-names>Demitri</given-names></name>
        <name><surname>Ferguson</surname><given-names>Henry</given-names></name>
        <name><surname>Grollier</surname><given-names>Fr√©d√©ric</given-names></name>
        <name><surname>Parikh</surname><given-names>Madhura M.</given-names></name>
        <name><surname>Nair</surname><given-names>Prasanth H.</given-names></name>
        <name><surname>Unther</surname><given-names>Hans M.</given-names></name>
        <name><surname>Deil</surname><given-names>Christoph</given-names></name>
        <name><surname>Woillez</surname><given-names>Julien</given-names></name>
        <name><surname>Conseil</surname><given-names>Simon</given-names></name>
        <name><surname>Kramer</surname><given-names>Roban</given-names></name>
        <name><surname>Turner</surname><given-names>James E. H.</given-names></name>
        <name><surname>Singer</surname><given-names>Leo</given-names></name>
        <name><surname>Fox</surname><given-names>Ryan</given-names></name>
        <name><surname>Weaver</surname><given-names>Benjamin A.</given-names></name>
        <name><surname>Zabalza</surname><given-names>Victor</given-names></name>
        <name><surname>Edwards</surname><given-names>Zachary I.</given-names></name>
        <name><surname>Azalee Bostroem</surname><given-names>K.</given-names></name>
        <name><surname>Burke</surname><given-names>D. J.</given-names></name>
        <name><surname>Casey</surname><given-names>Andrew R.</given-names></name>
        <name><surname>Crawford</surname><given-names>Steven M.</given-names></name>
        <name><surname>Dencheva</surname><given-names>Nadia</given-names></name>
        <name><surname>Ely</surname><given-names>Justin</given-names></name>
        <name><surname>Jenness</surname><given-names>Tim</given-names></name>
        <name><surname>Labrie</surname><given-names>Kathleen</given-names></name>
        <name><surname>Lim</surname><given-names>Pey Lian</given-names></name>
        <name><surname>Pierfederici</surname><given-names>Francesco</given-names></name>
        <name><surname>Pontzen</surname><given-names>Andrew</given-names></name>
        <name><surname>Ptak</surname><given-names>Andy</given-names></name>
        <name><surname>Refsdal</surname><given-names>Brian</given-names></name>
        <name><surname>Servillat</surname><given-names>Mathieu</given-names></name>
        <name><surname>Streicher</surname><given-names>Ole</given-names></name>
      </person-group>
      <article-title>Astropy: A community Python package for astronomy</article-title>
      <source>Astronomy &amp; Astrophysics</source>
      <year iso-8601-date="2013-10">2013</year><month>10</month>
      <volume>558</volume>
      <uri>https://arxiv.org/abs/1307.6212</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361/201322068</pub-id>
      <fpage>A33</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Sokolowski2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sokolowski</surname><given-names>M.</given-names></name>
        <name><surname>Colegate</surname><given-names>T.</given-names></name>
        <name><surname>Sutinjo</surname><given-names>A. T.</given-names></name>
        <name><surname>Ung</surname><given-names>D.</given-names></name>
        <name><surname>Wayth</surname><given-names>R.</given-names></name>
        <name><surname>Hurley-Walker</surname><given-names>N.</given-names></name>
        <name><surname>Lenc</surname><given-names>E.</given-names></name>
        <name><surname>Pindor</surname><given-names>B.</given-names></name>
        <name><surname>Morgan</surname><given-names>J.</given-names></name>
        <name><surname>Kaplan</surname><given-names>D. L.</given-names></name>
        <name><surname>Bell</surname><given-names>M. E.</given-names></name>
        <name><surname>Callingham</surname><given-names>J. R.</given-names></name>
        <name><surname>Dwarakanath</surname><given-names>K. S.</given-names></name>
        <name><surname>For</surname><given-names>Bi-Qing</given-names></name>
        <name><surname>Gaensler</surname><given-names>B. M.</given-names></name>
        <name><surname>Hancock</surname><given-names>P. J.</given-names></name>
        <name><surname>Hindson</surname><given-names>L.</given-names></name>
        <name><surname>Johnston-Hollitt</surname><given-names>M.</given-names></name>
        <name><surname>Kapi≈Ñska</surname><given-names>A. D.</given-names></name>
        <name><surname>McKinley</surname><given-names>B.</given-names></name>
        <name><surname>Offringa</surname><given-names>A. R.</given-names></name>
        <name><surname>Procopio</surname><given-names>P.</given-names></name>
        <name><surname>Staveley-Smith</surname><given-names>L.</given-names></name>
        <name><surname>Wu</surname><given-names>C.</given-names></name>
        <name><surname>Zheng</surname><given-names>Q.</given-names></name>
      </person-group>
      <article-title>Calibration and Stokes Imaging with Full Embedded Element Primary Beam Model for the Murchison Widefield Array</article-title>
      <source>Publications of the Astronomical Society Australia</source>
      <year iso-8601-date="2017-11">2017</year><month>11</month>
      <volume>34</volume>
      <issn>1323-3580</issn>
      <uri>https://www.cambridge.org/core/product/identifier/S1323358017000546/type/journal_article</uri>
      <pub-id pub-id-type="doi">10.1017/pasa.2017.54</pub-id>
      <fpage>e062</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Offringa2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Offringa</surname><given-names>A. R.</given-names></name>
        <name><surname>McKinley</surname><given-names>B.</given-names></name>
        <name><surname>Hurley-Walker</surname><given-names>N.</given-names></name>
        <name><surname>Briggs</surname><given-names>F. H.</given-names></name>
        <name><surname>Wayth</surname><given-names>R. B.</given-names></name>
        <name><surname>Kaplan</surname><given-names>D. L.</given-names></name>
        <name><surname>Bell</surname><given-names>M. E.</given-names></name>
        <name><surname>Feng</surname><given-names>L.</given-names></name>
        <name><surname>Neben</surname><given-names>A. R.</given-names></name>
        <name><surname>Hughes</surname><given-names>J. D.</given-names></name>
        <name><surname>Rhee</surname><given-names>J.</given-names></name>
        <name><surname>Murphy</surname><given-names>T.</given-names></name>
        <name><surname>Bhat</surname><given-names>N. D R</given-names></name>
        <name><surname>Bernardi</surname><given-names>G.</given-names></name>
        <name><surname>Bowman</surname><given-names>J. D.</given-names></name>
        <name><surname>Cappallo</surname><given-names>R. J.</given-names></name>
        <name><surname>Corey</surname><given-names>B. E.</given-names></name>
        <name><surname>Deshpande</surname><given-names>A. A.</given-names></name>
        <name><surname>Emrich</surname><given-names>D.</given-names></name>
        <name><surname>Ewall-Wice</surname><given-names>A.</given-names></name>
        <name><surname>Gaensler</surname><given-names>B. M.</given-names></name>
        <name><surname>Goeke</surname><given-names>R.</given-names></name>
        <name><surname>Greenhill</surname><given-names>L. J.</given-names></name>
        <name><surname>Hazelton</surname><given-names>B. J.</given-names></name>
        <name><surname>Hindson</surname><given-names>L.</given-names></name>
        <name><surname>Johnston-Hollitt</surname><given-names>M.</given-names></name>
        <name><surname>Jacobs</surname><given-names>D. C.</given-names></name>
        <name><surname>Kasper</surname><given-names>J. C.</given-names></name>
        <name><surname>Kratzenberg</surname><given-names>E.</given-names></name>
        <name><surname>Lenc</surname><given-names>E.</given-names></name>
        <name><surname>Lonsdale</surname><given-names>C. J.</given-names></name>
        <name><surname>Lynch</surname><given-names>M. J.</given-names></name>
        <name><surname>McWhirter</surname><given-names>S. R.</given-names></name>
        <name><surname>Mitchell</surname><given-names>D. A.</given-names></name>
        <name><surname>Morales</surname><given-names>M. F.</given-names></name>
        <name><surname>Morgan</surname><given-names>E.</given-names></name>
        <name><surname>Kudryavtseva</surname><given-names>N.</given-names></name>
        <name><surname>Oberoi</surname><given-names>D.</given-names></name>
        <name><surname>Ord</surname><given-names>S. M.</given-names></name>
        <name><surname>Pindor</surname><given-names>B.</given-names></name>
        <name><surname>Procopio</surname><given-names>P.</given-names></name>
        <name><surname>Prabu</surname><given-names>T.</given-names></name>
        <name><surname>Riding</surname><given-names>J.</given-names></name>
        <name><surname>Roshi</surname><given-names>D. A.</given-names></name>
        <name><surname>Shankar</surname><given-names>N. Udaya</given-names></name>
        <name><surname>Srivani</surname><given-names>K. S.</given-names></name>
        <name><surname>Subrahmanyan</surname><given-names>R.</given-names></name>
        <name><surname>Tingay</surname><given-names>S. J.</given-names></name>
        <name><surname>Waterson</surname><given-names>M.</given-names></name>
        <name><surname>Webster</surname><given-names>R. L.</given-names></name>
        <name><surname>Whitney</surname><given-names>A. R.</given-names></name>
        <name><surname>Williams</surname><given-names>A.</given-names></name>
        <name><surname>Williams</surname><given-names>C. L.</given-names></name>
      </person-group>
      <article-title>Wsclean: An implementation of a fast, generic wide-field imager for radio astronomy</article-title>
      <source>Monthly Notices of the Royal Astronomical Society</source>
      <year iso-8601-date="2014">2014</year>
      <volume>444</volume>
      <issue>1</issue>
      <isbn>00358711</isbn>
      <pub-id pub-id-type="doi">10.1093/mnras/stu1368</pub-id>
      <fpage>606</fpage>
      <lpage>619</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Offringa2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Offringa</surname><given-names>A. R.</given-names></name>
        <name><surname>Smirnov</surname><given-names>O.</given-names></name>
      </person-group>
      <article-title>An optimized algorithm for multiscale wideband deconvolution of radio astronomical images</article-title>
      <source>Monthly Notices of the Royal Astronomical Society</source>
      <year iso-8601-date="2017-10">2017</year><month>10</month>
      <volume>471</volume>
      <issue>1</issue>
      <issn>0035-8711</issn>
      <uri>https://academic.oup.com/mnras/article-lookup/doi/10.1093/mnras/stx1547</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stx1547</pub-id>
      <fpage>301</fpage>
      <lpage>316</lpage>
    </element-citation>
  </ref>
  <ref id="ref-HEALPix2005">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>G√≥rski</surname><given-names>K. M.</given-names></name>
        <name><surname>Hivon</surname><given-names>E.</given-names></name>
        <name><surname>Banday</surname><given-names>A. J.</given-names></name>
        <name><surname>Wandelt</surname><given-names>B. D.</given-names></name>
        <name><surname>Hansen</surname><given-names>F. K.</given-names></name>
        <name><surname>Reinecke</surname><given-names>M.</given-names></name>
        <name><surname>Bartelmann</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>HEALPix: A Framework for High-Resolution Discretization and Fast Analysis of Data Distributed on the Sphere</article-title>
      <source>The Astrophysical Journal</source>
      <year iso-8601-date="2005-04">2005</year><month>04</month>
      <volume>622</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/astro-ph/0409513</uri>
      <pub-id pub-id-type="doi">10.1086/427976</pub-id>
      <fpage>759</fpage>
      <lpage>771</lpage>
    </element-citation>
  </ref>
  <ref id="ref-FITS2002">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Calabretta</surname><given-names>M. R.</given-names></name>
        <name><surname>Greisen</surname><given-names>E. W.</given-names></name>
      </person-group>
      <article-title>Representations of celestial coordinates in FITS</article-title>
      <source>Astronomy &amp; Astrophysics</source>
      <year iso-8601-date="2002-12">2002</year><month>12</month>
      <volume>395</volume>
      <uri>https://arxiv.org/abs/astro-ph/0207413</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361:20021327</pub-id>
      <fpage>1077</fpage>
      <lpage>1122</lpage>
    </element-citation>
  </ref>
  <ref id="ref-TMSthird">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Thompson</surname><given-names>A. Richard</given-names></name>
        <name><surname>Moran</surname><given-names>James M.</given-names></name>
        <name><surname>Swenson</surname><given-names>Jr.</given-names><suffix>George W.</suffix></name>
      </person-group>
      <source>Interferometry and Synthesis in Radio Astronomy, 3rd Edition</source>
      <year iso-8601-date="2017">2017</year>
      <pub-id pub-id-type="doi">10.1007/978-3-319-44431-4</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-PAL2013">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Jenness</surname><given-names>T.</given-names></name>
        <name><surname>Berry</surname><given-names>D. S.</given-names></name>
      </person-group>
      <article-title>PAL: A Positional Astronomy Library</article-title>
      <source>Astronomical data analysis software and systems XXII</source>
      <person-group person-group-type="editor">
        <name><surname>Friedel</surname><given-names>D. N.</given-names></name>
      </person-group>
      <year iso-8601-date="2013-10">2013</year><month>10</month>
      <volume>475</volume>
      <fpage>307</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-pyerfa">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>van Kerkwijk</surname><given-names>Marten</given-names></name>
        <name><surname>Tollerud</surname><given-names>Erik</given-names></name>
        <name><surname>Woillez</surname><given-names>Julien</given-names></name>
        <name><surname>Robitaille</surname><given-names>Thomas</given-names></name>
        <name><surname>Bray</surname><given-names>E. M.</given-names></name>
        <name><surname>Valentino</surname><given-names>Antonio</given-names></name>
        <name><surname>Sipocz</surname><given-names>Brigitta</given-names></name>
        <name><surname>Droettboom</surname><given-names>Michael</given-names></name>
        <name><surname>Deil</surname><given-names>Christoph</given-names></name>
        <name><surname>Seifert</surname><given-names>Michael</given-names></name>
        <name><surname>Conseil</surname><given-names>Simon</given-names></name>
        <name><surname>Aldcroft</surname><given-names>Tom</given-names></name>
        <name><surname>Price-Whelan</surname><given-names>Adrian</given-names></name>
        <name><surname>StuartLittlefair</surname></name>
        <name><surname>Lim</surname><given-names>P. L.</given-names></name>
        <name><surname>Sulzbach</surname><given-names>Bernardo</given-names></name>
        <name><surname>Beaumont</surname><given-names>Chris</given-names></name>
        <name><surname>Cara</surname><given-names>Daria</given-names></name>
        <name><surname>Crichton</surname><given-names>Devin</given-names></name>
        <name><surname>Davis</surname><given-names>Matt</given-names></name>
        <name><surname>de Val-Borro</surname><suffix>Miguel</suffix></name>
        <name><surname>Pascual</surname><given-names>Sergio</given-names></name>
        <name><surname>Babej</surname><given-names>Tomas</given-names></name>
        <name><surname>Swaroop</surname><given-names>Vatsala</given-names></name>
        <name><surname>Vishnunarayan</surname><given-names>K. I.</given-names></name>
        <name><surname>Sumak</surname><given-names>Jani</given-names></name>
      </person-group>
      <article-title>Pyerfa</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2020-07">2020</year><month>07</month>
      <uri>https://doi.org/10.5281/zenodo.3940699</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.3940699</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Lanman2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lanman</surname><given-names>Adam E.</given-names></name>
        <name><surname>Hazelton</surname><given-names>Bryna J.</given-names></name>
        <name><surname>Jacobs</surname><given-names>Daniel C.</given-names></name>
        <name><surname>Kolopanis</surname><given-names>Matthew J.</given-names></name>
        <name><surname>Pober</surname><given-names>Jonathan C.</given-names></name>
        <name><surname>Aguirre</surname><given-names>James E.</given-names></name>
        <name><surname>Thyagarajan</surname><given-names>Nithyanandan</given-names></name>
      </person-group>
      <article-title>pyuvsim: A comprehensive simulation package for radio interferometers in Python</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>37</issue>
      <uri>https://doi.org/10.21105/joss.01234</uri>
      <pub-id pub-id-type="doi">10.21105/joss.01234</pub-id>
      <fpage>1234</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-OSKAR">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Mort</surname><given-names>Benjamin J.</given-names></name>
        <name><surname>Dulwich</surname><given-names>Fred</given-names></name>
        <name><surname>Salvini</surname><given-names>Stefano</given-names></name>
        <name><surname>Adami</surname><given-names>Kristian Zarb</given-names></name>
        <name><surname>Jones</surname><given-names>Mike E.</given-names></name>
      </person-group>
      <article-title>OSKAR: Simulating digital beamforming for the SKA aperture array</article-title>
      <source>2010 IEEE international symposium on phased array systems and technology</source>
      <year iso-8601-date="2010">2010</year>
      <volume></volume>
      <pub-id pub-id-type="doi">10.1109/ARRAY.2010.5613289</pub-id>
      <fpage>690</fpage>
      <lpage>694</lpage>
    </element-citation>
  </ref>
</ref-list>
<fn-group>
  <fn id="fn1">
    <label>1</label><p>Note there is no negative at the front inside the
    exponential for <inline-formula><alternatives>
    <tex-math><![CDATA[V(u,v,w)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
    After numerous comparisons to other simulation packages, and imaging
    to check the input source positions match, I find dropping the
    negative gives the correct outputs.</p>
  </fn>
</fn-group>
</back>
</article>
