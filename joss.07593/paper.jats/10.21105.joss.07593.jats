<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7593</article-id>
<article-id pub-id-type="doi">10.21105/joss.07593</article-id>
<title-group>
<article-title>Limace.jl: A Julia package to compute hydromagnetic modes
in spherical domains</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9924-0562</contrib-id>
<name>
<surname>Gerick</surname>
<given-names>Felix</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Paris Institute of Earth Physics (IPGP)</institution>
<institution-id institution-id-type="ROR">004gzqz66</institution-id>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>National Centre for Space Studies (CNES),
France</institution>
<institution-id institution-id-type="ROR">04h1h0y33</institution-id>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Royal Observatory of Belgium, Belgium</institution>
<institution-id institution-id-type="ROR">00hjks330</institution-id>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-06-10">
<day>10</day>
<month>6</month>
<year>2024</year>
</pub-date>
<volume>10</volume>
<issue>110</issue>
<fpage>7593</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Julia</kwd>
<kwd>geophysics</kwd>
<kwd>fluid dynamics</kwd>
<kwd>geomagnetism</kwd>
<kwd>hydromagnetic modes</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Hydromagnetic modes in spherical domains are relevant to the liquid
  cores of planets, moons or stars, as well as rotating fluid dynamics
  experiments. These modes are solutions to the linearized rotating
  magnetohydrodynamic equations that govern electrically conducting
  fluids under rapid rotation. <monospace>Limace.jl</monospace> is a
  package written in the Julia programming language
  (<xref alt="Bezanson et al., 2017" rid="ref-bezansonjulia2017" ref-type="bibr">Bezanson
  et al., 2017</xref>), based on Galerkin projections of the governing
  equations onto trial vectors of the velocity and magnetic field. It
  aims to facilitate the calculation of modes in flexible setups with a
  high-level interface, whilst remaining computationally performant
  enough to tackle relevant physical parameters.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>The study of hydromagnetic modes is relevant in particular to
  Earth’s liquid core. Despite having been theoretically predicted a
  long time ago
  (<xref alt="Braginsky, 1970" rid="ref-braginskytorsional1970" ref-type="bibr">Braginsky,
  1970</xref>;
  <xref alt="Hide, 1966" rid="ref-hidefree1966" ref-type="bibr">Hide,
  1966</xref>;
  <xref alt="Malkus, 1967" rid="ref-malkushydromagnetic1967" ref-type="bibr">Malkus,
  1967</xref>), recent advances in numerical modelling and new
  observational evidence in geomagnetic data have reignited interest in
  these modes
  (<xref alt="Gerick et al., 2021" rid="ref-gerickfast2021" ref-type="bibr">Gerick
  et al., 2021</xref>;
  <xref alt="Gerick &amp; Livermore, 2024" rid="ref-gerickinterannual2024" ref-type="bibr">Gerick
  &amp; Livermore, 2024</xref>;
  <xref alt="Gillet et al., 2022" rid="ref-gilletsatellite2022" ref-type="bibr">Gillet
  et al., 2022</xref>;
  <xref alt="Luo et al., 2022" rid="ref-luowaves2022a" ref-type="bibr">Luo
  et al., 2022</xref>;
  <xref alt="Luo &amp; Jackson, 2022" rid="ref-luowaves2022" ref-type="bibr">Luo
  &amp; Jackson, 2022</xref>;
  <xref alt="Triana et al., 2022" rid="ref-trianacore2022" ref-type="bibr">Triana
  et al., 2022</xref>). It is therefore relevant to the geophysical and
  astrophysical fluid dynamics community to have access to a code that
  models these modes. The only open-source models to compute
  hydromagnetic modes in relevant parameters for planetary cores is Kore
  (<xref alt="Triana et al., 2021" rid="ref-trianaviscous2021" ref-type="bibr">Triana
  et al., 2021</xref>), a spectral code based on ultraspherical
  polynomials in axisymmetric setups written in Python. Although Kore is
  limited to axisymmetric geometries, the implementation requires
  substantial work due to the complexity of the underlying spectral
  equations, resulting in a substantial entry barrier for scientists to
  model these modes. In addition to Kore,
  <monospace>Limace.jl</monospace> tries to lower this entry barrier, by
  providing a generic open source model with a very simple high-level
  API and modern online documentation with practical examples.</p>
  <p>Despite having a high-level interface,
  <monospace>Limace.jl</monospace> can be used to solve complex and
  geophysically relevant problems. A unique feature of
  <monospace>Limace.jl</monospace> is the support of complex
  (non-axisymmetric) background magnetic fields and flows over which the
  modes evolve. The code has been developed from the beginning to leave
  assumptions of symmetry up to the user. The model code base is tested
  against mode solutions from the scientific literature to ensure its
  correctness.</p>
</sec>
<sec id="theoretical-background-and-implementation-details">
  <title>Theoretical background and implementation details</title>
  <p>In order to compute modal solutions, we consider the linearized
  momentum equation of the incompressible fluid and the linearized
  induction equation
  (<xref alt="Gerick &amp; Livermore, 2024" rid="ref-gerickinterannual2024" ref-type="bibr">Gerick
  &amp; Livermore, 2024</xref>;
  <xref alt="Ivers &amp; Phillips, 2008" rid="ref-iversscalar2008" ref-type="bibr">Ivers
  &amp; Phillips, 2008</xref>) <disp-formula><alternatives>
  <tex-math><![CDATA[
  \begin{aligned}
      \lambda\mathbf{u} =& -\left(\boldsymbol{\nabla}\times\mathbf{u}\right)\times\mathbf{U}_0- \left(\boldsymbol{\nabla}\times\mathbf{U}_0\right)\times\mathbf{u} -2\boldsymbol{\Omega}\times\mathbf{u} - \frac{1}{\rho}\nabla p\\
       &+ \frac{1}{\rho\mu_0}\left(\left(\boldsymbol{\nabla}\times\mathbf{b}\right)\times\mathbf{B}_0+\left(\boldsymbol{\nabla}\times\mathbf{B}_0\right)\times\mathbf{b}\right) + \nu \boldsymbol{\nabla}^2\mathbf{u},\nonumber\\
      \lambda\mathbf{b} =& \boldsymbol{\nabla}\times\left(\mathbf{U}_0\times\mathbf{b}\right) + \boldsymbol{\nabla}\times\left(\mathbf{u}\times\mathbf{B}_0\right) + \eta \boldsymbol{\nabla}^2\mathbf{b}.
  \end{aligned}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>λ</mml:mi><mml:mi>𝐮</mml:mi><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mi>−</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝛁</mml:mi><mml:mo>×</mml:mo><mml:mi>𝐮</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>𝐔</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝛁</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>𝐔</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mi>𝐮</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>𝛀</mml:mi><mml:mo>×</mml:mo><mml:mi>𝐮</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>ρ</mml:mi></mml:mfrac><mml:mi>∇</mml:mi><mml:mi>p</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mi>+</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>ρ</mml:mi><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝛁</mml:mi><mml:mo>×</mml:mo><mml:mi>𝐛</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:msub><mml:mi>𝐁</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝛁</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>𝐁</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mi>𝐛</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ν</mml:mi><mml:msup><mml:mi>𝛁</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>𝐮</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>λ</mml:mi><mml:mi>𝐛</mml:mi><mml:mo>=</mml:mo></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mi>𝛁</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>𝐔</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>𝐛</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>𝛁</mml:mi><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐮</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>𝐁</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>η</mml:mi><mml:msup><mml:mi>𝛁</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>𝐛</mml:mi><mml:mi>.</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
  with <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{u}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐮</mml:mi></mml:math></alternatives></inline-formula>
  the velocity perturbation, <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{U}_0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐔</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  the steady background velocity, <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{b}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐛</mml:mi></mml:math></alternatives></inline-formula>
  the magnetic field perturbation, <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{B}_0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐁</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  the background magnetic field, <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{\Omega}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝛀</mml:mi></mml:math></alternatives></inline-formula>
  the rotation axis, <inline-formula><alternatives>
  <tex-math><![CDATA[\rho]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ρ</mml:mi></mml:math></alternatives></inline-formula>
  the fluid density, <inline-formula><alternatives>
  <tex-math><![CDATA[p]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>p</mml:mi></mml:math></alternatives></inline-formula>
  the reduced hydrodynamic pressure, <inline-formula><alternatives>
  <tex-math><![CDATA[\mu_0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>μ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  the magnetic permeability of free space,
  <inline-formula><alternatives>
  <tex-math><![CDATA[\nu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ν</mml:mi></mml:math></alternatives></inline-formula>
  the kinematic viscosity, <inline-formula><alternatives>
  <tex-math><![CDATA[\eta]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>η</mml:mi></mml:math></alternatives></inline-formula>
  the magnetic diffusivitiy, and <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda=-\sigma+\mathrm{i}\omega]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mi>−</mml:mi><mml:mi>σ</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mi>ω</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
  with <inline-formula><alternatives>
  <tex-math><![CDATA[\sigma]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>σ</mml:mi></mml:math></alternatives></inline-formula>
  the damping rate and <inline-formula><alternatives>
  <tex-math><![CDATA[\omega]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ω</mml:mi></mml:math></alternatives></inline-formula>
  the frequency of the oscillatory perturbation to the steady
  background.</p>
  <p>To discretize the linearized equations, they are projected onto
  trial vectors (Galerkin vector bases) <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{u}_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐮</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{b}_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐛</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  for the velocity and magnetic field, respectively. Due to the
  divergence free condition on the velocity and magnetic field, i.e. the
  flow is incompressible and no magnetic monopoles exist, it is
  convenient to decompose the fields into poloidal and toroidal
  components, so that <disp-formula><alternatives>
  <tex-math><![CDATA[
  \begin{aligned}
      \mathbf{u} &= \sum_i \alpha_i\mathbf{u}_i = \sum_{l,m,n} \alpha^P_{lmn}\mathbf{P}_{lmn} + \sum_{l,m,n} \alpha^Q_{lmn}\mathbf{Q}_{lmn},\\
      \mathbf{b} &= \sum_i \beta_i\mathbf{b}_i =  \sum_{l,m,n} \beta^S_{lmn}\mathbf{S}_{lmn} + \sum_{l,m,n} \beta^T_{lmn}\mathbf{T}_{lmn},
  \end{aligned}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>𝐮</mml:mi></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>𝐮</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msubsup><mml:msub><mml:mi>𝐏</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>α</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>Q</mml:mi></mml:msubsup><mml:msub><mml:mi>𝐐</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>𝐛</mml:mi></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>𝐛</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:msub><mml:mi>𝐒</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>𝐓</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
  with <inline-formula><alternatives>
  <tex-math><![CDATA[\alpha_i, \beta_i \in \mathbb{C}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>ℂ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
  The respective poloidal <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{P}_{lmn}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐏</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  and toroidal <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{Q}_{lmn}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐐</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  basis vectors in spherical coordinates <inline-formula><alternatives>
  <tex-math><![CDATA[(r,\theta,\phi)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  are <disp-formula><alternatives>
  <tex-math><![CDATA[
  \begin{aligned}
      \mathbf{P}_{lmn} & = \boldsymbol{\nabla}\times\boldsymbol{\nabla}\times P_{ln}(r)Y_l^m(\theta,\phi)\mathbf{r}, \\
      \mathbf{Q}_{lmn} & = \boldsymbol{\nabla}\times Q_{ln}(r) Y_l^m(\theta,\phi)\mathbf{r},
  \end{aligned}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msub><mml:mi>𝐏</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:mi>𝛁</mml:mi><mml:mo>×</mml:mo><mml:mi>𝛁</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>𝐫</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msub><mml:mi>𝐐</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:mi>𝛁</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>𝐫</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
  and analogously for <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{S}_{lmn}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐒</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{T}_{lmn}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝐓</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.
  Here, <inline-formula><alternatives>
  <tex-math><![CDATA[Y_l^m(\theta,\phi)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>l</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is the (fully normalized) spherical harmonic of degree
  <inline-formula><alternatives>
  <tex-math><![CDATA[l]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>l</mml:mi></mml:math></alternatives></inline-formula>
  and order <inline-formula><alternatives>
  <tex-math><![CDATA[m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>.
  The boundary conditions (or regularity condition at
  <inline-formula><alternatives>
  <tex-math><![CDATA[r=0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)
  are imposed on the scalar functions <inline-formula><alternatives>
  <tex-math><![CDATA[P,S,Q,T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>,</mml:mo><mml:mi>Q</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
  The scalar functions can be chosen to have optimal properties,
  i.e. the resulting basis is orthogonal w.r.t a given inner product
  (<xref alt="Chen et al., 2018" rid="ref-chenoptimal2018" ref-type="bibr">Chen
  et al., 2018</xref>;
  <xref alt="Gerick &amp; Livermore, 2024" rid="ref-gerickinterannual2024" ref-type="bibr">Gerick
  &amp; Livermore, 2024</xref>;
  <xref alt="Livermore, 2010" rid="ref-livermoregalerkin2010" ref-type="bibr">Livermore,
  2010</xref>). <monospace>Limace.jl</monospace> provides several
  optimal bases that satisfy relevant boundary conditions, such as
  non-penetration and no-slip for the velocity and perfectly conducting
  and insulating exteriors for the magnetic field.</p>
  <p>We need to consider all combinations of poloidal and toroidal
  vector combinations in the projection of the forces. This leads to
  several coupling terms, especially for the Lorentz force, advection
  and induction terms. The integrals of these coupling terms over the
  spherical surfaces are computed through the Adam-Gaunt and Elsasser
  variables
  (<xref alt="James, 1973" rid="ref-jamesadams1973" ref-type="bibr">James,
  1973</xref>), which are calculated from Wigner symbols (available in
  Julia through
  <ext-link ext-link-type="uri" xlink:href="https://github.com/Jutho/WignerSymbols.jl">WignerSymbols.jl</ext-link>,
  based on Johansson &amp; Forssén
  (<xref alt="2016" rid="ref-johanssonfast2016" ref-type="bibr">2016</xref>)).
  The remaining integration in radial direction is done using
  Gauss-Legendre quadratures, available through
  <ext-link ext-link-type="uri" xlink:href="https://github.com/JuliaApproximation/FastGaussQuadrature.jl">FastGaussQuadrature.jl</ext-link>.
  The exact modelled equations are outlined in Gerick &amp; Livermore
  (<xref alt="2024" rid="ref-gerickinterannual2024" ref-type="bibr">2024</xref>),
  based on the work of Ivers &amp; Phillips
  (<xref alt="2008" rid="ref-iversscalar2008" ref-type="bibr">2008</xref>).</p>
  <p>From the projected equations, the problem reduces to a generalized
  eigenproblem <disp-formula><alternatives>
  <tex-math><![CDATA[
  \lambda \mathbf{A}\mathbf{x} = \mathbf{B}\mathbf{x},
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>λ</mml:mi><mml:mi>𝐀</mml:mi><mml:mi>𝐱</mml:mi><mml:mo>=</mml:mo><mml:mi>𝐁</mml:mi><mml:mi>𝐱</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  that is solved numerically. Here, the eigenvector
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{x}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐱</mml:mi></mml:math></alternatives></inline-formula>
  contains the coefficients <inline-formula><alternatives>
  <tex-math><![CDATA[\alpha_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  (and <inline-formula><alternatives>
  <tex-math><![CDATA[\beta_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>).
  The matrix <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{B}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐁</mml:mi></mml:math></alternatives></inline-formula>
  is generally not symmetric/Hermitian, but
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{A}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐀</mml:mi></mml:math></alternatives></inline-formula>
  can be the unit matrix, symmetric tridiagonal or symmetric, depending
  on the chosen bases.</p>
  <p>For small problem sizes, the eigenproblem can be solved using dense
  methods, e.g. using the standard library function
  <monospace>LinearAlgebra.eigen</monospace>. For larger problem sizes
  it is only feasible to compute a few eigensolutions of the sparse
  system. To this end, a shift-invert spectral transform method is
  provided, based on the sparse LU factorization from
  <monospace>UMFPACK</monospace>
  (<xref alt="Davis, 2004" rid="ref-davisalgorithm2004" ref-type="bibr">Davis,
  2004</xref>) and the partial Schur decomposition implemented in
  <ext-link ext-link-type="uri" xlink:href="https://github.com/JuliaLinearAlgebra/ArnoldiMethod.jl">ArnoldiMethod.jl</ext-link>
  (<xref alt="Stoppels &amp; Nyman, n.d." rid="ref-StoppelsArnoldiMethod" ref-type="bibr">Stoppels
  &amp; Nyman, n.d.</xref>).</p>
  <p>For postprocessing, <monospace>Limace.jl</monospace> uses a fast
  spherical harmonic transform implemented in the
  <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/nschaeff/shtns">SHTns</ext-link>
  library
  (<xref alt="Schaeffer, 2013" rid="ref-schaefferefficient2013" ref-type="bibr">Schaeffer,
  2013</xref>), and available in Julia through
  <ext-link ext-link-type="uri" xlink:href="https://github.com/fgerick/SHTns.jl">SHTns.jl</ext-link>.
  It is used to transform the spectral coefficients to vector fields
  evaluated on a spatial grid. <monospace>Limace.jl</monospace> does not
  provide any plotting routines, but some examples are given, leaving
  the choice of plotting library up to the user.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>I have received funding from the European Research Council (ERC)
  GRACEFUL Synergy Grant No. 855677. This project has been funded by ESA
  in the framework of EO Science for Society, through contract
  4000127193/19/NL/IA (SWARM + 4D Deep Earth: Core).</p>
  <p>I thank Phil Livermore for the key contributions in the theoretical
  development of the model.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-bezansonjulia2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bezanson</surname><given-names>Jeff</given-names></name>
        <name><surname>Edelman</surname><given-names>Alan</given-names></name>
        <name><surname>Karpinski</surname><given-names>Stefan</given-names></name>
        <name><surname>Shah</surname><given-names>Viral B</given-names></name>
      </person-group>
      <article-title>Julia: A Fresh Approach to Numerical Computing</article-title>
      <source>SIAM Review</source>
      <year iso-8601-date="2017">2017</year>
      <volume>59</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1137/141000671</pub-id>
      <fpage>65</fpage>
      <lpage>98</lpage>
    </element-citation>
  </ref>
  <ref id="ref-iversscalar2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ivers</surname><given-names>D. J.</given-names></name>
        <name><surname>Phillips</surname><given-names>C. G.</given-names></name>
      </person-group>
      <article-title>Scalar and vector spherical harmonic spectral equations of rotating magnetohydrodynamics</article-title>
      <source>Geophysical Journal International</source>
      <year iso-8601-date="2008-12">2008</year><month>12</month>
      <volume>175</volume>
      <issue>3</issue>
      <issn>0956-540X</issn>
      <pub-id pub-id-type="doi">10.1111/j.1365-246X.2008.03944.x</pub-id>
      <fpage>955</fpage>
      <lpage>974</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gerickinterannual2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gerick</surname><given-names>F.</given-names></name>
        <name><surname>Livermore</surname><given-names>P. W.</given-names></name>
      </person-group>
      <article-title>Interannual Magneto–Coriolis modes and their sensitivity on the magnetic field within the Earth’s core</article-title>
      <source>Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</source>
      <publisher-name>Royal Society</publisher-name>
      <year iso-8601-date="2024-10">2024</year><month>10</month>
      <volume>480</volume>
      <issue>2299</issue>
      <pub-id pub-id-type="doi">10.1098/rspa.2024.0184</pub-id>
      <fpage>20240184</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-malkushydromagnetic1967">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Malkus</surname><given-names>Willem V R</given-names></name>
      </person-group>
      <article-title>Hydromagnetic planetary waves</article-title>
      <source>Journal of Fluid Mechanics</source>
      <year iso-8601-date="1967">1967</year>
      <volume>28</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1017/S0022112067002447</pub-id>
      <fpage>793</fpage>
      <lpage>802</lpage>
    </element-citation>
  </ref>
  <ref id="ref-trianaviscous2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Triana</surname><given-names>Santiago A.</given-names></name>
        <name><surname>Trinh</surname><given-names>Antony</given-names></name>
        <name><surname>Rekier</surname><given-names>Jérémy</given-names></name>
        <name><surname>Zhu</surname><given-names>Ping</given-names></name>
        <name><surname>Dehant</surname><given-names>Véronique</given-names></name>
      </person-group>
      <article-title>The Viscous and Ohmic Damping of the Earth’s Free Core Nutation</article-title>
      <source>Journal of Geophysical Research: Solid Earth</source>
      <year iso-8601-date="2021">2021</year>
      <volume>126</volume>
      <issue>4</issue>
      <issn>2169-9356</issn>
      <pub-id pub-id-type="doi">10.1029/2020JB021042</pub-id>
      <fpage>e2020JB021042</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-luowaves2022a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Luo</surname><given-names>Jiawen</given-names></name>
        <name><surname>Marti</surname><given-names>Philippe</given-names></name>
        <name><surname>Jackson</surname><given-names>Andrew</given-names></name>
      </person-group>
      <article-title>Waves in the Earth’s core. II. Magneto–Coriolis modes</article-title>
      <source>Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</source>
      <publisher-name>Royal Society</publisher-name>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <volume>478</volume>
      <issue>2261</issue>
      <pub-id pub-id-type="doi">10.1098/rspa.2022.0108</pub-id>
      <fpage>20220108</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-luowaves2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Luo</surname><given-names>Jiawen</given-names></name>
        <name><surname>Jackson</surname><given-names>Andrew</given-names></name>
      </person-group>
      <article-title>Waves in the Earth’s core. I. Mildly diffusive torsional oscillations</article-title>
      <source>Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</source>
      <publisher-name>Royal Society</publisher-name>
      <year iso-8601-date="2022-03">2022</year><month>03</month>
      <volume>478</volume>
      <issue>2259</issue>
      <pub-id pub-id-type="doi">10.1098/rspa.2021.0982</pub-id>
      <fpage>20210982</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-trianacore2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Triana</surname><given-names>Santiago A.</given-names></name>
        <name><surname>Dumberry</surname><given-names>Mathieu</given-names></name>
        <name><surname>Cébron</surname><given-names>David</given-names></name>
        <name><surname>Vidal</surname><given-names>Jérémie</given-names></name>
        <name><surname>Trinh</surname><given-names>Antony</given-names></name>
        <name><surname>Gerick</surname><given-names>Felix</given-names></name>
        <name><surname>Rekier</surname><given-names>Jérémy</given-names></name>
      </person-group>
      <article-title>Core Eigenmodes and their Impact on the Earth’s Rotation</article-title>
      <source>Surveys in Geophysics</source>
      <year iso-8601-date="2022-02">2022</year><month>02</month>
      <volume>43</volume>
      <issue>1</issue>
      <issn>1573-0956</issn>
      <pub-id pub-id-type="doi">10.1007/s10712-021-09668-y</pub-id>
      <fpage>107</fpage>
      <lpage>148</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gerickfast2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gerick</surname><given-names>F.</given-names></name>
        <name><surname>Jault</surname><given-names>D.</given-names></name>
        <name><surname>Noir</surname><given-names>J.</given-names></name>
      </person-group>
      <article-title>Fast Quasi-Geostrophic Magneto-Coriolis Modes in the Earth’s Core</article-title>
      <source>Geophysical Research Letters</source>
      <year iso-8601-date="2021">2021</year>
      <volume>48</volume>
      <issue>4</issue>
      <issn>1944-8007</issn>
      <pub-id pub-id-type="doi">10.1029/2020GL090803</pub-id>
      <fpage>e2020GL090803</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-schaefferefficient2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schaeffer</surname><given-names>Nathanaël</given-names></name>
      </person-group>
      <article-title>Efficient spherical harmonic transforms aimed at pseudospectral numerical simulations</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2013">2013</year>
      <volume>14</volume>
      <issue>3</issue>
      <issn>1525-2027</issn>
      <pub-id pub-id-type="doi">10.1002/ggge.20071</pub-id>
      <fpage>751</fpage>
      <lpage>758</lpage>
    </element-citation>
  </ref>
  <ref id="ref-johanssonfast2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johansson</surname><given-names>H. T.</given-names></name>
        <name><surname>Forssén</surname><given-names>C.</given-names></name>
      </person-group>
      <article-title>Fast and Accurate Evaluation of Wigner 3j, 6j, and 9j Symbols Using Prime Factorization and Multiword Integer Arithmetic</article-title>
      <source>SIAM Journal on Scientific Computing</source>
      <publisher-name>Society for Industrial and Applied Mathematics</publisher-name>
      <year iso-8601-date="2016-01">2016</year><month>01</month>
      <volume>38</volume>
      <issue>1</issue>
      <issn>1064-8275</issn>
      <pub-id pub-id-type="doi">10.1137/15M1021908</pub-id>
      <fpage>A376</fpage>
      <lpage>A384</lpage>
    </element-citation>
  </ref>
  <ref id="ref-jamesadams1973">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>James</surname><given-names>R. W.</given-names></name>
      </person-group>
      <article-title>The Adams and Elsasser Dynamo Integrals</article-title>
      <source>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences</source>
      <publisher-name>The Royal Society</publisher-name>
      <year iso-8601-date="1973">1973</year>
      <volume>331</volume>
      <issue>1587</issue>
      <issn>0080-4630</issn>
      <uri>https://www.jstor.org/stable/78350</uri>
      <fpage>469</fpage>
      <lpage>478</lpage>
    </element-citation>
  </ref>
  <ref id="ref-davisalgorithm2004">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Davis</surname><given-names>Timothy A.</given-names></name>
      </person-group>
      <article-title>Algorithm 832: UMFPACK V4.3—an unsymmetric-pattern multifrontal method</article-title>
      <source>ACM Transactions on Mathematical Software</source>
      <year iso-8601-date="2004-06">2004</year><month>06</month>
      <volume>30</volume>
      <issue>2</issue>
      <issn>0098-3500</issn>
      <pub-id pub-id-type="doi">10.1145/992200.992206</pub-id>
      <fpage>196</fpage>
      <lpage>199</lpage>
    </element-citation>
  </ref>
  <ref id="ref-StoppelsArnoldiMethod">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Stoppels</surname><given-names>Harmen Taeke</given-names></name>
        <name><surname>Nyman</surname><given-names>Lauri</given-names></name>
      </person-group>
      <article-title>ArnoldiMethod.jl: Arnoldi Method with Krylov-Schur restart, natively in Julia</article-title>
      <uri>https://github.com/JuliaLinearAlgebra/ArnoldiMethod.jl</uri>
    </element-citation>
  </ref>
  <ref id="ref-hidefree1966">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hide</surname><given-names>Raymond</given-names></name>
      </person-group>
      <article-title>Free hydromagnetic oscillations of the Earth’s core and the theory of the geomagnetic secular variation</article-title>
      <source>Philosophical Transactions of the Royal Society of London A: Mathematical, Physical and Engineering Sciences</source>
      <year iso-8601-date="1966">1966</year>
      <volume>259</volume>
      <issue>1107</issue>
      <pub-id pub-id-type="doi">10.1098/rsta.1966.0026</pub-id>
      <fpage>615</fpage>
      <lpage>647</lpage>
    </element-citation>
  </ref>
  <ref id="ref-malkushydromagnetic1967">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Malkus</surname><given-names>Willem V R</given-names></name>
      </person-group>
      <article-title>Hydromagnetic planetary waves</article-title>
      <source>Journal of Fluid Mechanics</source>
      <year iso-8601-date="1967">1967</year>
      <volume>28</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1017/S0022112067002447</pub-id>
      <fpage>793</fpage>
      <lpage>802</lpage>
    </element-citation>
  </ref>
  <ref id="ref-braginskytorsional1970">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Braginsky</surname><given-names>S. I.</given-names></name>
      </person-group>
      <article-title>Torsional magnetohydrodynamics vibrations in the Earth’s core and variations in day length</article-title>
      <source>Geomagnetism and Aeronomy</source>
      <year iso-8601-date="1970">1970</year>
      <volume>10</volume>
      <fpage>3</fpage>
      <lpage>12</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gilletsatellite2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gillet</surname><given-names>Nicolas</given-names></name>
        <name><surname>Gerick</surname><given-names>Felix</given-names></name>
        <name><surname>Jault</surname><given-names>Dominique</given-names></name>
        <name><surname>Schwaiger</surname><given-names>Tobias</given-names></name>
        <name><surname>Aubert</surname><given-names>Julien</given-names></name>
        <name><surname>Istas</surname><given-names>Mathieu</given-names></name>
      </person-group>
      <article-title>Satellite magnetic data reveal interannual waves in Earth’s core</article-title>
      <source>Proceedings of the National Academy of Sciences</source>
      <publisher-name>Proceedings of the National Academy of Sciences</publisher-name>
      <year iso-8601-date="2022-03">2022</year><month>03</month>
      <volume>119</volume>
      <issue>13</issue>
      <pub-id pub-id-type="doi">10.1073/pnas.2115258119</pub-id>
      <fpage>e2115258119</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-livermoregalerkin2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Livermore</surname><given-names>Philip W.</given-names></name>
      </person-group>
      <article-title>Galerkin orthogonal polynomials</article-title>
      <source>Journal of Computational Physics</source>
      <year iso-8601-date="2010-03">2010</year><month>03</month>
      <volume>229</volume>
      <issue>6</issue>
      <issn>0021-9991</issn>
      <pub-id pub-id-type="doi">10.1016/j.jcp.2009.11.022</pub-id>
      <fpage>2046</fpage>
      <lpage>2060</lpage>
    </element-citation>
  </ref>
  <ref id="ref-chenoptimal2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chen</surname><given-names>L.</given-names></name>
        <name><surname>Herreman</surname><given-names>W.</given-names></name>
        <name><surname>Li</surname><given-names>K.</given-names></name>
        <name><surname>Livermore</surname><given-names>P. W.</given-names></name>
        <name><surname>Luo</surname><given-names>J. W.</given-names></name>
        <name><surname>Jackson</surname><given-names>A.</given-names></name>
      </person-group>
      <article-title>The optimal kinematic dynamo driven by steady flows in a sphere</article-title>
      <source>Journal of Fluid Mechanics</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2018-03">2018</year><month>03</month>
      <volume>839</volume>
      <issn>0022-1120</issn>
      <pub-id pub-id-type="doi">10.1017/jfm.2017.924</pub-id>
      <fpage>1</fpage>
      <lpage>32</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
