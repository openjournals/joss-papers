<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8901</article-id>
<article-id pub-id-type="doi">10.21105/joss.08901</article-id>
<title-group>
<article-title>PyMetric: A Geometry Informed Array Mathematics
Package</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0005-9389-9098</contrib-id>
<name>
<surname>Diggins</surname>
<given-names>Eliza C.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9110-2245</contrib-id>
<name>
<surname>Wik</surname>
<given-names>Daniel R.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>University of Utah Department of Physics and Astronomy,
Salt Lake City, Utah, USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-06-11">
<day>11</day>
<month>6</month>
<year>2025</year>
</pub-date>
<volume>11</volume>
<issue>117</issue>
<fpage>8901</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2026</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>differential geometry</kwd>
<kwd>modeling</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>PyMetric is a lightweight Python library designed to streamline
  differential geometry and vector calculus operations in user-defined
  coordinate systems, with a focus on applications in astrophysics and
  computational physics. The library was originally created to provide a
  geometric backend for the Pisces project, an in-development, general
  purpose astrophysical modeling and initial conditions library, but has
  since grown into an independent library due to its size and
  complexity. In many physical modeling tasks, it is both natural and
  advantageous to work in non-Cartesian coordinate systems that align
  with the inherent symmetries of the system. These coordinate systems
  can feature complex geometric structure which, makes the explicit
  handling of differential operations cumbersome. This is particularly
  true for exotic coordinate systems (e.g., homoeoidal coordinate
  systems). PyMetric provides a unified abstraction that decouples the
  underlying coordinate representation from the operations themselves,
  allowing users to accurately compute gradients, divergences,
  Laplacians, and related geometric quantities through a consistent (and
  coordinate system agnostic) interface. This makes it easier to
  prototype and scale models in complex geometries without having to
  rewrite operations for each coordinate system.</p>
  <p>The core design of PyMetric relies on a hybrid symbolic-numeric
  model that balances efficiency, flexibility, and accuracy. Symbolic
  computation is used to derive key geometric quantities, such as metric
  tensors, Christoffel symbols, and Jacobians, from a minimal set of
  coordinate system properties. Once generated, these symbolic
  structures can be converted into efficient numerical routines that
  operate on array-backed data and are composed to perform higher-level
  operations. This approach allows PyMetric to support coordinate-aware
  computation with minimal overhead, avoiding the need for repeated
  symbolic manipulation during runtime, while maintaining high accuracy
  through analytically correct geometric expressions. The result is a
  powerful and extensible framework that enables NumPy-style
  (<xref alt="Harris et al., 2020" rid="ref-harris2020array" ref-type="bibr">Harris
  et al., 2020</xref>) workflows in complex coordinate systems without
  sacrificing physical fidelity.</p>
  <p>In addition to its symbolic-numeric foundation, PyMetric provides
  structured abstractions for grids and field data, supporting a range
  of coordinate systems and buffer backends. Because the PyMetric field
  abstraction is only minimally coupled to the underlying data storage,
  it can interface with a variety of array backends, including in-memory
  arrays and HDF5
  (<xref alt="The HDF Group, n.d." rid="ref-hdf5" ref-type="bibr">The
  HDF Group, n.d.</xref>) storage for lazy-loading and chunked
  computation. This design enables coordinate-aware operations to be
  applied efficiently to large, multidimensional datasets without
  compromising generality or performance.</p>
  <p>By automating core geometric operations across coordinate systems,
  PyMetric simplifies the development of physics-based modeling software
  that requires flexible geometric handling. Its design supports a broad
  spectrum of scientific computing applications, from simulating
  relativistic fluids to analyzing gravitational fields. In doing so,
  PyMetric establishes a modern and extensible foundation for
  geometry-aware computation in Python, enabling the creation of
  accurate, efficient, and scalable models in complex coordinate
  geometries.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Modern astrophysical modeling requires a high degree of
  flexibility—both in physical assumptions and in computational
  infrastructure. The Pisces Project (of which PyMetric is a part) is a
  general-purpose model-building framework for astrophysics that aims to
  unify and extend existing tools for generating models and initial
  conditions (e.g., DICE
  (<xref alt="Perret, 2016" rid="ref-perret2016dice" ref-type="bibr">Perret,
  2016</xref>), GALIC
  (<xref alt="Yurin &amp; Springel, 2014" rid="ref-yurin2014galic" ref-type="bibr">Yurin
  &amp; Springel, 2014</xref>)) under a common, modular API. Its goal is
  to make it easier to construct complex, physically motivated models of
  systems such as galaxies, black holes, or relativistic fluids by
  exposing a simple and extensible interface for defining models,
  fields, and dynamics.</p>
  <p>A persistent challenge in building such extensible modeling tools
  is the limited and inconsistent support for coordinate systems found
  in most existing software. Codes like EinsteinPy
  (<xref alt="EinsteinPy Development Team, 2024" rid="ref-einsteinpy" ref-type="bibr">EinsteinPy
  Development Team, 2024</xref>), DICE, and yt
  (<xref alt="Turk et al., 2010" rid="ref-turk2010yt" ref-type="bibr">Turk
  et al., 2010</xref>) often hard-code assumptions about coordinate
  geometry, making them difficult to generalize to new physical contexts
  or non-Cartesian coordinate systems. This lack of abstraction limits
  reusability and complicates the construction of unified modeling
  workflows across domains such as general relativity, galactic
  dynamics, and fluid mechanics.</p>
  <p>To address this limitation, PyMetric was developed to be a
  lightweight library that standardizes coordinate-aware geometric
  computation. The library is designed to serve as the geometric backend
  for Pisces and similar modeling systems. It provides a consistent
  abstraction layer for defining coordinate systems, computing
  differential geometric quantities, and evaluating operators like
  gradients, divergences, and Laplacians, all without requiring the user
  to manage low-level details of tensor algebra or coordinate
  transformations.</p>
  <p>PyMetric emphasizes extensibility and modularity through four core
  interfaces:</p>
  <list list-type="bullet">
    <list-item>
      <p><bold>Coordinate System API</bold> – Enables the definition and
      use of arbitrary coordinate systems with minimal required
      knowledge, while supporting symbolic derivation of
      metric-dependent quantities</p>
    </list-item>
    <list-item>
      <p><bold>Buffer API</bold> – Provides a backend-agnostic interface
      for array storage, allowing seamless integration with systems like
      HDF5, XArray, Dask, and unit-aware arrays</p>
    </list-item>
    <list-item>
      <p><bold>Differential Geometry API</bold> – Implements low-level,
      coordinate-independent formulations of core operations such as
      gradients, divergences, Laplacians, and volume elements</p>
    </list-item>
    <list-item>
      <p><bold>Grid and Field API</bold> – Supports flexible
      discretization strategies and a variety of field types, including
      sparse and dense scalar, vector, and tensor fields</p>
    </list-item>
  </list>
  <p>Together, these abstractions form a unified symbolic-numeric
  pipeline that allows high-level modeling code to operate naturally
  across diverse geometries and data representations. By standardizing
  geometric computation and decoupling it from specific coordinate
  assumptions or backend implementations, PyMetric addresses a
  longstanding gap in scientific Python infrastructure. This foundation
  enables Pisces to offer a powerful, composable, and user-friendly
  environment for building physically accurate models in astrophysics
  and beyond.</p>
</sec>
<sec id="methodology">
  <title>Methodology</title>
  <p>The core methodology behind PyMetric centers on a mathematically
  rigorous yet computationally practical framework for performing
  differential geometry operations in arbitrary coordinate systems. The
  library is designed to support seamless transitions between symbolic
  derivation and numerical evaluation, allowing for precise, efficient,
  and geometry-aware modeling.</p>
  <p>A coordinate system in PyMetric is defined minimally by:</p>
  <list list-type="bullet">
    <list-item>
      <p>A set of axes labels <inline-formula><alternatives>
      <tex-math><![CDATA[(x^1, x^2, \ldots)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula></p>
    </list-item>
    <list-item>
      <p>Forward and inverse transformations between these coordinates
      and Cartesian Space <inline-formula><alternatives>
      <tex-math><![CDATA[T(x,y,z)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>T</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[T^{-1}(x^1,x^2,x^3)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mrow><mml:mi>−</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></p>
    </list-item>
    <list-item>
      <p>A symbolically defined metric tensor
      <inline-formula><alternatives>
      <tex-math><![CDATA[g_{\mu\nu}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></p>
    </list-item>
  </list>
  <p>From this core specification, PyMetric constructs key geometric
  quantities, such as the inverse metric <inline-formula><alternatives>
  <tex-math><![CDATA[g^{\mu\nu}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>,
  the metric density <inline-formula><alternatives>
  <tex-math><![CDATA[\sqrt{g}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msqrt><mml:mi>g</mml:mi></mml:msqrt></mml:math></alternatives></inline-formula>,
  and terms appearing in differential operations, such as
  <inline-formula><alternatives>
  <tex-math><![CDATA[L^\nu = g^{-1/2} \partial_\mu (g^{1/2} g^{\mu\nu})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>L</mml:mi><mml:mi>ν</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi>−</mml:mi><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>∂</mml:mi><mml:mi>μ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  which appears in the scalar Laplacian <inline-formula><alternatives>
  <tex-math><![CDATA[\nabla^2 \phi = L^\nu \partial_\nu \phi + g^{\mu\nu} \partial^2_{\mu\nu} \phi]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>∇</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mi>ν</mml:mi></mml:msup><mml:msub><mml:mi>∂</mml:mi><mml:mi>ν</mml:mi></mml:msub><mml:mi>ϕ</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>g</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow></mml:msup><mml:msubsup><mml:mi>∂</mml:mi><mml:mrow><mml:mi>μ</mml:mi><mml:mi>ν</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mi>ϕ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
  These are represented both as symbolic expressions-using SymPy
  (<xref alt="Meurer et al., 2017" rid="ref-sympy" ref-type="bibr">Meurer
  et al., 2017</xref>)-and as NumPy-backed callables. These quantities
  are computed lazily: they are only derived when required for a
  specific operation, avoiding unnecessary overhead.</p>
  <p>Coordinate systems are categorized into types (e.g., orthogonal or
  curvilinear) that determine how symbolic properties are derived and
  which simplifications may apply. This abstraction enables users to
  model highly symmetric systems (e.g., spherical or ellipsoidal
  coordinates) as easily as more general curvilinear systems.</p>
  <sec id="field-and-grid-operations">
    <title>Field and Grid Operations</title>
    <p>Fields in PyMetric are array-backed data structures (typically
    NumPy or HDF5 buffers) that are explicitly associated with a
    coordinate system and grid. The grid handling supports flexible
    discretization strategies, including cell-centered and node-centered
    layouts, as well as ghost zones for finite-difference operations.
    Support is currently provided for single-grid configurations with
    arbitrary spacing; however, multigrid extension is planned for
    future releases. While fields behave like standard NumPy arrays,
    they also carry metadata about their geometric context, including
    coordinate labels, spacing, and metric-aware tensor properties.</p>
    <p>Operations on fields, such as computing covariant derivatives,
    applying Laplacians, or transforming between bases, are
    automatically dispatched to appropriate symbolic expressions and
    numerical kernels based on the field’s variance and the geometry of
    the underlying coordinate system.</p>
    <p>This design allows users to write high-level, reusable code that
    is agnostic to the specific geometry, while still benefiting from
    the mathematical correctness and efficiency of coordinate-aware
    computation.</p>
  </sec>
  <sec id="future-development">
    <title>Future Development</title>
    <p>The development roadmap for PyMetric is focused on deepening its
    mathematical capabilities and expanding its utility in advanced
    physical modeling contexts, particularly those involving curved and
    relativistic spacetimes. While the current implementation supports a
    robust suite of differential operators in orthogonal and curvilinear
    coordinate systems, several avenues for future growth are
    planned:</p>
    <list list-type="order">
      <list-item>
        <p>Expanded Differential Operator Support:</p>
        <p>PyMetric will be extended to support a broader range of
        tensor calculus operations, including:</p>
        <list list-type="bullet">
          <list-item>
            <p>Covariant derivatives of higher-rank tensors, enabling
            modeling of tensor transport and geodesic deviation</p>
          </list-item>
          <list-item>
            <p>Tensor contractions and curvature operations, including
            the Riemann, Ricci, and Einstein tensors, to support
            simulations in general relativity and cosmology</p>
          </list-item>
        </list>
      </list-item>
    </list>
    <p>These features will allow PyMetric to serve as a general-purpose
    differential geometry engine suitable for high-fidelity modeling in
    physics, engineering, and applied mathematics.</p>
    <list list-type="order">
      <list-item>
        <label>2.</label>
        <p>Relativistic and Non-Flat Coordinate Systems</p>
        <list list-type="bullet">
          <list-item>
            <p>A key area of expansion is support for relativistic
            geometries, where the metric tensor is no longer
            positive-definite and may depend dynamically on spacetime
            coordinates. Planned features include:</p>
          </list-item>
          <list-item>
            <p>General Lorentzian manifolds, including Schwarzschild,
            Kerr, and FLRW spacetimes, enabling direct modeling of
            astrophysical systems governed by Einstein’s field
            equations.</p>
          </list-item>
        </list>
      </list-item>
    </list>
    <p>PyMetric is explicitly intended to be a modeling and analysis
    tool, not a time-domain simulation engine. It provides geometric
    infrastructure for constructing and analyzing equations defined on
    curved spacetimes, but does not aim to solve dynamical systems or
    perform numerical integration of time-evolving fields.</p>
  </sec>
</sec>
<sec id="usage-example">
  <title>Usage Example</title>
  <p>To demonstrate the basic capabilities of the Pymetric library, we
  include a simple example of the typical workflow computing the
  Laplacian (<inline-formula><alternatives>
  <tex-math><![CDATA[\nabla^2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>∇</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>)
  of a field in spherical coordinates. We use
  <inline-formula><alternatives>
  <tex-math><![CDATA[F(r, \theta) = r \cos(\theta)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  as our test function, which has a known Laplacian of zero. A
  visualization of <inline-formula><alternatives>
  <tex-math><![CDATA[F(r, \theta)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  and its Laplacian is shown in Figure 1, demonstrating the library’s
  ability to perform geometry-aware computations directly on array
  data.</p>
  <code language="python">import pymetric as pym
import numpy as np

# Define spherical coordinate system and grid
cs = pym.coordinates.SphericalCoordinateSystem()
grid = pym.grids.GenericGrid(
    cs,
    [
        np.linspace(0.1, 4.9, 300),                # r
        np.linspace(0.01, np.pi - 0.01, 100),      # theta
        np.linspace(0.01, 2 * np.pi - 0.01, 100),  # phi
    ],
    center=&quot;cell&quot;,
    bbox=[(0, 5), (0, np.pi), (0, 2 * np.pi)],
    ghost_zones=2,
)

# Define scalar field F(r, theta) = r * cos(theta)
# This is a good test case since Lap(F) = 0.
field = pym.DenseField.from_function(
    lambda r, theta: r * np.cos(theta),
    grid,
    axes=[&quot;r&quot;, &quot;theta&quot;],
)

# Compute Laplacian
F_lap = field.element_wise_laplacian()</code>
  <fig>
    <caption><p>A scalar field <inline-formula><alternatives>
    <tex-math><![CDATA[F(r,\theta) = r\cos(\theta)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>r</mml:mi><mml:mo>cos</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    and its Laplacian <inline-formula><alternatives>
    <tex-math><![CDATA[\nabla^2 F(r,\theta)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>∇</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
    computed in spherical coordinates using PyMetric.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="fig1.png" />
  </fig>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-harris2020array">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harris</surname><given-names>Charles R</given-names></name>
        <name><surname>Millman</surname><given-names>K Jarrod</given-names></name>
        <name><surname>Van Der Walt</surname><given-names>Stéfan J</given-names></name>
        <name><surname>Gommers</surname><given-names>Ralf</given-names></name>
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>Cournapeau</surname><given-names>David</given-names></name>
        <name><surname>Wieser</surname><given-names>Eric</given-names></name>
        <name><surname>Taylor</surname><given-names>Julian</given-names></name>
        <name><surname>Berg</surname><given-names>Sebastian</given-names></name>
        <name><surname>Smith</surname><given-names>Nathaniel J</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Array programming with NumPy</article-title>
      <source>Nature</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>585</volume>
      <issue>7825</issue>
      <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
      <fpage>357</fpage>
      <lpage>362</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hdf5">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <string-name>The HDF Group</string-name>
      </person-group>
      <article-title>Hierarchical Data Format, version 5</article-title>
      <uri>https://github.com/HDFGroup/hdf5</uri>
    </element-citation>
  </ref>
  <ref id="ref-einsteinpy">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>EinsteinPy Development Team</string-name>
      </person-group>
      <source>EinsteinPy: Python library for general relativity</source>
      <year iso-8601-date="2024">2024</year>
      <uri>https://einsteinpy.org/</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2005.11288</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-perret2016dice">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Perret</surname><given-names>Valentin</given-names></name>
      </person-group>
      <article-title>DICE: Disk initial conditions environment</article-title>
      <source>Astrophysics Source Code Library</source>
      <year iso-8601-date="2016">2016</year>
      <fpage>ascl</fpage>
      <lpage>1607</lpage>
    </element-citation>
  </ref>
  <ref id="ref-yurin2014galic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yurin</surname><given-names>Denis</given-names></name>
        <name><surname>Springel</surname><given-names>Volker</given-names></name>
      </person-group>
      <article-title>GALIC: Galaxy initial conditions construction</article-title>
      <source>Astrophysics Source Code Library</source>
      <year iso-8601-date="2014">2014</year>
      <pub-id pub-id-type="doi">10.48550/arXiv.1402.1623</pub-id>
      <fpage>ascl</fpage>
      <lpage>1408</lpage>
    </element-citation>
  </ref>
  <ref id="ref-turk2010yt">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Turk</surname><given-names>Matthew J</given-names></name>
        <name><surname>Smith</surname><given-names>Britton D</given-names></name>
        <name><surname>Oishi</surname><given-names>Jeffrey S</given-names></name>
        <name><surname>Skory</surname><given-names>Stephen</given-names></name>
        <name><surname>Skillman</surname><given-names>Samuel W</given-names></name>
        <name><surname>Abel</surname><given-names>Tom</given-names></name>
        <name><surname>Norman</surname><given-names>Michael L</given-names></name>
      </person-group>
      <article-title>Yt: A multi-code analysis toolkit for astrophysical simulation data</article-title>
      <source>The Astrophysical Journal Supplement Series</source>
      <publisher-name>IOP Publishing</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>192</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1088/0067-0049/192/1/9</pub-id>
      <fpage>9</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-sympy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Meurer</surname><given-names>Aaron</given-names></name>
        <name><surname>Smith</surname><given-names>Christopher P.</given-names></name>
        <name><surname>Paprocki</surname><given-names>Mateusz</given-names></name>
        <name><surname>Čertík</surname><given-names>Ondřej</given-names></name>
        <name><surname>Kirpichev</surname><given-names>Sergey B.</given-names></name>
        <name><surname>Rocklin</surname><given-names>Matthew</given-names></name>
        <name><surname>Kumar</surname><given-names>AMiT</given-names></name>
        <name><surname>Ivanov</surname><given-names>Sergiu</given-names></name>
        <name><surname>Moore</surname><given-names>Jason K.</given-names></name>
        <name><surname>Singh</surname><given-names>Sartaj</given-names></name>
        <name><surname>Rathnayake</surname><given-names>Thilina</given-names></name>
        <name><surname>Vig</surname><given-names>Sean</given-names></name>
        <name><surname>Granger</surname><given-names>Brian E.</given-names></name>
        <name><surname>Muller</surname><given-names>Richard P.</given-names></name>
        <name><surname>Bonazzi</surname><given-names>Francesco</given-names></name>
        <name><surname>Gupta</surname><given-names>Harsh</given-names></name>
        <name><surname>Vats</surname><given-names>Shivam</given-names></name>
        <name><surname>Johansson</surname><given-names>Fredrik</given-names></name>
        <name><surname>Pedregosa</surname><given-names>Fabian</given-names></name>
        <name><surname>Curry</surname><given-names>Matthew J.</given-names></name>
        <name><surname>Terrel</surname><given-names>Andy R.</given-names></name>
        <name><surname>Roučka</surname><given-names>Štěpán</given-names></name>
        <name><surname>Saboo</surname><given-names>Ashutosh</given-names></name>
        <name><surname>Fernando</surname><given-names>Isuru</given-names></name>
        <name><surname>Kulal</surname><given-names>Sumith</given-names></name>
        <name><surname>Cimrman</surname><given-names>Robert</given-names></name>
        <name><surname>Scopatz</surname><given-names>Anthony</given-names></name>
      </person-group>
      <article-title>SymPy: Symbolic computing in python</article-title>
      <source>PeerJ Computer Science</source>
      <year iso-8601-date="2017-01">2017</year><month>01</month>
      <volume>3</volume>
      <issn>2376-5992</issn>
      <uri>https://doi.org/10.7717/peerj-cs.103</uri>
      <pub-id pub-id-type="doi">10.7717/peerj-cs.103</pub-id>
      <fpage>e103</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
