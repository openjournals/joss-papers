<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">5587</article-id>
<article-id pub-id-type="doi">10.21105/joss.05587</article-id>
<title-group>
<article-title>CRE: An R package for interpretable discovery and
inference of heterogeneous treatment effects</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2416-8943</contrib-id>
<name>
<surname>Cadei</surname>
<given-names>Riccardo</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4315-1426</contrib-id>
<name>
<surname>Khoshnevis</surname>
<given-names>Naeem</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5823-4331</contrib-id>
<name>
<surname>Lee</surname>
<given-names>Kwonsang</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3226-3561</contrib-id>
<name>
<surname>Garcia</surname>
<given-names>Daniela Maria</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6131-8165</contrib-id>
<name>
<surname>Stoffi</surname>
<given-names>Falco J. Bargagli</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Biostatistics, Harvard School of Public
Health, Boston, Massachusetts, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Department of Computer and Communication Science, École
Polytechnique Fédérale de Lausanne, Lausanne, Switzerland</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Research Computing, Harvard University, Cambridge,
Massachusetts, United States of America</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2023-03-15">
<day>15</day>
<month>3</month>
<year>2023</year>
</pub-date>
<volume>8</volume>
<issue>92</issue>
<fpage>5587</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>causal inference</kwd>
<kwd>heterogeneous effect</kwd>
<kwd>interpretability</kwd>
<kwd>machine learning</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>In health and social sciences, it is critically important to
  identify interpretable subgroups of the study population where a
  treatment has notable heterogeneity in the causal effects with respect
  to the average treatment effect (ATE). Several approaches have already
  been proposed for heterogeneous treatment effect (HTE) discovery,
  either estimating first the conditional average treatment effect
  (CATE) and identifying heterogeneous subgroups in a second stage
  (<xref alt="Bargagli-Stoffi et al., 2020" rid="ref-bargagli2020heterogeneous" ref-type="bibr">Bargagli-Stoffi
  et al., 2020</xref>,
  <xref alt="2022" rid="ref-bargagli2022heterogeneous" ref-type="bibr">2022</xref>;
  <xref alt="Foster et al., 2011" rid="ref-foster2011subgroup" ref-type="bibr">Foster
  et al., 2011</xref>;
  <xref alt="Hahn et al., 2020" rid="ref-hahn2020bayesian" ref-type="bibr">Hahn
  et al., 2020</xref>), either estimating directly these subgroups in a
  direct data-driven procedure
  (<xref alt="Nagpal et al., 2020" rid="ref-nagpal2020interpretable" ref-type="bibr">Nagpal
  et al., 2020</xref>;
  <xref alt="Wang &amp; Rudin, 2022" rid="ref-wang2022causal" ref-type="bibr">Wang
  &amp; Rudin, 2022</xref>). Many of these methodologies are decision
  tree-based methodologies. Tree-based approaches are based on efficient
  and easily implementable recursive mathematical programming (e.g., HTE
  maximization), they can be easily tweaked and adapted to different
  scenarios depending on the research question of interest, and they
  guarantee a high degree of interpretability—i.e., the degree to which
  a human can understand the cause of a decision
  (<xref alt="Lakkaraju et al., 2016" rid="ref-lakkaraju2016interpretable" ref-type="bibr">Lakkaraju
  et al., 2016</xref>). Despite these appealing features, single-tree
  heterogeneity discovery is characterized by two main limitations:
  instability in the identification of the subgroups and reduced
  exploration of the potential heterogeneity. To accommodate these
  shortcomings, Bargagli-Stoffi et al.
  (<xref alt="2023" rid="ref-bargagli2023causal" ref-type="bibr">2023</xref>)
  proposed Causal Rule Ensemble, a new method for interpretable HTE
  characterization in terms of decision rules, via an extensive
  exploration of heterogeneity patterns by an ensemble-of-trees
  approach. <monospace>CRE</monospace> is an R package providing a
  flexible implementation of Causal Rule Ensemble. The package allows
  for multiple variants of Causal Rule Ensemble algorithm, also
  including different internal individual average treatment effect
  (IATE) estimators—i.e., AIPW
  (<xref alt="Robins et al., 1994" rid="ref-robins1994estimation" ref-type="bibr">Robins
  et al., 1994</xref>), Causal Forest
  (<xref alt="Athey et al., 2019" rid="ref-athey2019generalized" ref-type="bibr">Athey
  et al., 2019</xref>), Causal BART
  (<xref alt="Hill, 2011" rid="ref-hill2011bayesian" ref-type="bibr">Hill,
  2011</xref>), S-Learner
  (<xref alt="Hill, 2011" rid="ref-hill2011bayesian" ref-type="bibr">Hill,
  2011</xref>), T-Learner
  (<xref alt="Hansotia &amp; Rukstales, 2002" rid="ref-hansotia2002incremental" ref-type="bibr">Hansotia
  &amp; Rukstales, 2002</xref>), X-Learner
  (<xref alt="Künzel et al., 2019" rid="ref-kunzel2019metalearners" ref-type="bibr">Künzel
  et al., 2019</xref>).</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Several methodologies for HTE estimation have already been proposed
  (together with the release of the corresponding packages), but the
  interpretable discovery of the subgroups and the key factors driving
  the HTE is still an open challenge. To the best of our knowledge,
  <monospace>causalTree</monospace>, based on Causal Honest Tree
  (<xref alt="Athey &amp; Imbens, 2016" rid="ref-athey2016" ref-type="bibr">Athey
  &amp; Imbens, 2016</xref>), is the unique R package proposing a
  methodology for interpretable HTE discovery and estimation via
  decision rules. Still, despite its appealing features, it is also
  characterized by the limitations of single tree-based methods.
  Firstly, single-tree-based subgroup identification is sensitive to
  variations in the training sample (high model variance)—e.g., if the
  data are slightly altered, a completely different set of discovered
  subgroups might be found
  (<xref alt="Breiman, 1996" rid="ref-breiman1996heuristics" ref-type="bibr">Breiman,
  1996</xref>;
  <xref alt="Hastie et al., 2009" rid="ref-hastie2009elements" ref-type="bibr">Hastie
  et al., 2009</xref>;
  <xref alt="Kuhn et al., 2013" rid="ref-kuhn2013applied" ref-type="bibr">Kuhn
  et al., 2013</xref>). Secondly, it may fail to explore a vast number
  of potential subgroups (limited subgroup exploration)—e.g., the
  subgroups discovered are just the ones that can be represented by a
  single tree
  (<xref alt="Kuhn et al., 2013" rid="ref-kuhn2013applied" ref-type="bibr">Kuhn
  et al., 2013</xref>;
  <xref alt="Spanbauer &amp; Sparapani, 2021" rid="ref-spanbauer2021nonparametric" ref-type="bibr">Spanbauer
  &amp; Sparapani, 2021</xref>). To illustrate, consider a scenario in
  which two distinct factors independently contribute to the
  heterogeneity in treatment effects. In such cases, a single tree
  algorithm may detect only one of these factors, failing to identify
  the second. In instances where both factors are identified, they are
  detected sub-optimally as an interaction between the two variables
  rather than as distinct drivers of the treatment heterogeneity. To
  account for these shortcomings, we propose <monospace>CRE</monospace>
  (<xref alt="Khoshnevis et al., 2023" rid="ref-cre_r" ref-type="bibr">Khoshnevis
  et al., 2023</xref>), an R package providing a flexible implementation
  of the Causal Rule Ensemble algorithm. <monospace>CRE</monospace>
  provides (i) an interpretable representation of the HTE in
  observational studies, (ii) via an extensive exploration of complex
  heterogeneity patterns using decision rules, while (iii) guaranteeing
  high stability in the discovery.</p>
</sec>
<sec id="algorithm">
  <title>Algorithm</title>
  <p>Causal Rule Ensemble relies on the Treatment Effect linear
  decomposition assumption, which characterizes the Conditional Average
  Treatment Effect (CATE) as the sum of <inline-formula><alternatives>
  <tex-math><![CDATA[M+1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  distinct contributions: <disp-formula><alternatives>
  <tex-math><![CDATA[\tau(\boldsymbol{x}) = \mathbb{E}[\tau_i | X_i=\boldsymbol{x}] = \bar{\tau} + \sum_{m=1}^M \alpha_m \cdot r_m(\boldsymbol{x})]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>τ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐱</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>𝔼</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>𝐱</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover><mml:mi>τ</mml:mi><mml:mo accent="true">‾</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>α</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>𝐱</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\bar{\tau}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>τ</mml:mi><mml:mo accent="true">‾</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
  is the ATE, <inline-formula><alternatives>
  <tex-math><![CDATA[\tau_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>τ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the ITE, and for each <inline-formula><alternatives>
  <tex-math><![CDATA[m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>
  in <inline-formula><alternatives>
  <tex-math><![CDATA[\{1,..., M\}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[r_m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>r</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is an interpretable decision rule characterizing a specific subset of
  the covariate space, and <inline-formula><alternatives>
  <tex-math><![CDATA[\alpha_m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>α</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the corresponding Additive Average Treatment Effect (AATE). The
  <monospace>CRE</monospace> procedure is divided into two steps,
  discovery and inference, and each observation is used for only one of
  the two steps (honest splitting). The splitting is at random and the
  percentage allocated to each step is controlled. During the discovery
  step, <monospace>CRE</monospace> retrieves the
  <inline-formula><alternatives>
  <tex-math><![CDATA[M]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula>
  decision rules characterizing the heterogeneity in the treatment
  effect. A set of candidate decision rules is extracted by an ensemble
  of trees modelling some IATE estimates
  (<xref alt="Dorie et al., 2020" rid="ref-dorie2020package" ref-type="bibr">Dorie
  et al., 2020</xref>;
  <xref alt="Polley et al., 2019" rid="ref-polley2019package" ref-type="bibr">Polley
  et al., 2019</xref>;
  <xref alt="Tibshirani et al., 2023" rid="ref-tibshirani2023package" ref-type="bibr">Tibshirani
  et al., 2023</xref>) (<italic>fit-the-fit</italic> approach), and
  among these, only a simple and robust subset of rules is selected for
  the linear decomposition by the Stability Selection algorithm via
  LASSO
  (<xref alt="Friedman et al., 2021" rid="ref-friedman2021package" ref-type="bibr">Friedman
  et al., 2021</xref>;
  <xref alt="Hofner et al., 2015" rid="ref-hofner2015package" ref-type="bibr">Hofner
  et al., 2015</xref>;
  <xref alt="Meinshausen &amp; Bühlmann, 2010" rid="ref-meinshausen2010stability" ref-type="bibr">Meinshausen
  &amp; Bühlmann, 2010</xref>). During the inference step,
  <monospace>CRE</monospace> estimates the ATE and AATEs, by the normal
  equations to model some IATE estimates and confidence intervals are
  provided by bootstrapping. A brief schematic summary of the described
  procedure
  (<xref alt="Bargagli-Stoffi et al., 2023" rid="ref-bargagli2023causal" ref-type="bibr">Bargagli-Stoffi
  et al., 2023</xref>) is reported below.</p>
  <graphic mimetype="image" mime-subtype="png" xlink:href="media/images/algorithm.png" />
</sec>
<sec id="usage">
  <title>Usage</title>
  <p><monospace>CRE</monospace> is available both on CRAN
  (<xref alt="Khoshnevis et al., 2023" rid="ref-cre_r" ref-type="bibr">Khoshnevis
  et al., 2023</xref>) and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/NSAPH-Software/CRE">GitHub</ext-link>,
  and can be installed and loaded into the R session using:</p>
  <code language="r script">install.packages(&quot;CRE&quot;)
library(&quot;CRE&quot;)</code>
  <p><monospace>generate_cre_dataset()</monospace> is a flexible
  synthetic dataset generator, which can be used for simulations before
  applying <monospace>CRE</monospace> to real-world observational data
  sets. It generates an outcome array <monospace>y</monospace> (binary
  or continuous), a treatment array <monospace>z</monospace> (binary), a
  covariate matrix (binary or continuous) and the true (unobserved)
  individual treatment effect <monospace>ite</monospace> (useful for
  performance evaluation). The input parameters specify the dataset
  characteristics, including the number of individuals
  (<monospace>n</monospace>), the number of covariates
  (<monospace>p</monospace>), the correlation within the covariates
  (<monospace>rho</monospace>), the number of decision rules
  (<monospace>n_rules</monospace>) decomposing the CATE, the treatment
  effect magnitude (<monospace>effect_size</monospace>), the confounding
  mechanism (<monospace>confounding</monospace>), and whether the
  covariates and outcomes are binary or continuous
  (<monospace>binary_covariates</monospace>,
  <monospace>binary_outcome</monospace>). For a full description of the
  data generating process and its variants, see Section 4 in
  Bargagli-Stoffi et al.
  (<xref alt="2023" rid="ref-bargagli2023causal" ref-type="bibr">2023</xref>).</p>
  <code language="r script">set.seed(2023)
dataset &lt;- generate_cre_dataset(n = 5000, 
                                rho = 0, 
                                n_rules = 4, 
                                p = 10,
                                effect_size = 5, 
                                binary_covariates = TRUE,
                                binary_outcome = FALSE,
                                confounding = &quot;no&quot;)
y &lt;- dataset$y
z &lt;- dataset$z
X &lt;- dataset$X
ite &lt;- dataset$ite</code>
  <p>We propose here three examples of how to run the Causal Rule
  Ensemble algorithm by the <monospace>CRE</monospace> package.</p>
  <p><bold>Example 1.</bold> Running Causal Rule Ensemble with default
  parameters. For a detailed description of the default method and hyper
  parameters refer to
  <ext-link ext-link-type="uri" xlink:href="https://nsaph-software.github.io/CRE/articles/CRE.html">https://nsaph-software.github.io/CRE/articles/CRE.html</ext-link>.</p>
  <code language="r script">results &lt;- cre(y, z, X)</code>
  <p><bold>Example 2.</bold> Running Causal Rule Ensemble with
  customized IATE estimator. If <monospace>ite</monospace> argument is
  provided, the IATE estimation both in the discovery and inference step
  is skipped. This argument is useful either to consider new IATE
  estimators which are not internally implemented in this package,
  either to compute this estimation una tantum (saving the results) and
  speed up the execution time during the hyper-parameter tuning.</p>
  <code language="r script"># personalized IATE estimation (S-Learner with Linear Regression)
model &lt;- lm(y ~., data = data.frame(y = y, X = X, z = z))
iate_pred &lt;- predict(model, newdata = data.frame(X = X, z = z))

results &lt;- cre(y, z, X, ite = iate_pred)</code>
  <p><bold>Example 3.</bold> Running Causal Rule Ensemble with
  customized parameters (no need to explicit all the arguments). The
  method parameters (<monospace>method_params</monospace>) entail the
  IATE estimator method, the outcome and propensity score learners, if
  needed), and the the ratio of data to use for each step. The hyper
  parameters (<monospace>hyper_params</monospace>) entail all the other
  parameters through which Causal Rule Ensemble algorithm can be fine
  tuned. For a detailed description of all the method and hyper
  parameters refer to
  <ext-link ext-link-type="uri" xlink:href="https://nsaph-software.github.io/CRE/articles/CRE.html">https://nsaph-software.github.io/CRE/articles/CRE.html</ext-link>.</p>
  <code language="r script">method_params &lt;- list(ratio_dis = 0.5,
                      ite_method = &quot;aipw&quot;,
                      learner_ps = &quot;SL.xgboost&quot;,
                      learner_y = &quot;SL.xgboost&quot;)

hyper_params &lt;- list(intervention_vars = NULL,
                     offset = NULL,
                     ntrees = 20,
                     node_size = 20,
                     max_rules = 100,
                     max_depth = 3,
                     t_decay = 0.025,
                     t_ext = 0.025,
                     t_corr = 1,
                     t_pvalue = 0.05,
                     stability_selection = &quot;vanilla&quot;,
                     cutoff = 0.9,
                     pfer = 0.1,
                     B = 50,
                     subsample = 0.05)

results &lt;- cre(y, z, X, method_params, hyper_params)</code>
  <p>The results are collected in a S3 object containing: the number of
  decision rules extracted at each step (<monospace>M</monospace>), the
  list of the rules finally selected (<monospace>rules</monospace>), a
  <monospace>data.frame</monospace> with the CATE decomposition
  estimates with corresponding uncertainty quantification
  (<monospace>CATE</monospace>) and the list of selected parameters
  (<monospace>method_params</monospace> and
  <monospace>hyper_params</monospace>).</p>
  <p><monospace>summarize()</monospace> and
  <monospace>print()</monospace> display a summary of these results.
  <monospace>predict()</monospace> estimates the Individual Treatment
  Effect on a new Covariate matrix by the linear decomposition just
  learnt. <monospace>plot()</monospace> visualizes the CATE
  decomposition estimates in a range bar plot.</p>
  <code language="r script">print(results)
y_pred &lt;- predict(results, X)
plot(results)</code>
  <p>Figure 1 reports the visualization of the results for Example 3,
  which perfectly discover the correct CATE decomposition.</p>
  <fig>
    <caption><p>Visualization of Causal Rule Ensemble HTE linear
    decomposition for Example 3. For each decision rule discovered, the
    corresponding AATE estimate with 95% confidence interval is reported
    in a range bar plot. The decision rules are ordered from the most
    vulnerable (high AATE) to the least, and the ATE is reported on top
    of the plot.</p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/images/example.pdf" />
  </fig>
  <p>The observed average execution time of the method varying the
  number of individuals and observed covariates on R 4.2.1 running on
  macOS 12.6 on a MacBook Pro 16GB Apple 8-cores M1 processor is
  reported in Figure 2.</p>
  <fig>
    <caption><p>Log-Log line plot reporting the average execution time
    of <monospace>cre()</monospace> and standard deviation over 10 seeds
    per experiment, varying the number of individuals and observed
    covariates.</p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/images/computation_time.pdf" />
  </fig>
  <p>Online documentation for the package can be found at
  <ext-link ext-link-type="uri" xlink:href="https://nsaph-software.github.io/CRE/">https://nsaph-software.github.io/CRE/</ext-link>.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work was partially funded by the following grants: NIH:
  R01ES026217, R01MD012769, R01ES028033, 1R01ES030616, 1R01AG066793,
  1R01MD016054-01A1, R01AG066793-02S1 and R01ES028033-03S1; Sloan
  Foundation: G-2020-13946.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-bargagli2022heterogeneous">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bargagli-Stoffi</surname><given-names>Falco J</given-names></name>
        <name><surname>De Witte</surname><given-names>Kristof</given-names></name>
        <name><surname>Gnecco</surname><given-names>Giorgio</given-names></name>
      </person-group>
      <article-title>Heterogeneous causal effects with imperfect compliance: A bayesian machine learning approach</article-title>
      <source>The Annals of Applied Statistics</source>
      <publisher-name>Institute of Mathematical Statistics</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>16</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1214/21-aoas1579</pub-id>
      <fpage>1986</fpage>
      <lpage>2009</lpage>
    </element-citation>
  </ref>
  <ref id="ref-athey2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Athey</surname><given-names>Susan</given-names></name>
        <name><surname>Imbens</surname><given-names>Guido</given-names></name>
      </person-group>
      <article-title>Recursive partitioning for heterogeneous causal effects</article-title>
      <source>Proceedings of the National Academy of Sciences</source>
      <publisher-name>National Academy Sciences</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>113</volume>
      <issue>27</issue>
      <pub-id pub-id-type="doi">10.1073/pnas.1510489113</pub-id>
      <fpage>7353</fpage>
      <lpage>7360</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lakkaraju2016interpretable">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Lakkaraju</surname><given-names>Himabindu</given-names></name>
        <name><surname>Bach</surname><given-names>Stephen H</given-names></name>
        <name><surname>Leskovec</surname><given-names>Jure</given-names></name>
      </person-group>
      <article-title>Interpretable decision sets: A joint framework for description and prediction</article-title>
      <source>Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining</source>
      <year iso-8601-date="2016">2016</year>
      <pub-id pub-id-type="doi">10.1145/2939672.2939874</pub-id>
      <fpage>1675</fpage>
      <lpage>1684</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wang2022causal">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wang</surname><given-names>Tong</given-names></name>
        <name><surname>Rudin</surname><given-names>Cynthia</given-names></name>
      </person-group>
      <article-title>Causal rule sets for identifying subgroups with enhanced treatment effects</article-title>
      <source>INFORMS Journal on Computing</source>
      <publisher-name>INFORMS</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <pub-id pub-id-type="doi">10.1287/ijoc.2021.1143</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-bargagli2023causal">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bargagli-Stoffi</surname><given-names>Falco J</given-names></name>
        <name><surname>Cadei</surname><given-names>Riccardo</given-names></name>
        <name><surname>Lee</surname><given-names>Kwonsang</given-names></name>
        <name><surname>Dominici</surname><given-names>Francesca</given-names></name>
      </person-group>
      <article-title>Causal rule ensemble: Interpretable discovery and inference of heterogeneous treatment effects</article-title>
      <source>arXiv</source>
      <year iso-8601-date="2023">2023</year>
      <pub-id pub-id-type="doi">10.48550/arXiv.2009.09036</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-foster2011subgroup">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Foster</surname><given-names>Jared C.</given-names></name>
        <name><surname>Taylor</surname><given-names>Jeremy M. G.</given-names></name>
        <name><surname>Ruberg</surname><given-names>Stephen J.</given-names></name>
      </person-group>
      <article-title>Subgroup identification from randomized clinical trial data</article-title>
      <source>Statistics in Medicine</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2011">2011</year>
      <volume>30</volume>
      <issue>24</issue>
      <pub-id pub-id-type="doi">10.1002/sim.4322</pub-id>
      <fpage>2867</fpage>
      <lpage>2880</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bargagli2020heterogeneous">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bargagli-Stoffi</surname><given-names>Falco J</given-names></name>
        <name><surname>Tortù</surname><given-names>Costanza</given-names></name>
        <name><surname>Forastiere</surname><given-names>Laura</given-names></name>
      </person-group>
      <article-title>Heterogeneous treatment and spillover effects under clustered network interference</article-title>
      <source>arXiv</source>
      <year iso-8601-date="2020">2020</year>
      <pub-id pub-id-type="doi">10.48550/arXiv.2008.00707</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-hahn2020bayesian">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hahn</surname><given-names>P. Richard</given-names></name>
        <name><surname>Murray</surname><given-names>Jared S.</given-names></name>
        <name><surname>Carvalho</surname><given-names>Carlos M.</given-names></name>
      </person-group>
      <article-title>Bayesian Regression Tree Models for Causal Inference: Regularization, Confounding, and Heterogeneous Effects (with Discussion)</article-title>
      <source>Bayesian Analysis</source>
      <publisher-name>International Society for Bayesian Analysis</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>15</volume>
      <issue>3</issue>
      <uri>https://doi.org/10.1214/19-BA1195</uri>
      <pub-id pub-id-type="doi">10.1214/19-BA1195</pub-id>
      <fpage>965 </fpage>
      <lpage> 2020</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nagpal2020interpretable">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Nagpal</surname><given-names>Chirag</given-names></name>
        <name><surname>Wei</surname><given-names>Dennis</given-names></name>
        <name><surname>Vinzamuri</surname><given-names>Bhanukiran</given-names></name>
        <name><surname>Shekhar</surname><given-names>Monica</given-names></name>
        <name><surname>Berger</surname><given-names>Sara E</given-names></name>
        <name><surname>Das</surname><given-names>Subhro</given-names></name>
        <name><surname>Varshney</surname><given-names>Kush R</given-names></name>
      </person-group>
      <article-title>Interpretable subgroup discovery in treatment effect estimation with application to opioid prescribing guidelines</article-title>
      <source>Proceedings of the ACM conference on health, inference, and learning</source>
      <year iso-8601-date="2020">2020</year>
      <pub-id pub-id-type="doi">10.1145/3368555.3384456</pub-id>
      <fpage>19</fpage>
      <lpage>29</lpage>
    </element-citation>
  </ref>
  <ref id="ref-breiman1996heuristics">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Breiman</surname><given-names>Leo</given-names></name>
      </person-group>
      <article-title>Heuristics of instability and stabilization in model selection</article-title>
      <source>The annals of statistics</source>
      <publisher-name>Institute of Mathematical Statistics</publisher-name>
      <year iso-8601-date="1996">1996</year>
      <volume>24</volume>
      <issue>6</issue>
      <pub-id pub-id-type="doi">10.1214/aos/1032181158</pub-id>
      <fpage>2350</fpage>
      <lpage>2383</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hastie2009elements">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Hastie</surname><given-names>Trevor</given-names></name>
        <name><surname>Tibshirani</surname><given-names>Robert</given-names></name>
        <name><surname>Friedman</surname><given-names>Jerome H</given-names></name>
        <name><surname>Friedman</surname><given-names>Jerome H</given-names></name>
      </person-group>
      <source>The elements of statistical learning: Data mining, inference, and prediction</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2009">2009</year>
      <volume>2</volume>
      <pub-id pub-id-type="doi">10.1007/978-0-387-21606-5</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-kuhn2013applied">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Kuhn</surname><given-names>Max</given-names></name>
        <name><surname>Johnson</surname><given-names>Kjell</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <source>Applied predictive modeling</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>26</volume>
      <pub-id pub-id-type="doi">10.1007/978-1-4614-6849-3</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-spanbauer2021nonparametric">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Spanbauer</surname><given-names>Charles</given-names></name>
        <name><surname>Sparapani</surname><given-names>Rodney</given-names></name>
      </person-group>
      <article-title>Nonparametric machine learning for precision medicine with longitudinal clinical trials and bayesian additive regression trees with mixed models</article-title>
      <source>Statistics in Medicine</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>40</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.1002/sim.8924</pub-id>
      <fpage>2665</fpage>
      <lpage>2691</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cre_r">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Khoshnevis</surname><given-names>Naeem</given-names></name>
        <name><surname>Garcia</surname><given-names>Daniela Maria</given-names></name>
        <name><surname>Cadei</surname><given-names>Riccardo</given-names></name>
        <name><surname>Lee</surname><given-names>Kwonsang</given-names></name>
        <name><surname>Bargagli Stoffi</surname><given-names>Falco Joannes</given-names></name>
      </person-group>
      <source>CRE: Interpretable subgroups identification through ensemble learning of causal rules</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://CRAN.R-project.org/package=CRE</uri>
    </element-citation>
  </ref>
  <ref id="ref-tibshirani2023package">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Tibshirani</surname><given-names>Julie</given-names></name>
        <name><surname>Athey</surname><given-names>Susan</given-names></name>
        <name><surname>Friedberg</surname><given-names>Rina</given-names></name>
        <name><surname>Hadad</surname><given-names>Vitor</given-names></name>
        <name><surname>Hirshberg</surname><given-names>David</given-names></name>
        <name><surname>Miner</surname><given-names>Luke</given-names></name>
        <name><surname>Sverdrup</surname><given-names>Erik</given-names></name>
        <name><surname>Wager</surname><given-names>Stefan</given-names></name>
        <name><surname>Wright</surname><given-names>Marvin</given-names></name>
        <name><surname>Tibshirani</surname><given-names>Maintainer Julie</given-names></name>
      </person-group>
      <article-title>Package ‘grf’</article-title>
      <year iso-8601-date="2023">2023</year>
      <uri>https://CRAN.R-project.org/package=grf</uri>
    </element-citation>
  </ref>
  <ref id="ref-polley2019package">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Polley</surname><given-names>Eric</given-names></name>
        <name><surname>LeDell</surname><given-names>Erin</given-names></name>
        <name><surname>Kennedy</surname><given-names>Chris</given-names></name>
        <name><surname>Lendle</surname><given-names>Sam</given-names></name>
        <name><surname>Laan</surname><given-names>Mark van der</given-names></name>
      </person-group>
      <article-title>Package ‘SuperLearner’</article-title>
      <source>CRAN</source>
      <year iso-8601-date="2019">2019</year>
      <uri>https://CRAN.R-project.org/package=SuperLearner</uri>
    </element-citation>
  </ref>
  <ref id="ref-dorie2020package">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dorie</surname><given-names>Vincent</given-names></name>
        <name><surname>Hill</surname><given-names>Jennifer</given-names></name>
        <name><surname>Dorie</surname><given-names>Maintainer Vincent</given-names></name>
      </person-group>
      <article-title>Package ‘bartcause’</article-title>
      <source>URL: https://cran. r-project. org/web/packages/bartCause/bartCause. pdf</source>
      <year iso-8601-date="2020">2020</year>
      <uri>https://CRAN.R-project.org/package=bartCause</uri>
    </element-citation>
  </ref>
  <ref id="ref-friedman2021package">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Friedman</surname><given-names>Jerome</given-names></name>
        <name><surname>Hastie</surname><given-names>Trevor</given-names></name>
        <name><surname>Tibshirani</surname><given-names>Rob</given-names></name>
        <name><surname>Narasimhan</surname><given-names>Balasubramanian</given-names></name>
        <name><surname>Tay</surname><given-names>Kenneth</given-names></name>
        <name><surname>Simon</surname><given-names>Noah</given-names></name>
        <name><surname>Qian</surname><given-names>Junyang</given-names></name>
      </person-group>
      <article-title>Package ‘glmnet’</article-title>
      <source>CRAN R Repositary</source>
      <year iso-8601-date="2021">2021</year>
      <uri>ttps://CRAN.R-project.org/package=glmnet</uri>
    </element-citation>
  </ref>
  <ref id="ref-hofner2015package">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hofner</surname><given-names>Benjamin</given-names></name>
        <name><surname>Hothorn</surname><given-names>Torsten</given-names></name>
        <name><surname>Hofner</surname><given-names>Maintainer Benjamin</given-names></name>
      </person-group>
      <article-title>Package ‘stabs’</article-title>
      <year iso-8601-date="2015">2015</year>
      <uri>https://CRAN.R-project.org/package=stabs</uri>
    </element-citation>
  </ref>
  <ref id="ref-meinshausen2010stability">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Meinshausen</surname><given-names>Nicolai</given-names></name>
        <name><surname>Bühlmann</surname><given-names>Peter</given-names></name>
      </person-group>
      <article-title>Stability selection</article-title>
      <source>Journal of the Royal Statistical Society Series B: Statistical Methodology</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>72</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1111/j.1467-9868.2010.00740.x</pub-id>
      <fpage>417</fpage>
      <lpage>473</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hill2011bayesian">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hill</surname><given-names>Jennifer L</given-names></name>
      </person-group>
      <article-title>Bayesian nonparametric modeling for causal inference</article-title>
      <source>Journal of Computational and Graphical Statistics</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2011">2011</year>
      <volume>20</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1198/jcgs.2010.08162</pub-id>
      <fpage>217</fpage>
      <lpage>240</lpage>
    </element-citation>
  </ref>
  <ref id="ref-athey2019generalized">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Athey</surname><given-names>Susan</given-names></name>
        <name><surname>Tibshirani</surname><given-names>Julie</given-names></name>
        <name><surname>Wager</surname><given-names>Stefan</given-names></name>
      </person-group>
      <article-title>Generalized random forests</article-title>
      <source>The Annals of Statistics</source>
      <publisher-name>Institute of Mathematical Statistics</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>47</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1214/18-AOS1709</uri>
      <pub-id pub-id-type="doi">10.1214/18-AOS1709</pub-id>
      <fpage>1148 </fpage>
      <lpage> 1178</lpage>
    </element-citation>
  </ref>
  <ref id="ref-robins1994estimation">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Robins</surname><given-names>James M</given-names></name>
        <name><surname>Rotnitzky</surname><given-names>Andrea</given-names></name>
        <name><surname>Zhao</surname><given-names>Lue Ping</given-names></name>
      </person-group>
      <article-title>Estimation of regression coefficients when some regressors are not always observed</article-title>
      <source>Journal of the American statistical Association</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="1994">1994</year>
      <volume>89</volume>
      <issue>427</issue>
      <pub-id pub-id-type="doi">10.2307/2290910</pub-id>
      <fpage>846</fpage>
      <lpage>866</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hansotia2002incremental">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hansotia</surname><given-names>Behram</given-names></name>
        <name><surname>Rukstales</surname><given-names>Brad</given-names></name>
      </person-group>
      <article-title>Incremental value modeling</article-title>
      <source>Journal of Interactive Marketing</source>
      <publisher-name>SAGE Publications Sage CA: Los Angeles, CA</publisher-name>
      <year iso-8601-date="2002">2002</year>
      <volume>16</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1002/dir.10035</pub-id>
      <fpage>35</fpage>
      <lpage>46</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kunzel2019metalearners">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Künzel</surname><given-names>Sören R</given-names></name>
        <name><surname>Sekhon</surname><given-names>Jasjeet S</given-names></name>
        <name><surname>Bickel</surname><given-names>Peter J</given-names></name>
        <name><surname>Yu</surname><given-names>Bin</given-names></name>
      </person-group>
      <article-title>Metalearners for estimating heterogeneous treatment effects using machine learning</article-title>
      <source>Proceedings of the national academy of sciences</source>
      <publisher-name>National Acad Sciences</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>116</volume>
      <issue>10</issue>
      <pub-id pub-id-type="doi">10.1073/pnas.1804597116</pub-id>
      <fpage>4156</fpage>
      <lpage>4165</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
