<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8457</article-id>
<article-id pub-id-type="doi">10.21105/joss.08457</article-id>
<title-group>
<article-title>Miop: a modular pipeline for 3D reconstruction from
scanning electron microscope images</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0003-0424-1688</contrib-id>
<name>
<surname>Paschoud</surname>
<given-names>Maxime</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0008-7530-3256</contrib-id>
<name>
<surname>Michel</surname>
<given-names>Luca</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3782-9368</contrib-id>
<name>
<surname>Kammer</surname>
<given-names>David S.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Institute for Building Materials, ETH Zurich,
Switzerland</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<volume>10</volume>
<issue>113</issue>
<fpage>8457</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>3D reconstruction</kwd>
<kwd>scanning electron microscopy</kwd>
<kwd>image processing</kwd>
<kwd>computer vision</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Powdered materials are ubiquitous in nature and widely used in
  industries such as food, cosmetics, and construction. These materials
  consist of small grains with a broad size and shape distribution,
  typically in the micrometer range. Understanding their microscale
  behavior requires accurate geometric characterization. Scanning
  electron microscopy (SEM) provides a fast and accessible method for
  imaging powdered materials at this scale. By leveraging the tilt
  capabilities of the microscope, along with feature-matching
  algorithms, it is possible to reconstruct the three-dimensional (3D)
  shape of individual grains.</p>
  <p>We introduce Miop, a modular pipeline for 3D reconstruction from
  SEM images. Miop implements key steps of a 3D reconstruction workflow,
  including feature matching, estimation of (intrinsic and extrinsic)
  camera parameters, and point cloud reconstruction. It models the image
  generation process using a scaled orthographic projection and can
  incorporate microscope metadata, such as stage tilt and rotation
  angle. Designed for flexibility, Miop is easily extensible and
  modifiable, providing researchers with a practical tool for 3D
  reconstruction of powdered materials. An example of a typical
  reconstruction generated by Miop is illustrated in
  <xref alt="[fig:miop_input_output]" rid="figU003Amiop_input_output">[fig:miop_input_output]</xref>.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>3D reconstruction from SEM images is a well-studied problem
  (<xref alt="Eulitz &amp; Reiss, 2015" rid="ref-eulitz_3d_2015" ref-type="bibr">Eulitz
  &amp; Reiss, 2015</xref>;
  <xref alt="Tafti et al., 2015" rid="ref-tafti_recent_2015" ref-type="bibr">Tafti
  et al., 2015</xref>;
  <xref alt="Töberg &amp; Reithmeier, 2020" rid="ref-toberg_quantitative_2020" ref-type="bibr">Töberg
  &amp; Reithmeier, 2020</xref>). However, to the best of our knowledge,
  there are no open-source tools specifically designed for 3D
  reconstruction from SEM image sets that offer the flexibility and
  modularity required for research use. General-purpose 3D
  reconstruction libraries such as COLMAP
  (<xref alt="Schonberger &amp; Frahm, 2016" rid="ref-schonberger_structure_motion_2016" ref-type="bibr">Schonberger
  &amp; Frahm, 2016</xref>) are tailored to standard perspective cameras
  and do not support the specific imaging geometry of electron
  microscopes. Other approaches
  (<xref alt="Töberg &amp; Reithmeier, 2020" rid="ref-toberg_quantitative_2020" ref-type="bibr">Töberg
  &amp; Reithmeier, 2020</xref>) are limited in scalability or are not
  designed to be extended for custom workflows. Despite active research
  in 3D reconstruction and SEM imaging, we are not aware of any new
  software addressing these specific limitations in recent years.</p>
  <fig>
    <caption><p>Typical Miop input and
    output.<styled-content id="figU003Amiop_input_output"></styled-content>
    Left: a sample SEM image of a cement grain. Right: reconstruction
    using Miop.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="paper_figure.png" />
  </fig>
</sec>
<sec id="brief-software-description">
  <title>Brief software description</title>
  <p>The reconstruction problem is formulated as a projection of a 3D
  scene onto the image plane. Under a scaled orthographic camera model,
  the projection of a single three-dimensional point is given by:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  \underbrace{
      \begin{bmatrix}
      k & 0 & 0 \\
      s & k & 0 \\
      \end{bmatrix}
  R}_{C}
      \begin{bmatrix}
      x \\
      y \\
      z \\
      \end{bmatrix}
  =
  \underbrace{
      \begin{bmatrix}
      x_{p,1} \\
      y_{p,1} \\
      \end{bmatrix}
  }_{W}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:munder><mml:munder><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mi>k</mml:mi></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mi>s</mml:mi></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mi>k</mml:mi></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mo accent="true">⏟</mml:mo></mml:munder><mml:mi>C</mml:mi></mml:munder><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mi>x</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mi>y</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mi>z</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo accent="true">⏟</mml:mo></mml:munder><mml:mi>W</mml:mi></mml:munder></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
  defines the scaling, and <inline-formula><alternatives>
  <tex-math><![CDATA[s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>s</mml:mi></mml:math></alternatives></inline-formula>
  is a skew parameter. The rotation matrix
  <inline-formula><alternatives>
  <tex-math><![CDATA[R]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>R</mml:mi></mml:math></alternatives></inline-formula>
  is determined by the tilt angle and axis of the microscope stage. This
  model accurately describes the image generation process in SEM at high
  magnification, as discussed in Töberg &amp; Reithmeier
  (<xref alt="2020" rid="ref-toberg_quantitative_2020" ref-type="bibr">2020</xref>).</p>
  <p>The matrix <inline-formula><alternatives>
  <tex-math><![CDATA[C]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
  fully determines both the intrinsic and extrinsic parameters of the
  camera. If <inline-formula><alternatives>
  <tex-math><![CDATA[C]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[W]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>
  are known, the system can be solved using methods such as least
  squares. When the axis of rotation of the microscope stage is known,
  <inline-formula><alternatives>
  <tex-math><![CDATA[C]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
  can be reconstructed from the microscope metadata. For microscopes
  with eucentric capabilities, a horizontal rotation axis can be
  assumed, allowing the rotation matrix <inline-formula><alternatives>
  <tex-math><![CDATA[R]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>R</mml:mi></mml:math></alternatives></inline-formula>
  to be recovered from the tilt angles. Furthermore, the scaling factor
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
  is determined by the magnification, and the skew parameter
  <inline-formula><alternatives>
  <tex-math><![CDATA[s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>s</mml:mi></mml:math></alternatives></inline-formula>
  can be assumed to be zero.</p>
  <p>If metadata are unavailable or unreliable, the intrinsic and
  extrinsic parameters of the camera can be estimated using the
  factorization method proposed by Poelman and Kanade
  (<xref alt="Poelman &amp; Kanade, 1993" rid="ref-poelman_paraperspective_nodate" ref-type="bibr">Poelman
  &amp; Kanade, 1993</xref>;
  <xref alt="Tomasi &amp; Kanade, 1992" rid="ref-tomasi_shape_1992" ref-type="bibr">Tomasi
  &amp; Kanade, 1992</xref>). This approach factorizes
  <inline-formula><alternatives>
  <tex-math><![CDATA[W]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>
  into two matrices using singular value decomposition (SVD):</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  W = \left( U \Sigma^{\frac{1}{2}} \right) \left( \Sigma^{\frac{1}{2}}V^T \right) = \hat{C} \hat{S}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>U</mml:mi><mml:msup><mml:mi>Σ</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>Σ</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:msup><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover><mml:mi>C</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mover><mml:mi>S</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>allowing <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{C}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>C</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{S}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>S</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
  to be computed efficiently. However, this decomposition is not unique,
  as any invertible 3x3 matrix <inline-formula><alternatives>
  <tex-math><![CDATA[Q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
  and its inverse can be inserted between <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{C}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>C</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{S}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>S</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:math></alternatives></inline-formula>:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  W = \hat{C}QQ^{-1}\hat{S}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mover><mml:mi>C</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>Q</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>−</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover><mml:mi>S</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>To recover <inline-formula><alternatives>
  <tex-math><![CDATA[Q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>,
  we solve the following linear system
  (<xref alt="Poelman &amp; Kanade, 1993" rid="ref-poelman_paraperspective_nodate" ref-type="bibr">Poelman
  &amp; Kanade, 1993</xref>;
  <xref alt="Tomasi &amp; Kanade, 1992" rid="ref-tomasi_shape_1992" ref-type="bibr">Tomasi
  &amp; Kanade, 1992</xref>):</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  \begin{aligned}
      \hat{i}_f^TQQ^T\hat{j}_f &= 0 \\
      \hat{j}_f^TQQ^T\hat{j}_f - \hat{i}_f^TQQ^T\hat{i}_f &= 0 \\
  \end{aligned}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msubsup><mml:mover><mml:mi>i</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi>Q</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mover><mml:mi>j</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:msubsup><mml:mover><mml:mi>j</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi>Q</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mover><mml:mi>j</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mover><mml:mi>i</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mi>Q</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mover><mml:mi>i</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub></mml:mtd><mml:mtd columnalign="left" style="text-align: left"><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{i}_f]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mover><mml:mi>i</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{j}_f]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mover><mml:mi>j</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  are the rows of the camera matrix <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{C}_f]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mover><mml:mi>C</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  Since <inline-formula><alternatives>
  <tex-math><![CDATA[QQ^T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Q</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  is a 3x3 symmetric matrix, it has six unique entries. We therefore
  need at least 3 different images to recover
  <inline-formula><alternatives>
  <tex-math><![CDATA[QQ^T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Q</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.
  Moreover, to avoid the trivial solution
  (<inline-formula><alternatives>
  <tex-math><![CDATA[\hat{i}_f = 0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mover><mml:mi>i</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\hat{j}_f=0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mover><mml:mi>j</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  for all <inline-formula><alternatives>
  <tex-math><![CDATA[f]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>f</mml:mi></mml:math></alternatives></inline-formula>),
  the scaling of the first camera is set to one
  (<xref alt="Poelman &amp; Kanade, 1993" rid="ref-poelman_paraperspective_nodate" ref-type="bibr">Poelman
  &amp; Kanade, 1993</xref>):</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
  \hat{i}_1^TQQ^T\hat{i}_1 = 1.
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mover><mml:mi>i</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mi>Q</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:msub><mml:mover><mml:mi>i</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><inline-formula><alternatives>
  <tex-math><![CDATA[Q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Q</mml:mi></mml:math></alternatives></inline-formula>
  is then obtained from the eigendecomposition of
  <inline-formula><alternatives>
  <tex-math><![CDATA[QQ^T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Q</mml:mi><mml:msup><mml:mi>Q</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.
  The method of Poelman and Kanade
  (<xref alt="Poelman &amp; Kanade, 1993" rid="ref-poelman_paraperspective_nodate" ref-type="bibr">Poelman
  &amp; Kanade, 1993</xref>) thus allows computing the camera positions
  from <inline-formula><alternatives>
  <tex-math><![CDATA[W]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>.</p>
  <p>The matrix <inline-formula><alternatives>
  <tex-math><![CDATA[W]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>
  is obtained through feature matching. Our pipeline currently uses the
  RoMa model
  (<xref alt="Edstedt et al., 2023" rid="ref-edstedt_roma_2023" ref-type="bibr">Edstedt
  et al., 2023</xref>), but users can easily integrate other algorithms
  if better suited to their specific applications.</p>
</sec>
<sec id="usage-and-documentation">
  <title>Usage and Documentation</title>
  <p>The code is hosted on GitLab:
  <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/miop-project/miop">https://gitlab.com/miop-project/miop</ext-link>.
  Installation and usage instructions are available in the README.md
  file. An example Jupyter notebook is provided to visualize
  intermediate steps of the reconstruction.</p>
</sec>
<sec id="acknowledgments">
  <title>Acknowledgments</title>
  <p>Part of the implementation of the scaled orthographic model is
  based on the code of Toeberg
  (<xref alt="Töberg &amp; Reithmeier, 2020" rid="ref-toberg_quantitative_2020" ref-type="bibr">Töberg
  &amp; Reithmeier, 2020</xref>), available at
  <ext-link ext-link-type="uri" xlink:href="https://github.com/Karido/3D-SEM/">https://github.com/Karido/3D-SEM/</ext-link>.</p>
  <p>The authors acknowledge the Swiss National Science Foundation for
  financial support under grant 200021_200343.</p>
  <p>The authors gratefully acknowledge the Scientific Center for
  Optical and Electron Microscopy (ScopeM) of ETH Zurich for providing
  helpful technical advice and support. The authors thank Christian
  Zaubitzer (ScopeM, ETH Zurich, Switzerland) for his assistance in
  image generation. The authors also thank Dr. Zuria Bauer and
  Dr. Sandro Lombardi for useful discussions during the method
  development.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-toberg_quantitative_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Töberg</surname><given-names>Stefan</given-names></name>
        <name><surname>Reithmeier</surname><given-names>Eduard</given-names></name>
      </person-group>
      <article-title>Quantitative 3D Reconstruction from Scanning Electron Microscope Images Based on Affine Camera Models</article-title>
      <source>Sensors</source>
      <year iso-8601-date="2020-01">2020</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-01-31">2025</year><month>01</month><day>31</day></date-in-citation>
      <volume>20</volume>
      <issue>12</issue>
      <issn>1424-8220</issn>
      <uri>https://www.mdpi.com/1424-8220/20/12/3598</uri>
      <pub-id pub-id-type="doi">10.3390/s20123598</pub-id>
      <fpage>3598</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-schonberger_structure_motion_2016">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Schonberger</surname><given-names>Johannes L.</given-names></name>
        <name><surname>Frahm</surname><given-names>Jan-Michael</given-names></name>
      </person-group>
      <article-title>Structure-from-Motion Revisited</article-title>
      <source>2016 IEEE Conference on Computer Vision and Pattern Recognition (CVPR)</source>
      <publisher-name>IEEE</publisher-name>
      <publisher-loc>Las Vegas, NV, USA</publisher-loc>
      <year iso-8601-date="2016-06">2016</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-01-31">2025</year><month>01</month><day>31</day></date-in-citation>
      <isbn>978-1-4673-8851-1</isbn>
      <uri>http://ieeexplore.ieee.org/document/7780814/</uri>
      <pub-id pub-id-type="doi">10.1109/CVPR.2016.445</pub-id>
      <fpage>4104</fpage>
      <lpage>4113</lpage>
    </element-citation>
  </ref>
  <ref id="ref-edstedt_roma_2023">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Edstedt</surname><given-names>Johan</given-names></name>
        <name><surname>Sun</surname><given-names>Qiyu</given-names></name>
        <name><surname>Bökman</surname><given-names>Georg</given-names></name>
        <name><surname>Wadenbäck</surname><given-names>Mårten</given-names></name>
        <name><surname>Felsberg</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>RoMa: Robust Dense Feature Matching</article-title>
      <publisher-name>arXiv</publisher-name>
      <year iso-8601-date="2023-12">2023</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-01-31">2025</year><month>01</month><day>31</day></date-in-citation>
      <uri>http://arxiv.org/abs/2305.15404</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2305.15404</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-eulitz_3d_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Eulitz</surname><given-names>Mona</given-names></name>
        <name><surname>Reiss</surname><given-names>Gebhard</given-names></name>
      </person-group>
      <article-title>3D reconstruction of SEM images by use of optical photogrammetry software</article-title>
      <source>Journal of Structural Biology</source>
      <year iso-8601-date="2015-08">2015</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-01-31">2025</year><month>01</month><day>31</day></date-in-citation>
      <volume>191</volume>
      <issue>2</issue>
      <issn>1047-8477</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S1047847715300149</uri>
      <pub-id pub-id-type="doi">10.1016/j.jsb.2015.06.010</pub-id>
      <fpage>190</fpage>
      <lpage>196</lpage>
    </element-citation>
  </ref>
  <ref id="ref-tafti_recent_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tafti</surname><given-names>Ahmad P.</given-names></name>
        <name><surname>Kirkpatrick</surname><given-names>Andrew B.</given-names></name>
        <name><surname>Alavi</surname><given-names>Zahrasadat</given-names></name>
        <name><surname>Owen</surname><given-names>Heather A.</given-names></name>
        <name><surname>Yu</surname><given-names>Zeyun</given-names></name>
      </person-group>
      <article-title>Recent advances in 3D SEM surface reconstruction</article-title>
      <source>Micron</source>
      <year iso-8601-date="2015-11">2015</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-01-31">2025</year><month>01</month><day>31</day></date-in-citation>
      <volume>78</volume>
      <issn>0968-4328</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0968432815300226</uri>
      <pub-id pub-id-type="doi">10.1016/j.micron.2015.07.005</pub-id>
      <fpage>54</fpage>
      <lpage>66</lpage>
    </element-citation>
  </ref>
  <ref id="ref-poelman_paraperspective_nodate">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Poelman</surname><given-names>Conrad J</given-names></name>
        <name><surname>Kanade</surname><given-names>Takeo</given-names></name>
      </person-group>
      <article-title>A Paraperspective Factorization Method for Shape and Motion Recovery</article-title>
      <source>IEEE transactions on pattern analysis and machine intelligence</source>
      <year iso-8601-date="1993">1993</year>
      <pub-id pub-id-type="doi">10.1109/34.584098</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-tomasi_shape_1992">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tomasi</surname><given-names>Carlo</given-names></name>
        <name><surname>Kanade</surname><given-names>Takeo</given-names></name>
      </person-group>
      <article-title>Shape and motion from image streams under orthography: A factorization method</article-title>
      <source>International Journal of Computer Vision</source>
      <year iso-8601-date="1992-11">1992</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-01-31">2025</year><month>01</month><day>31</day></date-in-citation>
      <volume>9</volume>
      <issue>2</issue>
      <issn>0920-5691</issn>
      <uri>http://link.springer.com/10.1007/BF00129684</uri>
      <pub-id pub-id-type="doi">10.1007/BF00129684</pub-id>
      <fpage>137</fpage>
      <lpage>154</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
