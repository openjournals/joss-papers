<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7081</article-id>
<article-id pub-id-type="doi">10.21105/joss.07081</article-id>
<title-group>
<article-title>Caustics: A Python Package for Accelerated Strong
Gravitational Lensing Simulations</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9086-6398</contrib-id>
<name>
<surname>Stone</surname>
<given-names>Connor</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8806-7936</contrib-id>
<name>
<surname>Adam</surname>
<given-names>Alexandre</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0055-1780</contrib-id>
<name>
<surname>Coogan</surname>
<given-names>Adam</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="aff" rid="aff-a"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5200-4095</contrib-id>
<name>
<surname>Yantovski-Barth</surname>
<given-names>M. J.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4701-3469</contrib-id>
<name>
<surname>Filipp</surname>
<given-names>Andreas</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1624-2667</contrib-id>
<name>
<surname>Setiawan</surname>
<given-names>Landung</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3531-3221</contrib-id>
<name>
<surname>Core</surname>
<given-names>Cordero</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9459-6316</contrib-id>
<name>
<surname>Legin</surname>
<given-names>Ronan</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7071-5528</contrib-id>
<name>
<surname>Wilson</surname>
<given-names>Charles</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0008-5839-5937</contrib-id>
<name>
<surname>Barco</surname>
<given-names>Gabriel Missael</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8669-5733</contrib-id>
<name>
<surname>Hezaveh</surname>
<given-names>Yashar</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="aff" rid="aff-5"/>
<xref ref-type="aff" rid="aff-6"/>
<xref ref-type="aff" rid="aff-7"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3544-3939</contrib-id>
<name>
<surname>Perreault-Levasseur</surname>
<given-names>Laurence</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="aff" rid="aff-5"/>
<xref ref-type="aff" rid="aff-6"/>
<xref ref-type="aff" rid="aff-7"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Ciela Institute - Montréal Institute for Astrophysical Data
Analysis and Machine Learning, Montréal, Québec, Canada</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Department of Physics, Université de Montréal, Montréal,
Québec, Canada</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Mila - Québec Artificial Intelligence Institute, Montréal,
Québec, Canada</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>eScience Institute Scientific Software Engineering Center,
1410 NE Campus Pkwy, Seattle, WA 98195, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Center for Computational Astrophysics, Flatiron Institute,
162 5th Avenue, 10010, New York, NY, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-6">
<institution-wrap>
<institution>Perimeter Institute for Theoretical Physics, Waterloo,
Canada</institution>
</institution-wrap>
</aff>
<aff id="aff-7">
<institution-wrap>
<institution>Trottier Space Institute, McGill University, Montréal,
Canada</institution>
</institution-wrap>
</aff>
<aff id="aff-a">
<institution-wrap>
<institution>Work done while at UdeM, Ciela, and Mila</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-03-19">
<day>19</day>
<month>3</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>103</issue>
<fpage>7081</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>astronomy</kwd>
<kwd>gravitational lensing</kwd>
<kwd>PyTorch</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Gravitational lensing is the deflection of light rays due to the
  gravity of intervening masses. This phenomenon is observed at a
  variety of scales and configurations, involving any non-uniform mass
  such as planets, stars, galaxies, clusters of galaxies, and even the
  large-scale structure of the Universe. Strong lensing occurs when the
  distortions are significant and multiple images of the background
  source are observed. The lens and lensed object(s) must be aligned on
  the sky within <inline-formula><alternatives>
  <tex-math><![CDATA[\sim 1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  arcsecond for galaxy-galaxy lensing, or tens of arcseconds for
  cluster-galaxy lensing. As the discovery of lens systems has grown to
  the low thousands, these systems have become pivotal for precision
  measurements and addressing critical questions in astrophysics.
  Notably, they are a tool for understanding a wide range of
  astrophysical phenomena including: dark matter (e.g.
  <xref alt="Hezaveh et al., 2016" rid="ref-Hezaveh2016" ref-type="bibr">Hezaveh
  et al., 2016</xref>;
  <xref alt="Vegetti &amp; Vogelsberger, 2014" rid="ref-Vegetti2014" ref-type="bibr">Vegetti
  &amp; Vogelsberger, 2014</xref>), supernovae (e.g.
  <xref alt="Rodney et al., 2021" rid="ref-Rodney2021" ref-type="bibr">Rodney
  et al., 2021</xref>), quasars (e.g.
  <xref alt="Peng et al., 2006" rid="ref-Peng2006" ref-type="bibr">Peng
  et al., 2006</xref>), the first stars (e.g.
  <xref alt="Welch et al., 2022" rid="ref-Welch2022" ref-type="bibr">Welch
  et al., 2022</xref>), and the Universe’s expansion rate (e.g.
  <xref alt="K. C. Wong et al., 2020" rid="ref-holycow" ref-type="bibr">K.
  C. Wong et al., 2020</xref>). With future surveys expected to discover
  hundreds of thousands of lensing systems, the modelling and simulation
  of such systems must be done at orders of magnitude larger scale than
  ever before. Here we present <monospace>caustics</monospace>, a Python
  package designed to facilitate machine learning and Bayesian methods
  to handle the extensive computational demands of modelling such a vast
  number of lensing systems.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>The next generation of astronomical surveys, such as the Legacy
  Survey of Space and Time, the Roman Core Community Surveys, and the
  Euclid wide survey, are expected to uncover hundreds of thousands of
  gravitational lenses
  (<xref alt="Collett, 2015" rid="ref-Collett2015" ref-type="bibr">Collett,
  2015</xref>), dramatically increasing the scientific potential of
  gravitational lensing studies. Currently, analyzing a single lensing
  system can take several days or weeks, which will be infeasible as the
  number of known lenses increases by orders of magnitude. Thus,
  advancements such as computational acceleration via GPUs and/or
  algorithmic advances such as automatic differentiation are needed to
  reduce the analysis timescales. Machine learning will be critical to
  achieve the necessary speed to process these lenses, it will also be
  needed to meet the complexity of strong lens modelling.
  <monospace>caustics</monospace> is built with the future of lensing in
  mind, using <monospace>PyTorch</monospace>
  (<xref alt="Paszke et al., 2019" rid="ref-pytorch" ref-type="bibr">Paszke
  et al., 2019</xref>) to accelerate the low-level computation and
  enable deep learning algorithms which rely on automatic
  differentiation. Automatic differentiation also benefits classical
  algorithms such as Hamiltonian Monte Carlo
  (<xref alt="Betancourt, 2017" rid="ref-hmc" ref-type="bibr">Betancourt,
  2017</xref>). With these tools available,
  <monospace>caustics</monospace> provides greater than two orders of
  magnitude acceleration to most standard operations, enabling
  previously impractical analyses at scale.</p>
  <p>Several other simulation packages for strong gravitational lensing
  are already publicly available. The well-established
  <monospace>lenstronomy</monospace> package has been in use since 2018
  (<xref alt="Birrer et al., 2021" rid="ref-lenstronomy" ref-type="bibr">Birrer
  et al., 2021</xref>); <monospace>GLAMER</monospace> is a C++-based
  code for modelling complex and large dynamic range fields
  (<xref alt="Metcalf &amp; Petkova, 2014" rid="ref-GLAMER" ref-type="bibr">Metcalf
  &amp; Petkova, 2014</xref>); <monospace>PyAutoLens</monospace> is also
  widely used
  (<xref alt="Nightingale et al., 2021" rid="ref-PyAutoLens" ref-type="bibr">Nightingale
  et al., 2021</xref>); <monospace>GIGA-Lens</monospace> is a
  specialized JAX
  (<xref alt="Bradbury et al., 2018" rid="ref-JAX" ref-type="bibr">Bradbury
  et al., 2018</xref>) based gravitational lensing package
  (<xref alt="Gu et al., 2022" rid="ref-GIGALens" ref-type="bibr">Gu et
  al., 2022</xref>); and <monospace>Herculens</monospace> is a more
  general JAX based lensing simulator package
  (<xref alt="Galan et al., 2022" rid="ref-Herculens" ref-type="bibr">Galan
  et al., 2022</xref>); among others (<monospace>GRAVLENS</monospace>
  <xref alt="Keeton, 2011" rid="ref-Keeton2011" ref-type="bibr">Keeton,
  2011</xref>; <monospace>LENSTOOL</monospace>
  <xref alt="Kneib et al., 2011" rid="ref-Kneib2011" ref-type="bibr">Kneib
  et al., 2011</xref>; <monospace>SLITRONOMY</monospace>
  <xref alt="Galan et al., 2021" rid="ref-Galan2021" ref-type="bibr">Galan
  et al., 2021</xref>; <monospace>paltax</monospace>
  <xref alt="Wagner-Carena et al., 2024" rid="ref-Wagner2024" ref-type="bibr">Wagner-Carena
  et al., 2024</xref>). There are also several in-house codes developed
  for specialized analysis which are then not publicly released (e.g.
  <xref alt="Suyu &amp; Halkola, 2010" rid="ref-Suyu2010" ref-type="bibr">Suyu
  &amp; Halkola, 2010</xref>). The development of
  <monospace>caustics</monospace> has been primarily focused on three
  aspects: processing speed, user experience, and flexibility. The code
  is optimized to fully exploit PyTorch’s capabilities, significantly
  enhancing processing speed. The user experience is streamlined by
  providing three interfaces to the code: configuration file,
  object-oriented, and functional, where each interface level requires
  more expertise but allows more capabilities. In this way, users with
  all levels of gravitational lensing simulation experience can
  effectively engage with the software. Flexibility is achieved by a
  determined focus on minimalism in the core functionality of
  <monospace>caustics</monospace>. All of these elements combine to make
  <monospace>caustics</monospace> a capable lensing simulator to support
  machine learning applications, and classical analysis.</p>
  <p><monospace>Caustics</monospace> fills a timely need for a
  differentiable lensing simulator. Several other fields have already
  benefited from such simulators, for example: gravitational wave
  analysis
  (<xref alt="Coogan et al., 2022" rid="ref-Coogan2022" ref-type="bibr">Coogan
  et al., 2022</xref>;
  <xref alt="Edwards et al., 2023" rid="ref-Edwards2023" ref-type="bibr">Edwards
  et al., 2023</xref>;
  <xref alt="K. W. K. Wong et al., 2023" rid="ref-Wong2023" ref-type="bibr">K.
  W. K. Wong et al., 2023</xref>); astronomical image photometry
  (<xref alt="Stone et al., 2023" rid="ref-Stone2023" ref-type="bibr">Stone
  et al., 2023</xref>); point spread function modelling
  (<xref alt="Desdoigts et al., 2023" rid="ref-Desdoigts2023" ref-type="bibr">Desdoigts
  et al., 2023</xref>); time series analysis
  (<xref alt="Million et al., 2024" rid="ref-Millon2024" ref-type="bibr">Million
  et al., 2024</xref>); and even generic optimization for scientific
  problems
  (<xref alt="Nikolic, 2018" rid="ref-Nikolic2018" ref-type="bibr">Nikolic,
  2018</xref>). <monospace>Caustics</monospace> is built on lessons from
  other differentiable codes, with the goal of enabling machine learning
  techniques in the field of strong lensing. With
  <monospace>caustics</monospace> it will now be possible to analyze
  over 100,000 lenses in a timely manner
  (<xref alt="Hezaveh et al., 2017" rid="ref-Hezaveh2017" ref-type="bibr">Hezaveh
  et al., 2017</xref>;
  <xref alt="Perreault Levasseur et al., 2017" rid="ref-Perreault2017" ref-type="bibr">Perreault
  Levasseur et al., 2017</xref>).</p>
</sec>
<sec id="scope">
  <title>Scope</title>
  <p><monospace>Caustics</monospace> is a gravitational lensing
  simulator. The purpose of the project is to streamline the simulation
  of strong gravitational lensing effects on the light of a background
  source. The primary focus is on all transformations between the source
  plane(s) and the image plane through the lensing plane(s). There is
  minimal effort on modelling the observational elements of atmosphere,
  telescope optics, detector effects with most of these left to the
  users. A variety of parametric lensing profiles are included, such as:
  Singular Isothermal Ellipsoid (SIE), Elliptical Power Law (EPL),
  Pseudo-Jaffe, Navarro-Frenk-White (NFW), and External Shear.
  Additionally, it offers non-parametric representations such as a
  gridded convergence or a potential field. For the background source
  <monospace>caustics</monospace> provides a Sérsic light profile, as
  well as a pixelized light image. Users can easily extend these lens
  and source lists using templates provided in the documentation.</p>
  <p>Once a lensing system has been defined,
  <monospace>caustics</monospace> can then perform various computational
  operations on the system such as raytracing through the lensing
  system, forwards and backwards. Users can compute the lensing
  potential, convergence, deflection field, time delay field, and
  magnification. All of these operations can readily be performed in a
  multi-plane setting to account for interlopers or multiple sources.
  Because the code is differentiable (via PyTorch), one can easily also
  compute the derivatives of these quantities, such as when finding
  critical curves or computing the Jacobian of the lens equation. For
  example, one can project interlopers from multiple lensing planes to a
  single plane by computing the effective convergence, obtained with the
  trace of the Jacobian.</p>
  <p>With these building blocks in place, one can construct fast and
  accurate simulators used to produce training sets for machine learning
  models or for inference on real-world systems. Neural networks have
  become a widespread tool for amortized inference of gravitational
  lensing parameter
  (<xref alt="Hezaveh et al., 2017" rid="ref-Hezaveh2017" ref-type="bibr">Hezaveh
  et al., 2017</xref>) or in the detection of gravitational lenses
  (<xref alt="Huang et al., 2021" rid="ref-Huang2021" ref-type="bibr">Huang
  et al., 2021</xref>;
  <xref alt="Petrillo et al., 2017" rid="ref-Petrillo2017" ref-type="bibr">Petrillo
  et al., 2017</xref>), but they require large and accurate training
  sets which can be created quickly with
  <monospace>caustics</monospace>. A demonstration of such a simulator
  is given in
  <xref alt="[fig:sample]" rid="figU003Asample">[fig:sample]</xref>
  which also demonstrates the importance of sub-pixel sampling. This
  involves raytracing through the lensing mass and extracting the
  brightness of the background source. Further, the image then must be
  convolved with a PSF for extra realism. All of these operations are
  collected into a single simulator which users can access and use
  simply as a function of the relevant lensing and light source
  parameters. Because <monospace>caustics</monospace> is written in
  <monospace>PyTorch</monospace>, its simulators are differentiable,
  thus one can compute gradients through the forward model. This enables
  machine learning algorithms such as recurrent inference machines
  (<xref alt="Adam et al., 2023" rid="ref-Adam2023" ref-type="bibr">Adam
  et al., 2023</xref>) and diffusion models
  (<xref alt="Adam et al., 2022" rid="ref-Adam2022" ref-type="bibr">Adam
  et al., 2022</xref>).</p>
  <fig>
    <caption><p>Example simulated gravitational lens system defined by a
    Sérsic source, SIE lens mass, and Sérsic lens light. Left, the pixel
    map is sampled only at the midpoint of each pixel. Middle, the pixel
    map is supersampled and then integrated using gaussian quadrature
    integration for greater accuracy. Right, the fractional difference
    between the two is shown. We can see that in this case the midpoint
    sampling is inaccurate by up to 30% of the pixel value in areas of
    high contrast. The exact inaccuracy depends greatly on the exact
    configuration.<styled-content id="figU003Asample"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="showquad.png" />
  </fig>
  <p>The current scope of <monospace>caustics</monospace> does not
  include weak lensing, microlensing, or cluster scale lensing
  simulations. While the underlying mathematical frameworks are similar,
  the specific techniques commonly used in these areas are not yet
  implemented, although they represent an avenue for future
  development.</p>
  <p>The scope of <monospace>caustics</monospace> ends at lensing
  simulation, thus it does not include functionality to optimize or
  sample the resulting functions. Users are encouraged to use already
  existing optimization and sampling codes such as
  <monospace>scipy.optimize</monospace>
  (<xref alt="Virtanen et al., 2020" rid="ref-scipy" ref-type="bibr">Virtanen
  et al., 2020</xref>), <monospace>emcee</monospace>
  (<xref alt="Foreman-Mackey et al., 2013" rid="ref-emcee" ref-type="bibr">Foreman-Mackey
  et al., 2013</xref>), <monospace>dynesty</monospace>
  (<xref alt="Speagle, 2020" rid="ref-dynesty" ref-type="bibr">Speagle,
  2020</xref>), <monospace>Pyro</monospace>
  (<xref alt="Bingham et al., 2019" rid="ref-pyro" ref-type="bibr">Bingham
  et al., 2019</xref>), and <monospace>torch.optim</monospace>
  (<xref alt="Paszke et al., 2019" rid="ref-pytorch" ref-type="bibr">Paszke
  et al., 2019</xref>). Interfacing with these codes is easy and
  demonstrations are included in the documentation.</p>
</sec>
<sec id="performance">
  <title>Performance</title>
  <p>Here we discuss the performance enhancements enabled by
  <monospace>caustics</monospace>. The code allows operations to be
  batched, multi-threaded on CPUs, or offloaded to GPUs to optimize
  computational efficiency (via <monospace>PyTorch</monospace>). In
  <xref alt="[fig:runtime]" rid="figU003Aruntime">[fig:runtime]</xref>
  we demonstrate this by sampling images of a Sérsic with an SIE model
  lensing the image (much like
  <xref alt="[fig:sample]" rid="figU003Asample">[fig:sample]</xref>).
  For CPU calculations we use an
  <monospace>Intel Gold 6148 Skylake</monospace> and for the GPU we use
  an <monospace>NVIDIA V100</monospace>, all tests were done at 64 bit
  precision. In the two subfigures we show the performance for sampling
  a 128x128 image using the pixel midpoint (left), and sampling a
  “realistic” image (right) which is upsampled by a factor of 4 and
  convolved with a PSF. The “caustics unbached CPU” line means the
  “Number of samples” (x-axis) were computed by using a Python
  <monospace>for-loop</monospace>. The “caustics batched CPU/4CPU” lines
  are determined by sending all “Number of samples” through the
  simulator simultaneously using <monospace>PyTorch</monospace>
  <monospace>vmap</monospace> on a single CPU or on four CPUs
  respectively. The “caustics batched gpu” line is determined similarly,
  except that the computations are performed on the GPU. All parameters
  are randomly resampled for each simulation to avoid caching effects.
  This demonstrates a number of interesting facts about numerical
  performance in such scenarios.</p>
  <p>We compare the performance with that of
  <monospace>lenstronomy</monospace> as our baseline. The most direct
  comparison between the two codes can be observed by comparing the
  <monospace>lenstronomy</monospace> line with the “caustics unbatched
  CPU” line. <monospace>lenstronomy</monospace> is written using the
  <monospace>numba</monospace>
  (<xref alt="Lam et al., 2015" rid="ref-numba" ref-type="bibr">Lam et
  al., 2015</xref>) package which compiles Python code into lower level
  C code. The left plot shows that <monospace>caustics</monospace>
  suffers from a significant overhead compared with
  <monospace>lenstronomy</monospace>, which is nearly twice as fast as
  the “caustics unbatched CPU” line. This occurs because the pure Python
  (interpreted language) elements of <monospace>caustics</monospace> are
  much slower than the C/Cuda PyTorch backends (compiled language). This
  is most pronounced when fewer computations are needed to perform a
  simulation. Despite this overhead, <monospace>caustics</monospace>
  showcases a strong performance when using the batched GPU setting,
  especially in the more realistic scenario with extra computations in
  the simulator including 4x oversampling of the raytracing and the PSF
  convolution.</p>
  <fig>
    <caption><p>Runtime comparisons for a simple lensing setup. We
    compare the amount of time taken (y-axis) to generate a certain
    number of lensing realizations (x-axis) where a Sérsic model is
    lensed by an SIE mass distribution. For CPU calculations we use
    <monospace>Intel Gold 6148 Skylake</monospace> and for the GPU we
    use a <monospace>NVIDIA V100</monospace>, all tests were done at 64
    bit precision. On the left, the lensing system is sampled 128 pixel
    resolution only at pixel midpoints. On the right, a more realistic
    simulation includes upsampled pixels and PSF convolution. From the
    two tests we see varying performance enhancements from compiled,
    unbatched, batched, multi-threaded, and GPU processing
    setups.<styled-content id="figU003Aruntime"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="runtime_comparison.png" />
  </fig>
  <p>Comparing the “caustics unbatched CPU” and “caustics batched CPU”
  lines we see that batching can provide more efficient use of the same,
  single CPU, computational resources. However, in the realistic
  scenario the batching has minimal performance enhancement, likely
  because the Python overhead of a for-loop is no longer significant
  compared to the large number of numerical operations being
  performed.</p>
  <p>Comparing “caustics batched CPU” and “caustics batched 4CPU” we see
  that PyTorch’s automatic multi-threading capabilities can indeed
  provide performance improvements. However, the improvement is not a
  direct multiple of the number of CPUs due to overheads. For tasks that
  are “embarrassingly parallel,” such as running multiple MCMC chains,
  it is more effective to parallelize at the job level rather than at
  the thread level to avoid these overheads.</p>
  <p>The most dramatic improvements are observed when comparing any CPU
  operations with “caustics batched gpu”. Although communication between
  the CPU and GPU can be slow, consolidating calculations into fewer,
  larger batches allow <monospace>caustics</monospace> to fully exploit
  GPU capabilities. In the midpoint sampling, the GPU never “saturates”
  meaning that it runs equally fast for any number of samples. In the
  realistic scenario, we reach the saturation limit of the GPU memory at
  100 samples and can no longer simultaneously model all the systems, we
  thus enter a linear regime in runtime just like the CPU for any number
  of simulations. The V100 GPUs have 16 GB of memory, with 100 images at
  128x128 resolution, upsampled on each axis by 4 times (16 times the
  memory), and 64bit precision each operation requires approximately
  200MB of memory. Since gravitational lensing requires a number of
  intermediate calculations<xref ref-type="fn" rid="fn1">1</xref> such
  as computing FFTs for convolution, plus PyTorch overheads, this fills
  the GPU memory. An A100 GPU with 80GB of memory can remain in the flat
  regime much further before saturation, giving even further performance
  improvements over CPU computations. Nonetheless, it is possible to
  easily achieve roughly 1000X speedup over CPU performance, making GPUs
  by far the most efficient method to perform large lensing computations
  such as running many MCMC chains or sampling many lensing realizations
  (e.g. for training machine learning models).</p>
</sec>
<sec id="user-experience">
  <title>User experience</title>
  <p>Caustics offers a tiered interface system designed to cater to
  users with varying levels of expertise in gravitational lensing
  simulation. This section outlines the three levels of interfaces that
  enhance the user experience by providing different degrees of
  complexity and flexibility.</p>
  <p><bold>Configuration file interface:</bold> The most accessible
  level of interaction is through configuration files. Users can define
  simulators in <monospace>.yaml</monospace> format, specifying
  parameters such as lens models, light source characteristics, and
  image processing details like PSF convolution and sub-pixel
  integration. The users can then load such a simulator in a single line
  of Python and carry on using that simulator as a pure function
  <monospace>f(x)</monospace> which takes in parameters such as the
  Sérsic index, position, SIE Einstein radius, etc. and returns an
  image. This interface is straightforward for new users and for
  simplifying the sharing of simulation configurations between
  users.</p>
  <p><bold>Object-oriented interface:</bold> This intermediate level
  allows users to manipulate lenses and light sources as objects. The
  users can build simulators just like the configuration file interface,
  or they can interact with the objects in a number of other ways
  accessing further details about each lens. Each lensing object has
  (where meaningful) a convergence, potential, time delay, and
  deflection field plus any associated quantities such as magnification.
  We provide examples to visualize all of these. Users can apply the
  full flexibility of Python to these lensing objects and construct
  customized analysis code, although there are many default routines
  which enable one to quickly perform typical analysis tasks.</p>
  <p>For both the object-oriented and configuration file interfaces, the
  final simulator object can be analyzed in a number of ways,
  <xref alt="[fig:graph]" rid="figU003Agraph">[fig:graph]</xref>
  demonstrates how one can investigate the structure of a simulator in
  the form of a directed acyclic graph of calculations. Note that one
  can also fix a subset of parameter values, making them “static”
  instead of the default, which is “dynamic”. Users can produce such a
  graph representation for any <monospace>caustics</monospace>
  simulator.</p>
  <fig>
    <caption><p>Example directed acyclic graph representation of the
    simulator from
    <xref alt="[fig:runtime]" rid="figU003Aruntime">[fig:runtime]</xref>.
    Ellipses are <monospace>caustics</monospace> objects and squares are
    parameters; open squares are dynamic parameters and greyed squares
    are static parameters. Parameters are passed at the top level node
    (<monospace>Lens_Source</monospace>) and flow down the graph
    automatically to all other objects which require parameter values to
    complete a lensing
    simulation.<styled-content id="figU003Agraph"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="graph.png" />
  </fig>
  <p><bold>Functional interface:</bold> The functional interface avoids
  the object-oriented <monospace>caustics</monospace> code, instead
  giving the users access to individual mathematical operations related
  to lensing, most of which are drawn directly from gravitational
  lensing literature. All such functions include references in their
  documentation to the relevant papers and equation numbers from which
  they are derived. These equations have been tested and implemented in
  a reasonably efficient manner. This interface is ideal for researchers
  and developers looking to experiment with novel lensing techniques or
  to modify existing algorithms while leveraging robust, pre-tested
  components.</p>
  <p>Each layer is in fact built on the one below it, making the
  transition from one to the other a matter of following documentation
  and code references. This makes the transition easy because one can
  very clearly see how their current analysis can be reproduced in the
  lower level. <monospace>Caustics</monospace> thus provides a
  straightforward pipeline for users to move from beginner to expert.
  Users at all levels are encouraged to investigate the documentation as
  the code includes extensive information for all methods, including
  units for most functions. This transparency not only aids in
  understanding and utilizing the functions correctly but also enhances
  the reliability and educational value of the software.</p>
</sec>
<sec id="flexibility">
  <title>Flexibility</title>
  <p>The flexibility of caustics is fundamentally linked to its design
  philosophy, which is focused on providing a robust yet adaptable
  framework for gravitational lensing simulations. A focus on minimalism
  in the core functionality means that research-ready analysis routines
  must be built by users. To facilitate this, our Jupyter notebook
  tutorials include examples of many typical analysis tasks, with the
  details laid out for the users so they can simply copy and modify to
  suit their particular analysis task. Thus, we achieve flexibility both
  by allowing many analysis paradigms, and by supporting the easy
  development of production code. With the simulator paradigm designed
  to produce simple functions (typically with the form
  <monospace>f(x)</monospace>) it is easy to interface
  <monospace>caustics</monospace> simulators with any other Python
  packages. Users are not constrained to pre-built analysis routines or
  design decisions and are instead encouraged to extend and interface
  with other packages.</p>
  <p>Research is an inherently dynamic process and gravitational lensing
  is an evolving field. Designing flexible codes for such environments
  ensures long-lasting relevance. <monospace>Caustics</monospace> is
  well positioned to grow and evolve with the needs of the
  community.</p>
</sec>
<sec id="machine-learning">
  <title>Machine Learning</title>
  <p>One of the core purposes of <monospace>caustics</monospace> is to
  advance the application of machine learning to strong gravitational
  lensing analysis. This is accomplished through two avenues. First, as
  demonstrated in
  <xref alt="[fig:runtime]" rid="figU003Aruntime">[fig:runtime]</xref>,
  <monospace>caustics</monospace> efficiently generates large samples of
  simulated mock lensing images by leveraging GPUs. Since many machine
  learning algorithms are “data hungry”, this translates to better
  performance with more examples to learn from. Literature on machine
  learning applications in strong gravitational lensing underscores the
  benefits of this generation capacity
  (<xref alt="Brehmer et al., 2019" rid="ref-Brehmer2019" ref-type="bibr">Brehmer
  et al., 2019</xref>;
  <xref alt="Chianese et al., 2020" rid="ref-Chianese2020" ref-type="bibr">Chianese
  et al., 2020</xref>;
  <xref alt="Coogan et al., 2020" rid="ref-Coogan2020" ref-type="bibr">Coogan
  et al., 2020</xref>;
  <xref alt="Karchev, Coogan, et al., 2022" rid="ref-Karchev2022" ref-type="bibr">Karchev,
  Coogan, et al., 2022</xref>;
  <xref alt="Karchev, Anau Montel, et al., 2022" rid="ref-Karchev2022b" ref-type="bibr">Karchev,
  Anau Montel, et al., 2022</xref>;
  <xref alt="Mishra-Sharma &amp; Yang, 2022" rid="ref-Mishra2022" ref-type="bibr">Mishra-Sharma
  &amp; Yang, 2022</xref>). Second, the differentiable nature of
  <monospace>caustics</monospace> allows it to be integrated directly
  into machine learning workflows. This could mean using
  <monospace>caustics</monospace> as part of a loss function.
  Alternatively, it could be through a statistical paradigm like
  diffusion modelling, in which <monospace>caustics</monospace> would be
  directly integrated in the sampling procedure. It has already been
  shown that differentiable lensing simulators, coupled with machine
  learning and diffusion modelling, can massively improve source
  reconstruction in strong gravitational lenses
  (<xref alt="Adam et al., 2022" rid="ref-Adam2022" ref-type="bibr">Adam
  et al., 2022</xref>) and in weak lensing
  (<xref alt="Remy et al., 2023" rid="ref-Remy2023" ref-type="bibr">Remy
  et al., 2023</xref>).</p>
</sec>
<sec id="conclusions">
  <title>Conclusions</title>
  <p>Here we have presented <monospace>caustics</monospace>, a
  gravitational lensing simulator framework which allows for greater
  than 100 times speedup over traditional CPU implementations by
  leveraging GPU resources. <monospace>Caustics</monospace> is
  fully-featured, meaning one can straightforwardly model any strong
  lensing system with state-of-the-art techniques. The code and
  documentation facilitate the transition of users from beginner to
  expert by providing three interfaces which allow increasingly more
  flexibility in how one wishes to model a lensing system.
  <monospace>Caustics</monospace> is designed to be the gravitational
  lensing simulator of the future and to meet the hundreds of thousands
  of lenses soon to be discovered with modern computational
  resources.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This research was enabled by a generous donation by Eric and Wendy
  Schmidt with the recommendation of the Schmidt Futures Foundation. We
  acknowledge the generous software support of the University of
  Washington Scientific Software Engineering Center (SSEC) at the
  eScience Institute, via matching through the Schmidt Futures Virtual
  Institute for Scientific Software (VISS). CS acknowledges the support
  of a NSERC Postdoctoral Fellowship and a CITA National Fellowship.
  This research was enabled in part by support provided by Calcul Québec
  and the Digital Research Alliance of Canada. The work of A.A. and R.L.
  was partially funded by NSERC CGS D scholarships. Y.H. and L.P.
  acknowledge support from the National Sciences and Engineering Council
  of Canada grants RGPIN-2020-05073 and 05102, the Fonds de recherche du
  Québec grants 2022-NC-301305 and 300397, and the Canada Research
  Chairs Program. Thanks to Simon Birrer for communications regarding
  benchmarking of <monospace>lenstronomy</monospace>. Thanks to James
  Nightingale and Andi Gu for thoughtful reviews of the codebase, and
  thanks to Ivelina Momcheva for a thorough editorial review.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-lenstronomy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Birrer</surname><given-names>Simon</given-names></name>
        <name><surname>Shajib</surname><given-names>Anowar J.</given-names></name>
        <name><surname>Gilman</surname><given-names>Daniel</given-names></name>
        <name><surname>Galan</surname><given-names>Aymeric</given-names></name>
        <name><surname>Aalbers</surname><given-names>Jelle</given-names></name>
        <name><surname>Million</surname><given-names>Martin</given-names></name>
        <name><surname>Morgan</surname><given-names>Robert</given-names></name>
        <name><surname>Pagano</surname><given-names>Giulia</given-names></name>
        <name><surname>Park</surname><given-names>Ji Won</given-names></name>
        <name><surname>Teodori</surname><given-names>Luca</given-names></name>
        <name><surname>Tessore</surname><given-names>Nicolas</given-names></name>
        <name><surname>Ueland</surname><given-names>Madison</given-names></name>
        <name><surname>Vyvere</surname><given-names>Lyne Van de</given-names></name>
        <name><surname>Wagner-Carena</surname><given-names>Sebastian</given-names></name>
        <name><surname>Wempe</surname><given-names>Ewoud</given-names></name>
        <name><surname>Yang</surname><given-names>Lilan</given-names></name>
        <name><surname>Ding</surname><given-names>Xuheng</given-names></name>
        <name><surname>Schmidt</surname><given-names>Thomas</given-names></name>
        <name><surname>Sluse</surname><given-names>Dominique</given-names></name>
        <name><surname>Zhang</surname><given-names>Ming</given-names></name>
        <name><surname>Amara</surname><given-names>Adam</given-names></name>
      </person-group>
      <article-title>Lenstronomy II: A gravitational lensing software ecosystem</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>6</volume>
      <issue>62</issue>
      <uri>https://doi.org/10.21105/joss.03283</uri>
      <pub-id pub-id-type="doi">10.21105/joss.03283</pub-id>
      <fpage>3283</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-PyAutoLens">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nightingale</surname><given-names>James. W.</given-names></name>
        <name><surname>Hayes</surname><given-names>Richard G.</given-names></name>
        <name><surname>Kelly</surname><given-names>Ashley</given-names></name>
        <name><surname>Amvrosiadis</surname><given-names>Aristeidis</given-names></name>
        <name><surname>Etherington</surname><given-names>Amy</given-names></name>
        <name><surname>He</surname><given-names>Qiuhan</given-names></name>
        <name><surname>Li</surname><given-names>Nan</given-names></name>
        <name><surname>Cao</surname><given-names>XiaoYue</given-names></name>
        <name><surname>Frawley</surname><given-names>Jonathan</given-names></name>
        <name><surname>Cole</surname><given-names>Shaun</given-names></name>
        <name><surname>Enia</surname><given-names>Andrea</given-names></name>
        <name><surname>Frenk</surname><given-names>Carlos S.</given-names></name>
        <name><surname>Harvey</surname><given-names>David R.</given-names></name>
        <name><surname>Li</surname><given-names>Ran</given-names></name>
        <name><surname>Massey</surname><given-names>Richard J.</given-names></name>
        <name><surname>Negrello</surname><given-names>Mattia</given-names></name>
        <name><surname>Robertson</surname><given-names>Andrew</given-names></name>
      </person-group>
      <article-title>‘PyAutoLens‘: Open-source strong gravitational lensing</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>6</volume>
      <issue>58</issue>
      <uri>https://doi.org/10.21105/joss.02825</uri>
      <pub-id pub-id-type="doi">10.21105/joss.02825</pub-id>
      <fpage>2825</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Herculens">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Galan</surname><given-names>A.</given-names></name>
        <name><surname>Vernardos</surname><given-names>G.</given-names></name>
        <name><surname>Peel</surname><given-names>A.</given-names></name>
        <name><surname>Courbin</surname><given-names>F.</given-names></name>
        <name><surname>Starck</surname><given-names>J. -L.</given-names></name>
      </person-group>
      <article-title>Using wavelets to capture deviations from smoothness in galaxy-scale strong lenses</article-title>
      <source>Astronomy and Astrophysics</source>
      <year iso-8601-date="2022-12">2022</year><month>12</month>
      <volume>668</volume>
      <uri>https://arxiv.org/abs/2207.05763</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361/202244464</pub-id>
      <fpage>A155</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-GIGALens">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gu</surname><given-names>A.</given-names></name>
        <name><surname>Huang</surname><given-names>X.</given-names></name>
        <name><surname>Sheu</surname><given-names>W.</given-names></name>
        <name><surname>Aldering</surname><given-names>G.</given-names></name>
        <name><surname>Bolton</surname><given-names>A. S.</given-names></name>
        <name><surname>Boone</surname><given-names>K.</given-names></name>
        <name><surname>Dey</surname><given-names>A.</given-names></name>
        <name><surname>Filipp</surname><given-names>A.</given-names></name>
        <name><surname>Jullo</surname><given-names>E.</given-names></name>
        <name><surname>Perlmutter</surname><given-names>S.</given-names></name>
        <name><surname>Rubin</surname><given-names>D.</given-names></name>
        <name><surname>Schlafly</surname><given-names>E. F.</given-names></name>
        <name><surname>Schlegel</surname><given-names>D. J.</given-names></name>
        <name><surname>Shu</surname><given-names>Y.</given-names></name>
        <name><surname>Suyu</surname><given-names>S. H.</given-names></name>
      </person-group>
      <article-title>GIGA-Lens: Fast Bayesian Inference for Strong Gravitational Lens Modeling</article-title>
      <source>The Astrophysical Journal</source>
      <year iso-8601-date="2022-08">2022</year><month>08</month>
      <volume>935</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/2202.07663</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/ac6de4</pub-id>
      <fpage>49</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Kneib2011">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Kneib</surname><given-names>Jean-Paul</given-names></name>
        <name><surname>Bonnet</surname><given-names>Henri</given-names></name>
        <name><surname>Golse</surname><given-names>Ghyslain</given-names></name>
        <name><surname>Sand</surname><given-names>David</given-names></name>
        <name><surname>Jullo</surname><given-names>Eric</given-names></name>
        <name><surname>Marshall</surname><given-names>Phil</given-names></name>
      </person-group>
      <article-title>LENSTOOL: A Gravitational Lensing Software for Modeling Mass Distribution of Galaxies and Clusters (strong and weak regime)</article-title>
      <publisher-name>Astrophysics Source Code Library, record ascl:1102.004</publisher-name>
      <year iso-8601-date="2011-02">2011</year><month>02</month>
    </element-citation>
  </ref>
  <ref id="ref-Wagner2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wagner-Carena</surname><given-names>Sebastian</given-names></name>
        <name><surname>Lee</surname><given-names>Jaehoon</given-names></name>
        <name><surname>Pennington</surname><given-names>Jeffrey</given-names></name>
        <name><surname>Aalbers</surname><given-names>Jelle</given-names></name>
        <name><surname>Birrer</surname><given-names>Simon</given-names></name>
        <name><surname>Wechsler</surname><given-names>Risa H.</given-names></name>
      </person-group>
      <article-title>A Strong Gravitational Lens Is Worth a Thousand Dark Matter Halos: Inference on Small-Scale Structure Using Sequential Methods</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2024-04">2024</year><month>04</month>
      <uri>https://arxiv.org/abs/2404.14487</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2404.14487</pub-id>
      <fpage>arXiv:2404.14487</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-GLAMER">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Metcalf</surname><given-names>R. Benton</given-names></name>
        <name><surname>Petkova</surname><given-names>Margarita</given-names></name>
      </person-group>
      <article-title>GLAMER - I. A code for gravitational lensing simulations with adaptive mesh refinement</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2014-12">2014</year><month>12</month>
      <volume>445</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/1312.1128</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stu1859</pub-id>
      <fpage>1942</fpage>
      <lpage>1953</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Galan2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Galan</surname><given-names>A.</given-names></name>
        <name><surname>Peel</surname><given-names>A.</given-names></name>
        <name><surname>Joseph</surname><given-names>R.</given-names></name>
        <name><surname>Courbin</surname><given-names>F.</given-names></name>
        <name><surname>Starck</surname><given-names>J. -L.</given-names></name>
      </person-group>
      <article-title>SLITRONOMY: Towards a fully wavelet-based strong lensing inversion technique</article-title>
      <source>Astronomy and Astrophysics</source>
      <year iso-8601-date="2021-03">2021</year><month>03</month>
      <volume>647</volume>
      <uri>https://arxiv.org/abs/2012.02802</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361/202039363</pub-id>
      <fpage>A176</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Suyu2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Suyu</surname><given-names>S. H.</given-names></name>
        <name><surname>Halkola</surname><given-names>A.</given-names></name>
      </person-group>
      <article-title>The halos of satellite galaxies: the companion of the massive elliptical lens SL2S J08544-0121</article-title>
      <source>Astronomy and Astrophysics</source>
      <year iso-8601-date="2010-12">2010</year><month>12</month>
      <volume>524</volume>
      <uri>https://arxiv.org/abs/1007.4815</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361/201015481</pub-id>
      <fpage>A94</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Keeton2011">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Keeton</surname><given-names>Charles R.</given-names></name>
      </person-group>
      <article-title>GRAVLENS: Computational Methods for Gravitational Lensing</article-title>
      <publisher-name>Astrophysics Source Code Library, record ascl:1102.003</publisher-name>
      <year iso-8601-date="2011-02">2011</year><month>02</month>
    </element-citation>
  </ref>
  <ref id="ref-Edwards2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Edwards</surname><given-names>Thomas D. P.</given-names></name>
        <name><surname>Wong</surname><given-names>Kaze W. K.</given-names></name>
        <name><surname>Lam</surname><given-names>Kelvin K. H.</given-names></name>
        <name><surname>Coogan</surname><given-names>Adam</given-names></name>
        <name><surname>Foreman-Mackey</surname><given-names>Daniel</given-names></name>
        <name><surname>Isi</surname><given-names>Maximiliano</given-names></name>
        <name><surname>Zimmerman</surname><given-names>Aaron</given-names></name>
      </person-group>
      <article-title>ripple: Differentiable and Hardware-Accelerated Waveforms for Gravitational Wave Data Analysis</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2023-02">2023</year><month>02</month>
      <uri>https://arxiv.org/abs/2302.05329</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2302.05329</pub-id>
      <fpage>arXiv:2302.05329</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Coogan2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Coogan</surname><given-names>Adam</given-names></name>
        <name><surname>Edwards</surname><given-names>Thomas D. P.</given-names></name>
        <name><surname>Chia</surname><given-names>Horng Sheng</given-names></name>
        <name><surname>George</surname><given-names>Richard N.</given-names></name>
        <name><surname>Freese</surname><given-names>Katherine</given-names></name>
        <name><surname>Messick</surname><given-names>Cody</given-names></name>
        <name><surname>Setzer</surname><given-names>Christian N.</given-names></name>
        <name><surname>Weniger</surname><given-names>Christoph</given-names></name>
        <name><surname>Zimmerman</surname><given-names>Aaron</given-names></name>
      </person-group>
      <article-title>Efficient gravitational wave template bank generation with differentiable waveforms</article-title>
      <source>Physical Review D</source>
      <year iso-8601-date="2022-12">2022</year><month>12</month>
      <volume>106</volume>
      <issue>12</issue>
      <uri>https://arxiv.org/abs/2202.09380</uri>
      <pub-id pub-id-type="doi">10.1103/PhysRevD.106.122001</pub-id>
      <fpage>122001</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Wong2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wong</surname><given-names>Kaze W. K.</given-names></name>
        <name><surname>Isi</surname><given-names>Maximiliano</given-names></name>
        <name><surname>Edwards</surname><given-names>Thomas D. P.</given-names></name>
      </person-group>
      <article-title>Fast Gravitational-wave Parameter Estimation without Compromises</article-title>
      <source>The Astrophysical Journal</source>
      <year iso-8601-date="2023-12">2023</year><month>12</month>
      <volume>958</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/2302.05333</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/acf5cd</pub-id>
      <fpage>129</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Desdoigts2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Desdoigts</surname><given-names>Louis</given-names></name>
        <name><surname>Pope</surname><given-names>Benjamin J. S.</given-names></name>
        <name><surname>Dennis</surname><given-names>Jordan</given-names></name>
        <name><surname>Tuthill</surname><given-names>Peter G.</given-names></name>
      </person-group>
      <article-title>Differentiable optics with ∂Lux: I—deep calibration of flat field and phase retrieval with automatic differentiation</article-title>
      <source>Journal of Astronomical Telescopes, Instruments, and Systems</source>
      <publisher-name>SPIE</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>9</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1117/1.JATIS.9.2.028007</uri>
      <pub-id pub-id-type="doi">10.1117/1.JATIS.9.2.028007</pub-id>
      <fpage>028007</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Stone2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Stone</surname><given-names>Connor J.</given-names></name>
        <name><surname>Courteau</surname><given-names>Stéphane</given-names></name>
        <name><surname>Cuillandre</surname><given-names>Jean-Charles</given-names></name>
        <name><surname>Hezaveh</surname><given-names>Yashar</given-names></name>
        <name><surname>Perreault-Levasseur</surname><given-names>Laurence</given-names></name>
        <name><surname>Arora</surname><given-names>Nikhil</given-names></name>
      </person-group>
      <article-title>ASTROPHOT: fitting everything everywhere all at once in astronomical images</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2023-11">2023</year><month>11</month>
      <volume>525</volume>
      <issue>4</issue>
      <uri>https://arxiv.org/abs/2308.01957</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stad2477</pub-id>
      <fpage>6377</fpage>
      <lpage>6393</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Chianese2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chianese</surname><given-names>Marco</given-names></name>
        <name><surname>Coogan</surname><given-names>Adam</given-names></name>
        <name><surname>Hofma</surname><given-names>Paul</given-names></name>
        <name><surname>Otten</surname><given-names>Sydney</given-names></name>
        <name><surname>Weniger</surname><given-names>Christoph</given-names></name>
      </person-group>
      <article-title>Differentiable strong lensing: uniting gravity and neural nets through differentiable probabilistic programming</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2020-07">2020</year><month>07</month>
      <volume>496</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1910.06157</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/staa1477</pub-id>
      <fpage>381</fpage>
      <lpage>393</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Karchev2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Karchev</surname><given-names>Konstantin</given-names></name>
        <name><surname>Coogan</surname><given-names>Adam</given-names></name>
        <name><surname>Weniger</surname><given-names>Christoph</given-names></name>
      </person-group>
      <article-title>Strong-lensing source reconstruction with variationally optimized Gaussian processes</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <volume>512</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/2105.09465</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stac311</pub-id>
      <fpage>661</fpage>
      <lpage>685</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Brehmer2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brehmer</surname><given-names>Johann</given-names></name>
        <name><surname>Mishra-Sharma</surname><given-names>Siddharth</given-names></name>
        <name><surname>Hermans</surname><given-names>Joeri</given-names></name>
        <name><surname>Louppe</surname><given-names>Gilles</given-names></name>
        <name><surname>Cranmer</surname><given-names>Kyle</given-names></name>
      </person-group>
      <article-title>Mining for Dark Matter Substructure: Inferring Subhalo Population Properties from Strong Lenses with Machine Learning</article-title>
      <source>The Astrophysical Journal</source>
      <year iso-8601-date="2019-11">2019</year><month>11</month>
      <volume>886</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1909.02005</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/ab4c41</pub-id>
      <fpage>49</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Mishra2022">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Mishra-Sharma</surname><given-names>Siddharth</given-names></name>
        <name><surname>Yang</surname><given-names>Ge</given-names></name>
      </person-group>
      <article-title>Strong Lensing Source Reconstruction Using Continuous Neural Fields</article-title>
      <source>Machine learning for astrophysics</source>
      <year iso-8601-date="2022-07">2022</year><month>07</month>
      <uri>https://arxiv.org/abs/2206.14820</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2206.14820</pub-id>
      <fpage>34</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Coogan2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Coogan</surname><given-names>Adam</given-names></name>
        <name><surname>Karchev</surname><given-names>Konstantin</given-names></name>
        <name><surname>Weniger</surname><given-names>Christoph</given-names></name>
      </person-group>
      <article-title>Targeted Likelihood-Free Inference of Dark Matter Substructure in Strongly-Lensed Galaxies</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2020-10">2020</year><month>10</month>
      <uri>https://arxiv.org/abs/2010.07032</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2010.07032</pub-id>
      <fpage>arXiv:2010.07032</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Karchev2022b">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Karchev</surname><given-names>Konstantin</given-names></name>
        <name><surname>Anau Montel</surname><given-names>Noemi</given-names></name>
        <name><surname>Coogan</surname><given-names>Adam</given-names></name>
        <name><surname>Weniger</surname><given-names>Christoph</given-names></name>
      </person-group>
      <article-title>Strong-Lensing Source Reconstruction with Denoising Diffusion Restoration Models</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2022-11">2022</year><month>11</month>
      <uri>https://arxiv.org/abs/2211.04365</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2211.04365</pub-id>
      <fpage>arXiv:2211.04365</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Millon2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Million</surname><given-names>Martin</given-names></name>
        <name><surname>Michalewicz</surname><given-names>Kevin</given-names></name>
        <name><surname>Dux</surname><given-names>Frédéric</given-names></name>
        <name><surname>Courbin</surname><given-names>Frédéric</given-names></name>
        <name><surname>Marshall</surname><given-names>Philip J.</given-names></name>
      </person-group>
      <article-title>Image deconvolution and PSF reconstruction with STARRED: a wavelet-based two-channel method optimized for light curve extraction</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2024-02">2024</year><month>02</month>
      <uri>https://arxiv.org/abs/2402.08725</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2402.08725</pub-id>
      <fpage>arXiv:2402.08725</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-dynesty">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Speagle</surname><given-names>Joshua S.</given-names></name>
      </person-group>
      <article-title>DYNESTY: a dynamic nested sampling package for estimating Bayesian posteriors and evidences</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2020-04">2020</year><month>04</month>
      <volume>493</volume>
      <issue>3</issue>
      <uri>https://arxiv.org/abs/1904.02180</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/staa278</pub-id>
      <fpage>3132</fpage>
      <lpage>3158</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Nikolic2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nikolic</surname><given-names>Bojan</given-names></name>
      </person-group>
      <article-title>Acceleration of Non-Linear Minimisation with PyTorch</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2018-05">2018</year><month>05</month>
      <uri>https://arxiv.org/abs/1805.07439</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.1805.07439</pub-id>
      <fpage>arXiv:1805.07439</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Petrillo2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Petrillo</surname><given-names>C. E.</given-names></name>
        <name><surname>Tortora</surname><given-names>C.</given-names></name>
        <name><surname>Chatterjee</surname><given-names>S.</given-names></name>
        <name><surname>Vernardos</surname><given-names>G.</given-names></name>
        <name><surname>Koopmans</surname><given-names>L. V. E.</given-names></name>
        <name><surname>Verdoes Kleijn</surname><given-names>G.</given-names></name>
        <name><surname>Napolitano</surname><given-names>N. R.</given-names></name>
        <name><surname>Covone</surname><given-names>G.</given-names></name>
        <name><surname>Schneider</surname><given-names>P.</given-names></name>
        <name><surname>Grado</surname><given-names>A.</given-names></name>
        <name><surname>McFarland</surname><given-names>J.</given-names></name>
      </person-group>
      <article-title>Finding strong gravitational lenses in the Kilo Degree Survey with Convolutional Neural Networks</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2017-11">2017</year><month>11</month>
      <volume>472</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1702.07675</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stx2052</pub-id>
      <fpage>1129</fpage>
      <lpage>1150</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Huang2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Huang</surname><given-names>X.</given-names></name>
        <name><surname>Storfer</surname><given-names>C.</given-names></name>
        <name><surname>Gu</surname><given-names>A.</given-names></name>
        <name><surname>Ravi</surname><given-names>V.</given-names></name>
        <name><surname>Pilon</surname><given-names>A.</given-names></name>
        <name><surname>Sheu</surname><given-names>W.</given-names></name>
        <name><surname>Venguswamy</surname><given-names>R.</given-names></name>
        <name><surname>Banka</surname><given-names>S.</given-names></name>
        <name><surname>Dey</surname><given-names>A.</given-names></name>
        <name><surname>Landriau</surname><given-names>M.</given-names></name>
        <name><surname>Lang</surname><given-names>D.</given-names></name>
        <name><surname>Meisner</surname><given-names>A.</given-names></name>
        <name><surname>Moustakas</surname><given-names>J.</given-names></name>
        <name><surname>Myers</surname><given-names>A. D.</given-names></name>
        <name><surname>Sajith</surname><given-names>R.</given-names></name>
        <name><surname>Schlafly</surname><given-names>E. F.</given-names></name>
        <name><surname>Schlegel</surname><given-names>D. J.</given-names></name>
      </person-group>
      <article-title>Discovering New Strong Gravitational Lenses in the DESI Legacy Imaging Surveys</article-title>
      <source>The Astrophysical Journal</source>
      <year iso-8601-date="2021-03">2021</year><month>03</month>
      <volume>909</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/2005.04730</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/abd62b</pub-id>
      <fpage>27</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-holycow">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wong</surname><given-names>Kenneth C.</given-names></name>
        <name><surname>Suyu</surname><given-names>Sherry H.</given-names></name>
        <name><surname>Chen</surname><given-names>Geoff C. -F.</given-names></name>
        <name><surname>Rusu</surname><given-names>Cristian E.</given-names></name>
        <name><surname>Million</surname><given-names>Martin</given-names></name>
        <name><surname>Sluse</surname><given-names>Dominique</given-names></name>
        <name><surname>Bonvin</surname><given-names>Vivien</given-names></name>
        <name><surname>Fassnacht</surname><given-names>Christopher D.</given-names></name>
        <name><surname>Taubenberger</surname><given-names>Stefan</given-names></name>
        <name><surname>Auger</surname><given-names>Matthew W.</given-names></name>
        <name><surname>Birrer</surname><given-names>Simon</given-names></name>
        <name><surname>Chan</surname><given-names>James H. H.</given-names></name>
        <name><surname>Courbin</surname><given-names>Frederic</given-names></name>
        <name><surname>Hilbert</surname><given-names>Stefan</given-names></name>
        <name><surname>Tihhonova</surname><given-names>Olga</given-names></name>
        <name><surname>Treu</surname><given-names>Tommaso</given-names></name>
        <name><surname>Agnello</surname><given-names>Adriano</given-names></name>
        <name><surname>Ding</surname><given-names>Xuheng</given-names></name>
        <name><surname>Jee</surname><given-names>In</given-names></name>
        <name><surname>Komatsu</surname><given-names>Eiichiro</given-names></name>
        <name><surname>Shajib</surname><given-names>Anowar J.</given-names></name>
        <name><surname>Sonnenfeld</surname><given-names>Alessandro</given-names></name>
        <name><surname>Blandford</surname><given-names>Roger D.</given-names></name>
        <name><surname>Koopmans</surname><given-names>Léon V. E.</given-names></name>
        <name><surname>Marshall</surname><given-names>Philip J.</given-names></name>
        <name><surname>Meylan</surname><given-names>Georges</given-names></name>
      </person-group>
      <article-title>H0LiCOW - XIII. A 2.4 per cent measurement of H_{0} from lensed quasars: 5.3\sigma tension between early- and late-Universe probes</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2020-10">2020</year><month>10</month>
      <volume>498</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1907.04869</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stz3094</pub-id>
      <fpage>1420</fpage>
      <lpage>1439</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pytorch">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Paszke</surname><given-names>Adam</given-names></name>
        <name><surname>Gross</surname><given-names>Sam</given-names></name>
        <name><surname>Massa</surname><given-names>Francisco</given-names></name>
        <name><surname>Lerer</surname><given-names>Adam</given-names></name>
        <name><surname>Bradbury</surname><given-names>James</given-names></name>
        <name><surname>Chanan</surname><given-names>Gregory</given-names></name>
        <name><surname>Killeen</surname><given-names>Trevor</given-names></name>
        <name><surname>Lin</surname><given-names>Zeming</given-names></name>
        <name><surname>Gimelshein</surname><given-names>Natalia</given-names></name>
        <name><surname>Antiga</surname><given-names>Luca</given-names></name>
        <name><surname>Desmaison</surname><given-names>Alban</given-names></name>
        <name><surname>Kopf</surname><given-names>Andreas</given-names></name>
        <name><surname>Yang</surname><given-names>Edward</given-names></name>
        <name><surname>DeVito</surname><given-names>Zachary</given-names></name>
        <name><surname>Raison</surname><given-names>Martin</given-names></name>
        <name><surname>Tejani</surname><given-names>Alykhan</given-names></name>
        <name><surname>Chilamkurthy</surname><given-names>Sasank</given-names></name>
        <name><surname>Steiner</surname><given-names>Benoit</given-names></name>
        <name><surname>Fang</surname><given-names>Lu</given-names></name>
        <name><surname>Bai</surname><given-names>Junjie</given-names></name>
        <name><surname>Chintala</surname><given-names>Soumith</given-names></name>
      </person-group>
      <article-title>PyTorch: An imperative style, high-performance deep learning library</article-title>
      <source>Advances in neural information processing systems 32</source>
      <publisher-name>Curran Associates, Inc.</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <uri>http://papers.neurips.cc/paper/9015-pytorch-an-imperative-style-high-performance-deep-learning-library.pdf</uri>
      <fpage>8024</fpage>
      <lpage>8035</lpage>
    </element-citation>
  </ref>
  <ref id="ref-JAX">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Bradbury</surname><given-names>James</given-names></name>
        <name><surname>Frostig</surname><given-names>Roy</given-names></name>
        <name><surname>Hawkins</surname><given-names>Peter</given-names></name>
        <name><surname>Johnson</surname><given-names>Matthew James</given-names></name>
        <name><surname>Leery</surname><given-names>Chris</given-names></name>
        <name><surname>Maclaurin</surname><given-names>Dougal</given-names></name>
        <name><surname>Necula</surname><given-names>George</given-names></name>
        <name><surname>Paszke</surname><given-names>Adam</given-names></name>
        <name><surname>VanderPlas</surname><given-names>Jake</given-names></name>
        <name><surname>Wanderman-Milne</surname><given-names>Skye</given-names></name>
        <name><surname>Zhang</surname><given-names>Qiao</given-names></name>
      </person-group>
      <article-title>JAX: Composable transformations of Python+NumPy programs</article-title>
      <year iso-8601-date="2018">2018</year>
      <uri>http://github.com/google/jax</uri>
    </element-citation>
  </ref>
  <ref id="ref-numba">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Lam</surname><given-names>Siu Kwan</given-names></name>
        <name><surname>Pitrou</surname><given-names>Antoine</given-names></name>
        <name><surname>Seibert</surname><given-names>Stanley</given-names></name>
      </person-group>
      <article-title>Numba: A llvm-based python jit compiler</article-title>
      <source>Proceedings of the second workshop on the LLVM compiler infrastructure in HPC</source>
      <year iso-8601-date="2015">2015</year>
      <fpage>1</fpage>
      <lpage>6</lpage>
    </element-citation>
  </ref>
  <ref id="ref-scipy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>Gommers</surname><given-names>Ralf</given-names></name>
        <name><surname>Oliphant</surname><given-names>Travis E.</given-names></name>
        <name><surname>Haberland</surname><given-names>Matt</given-names></name>
        <name><surname>Reddy</surname><given-names>Tyler</given-names></name>
        <name><surname>Cournapeau</surname><given-names>David</given-names></name>
        <name><surname>Burovski</surname><given-names>Evgeni</given-names></name>
        <name><surname>Peterson</surname><given-names>Pearu</given-names></name>
        <name><surname>Weckesser</surname><given-names>Warren</given-names></name>
        <name><surname>Bright</surname><given-names>Jonathan</given-names></name>
        <name><surname>van der Walt</surname><given-names>Stéfan J.</given-names></name>
        <name><surname>Brett</surname><given-names>Matthew</given-names></name>
        <name><surname>Wilson</surname><given-names>Joshua</given-names></name>
        <name><surname>Millman</surname><given-names>K. Jarrod</given-names></name>
        <name><surname>Mayorov</surname><given-names>Nikolay</given-names></name>
        <name><surname>Nelson</surname><given-names>Andrew R. J.</given-names></name>
        <name><surname>Jones</surname><given-names>Eric</given-names></name>
        <name><surname>Kern</surname><given-names>Robert</given-names></name>
        <name><surname>Larson</surname><given-names>Eric</given-names></name>
        <name><surname>Carey</surname><given-names>C J</given-names></name>
        <name><surname>Polat</surname><given-names>İlhan</given-names></name>
        <name><surname>Feng</surname><given-names>Yu</given-names></name>
        <name><surname>Moore</surname><given-names>Eric W.</given-names></name>
        <name><surname>VanderPlas</surname><given-names>Jake</given-names></name>
        <name><surname>Laxalde</surname><given-names>Denis</given-names></name>
        <name><surname>Perktold</surname><given-names>Josef</given-names></name>
        <name><surname>Cimrman</surname><given-names>Robert</given-names></name>
        <name><surname>Henriksen</surname><given-names>Ian</given-names></name>
        <name><surname>Quintero</surname><given-names>E. A.</given-names></name>
        <name><surname>Harris</surname><given-names>Charles R.</given-names></name>
        <name><surname>Archibald</surname><given-names>Anne M.</given-names></name>
        <name><surname>Ribeiro</surname><given-names>Antônio H.</given-names></name>
        <name><surname>Pedregosa</surname><given-names>Fabian</given-names></name>
        <name><surname>van Mulbregt</surname><given-names>Paul</given-names></name>
        <string-name>SciPy 1.0 Contributors</string-name>
      </person-group>
      <article-title>SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python</article-title>
      <source>Nature Methods</source>
      <year iso-8601-date="2020">2020</year>
      <volume>17</volume>
      <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
      <fpage>261</fpage>
      <lpage>272</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hmc">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Betancourt</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>A Conceptual Introduction to Hamiltonian Monte Carlo</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2017-01">2017</year><month>01</month>
      <uri>https://arxiv.org/abs/1701.02434</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.1701.02434</pub-id>
      <fpage>arXiv:1701.02434</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-emcee">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Foreman-Mackey</surname><given-names>Daniel</given-names></name>
        <name><surname>Hogg</surname><given-names>David W.</given-names></name>
        <name><surname>Lang</surname><given-names>Dustin</given-names></name>
        <name><surname>Goodman</surname><given-names>Jonathan</given-names></name>
      </person-group>
      <article-title>emcee: The MCMC Hammer</article-title>
      <source>Publications of the ASP</source>
      <year iso-8601-date="2013-03">2013</year><month>03</month>
      <volume>125</volume>
      <issue>925</issue>
      <uri>https://arxiv.org/abs/1202.3665</uri>
      <pub-id pub-id-type="doi">10.1086/670067</pub-id>
      <fpage>306</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-pyro">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bingham</surname><given-names>Eli</given-names></name>
        <name><surname>Chen</surname><given-names>Jonathan P</given-names></name>
        <name><surname>Jankowiak</surname><given-names>Martin</given-names></name>
        <name><surname>Obermeyer</surname><given-names>Fritz</given-names></name>
        <name><surname>Pradhan</surname><given-names>Neeraj</given-names></name>
        <name><surname>Karaletsos</surname><given-names>Theofanis</given-names></name>
        <name><surname>Singh</surname><given-names>Rohit</given-names></name>
        <name><surname>Szerlip</surname><given-names>Paul</given-names></name>
        <name><surname>Horsfall</surname><given-names>Paul</given-names></name>
        <name><surname>Goodman</surname><given-names>Noah D</given-names></name>
      </person-group>
      <article-title>Pyro: Deep universal probabilistic programming</article-title>
      <source>The Journal of Machine Learning Research</source>
      <publisher-name>JMLR. org</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>20</volume>
      <issue>1</issue>
      <fpage>973</fpage>
      <lpage>978</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Hezaveh2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hezaveh</surname><given-names>Yashar</given-names></name>
        <name><surname>Dalal</surname><given-names>Neal</given-names></name>
        <name><surname>Holder</surname><given-names>Gilbert</given-names></name>
        <name><surname>Kisner</surname><given-names>Theodore</given-names></name>
        <name><surname>Kuhlen</surname><given-names>Michael</given-names></name>
        <name><surname>Perreault Levasseur</surname><given-names>Laurence</given-names></name>
      </person-group>
      <article-title>Measuring the power spectrum of dark matter substructure using strong gravitational lensing</article-title>
      <source>Journal of Cosmology and Astroparticle Physics</source>
      <year iso-8601-date="2016-11">2016</year><month>11</month>
      <volume>2016</volume>
      <issue>11</issue>
      <uri>https://arxiv.org/abs/1403.2720</uri>
      <pub-id pub-id-type="doi">10.1088/1475-7516/2016/11/048</pub-id>
      <fpage>048</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Hezaveh2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hezaveh</surname><given-names>Yashar</given-names></name>
        <name><surname>Perreault Levasseur</surname><given-names>Laurence</given-names></name>
        <name><surname>Marshall</surname><given-names>Philip J.</given-names></name>
      </person-group>
      <article-title>Fast automated analysis of strong gravitational lenses with convolutional neural networks</article-title>
      <source>Nature</source>
      <year iso-8601-date="2017-08">2017</year><month>08</month>
      <volume>548</volume>
      <issue>7669</issue>
      <uri>https://arxiv.org/abs/1708.08842</uri>
      <pub-id pub-id-type="doi">10.1038/nature23463</pub-id>
      <fpage>555</fpage>
      <lpage>557</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Perreault2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Perreault Levasseur</surname><given-names>Laurence</given-names></name>
        <name><surname>Hezaveh</surname><given-names>Yashar D.</given-names></name>
        <name><surname>Wechsler</surname><given-names>Risa H.</given-names></name>
      </person-group>
      <article-title>Uncertainties in Parameters Estimated with Neural Networks: Application to Strong Gravitational Lensing</article-title>
      <source>The Astrophysical Journal Letters</source>
      <year iso-8601-date="2017-11">2017</year><month>11</month>
      <volume>850</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1708.08843</uri>
      <pub-id pub-id-type="doi">10.3847/2041-8213/aa9704</pub-id>
      <fpage>L7</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Vegetti2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vegetti</surname><given-names>Simona</given-names></name>
        <name><surname>Vogelsberger</surname><given-names>Mark</given-names></name>
      </person-group>
      <article-title>On the density profile of dark matter substructure in gravitational lens galaxies</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2014-08">2014</year><month>08</month>
      <volume>442</volume>
      <issue>4</issue>
      <uri>https://arxiv.org/abs/1406.1170</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stu1284</pub-id>
      <fpage>3598</fpage>
      <lpage>3603</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Peng2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Peng</surname><given-names>Chien Y.</given-names></name>
        <name><surname>Impey</surname><given-names>Chris D.</given-names></name>
        <name><surname>Rix</surname><given-names>Hans-Walter</given-names></name>
        <name><surname>Kochanek</surname><given-names>Christopher S.</given-names></name>
        <name><surname>Keeton</surname><given-names>Charles R.</given-names></name>
        <name><surname>Falco</surname><given-names>Emilio E.</given-names></name>
        <name><surname>Lehár</surname><given-names>Joseph</given-names></name>
        <name><surname>McLeod</surname><given-names>Brian A.</given-names></name>
      </person-group>
      <article-title>Probing the Coevolution of Supermassive Black Holes and Galaxies Using Gravitationally Lensed Quasar Hosts</article-title>
      <source>The Astrophysical Journal</source>
      <year iso-8601-date="2006-10">2006</year><month>10</month>
      <volume>649</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/astro-ph/0603248</uri>
      <pub-id pub-id-type="doi">10.1086/506266</pub-id>
      <fpage>616</fpage>
      <lpage>634</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Adam2022">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Adam</surname><given-names>Alexandre</given-names></name>
        <name><surname>Coogan</surname><given-names>Adam</given-names></name>
        <name><surname>Malkin</surname><given-names>Nikolay</given-names></name>
        <name><surname>Legin</surname><given-names>Ronan</given-names></name>
        <name><surname>Perreault-Levasseur</surname><given-names>Laurence</given-names></name>
        <name><surname>Hezaveh</surname><given-names>Yashar</given-names></name>
        <name><surname>Bengio</surname><given-names>Yoshua</given-names></name>
      </person-group>
      <article-title>Posterior samples of source galaxies in strong gravitational lenses with score-based priors</article-title>
      <source>Machine learning and the physical sciences workshop</source>
      <year iso-8601-date="2022-01">2022</year><month>01</month>
      <uri>https://arxiv.org/abs/2211.03812</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2211.03812</pub-id>
      <fpage>E1</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Adam2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Adam</surname><given-names>Alexandre</given-names></name>
        <name><surname>Perreault-Levasseur</surname><given-names>Laurence</given-names></name>
        <name><surname>Hezaveh</surname><given-names>Yashar</given-names></name>
        <name><surname>Welling</surname><given-names>Max</given-names></name>
      </person-group>
      <article-title>Pixelated Reconstruction of Foreground Density and Background Surface Brightness in Gravitational Lensing Systems Using Recurrent Inference Machines</article-title>
      <source>The Astrophysical Journal</source>
      <year iso-8601-date="2023-07">2023</year><month>07</month>
      <volume>951</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/2301.04168</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/accf84</pub-id>
      <fpage>6</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Remy2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Remy</surname><given-names>B.</given-names></name>
        <name><surname>Lanusse</surname><given-names>F.</given-names></name>
        <name><surname>Jeffrey</surname><given-names>N.</given-names></name>
        <name><surname>Liu</surname><given-names>J.</given-names></name>
        <name><surname>Starck</surname><given-names>J. -L.</given-names></name>
        <name><surname>Osato</surname><given-names>K.</given-names></name>
        <name><surname>Schrabback</surname><given-names>T.</given-names></name>
      </person-group>
      <article-title>Probabilistic mass-mapping with neural score estimation</article-title>
      <source>Astronomy and Astrophysics</source>
      <year iso-8601-date="2023-04">2023</year><month>04</month>
      <volume>672</volume>
      <uri>https://arxiv.org/abs/2201.05561</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361/202243054</pub-id>
      <fpage>A51</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Collett2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Collett</surname><given-names>Thomas E.</given-names></name>
      </person-group>
      <article-title>THE POPULATION OF GALAXY–GALAXY STRONG LENSES IN FORTHCOMING OPTICAL IMAGING SURVEYS</article-title>
      <source>The Astrophysical Journal</source>
      <publisher-name>The American Astronomical Society</publisher-name>
      <year iso-8601-date="2015-09">2015</year><month>09</month>
      <volume>811</volume>
      <issue>1</issue>
      <uri>https://dx.doi.org/10.1088/0004-637X/811/1/20</uri>
      <pub-id pub-id-type="doi">10.1088/0004-637X/811/1/20</pub-id>
      <fpage>20</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Rodney2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rodney</surname><given-names>Steven A.</given-names></name>
        <name><surname>Brammer</surname><given-names>Gabriel B.</given-names></name>
        <name><surname>Pierel</surname><given-names>Justin D. R.</given-names></name>
        <name><surname>Richard</surname><given-names>Johan</given-names></name>
        <name><surname>Toft</surname><given-names>Sune</given-names></name>
        <name><surname>O’Connor</surname><given-names>Kyle F.</given-names></name>
        <name><surname>Akhshik</surname><given-names>Mohammad</given-names></name>
        <name><surname>Whitaker</surname><given-names>Katherine E.</given-names></name>
      </person-group>
      <article-title>A gravitationally lensed supernova with an observable two-decade time delay</article-title>
      <source>Nature Astronomy</source>
      <year iso-8601-date="2021-11">2021</year><month>11</month>
      <volume>5</volume>
      <uri>https://arxiv.org/abs/2106.08935</uri>
      <pub-id pub-id-type="doi">10.1038/s41550-021-01450-9</pub-id>
      <fpage>1118</fpage>
      <lpage>1125</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Welch2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Welch</surname><given-names>Brian</given-names></name>
        <name><surname>Coe</surname><given-names>Dan</given-names></name>
        <name><surname>Zackrisson</surname><given-names>Erik</given-names></name>
        <name><surname>de Mink</surname><given-names>S. E.</given-names></name>
        <name><surname>Ravindranath</surname><given-names>Swara</given-names></name>
        <name><surname>Anderson</surname><given-names>Jay</given-names></name>
        <name><surname>Brammer</surname><given-names>Gabriel</given-names></name>
        <name><surname>Bradley</surname><given-names>Larry</given-names></name>
        <name><surname>Yoon</surname><given-names>Jinmi</given-names></name>
        <name><surname>Kelly</surname><given-names>Patrick</given-names></name>
        <name><surname>Diego</surname><given-names>Jose M.</given-names></name>
        <name><surname>Windhorst</surname><given-names>Rogier</given-names></name>
        <name><surname>Zitrin</surname><given-names>Adi</given-names></name>
        <name><surname>Dimauro</surname><given-names>Paola</given-names></name>
        <name><surname>Jiménez-Teja</surname><given-names>Yolanda</given-names></name>
        <string-name>Abdurro’uf</string-name>
        <name><surname>Nonino</surname><given-names>Mario</given-names></name>
        <name><surname>Acebron</surname><given-names>Ana</given-names></name>
        <name><surname>Andrade-Santos</surname><given-names>Felipe</given-names></name>
        <name><surname>Avila</surname><given-names>Roberto J.</given-names></name>
        <name><surname>Bayliss</surname><given-names>Matthew B.</given-names></name>
        <name><surname>Benı́tez</surname><given-names>Alex</given-names></name>
        <name><surname>Broadhurst</surname><given-names>Tom</given-names></name>
        <name><surname>Bhatawdekar</surname><given-names>Rachana</given-names></name>
        <name><surname>Bradač</surname><given-names>Maruša</given-names></name>
        <name><surname>Caminha</surname><given-names>Gabriel B.</given-names></name>
        <name><surname>Chen</surname><given-names>Wenlei</given-names></name>
        <name><surname>Eldridge</surname><given-names>Jan</given-names></name>
        <name><surname>Farag</surname><given-names>Ebraheem</given-names></name>
        <name><surname>Florian</surname><given-names>Michael</given-names></name>
        <name><surname>Frye</surname><given-names>Brenda</given-names></name>
        <name><surname>Fujimoto</surname><given-names>Seiji</given-names></name>
        <name><surname>Gomez</surname><given-names>Sebastian</given-names></name>
        <name><surname>Henry</surname><given-names>Alaina</given-names></name>
        <name><surname>Hsiao</surname><given-names>Tiger Y. -Y.</given-names></name>
        <name><surname>Hutchison</surname><given-names>Taylor A.</given-names></name>
        <name><surname>James</surname><given-names>Bethan L.</given-names></name>
        <name><surname>Joyce</surname><given-names>Meridith</given-names></name>
        <name><surname>Jung</surname><given-names>Intae</given-names></name>
        <name><surname>Khullar</surname><given-names>Gourav</given-names></name>
        <name><surname>Larson</surname><given-names>Rebecca L.</given-names></name>
        <name><surname>Mahler</surname><given-names>Guillaume</given-names></name>
        <name><surname>Mandelker</surname><given-names>Nir</given-names></name>
        <name><surname>McCandliss</surname><given-names>Stephan</given-names></name>
        <name><surname>Morishita</surname><given-names>Takahiro</given-names></name>
        <name><surname>Newshore</surname><given-names>Rosa</given-names></name>
        <name><surname>Norman</surname><given-names>Colin</given-names></name>
        <name><surname>O’Connor</surname><given-names>Kyle</given-names></name>
        <name><surname>Oesch</surname><given-names>Pascal A.</given-names></name>
        <name><surname>Oguri</surname><given-names>Masamune</given-names></name>
        <name><surname>Ouchi</surname><given-names>Masami</given-names></name>
        <name><surname>Postman</surname><given-names>Marc</given-names></name>
        <name><surname>Rigby</surname><given-names>Jane R.</given-names></name>
        <name><surname>Ryan</surname><given-names>Jr.</given-names><suffix>Russell E.</suffix></name>
        <name><surname>Sharma</surname><given-names>Soniya</given-names></name>
        <name><surname>Sharon</surname><given-names>Keren</given-names></name>
        <name><surname>Strait</surname><given-names>Victoria</given-names></name>
        <name><surname>Strolger</surname><given-names>Louis-Gregory</given-names></name>
        <name><surname>Timmes</surname><given-names>F. X.</given-names></name>
        <name><surname>Toft</surname><given-names>Sune</given-names></name>
        <name><surname>Trenti</surname><given-names>Michele</given-names></name>
        <name><surname>Vanzella</surname><given-names>Eros</given-names></name>
        <name><surname>Vikaeus</surname><given-names>Anton</given-names></name>
      </person-group>
      <article-title>JWST Imaging of Earendel, the Extremely Magnified Star at Redshift z = 6.2</article-title>
      <source>The Astrophysical Journal Letters</source>
      <year iso-8601-date="2022-11">2022</year><month>11</month>
      <volume>940</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/2208.09007</uri>
      <pub-id pub-id-type="doi">10.3847/2041-8213/ac9d39</pub-id>
      <fpage>L1</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
<fn-group>
  <fn id="fn1">
    <label>1</label><p>“Kernlizing” operations by packing multiple
    mathematical operations into a single call to the GPU can both
    reduce the memory load and increase the speed of such calculations.
    This is an avenue for further development for caustics.</p>
  </fn>
</fn-group>
</back>
</article>
