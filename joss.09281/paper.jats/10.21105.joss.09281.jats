<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">9281</article-id>
<article-id pub-id-type="doi">10.21105/joss.09281</article-id>
<title-group>
<article-title>PowerFactory-Tools: A Python Package to Facilitate the
Control of DIgSILENT PowerFactory</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3940-3398</contrib-id>
<name>
<surname>Krahmer</surname>
<given-names>Sebastian</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1190-051X</contrib-id>
<name>
<surname>Rasti</surname>
<given-names>Sasan Jacob</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9425-5324</contrib-id>
<name>
<surname>Fiedler</surname>
<given-names>Laura</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2509-8342</contrib-id>
<name>
<surname>Schmidt</surname>
<given-names>Maximilian</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Institute of Electrical Power Systems and High Voltage
Engineering, TUD Dresden University of Technology, Germany</institution>
<institution-id institution-id-type="ROR">042aqky30</institution-id>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-04-16">
<day>16</day>
<month>4</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>116</issue>
<fpage>9281</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>Electrical Power System</kwd>
<kwd>Power System Data Model</kwd>
<kwd>PowerFactory</kwd>
<kwd>Automation</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><italic>PowerFactory-Tools</italic> is a Python package that
  facilitates the control of PowerFactory, a worldwide used network
  calculation program. The software provides a well-structured and
  type-safe interface for PowerFactory, thereby simplifying the
  development, testing and verification of custom Python scripts. The
  package also includes a network exporter that converts PowerFactory
  data into the open-source <italic>Power System Data Model</italic>
  format. This enables users to access the nodal admittance matrix of
  the network, which is restricted in PowerFactory.
  <italic>PowerFactory-Tools</italic> also provides type hints and
  autocomplete suggestions, safe unit handling, and a temporary unit
  conversion to default values. The package has been utilised in a
  variety of research projects. This software is a valuable tool for
  power system engineers and researchers who require network
  calculations to be automated and streamlined.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p><italic>PowerFactory-Tools</italic> is a power system affiliated
  Python package for the control of the commercial electrical power
  system analysis software PowerFactory
  (<xref alt="DIgSILENT GmbH, 2025" rid="ref-powerfactory" ref-type="bibr">DIgSILENT
  GmbH, 2025</xref>). When it comes to calculations based on use case
  variations or the need for reproducible control actions, PowerFactory
  can be called and controlled via user-defined Python scripts.
  PowerFactory-Tools eases developing, testing and verification by
  providing a well-structured and type-safe Python interface for
  PowerFactory. This interface is established on top of the
  PowerFactory-Python-API, but has undergone a process of refinement and
  augmentation through the incorporation of individually parameterisable
  functions that prove to be of considerable practical benefit. A common
  task in respect to case studies that can be implemented more
  conveniently with <italic>PowerFactory-Tools</italic> is, for example,
  the automated replacement of generators with one’s own templates and
  their parameterisation.</p>
  <p>Furthermore, a main functionality is the network exporter from
  PowerFactory to the open-source <italic>Power System Data
  Model</italic> (PSDM)
  (<xref alt="2023" rid="ref-psdm" ref-type="bibr">2023</xref>). In
  terms of network optimisation, user-defined network reduction or
  stability analysis, users may require an explicitly accessible nodal
  admittance matrix (NAM) of the network. Since access to this is still
  restricted for PowerFactory users, exporting the PowerFactory network
  to a well structured and human readable exchange format is a huge
  benefit. Due to this, users can (a) export to <italic>PSDM</italic>
  Python objects and build the NAM by your own without changing the
  programming language or (b) export to <italic>PSDM</italic>-formatted
  JSON files, then import these files using the programming language of
  your choice and build the NAM. It has to be mentioned, that
  PowerFactory provides a built-in export with DGS, the bidirectional,
  flexible DIgSILENT data exchange format (ascii, xml, csv, odbc). While
  it is intended to support GIS and SCADA connections, the drawback is
  that the DGS export is typeless and not Python native. Due to this, a
  significant effort for parsing may occur.</p>
  <p><italic>PowerFactory-Tools</italic> was used in Krahmer et al.
  (<xref alt="2022" rid="ref-KrahmerU003A2022" ref-type="bibr">2022</xref>),
  Krahmer et al.
  (<xref alt="2023" rid="ref-KrahmerU003A2023" ref-type="bibr">2023</xref>),
  Krahmer et al.
  (<xref alt="2024" rid="ref-KrahmerU003A2024" ref-type="bibr">2024</xref>)
  and Fiedler et al.
  (<xref alt="2025" rid="ref-FiedlerU003A2024" ref-type="bibr">2025</xref>)
  as well as is currently in use in the research projects SysZell,
  ZellSys and digiTechNetz.</p>
</sec>
<sec id="application-benefits">
  <title>Application Benefits</title>
  <p>By implementing a type wrapper for internal PowerFactory element
  types, users receive type hints and autocomplete suggestions to
  increase the safety and productivity. Furthermore,
  <italic>PowerFactory-Tools</italic> guarantee safe unit handling. A
  temporary unit conversion to default values is automatically performed
  to have a project setting independent behavior. The units are reset
  when the interface is closed. During an active connection to
  PowerFactory, the following units apply: power in MVA (resp. MW,
  Mvar), voltage in kV, current in kA and length in km.</p>
  <p>A broad range of application examples is provided in the
  <italic>PowerFactory-Tools</italic> repository
  (<xref alt="2022" rid="ref-pftools" ref-type="bibr">2022</xref>),
  which encourage beginners.</p>
</sec>
<sec id="power-system-data-model">
  <title>Power System Data Model</title>
  <p>As previously stated, the <italic>PSDM</italic> constitutes a
  secondary open-source toolbox that has been developed in conjunction
  with the <italic>PowerFactory-Tools</italic>, but not exclusively for
  them. It utilizes a hierarchical structure/schema to describe unique
  entity relations as well as parameter sets. <italic>PSDM</italic> uses
  the BaseModel class from Pydantic as a technique for defining schema
  classes. The PSDM consists of three parts covering different types of
  information and each part can be stored as a human-readable JSON
  file:</p>
  <list list-type="bullet">
    <list-item>
      <p>Topology: plain network model with nodes, edges and connected
      devices</p>
    </list-item>
    <list-item>
      <p>TopologyCase: information about elements that are disconnected,
      e. g. out-of-service or via open switches</p>
    </list-item>
    <list-item>
      <p>SteadystateCase: operational case specific information.</p>
    </list-item>
  </list>
  <p>A full PSDM-representation of a network can be viewed in the
  example section of the <italic>PowerFactory-Tools</italic> repository
  (<xref alt="2022" rid="ref-pftools" ref-type="bibr">2022</xref>). The
  following code snippet shows how to use the library to export a
  PowerFactory 2025 network to the <italic>PSDM</italic> format.</p>
  <preformat>pip install ieeh-powerfactory-tools</preformat>
  <code language="python">import pathlib
from powerfactory_tools.versions.pf2025 import PowerFactoryExporter
from powerfactory_tools.versions.pf2025.interface import ValidPythonVersion

PF_PATH = pathlib.Path(&quot;C:/Program Files/DIgSILENT&quot;)
PF_SERVICE_PACK = 2 # mandatory
PF_USER_PROFILE = &quot;TODO&quot;  # mandatory, name of the user profile in PF data base
PF_PYTHON_VERSION = ValidPythonVersion.VERSION_3_13
# project name may be also full path &quot;dir_name\project_name&quot;
# (name is choosen related to example PF project in GitHub repository)
PROJECT_NAME = &quot;PowerFactory-Tools&quot;  
# a valid study case name in the choosen PF project
STUDY_CASE_NAME = &quot;Base&quot;  
# directory, the export results will be saved to
EXPORT_PATH = pathlib.Path(&quot;export&quot;) 

with PowerFactoryExporter(
    powerfactory_path=PF_PATH,
    powerfactory_service_pack=PF_SERVICE_PACK,
    powerfactory_user_profile=PF_USER_PROFILE,
    python_version=PF_PYTHON_VERSION,
    project_name=PROJECT_NAME,
    ) as exporter:
        # Option I: Export to PSDM Python objects
        grids = exporter.pfi.independent_grids(calc_relevant=True)
        for grid in grids:
            grid_name = grid.loc_name
            data = exporter.pfi.compile_powerfactory_data(grid)
            meta = exporter.create_meta_data(data=data, case_name=STUDY_CASE_NAME)

            # Create the three PSDM base classes
            topology = exporter.create_topology(meta=meta, data=data)
            topology_case = exporter.create_topology_case(meta=meta, data=data, 
                topology=topology)
            steadystate_case = exporter.create_steadystate_case(meta=meta, data=data, 
                topology=topology)
            # Now, the PSDM objects can be used by the user ...

        # Option II: Export to PSDM-formatted JSON files
        exporter.export(
            export_path = EXPORT_PATH, 
            study_case_names=[STUDY_CASE_NAME],
        )</code>
</sec>
<sec id="software-dependencies">
  <title>Software Dependencies</title>
  <p>The software is written in Python and uses the data validation
  library pydantic
  (<xref alt="2025" rid="ref-pydantic" ref-type="bibr">2025</xref>). In
  respect to the export functionality, the <italic>PSDM</italic>
  (<xref alt="2023" rid="ref-psdm" ref-type="bibr">2023</xref>) is used
  as schema for network entity relations. Ultimately, the responsibility
  falls upon the user to ensure the accurate compilation of software
  versions. Should any reader require assistance with this topic, they
  will find an up-to-date list of compatible software available at the
  repositories readme. For example, the
  <italic>PowerFactory-Tools</italic> version 3.3.0 is related to the
  <italic>PSDM</italic> version 2.3.3 and brings built-in support for
  PowerFactory version 2022, 2024 and 2025.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The tool was developed during work related to the projects STABEEL
  (project no. 442893506), SysZell (funding code 03EI4074D) and
  digiTechNetz (funding code 03EI6075A), first funded by the Deutsche
  Forschungsgemeinschaft (DFG, DOI: 10.13039/501100001659), the latter
  funded by the German Federal Ministry for Economic Affairs and Climate
  Action.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-powerfactory">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>DIgSILENT GmbH</string-name>
      </person-group>
      <article-title>PowerFactory</article-title>
      <year iso-8601-date="2025">2025</year>
      <uri>https://www.digsilent.de/en/powerfactory</uri>
    </element-citation>
  </ref>
  <ref id="ref-pydantic">
    <element-citation>
      <article-title>Pydantic: Data validation using python type hints</article-title>
      <source>GitHub repository</source>
      <publisher-name>GitHub</publisher-name>
      <year iso-8601-date="2025">2025</year>
      <uri>https://github.com/pydantic/pydantic</uri>
    </element-citation>
  </ref>
  <ref id="ref-psdm">
    <element-citation publication-type="webpage">
      <person-group person-group-type="author">
        <string-name>Institute of Electrical Power Systems and High Voltage Engineering - TU Dresden</string-name>
      </person-group>
      <article-title>Power System Data Model - A data model for the description of electrical power systems</article-title>
      <publisher-name>GitHub Repository</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <uri>https://github.com/ieeh-tu-dresden/power-system-data-model</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.7781375</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-pftools">
    <element-citation publication-type="webpage">
      <person-group person-group-type="author">
        <string-name>Institute of Electrical Power Systems and High Voltage Engineering - TU Dresden</string-name>
      </person-group>
      <article-title>PowerFactory-Tools: A Python Package to Facilitate the Control of DIgSILENT PowerFactory</article-title>
      <publisher-name>GitHub Repository</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <uri>https://github.com/ieeh-tu-dresden/powerfactory-tools</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.7074968</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-KrahmerU003A2022">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Krahmer</surname><given-names>Sebastian</given-names></name>
        <name><surname>Ecklebe</surname><given-names>Stefan</given-names></name>
        <name><surname>Schegner</surname><given-names>Peter</given-names></name>
        <name><surname>Röbenack</surname><given-names>Klaus</given-names></name>
      </person-group>
      <article-title>Analysis of the Converter-Driven Stability of Q(V)-Characteristic Control in Distribution Grids</article-title>
      <source>5th international conference on smart energy systems and technologies</source>
      <year iso-8601-date="2022">2022</year>
      <pub-id pub-id-type="doi">10.1109/SEST53650.2022.9898506</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-KrahmerU003A2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Krahmer</surname><given-names>Sebastian</given-names></name>
        <name><surname>Ecklebe</surname><given-names>Stefan</given-names></name>
        <name><surname>Schegner</surname><given-names>Peter</given-names></name>
        <name><surname>Röbenack</surname><given-names>Klaus</given-names></name>
      </person-group>
      <article-title>Zur Notwendigkeit von Stabilitätsbetrachtungen von Umrichterinteraktionen bei der Sicherheitsbewertung in Verteilnetzen</article-title>
      <source>at - Automatisierungstechnik</source>
      <year iso-8601-date="2023">2023</year>
      <volume>71</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1515/auto-2023-0142</pub-id>
      <fpage>1051</fpage>
      <lpage>1064</lpage>
    </element-citation>
  </ref>
  <ref id="ref-KrahmerU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Krahmer</surname><given-names>Sebastian</given-names></name>
        <name><surname>Ecklebe</surname><given-names>Stefan</given-names></name>
        <name><surname>Schegner</surname><given-names>Peter</given-names></name>
        <name><surname>Röbenack</surname><given-names>Klaus</given-names></name>
      </person-group>
      <article-title>Application of Stability Analysis of Q(V)-Characteristic Controls Related to the Converter-Driven Stability in Distribution Networks</article-title>
      <source>IEEE Transactions on Industry Applications</source>
      <year iso-8601-date="2024">2024</year>
      <volume>60</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1109/TIA.2024.3360023</pub-id>
      <fpage>5002</fpage>
      <lpage>5011</lpage>
    </element-citation>
  </ref>
  <ref id="ref-FiedlerU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fiedler</surname><given-names>Laura</given-names></name>
        <name><surname>Schmidt</surname><given-names>Maximilian</given-names></name>
        <name><surname>Schegner</surname><given-names>Peter</given-names></name>
        <name><surname>Reichardt</surname><given-names>Sven</given-names></name>
        <name><surname>Weisenstein</surname><given-names>Marco</given-names></name>
        <name><surname>Schmidt</surname><given-names>Uwe</given-names></name>
        <name><surname>Wagner</surname><given-names>Thomas</given-names></name>
        <name><surname>Hänchen</surname><given-names>Holger</given-names></name>
        <name><surname>Braun</surname><given-names>Lea</given-names></name>
        <name><surname>Menke</surname><given-names>Lukas</given-names></name>
      </person-group>
      <article-title>Digitechnetz – a smart grid platform enabling an active operation of low voltage distribution grids</article-title>
      <source>IET Conference Proceedings</source>
      <year iso-8601-date="2025">2025</year>
      <volume>2024</volume>
      <pub-id pub-id-type="doi">10.1049/icp.2024.1991</pub-id>
      <fpage>904</fpage>
      <lpage>908</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
