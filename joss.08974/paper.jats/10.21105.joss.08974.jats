<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8974</article-id>
<article-id pub-id-type="doi">10.21105/joss.08974</article-id>
<title-group>
<article-title>Spectralmatch: relative radiometric normalization toolkit
for raster mosaics and time series</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0009-5520-1911</contrib-id>
<name>
<surname>Lindiwe</surname>
<given-names>Kanoa</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5941-4601</contrib-id>
<name>
<surname>Percival</surname>
<given-names>Joseph Emile Honour</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4210-3281</contrib-id>
<name>
<surname>Perroy</surname>
<given-names>Ryan</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Spatial Data Analysis &amp; Visualization Research Lab,
University of Hawaii at Hilo, United States</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Dept of Geography &amp; Environmental Science, University
of Hawaii at Hilo, United States</institution>
<institution-id institution-id-type="ROR">02mp2av58</institution-id>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-05-08">
<day>8</day>
<month>5</month>
<year>2025</year>
</pub-date>
<volume>11</volume>
<issue>117</issue>
<fpage>8974</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2026</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Relative radiometric normalization</kwd>
<kwd>Python</kwd>
<kwd>Time series</kwd>
<kwd>Mosaic</kwd>
<kwd>QGIS plugin</kwd>
<kwd>Cloud masking</kwd>
<kwd>Pseudo invariant features</kwd>
<kwd>Remote sensing</kwd>
<kwd>Histogram matching</kwd>
<kwd>Seamline</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Spectralmatch provides algorithms to perform relative radiometric
  normalization (RRN) to enhance spectral consistency across raster
  mosaics and time series. It is built for geoscientific use, with a
  sensor- and unit-agnostic design, optimized for automation and
  efficiency on arbitrarily many images and bands, and works well with
  Very High Resolution Imagery (VHRI) as it does not require pixel
  co-registration. Its current matching algorithms are inspired by Yu et
  al.
  (<xref alt="2017" rid="ref-YuU003A2017" ref-type="bibr">2017</xref>),
  which include global regression and local block adjustment which
  minimize inter-image variability without relying on ancillary data.
  The impact of these functions on spectral consistency is illustrated
  in <xref alt="[fig:1]" rid="figU003A1">[fig:1]</xref>. The software
  supports cloud and vegetation masking, pseudo invariant feature (PIF)
  based exclusion, seamline network generation, raster merging, and
  plotting statistics. The toolkit is available as an open-source Python
  library, command line interface, and QGIS plugin.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Remote sensing relies on mosaics to broaden spatial coverage, and
  on time series to extend temporal coverage. However, both are affected
  by inter-image spectral variability, caused by differences in the
  atmosphere, illumination, surface condition, acquisition geometry, and
  other complications
  (<xref alt="Theiler et al., 2019" rid="ref-TheilerU003A2019" ref-type="bibr">Theiler
  et al., 2019</xref>). These factors introduce inconsistencies, reduce
  analytical accuracy, and complicate the detection of actual
  environmental changes. To address these issues, researchers have
  explored two main correction approaches in the literature: absolute
  radiometric correction and RRN, or a combination of both
  (<xref alt="Hu et al., 2011" rid="ref-HuU003A2011" ref-type="bibr">Hu
  et al., 2011</xref>). The absolute approach corrects for the
  aforementioned inaccuracies with algorithms involving atmospheric
  correction and bidirectional reflectance distribution functions
  (<xref alt="Shen et al., 2025" rid="ref-ShenU003A2025" ref-type="bibr">Shen
  et al., 2025</xref>), and gains accuracy from in-situ measurements,
  which may not exist or be difficult to obtain for specific images
  (<xref alt="Canty et al., 2004" rid="ref-CantyU003A2004" ref-type="bibr">Canty
  et al., 2004</xref>). Conversely, the relative approach applies
  algorithms to minimize apparent spectral differences between images,
  matching them for consistent analysis, rather than determining true
  spectral values or relying on ancillary data.</p>
  <p>Researchers have examined various algorithms for performing RRN
  (<xref alt="Vorovencii &amp; M., 2014" rid="ref-VorovenciiU003A2014" ref-type="bibr">Vorovencii
  &amp; M., 2014</xref>), with model selection and the identification of
  PIFs recognized as among the most critical and challenging aspects
  (<xref alt="Hessel et al., 2020" rid="ref-HesselU003A2020" ref-type="bibr">Hessel
  et al., 2020</xref>). Most researched RRN methods are not integrated
  into software packages, which leaves subsequent researchers either
  spending significant time implementing their own versions of the
  algorithms or relying on the limited available tools. There are
  commercial software programs that implement RRN which include
  <ext-link ext-link-type="uri" xlink:href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/data-management/color-balance-mosaic-dataset.htm">ArcGIS
  Pro</ext-link> (dodging, global fit, histogram, and standard
  deviation),
  <ext-link ext-link-type="uri" xlink:href="https://www.nv5geospatialsoftware.com/docs/MosaicSeamless.html">ENVI</ext-link>
  (histogram matching),
  <ext-link ext-link-type="uri" xlink:href="https://supportsi.hexagon.com/s/article/Create-a-Mosaic-using-ERDAS-IMAGINE-MosaicPro?language=en_US">ERDAS
  IMAGINE Mosaic Pro</ext-link> (illumination equalizing, dodging, color
  balancing, and histogram matching) and others. In addition, open
  source solutions include QGIS
  (<ext-link ext-link-type="uri" xlink:href="https://github.com/Gustavoohs/HistMatch">histogram
  matching</ext-link> and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/SMByC/ArrNorm">Iteratively
  Reweighted Multivariate Alteration Detection (IR-MAD)</ext-link>),
  MATLAB scripts (pixel similarity grouping by Moghimi et al.
  (<xref alt="2024" rid="ref-MoghimiU003A2024" ref-type="bibr">2024</xref>)),
  Python scripts (multi-sensor normalization by Hessel et al.
  (<xref alt="2020" rid="ref-HesselU003A2020" ref-type="bibr">2020</xref>))
  and the R ‘landsat’ library (histogram matching, pixel-wise linear
  regression, K-T ratio, and urban materials ratio) by Goslee
  (<xref alt="2011" rid="ref-GosleeU003A2011" ref-type="bibr">2011</xref>).
  While existing solutions cover many use cases, there is not an open
  source, scalable library to match non-coregistered VHRI using the
  mean-standard deviation method which this library specifically
  addresses. In addition, this library provides an extensible structure
  to add new RRN methods to meet researchers’ varying needs and dataset
  requirements.</p>
</sec>
<sec id="implemented-rrn-methods">
  <title>Implemented RRN Methods</title>
  <p>The current matching algorithm uses a two-step approach involving
  global regression and local block adjustment following the methods of
  Yu et al.
  (<xref alt="2017" rid="ref-YuU003A2017" ref-type="bibr">2017</xref>).
  The approach is suitable to match imagery from the same sensor or from
  multiple sensors with comparable wavelengths and resolution—for
  example, between satellites (Sentinel-PlanetScope) or between drones
  (Zenmuse P1-Mavic 3 Multispectral). The global regression algorithm
  adjusts brightness and contrast across overlapping images to reduce
  spectral differences. It first detects overlapping image pairs and
  computes per-band statistics (mean and standard deviation) within
  those regions. Using these statistics, a least-squares regression
  system is constructed to solve for per-image, per-band scale and
  offset parameters that minimize radiometric differences in overlapping
  areas. This approach aims to minimize brightness and contrast
  differences across images while preserving global consistency and
  aligning the spectral profiles of images to a central tendency,
  specific image, or set of images via custom-weighted mean and standard
  deviation constraints.</p>
  <p>The local block adjustment algorithm applies block-wise radiometric
  correction to individual satellite images based on local differences
  from a reference mosaic. The method divides the combined extent of all
  input images into spatial blocks and calculates local mean statistics
  for each block. Each image is then locally adjusted using interpolated
  adaptive gamma normalization to align with the global reference
  mosaic. This allows radiometric consistency across spatially
  heterogeneous scenes on a block scale. Both global and local
  algorithms support nodata-aware processing for images of irregular
  shapes and internal gaps and vector PIF masking applied at the
  matching solution stage. For large datasets, the library supports
  cloud optimized geotiff outputs, saving and loading of intermediate
  steps, and efficient windowing and parallelization. For example, on a
  computer with 16GB of memory and 10 M1 cores, multiprocessing
  increased processing speed by up to 43%, with larger images showing
  larger increases.</p>
  <p>Various helper functions support the creation of cloud masks,
  non-vegetation PIFs, generating seamline networks, merging images, and
  basic figures. Cloud masking utilities enable the generation of binary
  masks using
  <ext-link ext-link-type="uri" xlink:href="https://github.com/DPIRD-DMA/OmniCloudMask">OmniCloudMask</ext-link>
  by Wright et al.
  (<xref alt="2025" rid="ref-WrightU003A2025" ref-type="bibr">2025</xref>),
  followed by post-processing and vectorization. Vegetation masking
  utilities use NDVI-based thresholds, followed by post-processing and
  vectorization. The created masks can be used to mask input images or
  withhold pixels from analysis. Seamline generation utilities use
  Voronoi-based centerlines, following the methodology of Yuan et al.
  (<xref alt="2023" rid="ref-YuanU003A2023" ref-type="bibr">2023</xref>).
  Statistical utilities can generate basic figures comparing image
  spectral profiles before and after matching to evaluate radiometric
  changes. Raster merging utilities combine the final images into a
  seamless mosaic.</p>
</sec>
<sec id="figures">
  <title>Figures</title>
  <fig>
    <caption><p>Comparison of three WorldView-3 images from Puʻu
    Waʻawaʻa, Hawaiʻi before and after processing with global regression
    and local block adjustment using spectralmatch. The top left shows
    images before processing, the middle left shows images after
    processing, the bottom left shows images mosaicked before and after
    processing, and lastly, the right shows the averaged spectral
    profiles from the overlapping area of all images.
    <styled-content id="figU003A1"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="https://raw.githubusercontent.com/spectralmatch/spectralmatch/main/images/matching_histogram.png" />
  </fig>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work was primarily funded by the National Science Foundation
  EPSCoR grant 2149133, Change Hawaiʻi: Harnessing the Data Revolution
  for Island Resilience. The University of Hawaii at Hilo Spatial Data
  Analysis and Visualization Lab (SDAV) provided computational and
  laboratory resources.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-CantyU003A2004">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Canty</surname><given-names>M. J.</given-names></name>
        <name><surname>Nielsen</surname><given-names>A. A.</given-names></name>
        <name><surname>Schmidt</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>Automatic radiometric normalization of multitemporal satellite imagery</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2004">2004</year>
      <volume>91</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1016/j.rse.2003.10.024</pub-id>
      <fpage>441</fpage>
      <lpage>451</lpage>
    </element-citation>
  </ref>
  <ref id="ref-HesselU003A2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hessel</surname><given-names>C.</given-names></name>
        <name><surname>Grompone von Gioi</surname><given-names>R.</given-names></name>
        <name><surname>Morel</surname><given-names>J. M.</given-names></name>
        <name><surname>Facciolo</surname><given-names>G.</given-names></name>
        <name><surname>Arias</surname><given-names>P.</given-names></name>
        <name><surname>Franchis</surname><given-names>C. de</given-names></name>
      </person-group>
      <article-title>Relative radiometric normalization using several automatically chosen reference images for multi-sensor, multi-temporal series</article-title>
      <source>ISPRS Annals of the Photogrammetry, Remote Sensing and Spatial Information Sciences</source>
      <year iso-8601-date="2020">2020</year>
      <volume>V-2–2020</volume>
      <pub-id pub-id-type="doi">10.5194/isprs-annals-V-2-2020-845-2020</pub-id>
      <fpage>845</fpage>
      <lpage>852</lpage>
    </element-citation>
  </ref>
  <ref id="ref-HuU003A2011">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Hu</surname><given-names>Y.</given-names></name>
        <name><surname>Liu</surname><given-names>L.</given-names></name>
        <name><surname>Liu</surname><given-names>L.</given-names></name>
        <name><surname>Jiao</surname><given-names>Q.</given-names></name>
      </person-group>
      <article-title>Comparison of absolute and relative radiometric normalization use landsat time series images</article-title>
      <source>MIPPR 2011: Remote sensing image processing, geographic information systems, and other applications</source>
      <year iso-8601-date="2011">2011</year>
      <volume>8006</volume>
      <pub-id pub-id-type="doi">10.1117/12.902076</pub-id>
      <fpage>283</fpage>
      <lpage>290</lpage>
    </element-citation>
  </ref>
  <ref id="ref-MoghimiU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Moghimi</surname><given-names>A.</given-names></name>
        <name><surname>Sadeghi</surname><given-names>V.</given-names></name>
        <name><surname>Mohsenifar</surname><given-names>A.</given-names></name>
        <name><surname>Celik</surname><given-names>T.</given-names></name>
        <name><surname>Mohammadzadeh</surname><given-names>A.</given-names></name>
      </person-group>
      <article-title>LIRRN: Location-independent relative radiometric normalization of bitemporal remote-sensing images</article-title>
      <source>Sensors</source>
      <year iso-8601-date="2024">2024</year>
      <volume>24</volume>
      <issue>7</issue>
      <pub-id pub-id-type="doi">10.3390/s24072272</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-ShenU003A2025">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Shen</surname><given-names>A.</given-names></name>
        <name><surname>Shao</surname><given-names>J.</given-names></name>
        <name><surname>Qi</surname><given-names>X.</given-names></name>
        <name><surname>Zhu</surname><given-names>Z.</given-names></name>
        <name><surname>Dai</surname><given-names>Y.</given-names></name>
        <name><surname>Zeng</surname><given-names>Q.</given-names></name>
      </person-group>
      <article-title>BRDF correction in landsat directional reflectance data by combining optimal BRDF archetype with spectral characteristics</article-title>
      <source>IEEE Journal of Selected Topics in Applied Earth Observations and Remote Sensing</source>
      <year iso-8601-date="2025">2025</year>
      <volume>18</volume>
      <pub-id pub-id-type="doi">10.1109/JSTARS.2025.3586463</pub-id>
      <fpage>17592</fpage>
      <lpage>17609</lpage>
    </element-citation>
  </ref>
  <ref id="ref-TheilerU003A2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Theiler</surname><given-names>J.</given-names></name>
        <name><surname>Ziemann</surname><given-names>A.</given-names></name>
        <name><surname>Matteoli</surname><given-names>S.</given-names></name>
        <name><surname>Diani</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>Spectral variability of remotely sensed target materials: Causes, models, and strategies for mitigation and robust exploitation</article-title>
      <source>IEEE Geoscience and Remote Sensing Magazine</source>
      <year iso-8601-date="2019">2019</year>
      <volume>7</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1109/MGRS.2019.2890997</pub-id>
      <fpage>8</fpage>
      <lpage>30</lpage>
    </element-citation>
  </ref>
  <ref id="ref-VorovenciiU003A2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vorovencii</surname><given-names>I.</given-names></name>
        <name><surname>M.</surname><given-names>D. M.</given-names></name>
      </person-group>
      <article-title>Relative radiometric normalization methods: Overview and an application to landsat images</article-title>
      <source>Journal of Geodesy and Cadastre, RevCAD</source>
      <year iso-8601-date="2014">2014</year>
      <volume>17</volume>
      <fpage>193</fpage>
      <lpage>200</lpage>
    </element-citation>
  </ref>
  <ref id="ref-WrightU003A2025">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wright</surname><given-names>N.</given-names></name>
        <name><surname>Duncan</surname><given-names>J. M. A.</given-names></name>
        <name><surname>Callow</surname><given-names>J. N.</given-names></name>
        <name><surname>Thompson</surname><given-names>S. E.</given-names></name>
        <name><surname>George</surname><given-names>R. J.</given-names></name>
      </person-group>
      <article-title>Training sensor-agnostic deep learning models for remote sensing: Achieving state-of-the-art cloud and cloud shadow identification with OmniCloudMask</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2025">2025</year>
      <volume>322</volume>
      <pub-id pub-id-type="doi">10.1016/j.rse.2025.114694</pub-id>
      <fpage>114694</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-YuU003A2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yu</surname><given-names>L.</given-names></name>
        <name><surname>Zhang</surname><given-names>Y.</given-names></name>
        <name><surname>Sun</surname><given-names>M.</given-names></name>
        <name><surname>Zhou</surname><given-names>X.</given-names></name>
        <name><surname>Liu</surname><given-names>C.</given-names></name>
      </person-group>
      <article-title>An auto-adapting global-to-local color balancing method for optical imagery mosaic</article-title>
      <source>ISPRS Journal of Photogrammetry and Remote Sensing</source>
      <year iso-8601-date="2017">2017</year>
      <volume>132</volume>
      <pub-id pub-id-type="doi">10.1016/j.isprsjprs.2017.08.002</pub-id>
      <fpage>1</fpage>
      <lpage>19</lpage>
    </element-citation>
  </ref>
  <ref id="ref-YuanU003A2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yuan</surname><given-names>X.</given-names></name>
        <name><surname>Cai</surname><given-names>Y.</given-names></name>
        <name><surname>Yuan</surname><given-names>W.</given-names></name>
      </person-group>
      <article-title>Voronoi centerline-based seamline network generation method</article-title>
      <source>Remote Sensing</source>
      <year iso-8601-date="2023">2023</year>
      <volume>15</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.3390/rs15040917</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-GosleeU003A2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Goslee</surname><given-names>Sarah C.</given-names></name>
      </person-group>
      <article-title>Analyzing remote sensing data in R: The landsat package</article-title>
      <source>Journal of Statistical Software</source>
      <year iso-8601-date="2011">2011</year>
      <volume>43</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.18637/jss.v043.i04</pub-id>
      <fpage>1</fpage>
      <lpage>25</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
