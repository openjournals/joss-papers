<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6322</article-id>
<article-id pub-id-type="doi">10.21105/joss.06322</article-id>
<title-group>
<article-title>gsMAMS: an R package for Designing Multi-Arm Multi-Stage
Clinical Trials</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1605-7207</contrib-id>
<name>
<surname>Patni</surname>
<given-names>Tushar</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7046-4316</contrib-id>
<name>
<surname>Li</surname>
<given-names>Yimei</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3519-5894</contrib-id>
<name>
<surname>Wu</surname>
<given-names>Jianrong</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>St. Jude Children’s Research Hospital, Memphis, TN, United
States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>University of New Mexico Comprehensive Cancer Center,
Albuquerque, NM, United States of America</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-01-09">
<day>9</day>
<month>1</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>97</issue>
<fpage>6322</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>Clinical trial</kwd>
<kwd>Stopping boundaries</kwd>
<kwd>Operating Characteristics</kwd>
<kwd>Computational time</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>In the field of clinical trial design, a multi-arm trial allows
  simultaneous comparison of multiple experimental treatments with a
  common control and provides a substantial efficiency advantage
  compared to conventional randomized controlled trials. A multi-stage
  trial allows multiple interim looks at the trial outcome so that
  ineffective arms can be stopped early. In the current R ecosystem,
  <monospace>MAMS</monospace> Jaki et al.
  (<xref alt="2019" rid="ref-Jaki2019" ref-type="bibr">2019</xref>) is
  one of the few packages that can handle multiple stages, multiple
  treatment arms, and different types of endpoints, but the
  computational effort of obtaining sample size and sequential stopping
  boundaries is very high when the number of stages exceeds 3. More
  importantly, their method may lead to an under powered study when the
  endpoint is time-to-event data. Therefore, we introduce the R package
  <monospace>gsMAMS</monospace> (group sequential multi-arm multi-stage
  (MAMS)) for designing MAMS trials with continuous, ordinal, and
  survival outcomes, which is computationally very efficient even for a
  number of stages greater than 3. We also discuss the applications of
  the package. The <monospace>gsMAMS</monospace> package facilitates the
  design and planning of multi-arm clinical trials, which simultaneously
  compare multiple experimental treatments with a common control group.
  It is intended to be used by clinical researchers and statisticians so
  that they can determine appropriate sample sizes and stopping criteria
  for these trials.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Traditional two-arm randomized controlled trials are not an optimal
  choice when multiple experimental arms are available for testing
  efficacy (Parmar et al.
  (<xref alt="2014" rid="ref-PARMAR2014283" ref-type="bibr">2014</xref>)).
  In such situations, a multiple-arm trial should be preferred, which
  allows simultaneous comparison of multiple experimental arms with a
  common control and provides a substantial efficiency advantage. In
  multi-arm trials, several arms are monitored in a group sequential
  fashion, with ineffective arms being dropped out of the study.
  Therefore, multi-arm trials offer a more efficient, cost-effective,
  and patient-centered approach to clinical research, with the potential
  to identify superior treatments more reliably than traditional two-arm
  trials (Parmar et al.
  (<xref alt="2014" rid="ref-PARMAR2014283" ref-type="bibr">2014</xref>)).</p>
  <p>Some packages that are available in R (e.g.,
  <monospace>adaptTest</monospace> Vandemeulebroecke
  (<xref alt="2022" rid="ref-Vandemeulebroecke2022" ref-type="bibr">2022</xref>),
  <monospace>asd</monospace> Hack et al.
  (<xref alt="2022" rid="ref-Hack2022" ref-type="bibr">2022</xref>), and
  <monospace>AGSDEST</monospace> Parsons et al.
  (<xref alt="2011" rid="ref-Parsons2011" ref-type="bibr">2011</xref>))
  have limitations either in the number of treatment arms that can be
  incorporated in the package, the number of interim analyses that can
  be implemented in the package, or the different kinds of outcomes that
  the package can handle, but the <monospace>MAMS</monospace> package
  works well for both multiple treatment arms and multiple stages. It
  also works for continuous, ordinal, and survival outcomes. However,
  the computational effort of obtaining stopping boundaries is very high
  when the number of stages exceeds 3. The long computational time is
  the major drawback of using the <monospace>MAMS</monospace> package,
  and as a result, the process of generating design parameters and
  evaluating potential modifications can be time-intensive, sometimes
  taking several hours. This lengthy computation time becomes
  problematic when researchers or clinicians need to iteratively tweak
  design parameters and promptly assess the resulting changes in the
  trial design.</p>
  <p>This paper introduces the R package <monospace>gsMAMS</monospace>
  available at https://cran.r-project.org/web/packages/gsMAMS/, which
  provides functions to obtain sample size, and efficacy and futility
  boundaries for multiple stages and multiple experimental arms. It also
  provides functions that generate operating characteristics for
  designing trials with continuous, ordinal, and survival outcomes. It
  is computationally very fast compared to the
  <monospace>MAMS</monospace> package, even for a number of stages
  greater than 3.</p>
  <p>This package will serve well for clinicians, researchers, and
  statisticians who are involved in designing phase-II clinical trials
  with multiple treatment arms because it is easy to use, provides
  comprehensive information regarding the trial characteristics, and
  provides a substantial efficiency advantage compared to traditional
  randomized controlled trials.</p>
</sec>
<sec id="computational-aspects">
  <title>Computational Aspects</title>
  <p>The computational complexity of this package is very low because
  our proposed method is based on the sequential conditional probability
  ratio test (SCPRT) procedure, which provides analytical solutions for
  both futility and efficacy boundaries for an arbitrary number of
  stages and arms. Thus, it avoids complicated computational efforts in
  obtaining stopping boundaries (Wu et al.
  (<xref alt="2023" rid="ref-Li2023" ref-type="bibr">2023</xref>)). The
  family-wise error rate (FWER) is controlled by Dunnett correction,
  which entails finding the root of an integral of a multivariate normal
  distribution. The multivariate normal densities are evaluated using
  the package <monospace>mvtnorm</monospace> (Genz &amp; Bretz
  (<xref alt="2009" rid="ref-Genz2009" ref-type="bibr">2009</xref>)).
  The package is efficient for any number of treatment arms and stages,
  but it has a limitation that it is only configured for 10 stages. In
  practice, a study rarely needs to have more than 10 interim looks
  planned. To give an example, the computational time of the
  <monospace>MAMS</monospace> package to obtain stopping boundaries and
  sample size for a multi-arm trial with continuous outcome, four
  experimental arms, and three stages is approximately 7 minutes, and
  for four stages, it is approximately 4.5 hours. But for the
  <monospace>gsMAMS</monospace> package with the same trial
  configuration, the computational time to obtain stopping boundaries
  and sample size for three stages and four stages design is
  approximately 0.06 seconds for both cases. This is approximately
  7000-27000 times faster compared to the <monospace>MAMS</monospace>
  package.</p>
  <p>The operating characteristics for continuous and ordinal outcomes
  require less computational effort than the survival outcomes. The
  computational burden of sample size and sequential conditional
  probability ratio test (SCPRT) boundary calculation for continuous,
  ordinal, and survival outcomes is minimal because there are only two
  critical components of the algorithm, which are the roots of FWER and
  power, i.e., critical value and sample size.</p>
  <p>The below code shows an example demonstration about the
  computational efficiency of our package, where we are designing a
  four-stage trial for four treatment arms, and we have used the same
  equivalent parameters for both designs.</p>
  <code language="r script">##MAMS design
system.time(mams(K = 4, 
                 J = 4, 
                 p = NULL, 
                 p0 = NULL, 
                 delta = 0.545, 
                 delta0 = 0.178, 
                 sd = 1, 
                 r = 1:4, 
                 r0 = 1:4, 
                 alpha = 0.05, 
                 power = 0.9, 
                 ushape = &quot;obf&quot;, 
                 lfix = 0))
#   user system  elapsed
#5220.67   5.84  8860.42

##gsMAMS design
system.time(design_cont(delta0 = 0.178, 
                        delta1 = 0.545, 
                        alpha = 0.05, 
                        beta = 0.1, 
                        k = 4, 
                        frac = c(1:4 / 4)))
#  user  system elapsed
#  0.07    0.00    0.06
  </code>
  <p>Based on the results, the elapsed time is very high for the
  <monospace>MAMS</monospace> package.</p>
</sec>
<sec id="application">
  <title>Application</title>
  <p>In this section, we will demonstrate the use of
  <monospace>gsMAMS</monospace> package and provide a separate example
  for each type of outcome.</p>
  <sec id="continuous-outcome">
    <title>Continuous outcome</title>
    <p>For the continuous outcome, we will consider the TAILoR trial
    (Pushpakom et al.
    (<xref alt="2015" rid="ref-pushpakom2015" ref-type="bibr">2015</xref>)),
    which is a phase II trial, and it compares three doses of
    telmisartan (20, 40, 80mg) with no intervention (control) for the
    reduction of insulin resistance in human immunodeficiency
    virus-positive patients receiving combination antiretroviral
    therapy. The primary outcome measure is a reduction in the mean
    homeostasis model assessment of insulin resistance (HOMA-IR) score
    at 24 weeks. The standardized desirable and minimal effect sizes for
    efficacy are set as <inline-formula><alternatives>
    <tex-math><![CDATA[\delta^{(1)}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    = 0.545 for the 80mg group and <inline-formula><alternatives>
    <tex-math><![CDATA[\delta^{(0)}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>δ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    = 0.178 for the 20 and 40 mg groups, respectively, for the trial
    design.</p>
    <p>The sample size calculation is based on a one-sided type I error
    of 5% and a power of 90%. Based on the trial characteristics, we
    will design the trial for a two-stage design.</p>
    <p>The design parameters of the trial can be calculated using the
    <monospace>design_cont()</monospace> function, and the arguments in
    the function correspond to the standardized effect size in the
    ineffective arm (<monospace>delta0</monospace>) and effective arm
    (<monospace>delta1</monospace>), type I error
    (<monospace>alpha</monospace>), type II error
    (<monospace>beta</monospace>), total number of treatment arms
    (<monospace>k</monospace>), and the information time (0.5, 1) is
    denoted by the (<monospace>frac</monospace>) argument in the
    function.</p>
    <code language="r script">#Installing the package from CRAN
install.packages(&quot;gsMAMS&quot;)
#Loading the library
library(gsMAMS)</code>
    <code language="r script">set.seed(1234)
design_cont(delta0 = 0.178, 
            delta1 = 0.545, 
            alpha = 0.05, 
            beta = 0.1, 
            k = 3, 
            frac = c(0.5, 1))

## $`Sample size`
##                                            Stage 1 Stage 2
## Cumulative sample size for treatment group      40      79
## Cumulative sample size for control group        40      79
## 
## $`Maximum total sample size for the trial`
## [1] 316
## 
## $`Boundary values`
##             Stage 1 Stage 2
## Lower bound   0.006   2.062
## Upper bound   2.910   2.062
    </code>
    <p>The design output shows the cumulative sample size for the
    treatment and control groups at each stage. The SCPRT lower and
    upper boundaries are (0.006, 2.062) and (2.91, 2.062), respectively.
    Based on the design parameters, the first interim analysis can be
    conducted after the enrollment of 40 patients in the control arm. If
    the test statistic <inline-formula><alternatives>
    <tex-math><![CDATA[Z_{k,l} < 0.006]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0.006</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    the <inline-formula><alternatives>
    <tex-math><![CDATA[k_{th}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
    arm is rejected for futility at the <inline-formula><alternatives>
    <tex-math><![CDATA[1^{st}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    stage, and the trial continues with the remaining treatment arms and
    the control. If the test statistic <inline-formula><alternatives>
    <tex-math><![CDATA[0.006 \le Z_{k,l} \le 2.91]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>0.006</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>2.91</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    for <inline-formula><alternatives>
    <tex-math><![CDATA[k = 1, 2, 3]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    then the trial continues to the next stage, and 39 patients are
    further enrolled per arm. If <inline-formula><alternatives>
    <tex-math><![CDATA[Z_{k,1} > 2.91]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>2.91</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    for some <inline-formula><alternatives>
    <tex-math><![CDATA[k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>,
    the trial is terminated, and the arm with the maximum value of
    <inline-formula><alternatives>
    <tex-math><![CDATA[Z_{k,1}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives>
    <tex-math><![CDATA[k = 1, 2, 3]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    would be recommended for further study.</p>
    <sec id="for-fwer-and-stagewise-fwer">
      <title>For FWER and Stagewise FWER:</title>
      <p>The operating characteristics of the trial can be generated
      using the <monospace>op_power_cont()</monospace> and
      <monospace>op_fwer_cont()</monospace> functions for power under
      the alternative hypothesis and FWER under the global null
      hypothesis, respectively. Most of the arguments in the functions
      are similar to the <monospace>design_cont()</monospace> function,
      with the exception of the number of simulations
      (<monospace>nsim</monospace>) and the seed number
      (<monospace>seed</monospace>).</p>
      <code language="r script">op_fwer_cont(alpha = 0.05, 
             beta = 0.1, 
             p = 3, 
             frac = c(0.5, 1), 
             delta0 = 0.178, 
             delta1 = 0.545, 
             nsim = 10000, 
             seed = 10)

## $FWER
## [1] 0.05
## 
## $`Stagewise FWER`
##  look1  look2 
## 0.0050 0.0466 
## 
## $`Stopping probability under null`
##  look1  look2 
## 0.2599 0.7401 
## 
## $`Probability of futility under null`
##  look1  look2 
## 0.2549 0.6949 
## 
## $`Average sample size used per arm under null`
## [1] 61.645
      </code>
      <p>Based on the simulation results, the type I error at the first
      interim analysis is 0.5%, and at the second interim analysis, it
      is approximately 4.6%. Therefore, the overall type I error of the
      trial is close to 5%. The sample size required for the trial was
      79 patients per arm, but the trial used approximately an average
      of 62 subjects per arm. The stopping probability (probability of
      stopping the trial either due to futility or efficacy) should add
      up to 1, which is the case here. Since this is under the null
      configuration, the probability of futility (probability of
      stopping the trial when all the treatment arms become futile in
      the trial) should be approximately 95%, and it holds true in this
      case.</p>
    </sec>
    <sec id="for-power-and-stagewise-power">
      <title>For Power and Stagewise Power:</title>
      <code language="r script">op_power_cont(alpha = 0.05, 
              beta = 0.1, 
              p = 3, 
              frac = c(0.5, 1), 
              delta0 = 0.178, 
              delta1 = 0.545, 
              nsim = 10000, 
              seed = 10)

## $Power
## [1] 0.893
## 
## $`Stagewise Power`
##  look1  look2 
## 0.3126 0.5804 
## 
## $`Stopping probability under alternative`
##  look1  look2 
## 0.3258 0.6742 
## 
## $`Probability of futility under alternative`
##  look1  look2 
## 0.0035 0.0821 
## 
## $`Average sample size used per arm under alternative`
## [1] 62.652
      </code>
      <p>Based on the simulation results, the probability of success at
      the first stage is 31.26% and at the second stage is approximately
      58.04%. Therefore, the overall power is approximately 90%. The
      sample size required for the trial was 79 patients per arm, but
      the trial used approximately an average of 62 subjects per arm.
      The stopping probability should add up to 1, which is the case
      here, and under the alternate configuration, the probability of
      futility is approximately 8.5%, which is less than 10% type II
      error. The reason is that the type II error comes from both
      failing to find any efficacious arm (futility) and finding the
      less efficacious arm as the most efficacious arm. The latter part
      was not included when the probability of futility was
      calculated.</p>
    </sec>
  </sec>
  <sec id="ordinal-outcome">
    <title>Ordinal Outcome</title>
    <p>For the ordinal outcome, we will consider the ASCLEPIOS trial
    (Whitehead
    (<xref alt="1993" rid="ref-John1993" ref-type="bibr">1993</xref>)),
    a phase II trial for patients with stroke. The primary outcome
    response is the patient’s Barthel index assessed 90 days after
    randomization. This is an ordered categorical score ranging from 0
    (vegetative state) to 100 (complete recovery) in steps of 5, and
    relates to the activities of daily living that the patient is able
    to undertake. Following the ASCLEPIOS study, we group the outcome
    categories of the score into six larger categories. We will consider
    the treatment worthwhile if the odds ratio between the effective and
    control arms is 3.06, and we set the null odds ratio to be 1.32,
    which is the odds ratio between the ineffective and control
    arms.</p>
    <p>The sample size calculation is based on a one-sided family-wise
    error rate (FWER) of 5% and a power of 90%. Based on the trial
    characteristics, we will design the trial for a three-stage design.
    The design parameters for a five-arm (k = 4) trial can be calculated
    using the <monospace>design_ord()</monospace> function, and the
    arguments in the function correspond to the probability of outcomes
    in the control group (<monospace>prob</monospace>), the odds ratio
    of the ineffective treatment group vs. control
    (<monospace>or0</monospace>), the odds ratio of the effective
    treatment group vs. control (<monospace>or</monospace>), and the
    remaining arguments are similar to the
    <monospace>design_cont()</monospace> function for the continuous
    outcome.</p>
    <code language="r script">design_ord(prob = c(0.075, 0.182, 0.319, 0.243, 0.015, 0.166), 
           or = 3.06, 
           or0 = 1.32, 
           alpha = 0.05, 
           beta = 0.1, 
           k = 4, 
           frac = c(1/3, 2/3, 1))

## $`Sample size`
##                                            Stage 1 Stage 2 Stage 3
## Cumulative sample size for treatment group      21      42      62
## Cumulative sample size for control group        21      42      62
## 
## $`Maximum total sample size for the trial`
## [1] 310
## 
## $`Boundary values`
##             Stage 1 Stage 2 Stage 3
## Lower bound  -0.630   0.437   2.161
## Upper bound   3.126   3.092   2.161
    </code>
    <p>Based on the design parameters, the first interim analysis can be
    conducted after the enrollment of 21 patients (information time is
    21/62, which is approximately 1/3 at this stage) in the control and
    treatment arms. If the test statistic <inline-formula><alternatives>
    <tex-math><![CDATA[Z_{k,l} < -0.63]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mn>0.63</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    the <inline-formula><alternatives>
    <tex-math><![CDATA[k_{th}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
    arm is rejected for futility at the <inline-formula><alternatives>
    <tex-math><![CDATA[1^{st}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    stage, and the trial continues with the remaining treatment arms and
    the control. If the test statistic <inline-formula><alternatives>
    <tex-math><![CDATA[-0.63 \le Z_{k,l} \le 3.126]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.63</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>3.126</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    for <inline-formula><alternatives>
    <tex-math><![CDATA[k = 1, 2, 3, 4]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    then the trial continues to the next stage, and 21 patients are
    further enrolled per arm. If <inline-formula><alternatives>
    <tex-math><![CDATA[Z_{k,1} > 3.126]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>3.126</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    for some <inline-formula><alternatives>
    <tex-math><![CDATA[k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>,
    the trial is terminated, and the arm with the maximum value of
    <inline-formula><alternatives>
    <tex-math><![CDATA[Z_{k,1}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives>
    <tex-math><![CDATA[k = 1, 2, 3, 4]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    would be recommended for further study. A similar procedure is
    followed if the trial goes to the second stage of interim
    analysis.</p>
    <p>The operating characteristics can be generated using the
    functions <monospace>op_fwer_ord()</monospace> and
    <monospace>op_power_ord()</monospace>, which are similar to those of
    the continuous outcome.</p>
  </sec>
  <sec id="survival-outcome">
    <title>Survival Outcome</title>
    <p>For the survival outcome, we will consider a MAMS trial with five
    arms (four treatment arms and a control arm,
    <monospace>k</monospace> = 4) and two interim looks with balanced
    information time (<monospace>frac</monospace> = c(0.5, 1)). The null
    hazard ratio is (<monospace>hr0</monospace>) 1, and the alternative
    hazard ratio is (<monospace>hr1</monospace>) 0.67. The median
    survival time of the control group is 20 months, and the survival
    distribution is exponential without loss to follow-up. The sample
    size calculation is based on a one-sided type I error of 5% and a
    power of 90%.</p>
    <p>The design parameters for a two-stage design can be calculated
    using the <monospace>design_surv()</monospace> function, and the
    arguments in the function correspond to the median survival time of
    the control group (<monospace>m0</monospace>), the hazard ratio of
    the ineffective treatment vs. control (<monospace>hr0</monospace>),
    the hazard ratio of the effective treatment vs. control
    (<monospace>hr1</monospace>), the accrual time
    (<monospace>ta</monospace>), the follow-up time
    (<monospace>tf</monospace>), the shape parameter of the Weibull
    distribution (<monospace>kappa</monospace>), and the rate of loss to
    follow-up (<monospace>eta</monospace>) (assumed loss to follow-up
    follows an exponential distribution with rate parameter eta).</p>
    <code language="r script">design_surv(m0 = 20, 
            hr0 = 1, 
            hr1 = 0.67032, 
            ta = 40, 
            tf = 20, 
            alpha = 0.05, 
            beta = 0.1, 
            k = 4, 
            kappa = 1, 
            eta = 0, 
            frac = c(0.5, 1))

## $`Sample size`
##                                                              Stage 1 Stage 2
## Cumulative number of events for combined treatment &amp; control     164     328
## 
## $`Maximum total number of events for the trial`
## [1] 820
## 
## $`Total number of subjects required for the trial`
## [1] 1170
## 
## $`Boundary values`
##             Stage 1 Stage 2
## Lower bound   0.075    2.16
## Upper bound   2.980    2.16
    </code>
    <p>The operating characteristics of the trial can be generated using
    the <monospace>op_power_surv()</monospace> and
    <monospace>op_fwer_surv()</monospace> function.</p>
    <p>The design output shows the cumulative number of events for the
    treatment and control groups combined at each stage, along with the
    futility and efficacy boundaries. The total number of subjects
    required for the trial per arm is 234.</p>
    <p>Based on the design parameters, the first interim analysis can be
    conducted after the incidence of 164 events (information time is
    164/328, which is 0.5 at this stage), which results from the
    aggregation of events in the control and treatment arms. If the test
    statistic <inline-formula><alternatives>
    <tex-math><![CDATA[Z_{k,l} < 0.075]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0.075</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    the <inline-formula><alternatives>
    <tex-math><![CDATA[k_{th}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
    arm is rejected for futility at the <inline-formula><alternatives>
    <tex-math><![CDATA[1^{st}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mn>1</mml:mn><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>
    stage, and the trial continues with the remaining treatment arms and
    the control. If the test statistic <inline-formula><alternatives>
    <tex-math><![CDATA[0.075 \le Z_{k,l} \le 2.98]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>0.075</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>2.98</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    for <inline-formula><alternatives>
    <tex-math><![CDATA[k = 1, 2, 3, 4]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    then the trial continues to the next stage, and we will wait for the
    incidence of an additional 164 events to conduct the next interim
    analysis. If <inline-formula><alternatives>
    <tex-math><![CDATA[Z_{k,1} > 2.98]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>2.98</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    for some <inline-formula><alternatives>
    <tex-math><![CDATA[k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>,
    the trial is terminated, and the arm with the maximum value of
    <inline-formula><alternatives>
    <tex-math><![CDATA[Z_{k,1}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives>
    <tex-math><![CDATA[k = 1, 2, 3, 4]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    would be recommended for further study.</p>
    <p>The operating characteristics of the trial can be generated using
    the <monospace>op_power_surv()</monospace> and
    <monospace>op_fwer_surv()</monospace> functions.</p>
    <sec id="for-fwer-and-stagewise-fwer-1">
      <title>For FWER and Stagewise FWER:</title>
      <code language="r script">op_fwer_surv(m0 = 20, 
             alpha = 0.05, 
             beta = 0.1, 
             p = 4, 
             frac = c(1/2, 1), 
             hr0 = 1, 
             hr1 = 0.6703, 
             nsim = 10000, 
             ta = 40, 
             tf = 20, 
             kappa = 1, 
             eta = 0, 
             seed = 12)

## $FWER
## [1] 0.05
## 
## $`Stagewise FWER`
##  look1  look2 
## 0.0049 0.0460 
## 
## $`Stopping probability under null`
##  look1  look2 
## 0.2318 0.7682 
## 
## $`Probability of futility under null`
##  look1  look2 
## 0.2269 0.7234 
## 
## $`Average number of events happened per arm under null`
## [1] 129.5902
## 
## $`Average duration of trial(months)`
## [1] 54.27148
      </code>
      <p>Based on the simulation results, the type I error is
      approximately 0.4% at the first interim analysis and approximately
      4.6% at the second interim analysis. Therefore, the overall type I
      error is maintained at 5%. The stopping probability should be
      approximately 1, which is the case here, and since this is under
      the null configuration, the probability of futility should be
      approximately 95%, which holds true in this case. The average
      duration of the trial is 54 months, which is reasonable as the
      total duration of the trial is 60 months. The average number of
      events that happened per arm is 130.</p>
    </sec>
    <sec id="for-power-and-stagewise-power-1">
      <title>For Power and Stagewise Power :</title>
      <code language="r script">op_power_surv(m0 = 20, 
              alpha = 0.05, 
              beta = 0.1, 
              p = 4, 
              frac = c(1/2, 1), 
              hr0 = 1, 
              hr1 = 0.6703, 
              nsim = 10000, 
              ta = 40, 
              tf = 20, 
              kappa = 1, 
              eta = 0, 
              seed = 12)

## $Power
## [1] 0.913
## 
## $`Stagewise Power`
##  look1  look2 
## 0.3270 0.5863 
## 
## $`Stopping probability under alternative`
##  look1  look2 
## 0.3334 0.6666 
## 
## $`Probability of futility under alternative`
##  look1  look2 
## 0.0059 0.0800 
## 
## $`Average number of events happened per arm under alternative`
## [1] 115.0483
## 
## $`Average duration of trial(months)`
## [1] 52.27229
      </code>
      <p>Based on the simulation results, the probability of success at
      the first stage is 32.7% and at the second stage is approximately
      58.63%. Therefore, the desired power of 90% has been met. The
      overall stopping probability should add up to 1, which is the case
      here, and the probability of futility is approximately 8.5%, which
      is less than 10% type II error because of the same reason as
      mentioned in the continuous outcome. The average duration of the
      trial is 52 months, which is reasonable as the total duration of
      the trial is 60 months. The average number of events that happened
      per arm is 115.</p>
    </sec>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>Dr. Wu’s research was supported by the University of new Mexico
  Comprehensive Cancer Center Support Grant National Cancer Institute
  (NCI) P30CA118100 and Dr. Li’s research was supported by the
  Comprehensive Cancer Center at St. Jude Children’s Research Hospital
  and American Lebanese Syrian Associated Charities (ALSAC).</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-Jaki2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jaki</surname><given-names>Thomas</given-names></name>
        <name><surname>Pallmann</surname><given-names>Philip</given-names></name>
        <name><surname>Magirr</surname><given-names>Dominic</given-names></name>
      </person-group>
      <article-title>The R package MAMS for designing multi-arm multi-stage clinical trials</article-title>
      <source>Journal of Statistical Software</source>
      <year iso-8601-date="2019">2019</year>
      <volume>88</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.18637/jss.v088.i04</pub-id>
      <fpage>1</fpage>
      <lpage>25</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Parsons2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Parsons</surname><given-names>Nick</given-names></name>
        <name><surname>Friede</surname><given-names>Tim</given-names></name>
        <name><surname>Todd</surname><given-names>Susan</given-names></name>
        <name><surname>Stallard</surname><given-names>Nigel</given-names></name>
      </person-group>
      <article-title>Software tools for implementing simulation studies in adaptive seamless designs: Introducing r package ASD</article-title>
      <source>Trials</source>
      <year iso-8601-date="2011">2011</year>
      <volume>12</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1186/1745-6215-12-S1-A8</pub-id>
      <fpage>A8</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Hack2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hack</surname><given-names>Niklas</given-names></name>
        <name><surname>Brannath</surname><given-names>Werner</given-names></name>
        <name><surname>Brueckner</surname><given-names>Matthias</given-names></name>
      </person-group>
      <article-title>AGSDest: Estimation in adaptive group sequential trials</article-title>
      <year iso-8601-date="2022">2022</year>
      <uri>https://CRAN.R-project.org/package=AGSDest</uri>
    </element-citation>
  </ref>
  <ref id="ref-Vandemeulebroecke2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vandemeulebroecke</surname><given-names>Marc</given-names></name>
      </person-group>
      <article-title>adaptTest: Adaptive two-stage tests</article-title>
      <year iso-8601-date="2022">2022</year>
      <uri>https://CRAN.R-project.org/package=adaptTest</uri>
    </element-citation>
  </ref>
  <ref id="ref-PARMAR2014283">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Parmar</surname><given-names>Mahesh K B</given-names></name>
        <name><surname>Carpenter</surname><given-names>James</given-names></name>
        <name><surname>Sydes</surname><given-names>Matthew R</given-names></name>
      </person-group>
      <article-title>More multiarm randomised trials of superiority are needed</article-title>
      <source>The Lancet</source>
      <year iso-8601-date="2014">2014</year>
      <volume>384</volume>
      <issue>9940</issue>
      <issn>0140-6736</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0140673614611223</uri>
      <pub-id pub-id-type="doi">10.1016/S0140-6736(14)61122-3</pub-id>
      <fpage>283</fpage>
      <lpage>284</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Genz2009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Genz</surname><given-names>Alan</given-names></name>
        <name><surname>Bretz</surname><given-names>Frank</given-names></name>
      </person-group>
      <article-title>Computation of multivariate normal and t probabilities</article-title>
      <publisher-name>Springer-Verlag</publisher-name>
      <publisher-loc>Heidelberg</publisher-loc>
      <year iso-8601-date="2009">2009</year>
      <isbn>978-3-642-01688-2</isbn>
      <pub-id pub-id-type="doi">10.1007/978-3-642-01689-9</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-pushpakom2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pushpakom</surname><given-names>SP</given-names></name>
        <name><surname>Taylor</surname><given-names>C</given-names></name>
        <name><surname>Kolamunnage-Dona</surname><given-names>R</given-names></name>
        <name><surname>Spowart</surname><given-names>C</given-names></name>
        <name><surname>Vora</surname><given-names>J</given-names></name>
        <name><surname>García-Fiñana</surname><given-names>M</given-names></name>
        <name><surname>Kemp</surname><given-names>GJ</given-names></name>
        <name><surname>Whitehead</surname><given-names>J</given-names></name>
        <name><surname>Jaki</surname><given-names>T</given-names></name>
        <name><surname>Khoo</surname><given-names>S</given-names></name>
        <name><surname>Williamson</surname><given-names>P</given-names></name>
        <name><surname>Pirmohamed</surname><given-names>M</given-names></name>
      </person-group>
      <article-title>Telmisartan and insulin resistance in HIV (TAILoR): Protocol for a dose-ranging phase II randomised open-labelled trial of telmisartan as a strategy for the reduction of insulin resistance in HIV-positive individuals on combination antiretroviral therapy</article-title>
      <source>BMJ Open</source>
      <year iso-8601-date="2015">2015</year>
      <volume>5</volume>
      <issue>10</issue>
      <pub-id pub-id-type="doi">10.1136/bmjopen-2015-009566</pub-id>
      <pub-id pub-id-type="pmid">26474943</pub-id>
      <fpage>e009566</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-John1993">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Whitehead</surname><given-names>John</given-names></name>
      </person-group>
      <article-title>Application of sequential methods to a phase III clinical trial in stroke</article-title>
      <source>Drug Information Journal</source>
      <year iso-8601-date="1993">1993</year>
      <volume>27</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1177/009286159302700315</pub-id>
      <fpage>733</fpage>
      <lpage>740</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Li2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wu</surname><given-names>Jianrong</given-names></name>
        <name><surname>Li</surname><given-names>Yimei</given-names></name>
        <name><surname>Zhu</surname><given-names>Liang</given-names></name>
      </person-group>
      <article-title>Group sequential multi-arm multi-stage trial design with treatment selection</article-title>
      <source>Statistics in Medicine</source>
      <year iso-8601-date="2023">2023</year>
      <volume>42</volume>
      <issue>10</issue>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.9682</uri>
      <pub-id pub-id-type="doi">10.1002/sim.9682</pub-id>
      <fpage>1480</fpage>
      <lpage>1491</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
