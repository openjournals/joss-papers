<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6145</article-id>
<article-id pub-id-type="doi">10.21105/joss.06145</article-id>
<title-group>
<article-title>AHGestimation: An R package for computing robust, mass
preserving hydraulic geometries and rating curves</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5288-8350</contrib-id>
<name>
<surname>Johnson</surname>
<given-names>J Michael</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5166-6721</contrib-id>
<name>
<surname>Afshari</surname>
<given-names>Shahab</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6030-7923</contrib-id>
<name>
<surname>Rad</surname>
<given-names>Arash Modaresi</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Lynker, NOAA/NWS Office of Water Prediction</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>University of Massachusetts Amherst</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-04-12">
<day>12</day>
<month>4</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>96</issue>
<fpage>6145</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>hydrology</kwd>
<kwd>AHG</kwd>
<kwd>optimization</kwd>
<kwd>hydraulics</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <sec id="background">
    <title>Background</title>
    <p>The behavior of a river channel at a given cross-section is often
    described using power law equations to relate top width (TW), mean
    depth (Y), and mean velocity (V) to discharge (Q). These equations
    collectively define the “at a station hydraulic geometry” (AHG),
    with coefficients (a, c, k) and exponents (b, f, m) for the Q-TW,
    Q-Y, and Q-V relationships
    (<xref alt="Leopold &amp; Maddock, 1953" rid="ref-leopold1953hydraulic" ref-type="bibr">Leopold
    &amp; Maddock, 1953</xref>). While each relation can be studied
    independently, together they represent the full hydraulic
    system.</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[\begin{aligned}
     TW = a \cdot Q^b \\ Y = c \cdot Q^f \\ V = k \cdot Q^m 
    \end{aligned}]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>T</mml:mi><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mi>f</mml:mi></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>⋅</mml:mo><mml:msup><mml:mi>Q</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    <p>Where:</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[\begin{aligned}
     Q = TW \cdot Y \cdot V 
    \end{aligned}]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mi>W</mml:mi><mml:mo>⋅</mml:mo><mml:mi>Y</mml:mi><mml:mo>⋅</mml:mo><mml:mi>V</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    <p>When using the traditional AHG fitting methods, power laws are
    estimated using Ordinary Least Squares Regression (OLS) on the
    logarithmic transformation of the variables, where the exponential
    of the intercept provides the power law coefficient, and the slope
    of the linear model provides the exponent. Several studies have
    highlighted the potential problem of using this approach given that
    when the log transformed values are back-transformed, the estimates
    are effectively medians, and not means of the estimates, resulting
    in a general low bias. AHG relations apply to within-bank flows at a
    specific location and assume the channel characteristics do not
    significantly change with discharge. Under these assumptions, two
    continuity conditions ensure mass conservation (equation 5-6).</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[\begin{aligned}
     b + f + m = 1 \\ a \times c \times k = 1  
    \end{aligned}]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right" style="text-align: right"><mml:mi>a</mml:mi><mml:mo>×</mml:mo><mml:mi>c</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
    <p>Real-world data often fails to meet these conditions precisely,
    so an allowance is typically permitted. Violating these conditions
    leads to mass imbalances in computations, causing input streamflows
    to gain or lose mass in its translation to other states. Given the
    noisy nature of hydraulic data, tools are needed to prep input data
    and fit equations while balancing accuracy and mass preservation for
    hydrologic and hydraulic modeling.</p>
  </sec>
  <sec id="statement-of-need">
    <title>Statement of need</title>
    <p>Hydrologic models that simulate streamflow are critical for
    forecasting water availability, drought, and flood inundation. A key
    aspect of these models is estimating the size and shape of channels,
    often achieved through hydraulic geometry relationships.</p>
    <p>While extensively studied at local scales, these relationships
    remain unquantified for the majority of stream reaches globally,
    including in the United States. As a result, large-scale models
    often rely on incomplete approximations, leading to less accurate
    streamflow estimates
    (<xref alt="Fang et al., 2024" rid="ref-fang2024" ref-type="bibr">Fang
    et al., 2024</xref>;
    <xref alt="Heldmyer et al., 2022" rid="ref-hess-26-6121-2022" ref-type="bibr">Heldmyer
    et al., 2022</xref>;
    <xref alt="Johnson et al., 2023" rid="ref-johnson2023comprehensive" ref-type="bibr">Johnson
    et al., 2023</xref>) and flood forecasts
    (<xref alt="Johnson et al., 2019" rid="ref-johnson2019integrated" ref-type="bibr">Johnson
    et al., 2019</xref>;
    <xref alt="Maidment, 2017" rid="ref-maidment2014national" ref-type="bibr">Maidment,
    2017</xref>;
    <xref alt="NOAA, 2023" rid="ref-fim" ref-type="bibr">NOAA,
    2023</xref>;
    <xref alt="Zheng et al., 2018" rid="ref-zheng2018river" ref-type="bibr">Zheng
    et al., 2018</xref>). For instance, the National Oceanic and
    Atmospheric Administration National Water Model
    (<xref alt="Cosgrove et al., 2024" rid="ref-cosgrove2023" ref-type="bibr">Cosgrove
    et al., 2024</xref>) uses trapezoidal geometries
    (<xref alt="Gochis et al., 2020" rid="ref-wrfhydro" ref-type="bibr">Gochis
    et al., 2020</xref>) that are in part derived from hydraulic
    geometry relationships and drainage area assumptions found in Bieger
    et al.
    (<xref alt="2015" rid="ref-bieger2015development" ref-type="bibr">2015</xref>),
    Bieger et al.
    (<xref alt="2016" rid="ref-bieger2016development" ref-type="bibr">2016</xref>),
    and Blackburn-Lynch et al.
    (<xref alt="2017" rid="ref-blackburn2017development" ref-type="bibr">2017</xref>).
    Although these approximations are recognized as overly simplistic,
    advancing them requires integrating diverse observation systems and
    refining them into parameterized, mass-conserving relationships.</p>
    <p>Several efforts have aimed to address this challenge in the
    United States, primarily relying on traditional OLS fitting methods
    and data preprocessing
    (<xref alt="Afshari et al., 2017" rid="ref-afshari2017statistical" ref-type="bibr">Afshari
    et al., 2017</xref>;
    <xref alt="Afshari, 2019" rid="ref-afshari_shahab_2019_2558565" ref-type="bibr">Afshari,
    2019</xref>;
    <xref alt="Enzminger, 2023" rid="ref-enzminger_thomas_l_2023_7868764" ref-type="bibr">Enzminger,
    2023</xref>). However, these efforts are limited by the lack of
    shared software and source data, hindering the evolution, and
    interoperability, of their products.</p>
  </sec>
  <sec id="software">
    <title>Software</title>
    <p>AHG estimation has traditionally been conducted on a
    site-specific basis, with location-specific knowledge guiding data
    selection and output validation. However, as interest in large-scale
    model applications grows
    (<xref alt="Archfield et al., 2015" rid="ref-archfield2015" ref-type="bibr">Archfield
    et al., 2015</xref>), the importance of estimating these
    relationships from diverse and often noisy datasets becomes
    increasingly evident.</p>
    <p>Towards this, <monospace>AHGestimation</monospace> is an R
    package
    (<xref alt="R Core Team, 2023" rid="ref-r-project" ref-type="bibr">R
    Core Team, 2023</xref>) providing three capabilities:</p>
    <list list-type="order">
      <list-item>
        <p><bold>AHG Estimation</bold>
        (<monospace>ahg_estimate</monospace>): This tool provides robust
        estimation techniques to estimate single and full system AHG
        relations that enforce flow continuity and minimizes total
        system error. This is accomplished by introducing a hybrid
        approach that supplements the traditional OLS approach, with a
        Nonlinear Least Square (NLS) regression, Evolutionary algorithm
        (NSGA-2)
        (<xref alt="Mersmann, 2020" rid="ref-mco" ref-type="bibr">Mersmann,
        2020</xref>), and ensemble modeling approach.</p>
      </list-item>
      <list-item>
        <p><bold>Outlier Filtering Methods</bold>
        (<monospace>date_filter</monospace>,
        <monospace>qva_filter</monospace>,
        <monospace>mad_filter</monospace>,
        <monospace>nls_filter</monospace>): These methods allow users to
        filter outliers based on various criteria, including time, mass
        conservation, and statistical detection.</p>
      </list-item>
      <list-item>
        <p><bold>Formalization of derived AHG Concepts</bold>
        (<monospace>cross_section</monospace>,
        <monospace>compute_hydraulic_params</monospace>,
        <monospace>compute_n</monospace>): These functions formalize
        many of the concepts derived in Dingman &amp; Afshari
        (<xref alt="2018" rid="ref-dingman2018field" ref-type="bibr">2018</xref>)
        that relate AHG coefficients and exponents to cross-section
        hydraulics and geometry.</p>
      </list-item>
    </list>
    <p>The package documentation includes several examples on the
    theory, design, and application of these tools.</p>
    <p>The first stable version of <monospace>AHGestimation</monospace>
    was made available in 2019 and was applied to an aggregated dataset
    of USGS manual field measurements. Since then, it has been actively
    developed to better understand and quantify these fundamental
    relationships in the face of noisy, large, and disparate data
    sources. Applications of the software have been used to (1)
    demonstrate how improved flood forecasts could be delivered from the
    NOAA/NWS National Water Model
    (<xref alt="Johnson, Narock, et al., 2022" rid="ref-johnson2022knowledge" ref-type="bibr">Johnson,
    Narock, et al., 2022</xref>), (2) help the NOAA/NWS Office of Water
    Prediction develop continental scale channel size and shape
    estimates to improve flood prediction and hydraulic routing, and (3)
    bolster the co-agency USGS/NOAA National Hydrologic Geospatial
    Fabric and Next Generation Water Resource Modeling Framework
    Hydrofabric efforts
    (<xref alt="Blodgett et al., 2021" rid="ref-blodgett2021mainstems" ref-type="bibr">Blodgett
    et al., 2021</xref>,
    <xref alt="2023" rid="ref-blodgett2023generating" ref-type="bibr">2023</xref>;
    <xref alt="Bock et al., 2022" rid="ref-referencefabric" ref-type="bibr">Bock
    et al., 2022</xref>;
    <xref alt="Johnson, 2022" rid="ref-nextgenhf" ref-type="bibr">Johnson,
    2022</xref>).</p>
  </sec>
</sec>
<sec id="example-of-use">
  <title>Example of use</title>
  <p><monospace>AHGestimation</monospace> is available on
  <ext-link ext-link-type="uri" xlink:href="https://github.com/mikejohnson51/AHGestimation">GitHub</ext-link>
  and can be installed as follows:</p>
  <code language="r script">#install.packages(remotes)
remotes::install.packages(&quot;mikejohnson51/AHGestimation&quot;)</code>
  <p>This example illustrates how the package can be utilized to:</p>
  <list list-type="order">
    <list-item>
      <p><bold>Remove Data Outliers</bold>: Outliers are filtered based
      on time criteria and an NLS envelope.</p>
    </list-item>
    <list-item>
      <p><bold>Fit AHG Parameters</bold>: AHG parameters are estimated
      using the hybrid modeling approach.</p>
    </list-item>
    <list-item>
      <p><bold>Estimate and Plot Cross-Section Shape</bold>: The shape
      of the associated cross-section is estimated and plotted with an
      area-depth relation.</p>
    </list-item>
  </list>
  <p>The script to generate the plot found in
  <xref alt="[fig:ahg-1]" rid="figU003Aahg-1">[fig:ahg-1]</xref> can be
  found
  <ext-link ext-link-type="uri" xlink:href="https://github.com/mikejohnson51/AHGestimation/blob/master/paper/image.R">here</ext-link>,
  and the <monospace>nwis</monospace> data object is exported with the
  package to provides field measurements taken at
  <ext-link ext-link-type="uri" xlink:href="https://waterdata.usgs.gov/nwis/measurements/?site_no=01096500&amp;agency_cd=USGS">USGS
  site 01096500 on the Nashua River at East Pepperell in
  Massachusetts</ext-link>.</p>
  <code language="r script">nwis

#&gt; siteID       date           Q         Y        V       TW
#&gt; 01096500 1984-11-14   9.7409954 0.5276645 0.652272 28.34640
#&gt; 01096500 1985-01-04  11.8930757 0.6263473 0.682752 27.73680
#&gt; 01096500 1985-05-06  10.8170356 0.5952226 0.563880 32.30880


nrow(nwis)
#&gt;  245

# Keep only those observation made in the most recent 10 years, 
# and that fall withing the .5 nls envelope
(data = nwis  |&gt;
  dplyr::rename(Q = Q_cms, Y  = Y_m, V= V_ms, TW = TW_m) |&gt;
  date_filter(10, keep_max = TRUE) |&gt; 
  nls_filter(allowance = 0.5) )

# data reduced to 80 observations based on filters
nrow(data)
#&gt;  85</code>
  <p>The reduced clean data can then be used to fit an AHG relation and
  compute a set of hydraulic parameters:</p>
  <code language="r script"># Fit AHG relations
ahg_fit = ahg_estimate(data)
t(ahg_fit[1,])

#&gt; V_method  &quot;nls&quot;      
#&gt; TW_method &quot;nls&quot;      
#&gt; Y_method  &quot;nls&quot;      
#&gt; c1        &quot;1.006&quot;    
#&gt; c2        &quot;1.001&quot;    
#&gt; viable    &quot;TRUE&quot;     
#&gt; tot_nrmse &quot;0.3234122&quot;
#&gt; V_nrmse   &quot;0.1337535&quot;
#&gt; TW_nrmse  &quot;0.1009869&quot;
#&gt; Y_nrmse   &quot;0.0886718&quot;
#&gt; V_coef    &quot;0.2905399&quot;
#&gt; TW_coef   &quot;18.23401&quot; 
#&gt; Y_coef    &quot;0.1898499&quot;
#&gt; V_exp     &quot;0.3101059&quot;
#&gt; TW_exp    &quot;0.1756746&quot;
#&gt; Y_exp     &quot;0.5155772&quot;
#&gt; condition &quot;bestValid&quot;

# Use the AHG relations to compute hydraulic parameters
shape = compute_hydraulic_params(ahg_fit[1,])

#&gt; r    p    d    R    bd   fd   md
#&gt; 2.93 0.60 5.70 1.34 0.18 0.51 0.31</code>
  <p>Finally, the max width and depth, paired with the derived
  <monospace>r</monospace> coefficient can be used to generate a cross
  section:</p>
  <code language="r script"># Use the max width, max depth, and derived `r` to generate a cross section
# x: is the relative distance from the left bank
# Y: is the associated depth
# A: is the area associated with depth Y

cs = cross_section(r = shape$r,  
                   TW = max(data$TW), 
                   Ymax = max(data$Y))

#&gt;  ind         x            Y            A
#&gt;    1  0.000000 3.5525892702 1.337069e+02
#&gt;    2  1.040816 3.1514749668 1.136999e+02
#&gt;    3  2.081633 2.7814289966 9.601412e+01</code>
  <fig>
    <caption><p>Faceted image with multiple views of the channel
    estimate.<styled-content id="figU003Aahg-1"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="media/paper-fig1.png" />
  </fig>
  <p>As a proof of concept, this approach was applied to the synthetic
  rating curves generated by NOAA/NWS OWP’s inundation mapping software
  (<xref alt="NOAA, 2023" rid="ref-fim" ref-type="bibr">NOAA,
  2023</xref>). The package allowed the size of their rating curve
  database to be reduced by 99.68% while maintaining average accuracy
  within 0.4% NRMSE of the source data
  (<xref alt="Johnson, Coll, et al., 2022" rid="ref-preprint" ref-type="bibr">Johnson,
  Coll, et al., 2022</xref>). This reduction to a consistent AHG
  formulation not only enhances interoperability with efforts such as
  those by Enzminger
  (<xref alt="2023" rid="ref-enzminger_thomas_l_2023_7868764" ref-type="bibr">2023</xref>)
  or Afshari
  (<xref alt="2019" rid="ref-afshari_shahab_2019_2558565" ref-type="bibr">2019</xref>),
  but also lays the groundwork for providing essential training data for
  advanced prediction methods that seek to estimate the shape on
  non-measured river segments.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The development of this package began following the 2017 NOAA/NWS
  Office of Water Prediction Summer Institute
  (<xref alt="Johnson et al., 2017" rid="ref-owpsi2017" ref-type="bibr">Johnson
  et al., 2017</xref>) where discussions highlighted the potential
  influence of channel shape representation on the performance of the
  National Water Model.</p>
  <p>The algorithm and implementation began as a graduate school project
  between friends at UC Santa Barbara and UMass Amherst and has since
  evolved to provide an open source utility for robust large scale data
  synthesis and evaluation. Funding from the National Science Foundation
  (Grants 1937099, 2033607) provided time to draft
  (<xref alt="Johnson, Coll, et al., 2022" rid="ref-preprint" ref-type="bibr">Johnson,
  Coll, et al., 2022</xref>) and apply an early version of this software
  to the Continental Flood Inundation Mapping synthetic rating curve
  dataset
  (<xref alt="Liu &amp; Maidment, 2020" rid="ref-cfim" ref-type="bibr">Liu
  &amp; Maidment, 2020</xref>). Funding from the NOAA/NWS OWP supported
  the addition of data filtering and hydraulic geometry estimation,
  improved documentation, and code hardening. We are grateful to all
  involved.</p>
</sec>
<sec id="disclaimer">
  <title>Disclaimer</title>
  <p>The views expressed in this article do not necessarily represent
  the views of NOAA, the USGS, or the United States.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-r-project">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>R Core Team</string-name>
      </person-group>
      <source>R: A Language and Environment for Statistical Computing</source>
      <publisher-name>R Foundation for Statistical Computing</publisher-name>
      <publisher-loc>Vienna, Austria</publisher-loc>
      <year iso-8601-date="2023">2023</year>
      <uri>https://www.R-project.org/</uri>
    </element-citation>
  </ref>
  <ref id="ref-leopold1953hydraulic">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Leopold</surname><given-names>Luna Bergere</given-names></name>
        <name><surname>Maddock</surname><given-names>Thomas</given-names></name>
      </person-group>
      <source>The hydraulic geometry of stream channels and some physiographic implications</source>
      <publisher-name>US Government Printing Office</publisher-name>
      <year iso-8601-date="1953">1953</year>
      <volume>252</volume>
      <pub-id pub-id-type="doi">10.3133/pp252</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-johnson2022knowledge">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
        <name><surname>Narock</surname><given-names>Tom</given-names></name>
        <name><surname>Singh-Mohudpur</surname><given-names>Justin</given-names></name>
        <name><surname>Fils</surname><given-names>Doug</given-names></name>
        <name><surname>Clarke</surname><given-names>Keith</given-names></name>
        <name><surname>Saksena</surname><given-names>Siddharth</given-names></name>
        <name><surname>Shepherd</surname><given-names>Adam</given-names></name>
        <name><surname>Arumugam</surname><given-names>Sankar</given-names></name>
        <name><surname>Yeghiazarian</surname><given-names>Lilit</given-names></name>
      </person-group>
      <article-title>Knowledge graphs to support real-time flood impact evaluation</article-title>
      <source>AI Magazine</source>
      <year iso-8601-date="2022">2022</year>
      <volume>43</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1002/aaai.12035</pub-id>
      <fpage>40</fpage>
      <lpage>45</lpage>
    </element-citation>
  </ref>
  <ref id="ref-referencefabric">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Bock</surname><given-names>A. R.</given-names></name>
        <name><surname>Blodgett</surname><given-names>D. L.</given-names></name>
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
        <name><surname>Santiago</surname><given-names>M.</given-names></name>
        <name><surname>Wieczorek</surname><given-names>M. E.</given-names></name>
      </person-group>
      <source>National Hydrologic Geospatial Fabric Reference and Derived Hydrofabrics</source>
      <publisher-name>U.S. Geological Survey software release</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <uri>https://www.sciencebase.gov/catalog/item/60be0e53d34e86b93891012b</uri>
    </element-citation>
  </ref>
  <ref id="ref-nextgenhf">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
      </person-group>
      <article-title>National hydrologic geospatial fabric (hydrofabric) for the next generation (NextGen) hydrologic modeling framework</article-title>
      <publisher-name>HydroShare</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <uri>https://www.hydroshare.org/resource/129787b468aa4d55ace7b124ed27dbde/</uri>
    </element-citation>
  </ref>
  <ref id="ref-mco">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Mersmann</surname><given-names>Olaf</given-names></name>
      </person-group>
      <source>mco: Multiple Criteria Optimization Algorithms and Related Functions</source>
      <year iso-8601-date="2020">2020</year>
      <uri>https://CRAN.R-project.org/package=mco</uri>
    </element-citation>
  </ref>
  <ref id="ref-dingman2018field">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dingman</surname><given-names>Lawerence S.</given-names></name>
        <name><surname>Afshari</surname><given-names>Shahab</given-names></name>
      </person-group>
      <article-title>Field verification of analytical at-a-station hydraulic-geometry relations</article-title>
      <source>Journal of Hydrology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>564</volume>
      <pub-id pub-id-type="doi">10.1016/j.jhydrol.2018.07.020</pub-id>
      <fpage>859</fpage>
      <lpage>872</lpage>
    </element-citation>
  </ref>
  <ref id="ref-enzminger_thomas_l_2023_7868764">
    <element-citation publication-type="dataset">
      <person-group person-group-type="author">
        <name><surname>Enzminger</surname><given-names>Minear</given-names><suffix>Thomas L.</suffix></name>
      </person-group>
      <article-title>HyG: A hydraulic geometry dataset derived from historical stream gage measurements across the conterminous United States</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2023-04">2023</year><month>04</month>
      <uri>https://doi.org/10.5281/zenodo.7868764</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.7868764</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-afshari_shahab_2019_2558565">
    <element-citation publication-type="dataset">
      <person-group person-group-type="author">
        <name><surname>Afshari</surname><given-names>Shahab</given-names></name>
      </person-group>
      <article-title>USGS Table AHG Parameters And Supplementary Data</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2019-02">2019</year><month>02</month>
      <uri>https://doi.org/10.5281/zenodo.2558565</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.2558565</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-zheng2018river">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zheng</surname><given-names>Xing</given-names></name>
        <name><surname>Tarboton</surname><given-names>David G</given-names></name>
        <name><surname>Maidment</surname><given-names>David R</given-names></name>
        <name><surname>Liu</surname><given-names>Yan Y</given-names></name>
        <name><surname>Passalacqua</surname><given-names>Paola</given-names></name>
      </person-group>
      <article-title>River channel geometry and rating curve estimation using height above the nearest drainage</article-title>
      <source>JAWRA Journal of the American Water Resources Association</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>54</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1111/1752-1688.12661</pub-id>
      <fpage>785</fpage>
      <lpage>806</lpage>
    </element-citation>
  </ref>
  <ref id="ref-maidment2014national">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Maidment</surname><given-names>David R.</given-names></name>
      </person-group>
      <article-title>Conceptual Framework for the National Flood Interoperability Experiment</article-title>
      <source>JAWRA Journal of the American Water Resources Association</source>
      <year iso-8601-date="2017">2017</year>
      <volume>53</volume>
      <issue>2</issue>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1111/1752-1688.12474</uri>
      <pub-id pub-id-type="doi">10.1111/1752-1688.12474</pub-id>
      <fpage>245</fpage>
      <lpage>257</lpage>
    </element-citation>
  </ref>
  <ref id="ref-johnson2019integrated">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
        <name><surname>Munasinghe</surname><given-names>Dinuke</given-names></name>
        <name><surname>Eyelade</surname><given-names>Damilola</given-names></name>
        <name><surname>Cohen</surname><given-names>Sagy</given-names></name>
      </person-group>
      <article-title>An integrated evaluation of the National Water Model (NWM)–Height Above Nearest Drainage (HAND) flood mapping methodology</article-title>
      <source>Natural Hazards and Earth System Sciences</source>
      <publisher-name>Copernicus GmbH</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>19</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.5194/nhess-19-2405-2019</pub-id>
      <fpage>2405</fpage>
      <lpage>2420</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fim">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>NOAA</surname><given-names>Office of Water Prediction</given-names></name>
      </person-group>
      <source>Inundation Mapping</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://github.com/NOAA-OWP/inundation-mapping</uri>
    </element-citation>
  </ref>
  <ref id="ref-blackburn2017development">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Blackburn-Lynch</surname><given-names>Whitney</given-names></name>
        <name><surname>Agouridis</surname><given-names>Carmen T</given-names></name>
        <name><surname>Barton</surname><given-names>Christopher D</given-names></name>
      </person-group>
      <article-title>Development of regional curves for hydrologic landscape regions (HLR) in the contiguous United States</article-title>
      <source>JAWRA Journal of the American Water Resources Association</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>53</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1111/1752-1688.12540</pub-id>
      <fpage>903</fpage>
      <lpage>928</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wrfhydro">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gochis</surname><given-names>D. J.</given-names></name>
        <name><surname>M. Barlage</surname><given-names>R.</given-names></name>
        <name><surname>Cabell</surname><given-names>M. Casali</given-names></name>
        <name><surname>Dugger</surname><given-names>A.</given-names></name>
        <name><surname>K. FitzGerald</surname><given-names>J. McCreight</given-names><suffix>M. McAllister</suffix></name>
        <name><surname>RafieeiNasab</surname><given-names>A.</given-names></name>
        <name><surname>L. Read</surname><given-names>K. Sampson</given-names></name>
        <name><surname>Yates</surname><given-names>D.</given-names></name>
        <name><surname>Zhang</surname><given-names>Y.</given-names></name>
      </person-group>
      <article-title>The WRF-Hydro® modeling system technical description, (Version 5.2.0)</article-title>
      <source>NCAR Technical Note</source>
      <year iso-8601-date="2020">2020</year>
      <uri>https://ral.ucar.edu/sites/default/files/public/projects/wrf-hydro/technical-description-user-guide/wrf-hydrov5.2technicaldescription.pdf</uri>
    </element-citation>
  </ref>
  <ref id="ref-preprint">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
        <name><surname>Coll</surname><given-names>J.</given-names></name>
        <name><surname>Clarke</surname><given-names>Afshari</given-names><suffix>K. C.</suffix></name>
        <name><surname>S.</surname><given-names>S</given-names><suffix>Saksena</suffix></name>
        <name><surname>Yeghiazarian</surname><given-names>L.</given-names></name>
      </person-group>
      <article-title>Determining Feature Based Hydraulic Geometry and Rating Curves using a Physically Based, Computationally Efficient Framework</article-title>
      <source>Preprints</source>
      <year iso-8601-date="2022">2022</year>
      <uri>https://doi.org/10.20944/preprints202212.0390.v1</uri>
      <pub-id pub-id-type="doi">10.20944/preprints202212.0390.v1</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-cfim">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Liu</surname><given-names>Tarboton</given-names><suffix>Yan Y.</suffix></name>
        <name><surname>Maidment</surname><given-names>David R.</given-names></name>
      </person-group>
      <source>Height Above Nearest Drainage (HAND) and Hydraulic Property Table for CONUS - Version 0.2.1. (20200601)</source>
      <year iso-8601-date="2020">2020</year>
      <uri>https://cfim.ornl.gov/data/</uri>
    </element-citation>
  </ref>
  <ref id="ref-hess-26-6121-2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Heldmyer</surname><given-names>A.</given-names></name>
        <name><surname>Livneh</surname><given-names>B.</given-names></name>
        <name><surname>McCreight</surname><given-names>J.</given-names></name>
        <name><surname>Read</surname><given-names>L.</given-names></name>
        <name><surname>Kasprzyk</surname><given-names>J.</given-names></name>
        <name><surname>Minear</surname><given-names>T.</given-names></name>
      </person-group>
      <article-title>Evaluation of a new observationally based channel parameterization for the National Water Model</article-title>
      <source>Hydrology and Earth System Sciences</source>
      <year iso-8601-date="2022">2022</year>
      <volume>26</volume>
      <issue>23</issue>
      <uri>https://hess.copernicus.org/articles/26/6121/2022/</uri>
      <pub-id pub-id-type="doi">10.5194/hess-26-6121-2022</pub-id>
      <fpage>6121</fpage>
      <lpage>6136</lpage>
    </element-citation>
  </ref>
  <ref id="ref-blodgett2021mainstems">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Blodgett</surname><given-names>David</given-names></name>
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
        <name><surname>Sondheim</surname><given-names>Mark</given-names></name>
        <name><surname>Wieczorek</surname><given-names>Michael</given-names></name>
        <name><surname>Frazier</surname><given-names>Nels</given-names></name>
      </person-group>
      <article-title>Mainstems: A logical data model implementing mainstem and drainage basin feature types based on WaterML2 Part 3: HY Features concepts</article-title>
      <source>Environmental Modelling &amp; Software</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>135</volume>
      <pub-id pub-id-type="doi">10.1016/j.envsoft.2020.104927</pub-id>
      <fpage>104927</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-blodgett2023generating">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Blodgett</surname><given-names>David</given-names></name>
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
        <name><surname>Bock</surname><given-names>Andy</given-names></name>
      </person-group>
      <article-title>Generating a reference flow network with improved connectivity to support durable data integration and reproducibility in the coterminous US</article-title>
      <source>Environmental Modelling &amp; Software</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>165</volume>
      <pub-id pub-id-type="doi">10.1016/j.envsoft.2023.105726</pub-id>
      <fpage>105726</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-johnson2023comprehensive">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
        <name><surname>Fang</surname><given-names>Shiqi</given-names></name>
        <name><surname>Sankarasubramanian</surname><given-names>Arumugam</given-names></name>
        <name><surname>Rad</surname><given-names>Arash Modaresi</given-names></name>
        <name><surname>Kindl da Cunha</surname><given-names>Luciana</given-names></name>
        <name><surname>Jennings</surname><given-names>Keith S</given-names></name>
        <name><surname>Clarke</surname><given-names>Keith C</given-names></name>
        <name><surname>Mazrooei</surname><given-names>Amir</given-names></name>
        <name><surname>Yeghiazarian</surname><given-names>Lilit</given-names></name>
      </person-group>
      <article-title>Comprehensive analysis of the NOAA National Water Model: A call for heterogeneous formulations and diagnostic model selection</article-title>
      <source>Journal of Geophysical Research: Atmospheres</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>128</volume>
      <issue>24</issue>
      <pub-id pub-id-type="doi">10.1029/2023JD038534</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-afshari2017statistical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Afshari</surname><given-names>Shahab</given-names></name>
        <name><surname>Fekete</surname><given-names>Balazs M</given-names></name>
        <name><surname>Dingman</surname><given-names>S Lawrence</given-names></name>
        <name><surname>Devineni</surname><given-names>Naresh</given-names></name>
        <name><surname>Bjerklie</surname><given-names>David M</given-names></name>
        <name><surname>Khanbilvardi</surname><given-names>Reza M</given-names></name>
      </person-group>
      <article-title>Statistical filtering of river survey and streamflow data for improving At-A-Station hydraulic geometry relations</article-title>
      <source>Journal of Hydrology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>547</volume>
      <pub-id pub-id-type="doi">10.1016/j.jhydrol.2017.01.038</pub-id>
      <fpage>443</fpage>
      <lpage>454</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bieger2015development">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bieger</surname><given-names>Katrin</given-names></name>
        <name><surname>Rathjens</surname><given-names>Hendrik</given-names></name>
        <name><surname>Allen</surname><given-names>Peter M</given-names></name>
        <name><surname>Arnold</surname><given-names>Jeffrey G</given-names></name>
      </person-group>
      <article-title>Development and evaluation of bankfull hydraulic geometry relationships for the physiographic regions of the United States</article-title>
      <source>JAWRA Journal of the American Water Resources Association</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>51</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1111/jawr.12282</pub-id>
      <fpage>842</fpage>
      <lpage>858</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bieger2016development">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bieger</surname><given-names>Katrin</given-names></name>
        <name><surname>Rathjens</surname><given-names>Hendrik</given-names></name>
        <name><surname>Arnold</surname><given-names>Jeffrey G</given-names></name>
        <name><surname>Chaubey</surname><given-names>Indrajeet</given-names></name>
        <name><surname>Allen</surname><given-names>Peter M</given-names></name>
      </person-group>
      <article-title>Development and comparison of multiple regression models to predict bankfull channel dimensions for use in hydrologic models</article-title>
      <source>JAWRA Journal of the American Water Resources Association</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>52</volume>
      <issue>6</issue>
      <pub-id pub-id-type="doi">10.1111/1752-1688.12460</pub-id>
      <fpage>1385</fpage>
      <lpage>1400</lpage>
    </element-citation>
  </ref>
  <ref id="ref-owpsi2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
        <name><surname>Coll</surname><given-names>JM</given-names></name>
        <name><surname>Maidment</surname><given-names>DR</given-names></name>
        <name><surname>Cohen</surname><given-names>S</given-names></name>
        <name><surname>Nelson</surname><given-names>J</given-names></name>
        <name><surname>Ogden</surname><given-names>F</given-names></name>
        <name><surname>Praskievicz</surname><given-names>S</given-names></name>
        <name><surname>Clark</surname><given-names>EP</given-names></name>
      </person-group>
      <article-title>National Water Center Innovators Program Summer Institute Report 2017</article-title>
      <source>Consortium of Universities for the Advancement of Hydrologic Science, Inc., Technical Report</source>
      <year iso-8601-date="2017">2017</year>
      <issue>14</issue>
      <pub-id pub-id-type="doi">10.4211/technical.20171009</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-cosgrove2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cosgrove</surname><given-names>Brian</given-names></name>
        <name><surname>Gochis</surname><given-names>David</given-names></name>
        <name><surname>Flowers</surname><given-names>Trey</given-names></name>
        <name><surname>Dugger</surname><given-names>Aubrey</given-names></name>
        <name><surname>Ogden</surname><given-names>Fred</given-names></name>
        <name><surname>Graziano</surname><given-names>Tom</given-names></name>
        <name><surname>Clark</surname><given-names>Ed</given-names></name>
        <name><surname>Cabell</surname><given-names>Ryan</given-names></name>
        <name><surname>Casiday</surname><given-names>Nick</given-names></name>
        <name><surname>Cui</surname><given-names>Zhengtao</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>NOAA’s National Water Model: Advancing operational hydrology through continental-scale modeling</article-title>
      <source>JAWRA Journal of the American Water Resources Association</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <pub-id pub-id-type="doi">10.1111/1752-1688.13184</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-archfield2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Archfield</surname><given-names>Stacey A</given-names></name>
        <name><surname>Clark</surname><given-names>Martyn</given-names></name>
        <name><surname>Arheimer</surname><given-names>Berit</given-names></name>
        <name><surname>Hay</surname><given-names>Lauren E</given-names></name>
        <name><surname>McMillan</surname><given-names>Hilary</given-names></name>
        <name><surname>Kiang</surname><given-names>Julie E</given-names></name>
        <name><surname>Seibert</surname><given-names>Jan</given-names></name>
        <name><surname>Hakala</surname><given-names>Kirsti</given-names></name>
        <name><surname>Bock</surname><given-names>Andrew</given-names></name>
        <name><surname>Wagener</surname><given-names>Thorsten</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Accelerating advances in continental domain hydrologic modeling</article-title>
      <source>Water Resources Research</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>51</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1002/2015WR017498</pub-id>
      <fpage>10078</fpage>
      <lpage>10091</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fang2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fang</surname><given-names>Shiqi</given-names></name>
        <name><surname>Johnson</surname><given-names>JM</given-names></name>
        <name><surname>Yeghiazarian</surname><given-names>Lilit</given-names></name>
        <name><surname>Sankarasubramanian</surname><given-names>A</given-names></name>
      </person-group>
      <article-title>Improved National-Scale Above-Normal Flow Prediction for Gauged and Ungauged Basins Using a Spatio-Temporal Hierarchical Model</article-title>
      <source>Water Resources Research</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>60</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1029/2023WR034557</pub-id>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
