<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">5688</article-id>
<article-id pub-id-type="doi">10.21105/joss.05688</article-id>
<title-group>
<article-title>surtvep: An R package for estimating time-varying
effects</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Luo</surname>
<given-names>Lingfeng</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wu</surname>
<given-names>Wenbo</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Taylor</surname>
<given-names>Jeremy M. G.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kang</surname>
<given-names>Jian</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kleinsasser</surname>
<given-names>Michael J.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>He</surname>
<given-names>Kevin</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Biostatistics, School of Public Health,
University of Michigan</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Departments of Population Health and Medicine, New York
University Grossman School of Medicine</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<volume>9</volume>
<issue>98</issue>
<fpage>5688</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>survival</kwd>
<kwd>time-varying effects</kwd>
<kwd>penalization</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>The <monospace>surtvep</monospace> package is an open-source
  software designed for estimating time-varying effects in survival
  analysis using the Cox non-proportional hazards model in R. With the
  rapid increase in large-scale time-to-event data from national disease
  registries, detecting and accounting for time-varying effects in
  medical studies have become crucial. Current software solutions often
  face computational issues such as memory limitations when handling
  large datasets. Furthermore, modeling time-varying effects for
  time-to-event data can be challenging due to small at-risk sets and
  numerical instability near the end of the follow-up period.
  <monospace>surtvep</monospace> addresses these challenges by
  implementing a computationally efficient Kronecker product-based
  proximal algorithm, supporting both unstratified and stratified
  models. The package also incorporates P-spline and smoothing spline
  penalties to improve estimation
  (<xref alt="Eilers &amp; Marx, 1996" rid="ref-eilers1996flexible" ref-type="bibr">Eilers
  &amp; Marx, 1996</xref>). Cross-validation and information criteria
  are available to determine the optimal tuning parameters. Parallel
  computation is enabled to further enhance computational efficiency. A
  variety of operating characteristics are provided, including estimated
  time-varying effects, confidence intervals, hypothesis testing, and
  estimated hazard functions and survival probabilities. The
  <monospace>surtvep</monospace> package thus offers a comprehensive and
  flexible solution to analyzing large-scale time-to-event data with
  dynamic effect trajectories.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>The Cox non-proportional hazards model is a flexible and powerful
  tool for modeling time-varying effects of covariates in survival
  analysis. However, as the size of a dataset increases, the
  computational costs of this model can become substantial. Current
  software solutions, which may be effective for smaller datasets, face
  challenges when handling larger datasets.</p>
  <p>Numerous studies have demonstrated the widespread presence of
  time-varying effects. For instance, the scientific literature has
  shown that factors like age, sex, and race can have non-constant
  associations with survival in cases such as end-stage renal disease
  (<xref alt="He et al., 2017" rid="ref-he2017modeling" ref-type="bibr">He
  et al., 2017</xref>,
  <xref alt="2022" rid="ref-he2022stratified" ref-type="bibr">2022</xref>),
  and breast cancer patients receiving neo-adjuvant chemotherapy and
  head and neck cancer patients
  (<xref alt="Baulies et al., 2015" rid="ref-baulies2015time" ref-type="bibr">Baulies
  et al., 2015</xref>;
  <xref alt="Brouwer et al., 2020" rid="ref-brouwer2020time" ref-type="bibr">Brouwer
  et al., 2020</xref>). Ignoring the variations and relying solely on
  the Cox proportional hazards model can lead to inaccurate risk
  prediction and suboptimal treatment development.</p>
  <p>With the rising need for modeling time-varying effects, researchers
  have developed methods to handle the complex and dynamic nature of
  such data
  (<xref alt="Gray, 1992" rid="ref-gray1992flexible" ref-type="bibr">Gray,
  1992</xref>,
  <xref alt="1994" rid="ref-gray1994spline" ref-type="bibr">1994</xref>;
  <xref alt="Hastie &amp; Tibshirani, 1993" rid="ref-hastie1993varying" ref-type="bibr">Hastie
  &amp; Tibshirani, 1993</xref>;
  <xref alt="Zucker &amp; Karr, 1990" rid="ref-zucker1990nonparametric" ref-type="bibr">Zucker
  &amp; Karr, 1990</xref>). In terms of implementation, these methods
  expand the original data in a repeated measurement format
  (<xref alt="Therneau et al., 2017" rid="ref-therneau2017using" ref-type="bibr">Therneau
  et al., 2017</xref>) using existing software such as the
  <monospace>survival</monospace> package
  (<xref alt="Therneau, 2023" rid="ref-survival-package" ref-type="bibr">Therneau,
  2023</xref>). Even with moderate sample sizes, this leads to a large
  and computationally burdensome working dataset.
  <monospace>surtvep</monospace> addresses this issue by implementing a
  computationally efficient Kronecker product-based proximal algorithm
  (<xref alt="Perperoglou et al., 2006" rid="ref-perperoglou2006fast" ref-type="bibr">Perperoglou
  et al., 2006</xref>), which can handle time-varying effects in
  large-scale studies with improved efficiency and parallel computing
  capabilities. Compared with existing computational packages for Cox
  non-proportional hazards models, such as the
  <monospace>coxph</monospace> function, <monospace>surtvep</monospace>
  demonstrates a much more efficient performance, with both runtime and
  memory consumption reduced considerably.</p>
  <p>Another issue of numerical instability arises when analyzing data
  with binary covariates that have limited variation.
  <monospace>surtvep</monospace> implements a proximal Newton’s method
  to improve the estimation. Additionally, adding a penalty can improve
  the estimation. <monospace>surtvep</monospace> also supports P-spline
  and smoothing spline
  (<xref alt="Eilers &amp; Marx, 1996" rid="ref-eilers1996flexible" ref-type="bibr">Eilers
  &amp; Marx, 1996</xref>;
  <xref alt="Wood, 2017a" rid="ref-wood2017generalized" ref-type="bibr">Wood,
  2017a</xref>,
  <xref alt="2017b" rid="ref-wood2017p" ref-type="bibr">2017b</xref>),
  to further improve estimation stability. The improved estimation
  performance of <monospace>surtvep</monospace> is demonstrated in our
  recent studies
  (<xref alt="Luo et al., 2023" rid="ref-lfluo2023smmr" ref-type="bibr">Luo
  et al., 2023</xref>;
  <xref alt="Wu et al., 2022" rid="ref-wu2022scalable" ref-type="bibr">Wu
  et al., 2022</xref>).</p>
  <p>Finally, our method has several other features worth noting. First,
  <monospace>surtvep</monospace> supports the stratified model, which
  enables researchers to account for differences in baseline hazard
  functions across distinct clusters or other grouping factors. This is
  particularly useful when there are distinct subgroups within the data
  that may have different baseline hazards. Second,
  <monospace>surtvep</monospace> enables shared-memory parallel
  computation features, which can significantly improve the performance
  of the software when working with large datasets. Also,
  <monospace>surtvep</monospace> supports Breslow approximation
  (<xref alt="Breslow, 1974" rid="ref-breslow1974covariance" ref-type="bibr">Breslow,
  1974</xref>), which significantly improves the computational speed
  when a large number of ties are present. The functions and workflow of
  the <monospace>surtvep</monospace> package are summarized in the
  flowchart in
  <xref alt="[fig:flowchart]" rid="figU003Aflowchart">[fig:flowchart]</xref>.</p>
</sec>
<sec id="functions">
  <title>Functions</title>
  <fig>
    <caption><p>Flowchart for functions in the
    <monospace>surtvep</monospace> package. <monospace>coxtv</monospace>
    utilizes proximal Newton’s method to estimate the time-varying
    coefficients. <monospace>coxtp</monospace> combines the Newton’s
    approach with penalization. <monospace>IC</monospace> calculates
    different information criteria to select the best tuning parameter
    in front of the penalty term. <monospace>cv.coxtp</monospace> uses
    cross-validation for tuning parameter selection.
    <monospace>tvef.ph</monospace>, <monospace>tvef.ph.time</monospace>
    and <monospace>tvef.ph.zero</monospace> provide hypothesis testing
    for the fitted model. <monospace>get.tvef</monospace> retrieves the
    time-varying coefficients for the fitted model.
    <monospace>confint</monospace> provides confidence intervals for
    these coefficients. <monospace>baseline</monospace> offers the
    baseline hazard estimations. <monospace>plot</monospace> visualizes
    the estimated time-varying coefficients.
    <styled-content id="figU003Aflowchart"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="Flowchart.pdf" />
  </fig>
  <p><monospace>surtvep</monospace> is a powerful statistical software
  package designed for analyzing time-varying effects of time-to-event
  data. The software offers two main functions for estimating
  time-varying coefficients in survival analysis.</p>
  <p>To model time-varying coefficients in
  <monospace>surtvep</monospace>, we first define the time-varying
  coefficients as <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{\beta}(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>𝛃</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  which represents the effects of predictors at different time points.
  We then use a set of B-spline basis functions to span the
  <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{\beta}(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>𝛃</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  which provides a flexible and accurate way to capture the
  time-dependent effects of the predictors. These B-spline basis
  functions are generated using the <monospace>splines</monospace> R
  package with a fixed number of basis functions. While the effect of
  the predictors vary with time, the predictors are assumed to have a
  linear relationship with the outcome.</p>
  <p>Once we have established the basis functions for the time-varying
  coefficients, <monospace>coxtv</monospace> employs a proximal Newton’s
  approach to estimate the coefficients in front of the B-spline basis
  functions. This approach iteratively updates the coefficients until a
  maximum of the log-partial likelihood is reached. Backtracking line
  search is utilized to improve the estimation. We have also implemented
  a shared-memory parallelization to enable faster convergence.</p>
  <p><monospace>coxtp</monospace> is the second main function, adding a
  penalty term to the original objective function. This approach
  iteratively updates the coefficients until a maximum of the penalized
  log-partial likelihood is reached. <monospace>coxtp</monospace>
  provides two options for penalized regression: P-spline and smoothing
  spline.</p>
  <list list-type="bullet">
    <list-item>
      <p>P-spline stands for penalized B-spline. It combines the
      B-spline basis with a discrete quadratic penalty on the difference
      of basis coefficients between adjacent knots. When the penalty
      term goes to infinity, the time-varying effects are reduced to be
      constant.</p>
    </list-item>
    <list-item>
      <p>Smoothing spline is a derivative-based penalty combined with
      B-spline. When the cubic B-spline is used for constructing the
      basis functions, the smoothing spline penalizes the second-order
      derivative, which reduces the time-varying effect to a linear term
      when the penalty term goes to infinity. When the quadratic
      B-spline is used for constructing the basis functions, the
      smoothing spline penalizes the first-order derivative, which
      reduces the time-varying effect to a constant when the penalty
      term goes to infinity. See Wood
      (<xref alt="2017b" rid="ref-wood2017p" ref-type="bibr">2017b</xref>)
      for details.</p>
    </list-item>
  </list>
  <p><monospace>surtvep</monospace> also provides a function
  <monospace>IC</monospace> to select the best tuning parameter in front
  of the penalty term. <monospace>IC</monospace> can be used to
  calculate the modified Akaike information criterion (mAIC), the
  Takeuchi information criterion (TIC) and the generalized information
  criterion (GIC)
  (<xref alt="Akaike, 1998" rid="ref-akaike1998information" ref-type="bibr">Akaike,
  1998</xref>;
  <xref alt="Luo et al., 2023" rid="ref-lfluo2023smmr" ref-type="bibr">Luo
  et al., 2023</xref>;
  <xref alt="Takeuchi, 1976" rid="ref-takeuchi1976distribution" ref-type="bibr">Takeuchi,
  1976</xref>). Generally, mAIC, TIC and GIC have relatively similar
  performance. Using one of these criteria to select tuning parameters
  is considerably faster than using cross-validation, which is also
  provided in <monospace>surtvep</monospace> via function
  <monospace>cv.coxtp</monospace>.</p>
  <p>Finally, <monospace>surtvep</monospace> offers a comprehensive
  suite of hypothesis testing capabilities, allowing researchers to
  assess the validity and significance of their models
  (<xref alt="Wu et al., 2022" rid="ref-wu2022scalable" ref-type="bibr">Wu
  et al., 2022</xref>). Specifically, <monospace>surtvep</monospace> can
  perform the following hypothesis tests: (1) testing the proportional
  hazards assumption to verify the model’s suitability for the given
  data; and (2) examining the pointwise significance of covariate
  effects at different event times to assess the impact of each
  covariate on the outcome of interest. To conduct these hypothesis
  tests, <monospace>surtvep</monospace> employs the Wald test statistic,
  a widely-used method for inference.</p>
</sec>
<sec id="quick-start">
  <title>Quick Start</title>
  <p>The purpose of this section is to introduce the basics of
  <monospace>surtvep</monospace>. Interested users are referred to the
  online tutorial at
  <ext-link ext-link-type="uri" xlink:href="https://um-kevinhe.github.io/surtvep/articles/surtvep.html"><italic>https://um-kevinhe.github.io/surtvep/articles/surtvep.html</italic></ext-link>
  for detailed instructions.</p>
  <p><monospace>surtvep</monospace> can be easily installed by launching
  an R prompt and running the following commands:</p>
  <code language="r script">install.packages('surtvep')
library(surtvep)</code>
  <p>Next, we load an example data set that includes two columns
  <monospace>z</monospace> of continuous covariates, a column
  <monospace>time</monospace> indicating the time to an event, and a
  column “event” of event indicators.</p>
  <code language="r script">data(&quot;ExampleData&quot;)
z     &lt;- ExampleData$z
time  &lt;- ExampleData$time
event &lt;- ExampleData$event</code>
  <p>We can fit the Newton’s method without penalization using the most
  basic call to <monospace>coxtv</monospace>. For the Newton’s method
  with penalization, we call the <monospace>coxtp</monospace>
  function.</p>
  <code language="r script">fit.tv &lt;- coxtv(z = z, event = event, time = time)
fit.penalize &lt;- coxtp(z = z, event = event, time = time)</code>
  <p>We use <monospace>IC</monospace> to calculate the information
  criteria and select the best tuning parameter:</p>
  <code language="r script">fit.ic &lt;- IC(fit.penalize)</code>
  <p><monospace>fit.tv</monospace> is an object of class
  <monospace>coxtv</monospace> that contains all the relevant
  information of the fitted model for further use.
  <monospace>fit.ic</monospace> contains three objects of class
  <monospace>coxtp</monospace>, corresponding to the selected model
  using mAIC, TIC and GIC. Various methods are provided for the objects
  such as plotting and hypothesis testing.</p>
  <p>The code below generates
  <xref alt="[fig:coxtv]" rid="figU003Acoxtv">[fig:coxtv]</xref>, which
  visualizes the time-varying coefficients from
  <monospace>coxtv</monospace> and <monospace>coxtp</monospace>:</p>
  <code language="r script">plot(fit.tv, ylim = c(-3,10))
plot(fit.ic$model.mAIC, ylim = c(-3,10))</code>
  <fig>
    <caption><p>The estimated time-varying coefficients (log hazard
    ratio) from <monospace>coxtv</monospace> and
    <monospace>coxtp</monospace>. The tuning parameter for
    <monospace>coxtp</monospace> is selected using mAIC.
    <styled-content id="figU003Acoxtv"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="coxtv_tp.png" />
  </fig>
  <p>In utilizing the <monospace>coxtv</monospace> and
  <monospace>coxtp</monospace> functions, users have the flexibility to
  choose based on their dataset’s specifications. Numerical
  instabilities are commonly encountered when analyzing survival data of
  a small sample size or when the data includes some binary covariates
  with proportions that approach either zero or one. In these scenarios,
  the second-order information matrix can become ill-conditioned. See
  discussion in
  (<xref alt="Luo et al., 2023" rid="ref-lfluo2023smmr" ref-type="bibr">Luo
  et al., 2023</xref>;
  <xref alt="Wu et al., 2022" rid="ref-wu2022scalable" ref-type="bibr">Wu
  et al., 2022</xref>). To address this issue, the employment of the
  penalized method <monospace>coxtp</monospace> is recommended. When
  determining the number of basis functions, a typical range is between
  5-10. Though the choice is somewhat flexible, it has limited impact on
  results unless set too small
  (<xref alt="Gray, 1992" rid="ref-gray1992flexible" ref-type="bibr">Gray,
  1992</xref>). Users might consider increasing this number when
  applying the penalized method.</p>
  <p>Currently, both <monospace>coxtv</monospace> and
  <monospace>coxtp</monospace> assume time-varying effects for all
  covariates. We primarily focus on low-dimensional settings (where the
  number of covariates is much smaller than the sample size) and support
  only right-censored survival data. Future releases will expand these
  capabilities.</p>
</sec>
<sec id="data-example">
  <title>Data Example</title>
  <p>We demonstrate the effectiveness of <monospace>surtvep</monospace>
  by applying it to a real-world dataset from the National Cancer
  Institute Surveillance, Epidemiology, and End Results (SEER) Program
  (<xref alt="National Cancer Institute, 2019" rid="ref-SEER" ref-type="bibr">National
  Cancer Institute, 2019</xref>). We estimate the hazard ratios of the
  cancer stage of kidney, lung, and breast, as shown in
  <xref alt="[fig:example]" rid="figU003Aexample">[fig:example]</xref>.
  Our analysis highlights the dynamic nature of hazard ratios for cancer
  death among patients with metastatic stage compared to those with
  localized stage. Access to SEER data can be requested at
  https://seer.cancer.gov/data/access.html for those interested.</p>
  <p>In the first year after diagnosis, the hazard ratio is strikingly
  high, indicating a significant difference in survival outcomes between
  metastatic and localized stage patients. However, this disparity
  shrinks considerably by the eighth year, reflecting the diminishing
  relevance of the initial cancer stage in the prognosis of long-term
  survivors. This example illustrates the importance of accounting for
  time-varying effects, which has been effectively addressed by
  <monospace>surtvep</monospace> through its flexible and efficient
  approach to modeling these dynamics. By providing accurate and
  efficient modeling of time-varying effects in large-scale datasets,
  <monospace>surtvep</monospace> serves as a valuable tool for
  researchers working with complex survival data.</p>
  <fig>
    <caption><p>Time-varying effects of cancer stage in SEER data.
    <styled-content id="figU003Aexample"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="hr_appendix_stage_joss.png" />
  </fig>
</sec>
<sec id="availability">
  <title>Availability</title>
  <p>Stable releases of the <monospace>surtvep</monospace> package will
  be made available via the Comprehensive R Archive Network.
  Alternatively, the <monospace>surtvep</monospace> package is available
  on GitHub
  <ext-link ext-link-type="uri" xlink:href="https://github.com/UM-KevinHe/surtvep">(<italic>https://github.com/UM-KevinHe/surtvep</italic>)</ext-link>.
  Use of the <monospace>surtvep</monospace> package has been extensively
  documented in the package documentation and on the tutorial website
  <ext-link ext-link-type="uri" xlink:href="https://um-kevinhe.github.io/surtvep/index.html">(<italic>https://um-kevinhe.github.io/surtvep/index.html</italic>)</ext-link>.</p>
</sec>
<sec id="funding">
  <title>Funding</title>
  <p>This project was partially supported by the US National Cancer
  Institute (R01CA-129102) and National Institute of Diabetes and
  Digestive and Kidney Diseases (R01DK-129539).</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-baulies2015time">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Baulies</surname><given-names>S</given-names></name>
        <name><surname>Belin</surname><given-names>L</given-names></name>
        <name><surname>Mallon</surname><given-names>P</given-names></name>
        <name><surname>Senechal</surname><given-names>C</given-names></name>
        <name><surname>Pierga</surname><given-names>JY</given-names></name>
        <name><surname>Cottu</surname><given-names>P</given-names></name>
        <name><surname>Sablin</surname><given-names>MP</given-names></name>
        <name><surname>Sastre</surname><given-names>X</given-names></name>
        <name><surname>Asselain</surname><given-names>B</given-names></name>
        <name><surname>Rouzier</surname><given-names>R</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Time-varying effect and long-term survival analysis in breast cancer patients treated with neoadjuvant chemotherapy</article-title>
      <source>British journal of cancer</source>
      <publisher-name>Nature Publishing Group</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>113</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1038/bjc.2015.174</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361/201322068</pub-id>
      <fpage>30</fpage>
      <lpage>36</lpage>
    </element-citation>
  </ref>
  <ref id="ref-brouwer2020time">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brouwer</surname><given-names>Andrew F</given-names></name>
        <name><surname>He</surname><given-names>Kevin</given-names></name>
        <name><surname>Chinn</surname><given-names>Steven B</given-names></name>
        <name><surname>Mondul</surname><given-names>Alison M</given-names></name>
        <name><surname>Chapman</surname><given-names>Christina H</given-names></name>
        <name><surname>Ryser</surname><given-names>Marc D</given-names></name>
        <name><surname>Banerjee</surname><given-names>Mousumi</given-names></name>
        <name><surname>Eisenberg</surname><given-names>Marisa C</given-names></name>
        <name><surname>Meza</surname><given-names>Rafael</given-names></name>
        <name><surname>Taylor</surname><given-names>Jeremy MG</given-names></name>
      </person-group>
      <article-title>Time-varying survival effects for squamous cell carcinomas at oropharyngeal and nonoropharyngeal head and neck sites in the United States, 1973-2015</article-title>
      <source>Cancer</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>126</volume>
      <issue>23</issue>
      <uri>https://doi.org/10.1002/cncr.33174</uri>
      <pub-id pub-id-type="doi">10.1002/cncr.33174</pub-id>
      <fpage>5137</fpage>
      <lpage>5146</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zucker1990nonparametric">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zucker</surname><given-names>David M</given-names></name>
        <name><surname>Karr</surname><given-names>Alan F</given-names></name>
      </person-group>
      <article-title>Nonparametric survival analysis with time-dependent covariate effects: A penalized partial likelihood approach</article-title>
      <source>The Annals of Statistics</source>
      <publisher-name>Institute of Mathematical Statistics</publisher-name>
      <year iso-8601-date="1990">1990</year>
      <volume>18</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1214/aos/1176347503</uri>
      <pub-id pub-id-type="doi">10.1214/aos/1176347503</pub-id>
      <fpage>329</fpage>
      <lpage>353</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hastie1993varying">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hastie</surname><given-names>Trevor</given-names></name>
        <name><surname>Tibshirani</surname><given-names>Robert</given-names></name>
      </person-group>
      <article-title>Varying-coefficient models</article-title>
      <source>Journal of the Royal Statistical Society: Series B (Methodological)</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="1993">1993</year>
      <volume>55</volume>
      <issue>4</issue>
      <uri>https://doi.org/10.1111/j.2517-6161.1993.tb01939.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.2517-6161.1993.tb01939.x</pub-id>
      <fpage>757</fpage>
      <lpage>779</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gray1992flexible">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gray</surname><given-names>Robert J</given-names></name>
      </person-group>
      <article-title>Flexible methods for analyzing survival data using splines, with applications to breast cancer prognosis</article-title>
      <source>Journal of the American Statistical Association</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="1992">1992</year>
      <volume>87</volume>
      <issue>420</issue>
      <uri>https://doi.org/10.2307/2290630</uri>
      <pub-id pub-id-type="doi">10.2307/2290630</pub-id>
      <fpage>942</fpage>
      <lpage>951</lpage>
    </element-citation>
  </ref>
  <ref id="ref-therneau2017using">
    <element-citation publication-type="webpage">
      <person-group person-group-type="author">
        <name><surname>Therneau</surname><given-names>Terry</given-names></name>
        <name><surname>Crowson</surname><given-names>Cindy</given-names></name>
        <name><surname>Atkinson</surname><given-names>Elizabeth</given-names></name>
      </person-group>
      <article-title>Using time dependent covariates and time dependent coefficients in the Cox model</article-title>
      <publisher-name>Survival Vignettes</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>2</volume>
      <uri>https://stat.ethz.ch/R-manual/R-patched/library/survival/doc/timedep.pdf</uri>
      <fpage>1</fpage>
      <lpage>25</lpage>
    </element-citation>
  </ref>
  <ref id="ref-survival-package">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Therneau</surname><given-names>Terry</given-names></name>
      </person-group>
      <source>A package for survival analysis in R</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://CRAN.R-project.org/package=survival</uri>
    </element-citation>
  </ref>
  <ref id="ref-wu2022scalable">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wu</surname><given-names>Wenbo</given-names></name>
        <name><surname>Taylor</surname><given-names>Jeremy MG</given-names></name>
        <name><surname>Brouwer</surname><given-names>Andrew F</given-names></name>
        <name><surname>Luo</surname><given-names>Lingfeng</given-names></name>
        <name><surname>Kang</surname><given-names>Jian</given-names></name>
        <name><surname>Jiang</surname><given-names>Hui</given-names></name>
        <name><surname>He</surname><given-names>Kevin</given-names></name>
      </person-group>
      <article-title>Scalable proximal methods for cause-specific hazard modeling with time-varying coefficients</article-title>
      <source>Lifetime data analysis</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>28</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1007/s10985-021-09544-2</uri>
      <pub-id pub-id-type="doi">10.1007/s10985-021-09544-2</pub-id>
      <fpage>194</fpage>
      <lpage>218</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wood2017generalized">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Wood</surname><given-names>Simon N</given-names></name>
      </person-group>
      <source>Generalized Additive Models: An Introduction with R, Second Edition</source>
      <publisher-name>CRC Press</publisher-name>
      <year iso-8601-date="2017">2017</year>
    </element-citation>
  </ref>
  <ref id="ref-wood2017p">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wood</surname><given-names>Simon N</given-names></name>
      </person-group>
      <article-title>P-splines with derivative based penalties and tensor product smoothing of unevenly distributed data</article-title>
      <source>Statistics and Computing</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>27</volume>
      <uri>https://doi.org/10.1007/s11222-016-9666-x</uri>
      <pub-id pub-id-type="doi">10.1007/s11222-016-9666-x</pub-id>
      <fpage>985</fpage>
      <lpage>989</lpage>
    </element-citation>
  </ref>
  <ref id="ref-SEER">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>National Cancer Institute</string-name>
      </person-group>
      <article-title>Surveillance, Epidemiology, and End Results (SEER) Program. SEER*Stat Database</article-title>
      <publisher-name>https://www.seer.cancer.gov</publisher-name>
      <year iso-8601-date="2019">2019</year>
    </element-citation>
  </ref>
  <ref id="ref-akaike1998information">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Akaike</surname><given-names>Hirotogu</given-names></name>
      </person-group>
      <article-title>Information theory and an extension of the maximum likelihood principle</article-title>
      <source>Selected Papers of Hirotogu Akaike</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="1998">1998</year>
      <uri>https://doi.org/10.1007/978-1-4612-0919-5_38</uri>
      <pub-id pub-id-type="doi">10.1007/978-1-4612-0919-5_38</pub-id>
      <fpage>199</fpage>
      <lpage>213</lpage>
    </element-citation>
  </ref>
  <ref id="ref-eilers1996flexible">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Eilers</surname><given-names>Paul HC</given-names></name>
        <name><surname>Marx</surname><given-names>Brian D</given-names></name>
      </person-group>
      <article-title>Flexible smoothing with B-splines and penalties</article-title>
      <source>Statistical science</source>
      <publisher-name>Institute of Mathematical Statistics</publisher-name>
      <year iso-8601-date="1996">1996</year>
      <volume>11</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1214/ss/1038425655</uri>
      <pub-id pub-id-type="doi">10.1214/ss/1038425655</pub-id>
      <fpage>89</fpage>
      <lpage>121</lpage>
    </element-citation>
  </ref>
  <ref id="ref-takeuchi1976distribution">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Takeuchi</surname><given-names>Kei</given-names></name>
      </person-group>
      <article-title>Distribution of an information statistic and the criterion for the optimal model</article-title>
      <source>Mathematical Science</source>
      <year iso-8601-date="1976">1976</year>
      <volume>153</volume>
      <fpage>12</fpage>
      <lpage>18</lpage>
    </element-citation>
  </ref>
  <ref id="ref-perperoglou2006fast">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Perperoglou</surname><given-names>Aris</given-names></name>
        <name><surname>Cessie</surname><given-names>Saskia le</given-names></name>
        <name><surname>Houwelingen</surname><given-names>Hans C van</given-names></name>
      </person-group>
      <article-title>A fast routine for fitting Cox models with time varying effects of the covariates</article-title>
      <source>Computer methods and programs in biomedicine</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2006">2006</year>
      <volume>81</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1016/j.cmpb.2005.11.006</uri>
      <pub-id pub-id-type="doi">10.1016/j.cmpb.2005.11.006</pub-id>
      <fpage>154</fpage>
      <lpage>161</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lfluo2023smmr">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Luo</surname><given-names>Lingfeng</given-names></name>
        <name><surname>He</surname><given-names>Kevin</given-names></name>
        <name><surname>Wu</surname><given-names>Wenbo</given-names></name>
        <name><surname>Taylor</surname><given-names>Jeremy MG</given-names></name>
      </person-group>
      <article-title>Using information criteria to select smoothing parameters when analyzing survival data with time-varying coefficient hazard models</article-title>
      <source>Statistical methods in medical research</source>
      <year iso-8601-date="2023">2023</year>
      <volume>32</volume>
      <issue>9</issue>
      <uri>https://doi.org/10.1177/09622802231181471</uri>
      <pub-id pub-id-type="doi">10.1177/09622802231181471</pub-id>
      <fpage>1664</fpage>
      <lpage>1679</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gray1994spline">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gray</surname><given-names>Robert J</given-names></name>
      </person-group>
      <article-title>Spline-based tests in survival analysis</article-title>
      <source>Biometrics</source>
      <publisher-name>JSTOR</publisher-name>
      <year iso-8601-date="1994">1994</year>
      <volume>50</volume>
      <issue>3</issue>
      <uri>https://doi.org/10.2307/2532779</uri>
      <pub-id pub-id-type="doi">10.2307/2532779</pub-id>
      <fpage>640</fpage>
      <lpage>652</lpage>
    </element-citation>
  </ref>
  <ref id="ref-breslow1974covariance">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Breslow</surname><given-names>Norman</given-names></name>
      </person-group>
      <article-title>Covariance analysis of censored survival data</article-title>
      <source>Biometrics</source>
      <publisher-name>JSTOR</publisher-name>
      <year iso-8601-date="1974">1974</year>
      <volume>30</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.2307/2529620</uri>
      <pub-id pub-id-type="doi">10.2307/2529620</pub-id>
      <fpage>89</fpage>
      <lpage>99</lpage>
    </element-citation>
  </ref>
  <ref id="ref-he2017modeling">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>He</surname><given-names>Kevin</given-names></name>
        <name><surname>Yang</surname><given-names>Yuan</given-names></name>
        <name><surname>Li</surname><given-names>Yanming</given-names></name>
        <name><surname>Zhu</surname><given-names>Ji</given-names></name>
        <name><surname>Li</surname><given-names>Yi</given-names></name>
      </person-group>
      <article-title>Modeling time-varying effects with large-scale survival data: An efficient quasi-Newton approach</article-title>
      <source>Journal of Computational and Graphical Statistics</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>26</volume>
      <issue>3</issue>
      <uri>https://doi.org/10.1080/10618600.2016.1237364</uri>
      <pub-id pub-id-type="doi">10.1080/10618600.2016.1237364</pub-id>
      <fpage>635</fpage>
      <lpage>645</lpage>
    </element-citation>
  </ref>
  <ref id="ref-he2022stratified">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>He</surname><given-names>Kevin</given-names></name>
        <name><surname>Zhu</surname><given-names>Ji</given-names></name>
        <name><surname>Kang</surname><given-names>Jian</given-names></name>
        <name><surname>Li</surname><given-names>Yi</given-names></name>
      </person-group>
      <article-title>Stratified Cox models with time-varying effects for national kidney transplant patients: A new blockwise steepest ascent method</article-title>
      <source>Biometrics</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>78</volume>
      <issue>3</issue>
      <uri>https://doi.org/10.1111/biom.13473</uri>
      <pub-id pub-id-type="doi">10.1111/biom.13473</pub-id>
      <fpage>1221</fpage>
      <lpage>1232</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
