<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6057</article-id>
<article-id pub-id-type="doi">10.21105/joss.06057</article-id>
<title-group>
<article-title>CLPFUDatabase: A suite of R packages for energy
conversion chain analysis</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7438-214X</contrib-id>
<name>
<surname>Heun</surname>
<given-names>Matthew Kuperus</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9260-7827</contrib-id>
<name>
<surname>Marshall</surname>
<given-names>Zeke</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5964-6776</contrib-id>
<name>
<surname>Aramendia</surname>
<given-names>Emmanuel</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Engineering Department, Calvin University</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>School of Earth and Environment, University of
Leeds</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>School for Public Leadership, Stellenbosch
University</institution>
</institution-wrap>
</aff>
</contrib-group>
<volume>9</volume>
<issue>93</issue>
<fpage>6057</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>energy</kwd>
<kwd>exergy</kwd>
<kwd>R</kwd>
<kwd>matrix mathematics</kwd>
<kwd>energy efficiency</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Energy flowing through societal energy conversion chains (ECCs)
  enables economic activity and facilitates human flourishing. To
  understand economic growth and human well-being, the field of societal
  energy analysis
  (<xref alt="Common, 1976" rid="ref-CommonU003A1976wn" ref-type="bibr">Common,
  1976</xref>) evaluates ECCs from the primary stage (resources
  extracted from the environment, such as coal, oil, natural gas, wind,
  and solar), to the final stage (energy purchased by consumers, such as
  refined petroleum and electricity), to the useful stage (energy
  desired by the end user, such as heat, motion, and light), and
  sometimes to energy services (such as thermal comfort, transport, and
  illumination). Societal <italic>exergy</italic> analysis (SEA)
  (<xref alt="Ertesvåg, 2001" rid="ref-ErtesvaagU003A2001" ref-type="bibr">Ertesvåg,
  2001</xref>), an extension of societal <italic>energy</italic>
  analysis, quantifies ECCs in exergy
  terms<xref ref-type="fn" rid="fn1">1</xref>.</p>
  <p>We created a suite of open-source <monospace>R</monospace> packages
  and the metapackage
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/CLPFUDatabase">CLPFUDatabase</ext-link>
  (<xref alt="Heun, 2023a" rid="ref-Heun-CLPFUDatabaseU003A2023" ref-type="bibr">Heun,
  2023a</xref>) to assist SEA practitioners to analyze ECCs. The new
  packages enable analysis of any country in the world across timespans
  of decades or longer. In short, the new packages enable, for the first
  time, scalable SEA. We used the new packages to create the CL-PFU
  database<xref ref-type="fn" rid="fn2">2</xref>, a new resource for the
  SEA community
  (<xref alt="Brockway et al., 2024" rid="ref-BrockwayU003A2024aa" ref-type="bibr">Brockway
  et al., 2024</xref>).</p>
  <p>This paper describes the design of the new packages and
  demonstrates briefly their use.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Historically, SEA practitioners have analyzed the ECCs of
  individual countries using linked spreadsheets, often starting with
  primary- and final-stage data from the
  <ext-link ext-link-type="uri" xlink:href="https://www.iea.org">International
  Energy Agency</ext-link>’s (IEA’s)
  <ext-link ext-link-type="uri" xlink:href="https://www.iea.org/data-and-statistics/data-product/world-energy-balances">Extended
  World Energy Balances</ext-link> (EWEBs)
  (<xref alt="Ayres et al., 2003" rid="ref-AyresU003A2003ec" ref-type="bibr">Ayres
  et al., 2003</xref>;
  <xref alt="Brockway et al., 2014" rid="ref-BrockwayU003A2014aa" ref-type="bibr">Brockway
  et al., 2014</xref>,
  <xref alt="2015" rid="ref-BrockwayU003A2015aa" ref-type="bibr">2015</xref>;
  <xref alt="Serrenho et al., 2014" rid="ref-SerrenhoU003A2014aa" ref-type="bibr">Serrenho
  et al., 2014</xref>). Data were stored in varying and inconsistent
  formats. An early SEA database
  (<xref alt="De Stercke, 2014" rid="ref-De-SterckeU003A2014" ref-type="bibr">De
  Stercke, 2014</xref>) estimated energy efficiencies of end-use
  machines using the economic status of countries, thereby precluding
  use in energy-economy studies.</p>
  <p>The authors of the current paper and others in the field wanted to
  expand SEA to cover all countries, but the spreadsheet approach to SEA
  was deemed not scalable. A new approach to SEA was needed, one that
  scaled across all countries for many years without relying on economic
  data to estimate machine efficiencies.</p>
</sec>
<sec id="design-of-r-packages">
  <title>Design of <monospace>R</monospace> packages</title>
  <p>The most important design decision for the suite of
  <monospace>R</monospace> packages involved data format. We authors are
  among those who developed the Physical Supply-Use Table (PSUT)
  framework
  (<xref alt="Aramendia et al., 2022" rid="ref-AramendiaU003A2022tv" ref-type="bibr">Aramendia
  et al., 2022</xref>;
  <xref alt="Guevara &amp; Domingos, 2017" rid="ref-GuevaraU003A2017" ref-type="bibr">Guevara
  &amp; Domingos, 2017</xref>;
  <xref alt="Heun et al., 2018" rid="ref-HeunU003A2018" ref-type="bibr">Heun
  et al., 2018</xref>;
  <xref alt="Rocco, 2016" rid="ref-RoccoU003A2016" ref-type="bibr">Rocco,
  2016</xref>), an adaptation of economic Input-Output (IO) analysis
  (<xref alt="Miller &amp; Blair, 2009" rid="ref-MillerU003A2009" ref-type="bibr">Miller
  &amp; Blair, 2009</xref>) to describe energy flows through society.
  The Physical Supply-Use Table (PSUT) framework is a matrix-based
  approach that tracks energy flows (“products” in PSUT terminology)
  from resource extraction to processing stages (“industries” in PSUT
  terminology) and, ultimately, to final demand in a way that is
  compatible with the
  <ext-link ext-link-type="uri" xlink:href="https://www.iea.org">IEA</ext-link>’s
  <ext-link ext-link-type="uri" xlink:href="https://www.iea.org/data-and-statistics/data-product/world-energy-balances">EWEB</ext-link>
  data
  (<xref alt="International Energy Agency, 2023" rid="ref-International-Energy-AgencyU003A2023aa" ref-type="bibr">International
  Energy Agency, 2023</xref>). We chose the PSUT framework as the data
  format for the new <monospace>R</monospace> packages, because it
  succinctly describes an entire ECC for one country and one year via a
  set of six matrices (the “RUVY” matrices). See the following
  table.</p>
  <table-wrap>
    <table>
      <colgroup>
        <col width="12%" />
        <col width="16%" />
        <col width="26%" />
        <col width="46%" />
      </colgroup>
      <thead>
        <tr>
          <th align="left">Matrix</th>
          <th align="left">rows x columns</th>
          <th align="left">Name</th>
          <th align="left">Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left"><bold>R</bold></td>
          <td align="left">industry x product</td>
          <td align="left">Resource matrix</td>
          <td align="left">Contains exogeneous energy inputs to an
          ECC</td>
        </tr>
        <tr>
          <td align="left"><bold>U</bold></td>
          <td align="left">product x industry</td>
          <td align="left">Use matrix</td>
          <td align="left">Describes how each energy conversion device
          uses energy; the sum of <bold>U</bold><sub>feed</sub> and
          <bold>U</bold><sub>EIOU</sub></td>
        </tr>
        <tr>
          <td align="left"><bold>U</bold><sub>feed</sub></td>
          <td align="left">product x industry</td>
          <td align="left">Feedstock use matrix</td>
          <td align="left">Describes feedstock inputs to energy
          conversion devices</td>
        </tr>
        <tr>
          <td align="left"><bold>U</bold><sub>EOIU</sub></td>
          <td align="left">product x industry</td>
          <td align="left">Energy industry own use matrix</td>
          <td align="left">Describes how the energy industry uses
          energy</td>
        </tr>
        <tr>
          <td align="left"><bold>V</bold></td>
          <td align="left">industry x product</td>
          <td align="left">Make matrix</td>
          <td align="left">Describes how each energy conversion device
          makes energy</td>
        </tr>
        <tr>
          <td align="left"><bold>Y</bold></td>
          <td align="left">product x industry</td>
          <td align="left">Final demand matrix</td>
          <td align="left">Describes how each energy carrier is
          consumed</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p>Further development followed selection of the PSUT framework.
  First, the RUVY matrices carry the challenge that different countries
  and years have varying energy carriers (products) and varying energy
  conversion machines (industries), meaning that RUVY matrices have
  differing row names, differing column names, and differing sizes from
  one country to another and for different years within the same
  country. To circumvent this challenge, we created the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/matsbyname">matsbyname</ext-link>
  package
  (<xref alt="Heun, 2023b" rid="ref-Heun-matsbynameU003A2023" ref-type="bibr">Heun,
  2023b</xref>) which enables matrix mathematics that respects row and
  column names, inserting <bold>0</bold> row or column vectors when
  needed. Second, we wanted to be able to perform
  <italic>matrix</italic> mathematics as easily as
  <italic>scalar</italic> mathematics in <monospace>R</monospace> data
  frames using
  <ext-link ext-link-type="uri" xlink:href="https://www.tidyverse.org">tidyverse</ext-link>
  syntax
  (<xref alt="Wickham et al., 2019" rid="ref-WickhamU003A2019" ref-type="bibr">Wickham
  et al., 2019</xref>). We developed the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/matsindf">matsindf</ext-link>
  package
  (<xref alt="Heun, 2023c" rid="ref-Heun-matsindfU003A2023" ref-type="bibr">Heun,
  2023c</xref>) to enable this functionality. Finally, manipulating row
  and column names proved to be a challenge, especially for RUVY
  matrices in
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/matsindf">matsindf</ext-link>
  data frames, so we developed the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/RCLabels">RCLabels</ext-link>
  package
  (<xref alt="Heun, 2023g" rid="ref-Heun-RCLabelsU003A2023" ref-type="bibr">Heun,
  2023g</xref>) to support the PSUT framework. The table below
  summarizes these packages, all of which are generally useful and
  available on
  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org">CRAN</ext-link>.</p>
  <table-wrap>
    <table>
      <colgroup>
        <col width="50%" />
        <col width="50%" />
      </colgroup>
      <thead>
        <tr>
          <th align="left">Package</th>
          <th align="left">Purpose</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/RCLabels">RCLabels</ext-link></td>
          <td align="left">Manipulates matrix row and column names in
          <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/matsindf">matsindf</ext-link>
          data frames</td>
        </tr>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/matsbyname">matsbyname</ext-link></td>
          <td align="left">Performs matrix mathematics that respects row
          and column names</td>
        </tr>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/matsindf">matsindf</ext-link></td>
          <td align="left">Stores matrices in cells of data frames,
          thereby enabling analyses with
          <ext-link ext-link-type="uri" xlink:href="https://www.tidyverse.org">tidyverse</ext-link>
          syntax</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p>Broadly speaking, four calculation steps are required to create a
  CL-PFU database. Each step is assisted by functions in one or more of
  the new <monospace>R</monospace> packages. First, the IEA’s primary-
  and final-stage EWEB data must be converted to RUVY matrices for each
  country and year, a task accomplished by functions in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/IEATools">IEATools</ext-link>
  package
  (<xref alt="Heun et al., 2023" rid="ref-Heun-IEAToolsU003A2023" ref-type="bibr">Heun
  et al., 2023</xref>). Second, human and animal muscle work must be
  calculated from
  <ext-link ext-link-type="uri" xlink:href="https://www.ilo.org/">International
  Labor Organization</ext-link> (ILO) and
  <ext-link ext-link-type="uri" xlink:href="https://www.fao.org/">Food
  and Agriculture Organization</ext-link> (FAO) data, following the
  methodology of Steenwyk et al.
  (<xref alt="2022" rid="ref-SteenwykU003A2022ww" ref-type="bibr">2022</xref>),
  using functions in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/MWTools">MWTools</ext-link>
  package
  (<xref alt="Marshall &amp; Heun, 2023" rid="ref-MarshallU003A2023ab" ref-type="bibr">Marshall
  &amp; Heun, 2023</xref>). The muscle work data must also be converted
  to RUVY matrices. Third, the IEA’s primary- and final-stage ECC data
  must be extended to the useful stage by (a) allocating final stage
  energy to end-use machines and (b) multiplying allocated final energy
  by the final-to-useful efficiency of each machine. This task is
  accomplished by functions in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/Recca">Recca</ext-link>
  package
  (<xref alt="Heun &amp; Aramendia, 2023" rid="ref-Heun-ReccaU003A2023" ref-type="bibr">Heun
  &amp; Aramendia, 2023</xref>). Fourth, ECCs must be converted from
  energy terms to exergy terms. This step is also performed by functions
  in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/Recca">Recca</ext-link>
  package.</p>
  <p>The steps to create the PSUT matrices for each country and each
  year are accomplished by a
  <ext-link ext-link-type="uri" xlink:href="https://docs.ropensci.org/targets">targets</ext-link>
  (<xref alt="Landau, 2021" rid="ref-LandauU003A2021aa" ref-type="bibr">Landau,
  2021</xref>) computation pipeline available in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUPipeline">PFUPipeline</ext-link>
  package
  (<xref alt="Heun &amp; Marshall, 2023" rid="ref-Heun-PFUPipelineU003A2023" ref-type="bibr">Heun
  &amp; Marshall, 2023</xref>). A unique feature of the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUPipeline">PFUPipeline</ext-link>
  enabled by the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/Recca">Recca</ext-link>
  package is an innovative exemplar system that allows analyses to
  proceed when allocation or efficiency data are unavailable for a
  country. When allocations or efficiencies are missing, a string of
  exemplar countries or regions are queried for the required
  information. For example, exemplars for Belgium are France, Europe,
  and ultimately, the World, in that order. The design of the
  calculation pipeline in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUPipeline">PFUPipeline</ext-link>
  package allows allocation and efficiency data for any country or year
  to be added at a later date to improve the database.</p>
  <p>A second
  <ext-link ext-link-type="uri" xlink:href="https://docs.ropensci.org/targets">targets</ext-link>
  pipeline in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUAggPipeline">PFUAggPipeline</ext-link>
  package
  (<xref alt="Heun, 2023d" rid="ref-Heun-PFUAggPipelineU003A2023" ref-type="bibr">Heun,
  2023d</xref>) aggregates ECCs (a) by region (e.g., continents and
  world), (b) by energy carrier (product) category (e.g., Coal and coal
  products, Low-, Medium-, and High-temperature heat, etc.), (c) by
  energy conversion machines (industries) and/or end use sectors (e.g.,
  Residential, Transport, etc.), and (d) to primary, final, and useful
  (PFU) stages. In addition, the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUAggPipeline">PFUAggPipeline</ext-link>
  calculates efficiencies for each country at all available
  aggregations. The
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUAggPipeline">PFUAggPipeline</ext-link>
  uses the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/Recca">Recca</ext-link>
  package extensively.</p>
  <p>Both
  <ext-link ext-link-type="uri" xlink:href="https://docs.ropensci.org/targets">targets</ext-link>
  pipelines (in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUPipeline">PFUPipeline</ext-link>
  and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUAggPipeline">PFUAggPipeline</ext-link>
  packages) produce data frames readable by the
  <ext-link ext-link-type="uri" xlink:href="https://pins.rstudio.com">pins</ext-link>
  package
  (<xref alt="Silge et al., 2023" rid="ref-SilgaU003A2023" ref-type="bibr">Silge
  et al., 2023</xref>). Both pipelines benefit from the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUSetup">PFUSetup</ext-link>
  (<xref alt="Heun, 2023f" rid="ref-Heun-PFUSetupU003A2023" ref-type="bibr">Heun,
  2023f</xref>) and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUPipelineTools">PFUPipelineTools</ext-link>
  (<xref alt="Heun, 2023e" rid="ref-Heun-PFUPipelineToolsU003A2023" ref-type="bibr">Heun,
  2023e</xref>) packages.
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUSetup">PFUSetup</ext-link>
  identifies storage locations for pipeline input and output data.
  <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUPipelineTools">PFUPipelineTools</ext-link>
  provides functions and constants common to both pipelines.</p>
  <p>The packages in the following table support creation of the CL-PFU
  database and are available on GitHub.</p>
  <table-wrap>
    <table>
      <colgroup>
        <col width="50%" />
        <col width="50%" />
      </colgroup>
      <thead>
        <tr>
          <th align="left">Package</th>
          <th align="left">Purpose</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/IEATools">IEATools</ext-link></td>
          <td align="left">Converts
          <ext-link ext-link-type="uri" xlink:href="https://www.iea.org/data-and-statistics/data-product/world-energy-balances">IEA
          EWEB</ext-link> data to RUVY matrices in
          <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/matsindf">matsindf</ext-link>
          data frames</td>
        </tr>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/MWTools">MWTools</ext-link></td>
          <td align="left">Converts
          <ext-link ext-link-type="uri" xlink:href="https://www.ilo.org/">ILO</ext-link>
          and
          <ext-link ext-link-type="uri" xlink:href="https://www.fao.org/">FAO</ext-link>
          data to RUVY matrices of human and animal muscle work in
          <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/matsindf">matsindf</ext-link>
          data frames</td>
        </tr>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/Recca">Recca</ext-link></td>
          <td align="left">Performs <monospace>R</monospace> energy
          conversion chain analysis</td>
        </tr>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUSetup">PFUSetup</ext-link></td>
          <td align="left">Identifies input and output locations for the
          <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUPipeline">PFUPipeline</ext-link>
          and
          <ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUAggPipeline">PFUAggPipeline</ext-link>
          pipelines</td>
        </tr>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUPipelineTools">PFUPipelineTools</ext-link></td>
          <td align="left">Provides basic functionality for all PFU
          pipelines</td>
        </tr>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUPipeline">PFUPipeline</ext-link></td>
          <td align="left">Provides a
          <ext-link ext-link-type="uri" xlink:href="https://docs.ropensci.org/targets">targets</ext-link>
          pipeline to create a data frame of RUVY matrices</td>
        </tr>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/PFUAggPipeline">PFUAggPipeline</ext-link></td>
          <td align="left">Provides a
          <ext-link ext-link-type="uri" xlink:href="https://docs.ropensci.org/targets">targets</ext-link>
          pipeline to aggregate RUVY matrices</td>
        </tr>
        <tr>
          <td align="left"><ext-link ext-link-type="uri" xlink:href="https://github.com/EnergyEconomyDecoupling/CLPFUDatabase">CLPFUDatabase</ext-link></td>
          <td align="left">A metapackage (like
          <monospace>tidyverse</monospace>) to quickly load all package
          dependencies for the CL-PFU database</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p>Example input data for the CL-PFU database (for two countries and
  two years) can be found in the GitHub repository for this paper.
  Access to the full CL-PFU database can be obtained via correspondence
  with author
  <ext-link ext-link-type="uri" xlink:href="mailto:P.E.Brockway@leeds.ac.uk">P.E.B.</ext-link><xref ref-type="fn" rid="fn3">3</xref>.
  If desired, researchers with access to the
  <ext-link ext-link-type="uri" xlink:href="https://www.iea.org">IEA</ext-link>’s
  <ext-link ext-link-type="uri" xlink:href="https://www.iea.org/data-and-statistics/data-product/world-energy-balances">EWEB</ext-link>
  data can create their own CL-PFU database following the example
  below.</p>
</sec>
<sec id="example">
  <title>Example</title>
  <code language="r script"># (0) Use the CLPFUDatabase metapackage to install all dependencies.
#     This metapackage installation step is needed only once.
devtools::install_github(&quot;EnergyEconomyDecoupling/CLPFUDatabase&quot;)

# (1) Purchase, download, and store IEA EWEB data in the correct location.
#     Sample data for two countries (Ghana and South Africa) 
#     and two years (1971 and 2000) are included (with permission)
#     at the correct location in the repository for this paper.

# (2) Download FAO and ILO data for muscle work calculations
#     via the included script.
#     This download step is needed only once, and
#     downloaded data are stored in the repository 
#     for this paper.
source(file.path(&quot;ExampleFolder&quot;, &quot;DownloadScripts&quot;, &quot;download_mw_data.R&quot;))

# Steps (3) and (4) to construct the database are needed only once.
# Results are stored in the targets cache 
# located in the &quot;_targets&quot; folder
# at the root level of this repository.

# (3) Run the PFUPipeline to create RUVY matrices.
targets::tar_make_future(
  script = file.path(&quot;ExampleFolder&quot;, &quot;_targets_pfupipeline.R&quot;), 
  workers = 4
)

# (4) Run the PFUAggPipeline to aggregate 
#     energy and calculate efficiencies.
targets::tar_make_future(
  script = file.path(&quot;ExampleFolder&quot;, &quot;_targets_pfuaggpipeline.R&quot;),
  workers = 4
)</code>
  <code language="r script"># (5) Review results using the pins package.
#     Establish the pinboard.
pinboard &lt;- file.path(&quot;ExampleFolder&quot;, &quot;OutputData&quot;, &quot;PipelineReleases&quot;) |&gt; 
  pins::board_folder(versioned = TRUE)
#     Look at the psut data frame
#     created by the PFUPipeline.
psut &lt;- pinboard |&gt;
  pins::pin_read(name = &quot;psut&quot;, version = &quot;20231219T204403Z-2c3ce&quot;)
head(as.data.frame(psut), 2)</code>
  <preformat>## Loading required package: Matrix</preformat>
  <preformat>##   Country Method Energy.type Last.stage Year IEAMW
## 1     GHA    PCM           E      Final 1971   IEA
## 2     GHA    PCM           E      Final 2000   IEA
##                                                        R
## 1 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
## 2 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
##                                                        U
## 1 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
## 2 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
##                                                   U_feed
## 1 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
## 2 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
##                                                   U_EIOU
## 1 &lt;S4 class 'dgeMatrix' [package &quot;Matrix&quot;] with 4 slots&gt;
## 2 &lt;S4 class 'dgeMatrix' [package &quot;Matrix&quot;] with 4 slots&gt;
##                                                   r_EIOU
## 1 &lt;S4 class 'dgeMatrix' [package &quot;Matrix&quot;] with 4 slots&gt;
## 2 &lt;S4 class 'dgeMatrix' [package &quot;Matrix&quot;] with 4 slots&gt;
##                                                        V
## 1 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
## 2 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
##                                                        Y
## 1 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
## 2 &lt;S4 class 'dgCMatrix' [package &quot;Matrix&quot;] with 6 slots&gt;
##                                                  S_units
## 1 &lt;S4 class 'dgeMatrix' [package &quot;Matrix&quot;] with 4 slots&gt;
## 2 &lt;S4 class 'dgeMatrix' [package &quot;Matrix&quot;] with 4 slots&gt;</preformat>
  <code language="r script">#     Each column of the psut data frame contains sparse matrices, 
#     the columns of which are suppressed on display.
#     Show the column names here.
colnames(psut$R[[1]])</code>
  <preformat>##  [1] &quot;Aviation gasoline&quot;                      
##  [2] &quot;Crude oil&quot;                              
##  [3] &quot;Electricity&quot;                            
##  [4] &quot;Fuel oil&quot;                               
##  [5] &quot;Gas/diesel oil excl. biofuels&quot;          
##  [6] &quot;Hydro [from Resources]&quot;                 
##  [7] &quot;Kerosene type jet fuel excl. biofuels&quot;  
##  [8] &quot;Lubricants&quot;                             
##  [9] &quot;Other kerosene&quot;                         
## [10] &quot;Primary solid biofuels [from Resources]&quot;</preformat>
  <code language="r script">#     Show an example resource (R) matrix.
psut$R[[1]]</code>
  <preformat>## 9 x 10 sparse Matrix of class &quot;dgCMatrix&quot;</preformat>
  <preformat>##   [[ suppressing 10 column names 'Aviation gasoline', 'Crude oil', 'Electricity' ... ]]</preformat>
  <preformat>##                                                                             
## Imports [of Aviation gasoline]                     44.7988     .      .     
## Imports [of Crude oil]                              .      38359.8007 .     
## Imports [of Kerosene type jet fuel excl. biofuels]  .          .      .     
## Imports [of Lubricants]                             .          .      .     
## Imports [of Other kerosene]                         .          .      .     
## Resources [of Hydro]                                .          .      .     
## Resources [of Primary solid biofuels]               .          .      .     
## Statistical differences                             .          0.0001 0.0084
## Stock changes [of Gas/diesel oil excl. biofuels]    .          .      .     
##                                                                           
## Imports [of Aviation gasoline]                     .        .          .  
## Imports [of Crude oil]                             .        .          .  
## Imports [of Kerosene type jet fuel excl. biofuels] .        .          .  
## Imports [of Lubricants]                            .        .          .  
## Imports [of Other kerosene]                        .        .          .  
## Resources [of Hydro]                               .        .      10472.4
## Resources [of Primary solid biofuels]              .        .          .  
## Statistical differences                             1e-04 822.6979     .  
## Stock changes [of Gas/diesel oil excl. biofuels]   .      476.2987     .  
##                                                                             
## Imports [of Aviation gasoline]                       .        .       .     
## Imports [of Crude oil]                               .        .       .     
## Imports [of Kerosene type jet fuel excl. biofuels] 892.0019   .       .     
## Imports [of Lubricants]                              .      755.9979  .     
## Imports [of Other kerosene]                          .        .      43.7981
## Resources [of Hydro]                                 .        .       .     
## Resources [of Primary solid biofuels]                .        .       .     
## Statistical differences                              .        .       0.0042
## Stock changes [of Gas/diesel oil excl. biofuels]     .        .       .     
##                                                         
## Imports [of Aviation gasoline]                         .
## Imports [of Crude oil]                                 .
## Imports [of Kerosene type jet fuel excl. biofuels]     .
## Imports [of Lubricants]                                .
## Imports [of Other kerosene]                            .
## Resources [of Hydro]                                   .
## Resources [of Primary solid biofuels]              87400
## Statistical differences                                .
## Stock changes [of Gas/diesel oil excl. biofuels]       .</preformat>
  <code language="r script">#     Review the aggregate PFU efficiency data frame
#     created by the PFUAggPipeline.
agg_eta_pfu &lt;- pinboard |&gt; 
  pins::pin_read(name = &quot;agg_eta_pfu&quot;, version = &quot;20231211T161827Z-8f5e7&quot;)
agg_eta_pfu |&gt; 
#     Filter and delete columns 
#     to present a subset of exergy results in a data frame.
#     The EX.p, EX.f, and EX.u columns contain aggregate exergy at
#     primary, final, and useful stages, respectively, in TJ.
#     The eta_pf, eta_fu, and eta_pu columns contain aggregate
#     primary-to-final, final-to-useful, and 
#     primary-to-useful efficiencies.
  dplyr::filter(Energy.type == &quot;X&quot;, IEAMW == &quot;Both&quot;, 
                Product.aggregation == &quot;Specified&quot;, 
                Industry.aggregation == &quot;Specified&quot;, 
                GrossNet == &quot;Net&quot;,
                Country %in% c(&quot;GHA&quot;, &quot;ZAF&quot;)) |&gt; 
  dplyr::mutate(
    Method = NULL, 
    Energy.type = NULL,
    Product.aggregation = NULL,
    Industry.aggregation = NULL,
    IEAMW = NULL,
    Chopped.mat = NULL, 
    Chopped.var = NULL, 
    GrossNet = NULL
  )</code>
  <preformat>## # A tibble: 8 × 9
##   Country Last.stage  Year     EX.p     EX.f    EX.u eta_pf eta_fu eta_pu
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1 GHA     Final       1971  179666.  139694.  16853.  0.778  0.121 0.0938
## 2 GHA     Useful      1971  179666.  139694.  16853.  0.778  0.121 0.0938
## 3 GHA     Final       2000  344825.  274173.  56749.  0.795  0.207 0.165 
## 4 GHA     Useful      2000  344825.  274173.  56749.  0.795  0.207 0.165 
## 5 ZAF     Final       1971 2138435. 1525335. 211670.  0.713  0.139 0.0990
## 6 ZAF     Useful      1971 2138435. 1525335. 211670.  0.713  0.139 0.0990
## 7 ZAF     Final       2000 4957435. 2451131. 482533.  0.494  0.197 0.0973
## 8 ZAF     Useful      2000 4957435. 2451131. 482533.  0.494  0.197 0.0973</preformat>
</sec>
<sec id="conclusion">
  <title>Conclusion</title>
  <p>The new open source <monospace>R</monospace> packages described in
  this paper enable, for the first time, creation of databases of
  primary, final, and useful energy and exergy conversion chains in a
  scalable manner. Such databases will enable advances in societal
  exergy analysis and lead to new insights about the role of energy in
  economic growth and human well-being. An example of early work using
  the CL-PFU database is the calculation of useful stage Energy Return
  On Investment (EROI) for fossil fuels
  (<xref alt="Aramendia et al., 2023" rid="ref-AramendiaU003A2023aa" ref-type="bibr">Aramendia
  et al., 2023</xref>), for which the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/earamendia/ECCTools">ECCTools</ext-link>
  (<xref alt="Aramendia &amp; Heun, 2022a" rid="ref-AramendiaU003A2022aa" ref-type="bibr">Aramendia
  &amp; Heun, 2022a</xref>) and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/earamendia/EROITools">EROITools</ext-link>
  (<xref alt="Aramendia &amp; Heun, 2022b" rid="ref-AramendiaU003A2022ab" ref-type="bibr">Aramendia
  &amp; Heun, 2022b</xref>) packages were developed, expanding the
  software capabilities introduced
  here<xref ref-type="fn" rid="fn4">4</xref>.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>M.K.H. acknowledges the support of Calvin University for a
  sabbatical during which he developed the PSUT framework and course
  releases during which he wrote many of the <monospace>R</monospace>
  packages described in this paper. Z.M.’s time was funded by the UK
  Research Council under EPSRC Fellowship award EP/R024254/1. E.A.’s
  time was funded by the University of Leeds (School of Earth and
  Environment). M.K.H., Z.M., and E.A. are grateful for support and
  encouragement from Dr. Paul E. Brockway (University of Leeds). It was
  Dr. Brockway’s EPSRC fellowship that provided the need for the
  software described in this paper.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-Heun-RCLabelsU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>RCLabels: Tools for munging and manipulating row and column labels on matrices</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.5819143</uri>
    </element-citation>
  </ref>
  <ref id="ref-BrockwayU003A2024aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brockway</surname><given-names>Paul E.</given-names></name>
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
        <name><surname>Marshall</surname><given-names>Zeke</given-names></name>
        <name><surname>Aramendia</surname><given-names>Emmanuel</given-names></name>
        <name><surname>Steenwyk</surname><given-names>Paul</given-names></name>
        <name><surname>Relph</surname><given-names>Thomas</given-names></name>
        <name><surname>Widjanarko</surname><given-names>Michelle</given-names></name>
        <name><surname>Kim</surname><given-names>Jeonghoo (James)</given-names></name>
        <name><surname>Sainju</surname><given-names>Anjana</given-names></name>
        <name><surname>Irtube</surname><given-names>Julian</given-names></name>
      </person-group>
      <article-title>A country-level primary-final-useful (CL-PFU) energy and exergy database: Overview of its construction and 1971–2020 world-level efficiency results</article-title>
      <source>Environmental Research: Energy</source>
      <year iso-8601-date="2024">2024</year>
      <fpage>(In review)</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-AramendiaU003A2022ab">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Aramendia</surname><given-names>Emmanuel</given-names></name>
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>EROITools: Tools for calculating and aggregating energy return on investment values</source>
      <year iso-8601-date="2022">2022</year>
      <uri>https://doi.org/10.5281/zenodo.7696869</uri>
    </element-citation>
  </ref>
  <ref id="ref-AramendiaU003A2022aa">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Aramendia</surname><given-names>Emmanuel</given-names></name>
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>ECCTools: Tools for modifying the energy conversion chain</source>
      <year iso-8601-date="2022">2022</year>
      <uri>https://doi.org/10.5281/zenodo.5841962</uri>
    </element-citation>
  </ref>
  <ref id="ref-AramendiaU003A2023aa">
    <element-citation publication-type="thesis">
      <person-group person-group-type="author">
        <name><surname>Aramendia</surname><given-names>Emmanuel</given-names></name>
        <name><surname>Brockway</surname><given-names>Paul</given-names></name>
        <name><surname>Taylor</surname><given-names>Peter</given-names></name>
        <name><surname>Norman</surname><given-names>J.</given-names></name>
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
        <name><surname>Marshall</surname><given-names>Zeke</given-names></name>
      </person-group>
      <article-title>Chapter 4: Estimation of fossil fuels useful stage energy return on investment and implications for renewable energy systems in Exploring the useful energy implications of the global energy transition: A net energy perspective</article-title>
      <publisher-name>University of Leeds</publisher-name>
      <year iso-8601-date="2023">2023</year>
    </element-citation>
  </ref>
  <ref id="ref-International-Energy-AgencyU003A2023aa">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>International Energy Agency</string-name>
      </person-group>
      <article-title>IEA World Extended Energy Balances</article-title>
      <publisher-name>https://www.iea.org/data-and-statistics/data-product/world-energy-balances</publisher-name>
      <year iso-8601-date="2023">2023</year>
    </element-citation>
  </ref>
  <ref id="ref-AramendiaU003A2022tv">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Aramendia</surname><given-names>Emmanuel</given-names></name>
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
        <name><surname>Brockway</surname><given-names>Paul E.</given-names></name>
        <name><surname>Taylor</surname><given-names>Peter G.</given-names></name>
      </person-group>
      <article-title>Developing a multi-regional physical supply use table framework to improve the accuracy and reliability of energy analysis</article-title>
      <source>Applied Energy</source>
      <year iso-8601-date="2022">2022</year>
      <volume>310</volume>
      <issue>118413</issue>
      <pub-id pub-id-type="doi">10.1016/j.apenergy.2021.118413</pub-id>
      <fpage>1</fpage>
      <lpage>20</lpage>
    </element-citation>
  </ref>
  <ref id="ref-AyresU003A2003ec">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ayres</surname><given-names>Robert U.</given-names></name>
        <name><surname>Ayres</surname><given-names>Leslie W.</given-names></name>
        <name><surname>Warr</surname><given-names>Benjamin</given-names></name>
      </person-group>
      <article-title>Exergy, power, and work in the US economy, 1900–1998</article-title>
      <source>Energy</source>
      <year iso-8601-date="2003-03">2003</year><month>03</month>
      <volume>28</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1016/s0360-5442(02)00089-0</pub-id>
      <fpage>219</fpage>
      <lpage>273</lpage>
    </element-citation>
  </ref>
  <ref id="ref-BrockwayU003A2014aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brockway</surname><given-names>Paul E.</given-names></name>
        <name><surname>Barrett</surname><given-names>John R.</given-names></name>
        <name><surname>Foxon</surname><given-names>Timothy J.</given-names></name>
        <name><surname>Steinberger</surname><given-names>Julia K.</given-names></name>
      </person-group>
      <article-title>Divergence of trends in US and UK aggregate exergy efficiencies 1960–2010</article-title>
      <source>Environmental Science &amp; Technology</source>
      <year iso-8601-date="2014">2014</year>
      <volume>48</volume>
      <pub-id pub-id-type="doi">10.1021/es501217t</pub-id>
      <fpage>9874</fpage>
      <lpage>9881</lpage>
    </element-citation>
  </ref>
  <ref id="ref-BrockwayU003A2015aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brockway</surname><given-names>Paul E.</given-names></name>
        <name><surname>Steinberger</surname><given-names>Julia K.</given-names></name>
        <name><surname>Barrett</surname><given-names>John R.</given-names></name>
        <name><surname>Foxon</surname><given-names>Timothy J.</given-names></name>
      </person-group>
      <article-title>Understanding China’s past and future energy demand: An exergy efficiency and decomposition analysis</article-title>
      <source>Applied Energy</source>
      <year iso-8601-date="2015">2015</year>
      <volume>155</volume>
      <pub-id pub-id-type="doi">10.1016/j.apenergy.2015.05.082</pub-id>
      <fpage>892</fpage>
      <lpage>903</lpage>
    </element-citation>
  </ref>
  <ref id="ref-CommonU003A1976wn">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Common</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>The economics of energy analysis reconsidered</article-title>
      <source>Energy Policy</source>
      <year iso-8601-date="1976">1976</year>
      <volume>4</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1016/0301-4215(76)90008-2</pub-id>
      <fpage>158</fpage>
      <lpage>165</lpage>
    </element-citation>
  </ref>
  <ref id="ref-De-SterckeU003A2014">
    <element-citation publication-type="report">
      <person-group person-group-type="author">
        <name><surname>De Stercke</surname><given-names>Simon</given-names></name>
      </person-group>
      <article-title>Dynamics of energy systems: A useful perspective</article-title>
      <publisher-name>IIASA</publisher-name>
      <publisher-loc>Laxenburg, Austria</publisher-loc>
      <year iso-8601-date="2014">2014</year>
    </element-citation>
  </ref>
  <ref id="ref-ErtesvaagU003A2001">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ertesvåg</surname><given-names>Ivar S.</given-names></name>
      </person-group>
      <article-title>Society exergy analysis: A comparison of different societies</article-title>
      <source>Energy</source>
      <year iso-8601-date="2001">2001</year>
      <volume>26</volume>
      <pub-id pub-id-type="doi">10.1016/s0360-5442(00)00070-0</pub-id>
      <fpage>253</fpage>
      <lpage>270</lpage>
    </element-citation>
  </ref>
  <ref id="ref-GuevaraU003A2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Guevara</surname><given-names>Zeus</given-names></name>
        <name><surname>Domingos</surname><given-names>Tiago</given-names></name>
      </person-group>
      <article-title>The multi-factor energy input–output model</article-title>
      <source>Energy Economics</source>
      <year iso-8601-date="2017">2017</year>
      <volume>61</volume>
      <pub-id pub-id-type="doi">10.1016/j.eneco.2016.11.020</pub-id>
      <fpage>261</fpage>
      <lpage>269</lpage>
    </element-citation>
  </ref>
  <ref id="ref-HeunU003A2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
        <name><surname>Owen</surname><given-names>Anne</given-names></name>
        <name><surname>Brockway</surname><given-names>Paul E.</given-names></name>
      </person-group>
      <article-title>A physical supply-use table framework for energy analysis on the energy conversion chain</article-title>
      <source>Applied Energy</source>
      <year iso-8601-date="2018-09">2018</year><month>09</month>
      <volume>226</volume>
      <pub-id pub-id-type="doi">10.1016/j.apenergy.2018.05.109</pub-id>
      <fpage>1134</fpage>
      <lpage>1162</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Heun-CLPFUDatabaseU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>CLPFUDatabase: Easily install and load packages to construct the CL-PFU database</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.10359832</uri>
    </element-citation>
  </ref>
  <ref id="ref-Heun-matsbynameU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>matsbyname: An implementation of matrix mathematics</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.5118872</uri>
    </element-citation>
  </ref>
  <ref id="ref-Heun-matsindfU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>matsindf: Matrices in data frames</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.5475443</uri>
    </element-citation>
  </ref>
  <ref id="ref-Heun-IEAToolsU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
        <name><surname>Aramendia</surname><given-names>Emmanuel</given-names></name>
        <name><surname>Marshall</surname><given-names>Zeke</given-names></name>
      </person-group>
      <source>IEATools: Tools for munging and manipulating IEA extended energy balance data</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.5086371</uri>
    </element-citation>
  </ref>
  <ref id="ref-MarshallU003A2023ab">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Marshall</surname><given-names>Zeke</given-names></name>
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>MWTools: Functions for calculation of muscle work within the PSUT framework</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.7584858</uri>
    </element-citation>
  </ref>
  <ref id="ref-Heun-ReccaU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
        <name><surname>Aramendia</surname><given-names>Emmanuel</given-names></name>
      </person-group>
      <source>Recca: R energy conversion chain analysis</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.5226085</uri>
    </element-citation>
  </ref>
  <ref id="ref-Heun-PFUSetupU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>PFUSetup: Automated setup for the PFU database project.</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.5228359</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.5228359</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Heun-PFUPipelineToolsU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>PFUPipelineTools: Tools for PFU pipelines</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.8226419</uri>
    </element-citation>
  </ref>
  <ref id="ref-Heun-PFUPipelineU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
        <name><surname>Marshall</surname><given-names>Zeke</given-names></name>
      </person-group>
      <source>PFUPipeline: Functions and workflows for primary-final-useful societal exergy analysis within the PSUT framework</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.5228375</uri>
    </element-citation>
  </ref>
  <ref id="ref-Heun-PFUAggPipelineU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
      </person-group>
      <source>PFUAggPipeline: Calculate aggregations and efficiencies for energy conversion chains in PSUT format</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://doi.org/10.5281/zenodo.6409759</uri>
    </element-citation>
  </ref>
  <ref id="ref-LandauU003A2021aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Landau</surname><given-names>William Michael</given-names></name>
      </person-group>
      <article-title>The targets R package: A dynamic make-like function-oriented pipeline toolkit for reproducibility and high-performance computing</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2021">2021</year>
      <volume>6</volume>
      <issue>57</issue>
      <pub-id pub-id-type="doi">10.21105/joss.02959</pub-id>
      <fpage>2959</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-RoccoU003A2016">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Rocco</surname><given-names>Matteo Vincenzo</given-names></name>
      </person-group>
      <source>Primary exergy cost of goods and services: An input–output approach</source>
      <publisher-name>Springer</publisher-name>
      <publisher-loc>Switzerland</publisher-loc>
      <year iso-8601-date="2016">2016</year>
    </element-citation>
  </ref>
  <ref id="ref-SciDirectU003A2023">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>ScienceDirect</surname></name>
      </person-group>
      <article-title>Exergy</article-title>
      <publisher-name>https://www.sciencedirect.com/topics/earth-and-planetary-sciences/exergy</publisher-name>
      <year iso-8601-date="2021">2021</year>
    </element-citation>
  </ref>
  <ref id="ref-SerrenhoU003A2014aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Serrenho</surname><given-names>André Cabrera</given-names></name>
        <name><surname>Sousa</surname><given-names>Tânia</given-names></name>
        <name><surname>Warr</surname><given-names>Benjamin</given-names></name>
        <name><surname>Ayres</surname><given-names>Robert U.</given-names></name>
        <name><surname>Domingos</surname><given-names>Tiago</given-names></name>
      </person-group>
      <article-title>Decomposition of useful work intensity: The EU (European Union)-15 countries from 1960 to 2009</article-title>
      <source>Energy</source>
      <year iso-8601-date="2014-11">2014</year><month>11</month>
      <volume>76</volume>
      <pub-id pub-id-type="doi">10.1016/j.energy.2014.08.068</pub-id>
      <fpage>704</fpage>
      <lpage>715</lpage>
    </element-citation>
  </ref>
  <ref id="ref-SilgaU003A2023">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Silge</surname><given-names>Julia</given-names></name>
        <name><surname>Wickham</surname><given-names>Hadley</given-names></name>
        <name><surname>Luraschi</surname><given-names>Javier</given-names></name>
      </person-group>
      <source>Pins: Pin, discover, and share resources</source>
      <year iso-8601-date="2023">2023</year>
      <uri>https://CRAN.R-project.org/package=pins</uri>
    </element-citation>
  </ref>
  <ref id="ref-SteenwykU003A2022ww">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Steenwyk</surname><given-names>Paul</given-names></name>
        <name><surname>Heun</surname><given-names>Matthew Kuperus</given-names></name>
        <name><surname>Brockway</surname><given-names>Paul</given-names></name>
        <name><surname>Sousa</surname><given-names>Tânia</given-names></name>
        <name><surname>Henriques</surname><given-names>Sofia</given-names></name>
      </person-group>
      <article-title>The contributions of muscle and machine work to land and labor productivity in world agriculture since 1800</article-title>
      <source>Biophysical Economics and Sustainability</source>
      <year iso-8601-date="2022">2022</year>
      <volume>7</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1007/s41247-022-00096-z</pub-id>
      <fpage>1</fpage>
      <lpage>17</lpage>
    </element-citation>
  </ref>
  <ref id="ref-WickhamU003A2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wickham</surname><given-names>Hadley</given-names></name>
        <name><surname>Averick</surname><given-names>Mara</given-names></name>
        <name><surname>Bryan</surname><given-names>Jennifer</given-names></name>
        <name><surname>Chang</surname><given-names>Winston</given-names></name>
        <name><surname>McGowan</surname><given-names>Lucy D’Agostino</given-names></name>
        <name><surname>François</surname><given-names>Romain</given-names></name>
        <name><surname>Grolemund</surname><given-names>Garrett</given-names></name>
        <name><surname>Hayes</surname><given-names>Alex</given-names></name>
        <name><surname>Henry</surname><given-names>Lionel</given-names></name>
        <name><surname>Hester</surname><given-names>Jim</given-names></name>
        <name><surname>Kuhn</surname><given-names>Max</given-names></name>
        <name><surname>Pedersen</surname><given-names>Thomas Lin</given-names></name>
        <name><surname>Miller</surname><given-names>Evan</given-names></name>
        <name><surname>Bache</surname><given-names>Stephan Milton</given-names></name>
        <name><surname>Müller</surname><given-names>Kirill</given-names></name>
        <name><surname>Ooms</surname><given-names>Jeroen</given-names></name>
        <name><surname>Robinson</surname><given-names>David</given-names></name>
        <name><surname>Seidel</surname><given-names>Dana Paige</given-names></name>
        <name><surname>Spinu</surname><given-names>Vitalie</given-names></name>
        <name><surname>Takahashi</surname><given-names>Kohske</given-names></name>
        <name><surname>Vaughan</surname><given-names>Davis</given-names></name>
        <name><surname>Wilke</surname><given-names>Claus</given-names></name>
        <name><surname>Woo</surname><given-names>Kara</given-names></name>
        <name><surname>Yutani</surname><given-names>Hiroaki</given-names></name>
      </person-group>
      <article-title>Welcome to the tidyverse</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>43</issue>
      <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id>
      <fpage>1686</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-MillerU003A2009">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Miller</surname><given-names>Ronald E.</given-names></name>
        <name><surname>Blair</surname><given-names>Peter D.</given-names></name>
      </person-group>
      <source>Input-output analysis: Foundations and extensions</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <publisher-loc>Cambridge, UK</publisher-loc>
      <year iso-8601-date="2009">2009</year>
      <edition>2nd</edition>
    </element-citation>
  </ref>
</ref-list>
<fn-group>
  <fn id="fn1">
    <label>1</label><p>Exergy is the mechanical work potential of
    energy. See any number of internet references for an exergy primer,
    including ScienceDirect
    (<xref alt="2021" rid="ref-SciDirectU003A2023" ref-type="bibr">2021</xref>).</p>
  </fn>
  <fn id="fn2">
    <label>2</label><p>“CL-PFU” is an initialism for “Country-Level
    Primary, Final, and Useful.” The CL-PFU database contains many
    countries as well as continental and world aggregations. Technically
    speaking, we create
    <ext-link ext-link-type="uri" xlink:href="https://github.com/MatthewHeun/matsindf">matsindf</ext-link>
    data frames stored as
    <ext-link ext-link-type="uri" xlink:href="https://pins.rstudio.com">pins</ext-link>
    on a pinboard, not SQL or similar databases.</p>
  </fn>
  <fn id="fn3">
    <label>3</label><p>Because the CL-PFU database contains primary and
    final energy
    <ext-link ext-link-type="uri" xlink:href="https://www.iea.org/data-and-statistics/data-product/world-energy-balances">IEA
    EWEB</ext-link> data, use of the CL-PFU database is restricted to
    those who have access to
    <ext-link ext-link-type="uri" xlink:href="https://www.iea.org">IEA</ext-link>
    <ext-link ext-link-type="uri" xlink:href="https://www.iea.org/data-and-statistics/data-product/world-energy-balances">EWEB</ext-link>
    data.</p>
  </fn>
  <fn id="fn4">
    <label>4</label><p>Note that the
    <ext-link ext-link-type="uri" xlink:href="https://github.com/earamendia/ECCTools">ECCTools</ext-link>
    and
    <ext-link ext-link-type="uri" xlink:href="https://github.com/earamendia/EROITools">EROITools</ext-link>
    packages are not the subject of this paper and were not peer
    reviewed.</p>
  </fn>
</fn-group>
</back>
</article>
