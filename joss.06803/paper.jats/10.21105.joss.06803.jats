<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6803</article-id>
<article-id pub-id-type="doi">10.21105/joss.06803</article-id>
<title-group>
<article-title>COBRAPRO: A MATLAB toolbox for Physics-based Battery
Modeling and Co-simulation Parameter Optimization</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0005-9878-3537</contrib-id>
<name>
<surname>Ha</surname>
<given-names>Sara</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6556-2608</contrib-id>
<name>
<surname>Onori</surname>
<given-names>Simona</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Mechanical Engineering, Stanford University, 440 Escondido
Mall, Stanford 94305, CA, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Energy Science and Engineering, Stanford University, 367
Panama Mall, Stanford 94305, CA, United States of America</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-03-01">
<day>1</day>
<month>3</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>104</issue>
<fpage>6803</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>lithium-ion batteries</kwd>
<kwd>physics-based modeling</kwd>
<kwd>DFN model</kwd>
<kwd>P2D model</kwd>
<kwd>parameter identification</kwd>
<kwd>particle swarm optimization</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>COBRAPRO (<bold>Co</bold>-simulation
  <bold>B</bold>atte<bold>r</bold>y Modeling for
  <bold>A</bold>ccelerated <bold>P</bold>a<bold>r</bold>ameter
  <bold>O</bold>ptimization) is a physics-based battery modeling
  software with the capability to perform closed-loop parameter
  optimization using experimental data. COBRAPRO is based on the
  Doyle-Fuller-Newman (DFN) model
  (<xref alt="Doyle et al., 1993" rid="ref-doyle_modeling_1993" ref-type="bibr">Doyle
  et al., 1993</xref>), which is the most widely accepted high-fidelity
  model that considers the lithium-ion transport and charge conservation
  in the liquid electrolyte and solid electrodes, and kinetics at the
  solid and liquid interface during lithium intercalation and
  deintercalation. Such physics-based models have found applications in
  battery design
  (<xref alt="Couto et al., 2023" rid="ref-couto_lithiumion_2023" ref-type="bibr">Couto
  et al., 2023</xref>;
  <xref alt="Dai &amp; Srinivasan, 2016" rid="ref-dai_graded_2016" ref-type="bibr">Dai
  &amp; Srinivasan, 2016</xref>) and advanced battery management systems
  to ensure reliable and safe operation of electric vehicles
  (<xref alt="Kolluri et al., 2020" rid="ref-kolluri_realtime_2020" ref-type="bibr">Kolluri
  et al., 2020</xref>). The DFN model relies on physical parameters such
  as geometric, stoichiometric, concentration, transport, and kinetic
  properties. Accurate parameter values are essential for the model to
  predict real battery behavior under various usage conditions. However,
  parameters obtained from cell teardown experiments cannot be directly
  applied
  (<xref alt="Ha &amp; Onori, 2024" rid="ref-ha_cobrapro_2024" ref-type="bibr">Ha
  &amp; Onori, 2024</xref>;
  <xref alt="Li et al., 2022" rid="ref-li_datadriven_2022" ref-type="bibr">Li
  et al., 2022</xref>), as the DFN model simplifies a real battery,
  assuming perfectly spherical particles, neglecting electrode
  heterogeneity, and considering internal dynamics only in one
  dimension. Parameter identification is therefore crucial for
  developing models that accurately capture battery dynamics. COBRAPRO
  enables users to identify these parameters for any battery using
  standard current-voltage data from a battery cycler, optimizing DFN
  parameters by minimizing the error between simulated and experimental
  results through an integrated optimization routine.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Although parameter calibration is required to accurately predict
  the dynamical behavior of real batteries, current DFN modeling tools
  lack the capability to perform parameter identification.</p>
  <p>COMSOL Multiphysics©
  (<xref alt="COMSOL AB, Stockholm, Sweden, 2023" rid="ref-comsol" ref-type="bibr">COMSOL
  AB, Stockholm, Sweden, 2023</xref>) is a commercially available finite
  element modeling software commonly used to simulate the DFN model.
  Although COMSOL lacks a built-in parameter identification feature, it
  was demonstrated that COMSOL’s <italic>LiveLink™ for MATLAB</italic>©
  can be used to establish communication between COMSOL and MATLAB for
  parameter optimization
  (<xref alt="Pozzato &amp; Onori, 2023" rid="ref-pozzato_general_2023" ref-type="bibr">Pozzato
  &amp; Onori, 2023</xref>). This framework allows users to leverage the
  versatile suite of optimizers in MATLAB while running COMSOL to
  generate the model output. However, the expensive licensing fee and
  proprietary nature of COMSOL create barriers to public access,
  limiting collaboration and code reproducibility.</p>
  <p>In contrast, several open-source DFN model simulation tools have
  emerged, such as PyBaMM
  (<xref alt="Sulzer et al., 2021" rid="ref-sulzer_python_2021" ref-type="bibr">Sulzer
  et al., 2021</xref>), LIONSIMBA
  (<xref alt="Torchio et al., 2016" rid="ref-torchio_lionsimba_2016" ref-type="bibr">Torchio
  et al., 2016</xref>), PETLION
  (<xref alt="Berliner et al., 2021" rid="ref-berliner_methods_2021" ref-type="bibr">Berliner
  et al., 2021</xref>), DEARLIBS
  (<xref alt="Lee &amp; Onori, 2021" rid="ref-lee_robust_2021" ref-type="bibr">Lee
  &amp; Onori, 2021</xref>), fastDFN
  (<xref alt="Scott Moura, 2016" rid="ref-fastDFN" ref-type="bibr">Scott
  Moura, 2016</xref>), and MPET
  (<xref alt="Smith &amp; Bazant, 2017" rid="ref-smith_multiphase_2017" ref-type="bibr">Smith
  &amp; Bazant, 2017</xref>). Among these packages, DEARLIBS is the only
  software equipped with a closed-loop parameter identification routine.
  Other open-source packages operate as open-loop software, requiring
  predefined parameters to simulate real battery behavior. Without
  parameter optimization capabilities, these open-loop tools typically
  depend on uncalibrated, experimentally measured parameters from the
  literature. Taking inspiration from DEARLIBS, COBRAPRO aims to address
  three primary challenges in the DFN model:</p>
  <sec id="challenge-1.-computational-complexity">
    <title>Challenge 1. Computational complexity</title>
    <list list-type="bullet">
      <list-item>
        <p><bold>Issue:</bold> The DFN model is also known as the
        pseudo-two-dimensional (P2D) model due to the coupling of the
        cell thickness (x-direction) and radial particle (r-direction)
        dimensions. This coupling of dimensions contributes to the
        model’s computational complexity.</p>
      </list-item>
      <list-item>
        <p><bold>Solution:</bold> COBRAPRO leverages the SUNDIALS IDA
        solver
        (<xref alt="Gardner et al., 2022" rid="ref-gardner2022sundials" ref-type="bibr">Gardner
        et al., 2022</xref>;
        <xref alt="Hindmarsh et al., 2005" rid="ref-hindmarsh2005sundials" ref-type="bibr">Hindmarsh
        et al., 2005</xref>) to enable fast computation speed compared
        to DEARLIBS, which uses MATLAB©’s Symbolic Math Toolbox and
        ode15 solver. For 1C discharge given 10 discretized points in
        the electrodes, separator, and particle domains
        (<inline-formula><alternatives>
        <tex-math><![CDATA[N_p=N_s=N_n=N_{rp}=N_{rn}=10]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>),
        COBRAPRO solves the DFN model in ~0.708 seconds, while DEARLIBS
        takes ~2.54 minutes, which is a two orders of magnitude
        improvement (~257 times). Under identical simulation conditions,
        LIONSIMBA and PyBaMM computed the model in ~1.13 seconds and
        ~0.237 seconds, respectively, demonstrating comparable
        performance to COBRAPRO. For larger discretization points,
        COBRAPRO exhibits up to three orders of magnitude improvement in
        computation speed compared to DEARLIBS. Refer to
        (<xref alt="Ha &amp; Onori, 2024" rid="ref-ha_cobrapro_2024" ref-type="bibr">Ha
        &amp; Onori, 2024</xref>) for more details on the computation
        comparison study between COBRAPRO and other open-source DFN
        codes.</p>
      </list-item>
    </list>
  </sec>
  <sec id="challenge-2.-determining-consistent-initial-conditions">
    <title>Challenge 2. Determining consistent initial
    conditions</title>
    <list list-type="bullet">
      <list-item>
        <p><bold>Issue:</bold> The partial differential equations (PDEs)
        governing the DFN model are discretized in x- and r-directions
        to form a system of ordinary differential equations (ODEs) and
        algebraic equations (AEs), referred to as differential-algebraic
        equations (DAEs). To solve the DAE system, it is essential to
        provide the correct initial conditions for the algebraic
        variables, which are typically not known <italic>a
        priori</italic> and must satisfy the AEs in the DFN model
        (<xref alt="Lee &amp; Onori, 2021" rid="ref-lee_robust_2021" ref-type="bibr">Lee
        &amp; Onori, 2021</xref>). Inconsistent initial conditions
        result in either a failure to start the simulation or the model
        diverging towards an incorrect solution
        (<xref alt="Methekar et al., 2011" rid="ref-methekar_perturbation_2011" ref-type="bibr">Methekar
        et al., 2011</xref>).</p>
      </list-item>
      <list-item>
        <p><bold>Solution:</bold> The single-step approach
        (<xref alt="Lawder et al., 2015" rid="ref-lawder_extending_2015" ref-type="bibr">Lawder
        et al., 2015</xref>), a robust initialization method implemented
        in COBRAPRO and DEARLIBS, modifies the AEs into implicit ODEs to
        determine consistent initial conditions. This approach
        eliminates the need for nonlinear algebraic solvers, such as
        SUNDIALS IDACalcIC or CasADi’s rootfinder, which are commonly
        used in other open-source DFN codes but have been shown to
        experience convergence issues
        (<xref alt="Methekar et al., 2011" rid="ref-methekar_perturbation_2011" ref-type="bibr">Methekar
        et al., 2011</xref>). In
        (<xref alt="Ha &amp; Onori, 2024" rid="ref-ha_cobrapro_2024" ref-type="bibr">Ha
        &amp; Onori, 2024</xref>), a comparison study between the
        single-step approach and SUNDIALS IDACalcIC demonstrates that
        the single-step approach consistently determines initial
        conditions across different C-rates and node numbers,
        outperforming SUNDIALS IDACalcIC. For more details, refer to
        (<xref alt="Ha &amp; Onori, 2024" rid="ref-ha_cobrapro_2024" ref-type="bibr">Ha
        &amp; Onori, 2024</xref>).</p>
      </list-item>
    </list>
  </sec>
  <sec id="challenge-3.-parameter-identifiability-and-identification">
    <title>Challenge 3. Parameter identifiability and
    identification</title>
    <list list-type="bullet">
      <list-item>
        <p><bold>Issue:</bold> Extensive cell teardown experiments
        (<xref alt="Chen et al., 2020" rid="ref-chen_development_2020" ref-type="bibr">Chen
        et al., 2020</xref>;
        <xref alt="Ecker et al., 2015" rid="ref-ecker_parameterization_2015a" ref-type="bibr">Ecker
        et al., 2015</xref>;
        <xref alt="Schmalstieg et al., 2018" rid="ref-schmalstieg_full_2018a" ref-type="bibr">Schmalstieg
        et al., 2018</xref>) have measured properties such as cell
        geometry, open-circuit potentials (OCPs), electrolyte
        characteristics, and solid diffusion coefficients. However,
        directly using these parameters in the DFN model often leads to
        inaccurate simulation results. Systematic parameter optimization
        routines are necessary to develop a well-calibrated model that
        accurately predicts real battery dynamics. Furthermore, not all
        parameters in the DFN model are identifiable due to
        overparametrization
        (<xref alt="Forman et al., 2012" rid="ref-forman_genetic_2012" ref-type="bibr">Forman
        et al., 2012</xref>) and identifiability challenges
        (<xref alt="Goshtasbi et al., 2020" rid="ref-goshtasbi_effective_2020" ref-type="bibr">Goshtasbi
        et al., 2020</xref>), with identifiability depending on the type
        of data available.</p>
      </list-item>
      <list-item>
        <p><bold>Solution:</bold> COBRAPRO features a co-simulation
        parameter optimization framework that utilizes particle swarm
        optimization (PSO) to minimize the multi-objective function
        (<xref alt="Allam &amp; Onori, 2021" rid="ref-allam_online_2021" ref-type="bibr">Allam
        &amp; Onori, 2021</xref>;
        <xref alt="Xu et al., 2023" rid="ref-xu_comparative_2023" ref-type="bibr">Xu
        et al., 2023</xref>), defined as the error between the
        experimental and simulated voltage and state of charge (SOC) in
        the electrodes
        (<xref alt="Ha &amp; Onori, 2024" rid="ref-ha_cobrapro_2024" ref-type="bibr">Ha
        &amp; Onori, 2024</xref>). COBRAPRO leverages MATLAB’s Parallel
        Computing Toolbox to accelerate PSO convergence through
        multicore processing. Additionally, COBRAPRO supports parameter
        identifiability analysis, allowing users to conduct local
        sensitivity analysis (LSA) and correlation analysis to identify
        a subset of parameters that can be reliably optimized using
        PSO.</p>
      </list-item>
    </list>
  </sec>
</sec>
<sec id="core-capabilities">
  <title>Core Capabilities</title>
  <list list-type="bullet">
    <list-item>
      <p><bold>Parameter identification routine:</bold> PSO optimizes
      parameters using experimental current-voltage data</p>
    </list-item>
    <list-item>
      <p><bold>Parameter identifiability analysis:</bold></p>
      <list list-type="bullet">
        <list-item>
          <p>LSA: Perturbs parameters around their nominal values and
          evaluates their sensitivity with respect to voltage and
          SOC</p>
        </list-item>
        <list-item>
          <p>Correlation analysis: Calculates linear correlation between
          two parameters</p>
        </list-item>
        <list-item>
          <p>User-defined sensitivity and correlation index thresholds
          utilized to determine a set of identifiable parameters</p>
        </list-item>
      </list>
    </list-item>
    <list-item>
      <p><bold>DFN model implementation:</bold></p>
      <list list-type="bullet">
        <list-item>
          <p>PDEs along the x-direction spatially discretized with
          finite volume method (FVM)</p>
        </list-item>
        <list-item>
          <p>PDE along the r-direction spatially discretized with FVM
          and finite difference method (FDM)</p>
          <list list-type="bullet">
            <list-item>
              <p>To estimate particle surface concentration using FVM,
              3rd-order Hermite interpolation was implemented to account
              for sharp concentration gradients near the particle
              surface
              (<xref alt="Xu et al., 2023" rid="ref-xu_comparative_2023" ref-type="bibr">Xu
              et al., 2023</xref>)</p>
            </list-item>
          </list>
        </list-item>
        <list-item>
          <p>SUNDIALS IDA solver used to solve spatially discretized DFN
          equations</p>
        </list-item>
      </list>
    </list-item>
    <list-item>
      <p><bold>Determining consistent initial conditions:</bold></p>
      <list list-type="bullet">
        <list-item>
          <p>Single-step approach
          (<xref alt="Lawder et al., 2015" rid="ref-lawder_extending_2015" ref-type="bibr">Lawder
          et al., 2015</xref>)</p>
        </list-item>
        <list-item>
          <p>SUNDIALS IDACalcIC
          (<xref alt="Gardner et al., 2022" rid="ref-gardner2022sundials" ref-type="bibr">Gardner
          et al., 2022</xref>;
          <xref alt="Hindmarsh et al., 2005" rid="ref-hindmarsh2005sundials" ref-type="bibr">Hindmarsh
          et al., 2005</xref>)</p>
        </list-item>
      </list>
    </list-item>
    <list-item>
      <p><bold>Simulating battery cycling:</bold></p>
      <list list-type="bullet">
        <list-item>
          <p>Constant current (CC) profiles</p>
        </list-item>
        <list-item>
          <p>Hybrid pulse power characterization (HPPC) profiles</p>
        </list-item>
        <list-item>
          <p>Dynamic current profiles</p>
        </list-item>
      </list>
    </list-item>
  </list>
</sec>
<sec id="example-case-study-on-lg-21700-m50t-cells">
  <title>Example: Case Study on LG 21700-M50T Cells</title>
  <p>To demonstrate the parameter identification process in COBRAPRO, a
  case study is conducted to parameterize a fresh LG 21700-M50T cell
  using the C/20 capacity test, HPPC, and driving cycle data
  (<xref alt="Pozzato et al., 2022" rid="ref-pozzato_data_2022" ref-type="bibr">Pozzato
  et al., 2022</xref>). In this example, we break down the
  identification problem by systematically grouping parameters in each
  identification step, as shown in
  <xref alt="[fig:flowchart]" rid="figU003Aflowchart">[fig:flowchart]</xref>.
  This multi-step approach is proposed to improve the identifiability of
  parameters instead of identifying all the unknown parameters
  simultaneously
  (<xref alt="Arunachalam &amp; Onori, 2019" rid="ref-arunachalam_full_2019" ref-type="bibr">Arunachalam
  &amp; Onori, 2019</xref>). For detailed information on the
  multi-objective cost functions, identifiability analysis, and list of
  all the DFN parameters, refer to
  (<xref alt="Ha &amp; Onori, 2024" rid="ref-ha_cobrapro_2024" ref-type="bibr">Ha
  &amp; Onori, 2024</xref>).</p>
  <fig>
    <caption><p>Case study: Parameter identification procedure on LG
    21700-M50T
    cells.<styled-content id="figU003Aflowchart"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="example_flowchart.pdf" />
  </fig>
  <p>Based on the analysis from
  (<xref alt="Ha &amp; Onori, 2024" rid="ref-ha_cobrapro_2024" ref-type="bibr">Ha
  &amp; Onori, 2024</xref>), the geometric parameters, OCPs,
  transference number, and equilibrium electrolyte coefficients are
  determined to be redundant parameters from structural identifiability
  analysis. Their values are fixed to values measured from cell
  tear-down and half-cell experiments on LG 21700-M50 cells, as reported
  by
  (<xref alt="Chen et al., 2020" rid="ref-chen_development_2020" ref-type="bibr">Chen
  et al., 2020</xref>). Next, the C/20 capacity test data is used to
  identify the stoichiometric parameters in the example code
  <monospace>DFN_pso_0_05C.m</monospace>. A parameter identifiability
  study is then performed in <monospace>DFN_LSA_Corr_HPPC.m</monospace>,
  which includes LSA and correlation analysis to select parameters that
  exhibit high sensitivity to HPPC voltage and SOC, while maintaining
  low correlation with other parameters. The identified subset of
  parameters is then optimized using HPPC data in the
  <monospace>DFN_pso_HPPC.m</monospace> code. Finally, the identified
  parameters are validated with urban dynamometer driving schedule
  (UDDS) data in the <monospace>DFN_UDDS_validation.m</monospace> code.
  All case study codes are located in the Examples folder.</p>
  <p>View COBRAPRO’s
  <ext-link ext-link-type="uri" xlink:href="https://github.com/COBRAPROsimulator/COBRAPRO/blob/main/README.md#toc6">README
  on Github</ext-link> to view a list of all available example
  codes.</p>
  <sec id="c20-capacity-test-identification">
    <title>C/20 Capacity Test Identification</title>
    <p>In
    <monospace>Examples/Parameter_Identification_Routines/DFN_pso_0_05C.m</monospace>,
    the <monospace>User Input</monospace> section is used to define the
    parameter names, PSO settings, experimental data, etc. A preview of
    the <monospace>User Input</monospace> section is provided here.</p>
    <p>First, load the
    <monospace>Parameters_LG_INR21700_M50.m</monospace> function, which
    outputs a <monospace>param</monospace> structure containing the
    nominal (experimentally measured) parameters of an LG INR21700-M50
    cell
    (<xref alt="Chen et al., 2020" rid="ref-chen_development_2020" ref-type="bibr">Chen
    et al., 2020</xref>), as well as the DFN simulation settings, e.g.,
    discretization method, method to determine consistent initial
    condition, constant or variable current type, etc.:</p>
    <code language="matlab">%% User Input  
% Load nominal parameters 
param = Parameters_LG_INR21700_M50;</code>
    <p>Enter a mat file name to save the PSO results. The mat file will
    contain an updated <monospace>param</monospace> structure that
    replaces the nominal stoichiometric values with the identified
    parameters:</p>
    <code language="matlab">% Enter mat file name where your PSO results will be stored
file_name = 'identified_parameters_0_05C';</code>
    <p>Define the names of the parameters you want to identify. Here, we
    identify the stoichiometric parameters
    <inline-formula><alternatives>
    <tex-math><![CDATA[\theta_p^{100}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>p</mml:mi><mml:mn>100</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>
    (<monospace>theta100_p</monospace>), <inline-formula><alternatives>
    <tex-math><![CDATA[\theta_n^{100}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>n</mml:mi><mml:mn>100</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>
    (<monospace>theta100_n</monospace>), <inline-formula><alternatives>
    <tex-math><![CDATA[\theta_p^0]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>p</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>
    (<monospace>theta0_p</monospace>), and
    <inline-formula><alternatives>
    <tex-math><![CDATA[\theta_n^0]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>θ</mml:mi><mml:mi>n</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula>
    (<monospace>theta0_n</monospace>):</p>
    <code language="matlab">% Enter names of parameters to identify (make sure names match the
% parameter names in &quot;param&quot; structure containing the nominal parameters)
param_CC = {'theta100_p', 'theta100_n', 'theta0_p', 'theta0_n'};</code>
    <p>Define the lower and upper bounds of the parameters defined in
    <monospace>param_CC</monospace>:</p>
    <code language="matlab">% Enter lower and upper bounds of parameters to identify 
% theta100_p
lower_bounds.theta100_p = 0.22; 
upper_bounds.theta100_p = 0.34;
% theta100_n
lower_bounds.theta100_n = 0.7; 
upper_bounds.theta100_n = 1; 
% theta0_p
lower_bounds.theta0_p = 0.7; 
upper_bounds.theta0_p = 1; 
% theta0_n
lower_bounds.theta0_n = 0.015; 
upper_bounds.theta0_n = 0.04;</code>
    <p>Load your time, current, and voltage experimental data. In this
    example, load the C/20 capacity test data:</p>
    <code language="matlab">% Load Experimental Data 
%--------------------------------------------------------------------------
%   t: Should be a vector consisting of your time experiment data      [s] (Mx1)
%   I: Should be a vector consisting of your current experiment data   [A] (Mx1) 
%   V: Should be a vector consisting of your voltage experimental data [V] (Mx1)
%   -&gt; where M is the total number of data points in your experiment
%--------------------------------------------------------------------------
% C/20 capacity test conducted on LG INR21700 M50T cells
load('data_INR21700_M50T/capacity_test_data_W8_Diag1.mat')
% Assign your data variables to t, I, and V 
t = t_data;
I = I_data;
V = V_data;</code>
    <p>Once all user inputs have been defined, run the
    <monospace>DFN_pso_0_05C.m</monospace> code to start the PSO. Once
    the PSO is finished, the code prints the identified parameter
    values, and the HPPC voltage and SOC objective function values to
    the Command Window:</p>
    <preformat>Displaying identified values...
------------------------
theta100_p:
Identified value: 0.26475
0.22(lower) | 0.27(initial) | 0.34(upper)
------------------------
theta100_n:
Identified value: 0.77842
0.7(lower) | 0.9014(initial) | 1(upper)
------------------------
theta0_p:
Identified value: 0.89385
0.7(lower) | 0.9084(initial) | 1(upper)
------------------------
theta0_n:
Identified value: 0.029818
0.015(lower) | 0.0279(initial) | 0.04(upper)

Displaying objective function values...
------------------------
J_V =0.0033403 [-]
J_V =11.8445 [mV]
J_SOCp =0.030231 [%]
J_SOCn =0.019037 [%]
J_tot =0.003833 [-]</preformat>
    <p>The code also plots the simulation results generated from the
    identified parameters and the experimental data, as shown in
    <xref alt="[fig:V_0_05C]" rid="figU003AV_0_05C">[fig:V_0_05C]</xref>
    and
    <xref alt="[fig:SOC_0_05C]" rid="figU003ASOC_0_05C">[fig:SOC_0_05C]</xref>.</p>
    <p>Run
    <monospace>Examples/Parameter_Identification_Routines/DFN_pso_0_05C_identification.m</monospace>
    to replicate the results shown here (code will load the identified
    parameters shown in this case study).</p>
    <fig>
      <caption><p>C/20 capacity test voltage identification
      results.<styled-content id="figU003AV_0_05C"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="0_05C_Voltage.png" />
    </fig>
    <fig>
      <caption><p>C/20 capacity test positive and negative electrode SOC
      identification
      results.<styled-content id="figU003ASOC_0_05C"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="0_05C_SOC.png" />
    </fig>
  </sec>
  <sec id="parameter-identifiability-analysis">
    <title>Parameter Identifiability Analysis</title>
    <p>In
    <monospace>Examples/Parameter_Identifiability_Analysis/DFN_LSA_Corr_HPPC.m</monospace>,
    parameter identifiability analysis is conducted to determine a
    subset of identifiable parameters given the HPPC profile. In the
    <monospace>User Input</monospace> section, load the
    <monospace>param</monospace> structure that contains the identified
    stoichiometric parameter values from
    <monospace>DFN_pso_0_05C.m</monospace>:</p>
    <code language="matlab">%% User Input
% Load nominal parameters and identified stoichiometric parameters
% from C/20 capacity test data
load('identified_parameters_0_05C.mat','param')</code>
    <p>Next, enter the names of the parameters for the identifiability
    analysis. These include the remaining parameters, excluding the
    structurally redundant parameters and stoichiometric coefficients,
    as outlined in the analysis by
    (<xref alt="Ha &amp; Onori, 2024" rid="ref-ha_cobrapro_2024" ref-type="bibr">Ha
    &amp; Onori, 2024</xref>):</p>
    <code language="matlab">%--------------------------------------------------------------------------
% Enter names of parameters to conduct LSA (make sure names match the
% parameter names in &quot;param&quot; structure containing nominal parameters)
%--------------------------------------------------------------------------
param_LSA_HPPC = {'Rc' 'Dsp' 'Dsn' 'kp' 'kn' 'De' 'Kappa' 'sigmap' 'sigman'};</code>
    <p>Enter the name of the mat file to store the list of identifiable
    parameters:</p>
    <code language="matlab">%--------------------------------------------------------------------------
% Enter mat file name where the identifiable parameters will be stored
%--------------------------------------------------------------------------
file_name = 'HPPC_identifiable_params';</code>
    <p>Set the LSA perturbation coefficient and the correlation
    coefficient threshold values (refer to
    (<xref alt="Ha &amp; Onori, 2024" rid="ref-ha_cobrapro_2024" ref-type="bibr">Ha
    &amp; Onori, 2024</xref>) for more details). In this example, five
    different correlation coefficient thresholds
    (<inline-formula><alternatives>
    <tex-math><![CDATA[\beta = 0.8, 0.9, 0.95, 0.98, 0.99]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>0.9</mml:mn><mml:mo>,</mml:mo><mml:mn>0.95</mml:mn><mml:mo>,</mml:mo><mml:mn>0.98</mml:mn><mml:mo>,</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>)
    are investigated, resulting in five identifiable parameter sets, one
    for each threshold value:</p>
    <code language="matlab">%--------------------------------------------------------------------------
% Perturbation coefficient for LSA [-]
%--------------------------------------------------------------------------
pct=0.05;

%--------------------------------------------------------------------------
% Define correlation coefficient threshold
%--------------------------------------------------------------------------
% Correlation coefficient threshold used to determine the uncorrelated parameter  
% vector prioritized by sensitivity, which will be considered the &quot;identifiable&quot;
% parameters for the HPPC profile (input vector to yield multiple identifiable
% parameter sets for each correlation threshold)
%--------------------------------------------------------------------------
beta_corr = [0.8 0.9 0.95 0.98 0.99];</code>
    <p>Load the HPPC simulation conditions from
    <monospace>HPPC_W8_Diag1.mat</monospace>, which include the current
    magnitude (<monospace>curr_vec</monospace>) and time duration
    (<monospace>time_vec</monospace>) for each step in the HPPC
    profile:</p>
    <code language="matlab">%--------------------------------------------------------------------------
% Load HPPC profile input current vector [A] and simulation time [s] 
%--------------------------------------------------------------------------
% Load HPPC_W8_Diag1.mat file that consists of curr_vec and time_vec
load('HPPC_W8_Diag1.mat') </code>
    <p>Once all the user inputs have been defined, run the code to start
    the identifiability analysis. The code will output figures showing
    plots of parameter sensitivities as a function of time, the
    sensitivity index of each parameter, and the correlation matrix. The
    identifiable parameter subsets determined for each correlation
    coefficient threshold are printed to the Command Window:</p>
    <code language="matlab">------------------------------------------------
Identifiable parameters from LSA and correlation analysis:
------------------------------------------------
Rc Dsp Dsn (threshold = 0.8)
Rc Dsp Dsn (threshold = 0.9)
Rc Dsp Dsn De (threshold = 0.95)
Rc Dsp Dsn De (threshold = 0.98)
Rc Dsp Dsn kp De (threshold = 0.99)</code>
  </sec>
  <sec id="hppc-identification">
    <title>HPPC Identification</title>
    <p>In
    <monospace>Examples/Parameter_Identification_Routines/DFN_pso_HPPC.m</monospace>,
    the identifiable parameters determined from
    <monospace>DFN_LSA_Corr_HPPC.m</monospace> are identified using PSO.
    First, load your <monospace>param</monospace> structure, which
    contains the identified stoichiometric parameter values from
    <monospace>DFN_pso_0_05C.m</monospace>. In this example, we load the
    <monospace>identified_parameters_0_05C.mat</monospace> file, which
    contains a <monospace>param</monospace> structure with the
    identified stoichiometric parameter values from
    <monospace>DFN_pso_0_05C.m</monospace>:</p>
    <code language="matlab">%% User Input
% Load nominal parameters and identified stoichiometric parameters
% from C/20 capacity test data
load('identified_parameters_0_05C.mat','param')</code>
    <p>When defining the names of the HPPC parameters to identify, users
    can manually type the parameters (Option 1) or load the parameter
    identifiability results generated from
    <monospace>DFN_LSA_Corr_HPPC.m</monospace> (Option 2).</p>
    <p>Here, Option 2 is demonstrated by loading
    <monospace>HPPC_identifiable_params.mat</monospace>, which is
    generated from <monospace>DFN_LSA_Corr_HPPC.m</monospace> and
    contains five identifiable parameter sets for
    <inline-formula><alternatives>
    <tex-math><![CDATA[\beta = 0.8, 0.9, 0.95, 0.98, 0.99]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.8</mml:mn><mml:mo>,</mml:mo><mml:mn>0.9</mml:mn><mml:mo>,</mml:mo><mml:mn>0.95</mml:mn><mml:mo>,</mml:mo><mml:mn>0.98</mml:mn><mml:mo>,</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
    In this example, the parameter set corresponding to
    <inline-formula><alternatives>
    <tex-math><![CDATA[\beta=0.95]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    is selected for PSO, by defining
    <monospace>beta_value = 0.95</monospace>:</p>
    <code language="matlab">%--------------------------------------------------------------------------
% Option 2: Load identifiable parameters from identifiability analysis
% conducted in &quot;Examples/Local_Sensitivity_Analysis/DFN_LSA_Corr_HPPC.m&quot;
%--------------------------------------------------------------------------
load('HPPC_identifiable_params.mat')
% Enter desired beta value
beta_value = 0.95;</code>
    <p>Enter the MAT file name to save an updated param structure
    containing the PSO results:</p>
    <code language="matlab">% Enter mat file name where your PSO results will be stored
file_name = 'identified_parameters_HPPC_0_95Corr';</code>
    <p>Define the upper and lower bounds for each parameter in
    <monospace>param_HPPC</monospace>:</p>
    <code language="matlab">% Enter lower and upper bounds of parameters to identify 
% Dsp
pct = 0.2; % perturbation coeff
lower_bounds.Dsp = 10^(log10(param.Dsp)*(1+pct));
upper_bounds.Dsp = 10^(log10(param.Dsp)*(1-pct));
...</code>
    <p>Load the time, current, and voltage vectors generated from the
    HPPC data:</p>
    <code language="matlab">% Load Experimental Data 
% HPPC test conducted on LG INR21700 M50T cells
load('HPPC_data_W8_Diag1.mat')    </code>
    <p>PSO settings can also be modified in the
    <monospace>User Input</monospace> section:</p>
    <code language="matlab">particle_num = 100;
exit_type = 'MaxStallIterations';
max_iterations = 5;
max_stall_tolerance = 0.5e-6;
social_adjustment = 3.6; 
self_adjustment = 0.3;  </code>
    <p>Once all user inputs have been defined, run the code to start the
    PSO. Once the PSO is completed, the identified parameter and
    objective function values are printed to the Command Window:</p>
    <code language="matlab">Displaying identified values...
------------------------
Rc:
Identified value: 0.02339
0.001(lower) | 0.02339(initial) | 0.02339(upper)
------------------------
De:
Identified value: 7.1555e-11
6.6922e-13(lower) | 7.1555e-11(initial) | 7.6509e-09(upper)
------------------------
Dsp:
Identified value: 1.3732e-12
3.7936e-16(lower) | 1.3732e-12(initial) | 4.9706e-09(upper)
------------------------
Dsn:
Identified value: 1.6399e-11
9.5335e-15(lower) | 1.6399e-11(initial) | 2.8208e-08(upper)

Displaying objective function values...
------------------------
J_V =0.0050556 [-]
J_V =16.1016 [mV]
J_SOCp =0.13285 [%]
J_SOCn =0.17272 [%]
J_tot =0.0081113 [-]</code>
    <p>Similar to <monospace>DFN_pso_0_05C.m</monospace>, the simulation
    results generated from the identified parameters are plotted against
    the experimental data, as shown in
    <xref alt="[fig:V_HPPC]" rid="figU003AV_HPPC">[fig:V_HPPC]</xref>
    and
    <xref alt="[fig:SOC_HPPC]" rid="figU003ASOC_HPPC">[fig:SOC_HPPC]</xref>.</p>
    <p>In
    <monospace>Examples/Parameter_Identification_Results/DFN_pso_HPPC_identification.m</monospace>,
    the results shown here can be replicated by defining the following
    in the <monospace>User Input</monospace> section:</p>
    <code language="matlab">%--------------------------------------------------------------------------
% Enter your identified parameters 
%--------------------------------------------------------------------------
load('identified_parameters_HPPC_0_95Corr.mat')</code>
    <p>This loads the mat file containing the identified HPPC values
    using <inline-formula><alternatives>
    <tex-math><![CDATA[\beta=0.95]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
    Note that the identified HPPC values for
    <inline-formula><alternatives>
    <tex-math><![CDATA[\beta=0.90]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.90</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    or <inline-formula><alternatives>
    <tex-math><![CDATA[\beta=0.99]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    can also be viewed by loading
    <monospace>identified_parameters_HPPC_0_90Corr.mat</monospace> or
    <monospace>identified_parameters_HPPC_0_99Corr.mat</monospace>
    instead.</p>
    <fig>
      <caption><p>HPPC voltage identification results using
      <inline-formula><alternatives>
      <tex-math><![CDATA[\beta=0.95]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.<styled-content id="figU003AV_HPPC"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="HPPC_Voltage_corr95.png" />
    </fig>
    <fig>
      <caption><p>HPPC positive and negative electrode SOC
      identification results using <inline-formula><alternatives>
      <tex-math><![CDATA[\beta=0.95]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.<styled-content id="figU003ASOC_HPPC"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="HPPC_SOC_corr95.png" />
    </fig>
  </sec>
  <sec id="udds-driving-cycle-validation">
    <title>UDDS Driving Cycle Validation</title>
    <p>In
    <monospace>Examples/Parameter_Identification_Results/DFN_pso_UDDS_validation.m</monospace>,
    the identified parameters from the C/20 capacity test and HPPC data
    are validated using the UDDS driving cycle. The model is simulated
    under the UDDS profile and compared against the experimental UDDS
    data.</p>
    <p>In the <monospace>User Input</monospace> section, load the
    parameter values identified from C/20 and HPPC data:</p>
    <code language="matlab">%% User Input  
% Load identification results 
load('identified_parameters_HPPC_0_95Corr.mat','param')</code>
    <p>Note that to run the UDDS validation for the HPPC identification
    results using <inline-formula><alternatives>
    <tex-math><![CDATA[\beta=0.90]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.90</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\beta=0.99]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.99</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    load <monospace>identified_parameters_HPPC_0_90Corr.mat</monospace>
    or <monospace>identified_parameters_HPPC_0_99Corr.mat</monospace>
    instead.</p>
    <p>Load the experimental UDDS data:</p>
    <code language="matlab">% Load Experimental Data 
% HPPC test conducted on LG INR21700 M50T cells
load('data_INR21700_M50T/UDDS_W8_cyc1.mat')</code>
    <p>The objective function is printed to the Command Window:</p>
    <preformat>Displaying objective function values...
------------------------
J_V =0.0037372 [-]
J_V =13.6512 [mV]
J_SOCp =0.032023 [%]
J_SOCn =0.01561 [%]
J_tot =0.0042135 [-]</preformat>
    <p>The simulation results and experimental data are plotted as shown
    in <xref alt="[fig:V_UDDS]" rid="figU003AV_UDDS">[fig:V_UDDS]</xref>
    and
    <xref alt="[fig:SOC_UDDS]" rid="figU003ASOC_UDDS">[fig:SOC_UDDS]</xref>.</p>
    <fig>
      <caption><p>UDDS voltage identification results using
      <inline-formula><alternatives>
      <tex-math><![CDATA[\beta=0.95]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.<styled-content id="figU003AV_UDDS"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="UDDS_Voltage_corr95.png" />
    </fig>
    <fig>
      <caption><p>UDDS positive and negative electrode SOC
      identification results using <inline-formula><alternatives>
      <tex-math><![CDATA[\beta=0.95]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.95</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.<styled-content id="figU003ASOC_UDDS"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="UDDS_SOC_corr95.png" />
    </fig>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The authors thank the Bits and Watts Initiative within the Precourt
  Institute for Energy at Stanford University for its partial financial
  support. We thank Dr. Le Xu for all the insightful discussions that
  greatly contributed to the enhancement of COBRAPRO. We extend our
  thanks to Alexis Geslin, Joseph Lucero, and Maitri Uppaluri for
  testing COBRAPRO and providing valuable feedback.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-doyle_modeling_1993">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Doyle</surname><given-names>Marc</given-names></name>
        <name><surname>Fuller</surname><given-names>Thomas F.</given-names></name>
        <name><surname>Newman</surname><given-names>John</given-names></name>
      </person-group>
      <article-title>Modeling of Galvanostatic Charge and Discharge of the Lithium/Polymer/Insertion Cell</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="1993-06">1993</year><month>06</month>
      <volume>140</volume>
      <issue>6</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/1.2221597</pub-id>
      <fpage>1526</fpage>
      <lpage>1533</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dai_graded_2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dai</surname><given-names>Yiling</given-names></name>
        <name><surname>Srinivasan</surname><given-names>Venkat</given-names></name>
      </person-group>
      <article-title>On Graded Electrode Porosity as a Design Tool for Improving the Energy Density of Batteries</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2016">2016</year>
      <volume>163</volume>
      <issue>3</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/2.0301603jes</pub-id>
      <fpage>A406</fpage>
      <lpage>A416</lpage>
    </element-citation>
  </ref>
  <ref id="ref-couto_lithiumion_2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Couto</surname><given-names>Luis. D.</given-names></name>
        <name><surname>Charkhgard</surname><given-names>Mohammad</given-names></name>
        <name><surname>Karaman</surname><given-names>Berke</given-names></name>
        <name><surname>Job</surname><given-names>Nathalie</given-names></name>
        <name><surname>Kinnaert</surname><given-names>Michel</given-names></name>
      </person-group>
      <article-title>Lithium-ion battery design optimization based on a dimensionless reduced-order electrochemical model</article-title>
      <source>Energy</source>
      <year iso-8601-date="2023-01">2023</year><month>01</month>
      <volume>263</volume>
      <pub-id pub-id-type="doi">10.1016/j.energy.2022.125966</pub-id>
      <fpage>125966</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-kolluri_realtime_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kolluri</surname><given-names>Suryanarayana</given-names></name>
        <name><surname>Aduru</surname><given-names>Sai Varun</given-names></name>
        <name><surname>Pathak</surname><given-names>Manan</given-names></name>
        <name><surname>Braatz</surname><given-names>Richard D.</given-names></name>
        <name><surname>Subramanian</surname><given-names>Venkat R.</given-names></name>
      </person-group>
      <article-title>Real-time Nonlinear Model Predictive Control (NMPC) Strategies using Physics-Based Models for Advanced Lithium-ion Battery Management System (BMS)</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2020-01">2020</year><month>01</month>
      <volume>167</volume>
      <issue>6</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/1945-7111/ab7bd7</pub-id>
      <fpage>063505</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ecker_parameterization_2015a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ecker</surname><given-names>Madeleine</given-names></name>
        <name><surname>Tran</surname><given-names>Thi Kim Dung</given-names></name>
        <name><surname>Dechent</surname><given-names>Philipp</given-names></name>
        <name><surname>Käbitz</surname><given-names>Stefan</given-names></name>
        <name><surname>Warnecke</surname><given-names>Alexander</given-names></name>
        <name><surname>Sauer</surname><given-names>Dirk Uwe</given-names></name>
      </person-group>
      <article-title>Parameterization of a Physico-Chemical Model of a Lithium-Ion Battery: I. Determination of Parameters</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2015">2015</year>
      <volume>162</volume>
      <issue>9</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/2.0551509jes</pub-id>
      <fpage>A1836</fpage>
      <lpage>A1848</lpage>
    </element-citation>
  </ref>
  <ref id="ref-schmalstieg_full_2018a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schmalstieg</surname><given-names>Johannes</given-names></name>
        <name><surname>Rahe</surname><given-names>Christiane</given-names></name>
        <name><surname>Ecker</surname><given-names>Madeleine</given-names></name>
        <name><surname>Sauer</surname><given-names>Dirk Uwe</given-names></name>
      </person-group>
      <article-title>Full Cell Parameterization of a High-Power Lithium-Ion Battery for a Physico-Chemical Model: Part I. Physical and Electrochemical Parameters</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2018">2018</year>
      <volume>165</volume>
      <issue>16</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/2.0321816jes</pub-id>
      <fpage>A3799</fpage>
      <lpage>A3810</lpage>
    </element-citation>
  </ref>
  <ref id="ref-chen_development_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chen</surname><given-names>Chang-Hui</given-names></name>
        <name><surname>Brosa Planella</surname><given-names>Ferran</given-names></name>
        <name><surname>O’Regan</surname><given-names>Kieran</given-names></name>
        <name><surname>Gastol</surname><given-names>Dominika</given-names></name>
        <name><surname>Widanage</surname><given-names>W. Dhammika</given-names></name>
        <name><surname>Kendrick</surname><given-names>Emma</given-names></name>
      </person-group>
      <article-title>Development of Experimental Techniques for Parameterization of Multi-scale Lithium-ion Battery Models</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2020-01">2020</year><month>01</month>
      <volume>167</volume>
      <issue>8</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/1945-7111/ab9050</pub-id>
      <fpage>080534</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-sulzer_python_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sulzer</surname><given-names>Valentin</given-names></name>
        <name><surname>Marquis</surname><given-names>Scott G.</given-names></name>
        <name><surname>Timms</surname><given-names>Robert</given-names></name>
        <name><surname>Robinson</surname><given-names>Martin</given-names></name>
        <name><surname>Chapman</surname><given-names>S. Jon</given-names></name>
      </person-group>
      <article-title>Python Battery Mathematical Modelling (PyBaMM)</article-title>
      <source>Journal of Open Research Software</source>
      <year iso-8601-date="2021-06">2021</year><month>06</month>
      <volume>9</volume>
      <issue>1</issue>
      <issn>2049-9647</issn>
      <pub-id pub-id-type="doi">10.5334/jors.309</pub-id>
      <fpage>14</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-torchio_lionsimba_2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Torchio</surname><given-names>Marcello</given-names></name>
        <name><surname>Magni</surname><given-names>Lalo</given-names></name>
        <name><surname>Gopaluni</surname><given-names>R. Bhushan</given-names></name>
        <name><surname>Braatz</surname><given-names>Richard D.</given-names></name>
        <name><surname>Raimondo</surname><given-names>Davide M.</given-names></name>
      </person-group>
      <article-title>LIONSIMBA: A Matlab Framework Based on a Finite Volume Model Suitable for Li-Ion Battery Design, Simulation, and Control</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2016">2016</year>
      <volume>163</volume>
      <issue>7</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/2.0291607jes</pub-id>
      <fpage>A1192</fpage>
      <lpage>A1205</lpage>
    </element-citation>
  </ref>
  <ref id="ref-smith_multiphase_2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Smith</surname><given-names>Raymond B.</given-names></name>
        <name><surname>Bazant</surname><given-names>Martin Z.</given-names></name>
      </person-group>
      <article-title>Multiphase Porous Electrode Theory</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2017">2017</year>
      <volume>164</volume>
      <issue>11</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/2.0171711jes</pub-id>
      <fpage>E3291</fpage>
      <lpage>E3310</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pozzato_general_2023">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Pozzato</surname><given-names>Gabriele</given-names></name>
        <name><surname>Onori</surname><given-names>Simona</given-names></name>
      </person-group>
      <article-title>A General Matlab and COMSOL Co-simulation Framework for Model Parameter Optimization: Lithium-Ion Battery and Gasoline Particulate Filter Case Studies</article-title>
      <source>Automotive Technical Papers</source>
      <year iso-8601-date="2023-07">2023</year><month>07</month>
      <pub-id pub-id-type="doi">10.4271/2023-01-5047</pub-id>
      <fpage>2023</fpage>
      <lpage>01-5047</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pozzato_data_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pozzato</surname><given-names>Gabriele</given-names></name>
        <name><surname>Allam</surname><given-names>Anirudh</given-names></name>
        <name><surname>Onori</surname><given-names>Simona</given-names></name>
      </person-group>
      <article-title>Lithium-ion battery aging dataset based on electric vehicle real-driving profiles</article-title>
      <source>Data in Brief</source>
      <year iso-8601-date="2022-04">2022</year><month>04</month>
      <volume>41</volume>
      <pub-id pub-id-type="doi">10.1016/j.dib.2022.107995</pub-id>
      <fpage>107995</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-berliner_methods_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Berliner</surname><given-names>Marc D.</given-names></name>
        <name><surname>Cogswell</surname><given-names>Daniel A.</given-names></name>
        <name><surname>Bazant</surname><given-names>Martin Z.</given-names></name>
        <name><surname>Braatz</surname><given-names>Richard D.</given-names></name>
      </person-group>
      <article-title>MethodsPETLION: Open-Source Software for Millisecond-Scale Porous Electrode Theory-Based Lithium-Ion Battery Simulations</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2021-09">2021</year><month>09</month>
      <volume>168</volume>
      <issue>9</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/1945-7111/ac201c</pub-id>
      <fpage>090504</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-ha_cobrapro_2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ha</surname><given-names>Sara</given-names></name>
        <name><surname>Onori</surname><given-names>Simona</given-names></name>
      </person-group>
      <article-title>COBRAPRO: An open-source software for the dolye-fuller-newman model with co-simulation parameter optimization framework</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2024">2024</year>
      <pub-id pub-id-type="doi">10.1149/1945-7111/ad7292</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-arunachalam_full_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Arunachalam</surname><given-names>Harikesh</given-names></name>
        <name><surname>Onori</surname><given-names>Simona</given-names></name>
      </person-group>
      <article-title>Full Homogenized Macroscale Model and Pseudo-2-Dimensional Model for Lithium-Ion Battery Dynamics: Comparative Analysis, Experimental Verification and Sensitivity Analysis</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2019">2019</year>
      <volume>166</volume>
      <issue>8</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/2.0051908jes</pub-id>
      <fpage>A1380</fpage>
      <lpage>A1392</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lee_robust_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lee</surname><given-names>Seong Beom</given-names></name>
        <name><surname>Onori</surname><given-names>Simona</given-names></name>
      </person-group>
      <article-title>A Robust and Sleek Electrochemical Battery Model Implementation: A MATLAB Framework</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2021-09">2021</year><month>09</month>
      <volume>168</volume>
      <issue>9</issue>
      <issn>1945-7111</issn>
      <pub-id pub-id-type="doi">10.1149/1945-7111/ac22c8</pub-id>
      <fpage>090527</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-methekar_perturbation_2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Methekar</surname><given-names>Ravi N.</given-names></name>
        <name><surname>Ramadesigan</surname><given-names>Venkatasailanathan</given-names></name>
        <name><surname>Pirkle</surname><given-names>J. Carl</given-names></name>
        <name><surname>Subramanian</surname><given-names>Venkat R.</given-names></name>
      </person-group>
      <article-title>A perturbation approach for consistent initialization of index-1 explicit differentialalgebraic equations arising from battery model simulations</article-title>
      <source>Computers &amp; Chemical Engineering</source>
      <year iso-8601-date="2011-11">2011</year><month>11</month>
      <volume>35</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.1016/j.compchemeng.2011.01.003</pub-id>
      <fpage>2227</fpage>
      <lpage>2234</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lawder_extending_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lawder</surname><given-names>Matthew T.</given-names></name>
        <name><surname>Ramadesigan</surname><given-names>Venkatasailanathan</given-names></name>
        <name><surname>Suthar</surname><given-names>Bharatkumar</given-names></name>
        <name><surname>Subramanian</surname><given-names>Venkat R.</given-names></name>
      </person-group>
      <article-title>Extending explicit and linearly implicit ODE solvers for index-1 DAEs</article-title>
      <source>Computers &amp; Chemical Engineering</source>
      <year iso-8601-date="2015-11">2015</year><month>11</month>
      <volume>82</volume>
      <pub-id pub-id-type="doi">10.1016/j.compchemeng.2015.07.002</pub-id>
      <fpage>283</fpage>
      <lpage>292</lpage>
    </element-citation>
  </ref>
  <ref id="ref-xu_comparative_2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Xu</surname><given-names>Le</given-names></name>
        <name><surname>Cooper</surname><given-names>Julian</given-names></name>
        <name><surname>Allam</surname><given-names>Anirudh</given-names></name>
        <name><surname>Onori</surname><given-names>Simona</given-names></name>
      </person-group>
      <article-title>Comparative Analysis of Numerical Methods for Lithium-Ion Battery Electrochemical Modeling</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2023-12">2023</year><month>12</month>
      <volume>170</volume>
      <issue>12</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/1945-7111/ad1293</pub-id>
      <fpage>120525</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-comsol">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>COMSOL AB, Stockholm, Sweden</string-name>
      </person-group>
      <article-title>COMSOL multiphysics&amp;copy; v. 6.2</article-title>
      <year iso-8601-date="2023">2023</year>
      <uri>www.comsol.com</uri>
    </element-citation>
  </ref>
  <ref id="ref-fastDFN">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>Scott Moura</string-name>
      </person-group>
      <article-title>fastDFN</article-title>
      <year iso-8601-date="2016">2016</year>
      <uri>https://github.com/scott-moura/fastDFN</uri>
    </element-citation>
  </ref>
  <ref id="ref-gardner2022sundials">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gardner</surname><given-names>David J</given-names></name>
        <name><surname>Reynolds</surname><given-names>Daniel R</given-names></name>
        <name><surname>Woodward</surname><given-names>Carol S</given-names></name>
        <name><surname>Balos</surname><given-names>Cody J</given-names></name>
      </person-group>
      <article-title>Enabling new flexibility in the SUNDIALS suite of nonlinear and differential/algebraic equation solvers</article-title>
      <source>ACM Transactions on Mathematical Software (TOMS)</source>
      <publisher-name>ACM</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>48</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1145/3539801</pub-id>
      <fpage>1</fpage>
      <lpage>24</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hindmarsh2005sundials">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hindmarsh</surname><given-names>Alan C</given-names></name>
        <name><surname>Brown</surname><given-names>Peter N</given-names></name>
        <name><surname>Grant</surname><given-names>Keith E</given-names></name>
        <name><surname>Lee</surname><given-names>Steven L</given-names></name>
        <name><surname>Serban</surname><given-names>Radu</given-names></name>
        <name><surname>Shumaker</surname><given-names>Dan E</given-names></name>
        <name><surname>Woodward</surname><given-names>Carol S</given-names></name>
      </person-group>
      <article-title>SUNDIALS: Suite of nonlinear and differential/algebraic equation solvers</article-title>
      <source>ACM Transactions on Mathematical Software (TOMS)</source>
      <publisher-name>ACM</publisher-name>
      <year iso-8601-date="2005">2005</year>
      <volume>31</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1145/1089014.1089020</pub-id>
      <fpage>363</fpage>
      <lpage>396</lpage>
    </element-citation>
  </ref>
  <ref id="ref-li_datadriven_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Li</surname><given-names>Weihan</given-names></name>
        <name><surname>Demir</surname><given-names>Iskender</given-names></name>
        <name><surname>Cao</surname><given-names>Decheng</given-names></name>
        <name><surname>Jöst</surname><given-names>Dominik</given-names></name>
        <name><surname>Ringbeck</surname><given-names>Florian</given-names></name>
        <name><surname>Junker</surname><given-names>Mark</given-names></name>
        <name><surname>Sauer</surname><given-names>Dirk Uwe</given-names></name>
      </person-group>
      <article-title>Data-driven systematic parameter identification of an electrochemical model for lithium-ion batteries with artificial intelligence</article-title>
      <source>Energy Storage Materials</source>
      <year iso-8601-date="2022-01">2022</year><month>01</month>
      <volume>44</volume>
      <pub-id pub-id-type="doi">10.1016/j.ensm.2021.10.023</pub-id>
      <fpage>557</fpage>
      <lpage>570</lpage>
    </element-citation>
  </ref>
  <ref id="ref-allam_online_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Allam</surname><given-names>Anirudh</given-names></name>
        <name><surname>Onori</surname><given-names>Simona</given-names></name>
      </person-group>
      <article-title>Online Capacity Estimation for Lithium-Ion Battery Cells via an Electrochemical Model-Based Adaptive Interconnected Observer</article-title>
      <source>IEEE Transactions on Control Systems Technology</source>
      <year iso-8601-date="2021-07">2021</year><month>07</month>
      <volume>29</volume>
      <issue>4</issue>
      <issn>1063-6536</issn>
      <pub-id pub-id-type="doi">10.1109/TCST.2020.3017566</pub-id>
      <fpage>1636</fpage>
      <lpage>1651</lpage>
    </element-citation>
  </ref>
  <ref id="ref-goshtasbi_effective_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Goshtasbi</surname><given-names>Alireza</given-names></name>
        <name><surname>Chen</surname><given-names>Jixin</given-names></name>
        <name><surname>Waldecker</surname><given-names>James R.</given-names></name>
        <name><surname>Hirano</surname><given-names>Shinichi</given-names></name>
        <name><surname>Ersal</surname><given-names>Tulga</given-names></name>
      </person-group>
      <article-title>Effective Parameterization of PEM Fuel Cell Models—Part I: Sensitivity Analysis and Parameter Identifiability</article-title>
      <source>Journal of The Electrochemical Society</source>
      <year iso-8601-date="2020-03">2020</year><month>03</month>
      <volume>167</volume>
      <issue>4</issue>
      <issn>0013-4651</issn>
      <pub-id pub-id-type="doi">10.1149/1945-7111/ab7091</pub-id>
      <fpage>044504</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-forman_genetic_2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Forman</surname><given-names>Joel C.</given-names></name>
        <name><surname>Moura</surname><given-names>Scott J.</given-names></name>
        <name><surname>Stein</surname><given-names>Jeffrey L.</given-names></name>
        <name><surname>Fathy</surname><given-names>Hosam K.</given-names></name>
      </person-group>
      <article-title>Genetic identification and fisher identifiability analysis of the DoyleFullerNewman model from experimental cycling of a LiFePO4 cell</article-title>
      <source>Journal of Power Sources</source>
      <year iso-8601-date="2012-07">2012</year><month>07</month>
      <volume>210</volume>
      <pub-id pub-id-type="doi">10.1016/j.jpowsour.2012.03.009</pub-id>
      <fpage>263</fpage>
      <lpage>275</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
