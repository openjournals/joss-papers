<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8456</article-id>
<article-id pub-id-type="doi">10.21105/joss.08456</article-id>
<title-group>
<article-title>Gene Fetch: A Python tool for sequence retrieval from
GenBank across the tree of life</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5246-0725</contrib-id>
<name>
<surname>Parsons</surname>
<given-names>Daniel A. J.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5497-4087</contrib-id>
<name>
<surname>Price</surname>
<given-names>Benjamin</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Natural History Museum, Cromwell Road, London, SW7 5BD,
United Kingdom</institution>
<institution-id institution-id-type="ROR">039zvsn29</institution-id>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-05-07">
<day>7</day>
<month>5</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>112</issue>
<fpage>8456</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>Bioinformatics</kwd>
<kwd>Genomics</kwd>
<kwd>Biodiversity Genomics</kwd>
<kwd>Barcoding</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>Gene Fetch</monospace> is an open-source Python tool
  that automates the retrieval of sequence data from the National Center
  for Biotechnology Information (NCBI) GenBank sequence database
  (<xref alt="Benson et al., 2012" rid="ref-BensonU003A2012" ref-type="bibr">Benson
  et al., 2012</xref>;
  <xref alt="Sayers et al., 2024" rid="ref-SayersU003A2024" ref-type="bibr">Sayers
  et al., 2024</xref>). It simplifies sequence acquisition for
  biological research by retrieving both protein and nucleotide
  sequences for user-specified targets from across the tree of life,
  accepting NCBI taxonomic identifiers or hierarchical taxonomic
  information as input.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Comparative genetic analyses within or between taxonomic groups
  often requires researchers to gather large numbers of gene or protein
  sequences from public repositories such as GenBank, which currently
  holds over 4.7 billion nucleotide sequences from over 580,000 formally
  described species
  (<xref alt="Sayers et al., 2024" rid="ref-SayersU003A2024" ref-type="bibr">Sayers
  et al., 2024</xref>). Streamlined access to this invaluable database
  is essential for comprehensive sequence data analysis, however, this
  task presents several significant challenges: (1) Limited database
  curation leading to inconsistent sequence annotations. (2) Variable
  sequence representation across taxonomic groups on the databases. (3)
  Time-intensive manual retrieval processes that do not scale
  efficiently.</p>
  <p>While several existing tools enable sequence retrieval from NCBI
  sequence repositories, they often require considerable bioinformatics
  expertise, are limited in functionality or data scope, or are suited
  for slightly different applications. E-utilities like Entrez Direct
  (<xref alt="Kans, 2024" rid="ref-KansU003A2024" ref-type="bibr">Kans,
  2024</xref>) offer broad NCBI database access via several APIs but
  rely on manual NCBI search term construction and significant scripting
  expertise, burdening the user with navigating database-specific syntax
  and structure. Similarly, other tools like CRABS: Creating Reference
  databases for Amplicon-Based Sequencing
  (<xref alt="Jeunen et al., 2023" rid="ref-JeunenU003A2023" ref-type="bibr">Jeunen
  et al., 2023</xref>) and RESCRIPt: REference Sequence annotation and
  CuRatIon Pipeline
  (<xref alt="Robeson II et al., 2021" rid="ref-RobesonU003A2021" ref-type="bibr">Robeson
  II et al., 2021</xref>) offer bulk, programmatic retrieval of
  sequences from several databases (e.g. NCBI, BOLD, etc.), yet they
  also require manual search terms construction, operate on a single
  taxon, and often require substantial post-processing by the user. NCBI
  Datasets
  (<xref alt="O’Leary et al., 2024" rid="ref-Oleary2024" ref-type="bibr">O’Leary
  et al., 2024</xref>), while facilitating web- and programmatic-access
  to NCBI sequence data, is restricted to the curated RefSeq database (a
  small subset of sequences available on GenBank), limited to
  species-level queries, and lacks sequence filtering and batch
  processing capabilities.</p>
  <p>In contrast, <monospace>Gene Fetch</monospace> offers an
  accessible, high-throughput solution that automates and simplifies
  sequence retrieval from GenBank by matching sought after targets to
  feature table annotations in GenBank records, and requires no prior
  NCBI syntax knowledge. The tool integrates robust logging, error
  handling, checkpointing, and a standardised output format, making it
  suited for reproducible, efficient, and biologically-informed sequence
  retrieval at scale. <monospace>Gene Fetch</monospace> directly
  addresses the challenge of variable sequence representation by
  systematically traversing taxonomic hierarchies when target sequences
  are unavailable at the initially specified taxonomic rank (e.g.,
  species → genus → family, etc), documenting the matched rank. This is
  especially valuable for researchers working with non-model organisms
  or taxonomic groups with limited sequence data, facilitating retrieval
  of the taxonomically closest available sequence.</p>
  <p><monospace>Gene Fetch</monospace> supports ‘batch’ and ‘single’
  query modes across both protein and nucleotide sequences, with
  automated CDS extraction, customisable length filtering, and fallback
  mechanisms for atypical GenBank annotations. The integrated ‘batch’
  mode processes multiple input taxa and retrieves the single ‘best’
  sequence per taxon, whilst ‘single’ mode exhaustively searches for all
  target sequences for a specified taxon. Collectively, these modes
  enable efficient retrieval of sequence data for genomic and
  phylogenetic studies across diverse taxa. It can also process variable
  GenBank features, including complementary strands, joined sequences,
  and whole genome shotgun entries, enabling extraction regions of
  interest from variable feature annotations (e.g., COI from mitogenome
  records). Cross-validation of retrieved NCBI taxonomy against the
  input taxonomy prevents taxonomic homonyms matches (identical names
  referring to different organisms across the tree of life). At release,
  the tool is optimised for 18 common targets, including “barcoding”
  genes, with curated synonyms for improved search specificity. Users
  can also specify additional markers to those 18 targets, and
  optionally retrieve corresponding GenBank records for each fetched
  sequence.</p>
</sec>
<sec id="implementation">
  <title>Implementation</title>
  <p><monospace>Gene Fetch</monospace> is implemented in Python
  <monospace>(&gt;=3.9)</monospace> and leverages two main libraries:
  Biopython
  (<xref alt="Cock et al., 2009" rid="ref-CockU003A2009" ref-type="bibr">Cock
  et al., 2009</xref>), which, through subpackages of the Bio package
  (Bio.Entrez, Bio.Seq, Bio.SeqIO, and Bio.SeqRecord), provides the
  foundation for NCBI database access, sequence parsing and
  manipulation; and RateLimit, which manages NCBI API rate constraints
  (beyond those provided in Bio.Entrez) to prevent request
  throttling.</p>
  <p>The tool follows a modular design with four primary components:
  configuration manager (handles search parameters and target-specific
  search term generation), Entrez handler (manages NCBI API interactions
  with comprehensive error handling), sequence processor (implements
  core logic for sequence extraction and validation), and output manager
  (controls file generation and reporting). Detailed logs of parameter
  and search progress are produced, and checkpoint recovery enables
  interrupted runs to be resumed. <monospace>Gene Fetch</monospace>
  utilises batch processing and taxonomic lineage caching to maximise
  efficiency, and can process hundreds to thousands of samples (in
  ‘batch’ mode) with modest computational resources, as outlined in the
  GitHub repository.</p>
</sec>
<sec id="availability">
  <title>Availability</title>
  <p><monospace>Gene Fetch</monospace> is distributed as a Python
  package on
  <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/gene-fetch/">PyPI</ext-link>
  and a
  <ext-link ext-link-type="uri" xlink:href="https://bioconda.github.io/recipes/gene-fetch/README.html">Bioconda
  package</ext-link>, with the source code, testing modules, and a
  standalone script available under an MIT license through the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/bge-barcoding/gene_fetch">GitHub</ext-link>
  repository. A supplementary shell wrapper script is also provided in
  the GitHub repository for submitting a
  <monospace>Gene Fetch</monospace> job to a High-Performance Computing
  (HPC) cluster running the SLURM job scheduler.</p>
</sec>
<sec id="acknowledgments-and-contributions">
  <title>Acknowledgments and contributions</title>
  <p>Contributions following the project’s guidelines are welcomed.
  Users are encouraged to report bugs and suggest enhancements through
  the GitHub issue tracker. We thank Maria Kamouyiaros and Oliver White
  (Natural History Museum, London) for their contributions to the
  conceptualisation and testing of <monospace>Gene Fetch</monospace>.
  This work is supported by Biodiversity Genomics Europe (Grant
  no.101059492), funded by Horizon Europe under the Biodiversity,
  Circular Economy and Environment call (REA.B.3); co-funded by the
  Swiss State Secretariat for Education, Research and Innovation (SERI)
  under contract numbers 22.00173 and 24.00054; and by the UK Research
  and Innovation (UKRI) under the Department for Business, Energy and
  Industrial Strategy’s Horizon Europe Guarantee Scheme.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-BensonU003A2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Benson</surname><given-names>Dennis A.</given-names></name>
        <name><surname>Cavanaugh</surname><given-names>Mark</given-names></name>
        <name><surname>Clark</surname><given-names>Karen</given-names></name>
        <name><surname>Karsch-Mizrachi</surname><given-names>Ilene</given-names></name>
        <name><surname>Lipman</surname><given-names>David J.</given-names></name>
        <name><surname>Ostell</surname><given-names>James</given-names></name>
        <name><surname>Sayers</surname><given-names>Eric W.</given-names></name>
      </person-group>
      <article-title>GenBank</article-title>
      <source>Nucleic Acids Research</source>
      <year iso-8601-date="2012-11">2012</year><month>11</month>
      <volume>41</volume>
      <issue>D1</issue>
      <issn>0305-1048</issn>
      <uri>https://doi.org/10.1093/nar/gks1195</uri>
      <pub-id pub-id-type="doi">10.1093/nar/gks1195</pub-id>
      <fpage>D36</fpage>
      <lpage>D42</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Oleary2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>O’Leary</surname><given-names>Nuala A</given-names></name>
        <name><surname>Cox</surname><given-names>Eric</given-names></name>
        <name><surname>Holmes</surname><given-names>J Bradley</given-names></name>
        <name><surname>Anderson</surname><given-names>W Ray</given-names></name>
        <name><surname>Falk</surname><given-names>Robert</given-names></name>
        <name><surname>Hem</surname><given-names>Vichet</given-names></name>
        <name><surname>Tsuchiya</surname><given-names>Mirian TN</given-names></name>
        <name><surname>Schuler</surname><given-names>Gregory D</given-names></name>
        <name><surname>Zhang</surname><given-names>Xuan</given-names></name>
        <name><surname>Torcivia</surname><given-names>John</given-names></name>
        <name><surname>Ketter</surname><given-names>Anne</given-names></name>
        <name><surname>Breen</surname><given-names>Laurie</given-names></name>
        <name><surname>Cothran</surname><given-names>Jonathan</given-names></name>
        <name><surname>Bajwa</surname><given-names>Hena</given-names></name>
        <name><surname>Tinne</surname><given-names>Jovany</given-names></name>
        <name><surname>Meric</surname><given-names>Peter A</given-names></name>
        <name><surname>Hlavina</surname><given-names>Wratko</given-names></name>
        <name><surname>Schneider</surname><given-names>Valerie A</given-names></name>
      </person-group>
      <article-title>Exploring and retrieving sequence and metadata for species across the tree of life with NCBI datasets</article-title>
      <source>Scientific Data</source>
      <publisher-name>Nature Publishing Group</publisher-name>
      <year iso-8601-date="2024-07">2024</year><month>07</month>
      <volume>11</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/s41597-024-03571-y</pub-id>
      <pub-id pub-id-type="pmid">38969627</pub-id>
      <fpage>732</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-SayersU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sayers</surname><given-names>Eric W</given-names></name>
        <name><surname>Cavanaugh</surname><given-names>Mark</given-names></name>
        <name><surname>Frisse</surname><given-names>Linda</given-names></name>
        <name><surname>Pruitt</surname><given-names>Kim D</given-names></name>
        <name><surname>Schneider</surname><given-names>Valerie A</given-names></name>
        <name><surname>Underwood</surname><given-names>Beverly A</given-names></name>
        <name><surname>Yankie</surname><given-names>Linda</given-names></name>
        <name><surname>Karsch-Mizrachi</surname><given-names>Ilene</given-names></name>
      </person-group>
      <article-title>GenBank 2025 update</article-title>
      <source>Nucleic Acids Research</source>
      <year iso-8601-date="2024-11">2024</year><month>11</month>
      <volume>53</volume>
      <issue>D1</issue>
      <issn>1362-4962</issn>
      <uri>https://doi.org/10.1093/nar/gkae1114</uri>
      <pub-id pub-id-type="doi">10.1093/nar/gkae1114</pub-id>
      <fpage>D56</fpage>
      <lpage>D61</lpage>
    </element-citation>
  </ref>
  <ref id="ref-KansU003A2024">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Kans</surname><given-names>Jonathan</given-names></name>
      </person-group>
      <article-title>Entrez direct: E-utilities on the unix command line</article-title>
      <source>Entrez programming utilities help [internet]</source>
      <publisher-name>National Center for Biotechnology Information (US)</publisher-name>
      <year iso-8601-date="2024-03">2024</year><month>03</month>
      <uri>https://www.ncbi.nlm.nih.gov/books/NBK179288/</uri>
    </element-citation>
  </ref>
  <ref id="ref-JeunenU003A2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jeunen</surname><given-names>Gert-Jan</given-names></name>
        <name><surname>Dowle</surname><given-names>Eddy</given-names></name>
        <name><surname>Edgecombe</surname><given-names>Jonika</given-names></name>
        <name><surname>von Ammon</surname><given-names>Ulla</given-names></name>
        <name><surname>Gemmell</surname><given-names>Neil J.</given-names></name>
        <name><surname>Cross</surname><given-names>Hugh</given-names></name>
      </person-group>
      <article-title>CRABS—a software program to generate curated reference databases for metabarcoding sequencing data</article-title>
      <source>Molecular Ecology Resources</source>
      <year iso-8601-date="2023">2023</year>
      <volume>23</volume>
      <issue>3</issue>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1111/1755-0998.13741</uri>
      <pub-id pub-id-type="doi">10.1111/1755-0998.13741</pub-id>
      <fpage>725</fpage>
      <lpage>738</lpage>
    </element-citation>
  </ref>
  <ref id="ref-RobesonU003A2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Robeson II</surname><given-names>Michael S.</given-names></name>
        <name><surname>O’Rourke</surname><given-names>Devon R.</given-names></name>
        <name><surname>Kaehler</surname><given-names>Benjamin D.</given-names></name>
        <name><surname>Ziemski</surname><given-names>Michal</given-names></name>
        <name><surname>Dillon</surname><given-names>Matthew R.</given-names></name>
        <name><surname>Foster</surname><given-names>Jeffrey T.</given-names></name>
        <name><surname>Bokulich</surname><given-names>Nicholas A.</given-names></name>
      </person-group>
      <article-title>RESCRIPt: Reproducible sequence taxonomy reference database management</article-title>
      <source>PLOS Computational Biology</source>
      <publisher-name>Public Library of Science</publisher-name>
      <year iso-8601-date="2021-11">2021</year><month>11</month>
      <volume>17</volume>
      <issue>11</issue>
      <uri>https://doi.org/10.1371/journal.pcbi.1009581</uri>
      <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009581</pub-id>
      <fpage>1</fpage>
      <lpage>37</lpage>
    </element-citation>
  </ref>
  <ref id="ref-CockU003A2009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cock</surname><given-names>Peter J. A.</given-names></name>
        <name><surname>Antao</surname><given-names>Tiago</given-names></name>
        <name><surname>Chang</surname><given-names>Jeffrey T.</given-names></name>
        <name><surname>Chapman</surname><given-names>Brad A.</given-names></name>
        <name><surname>Cox</surname><given-names>Cymon J.</given-names></name>
        <name><surname>Dalke</surname><given-names>Andrew</given-names></name>
        <name><surname>Friedberg</surname><given-names>Iddo</given-names></name>
        <name><surname>Hamelryck</surname><given-names>Thomas</given-names></name>
        <name><surname>Kauff</surname><given-names>Frank</given-names></name>
        <name><surname>Wilczynski</surname><given-names>Bartek</given-names></name>
        <name><surname>Hoon</surname><given-names>Michiel J. L. de</given-names></name>
      </person-group>
      <article-title>Biopython: Freely available python tools for computational molecular biology and bioinformatics</article-title>
      <source>Bioinformatics</source>
      <year iso-8601-date="2009-03">2009</year><month>03</month>
      <volume>25</volume>
      <issue>11</issue>
      <issn>1367-4803</issn>
      <uri>https://doi.org/10.1093/bioinformatics/btp163</uri>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/btp163</pub-id>
      <fpage>1422</fpage>
      <lpage>1423</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
