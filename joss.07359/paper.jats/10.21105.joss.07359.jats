<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7359</article-id>
<article-id pub-id-type="doi">10.21105/joss.07359</article-id>
<title-group>
<article-title>ngsPETSc: A coupling between NETGEN/NGSolve and
PETSc</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3919-8603</contrib-id>
<name>
<surname>Betteridge</surname>
<given-names>Jack</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1241-7060</contrib-id>
<name>
<surname>Farrell</surname>
<given-names>Patrick E.</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0001-8842-3221</contrib-id>
<name>
<surname>Hochsteger</surname>
<given-names>Matthias</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0000-3448-3002</contrib-id>
<name>
<surname>Lackner</surname>
<given-names>Christopher</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1250-5087</contrib-id>
<name>
<surname>Schöberl</surname>
<given-names>Joachim</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0435-0433</contrib-id>
<name>
<surname>Zampini</surname>
<given-names>Stefano</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2577-1106</contrib-id>
<name>
<surname>Zerbinati</surname>
<given-names>Umberto</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Imperial College London, United Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>CERBSim GmbH, Austria</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>University of Oxford, United Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>TU Wien, Austria</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>King Abdullah University of Science and Technology, Saudi
Arabia</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-07-01">
<day>1</day>
<month>7</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>104</issue>
<fpage>7359</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>PETSc</kwd>
<kwd>FEM</kwd>
<kwd>Meshing</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Combining advanced meshing techniques with robust solver
  capabilities is essential for solving difficult problems in
  computational science and engineering. In recent years, various
  software packages have been developed to support the integration of
  meshing tools with finite element solvers. To mention a few, FreeFEM
  (<xref alt="Hecht et al., 2005" rid="ref-FreeFEM" ref-type="bibr">Hecht
  et al., 2005</xref>) includes built-in support for mesh generation,
  allowing users to create and manipulate meshes directly within the
  software. Similarly, deal.II
  (<xref alt="Arndt et al., 2023" rid="ref-dealII" ref-type="bibr">Arndt
  et al., 2023</xref>) provides a GridGenerator class for generating
  standard mesh geometries like grids and cylinders. Furthermore,
  deal.II can interface with OpenCASCADE
  (<xref alt="OpenCASCADE Technology, 2023" rid="ref-OpenCASCADE" ref-type="bibr">OpenCASCADE
  Technology, 2023</xref>) to refine existing grids while conforming to
  the geometry provided. Other finite element libraries, such as
  Firedrake
  (<xref alt="Ham et al., 2023" rid="ref-Firedrake" ref-type="bibr">Ham
  et al., 2023</xref>), DUNE-FEM
  (<xref alt="Dedner et al., 2010" rid="ref-DUNE" ref-type="bibr">Dedner
  et al., 2010</xref>), and FEniCSx
  (<xref alt="Baratta et al., 2023" rid="ref-dolfinX" ref-type="bibr">Baratta
  et al., 2023</xref>), rely on external tools like Gmsh
  (<xref alt="Geuzaine &amp; Remacle, 2020" rid="ref-GMSH" ref-type="bibr">Geuzaine
  &amp; Remacle, 2020</xref>) and Tetgen
  (<xref alt="Si, 2015" rid="ref-TETGEN" ref-type="bibr">Si,
  2015</xref>) for mesh generation. This paper introduces ngsPETSc,
  software built with petsc4py
  (<xref alt="Dalcin et al., 2011" rid="ref-petsc4py" ref-type="bibr">Dalcin
  et al., 2011</xref>) that seamlessly integrates the NETGEN mesher
  (<xref alt="Schöberl, 1997" rid="ref-Netgen" ref-type="bibr">Schöberl,
  1997</xref>), the NGSolve finite element library
  (<xref alt="Schöberl, 2014" rid="ref-NGSolve" ref-type="bibr">Schöberl,
  2014</xref>), and the PETSc toolkit
  (<xref alt="Balay et al., 2023" rid="ref-PETSc" ref-type="bibr">Balay
  et al., 2023</xref>). ngsPETSc enables the use of NETGEN meshes and
  geometries in solvers that use PETSc’s DMPLEX
  (<xref alt="Lange et al., 2015" rid="ref-DMPLEX" ref-type="bibr">Lange
  et al., 2015</xref>), and provides NGSolve users access to the wide
  array of linear, nonlinear solvers, and time-steppers available in
  PETSc.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Efficiently solving large-scale partial differential equations
  (PDEs) on complex geometries is vital in scientific computing. PETSc,
  NETGEN, and NGSolve offer distinct functionalities: PETSc handles
  linear and nonlinear problems in a discretisation agnostic manner,
  NETGEN constructs meshes from constructive solid geometry (CSG)
  described with OpenCASCADE
  (<xref alt="OpenCASCADE Technology, 2023" rid="ref-OpenCASCADE" ref-type="bibr">OpenCASCADE
  Technology, 2023</xref>), and NGSolve offers a wide range of finite
  element discretisations. Integrating these tools with ngsPETSc
  promises to streamline simulation workflows and to enhance large-scale
  computing capabilities for challenging problems. This integration also
  facilitates seamless mesh exports from NETGEN to PETSc DMPlex,
  enabling simulations of complex geometries and supporting advanced
  meshing techniques in other PETSc-based solvers that employ DMPLEX. We
  illustrate this with the Firedrake finite element system
  (<xref alt="Ham et al., 2023" rid="ref-Firedrake" ref-type="bibr">Ham
  et al., 2023</xref>).</p>
  <p>In particular, by combining PETSc, NETGEN, and NGSolve within
  ngsPETSc the following new features are available:</p>
  <list list-type="bullet">
    <list-item>
      <p>PETSc Krylov solvers, including flexible and pipelined
      variants, are available in NGSolve. They can be used both with
      NGSolve matrix-free operators and NGSolve block matrices;</p>
    </list-item>
    <list-item>
      <p>PETSc preconditioners can be used as components within the
      NGSolve preconditioning infrastructure;</p>
    </list-item>
    <list-item>
      <p>PETSc nonlinear solvers are available in NGSolve, including
      advanced line search and trust region Newton-based methods;</p>
    </list-item>
    <list-item>
      <p>high order meshes constructed in NETGEN are now available in
      Firedrake
      (<xref alt="Ham et al., 2023" rid="ref-Firedrake" ref-type="bibr">Ham
      et al., 2023</xref>), enabling adaptive mesh refinement and
      geometric multigrid on hierarchies of curved meshes.</p>
    </list-item>
  </list>
  <p>In conclusion, ngsPETSc is a lightweight, user-friendly interface
  that bridges the gap between NETGEN, NGSolve, and PETSc, building on
  top of petsc4py. ngsPETsc aims to assist with the solution of
  challenging PDEs on complex geometries, enriching the already powerful
  capabilities of NETGEN, NGSolve, PETSc, and Firedrake.</p>
</sec>
<sec id="examples">
  <title>Examples</title>
  <p>In this section we provide a few examples of results that can be
  obtained using ngsPETSc. We begin by considering a simple primal
  Poisson problem on a unit square domain discretised with conforming
  <inline-formula><alternatives>
  <tex-math><![CDATA[P_2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  finite elements and compare the performance of different solvers newly
  available in NGSolve via ngsPETSc. In particular, we consider PETSc’s
  algebraic multigrid algorithm GAMG
  (<xref alt="“Parallel Multigrid Smoothing,” 2003" rid="ref-PETScGAMG" ref-type="bibr">“Parallel
  Multigrid Smoothing,” 2003</xref>), PETSc’s domain decomposition BDDC
  algorithm
  (<xref alt="Zampini, 2016" rid="ref-PETScBDDC" ref-type="bibr">Zampini,
  2016</xref>), NGSolve’s own implementation of element-wise BDDC, the
  Hypre algebraic multigrid algorithm
  (<xref alt="Falgout &amp; Yang, 2002" rid="ref-hypre" ref-type="bibr">Falgout
  &amp; Yang, 2002</xref>) and the ML algebraic multigrid algorithm
  (<xref alt="Sala et al., 2004" rid="ref-ml" ref-type="bibr">Sala et
  al., 2004</xref>), each combined with the conjugate gradient method.
  Other than the elementwise BDDC preconditioner, these preconditioners
  were not previously available in NGSolve. The results are shown in
  Table 1 and the full example, with more details, can be found in the
  <ext-link ext-link-type="uri" xlink:href="https://ngspetsc.readthedocs.io/en/latest/PETScKSP/poisson.py.html">ngsPETSc
  documentation</ext-link>. All the preconditioners considered exhibit
  robust conjugate gradient iteration counts as we refine the mesh for a
  <inline-formula><alternatives>
  <tex-math><![CDATA[P_1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  discretisation, but out-of-the-box only BDDC type preconditioners are
  robust as we refine the mesh for a <inline-formula><alternatives>
  <tex-math><![CDATA[P_2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  discretisation. A possible remedy for this issue is discussed in the
  <ext-link ext-link-type="uri" xlink:href="https://ngspetsc.readthedocs.io/en/latest/PETScPC/poisson.py.html">ngsPETSc
  documentation</ext-link>.</p>
  <table-wrap>
    <table>
      <colgroup>
        <col width="13%" />
        <col width="21%" />
        <col width="10%" />
        <col width="7%" />
        <col width="18%" />
        <col width="30%" />
      </colgroup>
      <thead>
        <tr>
          <th># DoFs</th>
          <th>PETSc GAMG</th>
          <th>HYPRE</th>
          <th>ML</th>
          <th>PETSc BDDC*</th>
          <th>Element-wise BDDC**</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>116716</td>
          <td>35</td>
          <td>36</td>
          <td>31</td>
          <td>9</td>
          <td>10</td>
        </tr>
        <tr>
          <td>464858</td>
          <td>69</td>
          <td>74</td>
          <td>63</td>
          <td>8</td>
          <td>9</td>
        </tr>
        <tr>
          <td>1855428</td>
          <td>142</td>
          <td>148</td>
          <td>127</td>
          <td>9</td>
          <td>10</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p>Table 1: The number of degrees of freedom (DoFs) and the number of
  iterations required to solve the Poisson problem with different
  solvers. Each row corresponds to a level of uniform refinement. The
  conjugate gradient solve was terminated when the residual norm
  decreased by six orders of magnitude. *We choose to use PETSc BDDC
  with six subdomains. **Element-wise BDDC is a custom implementation of
  BDDC in NGSolve.</p>
  <p>We next consider the Oseen problem, i.e.
  <disp-formula><tex-math><![CDATA[
  \nu\Delta \vec{u} +\vec{b}\cdot \nabla\vec{u} - \nabla p = \vec{f},
  \\ \quad \nabla \cdot \vec{u} = 0,
  ]]></tex-math></disp-formula> We discretise this problem using
  high-order Hood-Taylor elements (<inline-formula><alternatives>
  <tex-math><![CDATA[P_4]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-<inline-formula><alternatives>
  <tex-math><![CDATA[P_3]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>)
  on a unit square domain
  (<xref alt="Boffi, 1994" rid="ref-Boffi" ref-type="bibr">Boffi,
  1994</xref>;
  <xref alt="Taylor &amp; Hood, 1973" rid="ref-HT" ref-type="bibr">Taylor
  &amp; Hood, 1973</xref>). We employ an augmented Lagrangian
  formulation to better enforce the incompressibility constraint. We
  present the performance of GMRES
  (<xref alt="Saad &amp; Schultz, 1986" rid="ref-GMRES" ref-type="bibr">Saad
  &amp; Schultz, 1986</xref>) preconditioned with a two level additive
  Schwarz preconditioner with vertex-patch smoothing as fine level
  correction
  (<xref alt="Benzi &amp; Olshanskii, 2006" rid="ref-BenziOlshanskii" ref-type="bibr">Benzi
  &amp; Olshanskii, 2006</xref>;
  <xref alt="Farrell et al., 2021" rid="ref-FarrellEtAll" ref-type="bibr">Farrell
  et al., 2021</xref>). This preconditioner was built using ngsPETSc.
  The result for different viscosities <inline-formula><alternatives>
  <tex-math><![CDATA[\nu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ν</mml:mi></mml:math></alternatives></inline-formula>
  are shown in Table 2, exhibiting reasonable robustness as the
  viscosity (and hence Reynolds number) changes. The full example, with
  more details, can be found in the
  <ext-link ext-link-type="uri" xlink:href="https://ngspetsc.readthedocs.io/en/latest/PETScPC/oseen.py.html">ngsPETSc
  documentation</ext-link>.</p>
  <table-wrap>
    <table>
      <thead>
        <tr>
          <th># refinements (# DoFs)</th>
          <th><inline-formula><alternatives>
          <tex-math><![CDATA[\nu=10^{-2}]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mi>−</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></th>
          <th><inline-formula><alternatives>
          <tex-math><![CDATA[\nu=10^{-3}]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mi>−</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></th>
          <th><inline-formula><alternatives>
          <tex-math><![CDATA[\nu=10^{-4}]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ν</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mi>−</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1 (83842)</td>
          <td>3</td>
          <td>4</td>
          <td>6</td>
        </tr>
        <tr>
          <td>2 (334082)</td>
          <td>3</td>
          <td>4</td>
          <td>6</td>
        </tr>
        <tr>
          <td>3 (1333762)</td>
          <td>3</td>
          <td>4</td>
          <td>6</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p>Table 2: The number of iterations required to solve the Oseen
  problem with different viscosities and different refinement levels. In
  parentheses we report the number of degrees of freedom (DoFs) on the
  finest level. The GMRES iteration was terminated when the residual
  norm decreased by eight orders of magnitude.</p>
  <p>Figure 1 shows a simulation of a hyperelastic beam, solved with
  PETSc nonlinear solvers; the line search algorithms in PETSc solve
  this straightforwardly, but an undamped Newton iteration does not
  converge. Figures 2 and 3 show simulations in Firedrake that were not
  previously possible. Figure 2 shows a high-order NETGEN mesh employed
  for the simulation of a Navier-Stokes flow past a cylinder, while
  Figure 3 shows adaptive mesh refinement for a Poisson problem on an
  L-shaped domain. The adaptive procedure achieves the optimal
  complexity of error with degree of freedom count, as expected
  (<xref alt="Stevenson, 2006" rid="ref-stevenson2006" ref-type="bibr">Stevenson,
  2006</xref>).</p>
  <fig>
    <caption><p>A hyperelastic beam deformed by fixing one end and
    applying a twist at the other end. The colouring corresponds to the
    deviatoric von Mises stress experienced by the beam. The beam is
    discretised with <inline-formula><alternatives>
    <tex-math><![CDATA[P_3]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
    finite elements and the nonlinear problem is solved using PETSc
    SNES. The full example, with more details, can be found in the
    <ext-link ext-link-type="uri" xlink:href="https://ngspetsc.readthedocs.io/en/latest/PETScSNES/hyperelasticity.py.html">ngsPETSc
    documentation</ext-link>.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="hyperelastic.png" />
  </fig>
  <fig>
    <caption><p>Flow past a cylinder. The Navier-Stokes equations are
    discretised on a NETGEN high-order mesh with Firedrake. We use
    high-order Taylor-Hood elements (<inline-formula><alternatives>
    <tex-math><![CDATA[P_4]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math></alternatives></inline-formula>-<inline-formula><alternatives>
    <tex-math><![CDATA[P_3]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math></alternatives></inline-formula>)
    and a vertex-patch smoother as fine level correction in a two-level
    additive Schwarz preconditioner,
    (<xref alt="Benzi &amp; Olshanskii, 2006" rid="ref-BenziOlshanskii" ref-type="bibr">Benzi
    &amp; Olshanskii, 2006</xref>;
    <xref alt="Farrell et al., 2021" rid="ref-FarrellEtAll" ref-type="bibr">Farrell
    et al., 2021</xref>). The full example, with more details, can be
    found in
    <ext-link ext-link-type="uri" xlink:href="https://github.com/NGSolve/ngsPETSc">ngsPETSc
    documentation</ext-link>. On the right a zoom near the cylinder
    shows the curvature of the mesh.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="flow_past_a_cylinder.png" />
  </fig>
  <fig>
    <caption><p>An adaptive scheme applied to the Poisson problem on an
    L-shaped domain. The domain is discretised using
    <inline-formula><alternatives>
    <tex-math><![CDATA[P_1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>P</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
    finite elements and the adaptive mesh refinement is driven by a
    Babuška-Rheinboldt error estimator
    (<xref alt="Babuška &amp; Rheinboldt, 1978" rid="ref-BabuskaRheinboldt" ref-type="bibr">Babuška
    &amp; Rheinboldt, 1978</xref>). The adaptive procedure delivers
    optimal scaling of the energy norm of the error in terms of the
    number of degrees of freedom. The full example, with more details,
    can be found in the
    <ext-link ext-link-type="uri" xlink:href="https://ngspetsc.readthedocs.io/en/latest/utils/firedrake/lomesh.py.html">ngsPETSc
    documentation</ext-link>.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="adaptivity.png" />
  </fig>
  <p>More examples can be found in the documentation of ngsPETSc manual
  (<xref alt="Zerbinati, 2024" rid="ref-manual" ref-type="bibr">Zerbinati,
  2024</xref>).</p>
</sec>
<sec id="acknowledgement">
  <title>Acknowledgement</title>
  <p>This work was funded by the Engineering and Physical Sciences
  Research Council [grant numbers EP/R029423/1 and EP/W026163/1]. For
  the purpose of open access, the author has applied a CC BY public
  copyright licence to any Author Accepted Manuscript (AAM) version
  arising from this submission.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-Netgen">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schöberl</surname><given-names>Joachim</given-names></name>
      </person-group>
      <article-title>NETGEN An advancing front 2D/3D-mesh generator based on abstract rules</article-title>
      <source>Computing and visualization in science</source>
      <publisher-name>Springer Science; Business Media LLC</publisher-name>
      <year iso-8601-date="1997">1997</year>
      <volume>1</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1007/s007910050004</pub-id>
      <fpage>41</fpage>
      <lpage>52</lpage>
    </element-citation>
  </ref>
  <ref id="ref-NGSolve">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schöberl</surname><given-names>Joachim</given-names></name>
      </person-group>
      <article-title>C++ 11 implementation of finite elements in NGSolve</article-title>
      <source>Institute for analysis and scientific computing, Vienna University of Technology</source>
      <year iso-8601-date="2014">2014</year>
      <volume>30</volume>
    </element-citation>
  </ref>
  <ref id="ref-Firedrake">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ham</surname><given-names>David A</given-names></name>
        <name><surname>Kelly</surname><given-names>Paul HJ</given-names></name>
        <name><surname>Mitchell</surname><given-names>Lawrence</given-names></name>
        <name><surname>Cotter</surname><given-names>Colin J</given-names></name>
        <name><surname>Kirby</surname><given-names>Robert C</given-names></name>
        <name><surname>Sagiyama</surname><given-names>Koki</given-names></name>
        <name><surname>Bouziani</surname><given-names>Nacime</given-names></name>
        <name><surname>Vorderwuelbecke</surname><given-names>Sophia</given-names></name>
        <name><surname>Gregory</surname><given-names>Thomas J</given-names></name>
        <name><surname>Betteridge</surname><given-names>Jack</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Firedrake user manual</article-title>
      <source>Imperial College London and University of Oxford and Baylor University and University of Washington,</source>
      <year iso-8601-date="2023-05">2023</year><month>05</month>
      <pub-id pub-id-type="doi">10.25561/104839</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-TETGEN">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Si</surname><given-names>Hang</given-names></name>
      </person-group>
      <article-title>TetGen, a Delaunay-based quality tetrahedral mesh generator</article-title>
      <source>ACM Trans. Math. Softw.</source>
      <publisher-name>Association for Computing Machinery</publisher-name>
      <publisher-loc>New York, NY, USA</publisher-loc>
      <year iso-8601-date="2015-02">2015</year><month>02</month>
      <volume>41</volume>
      <issue>2</issue>
      <issn>0098-3500</issn>
      <uri>https://doi.org/10.1145/2629697</uri>
      <pub-id pub-id-type="doi">10.1145/2629697</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-PETSc">
    <element-citation publication-type="report">
      <person-group person-group-type="author">
        <name><surname>Balay</surname><given-names>Satish</given-names></name>
        <name><surname>Abhyankar</surname><given-names>Shrirang</given-names></name>
        <name><surname>Adams</surname><given-names>Mark F.</given-names></name>
        <name><surname>Benson</surname><given-names>Steven</given-names></name>
        <name><surname>Brown</surname><given-names>Jed</given-names></name>
        <name><surname>Brune</surname><given-names>Peter</given-names></name>
        <name><surname>Buschelman</surname><given-names>Kris</given-names></name>
        <name><surname>Constantinescu</surname><given-names>Emil</given-names></name>
        <name><surname>Dalcin</surname><given-names>Lisandro</given-names></name>
        <name><surname>Dener</surname><given-names>Alp</given-names></name>
        <name><surname>Eijkhout</surname><given-names>Victor</given-names></name>
        <name><surname>Faibussowitsch</surname><given-names>Jacob</given-names></name>
        <name><surname>Gropp</surname><given-names>William D.</given-names></name>
        <name><surname>Hapla</surname><given-names>Václav</given-names></name>
        <name><surname>Isaac</surname><given-names>Tobin</given-names></name>
        <name><surname>Jolivet</surname><given-names>Pierre</given-names></name>
        <name><surname>Karpeev</surname><given-names>Dmitry</given-names></name>
        <name><surname>Kaushik</surname><given-names>Dinesh</given-names></name>
        <name><surname>Knepley</surname><given-names>Matthew G.</given-names></name>
        <name><surname>Kong</surname><given-names>Fande</given-names></name>
        <name><surname>Kruger</surname><given-names>Scott</given-names></name>
        <name><surname>May</surname><given-names>Dave A.</given-names></name>
        <name><surname>McInnes</surname><given-names>Lois Curfman</given-names></name>
        <name><surname>Mills</surname><given-names>Richard Tran</given-names></name>
        <name><surname>Mitchell</surname><given-names>Lawrence</given-names></name>
        <name><surname>Munson</surname><given-names>Todd</given-names></name>
        <name><surname>Roman</surname><given-names>Jose E.</given-names></name>
        <name><surname>Rupp</surname><given-names>Karl</given-names></name>
        <name><surname>Sanan</surname><given-names>Patrick</given-names></name>
        <name><surname>Sarich</surname><given-names>Jason</given-names></name>
        <name><surname>Smith</surname><given-names>Barry F.</given-names></name>
        <name><surname>Zampini</surname><given-names>Stefano</given-names></name>
        <name><surname>Zhang</surname><given-names>Hong</given-names></name>
        <name><surname>Zhang</surname><given-names>Hong</given-names></name>
        <name><surname>Zhang</surname><given-names>Junchao</given-names></name>
      </person-group>
      <article-title>PETSc/TAO users manual</article-title>
      <publisher-name>Argonne National Laboratory</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <pub-id pub-id-type="doi">10.2172/2205494</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-petsc4py">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dalcin</surname><given-names>Lisandro D.</given-names></name>
        <name><surname>Paz</surname><given-names>Rodrigo R.</given-names></name>
        <name><surname>Kler</surname><given-names>Pablo A.</given-names></name>
        <name><surname>Cosimo</surname><given-names>Alejandro</given-names></name>
      </person-group>
      <article-title>Parallel distributed computing using python</article-title>
      <source>Advances in Water Resources</source>
      <year iso-8601-date="2011">2011</year>
      <volume>34</volume>
      <issue>9</issue>
      <issn>0309-1708</issn>
      <pub-id pub-id-type="doi">10.1016/j.advwatres.2011.04.013</pub-id>
      <fpage>1124 </fpage>
      <lpage> 1139</lpage>
    </element-citation>
  </ref>
  <ref id="ref-manual">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Zerbinati</surname><given-names>Umberto</given-names></name>
      </person-group>
      <article-title>ngsPETSc user manual</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2024-07">2024</year><month>07</month>
      <pub-id pub-id-type="doi">10.5281/zenodo.12650574</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-PETScBDDC">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zampini</surname><given-names>Stefano</given-names></name>
      </person-group>
      <article-title>PCBDDC: A class of robust dual-primal methods in PETSc</article-title>
      <source>SIAM Journal on Scientific Computing</source>
      <year iso-8601-date="2016">2016</year>
      <volume>38</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.1137/15M1025785</pub-id>
      <fpage>S282</fpage>
      <lpage>S306</lpage>
    </element-citation>
  </ref>
  <ref id="ref-PETScGAMG">
    <element-citation publication-type="article-journal">
      <article-title>Parallel multigrid smoothing: Polynomial versus Gauss–Seidel</article-title>
      <source>Journal of Computational Physics</source>
      <year iso-8601-date="2003">2003</year>
      <volume>188</volume>
      <issue>2</issue>
      <issn>0021-9991</issn>
      <pub-id pub-id-type="doi">10.1016/S0021-9991(03)00194-3</pub-id>
      <fpage>593</fpage>
      <lpage>610</lpage>
    </element-citation>
  </ref>
  <ref id="ref-BenziOlshanskii">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Benzi</surname><given-names>Michele</given-names></name>
        <name><surname>Olshanskii</surname><given-names>Maxim A.</given-names></name>
      </person-group>
      <article-title>An augmented lagrangian–based approach to the oseen problem</article-title>
      <source>SIAM Journal on Scientific Computing</source>
      <year iso-8601-date="2006">2006</year>
      <volume>28</volume>
      <issue>6</issue>
      <pub-id pub-id-type="doi">10.1137/050646421</pub-id>
      <fpage>2095</fpage>
      <lpage>2113</lpage>
    </element-citation>
  </ref>
  <ref id="ref-BabuskaRheinboldt">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Babuška</surname><given-names>I.</given-names></name>
        <name><surname>Rheinboldt</surname><given-names>W. C.</given-names></name>
      </person-group>
      <article-title>A-posteriori error estimates for the finite element method</article-title>
      <source>International Journal for Numerical Methods in Engineering</source>
      <year iso-8601-date="1978">1978</year>
      <volume>12</volume>
      <issue>10</issue>
      <pub-id pub-id-type="doi">10.1002/nme.1620121010</pub-id>
      <fpage>1597</fpage>
      <lpage>1615</lpage>
    </element-citation>
  </ref>
  <ref id="ref-OpenCASCADE">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>OpenCASCADE Technology</string-name>
      </person-group>
      <article-title>OpenCASCADE</article-title>
      <year iso-8601-date="2023">2023</year>
      <uri>https://www.opencascade.com/</uri>
    </element-citation>
  </ref>
  <ref id="ref-FarrellEtAll">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Farrell</surname><given-names>Patrick E.</given-names></name>
        <name><surname>Mitchell</surname><given-names>Lawrence</given-names></name>
        <name><surname>Scott</surname><given-names>L. Ridgway</given-names></name>
        <name><surname>Wechsung</surname><given-names>Florian</given-names></name>
      </person-group>
      <article-title>A Reynolds-robust preconditioner for the Scott-Vogelius discretization of the stationary incompressible Navier-Stokes equations</article-title>
      <source>The SMAI Journal of computational mathematics</source>
      <publisher-name>Société de Mathématiques Appliquées et Industrielles</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>7</volume>
      <pub-id pub-id-type="doi">10.5802/smai-jcm.72</pub-id>
      <fpage>75</fpage>
      <lpage>96</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ml">
    <element-citation publication-type="report">
      <person-group person-group-type="author">
        <name><surname>Sala</surname><given-names>M.</given-names></name>
        <name><surname>Hu</surname><given-names>J. J.</given-names></name>
        <name><surname>Tuminaro</surname><given-names>R. S.</given-names></name>
      </person-group>
      <article-title>ML3.1 smoothed aggregation user’s guide</article-title>
      <publisher-name>Sandia National Laboratories</publisher-name>
      <publisher-loc>Albuquerque, NM (USA)</publisher-loc>
      <year iso-8601-date="2004">2004</year>
      <pub-id pub-id-type="doi">10.2172/974895</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Boffi">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Boffi</surname><given-names>D.</given-names></name>
      </person-group>
      <article-title>Stability of higher order triangular Hood–Taylor methods for the stationary Stokes equations</article-title>
      <source>Mathematical Models and Methods in Applied Sciences</source>
      <year iso-8601-date="1994">1994</year>
      <volume>04</volume>
      <issue>02</issue>
      <pub-id pub-id-type="doi">10.1142/S0218202594000133</pub-id>
      <fpage>223</fpage>
      <lpage>235</lpage>
    </element-citation>
  </ref>
  <ref id="ref-HT">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Taylor</surname><given-names>C.</given-names></name>
        <name><surname>Hood</surname><given-names>P.</given-names></name>
      </person-group>
      <article-title>A numerical solution of the Navier–Stokes equations using the finite element technique</article-title>
      <source>Computers &amp; Fluids</source>
      <year iso-8601-date="1973">1973</year>
      <volume>1</volume>
      <issue>1</issue>
      <issn>0045-7930</issn>
      <pub-id pub-id-type="doi">10.1016/0045-7930(73)90027-3</pub-id>
      <fpage>73</fpage>
      <lpage>100</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hypre">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Falgout</surname><given-names>Robert D.</given-names></name>
        <name><surname>Yang</surname><given-names>Ulrike Meier</given-names></name>
      </person-group>
      <article-title>Hypre: A library of high performance preconditioners</article-title>
      <source>Computational science — ICCS 2002</source>
      <person-group person-group-type="editor">
        <name><surname>Sloot</surname><given-names>Peter M. A.</given-names></name>
        <name><surname>Hoekstra</surname><given-names>Alfons G.</given-names></name>
        <name><surname>Tan</surname><given-names>C. J. Kenneth</given-names></name>
        <name><surname>Dongarra</surname><given-names>Jack J.</given-names></name>
      </person-group>
      <publisher-name>Springer Berlin Heidelberg</publisher-name>
      <year iso-8601-date="2002">2002</year>
      <isbn>978-3-540-47789-1</isbn>
      <pub-id pub-id-type="doi">10.1007/3-540-47789-6_66</pub-id>
      <fpage>632</fpage>
      <lpage>641</lpage>
    </element-citation>
  </ref>
  <ref id="ref-GMRES">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Saad</surname><given-names>Yousef</given-names></name>
        <name><surname>Schultz</surname><given-names>Martin H.</given-names></name>
      </person-group>
      <article-title>GMRES: A generalized minimal residual algorithm for solving nonsymmetric linear systems</article-title>
      <source>SIAM Journal on Scientific and Statistical Computing</source>
      <year iso-8601-date="1986">1986</year>
      <volume>7</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1137/0907058</pub-id>
      <fpage>856</fpage>
      <lpage>869</lpage>
    </element-citation>
  </ref>
  <ref id="ref-stevenson2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Stevenson</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>Optimality of a standard adaptive finite element method</article-title>
      <source>Foundations of Computational Mathematics</source>
      <year iso-8601-date="2006">2006</year>
      <volume>7</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1007/s10208-005-0183-0</pub-id>
      <fpage>245</fpage>
      <lpage>269</lpage>
    </element-citation>
  </ref>
  <ref id="ref-FreeFEM">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hecht</surname><given-names>Frédéric</given-names></name>
        <name><surname>Pironneau</surname><given-names>Olivier</given-names></name>
        <name><surname>Le Hyaric</surname><given-names>A</given-names></name>
        <name><surname>Ohtsuka</surname><given-names>K</given-names></name>
      </person-group>
      <article-title>FreeFem++ manual</article-title>
      <source>Laboratoire Jacques Louis Lions</source>
      <year iso-8601-date="2005">2005</year>
    </element-citation>
  </ref>
  <ref id="ref-DUNE">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dedner</surname><given-names>Andreas</given-names></name>
        <name><surname>Klöfkorn</surname><given-names>Robert</given-names></name>
        <name><surname>Nolte</surname><given-names>Martin</given-names></name>
        <name><surname>Ohlberger</surname><given-names>Mario</given-names></name>
      </person-group>
      <article-title>A generic interface for parallel and adaptive discretization schemes: Abstraction principles and the dune-fem module</article-title>
      <source>Computing</source>
      <year iso-8601-date="2010-11-01">2010</year><month>11</month><day>01</day>
      <volume>90</volume>
      <issue>3</issue>
      <issn>1436-5057</issn>
      <uri>https://doi.org/10.1007/s00607-010-0110-3</uri>
      <pub-id pub-id-type="doi">10.1007/s00607-010-0110-3</pub-id>
      <fpage>165</fpage>
      <lpage>196</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dealII">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Arndt</surname><given-names>Daniel</given-names></name>
        <name><surname>Bangerth</surname><given-names>Wolfgang</given-names></name>
        <name><surname>Bergbauer</surname><given-names>Maximilian</given-names></name>
        <name><surname>Feder</surname><given-names>Marco</given-names></name>
        <name><surname>Fehling</surname><given-names>Marc</given-names></name>
        <name><surname>Heinz</surname><given-names>Johannes</given-names></name>
        <name><surname>Heister</surname><given-names>Timo</given-names></name>
        <name><surname>Heltai</surname><given-names>Luca</given-names></name>
        <name><surname>Kronbichler</surname><given-names>Martin</given-names></name>
        <name><surname>Maier</surname><given-names>Matthias</given-names></name>
        <name><surname>Munch</surname><given-names>Peter</given-names></name>
        <name><surname>Pelteret</surname><given-names>Jean-Paul</given-names></name>
        <name><surname>Turcksin</surname><given-names>Bruno</given-names></name>
        <name><surname>Wells</surname><given-names>David</given-names></name>
        <name><surname>Zampini</surname><given-names>Stefano</given-names></name>
      </person-group>
      <article-title>The deal.II library, version 9.5</article-title>
      <source>Journal of Numerical Mathematics</source>
      <year iso-8601-date="2023">2023</year>
      <volume>31</volume>
      <issue>3</issue>
      <uri>https://dealii.org/deal95-preprint.pdf</uri>
      <pub-id pub-id-type="doi">10.1515/jnma-2023-0089</pub-id>
      <fpage>231</fpage>
      <lpage>246</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dolfinX">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Baratta</surname><given-names>Igor A.</given-names></name>
        <name><surname>Dean</surname><given-names>Joseph P.</given-names></name>
        <name><surname>Dokken</surname><given-names>Jørgen S.</given-names></name>
        <name><surname>Habera</surname><given-names>Michal</given-names></name>
        <name><surname>Hale</surname><given-names>Jack S.</given-names></name>
        <name><surname>Richardson</surname><given-names>Chris N.</given-names></name>
        <name><surname>Rognes</surname><given-names>Marie E.</given-names></name>
        <name><surname>Scroggs</surname><given-names>Matthew W.</given-names></name>
        <name><surname>Sime</surname><given-names>Nathan</given-names></name>
        <name><surname>Wells</surname><given-names>Garth N.</given-names></name>
      </person-group>
      <article-title>DOLFINx: The next generation FEniCS problem solving environment</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2023-12">2023</year><month>12</month>
      <uri>https://doi.org/10.5281/zenodo.10447666</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.10447666</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-GMSH">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Geuzaine</surname><given-names>Christophe</given-names></name>
        <name><surname>Remacle</surname><given-names>Jean-François</given-names></name>
      </person-group>
      <article-title>A three-dimensional finite element mesh generator with built-in pre-and post-processing facilities</article-title>
      <source>International Journal for Numerical Methods in Engineering</source>
      <year iso-8601-date="2020">2020</year>
      <volume>11</volume>
      <fpage>79</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-DMPLEX">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Lange</surname><given-names>Michael</given-names></name>
        <name><surname>Knepley</surname><given-names>Matthew G.</given-names></name>
        <name><surname>Gorman</surname><given-names>Gerard J.</given-names></name>
      </person-group>
      <article-title>Flexible, scalable mesh and data management using PETSc DMPlex</article-title>
      <source>Proceedings of the 3rd international conference on exascale applications and software</source>
      <publisher-name>University of Edinburgh</publisher-name>
      <publisher-loc>Great Britain</publisher-loc>
      <year iso-8601-date="2015">2015</year>
      <isbn>9780992661519</isbn>
      <fpage>71</fpage>
      <lpage>76</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
