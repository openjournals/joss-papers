<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8264</article-id>
<article-id pub-id-type="doi">10.21105/joss.08264</article-id>
<title-group>
<article-title>DiRe - JAX: A JAX based Dimensionality Reduction
Algorithm for Large-scale Data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6764-8894</contrib-id>
<name>
<surname>Kolpakov</surname>
<given-names>Alexander</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9302-2169</contrib-id>
<name>
<surname>Rivin</surname>
<given-names>Igor</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>University of Austin, Austin TX, USA;
akolpakov@uaustin.org</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Temple University, Philadelphia PA, USA;
rivin@temple.edu</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-05-21">
<day>21</day>
<month>5</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>110</issue>
<fpage>8264</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>JAX</kwd>
<kwd>dimensionality reduction</kwd>
<kwd>machine learning</kwd>
<kwd>persistence homology</kwd>
<kwd>data visualization</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>DiRe - JAX is a new dimensionality reduction toolkit designed to
  address some of the challenges faced by traditional methods like UMAP
  and tSNE, such as loss of global structure and computational
  efficiency. Built on the JAX framework, DiRe leverages modern hardware
  acceleration to provide an efficient, scalable, and interpretable
  solution for visualizing complex data structures and for quantitative
  analysis of lower-dimensional embeddings. The toolkit shows
  considerable promise in preserving both local and global structures
  within the data as compared to state-of-the-art UMAP and tSNE
  implementations. This makes it suitable for a wide range of
  applications in machine learning, bioinformatics, and data
  science.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Traditional dimensionality reduction techniques such as UMAP and
  tSNE are widely used for visualizing high-dimensional data in
  lower-dimensional spaces, usually 2D and sometimes 3D. Other uses
  include dimensionality reduction to other, possibly higher and thus
  non-visual dimensions, for the subsequent use of classifiers such as
  SVMs.</p>
  <p>However, these methods often struggle with scalability,
  interpretability, and preservation of global data structures. For
  example, while fast and scalable, UMAP may overemphasize local
  structures at the expense of global data relationships
  (<xref alt="Chari &amp; Pachter, 2023" rid="ref-pachter" ref-type="bibr">Chari
  &amp; Pachter, 2023</xref>). And tSNE, while known for producing
  high-quality visualizations, may be computationally expensive and
  sensitive to hyperparameter tuning
  (<xref alt="Kobak &amp; Berens, 2019" rid="ref-kobak2019art" ref-type="bibr">Kobak
  &amp; Berens, 2019</xref>).</p>
  <p>DiRe-JAX addresses these challenges by offering a scalable solution
  that balances the preservation of both local and global structures.
  Leveraging the JAX framework allows DiRe-JAX to efficiently handle
  large datasets by utilizing GPU/TPU acceleration, making it
  significantly faster than CPU-based implementations without
  compromising on the quality of the embeddings.</p>
  <p>DiRe-JAX also includes a wealth of metrics for analyzing embedding
  quality and for hyperparameter tuning. Given its runtime efficiency,
  tasks such as grid-search hyperparameter optimization become feasible
  even in low-cost environments like Google Colab.</p>
  <p>This makes DiRe-JAX an essential toolkit for researchers and
  practitioners working with complex, high-dimensional data.</p>
</sec>
<sec id="benchmarks">
  <title>Benchmarks</title>
  <p>A few benchmark below provide some visuals regarding the global
  structure changes or preservation by various methods, such as:</p>
  <sec id="dataset-disk-uniform">
    <title>Dataset: Disk Uniform</title>
    <table-wrap>
      <table>
        <colgroup>
          <col width="50%" />
          <col width="50%" />
        </colgroup>
        <tbody>
          <tr>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Disk DiRe–JAX embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/disk-dire-jax.png" />
              </fig>
            </p></td>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Disk tSNE embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/disk-tsne.png" />
              </fig>
            </p></td>
          </tr>
          <tr>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Disk cuML UMAP embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/disk-cuml-umap.png" />
              </fig>
            </p></td>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Disk UMAP embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/disk-umap.png" />
              </fig>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
  <sec id="dataset-two-halfmoons">
    <title>Dataset: Two Half–Moons</title>
    <table-wrap>
      <table>
        <colgroup>
          <col width="50%" />
          <col width="50%" />
        </colgroup>
        <tbody>
          <tr>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Moons DiRe–JAX embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/moons-dire-jax.png" />
              </fig>
            </p></td>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Moons tSNE embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/moons-tsne.png" />
              </fig>
            </p></td>
          </tr>
          <tr>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Moons cuML UMAP embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/moons-cuml-umap.png" />
              </fig>
            </p></td>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Moons UMAP embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/moons-umap.png" />
              </fig>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
  <sec id="dataset-levine-32">
    <title>Dataset: Levine 32</title>
    <table-wrap>
      <table>
        <colgroup>
          <col width="52%" />
          <col width="48%" />
        </colgroup>
        <tbody>
          <tr>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Levine 32 DiRe–JAX embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/levine32-dire-jax.png" />
              </fig>
            </p></td>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Levine 32 tSNE embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/levine32-tsne.png" />
              </fig>
            </p></td>
          </tr>
          <tr>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Levine 32 cuML UMAP embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/levine32-cuml-umap.png" />
              </fig>
            </p></td>
            <td><p specific-use="wrapper">
              <fig>
                <caption><p>Levine 32 UMAP embedding</p></caption>
                <graphic mimetype="image" mime-subtype="png" xlink:href="../pics/embeddings/levine32-umap.png" />
              </fig>
            </p></td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
</sec>
<sec id="main-methods">
  <title>Main methods</title>
  <p>The main class of DiRe-JAX is <monospace>DiRe</monospace>. Let
  <inline-formula><alternatives>
  <tex-math><![CDATA[X \subset \mathbb{R}^n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>X</mml:mi><mml:mo>⊂</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  be the input data realized as a NumPy array. Then,
  <monospace>DiRe</monospace> performs the following main steps:</p>
  <list list-type="order">
    <list-item>
      <p><bold>Capturing dataset topology:</bold> Create the kNN graph
      of <inline-formula><alternatives>
      <tex-math><![CDATA[X]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>,
      say <inline-formula><alternatives>
      <tex-math><![CDATA[\Gamma]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Γ</mml:mi></mml:math></alternatives></inline-formula>,
      for a given number of neighbors <inline-formula><alternatives>
      <tex-math><![CDATA[k]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
      (<monospace>n_neighbors</monospace>) by calling
      <monospace>make_knn_adjacency</monospace>. This step uses a JAX
      kernel specifically developed by the authors to perform the
      computation on CPU, GPU, or TPU settings. Other libraries like
      FAISS
      (<xref alt="Douze et al., 2024" rid="ref-faiss" ref-type="bibr">Douze
      et al., 2024</xref>) may also be used, although they do not
      provide the same hardware universality.</p>
    </list-item>
    <list-item>
      <p><bold>Initial dimension reduction:</bold> Produce
      <inline-formula><alternatives>
      <tex-math><![CDATA[Y \subset \mathbb{R}^d]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>⊂</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>,
      the initial embedding of <inline-formula><alternatives>
      <tex-math><![CDATA[X]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>,
      with <inline-formula><alternatives>
      <tex-math><![CDATA[d \ll n]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>d</mml:mi><mml:mo>≪</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
      (usually <inline-formula><alternatives>
      <tex-math><![CDATA[d=2]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
      or <inline-formula><alternatives>
      <tex-math><![CDATA[3]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>3</mml:mn></mml:math></alternatives></inline-formula>)
      given by the <monospace>dimension</monospace> parameter, using one
      of the available embedding methods: <monospace>random</monospace>
      (random projections from the Johnson–Lindenstrauss Lemma),
      <monospace>spectral</monospace> (using the kNN graph
      <inline-formula><alternatives>
      <tex-math><![CDATA[\Gamma]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Γ</mml:mi></mml:math></alternatives></inline-formula>
      to construct the weighted Laplacian, optionally applying a
      similarity kernel), or <monospace>pca</monospace> (classical or
      kernel-based).</p>
    </list-item>
    <list-item>
      <p><bold>Layout optimization:</bold> Call
      <monospace>do_layout</monospace> to adjust the lower-dimensional
      embedding <inline-formula><alternatives>
      <tex-math><![CDATA[Y]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Y</mml:mi></mml:math></alternatives></inline-formula>
      to conform to the similarity structure of the higher-dimensional
      data <inline-formula><alternatives>
      <tex-math><![CDATA[X]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>.
      This is done via a force-directed layout where the role of
      “forces” is played by probability kernels (the distributions can
      be adjusted via parameters <monospace>min_dist</monospace> and
      <monospace>spread</monospace>).</p>
    </list-item>
  </list>
  <p>The initial embedding is stored in
  <monospace>self.init_embedding</monospace>, while the optimized layout
  is stored in <monospace>self.layout</monospace>. Both can be accessed
  after the main method <monospace>fit_transform</monospace> is called,
  for detailed comparison and analysis.</p>
  <sec id="random-projection-embedding">
    <title>Random Projection embedding</title>
    <p>This embedding is based on the following classical
    Johnson–Lindenstrauss Lemma
    (<xref alt="Johnson &amp; Lindenstrauss, 1984" rid="ref-JL" ref-type="bibr">Johnson
    &amp; Lindenstrauss, 1984</xref>):</p>
    <disp-quote>
      <p><bold>Johnson–Lindenstrauss Lemma (Probabilistic
      Form)</bold></p>
      <p>Given <inline-formula><alternatives>
      <tex-math><![CDATA[0 < \epsilon < 1]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>ϵ</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
      and an integer <inline-formula><alternatives>
      <tex-math><![CDATA[n]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>,
      let <inline-formula><alternatives>
      <tex-math><![CDATA[X]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>
      be a set of <inline-formula><alternatives>
      <tex-math><![CDATA[n]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>
      points in <inline-formula><alternatives>
      <tex-math><![CDATA[\mathbb{R}^d]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:math></alternatives></inline-formula>.
      For a random linear map <inline-formula><alternatives>
      <tex-math><![CDATA[f: \mathbb{R}^d \to \mathbb{R}^k]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>f</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>d</mml:mi></mml:msup><mml:mo>→</mml:mo><mml:msup><mml:mi>ℝ</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
      where <inline-formula><alternatives>
      <tex-math><![CDATA[k = O\left(\frac{\log n}{\epsilon^2}\right)]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac><mml:mrow><mml:mo>log</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:msup><mml:mi>ϵ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
      with high probability, for all <inline-formula><alternatives>
      <tex-math><![CDATA[u, v \in X]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mi>X</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>:</p>
      <p><disp-formula><alternatives>
      <tex-math><![CDATA[
      (1 - \epsilon) \lVert u - v \rVert^2 \le \lVert f(u) - f(v) \rVert^2 \le (1 + \epsilon) \lVert u - v \rVert^2.
      ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:msup><mml:mo stretchy="false" form="postfix">∥</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>≤</mml:mo><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msup><mml:mo stretchy="false" form="postfix">∥</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mo>≤</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:msup><mml:mo stretchy="false" form="postfix">∥</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>The value</p>
      <p><disp-formula><alternatives>
      <tex-math><![CDATA[
      \text{dist}(f) = \frac{\lVert f(u) - f(v) \rVert}{\lVert u - v \rVert}
      ]]></tex-math>
      <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">dist</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="false" form="postfix">∥</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mi>u</mml:mi><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mo stretchy="false" form="postfix">∥</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>is called the <italic>distortion</italic> of
      <inline-formula><alternatives>
      <tex-math><![CDATA[f]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>f</mml:mi></mml:math></alternatives></inline-formula>,
      and is expected to be close to <inline-formula><alternatives>
      <tex-math><![CDATA[1.0]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>1.0</mml:mn></mml:math></alternatives></inline-formula>
      for a high-quality embedding.</p>
    </disp-quote>
    <p>Random projections are simple and computationally inexpensive,
    but can suffer from cluttered outputs when
    <inline-formula><alternatives>
    <tex-math><![CDATA[k \ll d]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≪</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    due to variance reduction in the projected data.</p>
  </sec>
  <sec id="principal-component-analysis-embedding">
    <title>Principal Component Analysis embedding</title>
    <p>PCA seeks to preserve as much dataset variance as possible by
    projecting onto the top <inline-formula><alternatives>
    <tex-math><![CDATA[k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
    singular vectors. Assume <inline-formula><alternatives>
    <tex-math><![CDATA[X]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>
    is column-centered, with covariance matrix
    <inline-formula><alternatives>
    <tex-math><![CDATA[\mathrm{Cov}(X) = \frac{1}{n-1}X^T X]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mi>X</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mi>X</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
    Compute the singular value decomposition:</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[
    X = U \Sigma W^T,
    ]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>U</mml:mi><mml:mi>Σ</mml:mi><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
    <p>and truncate to the top <inline-formula><alternatives>
    <tex-math><![CDATA[k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
    singular values <inline-formula><alternatives>
    <tex-math><![CDATA[\Sigma_k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Σ</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    and vectors <inline-formula><alternatives>
    <tex-math><![CDATA[W_k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
    The rank-<inline-formula><alternatives>
    <tex-math><![CDATA[k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
    approximation is:</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[
    \widehat{X} = U_k \Sigma_k W_k^T,
    ]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mover><mml:mi>X</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mi>U</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>Σ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msubsup><mml:mi>W</mml:mi><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
    <p>and the PCA embedding is:</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[
    X_k = X W_k.
    ]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
    <p>Under mild conditions on the spectrum, the bottleneck distance
    between persistence diagrams of <inline-formula><alternatives>
    <tex-math><![CDATA[X]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[X_k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    satisfies
    (<xref alt="Chazal et al., 2014" rid="ref-chazal-persistence" ref-type="bibr">Chazal
    et al., 2014</xref>):</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[
    d_b(D(X), D(X_k)) \le \lVert \widehat{X} - X \rVert_F = \varepsilon \lVert X \rVert_F.
    ]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>D</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mover><mml:mi>X</mml:mi><mml:mo accent="true">̂</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi>X</mml:mi><mml:msub><mml:mo stretchy="false" form="postfix">∥</mml:mo><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mi>X</mml:mi><mml:msub><mml:mo stretchy="false" form="postfix">∥</mml:mo><mml:mi>F</mml:mi></mml:msub><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
    <p>Thus, PCA approximately preserves topological features up to a
    controlled relative error <inline-formula><alternatives>
    <tex-math><![CDATA[\varepsilon > 0]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ε</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  </sec>
  <sec id="spectral-laplacian-embedding">
    <title>Spectral Laplacian embedding</title>
    <p>Using the kNN graph <inline-formula><alternatives>
    <tex-math><![CDATA[\Gamma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Γ</mml:mi></mml:math></alternatives></inline-formula>
    of <inline-formula><alternatives>
    <tex-math><![CDATA[X]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>,
    construct the graph Laplacian (optionally with a similarity kernel)
    and compute the bottom-<inline-formula><alternatives>
    <tex-math><![CDATA[k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
    eigenvectors for embedding. This method often captures manifold
    structure but may not preserve global relationships.</p>
  </sec>
  <sec id="force-directed-layout">
    <title>Force-directed layout</title>
    <p>After obtaining an initial embedding
    <inline-formula><alternatives>
    <tex-math><![CDATA[Y]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Y</mml:mi></mml:math></alternatives></inline-formula>,
    DiRe–JAX applies an iterative force-directed layout to align
    <inline-formula><alternatives>
    <tex-math><![CDATA[Y]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Y</mml:mi></mml:math></alternatives></inline-formula>’s
    local structure with that of <inline-formula><alternatives>
    <tex-math><![CDATA[X]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>X</mml:mi></mml:math></alternatives></inline-formula>.
    Attraction and repulsion forces are modeled after tSNE and UMAP
    kernels</p>
    <p><disp-formula><alternatives>
    <tex-math><![CDATA[
    \varphi(x) = \frac{1}{1 + a \lVert x \rVert^{2b}}, \text{ with } a, b > 0,
    ]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>φ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mi>x</mml:mi><mml:msup><mml:mo stretchy="false" form="postfix">∥</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mrow><mml:mspace width="0.333em"></mml:mspace><mml:mtext mathvariant="normal"> with </mml:mtext><mml:mspace width="0.333em"></mml:mspace></mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
    <p>tuned by <monospace>min_dist</monospace>
    <inline-formula><alternatives>
    <tex-math><![CDATA[= \delta]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>=</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    and <monospace>spread</monospace> <inline-formula><alternatives>
    <tex-math><![CDATA[= \sigma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>=</mml:mo><mml:mi>σ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    so that:</p>
    <list list-type="bullet">
      <list-item>
        <p><inline-formula><alternatives>
        <tex-math><![CDATA[\varphi(x) \approx 1.0]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>φ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
        for <inline-formula><alternatives>
        <tex-math><![CDATA[\lVert x \rVert < \delta]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false" form="postfix">∥</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
        and</p>
      </list-item>
      <list-item>
        <p><inline-formula><alternatives>
        <tex-math><![CDATA[\varphi(x) \approx \exp\bigl(-(\lVert x \rVert - \delta)/\sigma\bigr)]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>φ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:mo>exp</mml:mo><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mml:mo><mml:mo>−</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mo stretchy="false" form="prefix">∥</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false" form="postfix">∥</mml:mo><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>/</mml:mi><mml:mi>σ</mml:mi><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
        otherwise.</p>
      </list-item>
    </list>
    <p>Attraction forces apply to kNN neighbors in
    <inline-formula><alternatives>
    <tex-math><![CDATA[\Gamma]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Γ</mml:mi></mml:math></alternatives></inline-formula>,
    while all other pairs experience repulsion. Layout iterations run
    until a preset number of steps is reached.</p>
  </sec>
</sec>
<sec id="code-availability">
  <title>Code availability</title>
  <p>The DiRe - JAX repository is available on
  <ext-link ext-link-type="uri" xlink:href="https://github.com/sashakolpakov/dire-jax">GitHub</ext-link>.
  An installable package is available on
  <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/dire-jax/">PyPI</ext-link>.</p>
</sec>
<sec id="whitepaper">
  <title>Whitepaper</title>
  <p>The DiRe - JAX whitepaper is available on the
  <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/abs/2503.03156">arXiv</ext-link>
  preprint server.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The authors would like to thank
  <ext-link ext-link-type="uri" xlink:href="https://github.com/Treys925"><monospace>@Treys925</monospace></ext-link>
  (Trey Smith, University of Michigan, Ann Arbor),
  <ext-link ext-link-type="uri" xlink:href="https://github.com/crhea93"><monospace>@crhea93</monospace></ext-link>
  (Carter Lee Rhea, Université de Montréal), and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/lmcinnes"><monospace>@lmcinnes</monospace></ext-link>
  (Leland McInnes, Tutte Institute for Mathematics and Computing) for
  their helpful comments and suggestions. This work is supported by the
  Google Cloud Research Award number GCP19980904.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-kobak2019art">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kobak</surname><given-names>Dmitry</given-names></name>
        <name><surname>Berens</surname><given-names>Philipp</given-names></name>
      </person-group>
      <article-title>The art of using t-SNE for single-cell transcriptomics</article-title>
      <source>Nature Communications</source>
      <publisher-name>Nature Publishing Group</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>10</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1038/s41467-019-13056-x</uri>
      <pub-id pub-id-type="doi">10.1038/s41467-019-13056-x</pub-id>
      <fpage>5416</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-pachter">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chari</surname><given-names>Tara</given-names></name>
        <name><surname>Pachter</surname><given-names>Lior</given-names></name>
      </person-group>
      <article-title>The specious art of single-cell genomics</article-title>
      <source>PLoS Computational Biology</source>
      <publisher-name>Public Library of Science</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>19</volume>
      <issue>8</issue>
      <uri>https://doi.org/10.1371/journal.pcbi.1011288</uri>
      <pub-id pub-id-type="doi">10.1371/journal.pcbi.1011288</pub-id>
      <fpage>e1011288</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-faiss">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Douze</surname><given-names>Matthijs</given-names></name>
        <name><surname>Guzhva</surname><given-names>Alexandr</given-names></name>
        <name><surname>Deng</surname><given-names>Chengqi</given-names></name>
        <name><surname>Johnson</surname><given-names>Jeff</given-names></name>
        <name><surname>Szilvasy</surname><given-names>Gergely</given-names></name>
        <name><surname>Mazaré</surname><given-names>Pierre-Emmanuel</given-names></name>
        <name><surname>Lomeli</surname><given-names>Maria</given-names></name>
        <name><surname>Hosseini</surname><given-names>Lucas</given-names></name>
        <name><surname>Jégou</surname><given-names>Hervé</given-names></name>
      </person-group>
      <article-title>The FAISS library</article-title>
      <year iso-8601-date="2024">2024</year>
      <uri>https://arxiv.org/abs/2401.08281</uri>
    </element-citation>
  </ref>
  <ref id="ref-JL">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>William B.</given-names></name>
        <name><surname>Lindenstrauss</surname><given-names>Joram</given-names></name>
      </person-group>
      <article-title>Extensions of Lipschitz mappings into a Hilbert space</article-title>
      <source>Contemporary Mathematics</source>
      <publisher-name>American Mathematical Society</publisher-name>
      <year iso-8601-date="1984">1984</year>
      <volume>26</volume>
      <uri>https://doi.org/10.1090/conm/026</uri>
      <pub-id pub-id-type="doi">10.1090/conm/026</pub-id>
      <fpage>189</fpage>
      <lpage>206</lpage>
    </element-citation>
  </ref>
  <ref id="ref-chazal-persistence">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chazal</surname><given-names>Frédéric</given-names></name>
        <name><surname>Silva</surname><given-names>Vin de</given-names></name>
        <name><surname>Oudot</surname><given-names>Steve</given-names></name>
      </person-group>
      <article-title>Persistence stability for geometric complexes</article-title>
      <source>Geometriae Dedicata</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2014">2014</year>
      <volume>173</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1007/s10711-013-9937-z</uri>
      <pub-id pub-id-type="doi">10.1007/s10711-013-9937-z</pub-id>
      <fpage>193</fpage>
      <lpage>214</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
