<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8111</article-id>
<article-id pub-id-type="doi">10.21105/joss.08111</article-id>
<title-group>
<article-title>Heatwave Diagnostics Package: Efficiently Compute
Heatwave Metrics Across Parameter Spaces</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5526-966X</contrib-id>
<name>
<surname>Cummins</surname>
<given-names>Cameron</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4690-0867</contrib-id>
<name>
<surname>Persad</surname>
<given-names>Geeta</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Earth and Planetary Sciences, Jackson School
of Geoscience, The University of Texas at Austin, Austin, TX,
USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2026-01-22">
<day>22</day>
<month>1</month>
<year>2026</year>
</pub-date>
<volume>11</volume>
<issue>118</issue>
<fpage>8111</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2026</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>heat</kwd>
<kwd>heatwave</kwd>
<kwd>diagnostics</kwd>
<kwd>python</kwd>
<kwd>xarray</kwd>
<kwd>dask</kwd>
<kwd>large ensemble</kwd>
<kwd>netcdf</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>The heatwave diagnostics package (<monospace>HDP</monospace>) is a
  Python package that provides the climate research community with tools
  to compute heatwave metrics for the large volumes of data produced by
  earth system model large ensembles, across multiple measures of heat,
  extreme heat thresholds, and heatwave definitions. The
  <monospace>HDP</monospace> leverages performance-oriented design using
  xarray, Dask, and Numba to maximize the use of available hardware
  resources while maintaining accessibility through an intuitive
  interface and well-documented user guide. This approach empowers the
  user to generate metrics for a wide and diverse range of heatwave
  types across the parameter space.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Accurate quantification of the evolution of heatwave trends in
  climate model output is critical for evaluating future changes in
  hazard. The framework for indexing heatwaves by comparing a
  time-evolving measure of heat against some seasonally-varying
  percentile threshold is well-established in the literature (Baldwin et
  al.
  (<xref alt="2019" rid="ref-baldwin_temporally_2019" ref-type="bibr">2019</xref>);
  Schoetter et al.
  (<xref alt="2015" rid="ref-schoetter_changes_2015" ref-type="bibr">2015</xref>);
  Acero et al.
  (<xref alt="2024" rid="ref-acero_changes_2024" ref-type="bibr">2024</xref>);
  Argüeso et al.
  (<xref alt="2016" rid="ref-argueso_seasonal_2016" ref-type="bibr">2016</xref>)).
  Metrics such as heatwave frequency and duration are commonly used in
  hazard assessments, but there are few centralized tools and no
  universal heatwave criteria for computing them. This has resulted in
  parameter heterogeneity across the literature and has prompted
  researchers to adopt multiple definitions to build robustness (Sarah
  E. Perkins
  (<xref alt="2015" rid="ref-perkins_review_2015" ref-type="bibr">2015</xref>)).
  Although studies could attempt to report metrics across larger
  parameter spaces, the excessive data management costs and
  computational burden of sampling more parameters makes it increasingly
  complex and expensive (S. E. Perkins &amp; Alexander
  (<xref alt="2013" rid="ref-perkins_measurement_2013" ref-type="bibr">2013</xref>)).
  The introduction of large ensembles has further exacerbated this
  issue. New heatwave packages have been developed to simplify the
  analysis, but they are often not optimized specifically for evaluating
  the potential sensitivities of heatwave hazard to the selections of
  heat measure, extreme heat threshold, and heatwave definition.</p>
  <p>Development of the <monospace>HDP</monospace> was initially focused
  on addressing the challenges of handling terabyte-scale ensembles, but
  then quickly expanded to investigate new scientific questions around
  how the selection of characteristic heatwave parameters may impact
  hazard analysis. The <monospace>HDP</monospace> can provide insight
  into how the spatial-temporal response of heatwaves to climate
  perturbations depends on the choice of heatwave parameters. While
  other software packages primarly focus on calculating heatwave metrics
  for individual parameter selections
  (e.g. <monospace>heatwave3</monospace>(<xref alt="Schlegel et al., 2024" rid="ref-hw" ref-type="bibr">Schlegel
  et al., 2024</xref>),
  <monospace>xclim</monospace>(<xref alt="Bourgault et al., 2023" rid="ref-xclim" ref-type="bibr">Bourgault
  et al., 2023</xref>),
  <monospace>ehfheatwaves</monospace>(<xref alt="Loughran, 2021" rid="ref-ehfheatwaves" ref-type="bibr">Loughran,
  2021</xref>)), the <monospace>HDP</monospace> builds on these tools to
  efficiently evaluate metrics across large ranges of the parameter
  space.</p>
</sec>
<sec id="key-features">
  <title>Key Features</title>
  <sec id="extension-of-xarray-with-implementations-of-dask-and-numba">
    <title>Extension of Xarray with Implementations of Dask and
    Numba</title>
    <p><monospace>xarray</monospace> is a popular Python package used
    for geospatial analysis and for working with the netCDF files
    produced by climate models. The <monospace>HDP</monospace> workflow
    is based around <monospace>xarray</monospace> and seamlessly
    integrates with the <monospace>xarray.DataArray</monospace> data
    structure. Parallelization of <monospace>HDP</monospace> functions
    is achieved through the integration of <monospace>dask</monospace>
    with automated chunking and task graph construction features built
    into the <monospace>xarray</monospace> library.</p>
  </sec>
  <sec id="heatwave-metrics-for-multiple-measures-thresholds-and-definitions">
    <title>Heatwave Metrics for Multiple Measures, Thresholds, and
    Definitions</title>
    <p>The “heatwave parameter space” refers to the span of measures,
    thresholds, and definitions that define individual heatwave “types”
    as described in Table
    <xref alt="1" rid="tableU003Aparams">1</xref>.</p>
    <table-wrap>
      <caption>
        <p>Parameters that define the “heatwave parameter space” and can
        be sampled using the HDP.
        <styled-content id="tableU003Aparams"></styled-content></p>
      </caption>
      <table>
        <colgroup>
          <col width="31%" />
          <col width="41%" />
          <col width="28%" />
        </colgroup>
        <thead>
          <tr>
            <th align="center">Parameter</th>
            <th align="center">Description</th>
            <th align="center">Example</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center">Measure</td>
            <td align="center">The daily variable used to quantify
            heat.</td>
            <td align="center">Average temperature, minimum temperature,
            maximum temperature, heat index, etc.</td>
          </tr>
          <tr>
            <td align="center">Threshold</td>
            <td align="center">The minimum value of heat measure that
            indicates a “hot day.” The threshold can be constant or
            change relative to the day of year and/or location.</td>
            <td align="center">90th percentile temperature for each day
            of the year derived from observed temperatures from 1961 to
            1990.</td>
          </tr>
          <tr>
            <td align="center">Definition</td>
            <td align="center">“X-Y-Z” where X indicates the minimum
            number of consecutive hot days, Y indicates the maximum
            number of non-hot days that can break up a heatwave, and Z
            indicates the maximum number of breaks.</td>
            <td align="center">“3-0-0” (three-day heatwaves), “3-1-1”
            (three-day heatwaves with possible one-day breaks)</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>The <monospace>HDP</monospace> allows the user to test a range of
    parameter values: for example, heatwaves that exceed 90th, 91st, …
    99th percentile thresholds for 3-day, 4-day, … 7-day heatwaves. Four
    heatwave metrics that evaluate the temporal patterns in each grid
    cell are calculated for each measure and aggregated into a
    <monospace>xarray.Dataset</monospace>. Detailed descriptions of
    these metrics are shown in Table
    <xref alt="2" rid="tableU003Ametrics">2</xref>.</p>
    <table-wrap>
      <caption>
        <p>Description of the heatwave metrics produced by the HDP.
        <styled-content id="tableU003Ametrics"></styled-content></p>
      </caption>
      <table>
        <colgroup>
          <col width="19%" />
          <col width="31%" />
          <col width="19%" />
          <col width="31%" />
        </colgroup>
        <thead>
          <tr>
            <th align="center">Metric</th>
            <th align="center">Long Name</th>
            <th align="center">Units</th>
            <th align="center">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="center">HWF</td>
            <td align="center">heatwave frequency</td>
            <td align="center">days</td>
            <td align="center">The number of heatwave days per heatwave
            season.</td>
          </tr>
          <tr>
            <td align="center">HWN</td>
            <td align="center">heatwave number</td>
            <td align="center">events</td>
            <td align="center">The number of heatwaves per heatwave
            season.</td>
          </tr>
          <tr>
            <td align="center">HWA</td>
            <td align="center">heatwave average</td>
            <td align="center">days</td>
            <td align="center">The average length of heatwaves per
            heatwave season.</td>
          </tr>
          <tr>
            <td align="center">HWD</td>
            <td align="center">heatwave duration</td>
            <td align="center">days</td>
            <td align="center">The length of the longest heatwave per
            heatwave season.</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
  <sec id="diagnostic-notebooks-and-figures">
    <title>Diagnostic Notebooks and Figures</title>
    <p>The automatic workflow compiles a “figure deck” containing
    diagnostic plots for multiple heatwave parameters and input
    variables. To simplify this process, figure decks are serialized and
    stored in a single Jupyter Notebook separated into descriptive
    sections. Basic descriptions are included in markdown cells at the
    top of each figure. The <monospace>HDPNotebook</monospace> class in
    <monospace>hdp.graphics.notebook</monospace> is utilized to
    facilitate the generation of these Notebooks internally, but can be
    called through the API as well to build custom notebooks. An example
    figure of HWF from the sample figure deck is shown in Figure
    <xref alt="[fig:notebook]" rid="figU003Anotebook">[fig:notebook]</xref>.</p>
    <fig>
      <caption><p>Example of an HDP standard figure deck
      <styled-content id="figU003Anotebook"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="ExampleFigure.png" />
    </fig>
  </sec>
</sec>
<sec id="ongoing-work">
  <title>Ongoing Work</title>
  <p>This package was used to produce the results featured in a research
  manuscript currently undergoing the peer-review process in a
  scientific journal. Updates to the <monospace>HDP</monospace> are
  ongoing.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We thank Dr. Tammas Loughran, Dr. Jane Baldwin, and Dr. Sarah
  Perkins-Kirkpatrick for their work on developing the initial Python
  software and heatwave analysis framework that inspired this project.
  Dr. Loughran’s Python package is available on
  <ext-link ext-link-type="uri" xlink:href="https://tammasloughran.github.io/ehfheatwaves/">GitHub</ext-link>.
  This work is partially supported by the Modeling, Analysis,
  Predictions, and Projections Award Program under the National Oceanic
  and Atmospheric Administration (Award Number NA23OAE4310601).</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-ehfheatwaves">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Loughran</surname><given-names>Tammas</given-names></name>
      </person-group>
      <article-title>tammasloughran/ehfheatwaves: First zenodo release</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <uri>https://doi.org/10.5281/zenodo.5637520</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.5637520</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-xclim">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bourgault</surname><given-names>Pascal</given-names></name>
        <name><surname>Huard</surname><given-names>David</given-names></name>
        <name><surname>Smith</surname><given-names>Trevor James</given-names></name>
        <name><surname>Logan</surname><given-names>Travis</given-names></name>
        <name><surname>Aoun</surname><given-names>Abel</given-names></name>
        <name><surname>Lavoie</surname><given-names>Juliette</given-names></name>
        <name><surname>Dupuis</surname><given-names>Éric</given-names></name>
        <name><surname>Rondeau-Genesse</surname><given-names>Gabriel</given-names></name>
        <name><surname>Alegre</surname><given-names>Raquel</given-names></name>
        <name><surname>Barnes</surname><given-names>Clair</given-names></name>
        <name><surname>Laperrière</surname><given-names>Alexis Beaupré</given-names></name>
        <name><surname>Biner</surname><given-names>Sébastien</given-names></name>
        <name><surname>Caron</surname><given-names>David</given-names></name>
        <name><surname>Ehbrecht</surname><given-names>Carsten</given-names></name>
        <name><surname>Fyke</surname><given-names>Jeremy</given-names></name>
        <name><surname>Keel</surname><given-names>Tom</given-names></name>
        <name><surname>Labonté</surname><given-names>Marie-Pier</given-names></name>
        <name><surname>Lierhammer</surname><given-names>Ludwig</given-names></name>
        <name><surname>Low</surname><given-names>Jwen-Fai</given-names></name>
        <name><surname>Quinn</surname><given-names>Jamie</given-names></name>
        <name><surname>Roy</surname><given-names>Philippe</given-names></name>
        <name><surname>Squire</surname><given-names>Dougie</given-names></name>
        <name><surname>Stephens</surname><given-names>Ag</given-names></name>
        <name><surname>Tanguy</surname><given-names>Maliko</given-names></name>
        <name><surname>Whelan</surname><given-names>Christopher</given-names></name>
      </person-group>
      <article-title>Xclim: Xarray-based climate data analytics</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>8</volume>
      <issue>85</issue>
      <uri>https://doi.org/10.21105/joss.05415</uri>
      <pub-id pub-id-type="doi">10.21105/joss.05415</pub-id>
      <fpage>5415</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-hw">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Schlegel</surname><given-names>Robert W.</given-names></name>
        <name><surname>Pinto</surname><given-names>Guilherme</given-names></name>
        <name><surname>Genevier</surname><given-names>Lily</given-names></name>
        <name><surname>Cohen</surname><given-names>Jacob</given-names></name>
        <name><surname>Dasgupta</surname><given-names>Panini</given-names></name>
        <name><surname>Meeker</surname><given-names>Evan</given-names></name>
        <name><surname>Beaudin</surname><given-names>Elise</given-names></name>
        <name><surname>Smit</surname><given-names>Albertus J.</given-names></name>
      </person-group>
      <source>heatwave3: Detect heatwaves and cold-spells within cubed data</source>
      <year iso-8601-date="2024">2024</year>
      <uri>https://robwschlegel.github.io/heatwave3/index.html</uri>
    </element-citation>
  </ref>
  <ref id="ref-perkins_review_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Perkins</surname><given-names>Sarah E.</given-names></name>
      </person-group>
      <article-title>A review on the scientific understanding of heatwaves—Their measurement, driving mechanisms, and changes at the global scale</article-title>
      <source>Atmospheric Research</source>
      <year iso-8601-date="2015-10">2015</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-02-18">2025</year><month>02</month><day>18</day></date-in-citation>
      <volume>164-165</volume>
      <issn>0169-8095</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0169809515001738</uri>
      <pub-id pub-id-type="doi">10.1016/j.atmosres.2015.05.014</pub-id>
      <fpage>242</fpage>
      <lpage>267</lpage>
    </element-citation>
  </ref>
  <ref id="ref-perkins_measurement_2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Perkins</surname><given-names>S. E.</given-names></name>
        <name><surname>Alexander</surname><given-names>L. V.</given-names></name>
      </person-group>
      <article-title>On the Measurement of Heat Waves</article-title>
      <year iso-8601-date="2013-07">2013</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-02-18">2025</year><month>02</month><day>18</day></date-in-citation>
      <uri>https://journals.ametsoc.org/view/journals/clim/26/13/jcli-d-12-00383.1.xml</uri>
      <pub-id pub-id-type="doi">10.1175/JCLI-D-12-00383.1</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-schoetter_changes_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schoetter</surname><given-names>Robert</given-names></name>
        <name><surname>Cattiaux</surname><given-names>Julien</given-names></name>
        <name><surname>Douville</surname><given-names>Hervé</given-names></name>
      </person-group>
      <article-title>Changes of western European heat wave characteristics projected by the CMIP5 ensemble</article-title>
      <source>Climate Dynamics</source>
      <year iso-8601-date="2015-09">2015</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-02-18">2025</year><month>02</month><day>18</day></date-in-citation>
      <volume>45</volume>
      <issue>5</issue>
      <issn>1432-0894</issn>
      <uri>https://doi.org/10.1007/s00382-014-2434-8</uri>
      <pub-id pub-id-type="doi">10.1007/s00382-014-2434-8</pub-id>
      <fpage>1601</fpage>
      <lpage>1616</lpage>
    </element-citation>
  </ref>
  <ref id="ref-acero_changes_2024">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Acero</surname><given-names>F. J.</given-names></name>
        <name><surname>Fernández-Fernández</surname><given-names>M. I.</given-names></name>
        <name><surname>Carrasco</surname><given-names>V. M. S.</given-names></name>
        <name><surname>Parey</surname><given-names>S.</given-names></name>
        <name><surname>Hoang</surname><given-names>T. T. Huong</given-names></name>
        <name><surname>Dacunha-Castelle</surname><given-names>D.</given-names></name>
        <name><surname>García</surname><given-names>J. A.</given-names></name>
      </person-group>
      <article-title>Changes in heat waves characteristics over Extremadura (SW Spain)</article-title>
      <publisher-name>arXiv</publisher-name>
      <year iso-8601-date="2024-02">2024</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-02-18">2025</year><month>02</month><day>18</day></date-in-citation>
      <uri>http://arxiv.org/abs/2402.00514</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2402.00514</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-baldwin_temporally_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Baldwin</surname><given-names>Jane Wilson</given-names></name>
        <name><surname>Dessy</surname><given-names>Jay Benjamin</given-names></name>
        <name><surname>Vecchi</surname><given-names>Gabriel A.</given-names></name>
        <name><surname>Oppenheimer</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>Temporally Compound Heat Wave Events and Global Warming: An Emerging Hazard</article-title>
      <source>Earth’s Future</source>
      <year iso-8601-date="2019">2019</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-02-18">2025</year><month>02</month><day>18</day></date-in-citation>
      <volume>7</volume>
      <issue>4</issue>
      <issn>2328-4277</issn>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1029/2018EF000989</uri>
      <pub-id pub-id-type="doi">10.1029/2018EF000989</pub-id>
      <fpage>411</fpage>
      <lpage>427</lpage>
    </element-citation>
  </ref>
  <ref id="ref-argueso_seasonal_2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Argüeso</surname><given-names>Daniel</given-names></name>
        <name><surname>Di Luca</surname><given-names>Alejandro</given-names></name>
        <name><surname>Perkins-Kirkpatrick</surname><given-names>Sarah E.</given-names></name>
        <name><surname>Evans</surname><given-names>Jason P.</given-names></name>
      </person-group>
      <article-title>Seasonal mean temperature changes control future heat waves</article-title>
      <source>Geophysical Research Letters</source>
      <year iso-8601-date="2016">2016</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-11-18">2023</year><month>11</month><day>18</day></date-in-citation>
      <volume>43</volume>
      <issue>14</issue>
      <issn>1944-8007</issn>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1002/2016GL069408</uri>
      <pub-id pub-id-type="doi">10.1002/2016GL069408</pub-id>
      <fpage>7653</fpage>
      <lpage>7660</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
