<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8754</article-id>
<article-id pub-id-type="doi">10.21105/joss.08754</article-id>
<title-group>
<article-title>THz Image Explorer - An Interactive Cross-Platform
Open-Source THz Image Analysis Tool</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7916-2592</contrib-id>
<name>
<surname>Stöckli</surname>
<given-names>Linus Leo</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0002-6920-475X</contrib-id>
<name>
<surname>Demion</surname>
<given-names>Arnaud</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0146-0071</contrib-id>
<name>
<surname>Thomas</surname>
<given-names>Nicolas</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Space Research &amp; Planetary Sciences Division,
University of Bern, Bern, Switzerland</institution>
<institution-id institution-id-type="ROR">02k7v4d05</institution-id>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>University of Applied Sciences and Arts Western Switzerland
Valais, HES-SO Valais-Wallis, Sion, Switzerland</institution>
<institution-id institution-id-type="ROR">03r5zec51</institution-id>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-07-03">
<day>3</day>
<month>7</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>115</issue>
<fpage>8754</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>THz</kwd>
<kwd>Rust</kwd>
<kwd>Imaging</kwd>
<kwd>Data Analysis</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="introduction">
  <title>Introduction</title>
  <p>THz time-domain spectroscopy (TDS) is a fast-growing field with
  applications to perform non-destructive studies of material properties
  (<xref alt="Neu &amp; Schmuttenmaer, 2018" rid="ref-neu_tutorial_2018" ref-type="bibr">Neu
  &amp; Schmuttenmaer, 2018</xref>). The pulses can either be measured
  after passing through (transmission spectrum) or after being reflected
  by (reflection spectrum) a sample. Through Fourier analysis (FFT), we
  can investigate the complex refractive index and absorption
  coefficient of the sample. By placing either the sample or the optical
  setup on a moving stage the sample can be imaged in 2D.</p>
  <fig id="id">
    <caption><p>THz Image Explorer
    icon.<styled-content id="figU003Aicon"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="icon.png" />
  </fig>
  <p>We developed an interactive graphical user interface (GUI), written
  in
  <ext-link ext-link-type="uri" xlink:href="https://www.rust-lang.org">Rust</ext-link>
  (<xref alt="Matsakis &amp; Klock II, 2014" rid="ref-matsakis2014rust" ref-type="bibr">Matsakis
  &amp; Klock II, 2014</xref>), to aid in investigating acquired 2D
  scans. The application implements the dotTHz standard
  (<xref alt="Lee et al., 2023" rid="ref-lee_dotthz_2023" ref-type="bibr">Lee
  et al., 2023</xref>) and is platform independent and open-source,
  making it easier to maintain and increasing its reach.</p>
  <fig>
    <caption><p>THz Image Explorer
    screenshot.<styled-content id="figU003Ascreenshot"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="screenshot.png" />
  </fig>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Interactive analysis tools for THz spectroscopy are essential to
  browse through images and analyse different regions of interest
  efficiently. Commercial suppliers provide closed-source analysis tools
  (e.g. <ext-link ext-link-type="uri" xlink:href="https://www.menlosystems.com">Menlo
  Systems</ext-link>) where the code cannot be adapted by the user,
  which is often essential in research environments and extends the
  maintainability of the code. Solutions published by the scientific
  community are not available on all platforms, are only applicable on
  single pixel measurements and/or are not focused on an interactive
  workflow
  (<xref alt="Loaiza et al., 2024" rid="ref-loaiza_thztools_2024" ref-type="bibr">Loaiza
  et al., 2024</xref>;
  <xref alt="Peretti et al., 2019" rid="ref-peretti_thz-tds_2019" ref-type="bibr">Peretti
  et al., 2019</xref>). With this application, we provide a
  high-performance solution written in Rust that allows an interactive
  analysis of 2D THz scans with multiple filters and a 3D viewer. The
  work is open-source, and pre-built bundles are provided for Linux,
  macOS, and Windows, ensuring broad accessibility for the scientific
  community.</p>
</sec>
<sec id="structure">
  <title>Structure</title>
  <p>The application is multithreaded with two main threads:</p>
  <list list-type="bullet">
    <list-item>
      <p>GUI thread,</p>
    </list-item>
    <list-item>
      <p>Data thread.</p>
    </list-item>
  </list>
  <p>The GUI uses
  <ext-link ext-link-type="uri" xlink:href="https://www.egui.rs">egui</ext-link>,
  an immediate-mode GUI library for rust.</p>
  <p>The structure of the software is shown in figure
  <xref alt="[fig:software-architecture]" rid="figU003Asoftware-architecture">[fig:software-architecture]</xref>.</p>
  <fig>
    <caption><p>Software
    Architecture.<styled-content id="figU003Asoftware-architecture"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="thz-image-explorer.drawio.png" />
  </fig>
</sec>
<sec id="usage">
  <title>Usage</title>
  <p>A sample scan (of a resolution target) is available in the
  <monospace>sample_data</monospace> directory. The measurement has been
  acquired using the COCoNuT setup
  (<xref alt="Stöckli et al., 2025" rid="ref-coconut_2025" ref-type="bibr">Stöckli
  et al., 2025</xref>).</p>
  <sec id="optical-properties-calculation">
    <title>Optical Properties Calculation</title>
    <p>The user can select a source and reference scan in the drop-down
    menu, after which the refractive index
    <inline-formula><alternatives>
    <tex-math><![CDATA[n]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>
    and absorption coefficient <inline-formula><alternatives>
    <tex-math><![CDATA[\alpha]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula>
    are computed according to
    (<xref alt="Jepsen, 2019" rid="ref-Jepsen2019" ref-type="bibr">Jepsen,
    2019</xref>) <disp-formula><alternatives>
    <tex-math><![CDATA[n(\omega) = 1 + \frac{c \Delta\phi(\omega)}{\omega d},]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi>c</mml:mi><mml:mi>Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>ω</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
    <disp-formula><alternatives>
    <tex-math><![CDATA[\alpha(\omega) = -\frac{2}{d} \ln\left(\frac{(n+1)^2}{4n} \cdot \frac{A_{\text{sample}}(\omega)}{A_{\text{reference}}(\omega)}\right),]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>α</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>−</mml:mi><mml:mfrac><mml:mn>2</mml:mn><mml:mi>d</mml:mi></mml:mfrac><mml:mo>ln</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>4</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mtext mathvariant="normal">sample</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mtext mathvariant="normal">reference</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
    where</p>
    <list list-type="bullet">
      <list-item>
        <p><inline-formula><alternatives>
        <tex-math><![CDATA[\Delta\phi(\omega) = \phi_{\text{sample}}(\omega) - \phi_{\text{reference}}(\omega)]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mtext mathvariant="normal">sample</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>ϕ</mml:mi><mml:mtext mathvariant="normal">reference</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
        is the phase difference,</p>
      </list-item>
      <list-item>
        <p><inline-formula><alternatives>
        <tex-math><![CDATA[A_{\text{sample}}(\omega)]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mtext mathvariant="normal">sample</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
        and <inline-formula><alternatives>
        <tex-math><![CDATA[A_{\text{reference}}(\omega)]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mtext mathvariant="normal">reference</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ω</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
        are the amplitude spectra,</p>
      </list-item>
      <list-item>
        <p><inline-formula><alternatives>
        <tex-math><![CDATA[c]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>
        is the speed of light,</p>
      </list-item>
      <list-item>
        <p><inline-formula><alternatives>
        <tex-math><![CDATA[\omega = 2\pi f]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ω</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
        is the angular frequency,</p>
      </list-item>
      <list-item>
        <p><inline-formula><alternatives>
        <tex-math><![CDATA[d]]></tex-math>
        <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>d</mml:mi></mml:math></alternatives></inline-formula>
        is the sample thickness.</p>
      </list-item>
    </list>
  </sec>
  <sec id="interactive-3d-viewer">
    <title>Interactive 3D Viewer</title>
    <p>A THz time domain scan produces a 3D data array with dimensions
    <inline-formula><alternatives>
    <tex-math><![CDATA[n_x \times n_y \times n_t]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
    where <inline-formula><alternatives>
    <tex-math><![CDATA[(n_x, n_y)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
    represent the spatial coordinates and <inline-formula><alternatives>
    <tex-math><![CDATA[n_t]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    represents the time axis.</p>
    <p>Scans performed in reflection can be visualized in 3D. First, we
    transform each time trace into an intensity value by computing the
    squared amplitude and applying a Gaussian envelope function
    <disp-formula><alternatives>
    <tex-math><![CDATA[
    I(x,y,t) = |s(x,y,t)|^2 * G_{\sigma}(t),
    ]]></tex-math>
    <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>s</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>*</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
    <p>where <inline-formula><alternatives>
    <tex-math><![CDATA[G_{\sigma}(t)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>σ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    is a normalized 1D Gaussian kernel with standard deviation
    <inline-formula><alternatives>
    <tex-math><![CDATA[\sigma = 6.0]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>σ</mml:mi><mml:mo>=</mml:mo><mml:mn>6.0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    and radius of 12 samples, applied via convolution to smooth the
    squared signal and extract the envelope as shown in figure
    <xref alt="[fig:envelope]" rid="figU003Aenvelope">[fig:envelope]</xref>.</p>
    <fig>
      <caption><p>The convoluted envelope of the signal. All datapoints
      below the indicated threshold are treated as transparent.
      <styled-content id="figU003Aenvelope"></styled-content></p></caption>
      <graphic mimetype="application" mime-subtype="pdf" xlink:href="convolution_example.pdf" />
    </fig>
    <p>The time axis is converted to a spatial distance coordinate by
    assuming a refractive index of <inline-formula><alternatives>
    <tex-math><![CDATA[n=1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    and using the relation <inline-formula><alternatives>
    <tex-math><![CDATA[z = ct/2]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>z</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
    where <inline-formula><alternatives>
    <tex-math><![CDATA[c]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>c</mml:mi></mml:math></alternatives></inline-formula>
    is the speed of light and the factor of 2 accounts for the signal’s
    round-trip. This transformation yields a 3D intensity cube
    <inline-formula><alternatives>
    <tex-math><![CDATA[I(x,y,z)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
    <p>Each element (voxel) in this cube represents the THz signal
    intensity at a specific point in 3D space, enabling visualization of
    reflections from internal interfaces and sub-surface structures. The
    computed intensities are mapped to voxel opacity values; regions
    with high intensity appear opaque while low-intensity regions become
    transparent.</p>
    <p>The 3D viewer is implemented using the
    <monospace>bevy</monospace> game engine
    (<xref alt="Contributors, 2025" rid="ref-bevyengine" ref-type="bibr">Contributors,
    2025</xref>) with a custom WGSL shader, available as a separate
    crate under the name
    <ext-link ext-link-type="uri" xlink:href="https://github.com/hacknus/bevy_voxel_plot">bevy_voxel_plot</ext-link>.</p>
  </sec>
  <sec id="filtering-pipeline">
    <title>Filtering pipeline</title>
    <p>The filtering process is a simple linear pipeline, where the
    output of one filter is the input of the next filter. Filters can be
    placed in the following specific domains:</p>
    <list list-type="bullet">
      <list-item>
        <p>Time Domain Before FFT,</p>
      </list-item>
      <list-item>
        <p>Frequency Band Pass Filter,</p>
      </list-item>
      <list-item>
        <p>Time Domain After FFT.</p>
      </list-item>
    </list>
    <p>Band-pass filters are already implemented in the application for
    each domain. The band-pass filter in time domain before FFT can be
    used to trim off trailing pulses. By selecting a slice in time
    domain after FFT, it is possible to scan through the
    <inline-formula><alternatives>
    <tex-math><![CDATA[z]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>z</mml:mi></mml:math></alternatives></inline-formula>-axis
    of the scan and analyse sub-surface layers
    (<xref alt="Koch-Dandolo et al., 2015" rid="ref-koch-dandolo_reflection_2015" ref-type="bibr">Koch-Dandolo
    et al., 2015</xref>).</p>
    <sec id="deconvolution">
      <title>Deconvolution</title>
      <p>The deconvolution filter is an implementation of the
      Frequency-dependent Richardson – Lucy algorithm described in
      (<xref alt="Demion et al., 2025" rid="ref-demion_frequency-dependent_2025" ref-type="bibr">Demion
      et al., 2025</xref>).</p>
    </sec>
    <sec id="custom-filters">
      <title>Custom Filters</title>
      <p>The code-base can easily be extended with custom filters. The
      user needs to create a custom file in the
      <monospace>src/filters</monospace> directory with a struct that
      implements the <monospace>Filter</monospace> trait.</p>
    </sec>
  </sec>
</sec>
<sec id="summary">
  <title>Summary</title>
  <p>THz Image Explorer primarily serves as a high-performance data
  analysis tool for THz 2D images. Its main focus lies on preliminary
  browsing of measurements, rough analysis of scans and identifying
  regions of interest in each scan. It is designed in a modular way to
  allow possible implementation of more thorough analysis features in
  the future.</p>
</sec>
<sec id="declaration-of-the-use-of-ai-based-tools">
  <title>Declaration of the use of AI-based tools</title>
  <p>AI-based tools, including ChatGPT and GitHub Copilot, were used to
  support this work. These tools assisted with code generation but did
  not replace the author’s critical thinking or original contributions
  in any way. All content has been reviewed and validated by the authors
  to ensure accuracy and integrity.</p>
  <table-wrap>
    <table>
      <colgroup>
        <col width="16%" />
        <col width="53%" />
        <col width="14%" />
        <col width="17%" />
      </colgroup>
      <thead>
        <tr>
          <th><bold>AI-based tool</bold></th>
          <th><bold>Model</bold></th>
          <th><bold>Use Case</bold></th>
          <th><bold>Remarks</bold></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>ChatGPT</td>
          <td>GPT-3, GPT-4, GPT-4o, GPT-5</td>
          <td>Code generation</td>
          <td>Rust, Python</td>
        </tr>
        <tr>
          <td>GitHub Copilot</td>
          <td>GPT-4o, GPT-5, Claude Sonnet 3.5, Claude Sonnet 3.7,
          Gemini 2.5</td>
          <td>Code generation</td>
          <td>Rust, Python, Swift</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work was supported through a MARVIS (Multidisciplinary
  Advanced Research Ventures in Space) programme of the Swiss Department
  for Business, Education, and Research (SBFI) called SUBICE. SUBICE is
  a project of the University of Bern (UniBe), the University of Applied
  Sciences and Arts, Western Switzerland (HES-SO), and Thales-Alenia
  Space Switzerland (TASCH). The project has been partially funded by
  the European Space Agency (ESA) under the ESA Initial Support for
  Innovation (EISI) program. We acknowledge the support of the Open
  Space Innovation Platform (OSIP) and in particular Nicolas Thiry and
  Leopold Summerer.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-matsakis2014rust">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Matsakis</surname><given-names>Nicholas D</given-names></name>
        <name><surname>Klock II</surname><given-names>Felix S</given-names></name>
      </person-group>
      <article-title>The rust language</article-title>
      <source>ACM SIGAda ada letters</source>
      <publisher-name>ACM</publisher-name>
      <year iso-8601-date="2014">2014</year>
      <volume>34</volume>
      <pub-id pub-id-type="doi">10.1145/2692956.2663188</pub-id>
      <fpage>103</fpage>
      <lpage>104</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bevyengine">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Contributors</surname><given-names>Bevy</given-names></name>
      </person-group>
      <article-title>Bevy engine</article-title>
      <publisher-name>https://github.com/bevyengine/bevy/releases/tag/v0.16.1</publisher-name>
      <year iso-8601-date="2025-05-31">2025</year><month>05</month><day>31</day>
    </element-citation>
  </ref>
  <ref id="ref-coconut_2025">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Stöckli</surname><given-names>Linus Leo</given-names></name>
        <name><surname>Brändli</surname><given-names>Mathias</given-names></name>
        <name><surname>Piazza</surname><given-names>Daniele</given-names></name>
        <name><surname>Ottersberg</surname><given-names>Rafael</given-names></name>
        <name><surname>Pommerol</surname><given-names>Antoine</given-names></name>
        <name><surname>Murk</surname><given-names>Axel</given-names></name>
        <name><surname>Thomas</surname><given-names>Nicolas</given-names></name>
      </person-group>
      <article-title>Design and commissioning of a THz time-domain spectro-goniometer in a cryogenic comet simulation chamber</article-title>
      <source>Review of Scientific Instruments</source>
      <year iso-8601-date="2025-03">2025</year><month>03</month>
      <volume>96</volume>
      <issue>3</issue>
      <issn>0034-6748</issn>
      <uri>https://doi.org/10.1063/5.0252742</uri>
      <pub-id pub-id-type="doi">10.1063/5.0252742</pub-id>
      <fpage>034502</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Jepsen2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jepsen</surname><given-names>Peter Uhd</given-names></name>
      </person-group>
      <article-title>Phase retrieval in terahertz time-domain measurements: A “how to” tutorial</article-title>
      <source>Journal of Infrared, Millimeter, and Terahertz Waves</source>
      <year iso-8601-date="2019-04-01">2019</year><month>04</month><day>01</day>
      <volume>40</volume>
      <issue>4</issue>
      <issn>1866-6906</issn>
      <uri>https://doi.org/10.1007/s10762-019-00578-0</uri>
      <pub-id pub-id-type="doi">10.1007/s10762-019-00578-0</pub-id>
      <fpage>395</fpage>
      <lpage>411</lpage>
    </element-citation>
  </ref>
  <ref id="ref-demion_frequency-dependent_2025">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Demion</surname><given-names>Arnaud</given-names></name>
        <name><surname>Stöckli</surname><given-names>Linus Leo</given-names></name>
        <name><surname>Thomas</surname><given-names>Nicolas</given-names></name>
        <name><surname>Zahno</surname><given-names>Silvan</given-names></name>
      </person-group>
      <article-title>Frequency-dependent deconvolution for enhanced THz-TDS scans: Accounting for beam width variations in time traces</article-title>
      <source>IEEE Transactions on Terahertz Science and Technology</source>
      <year iso-8601-date="2025">2025</year>
      <volume>15</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1109/TTHZ.2025.3546756</pub-id>
      <fpage>505</fpage>
      <lpage>513</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lee_dotthz_2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lee</surname><given-names>Jongmin</given-names></name>
        <name><surname>Leung</surname><given-names>Chi Ki</given-names></name>
        <name><surname>Ma</surname><given-names>Mingrui</given-names></name>
        <name><surname>Ward-Berry</surname><given-names>Jasper</given-names></name>
        <name><surname>Santitewagun</surname><given-names>Supawan</given-names></name>
        <name><surname>Zeitler</surname><given-names>J. Axel</given-names></name>
      </person-group>
      <article-title>The dotTHz Project: A Standard Data Format for Terahertz Time-Domain Data</article-title>
      <source>Journal of Infrared, Millimeter, and Terahertz Waves</source>
      <year iso-8601-date="2023-12">2023</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-11-12">2024</year><month>11</month><day>12</day></date-in-citation>
      <volume>44</volume>
      <issue>11-12</issue>
      <issn>1866-6892</issn>
      <uri>https://link.springer.com/10.1007/s10762-023-00947-w</uri>
      <pub-id pub-id-type="doi">10.1007/s10762-023-00947-w</pub-id>
      <fpage>795</fpage>
      <lpage>813</lpage>
    </element-citation>
  </ref>
  <ref id="ref-koch-dandolo_reflection_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Koch-Dandolo</surname><given-names>Corinna L.</given-names></name>
        <name><surname>Filtenborg</surname><given-names>Troels</given-names></name>
        <name><surname>Fukunaga</surname><given-names>Kaori</given-names></name>
        <name><surname>Skou-Hansen</surname><given-names>Jacob</given-names></name>
        <name><surname>Jepsen</surname><given-names>Peter Uhd</given-names></name>
      </person-group>
      <article-title>Reflection terahertz time-domain imaging for analysis of an 18th century neoclassical easel painting</article-title>
      <source>Applied Optics</source>
      <year iso-8601-date="2015-06">2015</year><month>06</month>
      <volume>54</volume>
      <issue>16</issue>
      <pub-id pub-id-type="doi">10.1364/ao.54.005123</pub-id>
      <fpage>5123</fpage>
      <lpage>5123</lpage>
    </element-citation>
  </ref>
  <ref id="ref-loaiza_thztools_2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Loaiza</surname><given-names>Jonathan Posada</given-names></name>
        <name><surname>Higuera-Quintero</surname><given-names>Santiago</given-names></name>
        <name><surname>Noori</surname><given-names>Alireza</given-names></name>
        <name><surname>Mohtashemi</surname><given-names>Laleh</given-names></name>
        <name><surname>Hall</surname><given-names>R. P.</given-names></name>
        <name><surname>Yimam</surname><given-names>Naod Ayalew</given-names></name>
        <name><surname>Dodge</surname><given-names>J. Steven</given-names></name>
      </person-group>
      <article-title>THzTools: Data analysis software for terahertztime-domain spectroscopy</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2024-12">2024</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-01-24">2025</year><month>01</month><day>24</day></date-in-citation>
      <volume>9</volume>
      <issue>104</issue>
      <issn>2475-9066</issn>
      <uri>https://joss.theoj.org/papers/10.21105/joss.07542</uri>
      <pub-id pub-id-type="doi">10.21105/joss.07542</pub-id>
      <fpage>7542</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-neu_tutorial_2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Neu</surname><given-names>Jens</given-names></name>
        <name><surname>Schmuttenmaer</surname><given-names>Charles A.</given-names></name>
      </person-group>
      <article-title>Tutorial: An introduction to terahertz time domain spectroscopy (THz-TDS)</article-title>
      <source>Journal of Applied Physics</source>
      <year iso-8601-date="2018-12">2018</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-01-24">2025</year><month>01</month><day>24</day></date-in-citation>
      <volume>124</volume>
      <issue>23</issue>
      <issn>0021-8979</issn>
      <uri>https://pubs.aip.org/jap/article/124/23/231101/155935/Tutorial-An-introduction-to-terahertz-time-domain</uri>
      <pub-id pub-id-type="doi">10.1063/1.5047659</pub-id>
      <fpage>231101</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-peretti_thz-tds_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Peretti</surname><given-names>Romain</given-names></name>
        <name><surname>Mitryukovskiy</surname><given-names>Sergey</given-names></name>
        <name><surname>Froberger</surname><given-names>Kevin</given-names></name>
        <name><surname>Mebarki</surname><given-names>Mohamed Aniss</given-names></name>
        <name><surname>Eliet</surname><given-names>Sophie</given-names></name>
        <name><surname>Vanwolleghem</surname><given-names>Mathias</given-names></name>
        <name><surname>Lampin</surname><given-names>Jean-Francois</given-names></name>
      </person-group>
      <article-title>THz-TDS Time-Trace Analysis for the Extraction of Material and Metamaterial Parameters</article-title>
      <source>IEEE Transactions on Terahertz Science and Technology</source>
      <year iso-8601-date="2019-03">2019</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-01-24">2025</year><month>01</month><day>24</day></date-in-citation>
      <volume>9</volume>
      <issue>2</issue>
      <issn>2156-342X</issn>
      <uri>https://ieeexplore.ieee.org/document/8585050/</uri>
      <pub-id pub-id-type="doi">10.1109/TTHZ.2018.2889227</pub-id>
      <fpage>136</fpage>
      <lpage>149</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
