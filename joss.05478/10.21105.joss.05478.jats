<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">5478</article-id>
<article-id pub-id-type="doi">10.21105/joss.05478</article-id>
<title-group>
<article-title>PyPO: a Python package for Physical
Optics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0475-6134</contrib-id>
<name>
<surname>Moerman</surname>
<given-names>Arend</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gafaji</surname>
<given-names>Maikel H.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4562-5584</contrib-id>
<name>
<surname>Karatsu</surname>
<given-names>Kenichi</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0379-2341</contrib-id>
<name>
<surname>Endo</surname>
<given-names>Akira</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Faculty of Electrical Engineering, Mathematics and Computer
Science, Delft University of Technology, Mekelweg 4, 2628 CD, Delft, The
Netherlands</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>The Hague University of Applied Sciences, Johanna
Westerdijkplein 75, 2521 EN, The Hague, The Netherlands</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>SRON—Netherlands Institute for Space Research, Niels
Bohrweg 4, 2333 CA, Leiden, The Netherlands</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2023-04-26">
<day>26</day>
<month>4</month>
<year>2023</year>
</pub-date>
<volume>8</volume>
<issue>88</issue>
<fpage>5478</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Physical Optics</kwd>
<kwd>Geometrical Optics</kwd>
<kwd>Reflectors</kwd>
<kwd>Python</kwd>
<kwd>C++</kwd>
<kwd>CUDA</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>PyPO</monospace> is a Python interface for end-to-end
  design, simulation and analysis of (quasi-)optical reflector systems.
  It can model the forward and backward propagation of electromagnetic
  field distributions between multiple planar and (off-axis) quadric
  surfaces, as well as far-field propagation. Simulations are performed
  using either geometrical optics (GO) or the equivalent surface current
  approach, belonging to the field of physical optics (PO)
  (<xref alt="Balanis, 1989" rid="ref-BalanisU003A1989" ref-type="bibr">Balanis,
  1989</xref>). The GO and PO calculations are performed using libraries
  written in C++ and CUDA, allowing for multi-threading and GPU
  acceleration. Common figures of merit, such as aperture efficiency and
  half-power beamwidth, can be calculated and used for quantitative
  analysis of the designed system. Input beam patterns can be selected
  from a range of models, such as Gaussian beams, point sources and
  uniform current distributions. Custom beam patterns can also be
  imported to, for example, model the propagation of measured beam
  patterns through simulated optical systems.</p>
  <p><monospace>PyPO</monospace> can be used through either a
  scripting-based approach, where simulations are defined in Python
  scripts, or through the graphical user interface (GUI). It only
  carries core dependencies on NumPy
  (<xref alt="Harris &amp; others, 2020" rid="ref-HarrisU003A2020" ref-type="bibr">Harris
  &amp; others, 2020</xref>), Matplotlib
  (<xref alt="Hunter, 2007" rid="ref-HunterU003A2007" ref-type="bibr">Hunter,
  2007</xref>) and SciPy
  (<xref alt="Virtanen &amp; others, 2020" rid="ref-VirtanenU003A2020" ref-type="bibr">Virtanen
  &amp; others, 2020</xref>). The unittesting framework carries a
  dependency on nose2. The GUI carries dependencies on PySide6,
  pyqtdarktheme and attrs.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Development of <monospace>PyPO</monospace> started with the need
  for alignment strategies for the wideband sub-mm spectrometer DESHIMA
  2.0
  (<xref alt="Taniguchi &amp; others, 2022" rid="ref-TaniguchiU003A2022" ref-type="bibr">Taniguchi
  &amp; others, 2022</xref>). A software package capable of efficient GO
  and PO calulations through optical systems consisting of off-axis
  quadric surfaces was necessary for calculating the configuration of
  the corrective optics. Currently, <monospace>PyPO</monospace> is also
  being used in simulations of measured beam patterns of DESHIMA 2.0 at
  the ASTE
  (<xref alt="Ezawa &amp; others, 2004" rid="ref-ASTE" ref-type="bibr">Ezawa
  &amp; others, 2004</xref>) telescope for the analysis of instrument
  and optical system performance.</p>
  <p>Commercial software for GO/PO calculations and analysis, such as
  OpticStudio (Zemax) and GRASP (TICRA), has already been developed.
  Open-source optical simulation software packages such as POPPy (Perrin
  &amp; others, 2012) and Prysm (Dube, 2019) are also available. These
  open-source software packages use Fourier methods to solve the
  Rayleigh-Sommerfeld integral equation. <monospace>PyPO</monospace>
  aims to contribute to this open-source optical simulation ecosystem by
  offering a software package working on the principle of the equivalent
  surface currents.</p>
</sec>
<sec id="availability">
  <title>Availability</title>
  <p><monospace>PyPO</monospace> can be found on
  <ext-link ext-link-type="uri" xlink:href="https://github.com/PyPO-dev/PyPO">Github</ext-link>
  and is available for Linux, MacOS and Windows. Software documentation
  and instructions regarding installation, contributing and issue
  tracking can be found in the
  <ext-link ext-link-type="uri" xlink:href="https://pypo-dev.github.io/PyPO/">documentation</ext-link>.
  The package comes with several Jupyter Notebook tutorials illustrating
  the workflow and features, and can be used as building blocks for new
  reflector systems. Several tutorials for using the GUI features are
  also included and can be found in the software documentation.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We thank Shahab Oddin Dabironezare for useful discussions and
  proofreading the manuscript. This work is supported by the European
  Union (ERC Consolidator Grant No. 101043486 TIFUUN). Views and
  opinions expressed are however those of the authors only and do not
  necessarily reflect those of the European Union or the European
  Research Council Executive Agency. Neither the European Union nor the
  granting authority can be held responsible for them.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-BalanisU003A1989">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Balanis</surname><given-names>C. A.</given-names></name>
      </person-group>
      <source>Advanced engineering electromagnetics</source>
      <publisher-name>John Wiley &amp; Sons</publisher-name>
      <year iso-8601-date="1989">1989</year>
      <isbn>0-471-62194-3</isbn>
    </element-citation>
  </ref>
  <ref id="ref-TaniguchiU003A2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Taniguchi</surname><given-names>A.</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>DESHIMA 2.0: Development of an integrated superconducting spectrometer for science-grade astronomical observations</article-title>
      <source>Journal of Low Temperature Physics</source>
      <year iso-8601-date="2022">2022</year>
      <volume>209</volume>
      <uri>https://doi.org/10.1007/s10909-022-02888-5</uri>
      <pub-id pub-id-type="doi">10.1007/s10909-022-02888-5</pub-id>
      <fpage>278</fpage>
      <lpage>286</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ASTE">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Ezawa</surname><given-names>H.</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>The Atacama Submillimeter Telescope Experiment (ASTE)</article-title>
      <source>Ground-based telescopes</source>
      <person-group person-group-type="editor">
        <name><surname>Jr.</surname><given-names>Jacobus M. Oschmann</given-names></name>
      </person-group>
      <publisher-name>International Society for Optics; Photonics; SPIE</publisher-name>
      <year iso-8601-date="2004">2004</year>
      <volume>5489</volume>
      <uri>https://doi.org/10.1117/12.551391</uri>
      <pub-id pub-id-type="doi">10.1117/12.551391</pub-id>
      <fpage>763 </fpage>
      <lpage> 772</lpage>
    </element-citation>
  </ref>
  <ref id="ref-HunterU003A2007">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hunter</surname><given-names>J. D.</given-names></name>
      </person-group>
      <article-title>Matplotlib: A 2D graphics environment</article-title>
      <source>Computing in Science &amp; Engineering</source>
      <publisher-name>IEEE COMPUTER SOC</publisher-name>
      <year iso-8601-date="2007">2007</year>
      <volume>9</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      <fpage>90</fpage>
      <lpage>95</lpage>
    </element-citation>
  </ref>
  <ref id="ref-HarrisU003A2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harris</surname><given-names>Charles R.</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Array programming with NumPy</article-title>
      <source>Nature</source>
      <publisher-name>Springer Science; Business Media LLC</publisher-name>
      <year iso-8601-date="2020-09">2020</year><month>09</month>
      <volume>585</volume>
      <issue>7825</issue>
      <uri>https://doi.org/10.1038/s41586-020-2649-2</uri>
      <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
      <fpage>357</fpage>
      <lpage>362</lpage>
    </element-citation>
  </ref>
  <ref id="ref-VirtanenU003A2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python</article-title>
      <source>Nature Methods</source>
      <year iso-8601-date="2020">2020</year>
      <volume>17</volume>
      <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
      <fpage>261</fpage>
      <lpage>272</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
