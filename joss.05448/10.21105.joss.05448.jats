<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">5448</article-id>
<article-id pub-id-type="doi">10.21105/joss.05448</article-id>
<title-group>
<article-title>MiNAA: Microbiome Network Alignment
Algorithm</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Nelson</surname>
<given-names>Reed</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Aghdam</surname>
<given-names>Rosa</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Solis-Lemus</surname>
<given-names>Claudia</given-names>
</name>
<email>solislemus@wisc.edu</email>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Computer Science, University of
Wisconsin-Madison, Madison, WI, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Wisconsin Institute for Discovery, University of
Wisconsin-Madison, Madison, WI, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Department of Plant Pathology, University of
Wisconsin-Madison, Madison, WI, United States of America</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email>solislemus@wisc.edu</email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2022-12-12">
<day>12</day>
<month>12</month>
<year>2022</year>
</pub-date>
<volume>9</volume>
<issue>96</issue>
<fpage>5448</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>network alignment</kwd>
<kwd>microbiome</kwd>
<kwd>graph matching</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>A microbial network is a mathematical representation of a microbial
  community where nodes represent microbes and edges represent
  interactions. It is well-recognized that microbes are among the main
  drivers of biological phenotypes in soil, plants, and animals alike,
  and thus, their study has vast implications for soil, plant and human
  health. In particular, recognizing the microbial, environmental, and
  agricultural factors that drive plant and soil phenotypes is crucial
  to comprehend processes connected to plant and soil health, to
  identify global practices of sustainable agriculture, as well as to
  predict plant and soil responses to environmental perturbations such
  as climate change.</p>
  <p>The adaptability of microbes to thrive in every environment poses
  challenges for scientists who try to understand their communities.
  Indeed, two microbial communities with the exact same players can
  interact differently depending on the environmental conditions. It is
  thus desirable to identify commonalities and differences on two
  microbial networks, hence the need for computational tools that can
  match (or <italic>align</italic>) them.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Our Microbiome Network Alignment Algorithm (MiNAA) aligns two
  microbial networks using a combination of the GRAph ALigner (GRAAL)
  algorithm
  (<xref alt="Kuchaiev et al., 2010" rid="ref-kuchaiev2010topological" ref-type="bibr">Kuchaiev
  et al., 2010</xref>) and the Hungarian algorithm
  (<xref alt="Kuhn, 1955" rid="ref-kuhn1955hungarian" ref-type="bibr">Kuhn,
  1955</xref>;
  <xref alt="Pilgrim, 1995" rid="ref-pilgrim1995" ref-type="bibr">Pilgrim,
  1995</xref>). Network alignment algorithms find pairs of nodes (one
  node from the first network and the other node from the second
  network) that have the highest <italic>similarity</italic>.
  Traditionally, similarity has been defined as topological similarity
  such that the neighborhoods around the two nodes are similar. Recent
  implementations of network alignment methods such as NETAL
  (<xref alt="Neyshabur et al., 2013" rid="ref-neyshabur2013netal" ref-type="bibr">Neyshabur
  et al., 2013</xref>) and L-GRAAL
  (<xref alt="Malod-Dognin &amp; Pržulj, 2015" rid="ref-malod2015graal" ref-type="bibr">Malod-Dognin
  &amp; Pržulj, 2015</xref>) also include measures of biological
  similarity, yet these methods are restricted to one specific type of
  biological similarity (e.g. sequence similarity in L-GRAAL). Our work
  extends existing network alignment implementations by allowing
  <italic>any</italic> type of biological similarity to be input by the
  user. This flexibility allows the user to choose whatever measure of
  biological similarity is suitable for the study at hand. In addition,
  unlike most existing network alignment methods that are tailored for
  protein or gene interaction networks
  (<xref alt="Chen et al., 2020" rid="ref-chen2020gppial" ref-type="bibr">Chen
  et al., 2020</xref>;
  <xref alt="Ma &amp; Liao, 2020" rid="ref-ma2020review" ref-type="bibr">Ma
  &amp; Liao, 2020</xref>), our work is the first one suited for
  microbiome networks.</p>
</sec>
<sec id="description-of-the-algorithm">
  <title>Description of the algorithm</title>
  <p><bold>Input.</bold> Two networks, represented by adjacency
  matrices, are the main inputs for our algorithm. Let
  <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>H</mml:mi></mml:math></alternatives></inline-formula>
  be such input networks such that <inline-formula><alternatives>
  <tex-math><![CDATA[|G| \leq |H|]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>≤</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[|G|]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  indicates the size of <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>.
  Optionally, the user may add biological similarity (as a
  <inline-formula><alternatives>
  <tex-math><![CDATA[|G| \times |H|]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  matrix) to be weighed into the alignment. This matrix could include
  gene similarity, phylogenetic similarity, functional similarity, among
  others. Our algorithm also includes additional options that allow the
  user to specify how much weight should be placed on biological versus
  topological information. Specifics on all the input arguments can be
  found on GitHub https://github.com/solislemuslab/minaa.</p>
  <p><bold>Algorithms.</bold> For each input network (
  <inline-formula><alternatives>
  <tex-math><![CDATA[G,H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  ), we calculate the <italic>graphlet degree vector</italic>, also
  denoted the <italic>node signature</italic> of each node. This
  topological descriptor characterizes a node based on its local
  neighborhood within a 5-node radius
  (<xref alt="Pržulj, 2007" rid="ref-prvzulj2007biological" ref-type="bibr">Pržulj,
  2007</xref>).</p>
  <p>Currently, we use the same algorithm for calculating node
  signatures as in GraphCrunch2
  (<xref alt="Kuchaiev et al., 2011" rid="ref-kuchaiev2011graphcrunch" ref-type="bibr">Kuchaiev
  et al., 2011</xref>) which is a <inline-formula><alternatives>
  <tex-math><![CDATA[O(ed^3)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>e</mml:mi><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  algorithm where <inline-formula><alternatives>
  <tex-math><![CDATA[e]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>e</mml:mi></mml:math></alternatives></inline-formula>
  is the number of edges, and <inline-formula><alternatives>
  <tex-math><![CDATA[d]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>d</mml:mi></mml:math></alternatives></inline-formula>
  is the maximal node degree. Future work will see this implementation
  replaced by ORCA
  (<xref alt="Hočevar &amp; Demšar, 2016" rid="ref-hovcevar2016computation" ref-type="bibr">Hočevar
  &amp; Demšar, 2016</xref>), a functional equivalent with runtime
  <inline-formula><alternatives>
  <tex-math><![CDATA[O(ed^2)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>e</mml:mi><mml:msup><mml:mi>d</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  for sparse graphs such as microbial networks.</p>
  <p>Using the node signatures, we calculate the topological difference
  between each node <inline-formula><alternatives>
  <tex-math><![CDATA[g \in G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi>G</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[h \in H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>h</mml:mi><mml:mo>∈</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
  according to the formula described in
  (<xref alt="Milenković &amp; Pržulj, 2008" rid="ref-milenkovic2008uncovering" ref-type="bibr">Milenković
  &amp; Pržulj, 2008</xref>). In keeping with the flexibility of the
  original formula, we include a parameter
  <inline-formula><alternatives>
  <tex-math><![CDATA[\alpha]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>α</mml:mi></mml:math></alternatives></inline-formula>,
  such that the topological distance <inline-formula><alternatives>
  <tex-math><![CDATA[T_{i,j} = \alpha \cdot S_{i,j} + (1 - \alpha) \cdot N_{i,j}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[S_{i,j}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  represents the difference in node signatures between nodes
  <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>,
  and <inline-formula><alternatives>
  <tex-math><![CDATA[N_{i,j}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  represents the difference in degree between the nodes
  <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>.
  It is recommended to use the default <inline-formula><alternatives>
  <tex-math><![CDATA[\alpha = 1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
  We store the resulting values in the topological cost matrix
  <inline-formula><alternatives>
  <tex-math><![CDATA[T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>
  whose computation has complexity <inline-formula><alternatives>
  <tex-math><![CDATA[O(|G||H|)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p>At this time, if the user provided a biological cost matrix
  <inline-formula><alternatives>
  <tex-math><![CDATA[B]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>B</mml:mi></mml:math></alternatives></inline-formula>,
  the two matrices are combined into an overall cost matrix
  <inline-formula><alternatives>
  <tex-math><![CDATA[O]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>O</mml:mi></mml:math></alternatives></inline-formula>,
  such that <inline-formula><alternatives>
  <tex-math><![CDATA[O_{i,j} = \beta \cdot T_{i,j} + (1 - \beta) \cdot B_{i,j}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>O</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>β</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.
  The user can specify the value of the parameter
  <inline-formula><alternatives>
  <tex-math><![CDATA[\beta]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>β</mml:mi></mml:math></alternatives></inline-formula>,
  and by default, we use <inline-formula><alternatives>
  <tex-math><![CDATA[\beta=1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  which represents the case in which only topological information is
  considered.</p>
  <p>The overall cost matrix, <inline-formula><alternatives>
  <tex-math><![CDATA[O]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>O</mml:mi></mml:math></alternatives></inline-formula>,
  is the input to the Hungarian algorithm
  (<xref alt="Kuhn, 1955" rid="ref-kuhn1955hungarian" ref-type="bibr">Kuhn,
  1955</xref>;
  <xref alt="Pilgrim, 1995" rid="ref-pilgrim1995" ref-type="bibr">Pilgrim,
  1995</xref>), an <inline-formula><alternatives>
  <tex-math><![CDATA[O(|G|^3)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  solution to the <italic>assignment problem</italic>. It is important
  to note that the Hungarian algorithm will align every node
  <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
  to some node in <inline-formula><alternatives>
  <tex-math><![CDATA[H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>H</mml:mi></mml:math></alternatives></inline-formula>.
  Optimally, we should only align nodes which we have sufficient
  confidence ought to be aligned, but this <italic>partial assignment
  problem</italic> is computationally harder (likely, NP hard), and
  beyond the scope of this work. We show a graphical abstract of our
  algorithm in
  <xref alt="[graph-abs]" rid="graph-abs">[graph-abs]</xref>.</p>
  <fig>
    <caption><p>Graphical abstract of MiNAA. The algorithm takes two
    networks as input (<inline-formula><alternatives>
    <tex-math><![CDATA[G,H]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>),
    and for each node in the networks, it computes a node signature
    vector based on the topological information of the node’s
    neighborhood. With the node signatures, a topological cost matrix is
    computed which is then combined with a biological cost matrix input
    by the user. This method then applies the Hungarian algorithm to the
    overall cost matrix, resulting in a globally optimal alignment. Note
    that we show similarity matrices rather than cost matrices in this
    figure. While the algorithm works with cost matrices, similarity
    matrices are more intuitive for the graphical representation, and it
    is easy to convert one for the other with a
    transformation.<styled-content id="graph-abs"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/graphics/graphical_abstract.pdf" />
  </fig>
  <p><bold>Output.</bold> The algorithm’s main output is the complete
  alignment of <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>H</mml:mi></mml:math></alternatives></inline-formula>.
  That is, we return a list of pairs of nodes, one node from network
  <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
  and one node from network <inline-formula><alternatives>
  <tex-math><![CDATA[H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>H</mml:mi></mml:math></alternatives></inline-formula>
  that have been identified by the algorithm as having the lowest
  alignment cost. We also return an alignment score matrix with
  dimensions <inline-formula><alternatives>
  <tex-math><![CDATA[|G| \times |H|]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>G</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">|</mml:mo><mml:mi>H</mml:mi><mml:mo stretchy="true" form="postfix">|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  with the alignment score of each pair of nodes (the highest value, the
  more evidence for alignment). Along the way,
  <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>H</mml:mi></mml:math></alternatives></inline-formula>’s
  node signature sets are saved as files, as are the intermediate
  matrices <inline-formula><alternatives>
  <tex-math><![CDATA[T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[B]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>B</mml:mi></mml:math></alternatives></inline-formula>,
  and <inline-formula><alternatives>
  <tex-math><![CDATA[O]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>O</mml:mi></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="simulations">
  <title>Simulations</title>
  <p>We simulate networks with the R package SPIEC-EASI (SParse InversE
  Covariance Estimation for Ecological Association Inference)
  (<xref alt="Kurtz et al., 2015" rid="ref-kurtz2015sparse" ref-type="bibr">Kurtz
  et al., 2015</xref>). We focus on the “Cluster” network topology since
  cluster networks are conducive to speculative ecological scenarios.
  Indeed, for microbial communities that inhabit many discontinuous
  niches (clusters) and have minimal interactions between niches,
  cluster networks may serve as archetypal models
  (<xref alt="Peschel et al., 2021" rid="ref-peschel2021netcomi" ref-type="bibr">Peschel
  et al., 2021</xref>;
  <xref alt="Yang et al., 2019" rid="ref-yang2019meta" ref-type="bibr">Yang
  et al., 2019</xref>).</p>
  <p>A network is simulated with certain number of nodes, and then a
  proportion of its edges are flipped to produce a second network.
  Because the second network is just a perturbation of the first
  network, we expect our alignment method to align the same nodes
  correctly. For example, for the original simulated network (Network
  <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>)
  with 10 nodes and with 5% edge change rate, five out of every 100
  edges in the adjacency matrix that are 1 are replaced by 0, and
  similarly, five out of every 100 edges that are 0 are replaced with 1.
  The modified network from Network <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
  is named Network <inline-formula><alternatives>
  <tex-math><![CDATA[H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>H</mml:mi></mml:math></alternatives></inline-formula>.
  Then our algorithm is applied on the original and modified networks to
  detect the alignment pairs. This results in a alignment matrix with
  its elements represented as <inline-formula><alternatives>
  <tex-math><![CDATA[a_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.
  Each <inline-formula><alternatives>
  <tex-math><![CDATA[a_{ij}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  shows the similarity value of the <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>’s
  node in Network <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
  with <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>’s
  node in Network <inline-formula><alternatives>
  <tex-math><![CDATA[H]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>H</mml:mi></mml:math></alternatives></inline-formula>.
  We expect the alignment matrix to be close to the identity matrix.</p>
  <p>We iterate over different numbers of nodes (10, 30, 50, 100, 250
  and 500), and different proportions of edges changed (0.05 (5%), 0.1,
  and 0.9). To achieve reliable results, each scenario is repeated 30
  times and the average of the alignment matrices is computed. We expect
  Network <inline-formula><alternatives>
  <tex-math><![CDATA[G]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>G</mml:mi></mml:math></alternatives></inline-formula>
  to be properly aligned with a perturbation of itself with edge change
  rate of 0.05 or 0.1, but not with an edge change rate of 0.9.</p>
  <p><xref alt="[heatmap]" rid="heatmap">[heatmap]</xref> displays the
  results of the averaged similarity matrices for all simulated
  networks, with rows representing the edge change rate and columns
  representing the number of nodes. For instance, for 10 nodes with 0.05
  edge changes, the heatmap displays the mean of 30 alignment matrices.
  Given that we observe diagonal matrices for a small rate of edge
  change (0.05 and 0.1), we can conclude that our algorithm correctly
  aligns nodes under small perturbations of the networks. However, the
  results for the same networks with the edge change rate of 0.9 is far
  from diagonal which is also what we expected.</p>
  <fig>
    <caption><p>Averaged alignment matrices for all simulated networks,
    rows representing the rate of altered edge change and columns
    representing the number of nodes. Each sub-matrix is a heat map,
    where a coordinate’s color represents the rate at which those nodes
    were aligned. As expected, for 0.05 or 0.1 edge change rate, the
    alignment matrices are close to identity matrices, illustrating our
    method’s ability to align the same nodes on perturbed
    networks.<styled-content id="heatmap"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/graphics/heatmapGraph.pdf" />
  </fig>
  <p>We also present results on running time (see table below). We
  average the runtime over 90 alignments (30 replicates with 3 levels of
  edge change rate each) for each network size (as in the simulated data
  described above). Benchmarking was done in a single thread on a 72
  core/3.10GHz Intel CPU, with 1TB available RAM.</p>
  <table-wrap>
    <table>
      <thead>
        <tr>
          <th align="center">Number of nodes</th>
          <th align="center">Average Runtime (ms)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="center">10</td>
          <td align="center">25.100</td>
        </tr>
        <tr>
          <td align="center">30</td>
          <td align="center">40.167</td>
        </tr>
        <tr>
          <td align="center">50</td>
          <td align="center">66.767</td>
        </tr>
        <tr>
          <td align="center">100</td>
          <td align="center">139.133</td>
        </tr>
        <tr>
          <td align="center">250</td>
          <td align="center">972.433</td>
        </tr>
        <tr>
          <td align="center">500</td>
          <td align="center">7603.233</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work was supported by the Department of Energy [DE-SC0021016
  to CSL]. The authors thank Arnaud Becheler for meaningful discussions
  about ORCA.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-chen2020gppial">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Chen</surname><given-names>Yaoran</given-names></name>
        <name><surname>Zhu</surname><given-names>Yuanyuan</given-names></name>
        <name><surname>Zhong</surname><given-names>Ming</given-names></name>
        <name><surname>Peng</surname><given-names>Rong</given-names></name>
        <name><surname>Liu</surname><given-names>Juan</given-names></name>
      </person-group>
      <article-title>GPPIAL: A new global PPI network aligner based on orthologs</article-title>
      <source>2020 IEEE international conference on bioinformatics and biomedicine (BIBM)</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <pub-id pub-id-type="doi">10.1109/bibm49941.2020.9313552</pub-id>
      <fpage>100</fpage>
      <lpage>107</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hovcevar2016computation">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hočevar</surname><given-names>Tomaž</given-names></name>
        <name><surname>Demšar</surname><given-names>Janez</given-names></name>
      </person-group>
      <article-title>Computation of graphlet orbits for nodes and edges in sparse graphs</article-title>
      <source>Journal of Statistical Software</source>
      <year iso-8601-date="2016">2016</year>
      <volume>71</volume>
      <pub-id pub-id-type="doi">10.18637/jss.v071.i10</pub-id>
      <fpage>1</fpage>
      <lpage>24</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kuchaiev2010topological">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kuchaiev</surname><given-names>Oleksii</given-names></name>
        <name><surname>Milenković</surname><given-names>Tijana</given-names></name>
        <name><surname>Memišević</surname><given-names>Vesna</given-names></name>
        <name><surname>Hayes</surname><given-names>Wayne</given-names></name>
        <name><surname>Pržulj</surname><given-names>Nataša</given-names></name>
      </person-group>
      <article-title>Topological network alignment uncovers biological function and phylogeny</article-title>
      <source>Journal of the Royal Society Interface</source>
      <publisher-name>The Royal Society</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>7</volume>
      <issue>50</issue>
      <pub-id pub-id-type="doi">10.1098/rsif.2010.0063</pub-id>
      <fpage>1341</fpage>
      <lpage>1354</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kuchaiev2011graphcrunch">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kuchaiev</surname><given-names>Oleksii</given-names></name>
        <name><surname>Stevanović</surname><given-names>Aleksandar</given-names></name>
        <name><surname>Hayes</surname><given-names>Wayne</given-names></name>
        <name><surname>Pržulj</surname><given-names>Nataša</given-names></name>
      </person-group>
      <article-title>GraphCrunch 2: Software tool for network modeling, alignment and clustering</article-title>
      <source>BMC bioinformatics</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2011">2011</year>
      <volume>12</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1186/1471-2105-12-24</pub-id>
      <fpage>1</fpage>
      <lpage>13</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kuhn1955hungarian">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kuhn</surname><given-names>Harold W</given-names></name>
      </person-group>
      <article-title>The hungarian method for the assignment problem</article-title>
      <source>Naval research logistics quarterly</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="1955">1955</year>
      <volume>2</volume>
      <issue>1-2</issue>
      <pub-id pub-id-type="doi">10.1002/nav.20053</pub-id>
      <fpage>83</fpage>
      <lpage>97</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kurtz2015sparse">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kurtz</surname><given-names>Zachary D.</given-names></name>
        <name><surname>Muller</surname><given-names>Christian L.</given-names></name>
        <name><surname>Miraldi</surname><given-names>Emily R.</given-names></name>
        <name><surname>Littman</surname><given-names>Dan R.</given-names></name>
        <name><surname>Blaser</surname><given-names>Martin J.</given-names></name>
        <name><surname>Bonneau</surname><given-names>Richard A.</given-names></name>
      </person-group>
      <article-title>Sparse and compositionally robust inference of microbial ecological networks</article-title>
      <source>PLOS Computational Biology</source>
      <publisher-name>Public Library of Science</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>11</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004226</pub-id>
      <fpage>1</fpage>
      <lpage>25</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ma2020review">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ma</surname><given-names>Cheng-Yu</given-names></name>
        <name><surname>Liao</surname><given-names>Chung-Shou</given-names></name>
      </person-group>
      <article-title>A review of protein–protein interaction network alignment: From pathway comparison to global alignment</article-title>
      <source>Computational and Structural Biotechnology Journal</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>18</volume>
      <pub-id pub-id-type="doi">10.1016/j.csbj.2020.09.011</pub-id>
      <fpage>2647</fpage>
      <lpage>2656</lpage>
    </element-citation>
  </ref>
  <ref id="ref-malod2015graal">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Malod-Dognin</surname><given-names>Noël</given-names></name>
        <name><surname>Pržulj</surname><given-names>Nataša</given-names></name>
      </person-group>
      <article-title>L-GRAAL: Lagrangian graphlet-based network aligner</article-title>
      <source>Bioinformatics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>31</volume>
      <issue>13</issue>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/btv130</pub-id>
      <fpage>2182</fpage>
      <lpage>2189</lpage>
    </element-citation>
  </ref>
  <ref id="ref-milenkovic2008uncovering">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Milenković</surname><given-names>Tijana</given-names></name>
        <name><surname>Pržulj</surname><given-names>Nataša</given-names></name>
      </person-group>
      <article-title>Uncovering biological network function via graphlet degree signatures</article-title>
      <source>Cancer informatics</source>
      <publisher-name>SAGE Publications Sage UK: London, England</publisher-name>
      <year iso-8601-date="2008">2008</year>
      <volume>6</volume>
      <pub-id pub-id-type="doi">10.4137/cin.s680</pub-id>
      <fpage>CIN</fpage>
      <lpage>S680</lpage>
    </element-citation>
  </ref>
  <ref id="ref-neyshabur2013netal">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Neyshabur</surname><given-names>Behnam</given-names></name>
        <name><surname>Khadem</surname><given-names>Ahmadreza</given-names></name>
        <name><surname>Hashemifar</surname><given-names>Somaye</given-names></name>
        <name><surname>Arab</surname><given-names>Seyed Shahriar</given-names></name>
      </person-group>
      <article-title>NETAL: A new graph-based method for global alignment of protein–protein interaction networks</article-title>
      <source>Bioinformatics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>29</volume>
      <issue>13</issue>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/btt202</pub-id>
      <fpage>1654</fpage>
      <lpage>1662</lpage>
    </element-citation>
  </ref>
  <ref id="ref-peschel2021netcomi">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Peschel</surname><given-names>Stefanie</given-names></name>
        <name><surname>Müller</surname><given-names>Christian L</given-names></name>
        <name><surname>Mutius</surname><given-names>Erika von</given-names></name>
        <name><surname>Boulesteix</surname><given-names>Anne-Laure</given-names></name>
        <name><surname>Depner</surname><given-names>Martin</given-names></name>
      </person-group>
      <article-title>NetCoMi: Network construction and comparison for microbiome data in r</article-title>
      <source>Briefings in bioinformatics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>22</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1101/2020.07.15.195248</pub-id>
      <fpage>bbaa290</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-pilgrim1995">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pilgrim</surname><given-names>Robert</given-names></name>
      </person-group>
      <article-title>Tutorial on implementation of munkres’ assignment algorithm</article-title>
      <source>Lecture notes</source>
      <year iso-8601-date="1995-08">1995</year><month>08</month>
      <pub-id pub-id-type="doi">10.13140/RG.2.1.3572.3287</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-prvzulj2007biological">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pržulj</surname><given-names>Nataša</given-names></name>
      </person-group>
      <article-title>Biological network comparison using graphlet degree distribution</article-title>
      <source>Bioinformatics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2007">2007</year>
      <volume>23</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/btq091</pub-id>
      <fpage>e177</fpage>
      <lpage>e183</lpage>
    </element-citation>
  </ref>
  <ref id="ref-yang2019meta">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yang</surname><given-names>Pengshuo</given-names></name>
        <name><surname>Yu</surname><given-names>Shaojun</given-names></name>
        <name><surname>Cheng</surname><given-names>Lin</given-names></name>
        <name><surname>Ning</surname><given-names>Kang</given-names></name>
      </person-group>
      <article-title>Meta-network: Optimized species-species network analysis for microbial communities</article-title>
      <source>BMC genomics</source>
      <publisher-name>BioMed Central</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>20</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1186/s12864-019-5471-1</pub-id>
      <fpage>143</fpage>
      <lpage>151</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
