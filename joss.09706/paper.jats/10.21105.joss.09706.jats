<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">9706</article-id>
<article-id pub-id-type="doi">10.21105/joss.09706</article-id>
<title-group>
<article-title><monospace>FastPCA</monospace>: An R package for fast
singular value decomposition</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ward</surname>
<given-names>Kimberly R.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3240-9946</contrib-id>
<name>
<surname>Hayes</surname>
<given-names>Mitchell</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6620-8600</contrib-id>
<name>
<surname>Peres</surname>
<given-names>Lauren C</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7739-7956</contrib-id>
<name>
<surname>Fridley</surname>
<given-names>Brooke L</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9833-2788</contrib-id>
<name>
<surname>Eschrich</surname>
<given-names>Steven</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1251-9179</contrib-id>
<name>
<surname>Soupir</surname>
<given-names>Alex C</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Cutaneous Oncology, Moffitt Cancer
Center</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Department of Genitourinary Oncology, Moffitt Cancer
Center</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Department of Cancer Epidemiology, Moffitt Cancer
Center</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Health Services &amp; Outcomes Research, Children’s
Mercy</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Department of Bioinformatics and Biostatistics, Moffitt
Cancer Center</institution>
</institution-wrap>
</aff>
</contrib-group>
<volume>11</volume>
<issue>118</issue>
<fpage>9706</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2026</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>Python</kwd>
<kwd>single-cell</kwd>
<kwd>randomized SVD</kwd>
<kwd>principal component analysis</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>The <monospace>FastPCA</monospace> package provides an interface to
  optimized matrix multiplication libraries
  (<monospace>libtorch</monospace>) for the purpose of singular value
  decomposition. Using <monospace>FastPCA</monospace> to perform
  randomized singular value decomposition (SVD, Halko, Martinsson, &amp;
  Tropp
  (<xref alt="2011" rid="ref-Halko-ILBRA" ref-type="bibr">2011</xref>))
  with the <monospace>torch</monospace> or
  <monospace>pytorch</monospace> backend drastically reduces the
  computational time compared to base R <monospace>prcomp</monospace>
  and other truncated singular value decomposition. Developed for
  biological data such as single-cell RNA-sequencing, spatial
  transcriptomics, or matrix-assisted laser desorption/ionization (MALDI
  imaging), <monospace>FastPCA</monospace> can efficiently and
  accurately identify the leading singular values in high-dimensional
  data.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Over the last decade, advances in single-cell and spatial profiling
  technologies have dramatically increased the scale and resolution of
  biological data (Lim, Wang, Buzdin, &amp; Li
  (<xref alt="2025" rid="ref-Lim2025-vb" ref-type="bibr">2025</xref>)).
  Multiple custom and commercially available technologies produce tens
  of thousands of samples (e.g., spots, cells, pixels) and thousands of
  measured features (i.e., genes, peaks, etc) per sample which can
  require tens to hundreds of gigabytes (Zaima, Hayasaka, Goto-Inoue,
  &amp; Setou
  (<xref alt="2010" rid="ref-Zaima2010-gy" ref-type="bibr">2010</xref>)).
  Creating linear or non-linear combinations of the input space in
  lower-dimensional space enables more efficient downstream analysis.
  However, this is typically done with packages like
  <monospace>irlba</monospace> (Baglama, Reichel, &amp; Lewis
  (<xref alt="2011" rid="ref-Baglama2011-ob" ref-type="bibr">2011</xref>))
  where the process of identifying singular values is iterative and
  single-thread limited. Other packages can improve efficiency by using
  an API for R (such as <monospace>reticulate</monospace> for python)
  but is not multithreaded without modification to the source code (Li,
  Meisner, &amp; Albrechtsen
  (<xref alt="2023" rid="ref-Li2023-aa" ref-type="bibr">2023</xref>)).
  The <monospace>qrpca</monospace> R package (S. de Souza, Quanfeng,
  Shen, Peng, &amp; Mu
  (<xref alt="2022" rid="ref-De_Souza2022-lk" ref-type="bibr">2022</xref>))
  uses <monospace>torch</monospace> (Falbel &amp; Luraschi
  (<xref alt="2020" rid="ref-Falbel2020-wq" ref-type="bibr">2020</xref>);
  Paszke et al.
  (<xref alt="2019" rid="ref-Paszke2019-go" ref-type="bibr">2019</xref>))
  to perform QR-based principal component analysis (PCA), but doesn’t
  produce truncated singular values resulting in incredibly large memory
  requirements for large matrices. For biological studies, parameter
  tuning and rapid iteration (e.g., normalization methods, subclustering
  for identifying specific cell types) are essential to identify
  biologically meaningful signals, which typically reside in early
  dimensions, enabling the avoidance of the full decomposition.</p>
  <p>The <monospace>FastPCA</monospace> R package was developed to
  address this critical need. <monospace>FastPCA</monospace> has access
  to the <monospace>torch</monospace> backend through R, as well as
  <monospace>pytorch</monospace> with <monospace>reticulate</monospace>
  (Ushey, Allaire, &amp; Tang
  (<xref alt="2017" rid="ref-Ushey2017-mx" ref-type="bibr">2017</xref>)).
  We’ve also included vignettes to demonstrate
  <monospace>FastPCA</monospace>’s utility and functionality
  (<ext-link ext-link-type="uri" xlink:href="https://acsoupir.github.io/FastPCA/">https://acsoupir.github.io/FastPCA/</ext-link>).</p>
</sec>
<sec id="functionality">
  <title>Functionality</title>
  <p><monospace>FastPCA</monospace> uses <monospace>irlba</monospace> as
  the default backend for calculating singular values for compatability,
  but offers access to <monospace>libtorch</monospace> via python
  <monospace>pytorch</monospace> or R <monospace>torch</monospace>
  packages. Using the <monospace>pytorch</monospace> or
  <monospace>torch</monospace> backends support setting the number of
  threads where the backend provides it. There are two functions within
  <monospace>FastPCA</monospace> that aid in the setup of the
  environments:</p>
  <list list-type="bullet">
    <list-item>
      <p><monospace>setup_py_env()</monospace>: creates a python
      environment (either with ‘conda’ or ‘virtualenv’) for using in the
      event that <monospace>pytorch</monospace> is wanted for the
      backend</p>
    </list-item>
    <list-item>
      <p><monospace>start_FastPCA_env()</monospace>: starts the
      environment created with <monospace>setup_py_env()</monospace> to
      use for <monospace>pytorch</monospace> backend</p>
    </list-item>
  </list>
  <p>Then, there are processing functions that work on input matrices or
  intermediate lists produced by <monospace>FastPCA</monospace>:</p>
  <list list-type="bullet">
    <list-item>
      <p><monospace>prep_matrix()</monospace>: converts expected data
      types (rows/columns) into <monospace>FastPCA</monospace> format
      (rows as samples, columns as features). Also supports
      transformations such as log2 and scaling.</p>
    </list-item>
    <list-item>
      <p><monospace>FastPCA()</monospace>: performs either exact SVD
      (though not recommended other than benchmarking) or truncated
      singular value decomposition with <monospace>irlba</monospace> or
      randomized SVD. Returns a list containing matrices of singular
      vectors <inline-formula><alternatives>
      <tex-math><![CDATA[U]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>U</mml:mi></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[V^T]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></alternatives></inline-formula>,
      and vector of singular values <inline-formula><alternatives>
      <tex-math><![CDATA[S]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>S</mml:mi></mml:math></alternatives></inline-formula></p>
    </list-item>
    <list-item>
      <p><monospace>get_pc_scores()</monospace>: calculates the
      principal component scores from the output of
      <monospace>FastPCA()</monospace> (<inline-formula><alternatives>
      <tex-math><![CDATA[U]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>U</mml:mi></mml:math></alternatives></inline-formula>
      matrix which contains left singular vectors,
      <inline-formula><alternatives>
      <tex-math><![CDATA[S]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>S</mml:mi></mml:math></alternatives></inline-formula>
      vector containing the singular values, and
      <inline-formula><alternatives>
      <tex-math><![CDATA[V^T]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msup></mml:math></alternatives></inline-formula>
      matrix of the right singular vectors) which are typically expected
      for downstream analyses</p>
    </list-item>
    <list-item>
      <p><monospace>umap()</monospace>: uses either
      <monospace>uwot</monospace> (R) or
      <monospace>umap-learn</monospace> (python) for visualization of
      the principal component scores</p>
    </list-item>
  </list>
</sec>
<sec id="research-impact">
  <title>Research Impact</title>
  <p>To demonstrate the improvements of <monospace>FastPCA</monospace>,
  we use our previous data set of single-cell spatial transcriptomics of
  kidney cancer. The dataset is publicly available on
  <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/doi/10.5281/zenodo.12730226">Zenodo</ext-link>
  and can be downloaded locally to be used (Soupir et al.
  (<xref alt="2024" rid="ref-Soupir2024-ww" ref-type="bibr">2024</xref>)).
  Since the main benefits of <monospace>FastPCA</monospace> are in its
  application of singular value decomposition, that is what will be
  focused on. The counts for each cell were extracted from the Seurat
  object in the Nanostring assay, which contains the expression of 978
  probes (959 genes, 19 negative control probes) in 199,112 cells.
  Normalization was performed using
  <monospace>prep_matrix()</monospace>, applying a log transformation,
  scaling (mean centering and unit variance), and transposing for
  samples to be rows and columns to be the gene features. The full
  script can be found
  <ext-link ext-link-type="uri" xlink:href="https://github.com/ACSoupir/FastPCA/blob/main/docs_acs/paper/benchmarking_script.R">https://github.com/ACSoupir/FastPCA/blob/main/docs_acs/paper/benchmarking_script.R</ext-link>.</p>
  <p>Experiments were performed using <monospace>FastPCA</monospace>,
  both randomized SVD and exact, <monospace>irlba</monospace>,
  <monospace>pcaone</monospace> (Li et al.
  (<xref alt="2023" rid="ref-Li2023-aa" ref-type="bibr">2023</xref>)),
  and <monospace>bigstatsr</monospace> (Privé, Aschard, Ziyatdinov,
  &amp; Blum
  (<xref alt="2018" rid="ref-prive2018efficient" ref-type="bibr">2018</xref>)),
  both partial and randomized partial SVD. Performance measures were
  collected from a M3 Pro MacBook Pro with 36GB unified RAM.
  <monospace>FastPCA</monospace> (4 cores),
  <monospace>bigstatsr</monospace> partial (1 core) and random (4
  cores), <monospace>irlba</monospace> (1 core), and
  <monospace>pcaone</monospace> (1 core) were assessed. Time was
  profiled with <monospace>bench::mark()</monospace> function over 10
  repetitions for each implementation. The elapsed time of
  <monospace>FastPCA</monospace> calculating the singular value
  decomposition on the full data took 10.74 seconds on average (range
  10.61 to 11.27 seconds) and the randomized SVD with
  <monospace>FastPCA</monospace> taking 8.46 (8.35 to 8.79) seconds on
  average <bold>Table 1</bold>, <bold>Figure 1</bold>). The next fastest
  were the implementations with PCAone which took 27.29 (27.1 to 27.54)
  and 29.58 (28.59 to 32.59) seconds on average for “Alg1” and “Alg2”,
  respectively.</p>
  <table-wrap>
    <caption>
      <p>Time to calculate singular value decomposition using different
      R packages and implementations over 10 replicates.</p>
    </caption>
    <table>
      <thead>
        <tr>
          <th>Implementation</th>
          <th align="right">Min</th>
          <th align="right">Median</th>
          <th align="right">Mean</th>
          <th align="right">Max</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><monospace>FastPCA</monospace> (rSVD)</td>
          <td align="right">8.35s</td>
          <td align="right">8.43s</td>
          <td align="right">8.46s</td>
          <td align="right">8.79s</td>
        </tr>
        <tr>
          <td><monospace>FastPCA</monospace> (Exact)</td>
          <td align="right">10.61s</td>
          <td align="right">10.65s</td>
          <td align="right">10.74s</td>
          <td align="right">11.27s</td>
        </tr>
        <tr>
          <td><monospace>irlba</monospace></td>
          <td align="right">413.15s</td>
          <td align="right">423.73s</td>
          <td align="right">429.99s</td>
          <td align="right">466.80s</td>
        </tr>
        <tr>
          <td><monospace>pcaone</monospace> (Alg1)</td>
          <td align="right">27.1s</td>
          <td align="right">27.27s</td>
          <td align="right">27.29s</td>
          <td align="right">27.54s</td>
        </tr>
        <tr>
          <td><monospace>pcaone</monospace> (Alg2)</td>
          <td align="right">28.59s</td>
          <td align="right">29.01s</td>
          <td align="right">29.58s</td>
          <td align="right">32.59s</td>
        </tr>
        <tr>
          <td><monospace>bigstatsr</monospace> (rSVD)</td>
          <td align="right">50.0s</td>
          <td align="right">50.8s</td>
          <td align="right">51.15s</td>
          <td align="right">54.34s</td>
        </tr>
        <tr>
          <td><monospace>bigstatsr</monospace> (Partial)</td>
          <td align="right">104.08s</td>
          <td align="right">106.94s</td>
          <td align="right">106.43s</td>
          <td align="right">107.73s</td>
        </tr>
        <tr>
          <td><monospace>BiocSingular</monospace> (rSVD)</td>
          <td align="right">606.71s</td>
          <td align="right">615.53s</td>
          <td align="right">623.30s</td>
          <td align="right">646.58s</td>
        </tr>
        <tr>
          <td><monospace>FastPCA</monospace> GPU (rSVD)</td>
          <td align="right">2.44s</td>
          <td align="right">2.44s</td>
          <td align="right">2.44s</td>
          <td align="right">2.44s</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <fig id="figU003Atime_mem">
    <caption><p>Time of singular value decomposition implementations
    over 10 replicates.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="figure1.png" />
  </fig>
  <p>The <monospace>pytorch</monospace> backend also has the ability to
  use a CUDA-enabled GPU (using
  <monospace>device = &quot;GPU&quot;</monospace>), leveraging the
  highly parallel processing commonly used in deep learning applications
  (Paszke et al.
  (<xref alt="2019" rid="ref-Paszke2019-go" ref-type="bibr">2019</xref>)).
  Enabling GPU acceleration with <monospace>FastPCA</monospace> further
  improves compute time to 2.44 (2.44 to 2.44) seconds. While current
  GPU implementation significantly improves speed for same operation
  (CPU time between 8.35 and 8.27 seconds; GPU time between 2.44 and
  2.44 seconds), it is limited to CUDA due to lack of access to other
  hardware. Future development of <monospace>FastPCA</monospace> aims to
  be hardware agnostic through added support or adding other hardware
  agnostic backends like <monospace>tinygrad</monospace>
  (https://tinygrad.org/).</p>
  <p>Reconstruction error was calculated for all implementations.
  Because the three matrices (left eigenvectors, eigenvalues, and right
  eigenvectors) should contain all of the information decomposed from
  the original matrix when calculated in full, exact
  <monospace>FastPCA</monospace> was used as reference. To determine how
  much information was captured in the truncated methods compared to the
  full decomposition, the output from exact
  <monospace>FastPCA</monospace> was directly truncated to the first 100
  dimensions and sum of squares error ratio was calculated (reduced SSE
  / exact truncated SSE; <bold>Table 2</bold>; Eckart &amp; Young
  (<xref alt="1936" rid="ref-Eckart1936-mg" ref-type="bibr">1936</xref>)).
  Values of 1 are interpreted as containing the same variance in the
  reconstructed data as the first 100 dimensions of the truncated exact
  SVD, and values greater than 1 indicate how much error over optimal
  reconstruction the method or implementation had. These demonstrate
  that <monospace>irlba</monospace> with it’s iterative approach
  captures the first 100 dimensions extremely well (1.000) compared to
  the exact SVD; similar with the <monospace>bigstatsr</monospace>
  implementations. <monospace>FastPCA</monospace> randomized SVD and
  PCAone approaches contain slightly greater error (~0.14% to ~0.33%
  greater than the optimal reconstruction with exact
  <monospace>FastPCA</monospace>) just like
  <monospace>BiocSingular</monospace> randomized SVD (~0.33%). These
  errors indicate that with <monospace>FastPCA</monospace> being more
  than 50x faster using the randomized SVD approach than IRLBA, it is
  within the error of other common implementations, and while being
  greater than 40x faster using the exact approach perfectly
  reconstructs the original data.</p>
  <table-wrap>
    <caption>
      <p>Reconstruction error of the truncated singular value
      decomposition. <monospace>FastPCA</monospace> using the exact
      approach was used as reference as it produces the full singular
      value decomposition.</p>
    </caption>
    <table>
      <thead>
        <tr>
          <th>Implementation</th>
          <th align="center">SSE Ratio</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><monospace>FastPCA</monospace> (rSVD)</td>
          <td align="center">1.003191</td>
        </tr>
        <tr>
          <td><monospace>FastPCA</monospace> (Exact)</td>
          <td align="center">–</td>
        </tr>
        <tr>
          <td><monospace>irlba</monospace></td>
          <td align="center">1.000000</td>
        </tr>
        <tr>
          <td><monospace>pcaone</monospace> (Alg1)</td>
          <td align="center">1.003316</td>
        </tr>
        <tr>
          <td><monospace>pcaone</monospace> (Alg2)</td>
          <td align="center">1.001383</td>
        </tr>
        <tr>
          <td><monospace>bigstatsr</monospace> (rSVD)</td>
          <td align="center">1.000000</td>
        </tr>
        <tr>
          <td><monospace>bigstatsr</monospace> (Partial)</td>
          <td align="center">1.000000</td>
        </tr>
        <tr>
          <td><monospace>BiocSingular</monospace> (rSVD)</td>
          <td align="center">1.003275</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p>Further, for the first 100 singular values, and first and second
  left singular vectors (samples), we used the concordance correlation
  coefficient (CCC) to demonstrate agreement of each with the exact
  <monospace>FastPCA</monospace>. Singular values produced by
  <monospace>irlba</monospace> and both implementations from
  <monospace>bigstatsr</monospace> were identical to those from the full
  SVD (<bold>Table 3</bold>). Again, <monospace>FastPCA</monospace>
  using randomized SVD, both algorithms from
  <monospace>pcaone</monospace>, and <monospace>BiocSingular</monospace>
  deviated slightly from the exact yet were considered “almost perfect”
  having CCC values greater than 0.99 (actually &gt; 0.9999; Akoglu
  (<xref alt="2018" rid="ref-Akoglu2018-pq" ref-type="bibr">2018</xref>)).
  For both principal component (PC) 1 and 2, the CCC was 1.0000
  indicating perfect agreement (PCs calculated by multiplying the left
  singular vectors by the singular values).</p>
  <table-wrap>
    <caption>
      <p>Concordance correlation coefficient estimates for how well each
      implementation agrees with the true full
      <monospace>FastPCA</monospace> singular value decomposition on the
      singular values and principal component 1 and 2 values.</p>
    </caption>
    <table>
      <colgroup>
        <col width="29%" />
        <col width="22%" />
        <col width="23%" />
        <col width="24%" />
      </colgroup>
      <thead>
        <tr>
          <th>Implementation</th>
          <th align="center">Singular Values</th>
          <th align="center">Principal<break/>Component 1</th>
          <th align="center">Principal<break/>Component 2</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><monospace>FastPCA</monospace> (rSVD)</td>
          <td align="center">0.9999</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
        </tr>
        <tr>
          <td><monospace>FastPCA</monospace> (Exact)</td>
          <td align="center">–</td>
          <td align="center">–</td>
          <td align="center">–</td>
        </tr>
        <tr>
          <td><monospace>irlba</monospace></td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
        </tr>
        <tr>
          <td><monospace>pcaone</monospace> (Alg1)</td>
          <td align="center">0.9999</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
        </tr>
        <tr>
          <td><monospace>pcaone</monospace> (Alg2)</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
        </tr>
        <tr>
          <td><monospace>bigstatsr</monospace> (rSVD)</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
        </tr>
        <tr>
          <td><monospace>bigstatsr</monospace> (Partial)</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
        </tr>
        <tr>
          <td><monospace>BiocSingular</monospace> (rSVD)</td>
          <td align="center">0.9999</td>
          <td align="center">1.0000</td>
          <td align="center">1.0000</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p>To demonstrate that the <monospace>FastPCA</monospace> exact is
  mathematically sound for the comparison above, we assessed it’s error
  compared to the original expression matrix. The absolute error (using
  the r <monospace>norm</monospace> function with
  <monospace>type = &quot;F&quot;</monospace>) of the reconstructed data
  from the exact method is 2.11e-09. Relative error, calculated by
  dividing absolute error by square root of variance within the original
  data, was calculated to be 1.51e-13.</p>
</sec>
<sec id="conclusion">
  <title>Conclusion</title>
  <p><monospace>FastPCA</monospace> provides an accelerated route to
  principal component analysis on large matrices by coupling randomized
  SVD with <monospace>torch</monospace>/<monospace>pytorch</monospace>
  backends and a familiar R API. In our kidney cancer
  spatial-transcriptomics benchmark (199,112 cells × 978 features),
  <monospace>FastPCA</monospace>’s randomized SVD achieved 8.5 s mean
  runtime on commodity hardware while matching the early singular values
  from exact decompositions and widely used methods (IRLBA in
  <monospace>irlba</monospace>). Memory use remained modest for
  <monospace>FastPCA</monospace>’s randomized SVD implementation (321.4
  MB), with predictable increase for exact decompositions when full
  matrices are returned. These results, together with setup helpers
  (optional Python via <monospace>reticulate</monospace>, otherwise
  R-only), make <monospace>FastPCA</monospace> a practical default for
  exploratory analyses and iterative pipelines (e.g., normalization
  alternatives, sub-clustering, visualization) where the top components
  contain the most biological information. Future work will extend
  functionality to sparse-matrix coverage and GPU pathways.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work was supported in part by effort on NIH R01CA279065. We
  would like to thank Dr. Oscar Ospina for his testing of the
  <monospace>FastPCA</monospace> in a single-cell workflow to validate
  its similarity to values derived from Seurat
  (<monospace>irlba</monospace>) in real data.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-Soupir2024-ww">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Soupir</surname><given-names>Alex C</given-names></name>
        <name><surname>Hayes</surname><given-names>Mitchell T</given-names></name>
        <name><surname>Peak</surname><given-names>Taylor C</given-names></name>
        <name><surname>Ospina</surname><given-names>Oscar</given-names></name>
        <name><surname>Chakiryan</surname><given-names>Nicholas H</given-names></name>
        <name><surname>Berglund</surname><given-names>Anders E</given-names></name>
        <name><surname>Stewart</surname><given-names>Paul A</given-names></name>
        <name><surname>Nguyen</surname><given-names>Jonathan</given-names></name>
        <name><surname>Segura</surname><given-names>Carlos Moran</given-names></name>
        <name><surname>Francis</surname><given-names>Natasha L</given-names></name>
        <name><surname>Echevarria</surname><given-names>Paola M Ramos</given-names></name>
        <name><surname>Chahoud</surname><given-names>Jad</given-names></name>
        <name><surname>Li</surname><given-names>Roger</given-names></name>
        <name><surname>Tsai</surname><given-names>Kenneth Y</given-names></name>
        <name><surname>Balasi</surname><given-names>Jodi A</given-names></name>
        <name><surname>Peres</surname><given-names>Yamila Caraballo</given-names></name>
        <name><surname>Dhillon</surname><given-names>Jasreman</given-names></name>
        <name><surname>Martinez</surname><given-names>Lindsey A</given-names></name>
        <name><surname>Gloria</surname><given-names>Warren E</given-names></name>
        <name><surname>Schurman</surname><given-names>Nathan</given-names></name>
        <name><surname>Kim</surname><given-names>Sean</given-names></name>
        <name><surname>Gregory</surname><given-names>Mark</given-names></name>
        <name><surname>Mulé</surname><given-names>James</given-names></name>
        <name><surname>Fridley</surname><given-names>Brooke L</given-names></name>
        <name><surname>Manley</surname><given-names>Brandon J</given-names></name>
      </person-group>
      <article-title>Increased spatial coupling of integrin and collagen IV in the immunoresistant clear-cell renal-cell carcinoma tumor microenvironment</article-title>
      <source>Genome Biol.</source>
      <year iso-8601-date="2024-12">2024</year><month>12</month>
      <volume>25</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1186/s13059-024-03435-z</pub-id>
      <fpage>308</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Lim2025-vb">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lim</surname><given-names>Hyun Ju</given-names></name>
        <name><surname>Wang</surname><given-names>Ye</given-names></name>
        <name><surname>Buzdin</surname><given-names>Anton</given-names></name>
        <name><surname>Li</surname><given-names>Xinmin</given-names></name>
      </person-group>
      <article-title>A practical guide for choosing an optimal spatial transcriptomics technology from seven major commercially available options</article-title>
      <source>BMC Genomics</source>
      <year iso-8601-date="2025-01">2025</year><month>01</month>
      <volume>26</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1186/s12864-025-11235-3</pub-id>
      <fpage>47</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Zaima2010-gy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zaima</surname><given-names>Nobuhiro</given-names></name>
        <name><surname>Hayasaka</surname><given-names>Takahiro</given-names></name>
        <name><surname>Goto-Inoue</surname><given-names>Naoko</given-names></name>
        <name><surname>Setou</surname><given-names>Mitsutoshi</given-names></name>
      </person-group>
      <article-title>Matrix-assisted laser desorption/ionization imaging mass spectrometry</article-title>
      <source>Int. J. Mol. Sci.</source>
      <publisher-name>MDPI AG</publisher-name>
      <year iso-8601-date="2010-12">2010</year><month>12</month>
      <volume>11</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.3390/ijms11125040</pub-id>
      <fpage>5040</fpage>
      <lpage>5055</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Baglama2011-ob">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Baglama</surname><given-names>Jim</given-names></name>
        <name><surname>Reichel</surname><given-names>Lothar</given-names></name>
        <name><surname>Lewis</surname><given-names>B W</given-names></name>
      </person-group>
      <article-title>Irlba: Fast truncated singular value decomposition and principal components analysis for large dense and sparse matrices</article-title>
      <publisher-name>The R Foundation</publisher-name>
      <year iso-8601-date="2011-05">2011</year><month>05</month>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.irlba</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Li2023-aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Li</surname><given-names>Zilong</given-names></name>
        <name><surname>Meisner</surname><given-names>Jonas</given-names></name>
        <name><surname>Albrechtsen</surname><given-names>Anders</given-names></name>
      </person-group>
      <article-title>Fast and accurate out-of-core PCA framework for large scale biobank data</article-title>
      <source>Genome Res.</source>
      <year iso-8601-date="2023-09">2023</year><month>09</month>
      <volume>33</volume>
      <issue>9</issue>
      <pub-id pub-id-type="doi">10.1101/gr.277525.122</pub-id>
      <fpage>1599</fpage>
      <lpage>1608</lpage>
    </element-citation>
  </ref>
  <ref id="ref-De_Souza2022-lk">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>S. de Souza</surname><given-names>R.</given-names></name>
        <name><surname>Quanfeng</surname><given-names>X.</given-names></name>
        <name><surname>Shen</surname><given-names>S.</given-names></name>
        <name><surname>Peng</surname><given-names>C.</given-names></name>
        <name><surname>Mu</surname><given-names>Z.</given-names></name>
      </person-group>
      <article-title>Qrpca: A package for fast principal component analysis with GPU acceleration</article-title>
      <source>Astronomy and Computing</source>
      <year iso-8601-date="2022">2022</year>
      <volume>41</volume>
      <issn>2213-1337</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S221313372200052X</uri>
      <pub-id pub-id-type="doi">10.1016/j.ascom.2022.100633</pub-id>
      <fpage>100633</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Falbel2020-wq">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Falbel</surname><given-names>Daniel</given-names></name>
        <name><surname>Luraschi</surname><given-names>Javier</given-names></name>
      </person-group>
      <article-title>Torch: Tensors and neural networks with ’GPU’ acceleration</article-title>
      <publisher-name>The R Foundation</publisher-name>
      <year iso-8601-date="2020-08">2020</year><month>08</month>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.torch</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Paszke2019-go">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Paszke</surname><given-names>Adam</given-names></name>
        <name><surname>Gross</surname><given-names>Sam</given-names></name>
        <name><surname>Massa</surname><given-names>Francisco</given-names></name>
        <name><surname>Lerer</surname><given-names>Adam</given-names></name>
        <name><surname>Bradbury</surname><given-names>James</given-names></name>
        <name><surname>Chanan</surname><given-names>Gregory</given-names></name>
        <name><surname>Killeen</surname><given-names>Trevor</given-names></name>
        <name><surname>Lin</surname><given-names>Zeming</given-names></name>
        <name><surname>Gimelshein</surname><given-names>Natalia</given-names></name>
        <name><surname>Antiga</surname><given-names>Luca</given-names></name>
        <name><surname>Desmaison</surname><given-names>Alban</given-names></name>
        <name><surname>Köpf</surname><given-names>Andreas</given-names></name>
        <name><surname>Yang</surname><given-names>Edward</given-names></name>
        <name><surname>DeVito</surname><given-names>Zach</given-names></name>
        <name><surname>Raison</surname><given-names>Martin</given-names></name>
        <name><surname>Tejani</surname><given-names>Alykhan</given-names></name>
        <name><surname>Chilamkurthy</surname><given-names>Sasank</given-names></name>
        <name><surname>Steiner</surname><given-names>Benoit</given-names></name>
        <name><surname>Fang</surname><given-names>Lu</given-names></name>
        <name><surname>Bai</surname><given-names>Junjie</given-names></name>
        <name><surname>Chintala</surname><given-names>Soumith</given-names></name>
      </person-group>
      <article-title>PyTorch: An imperative style, high-performance deep learning library</article-title>
      <year iso-8601-date="2019">2019</year>
      <pub-id pub-id-type="doi">10.48550/arXiv.1912.01703</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Ushey2017-mx">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Ushey</surname><given-names>Kevin</given-names></name>
        <name><surname>Allaire</surname><given-names>J J</given-names></name>
        <name><surname>Tang</surname><given-names>Yuan</given-names></name>
      </person-group>
      <article-title>Reticulate: Interface to ’python’</article-title>
      <publisher-name>The R Foundation</publisher-name>
      <year iso-8601-date="2017-03">2017</year><month>03</month>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.reticulate</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Halko-ILBRA">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Halko</surname><given-names>N.</given-names></name>
        <name><surname>Martinsson</surname><given-names>P. G.</given-names></name>
        <name><surname>Tropp</surname><given-names>J. A.</given-names></name>
      </person-group>
      <article-title>Finding structure with randomness: Probabilistic algorithms for constructing approximate matrix decompositions</article-title>
      <source>SIAM Review</source>
      <year iso-8601-date="2011">2011</year>
      <volume>53</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1137/090771806</uri>
      <pub-id pub-id-type="doi">10.1137/090771806</pub-id>
      <fpage>217</fpage>
      <lpage>288</lpage>
    </element-citation>
  </ref>
  <ref id="ref-prive2018efficient">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Privé</surname><given-names>Florian</given-names></name>
        <name><surname>Aschard</surname><given-names>Hugues</given-names></name>
        <name><surname>Ziyatdinov</surname><given-names>Andrey</given-names></name>
        <name><surname>Blum</surname><given-names>Michael G. B.</given-names></name>
      </person-group>
      <article-title>Efficient analysis of large-scale genome-wide data with two R packages: Bigstatsr and bigsnpr</article-title>
      <source>Bioinformatics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>34</volume>
      <issue>16</issue>
      <uri>https://doi.org/10.1093/bioinformatics/bty185</uri>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/bty185</pub-id>
      <fpage>2781</fpage>
      <lpage>2787</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Eckart1936-mg">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Eckart</surname><given-names>Carl</given-names></name>
        <name><surname>Young</surname><given-names>Gale</given-names></name>
      </person-group>
      <article-title>The approximation of one matrix by another of lower rank</article-title>
      <source>Psychometrika</source>
      <publisher-name>Springer Science; Business Media LLC</publisher-name>
      <year iso-8601-date="1936-09">1936</year><month>09</month>
      <volume>1</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1007/BF02288367</pub-id>
      <fpage>211</fpage>
      <lpage>218</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Akoglu2018-pq">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Akoglu</surname><given-names>Haldun</given-names></name>
      </person-group>
      <article-title>User’s guide to correlation coefficients</article-title>
      <source>Turk. J. Emerg. Med.</source>
      <publisher-name>Medknow</publisher-name>
      <year iso-8601-date="2018-09">2018</year><month>09</month>
      <volume>18</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1016/j.tjem.2018.08.001</pub-id>
      <fpage>91</fpage>
      <lpage>93</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
