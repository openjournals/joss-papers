<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8866</article-id>
<article-id pub-id-type="doi">10.21105/joss.08866</article-id>
<title-group>
<article-title>Low scaling BSE implementation in the exciting
code</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9152-7390</contrib-id>
<name>
<surname>Maurer</surname>
<given-names>Benedikt</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3523-6657</contrib-id>
<name>
<surname>Draxl</surname>
<given-names>Claudia</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Physics and CSMB Adlershof,
Humboldt-UniversitÃ¤t zu Berlin, Zum GroÃŸen Windkanal 2, D-12489 Berlin,
Germany</institution>
</institution-wrap>
</aff>
</contrib-group>
<volume>11</volume>
<issue>118</issue>
<fpage>8866</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2026</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Fortran</kwd>
<kwd>Many-Body Pertrubation Theory</kwd>
<kwd>Bethe-Salpeter equation</kwd>
<kwd>Interpolative Seperable Denisty Fitting</kwd>
<kwd>DFT</kwd>
<kwd>exciting</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Solving the Bethe-Salpeter Equation (BSE) is essential for
  understanding excited-state systems, but often challenging to converge
  or even computationally prohibitive for large systems. We implement a
  matrix-free BSE solver leveraging Interpolative Separable Density
  Fitting (ISDF) to interpolate electron-hole interaction kernels
  together with the Lanczos algorithm for diagonalization, avoiding full
  matrix setup. The scaling of our implementation is bounded by
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}(N_o N_u N_{\mathbf k} \log N_{\mathbf k})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ’ª</mml:mi><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mo>&#8289;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  and is thus a massive improvement over methods that set up the whole
  matrix, scaling with at least <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}((N_o N_u N_{\mathbf k})^3)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ’ª</mml:mi><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[N_o]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[N_u]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  are the numbers of occupied and unoccupied states, respectively, and
  <inline-formula><alternatives>
  <tex-math><![CDATA[N_{\mathbf k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the number <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ¤</mml:mi></mml:math></alternatives></inline-formula>-points.</p>
</sec>
<sec id="theoretical-background">
  <title>Theoretical background</title>
  <p>The Bethe-Salpeter Equation (BSE) within many body perturbation
  theory (MBPT) provides the state-of-the-art framework for describing
  light-matter interaction. In particular, it is used to obtain optical
  absorption spectra, including the effects of excitons, which are bound
  electron-hole states. By expanding the electron-hole wavefunctions in
  the transition basis, solving the BSE can be reduced to a
  SchrÃ¶dinger-like equation. Setting up and diagonalizing the
  Bethe-Salpeter Hamiltonian (BSH) are the computationally expensive
  tasks
  (<xref alt="Vorwerk et al., 2019" rid="ref-VorwerkU003A2019" ref-type="bibr">Vorwerk
  et al., 2019</xref>). The BSH is given as <disp-formula><alternatives>
  <tex-math><![CDATA[
  H^{BSH} = D + \gamma V - W \:,
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>H</mml:mi><mml:mrow><mml:mi>B</mml:mi><mml:mi>S</mml:mi><mml:mi>H</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>Î³</mml:mi><mml:mi>V</mml:mi><mml:mo>âˆ’</mml:mo><mml:mi>W</mml:mi><mml:mspace width="0.222em"></mml:mspace><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\gamma = 2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Î³</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  gives the spin-singlet and <inline-formula><alternatives>
  <tex-math><![CDATA[\gamma = 0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Î³</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  spin-triplet channel, respectively. The diagonal term
  <inline-formula><alternatives>
  <tex-math><![CDATA[D]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>D</mml:mi></mml:math></alternatives></inline-formula>
  is given by the differences of the one-particle energies of the
  occupied (<inline-formula><alternatives>
  <tex-math><![CDATA[o]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>o</mml:mi></mml:math></alternatives></inline-formula>)
  and unoccupied (<inline-formula><alternatives>
  <tex-math><![CDATA[u]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>u</mml:mi></mml:math></alternatives></inline-formula>)
  states: <disp-formula><alternatives>
  <tex-math><![CDATA[
  D_{ou\mathbf{k},o'u'\mathbf{k}'} = (\varepsilon_{u\mathbf{k}} - \varepsilon_{o\mathbf{k}})\delta_{oo'}\delta_{uu'}\delta_{\mathbf{k}\mathbf{k}'}\:.
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>ğ¤</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>o</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>u</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msub><mml:mi>Îµ</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow></mml:msub><mml:mo>âˆ’</mml:mo><mml:msub><mml:mi>Îµ</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msub><mml:mi>Î´</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:msup><mml:mi>o</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mi>Î´</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:msup><mml:mi>u</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:msub><mml:mi>Î´</mml:mi><mml:mrow><mml:mi>ğ¤</mml:mi><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mspace width="0.222em"></mml:mspace><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>
  The matrix elements of the repulsive exchange interaction
  <inline-formula><alternatives>
  <tex-math><![CDATA[V]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>V</mml:mi></mml:math></alternatives></inline-formula>
  and the attractive screened Coulomb interaction
  <inline-formula><alternatives>
  <tex-math><![CDATA[W]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>
  are calculated by solving integrals of the form
  <disp-formula><alternatives>
  <tex-math><![CDATA[
  V_{ou\mathbf{k}, o'u'\mathbf{k}'} = \int d^3r \int d^3 r' \frac{ 
  u_{o\mathbf{k}}(\mathbf{r})
  u^*_{u\mathbf{k}}(\mathbf{r})
  u^*_{o'\mathbf{k}'}(\mathbf{r'})
  u_{u'\mathbf{k}'}(\mathbf{r'}) 
  } {| \mathbf{r - r'} |} \:,
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>ğ¤</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>o</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>u</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>âˆ«</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>r</mml:mi><mml:mo>âˆ«</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>r</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:msup><mml:mi>o</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msup><mml:mi>ğ«</mml:mi><mml:mo mathvariant="bold">â€²</mml:mo></mml:msup><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msup><mml:mi>ğ«</mml:mi><mml:mo mathvariant="bold">â€²</mml:mo></mml:msup><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mrow><mml:mi>ğ«</mml:mi><mml:mo mathvariant="bold">âˆ’</mml:mo><mml:msup><mml:mi>ğ«</mml:mi><mml:mo mathvariant="bold">â€²</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false" form="prefix">|</mml:mo></mml:mrow></mml:mfrac><mml:mspace width="0.222em"></mml:mspace><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  <disp-formula><alternatives>
  <tex-math><![CDATA[
  W_{ou\mathbf{k}, o'u'\mathbf{k}'} = \int d^3r \int d^3 r' u^*_{u\mathbf{k}}(\mathbf{r})
  u_{u'\mathbf{k}'}(\mathbf{r}) 
  W_{\mathbf{k-k'}} (\mathbf{r, r'})
  u_{o\mathbf{k}}(\mathbf{r}')
  u^*_{o'\mathbf{k}'}(\mathbf{r}')
   \:,
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>u</mml:mi><mml:mi>ğ¤</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>o</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>u</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>âˆ«</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:mi>r</mml:mi><mml:mo>âˆ«</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mi>r</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>u</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:msup><mml:mi>u</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>ğ¤</mml:mi><mml:mo mathvariant="bold">âˆ’</mml:mo><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo mathvariant="bold">â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mrow><mml:mi>ğ«</mml:mi><mml:mo mathvariant="bold">,</mml:mo><mml:msup><mml:mi>ğ«</mml:mi><mml:mo mathvariant="bold">â€²</mml:mo></mml:msup></mml:mrow><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>o</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msup><mml:mi>ğ«</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:msup><mml:mi>o</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msup><mml:mi>ğ«</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[W_{\mathbf{k-k'}}(\mathbf{r}, \mathbf{r}')]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>ğ¤</mml:mi><mml:mo mathvariant="bold">âˆ’</mml:mo><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo mathvariant="bold">â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>ğ«</mml:mi><mml:mo>â€²</mml:mo></mml:msup><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  is the statically screened Coulomb potential.
  <inline-formula><alternatives>
  <tex-math><![CDATA[u_{i\mathbf{k}}(\mathbf{r})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  is the periodic part of the one-particle wavefunction of state
  <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  at the reciprocal lattice point <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ¤</mml:mi></mml:math></alternatives></inline-formula>.
  In general, we cannot see which of the matrix elements will be zero,
  thus we need to compute all of them. Therefore, setting up the full
  BSH scales with <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}(N_o^2 N_u^2 N_{\mathbf{k}}^2)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ’ª</mml:mi><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>u</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  and diagonalizing it directly with <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}(N_o^3 N_u^3 N_{\mathbf{k}}^3)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ’ª</mml:mi><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>o</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>u</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p>The primary scaling bottleneck stems from evaluating the matrix
  elements of the interaction kernels. To mitigate this, we reformulate
  the wavefunction products using Interpolative Separable Density
  Fitting (ISDF)
  (<xref alt="Lu &amp; Ying, 2015" rid="ref-LuU003A2015" ref-type="bibr">Lu
  &amp; Ying, 2015</xref>,
  <xref alt="2016" rid="ref-LuU003A2016" ref-type="bibr">2016</xref>).
  Specifically, we approximate these products on a discrete real-space
  grid, <inline-formula><alternatives>
  <tex-math><![CDATA[\{\mathbf{r}\}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>,
  by expressing them as superpositions of values evaluated on a smaller
  interpolation grid, <inline-formula><alternatives>
  <tex-math><![CDATA[\{\mathbf{r}_\mu\} \subset \{\mathbf{r}\}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:msub><mml:mi>ğ«</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:mo>âŠ‚</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>:
  <disp-formula><alternatives>
  <tex-math><![CDATA[
  u_{i\mathbf{k}}^*(\mathbf{r})u_{j\mathbf{k}'}(\mathbf{r}) \approx \sum_{\mu=1}^{N_\mu} \zeta_\mu(\mathbf{r}) u_{i\mathbf{k}}^*(\mathbf{r}_\mu) u_{j\mathbf{k}}(\mathbf{r}_\mu) \:,
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:mo>â‰ˆ</mml:mo><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>Î¼</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi></mml:msub></mml:munderover><mml:msub><mml:mi>Î¶</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msub><mml:mi>ğ«</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msub><mml:mi>ğ«</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the number of interpolation points, and
  <inline-formula><alternatives>
  <tex-math><![CDATA[\zeta_\mu(\mathbf r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Î¶</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  are the expansion coefficients. Due to the tensor product structure of
  <inline-formula><alternatives>
  <tex-math><![CDATA[u_{i\mathbf{k}}^*(\mathbf{r})u_{j\mathbf{k}'}(\mathbf{r})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:msup><mml:mi>ğ¤</mml:mi><mml:mo>â€²</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[\zeta_\mu(\mathbf r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Î¶</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  can be computed efficiently, and the scaling is bounded by
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}(N_\mu^3)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ’ª</mml:mi><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi><mml:mn>3</mml:mn></mml:msubsup><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  (<xref alt="Hu et al., 2017" rid="ref-HuU003A2017" ref-type="bibr">Hu
  et al., 2017</xref>). We observe that we can always choose
  <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mu \ll N_o N_u N_\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:mo>â‰ª</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
  thus ISDF is never a bottleneck. The interpolation points are computed
  efficiently with centroidal Voronoi tessellation within
  <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}(N_\mu N_r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ’ª</mml:mi><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  (<xref alt="Dong et al., 2018" rid="ref-DongU003A2018" ref-type="bibr">Dong
  et al., 2018</xref>).</p>
  <p>Replacing the wavefunction products in the interaction kernel
  integrals with the ISDF representation yields a formulation that
  allows for efficient application to a vector without ever setting up
  the full matrix. Combined with a Lanczos algorithm, the BSE can be
  solved with a scaling of <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}(N_o N_u N_k \log N_k)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ’ª</mml:mi><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>u</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mo>&#8289;</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  (<xref alt="Henneke et al., 2020" rid="ref-HennekeU003A2020" ref-type="bibr">Henneke
  et al., 2020</xref>).</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Due to the unfavorable scaling of solving the BSE directly, many
  interesting problems such as complex materials with large unit cells
  or systems requiring a dense Brillouin-zone sampling are not feasible.
  Even though Henneke and coworkers
  (<xref alt="Henneke et al., 2020" rid="ref-HennekeU003A2020" ref-type="bibr">Henneke
  et al., 2020</xref>) have already described the new algorithm and
  demonstrated the scaling improvement, an easy-to-use and scalable
  implementation was still missing. We have implemented and fully
  integrated this approach in the existing BSE infrastructure of the
  all-electron, full-potential package
  <styled-content style="font-family: 'Courier New', monospace; font-weight: bold;">exciting</styled-content>
  (<xref alt="Gulans et al., 2014" rid="ref-GulansU003A2014" ref-type="bibr">Gulans
  et al., 2014</xref>). Users can now easily choose which algorithm they
  prefer to use and have the full suite of exciton analysis implemented
  in
  <styled-content style="font-family: 'Courier New', monospace; font-weight: bold;">exciting</styled-content>
  at hand.</p>
</sec>
<sec id="results">
  <title>Results</title>
  <p>For computing the ISDF, two new parameters,
  <inline-formula><alternatives>
  <tex-math><![CDATA[n_\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[c_\mu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>c</mml:mi><mml:mi>Î¼</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  are introduced. <inline-formula><alternatives>
  <tex-math><![CDATA[n_\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the real-space sampling density for <inline-formula><alternatives>
  <tex-math><![CDATA[u_{i\mathbf{k}}(\mathbf{r})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>ğ¤</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:mi>ğ«</mml:mi><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  and is defined as <disp-formula><alternatives>
  <tex-math><![CDATA[
  n_\mathbf{r} = \frac{N_\mathbf{r}}{\Omega}\:,
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ«</mml:mi></mml:msub><mml:mi mathvariant="normal">Î©</mml:mi></mml:mfrac><mml:mspace width="0.222em"></mml:mspace><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ«</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the number of <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ«</mml:mi></mml:math></alternatives></inline-formula>-points
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\Omega]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi mathvariant="normal">Î©</mml:mi></mml:math></alternatives></inline-formula>
  the unit cell volume. The sampling is chosen to be regular such that
  the distance between the sampling points in each lattice direction is
  as similar as possible. The dimensionless parameter
  <inline-formula><alternatives>
  <tex-math><![CDATA[c_\mu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>c</mml:mi><mml:mi>Î¼</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is used to control the number of interpolation points and is defined
  as <disp-formula><alternatives>
  <tex-math><![CDATA[
  N_\mu = c_\mu \sqrt{\sqrt{N_{\text{pairs}}}}\:,
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:msqrt><mml:msqrt><mml:msub><mml:mi>N</mml:mi><mml:mtext mathvariant="normal">pairs</mml:mtext></mml:msub></mml:msqrt></mml:msqrt><mml:mspace width="0.222em"></mml:mspace><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[N_{\text{pairs}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mtext mathvariant="normal">pairs</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
  refers to the number of wave function pairs for which ISDF is
  computed. Note that <inline-formula><alternatives>
  <tex-math><![CDATA[N_\text{pairs}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mtext mathvariant="normal">pairs</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
  depends on <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  The double square-root dependence ensures that the overall scaling
  remains below <inline-formula><alternatives>
  <tex-math><![CDATA[\mathcal{O}(N_\mathbf{k}^2)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ’ª</mml:mi><mml:mo stretchy="false" form="prefix">(</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.
  In
  <xref alt="[fig:newparams]" rid="figU003Anewparams">[fig:newparams]</xref>
  we present, for the example of diamond, the difference in exciton
  binding energies obtained with the new implementation and a reference
  calculation. The reference, based on the direct implementation, sets
  up and diagonalizes the full BSH and depends neither on
  <inline-formula><alternatives>
  <tex-math><![CDATA[n_\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  nor <inline-formula><alternatives>
  <tex-math><![CDATA[c_\mu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>c</mml:mi><mml:mi>Î¼</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  The results are shown as functions of <inline-formula><alternatives>
  <tex-math><![CDATA[n_\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[c_\mu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>c</mml:mi><mml:mi>Î¼</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  for a small <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ¤</mml:mi></mml:math></alternatives></inline-formula>-grid
  of <inline-formula><alternatives>
  <tex-math><![CDATA[2\times 2\times 2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>2</mml:mn><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
  Additionally, we show the spectral similarities compared to the
  reference calculation as functions of <inline-formula><alternatives>
  <tex-math><![CDATA[n_\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[c_\mu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>c</mml:mi><mml:mi>Î¼</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  For both parameters, both properties converge as their values
  increase. To find the optimal interpolation grid for ISDF, we first
  converge <inline-formula><alternatives>
  <tex-math><![CDATA[n_\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  then <inline-formula><alternatives>
  <tex-math><![CDATA[c_\mu]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>c</mml:mi><mml:mi>Î¼</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  In our example, <inline-formula><alternatives>
  <tex-math><![CDATA[n_\mathbf{r}=138]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>138</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  [a.u.] and <inline-formula><alternatives>
  <tex-math><![CDATA[c_\mu = 40.0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>Î¼</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>40.0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  yield converged results. This corresponds to a real-space sampling of
  <inline-formula><alternatives>
  <tex-math><![CDATA[22 \times 22 \times 22]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>22</mml:mn><mml:mo>Ã—</mml:mo><mml:mn>22</mml:mn><mml:mo>Ã—</mml:mo><mml:mn>22</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  and numbers of interpolation points <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mu^V = 202]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi><mml:mi>V</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>202</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mu^{W_o} = 322]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:msubsup><mml:mo>=</mml:mo><mml:mn>322</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  and <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mu^{W_u} = 360]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:msubsup><mml:mo>=</mml:mo><mml:mn>360</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <fig>
    <caption><p>Difference of the exciton binding energy
    <inline-formula><alternatives>
    <tex-math><![CDATA[\Delta E_\mathrm{b}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi mathvariant="normal">Î”</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">b</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
    and spectral similarity <inline-formula><alternatives>
    <tex-math><![CDATA[S]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>S</mml:mi></mml:math></alternatives></inline-formula>
    between the new method and the direct method as functions of
    <inline-formula><alternatives>
    <tex-math><![CDATA[n_\mathbf{r}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    (upper panel) and <inline-formula><alternatives>
    <tex-math><![CDATA[c_\mu]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>c</mml:mi><mml:mi>Î¼</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    (lower panel) for diamond on a <inline-formula><alternatives>
    <tex-math><![CDATA[2 \times 2 \times 2]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mn>2</mml:mn><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn><mml:mo>Ã—</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    <inline-formula><alternatives>
    <tex-math><![CDATA[\mathbf k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ¤</mml:mi></mml:math></alternatives></inline-formula>-grid.
    <styled-content id="figU003Anewparams"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="Diamond_ngridrdens_cisdf.png" />
  </fig>
  <p>In <xref alt="[fig:error]" rid="figU003Aerror">[fig:error]</xref>,
  we compare the exciton binding energies <inline-formula><alternatives>
  <tex-math><![CDATA[\Delta E_\mathrm{b}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi mathvariant="normal">Î”</mml:mi><mml:msub><mml:mi>E</mml:mi><mml:mi mathvariant="normal">b</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  and spectra of the new implementation to those of the old
  implementation for increasing <inline-formula><alternatives>
  <tex-math><![CDATA[\mathbf k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ¤</mml:mi></mml:math></alternatives></inline-formula>-grids,
  while keeping <inline-formula><alternatives>
  <tex-math><![CDATA[n_\mathbf{r}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>n</mml:mi><mml:mi>ğ«</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  as well as <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mu^V]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi><mml:mi>V</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mu^{W_o}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula>,
  and <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mu^{W_u}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>N</mml:mi><mml:mi>Î¼</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:msubsup></mml:math></alternatives></inline-formula>
  fixed at the values above. We observe that the results converge as
  <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  increases. Thus, the number of interpolation points is asymptotically
  independent of <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  A similar behavior of ISDF was observed in
  (<xref alt="Lu &amp; Ying, 2016" rid="ref-LuU003A2016" ref-type="bibr">Lu
  &amp; Ying, 2016</xref>).</p>
  <fig>
    <caption><p>Difference of the exciton binding energy and spectral
    similarity between the new method and the direct method as functions
    of <inline-formula><alternatives>
    <tex-math><![CDATA[N_{\mathbf k}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    for diamond.
    <styled-content id="figU003Aerror"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="Diamond_ngridk_fastDirectComparison.png" />
  </fig>
  <p>In
  <xref alt="[fig:scaling]" rid="figU003Ascaling">[fig:scaling]</xref>,
  we show the wall times for solving the BSE with the new and direct
  implementations for increasing <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  The new algorithm massively outperforms the direct one, and the
  speedup increases more than linearly with
  <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  We also show the wall times for computing the RPA screening with
  increasing <inline-formula><alternatives>
  <tex-math><![CDATA[N_\mathbf{k}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  which is now clearly the bottleneck in solving the BSE.</p>
  <fig>
    <caption><p>Runtimes of the direct (black) and new (red) BSE
    implementations and the RPA screening (blue) as functions of
    <inline-formula><alternatives>
    <tex-math><![CDATA[N_\mathbf{k}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>N</mml:mi><mml:mi>ğ¤</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
    The speedup of the algorithm is shown by the gray dashed line.
    <styled-content id="figU003Ascaling"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="Diamond_ngridk_scaling.png" />
  </fig>
  <p>Altogether, we have implemented a new, low-scaling BSE solver and
  fully integrated it into the all-electron, full-potential package
  <styled-content style="font-family: 'Courier New', monospace; font-weight: bold;">exciting</styled-content>.
  We demonstrate that the new implementation yields results equivalent
  to the direct solution of the BSE but with significantly reduced
  computational time. Consequently, it enables more precise calculations
  and facilitates the study of more complex problems.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-HennekeU003A2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Henneke</surname><given-names>Felix</given-names></name>
        <name><surname>Lin</surname><given-names>Lin</given-names></name>
        <name><surname>Vorwerk</surname><given-names>Christian</given-names></name>
        <name><surname>Draxl</surname><given-names>Claudia</given-names></name>
        <name><surname>Klein</surname><given-names>Rupert</given-names></name>
        <name><surname>Yang</surname><given-names>Chao</given-names></name>
      </person-group>
      <article-title>Fast optical absorption spectra calculations for periodic solid state systems</article-title>
      <source>Communications in Applied Mathematics and Computational Science</source>
      <publisher-name>Mathematical Sciences Publishers</publisher-name>
      <year iso-8601-date="2020-06">2020</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-11-03">2024</year><month>11</month><day>03</day></date-in-citation>
      <volume>15</volume>
      <uri>https://msp.org/camcos/2020/15-1/p04.xhtml</uri>
      <pub-id pub-id-type="doi">10.2140/camcos.2020.15.89</pub-id>
      <fpage>89</fpage>
      <lpage>113</lpage>
    </element-citation>
  </ref>
  <ref id="ref-DongU003A2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dong</surname><given-names>Kun</given-names></name>
        <name><surname>Hu</surname><given-names>Wei</given-names></name>
        <name><surname>Lin</surname><given-names>Lin</given-names></name>
      </person-group>
      <article-title>Interpolative separable density fitting through centroidal Voronoi tessellation with applications to hybrid functional electronic structure calculations</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2018-01">2018</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-04-24">2022</year><month>04</month><day>24</day></date-in-citation>
      <volume>14</volume>
      <pub-id pub-id-type="doi">10.1021/acs.jctc.7b01113</pub-id>
      <fpage>1311</fpage>
      <lpage>1320</lpage>
    </element-citation>
  </ref>
  <ref id="ref-LuU003A2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lu</surname><given-names>Jianfeng</given-names></name>
        <name><surname>Ying</surname><given-names>Lexing</given-names></name>
      </person-group>
      <article-title>Compression of the electron repulsion integral tensor in tensor hypercontraction format with cubic scaling cost</article-title>
      <source>Journal of Computational Physics</source>
      <year iso-8601-date="2015-12">2015</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-06-12">2024</year><month>06</month><day>12</day></date-in-citation>
      <volume>302</volume>
      <uri>https://arxiv.org/pdf/1410.7757</uri>
      <pub-id pub-id-type="doi">10.1016/j.jcp.2015.09.014</pub-id>
      <fpage>329</fpage>
      <lpage>335</lpage>
    </element-citation>
  </ref>
  <ref id="ref-GulansU003A2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gulans</surname><given-names>Andris</given-names></name>
        <name><surname>Kontur</surname><given-names>Stefan</given-names></name>
        <name><surname>Meisenbichler</surname><given-names>Christian</given-names></name>
        <name><surname>Nabok</surname><given-names>Dmitrii</given-names></name>
        <name><surname>Pavone</surname><given-names>Pasquale</given-names></name>
        <name><surname>Rigamonti</surname><given-names>Santiago</given-names></name>
        <name><surname>Sagmeister</surname><given-names>Stephan</given-names></name>
        <name><surname>Werner</surname><given-names>Ute</given-names></name>
        <name><surname>Draxl</surname><given-names>Claudia</given-names></name>
      </person-group>
      <article-title>Exciting: A full-potential all-electron package implementing density-functional theory and many-body perturbation theory</article-title>
      <source>Journal of Physics: Condensed Matter</source>
      <year iso-8601-date="2014-08">2014</year><month>08</month>
      <volume>26</volume>
      <pub-id pub-id-type="doi">10.1088/0953-8984/26/36/363202</pub-id>
      <fpage>363202</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-VorwerkU003A2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vorwerk</surname><given-names>Christian</given-names></name>
        <name><surname>Aurich</surname><given-names>Benjamin</given-names></name>
        <name><surname>Cocchi</surname><given-names>Caterina</given-names></name>
        <name><surname>Draxl</surname><given-names>Claudia</given-names></name>
      </person-group>
      <article-title>Betheâ€“Salpeter equation for absorption and scattering spectroscopy: Implementation in the exciting code</article-title>
      <source>Electronic structure</source>
      <publisher-name>IOP Publishing</publisher-name>
      <year iso-8601-date="2019-08">2019</year><month>08</month>
      <volume>1</volume>
      <pub-id pub-id-type="doi">10.1088/2516-1075/ab3123</pub-id>
      <fpage>037001</fpage>
      <lpage>037001</lpage>
    </element-citation>
  </ref>
  <ref id="ref-HuU003A2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hu</surname><given-names>Wei</given-names></name>
        <name><surname>Lin</surname><given-names>Lin</given-names></name>
        <name><surname>Yang</surname><given-names>Chao</given-names></name>
      </person-group>
      <article-title>Interpolative separable density fitting decomposition for accelerating hybrid density functional calculations with applications to defects in silicon</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2017-10">2017</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-04-24">2022</year><month>04</month><day>24</day></date-in-citation>
      <volume>13</volume>
      <pub-id pub-id-type="doi">10.1021/acs.jctc.7b00807</pub-id>
      <fpage>5420</fpage>
      <lpage>5431</lpage>
    </element-citation>
  </ref>
  <ref id="ref-LuU003A2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lu</surname><given-names>Jianfeng</given-names></name>
        <name><surname>Ying</surname><given-names>Lexing</given-names></name>
      </person-group>
      <article-title>Fast algorithm for periodic density fitting for Bloch waves</article-title>
      <source>Annals of Mathematical Sciences and Applications</source>
      <year iso-8601-date="2016-07-25">2016</year><month>07</month><day>25</day>
      <date-in-citation content-type="access-date"><year iso-8601-date="2025-08-20">2025</year><month>08</month><day>20</day></date-in-citation>
      <volume>1</volume>
      <issue>2</issue>
      <issn>2380-2898</issn>
      <uri>https://link.intlpress.com/JDetail/1805564664274690050</uri>
      <pub-id pub-id-type="doi">10.4310/AMSA.2016.v1.n2.a3</pub-id>
      <fpage>321</fpage>
      <lpage>339</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
