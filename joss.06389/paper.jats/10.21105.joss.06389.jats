<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6389</article-id>
<article-id pub-id-type="doi">10.21105/joss.06389</article-id>
<title-group>
<article-title>SSN2: The next generation of spatial stream network
modeling in R</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3393-5529</contrib-id>
<name>
<surname>Dumelle</surname>
<given-names>Michael</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2992-0372</contrib-id>
<name>
<surname>Peterson</surname>
<given-names>Erin E.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4302-6895</contrib-id>
<name>
<surname>Hoef</surname>
<given-names>Jay M. Ver</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4133-8548</contrib-id>
<name>
<surname>Pearse</surname>
<given-names>Alan</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Isaak</surname>
<given-names>Daniel J.</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Pacific Ecological Systems Division, United States
Environmental Protection Agency, Corvallis, OR, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>EP Consulting and Centre for Data Science, Queensland
University of Technology, Brisbane, QLD, Australia</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>NMFS Alaska Fisheries Science Center, United States
National Oceanic and Atmospheric Administration, Seattle, WA,
USA</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>NIASRA, School of Mathematics and Applied Statistics,
University of Wollongong, Wollongong, NSW, Australia</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Rocky Mountain Research Station, United States Forest
Service, Boise, ID, USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-07-07">
<day>7</day>
<month>7</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>99</issue>
<fpage>6389</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>Spatial stream network</kwd>
<kwd>Spatial correlation</kwd>
<kwd>Spatial prediction (Kriging)</kwd>
<kwd>Geostatistics</kwd>
<kwd>Generalized linear model</kwd>
<kwd>Torgegram</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>The <monospace>SSN2</monospace> <bold>R</bold> package provides
  tools for spatial statistical modeling, parameter estimation, and
  prediction on stream (river) networks. <monospace>SSN2</monospace> is
  the successor to the <monospace>SSN</monospace> <bold>R</bold> package
  (<xref alt="Ver Hoef, Peterson, Clifford, &amp; Shah, 2014" rid="ref-ver2014ssn" ref-type="bibr">Ver
  Hoef, Peterson, Clifford, &amp; Shah, 2014</xref>), which was archived
  alongside broader changes in the <bold>R</bold>-spatial ecosystem
  (<xref alt="Nowosad, 2023" rid="ref-nowosad2023" ref-type="bibr">Nowosad,
  2023</xref>) that included 1) the retirement of
  <monospace>rgdal</monospace>
  (<xref alt="Bivand, Keitt, &amp; Rowlingson, 2021" rid="ref-bivand2021rgdal" ref-type="bibr">Bivand,
  Keitt, &amp; Rowlingson, 2021</xref>), <monospace>rgeos</monospace>
  (<xref alt="Bivand &amp; Rundel, 2020" rid="ref-bivand2020rgeos" ref-type="bibr">Bivand
  &amp; Rundel, 2020</xref>), and <monospace>maptools</monospace>
  (<xref alt="Bivand &amp; Lewin-Koh, 2021" rid="ref-bivand2021maptools" ref-type="bibr">Bivand
  &amp; Lewin-Koh, 2021</xref>) and 2) the lack of active development of
  <monospace>sp</monospace>
  (<xref alt="Bivand, Pebesma, &amp; Gómez-Rubio, 2013" rid="ref-bivand2013applied" ref-type="bibr">Bivand,
  Pebesma, &amp; Gómez-Rubio, 2013</xref>). <monospace>SSN2</monospace>
  maintains compatibility with the input data file structures used by
  the <monospace>SSN</monospace> <bold>R</bold> package but leverages
  modern <bold>R</bold>-spatial tools like <monospace>sf</monospace>
  (<xref alt="Pebesma, 2018" rid="ref-pebesma2018sf" ref-type="bibr">Pebesma,
  2018</xref>). <monospace>SSN2</monospace> also provides many useful
  features that were not available in the <monospace>SSN</monospace>
  <bold>R</bold> package, including new modeling and helper functions,
  enhanced fitting algorithms, and simplified syntax consistent with
  other <bold>R</bold> generic functions.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Streams provide vital aquatic services that sustain wildlife,
  provide drinking and irrigation water, and support recreational and
  cultural activities. Data are often collected at various locations on
  a stream network and used to characterize spatial patterns in stream
  phenomena. For example, a manager may need to know how the amount of a
  hazardous chemical changes throughout a stream network to inform
  mitigation efforts. Comprehensive formulations of spatial stream
  network (SSN) models are provided by Ver Hoef &amp; Peterson
  (<xref alt="2010" rid="ref-ver2010moving" ref-type="bibr">2010</xref>),
  Peterson &amp; Ver Hoef
  (<xref alt="2010" rid="ref-peterson2010mixed" ref-type="bibr">2010</xref>),
  and Ver Hoef et al.
  (<xref alt="2014" rid="ref-ver2014ssn" ref-type="bibr">2014</xref>).
  The <monospace>SSN2</monospace> <bold>R</bold> package is designed to
  help users fit SSN models to their stream network data.</p>
  <p>SSN models use a spatial statistical modeling framework (e.g.,
  <xref alt="Cressie, 1993" rid="ref-cressie1993statistics" ref-type="bibr">Cressie,
  1993</xref>) to describe unique and complex dependencies on a stream
  network resulting from a branching network structure, directional
  water flow, and differences in flow volume. These SSN models relate a
  continuous or discrete response variable to one or more explanatory
  variables, a spatially independent random error term, and up to three
  spatially dependent random error terms: tail-up random errors,
  tail-down random errors, and Euclidean random errors. Tail-up random
  errors restrict spatial dependence to flow-connected sites (i.e.,
  water flows from an upstream to a downstream site) and incorporate
  spatial weights through an additive function to describe the branching
  network between sites. Tail-down random errors describe spatial
  dependence between both flow-connected and flow-unconnected sites
  (i.e., sites that share a common downstream junction but not flow),
  but spatial weights are not required. Euclidean random errors describe
  spatial dependence between sites based on straight-line distance and
  are governed by factors not confined to the stream network, such as
  regional geology. The variances and the length-scales of spatial
  dependence in the tail-up, tail-down, and Euclidean random errors are
  controlled by separate variance (i.e., partial sill) and range
  parameters, respectively, while the spatially independent variance
  (i.e., nugget) is controlled by another separate variance parameter.
  In this paper, we show how to use the <monospace>SSN2</monospace>
  <bold>R</bold> package to fit SSN models, inspect SSN models, and use
  SSN models to make predictions at unobserved locations on a stream
  network.</p>
</sec>
<sec id="package-overview">
  <title>Package Overview</title>
  <p>The streams, observation, and prediction datasets must be
  pre-processed prior to fitting SSN models and making predictions at
  unobserved locations using <monospace>SSN2</monospace>. Previously,
  the STARS toolset for ArcGIS Desktop versions 9.3x - 10.8x
  (<xref alt="Peterson &amp; Ver Hoef, 2014" rid="ref-peterson2014stars" ref-type="bibr">Peterson
  &amp; Ver Hoef, 2014</xref>) or the <monospace>openSTARS</monospace>
  <bold>R</bold> package
  (<xref alt="Kattwinkel, Szöcs, Peterson, &amp; Schäfer, 2020" rid="ref-kattwinkel2020preparing" ref-type="bibr">Kattwinkel,
  Szöcs, Peterson, &amp; Schäfer, 2020</xref>) were used to generate
  spatial information required for model fitting and prediction.
  However, both software packages have recently been retired and are
  replaced by the <monospace>SSNbler</monospace> <bold>R</bold> package
  (<xref alt="Peterson, Dumelle, Pearse, Teleki, &amp; Ver Hoef, 2024" rid="ref-peterson2024SSNbler" ref-type="bibr">Peterson,
  Dumelle, Pearse, Teleki, &amp; Ver Hoef, 2024</xref>), which is a new,
  <bold>R</bold>-based version of the STARS tools.
  <monospace>SSNbler</monospace> is currently available on GitHub, will
  soon be available on CRAN, and contains several useful resources that
  guide users through these pre-processing steps. Pre-processing using
  either <monospace>SSNbler</monospace>, STARS, or
  <monospace>openSTARS</monospace> ends with the creation of a
  <monospace>.ssn</monospace> folder, which is non-proprietary. Files
  residing in the <monospace>.ssn</monospace> folder are read into R
  using <monospace>ssn_import()</monospace> from
  <monospace>SSN2</monospace> and placed into a list structure called an
  SSN object, which contains all the spatial, topological, and attribute
  information needed to leverage the modeling tools in
  <monospace>SSN2</monospace>.</p>
  <p><monospace>SSN2</monospace> is first installed from CRAN:</p>
  <code language="r script">install.packages(&quot;SSN2&quot;)</code>
  <p>Then, <monospace>SSN2</monospace> is loaded into an <bold>R</bold>
  session:</p>
  <code language="r script">library(SSN2)</code>
  <p>The <monospace>SSN2</monospace> package comes with an example
  <monospace>.ssn</monospace> folder called
  <monospace>MiddleFork04.ssn</monospace> that represents water
  temperatures recorded from a stream network in the Middle Fork of the
  Salmon River in Idaho, USA during 2004.</p>
  <p>Several functions in <monospace>SSN2</monospace> for reading and
  writing data directly manipulate the <monospace>.ssn</monospace>
  folder. To avoid directly manipulating the
  <monospace>MiddleFork04.ssn</monospace> data installed alongside
  <monospace>SSN2</monospace>, <monospace>MiddleFork04.ssn</monospace>
  is instead copied into a temporary directory and the relevant path to
  this directory stored:</p>
  <code language="r script">copy_lsn_to_temp()
path &lt;- file.path(tempdir(), &quot;MiddleFork04.ssn&quot;)</code>
  <p>The <monospace>copy_lsn_to_temp()</monospace> function is only used
  when working with <monospace>MiddleFork04.ssn</monospace> and
  generally, <monospace>path</monospace> should indicate a permanent
  directory on your computer that points towards your
  <monospace>.ssn</monospace> object. After specifying
  <monospace>path</monospace>, the stream reaches, observed sites, and
  prediction sites (<monospace>pred1km</monospace>) are imported and
  then visualized (Figure<inline-formula><alternatives>
  <tex-math><![CDATA[~]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mspace width="0.222em"></mml:mspace></mml:math></alternatives></inline-formula><xref alt="[fig:steam-network]" rid="figU003Asteam-network">[fig:steam-network]</xref>):</p>
  <code language="r script">mf04p &lt;- ssn_import(path, predpts = &quot;pred1km&quot;)</code>
  <code language="r script">library(ggplot2)
ggplot() +
  geom_sf(data = mf04p$edges) +
  geom_sf(data = mf04p$preds$pred1km, pch = 17, color = &quot;blue&quot;) +
  geom_sf(data = mf04p$obs, color = &quot;brown&quot;, size = 2) +
  theme_bw()</code>
  <fig id="figU003Asteam-network">
    <caption><p>Middle Fork 2004 stream networks. Observed sites are
    represented by brown, closed circles at various locations throughout
    the stream network. Prediction sites are represented by blue, closed
    triangles and are spaced one kilometer apart.</p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="steam-network-1.pdf" />
  </fig>
  <p>Prior to statistical modeling, hydrologic distance matrices are
  created
  (<xref alt="Ver Hoef &amp; Peterson, 2010" rid="ref-ver2010moving" ref-type="bibr">Ver
  Hoef &amp; Peterson, 2010</xref>):</p>
  <code language="r script">ssn_create_distmat(mf04p, predpts = &quot;pred1km&quot;, overwrite = TRUE)</code>
  <p>Of particular interest here is summer mean stream temperature
  (<monospace>Summer_mn</monospace>) in degrees Celsius, which will be
  modeled as a function of elevation (<monospace>ELEV_DEM</monospace>)
  and watershed-averaged precipitation
  (<monospace>AREAWTMAP</monospace>) with exponential, spherical, and
  Gaussian structures for the tail-up, tail-down, and Euclidean errors,
  respectively, and a nugget effect (by default). Using
  <monospace>ssn_lm()</monospace>, the model is fit:</p>
  <code language="r script">ssn_mod &lt;- ssn_lm(
  formula = Summer_mn ~ ELEV_DEM + AREAWTMAP,
  ssn.object = mf04p,
  tailup_type = &quot;exponential&quot;,
  taildown_type = &quot;spherical&quot;,
  euclid_type = &quot;gaussian&quot;,
  additive = &quot;afvArea&quot;
)</code>
  <p>The <monospace>additive</monospace> argument represents an
  “additive function value (AFV)” variable that captures branching in
  the stream network and is required when modeling the tail-up
  covariance. Cumulative watershed area is commonly used to derive the
  additive function value (here, <monospace>afvArea</monospace>
  represents cumulative watershed area), but other variables like flow
  can be used (if every line feature in the <monospace>edges</monospace>
  dataset contains a non-null value). Ver Hoef &amp; Peterson
  (<xref alt="2010" rid="ref-ver2010moving" ref-type="bibr">2010</xref>)
  provide further details regarding additive function values.</p>
  <p>The <monospace>ssn_lm()</monospace> function is designed to be
  similar in syntax and structure to the <monospace>lm()</monospace>
  function in base <bold>R</bold> for fitting nonspatial linear models.
  Additionally, <monospace>SSN2</monospace> accommodates various S3
  methods for commonly-used <bold>R</bold> generic functions that
  operate on model objects. For example, the generic function
  <monospace>summary()</monospace> is used to summarize the fitted
  model:</p>
  <code language="r script">summary(ssn_mod)</code>
  <preformat>## 
## Call:
## ssn_lm(formula = Summer_mn ~ ELEV_DEM + AREAWTMAP, ssn.object = mf04p, 
##     tailup_type = &quot;exponential&quot;, taildown_type = &quot;spherical&quot;, 
##     euclid_type = &quot;gaussian&quot;, additive = &quot;afvArea&quot;)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.6393 -2.0646 -0.5952  0.2143  0.7497 
## 
## Coefficients (fixed):
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) 76.195041   7.871574   9.680  &lt; 2e-16 ***
## ELEV_DEM    -0.026905   0.003646  -7.379  1.6e-13 ***
## AREAWTMAP   -0.009099   0.004461  -2.040   0.0414 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Pseudo R-squared: 0.6124
## 
## Coefficients (covariance):
##               Effect     Parameter   Estimate
##   tailup exponential  de (parsill)  3.800e+00
##   tailup exponential         range  4.194e+06
##   taildown spherical  de (parsill)  4.480e-01
##   taildown spherical         range  1.647e+05
##      euclid gaussian  de (parsill)  1.509e-02
##      euclid gaussian         range  4.496e+03
##               nugget        nugget  2.087e-02</preformat>
  <p><monospace>SSN2</monospace> methods for the
  <monospace>tidy()</monospace>, <monospace>glance()</monospace>, and
  <monospace>augment()</monospace> generic functions from the
  <monospace>broom</monospace> <bold>R</bold> package
  (<xref alt="Robinson, Hayes, &amp; Couch, 2021" rid="ref-robinson2021broom" ref-type="bibr">Robinson,
  Hayes, &amp; Couch, 2021</xref>) are used to inspect the fitted model
  and provide diagnostics:</p>
  <code language="r script">tidy(ssn_mod, conf.int = TRUE)</code>
  <preformat>## # A tibble: 3 x 7
##   term        estimate std.error statistic  p.value conf.low conf.high
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept) 76.2       7.87         9.68 0         60.8    91.6     
## 2 AREAWTMAP   -0.00910   0.00446     -2.04 4.14e- 2  -0.0178 -0.000356
## 3 ELEV_DEM    -0.0269    0.00365     -7.38 1.60e-13  -0.0341 -0.0198</preformat>
  <code language="r script">glance(ssn_mod)</code>
  <preformat>## # A tibble: 1 x 9
##       n     p  npar value   AIC  AICc logLik deviance pseudo.r.squared
##   &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;            &lt;dbl&gt;
## 1    45     3     7  59.3  73.3  76.3  -29.6     41.9            0.612</preformat>
  <code language="r script">aug_mod &lt;- augment(ssn_mod)
subset(aug_mod, select = c(Summer_mn, .fitted, .resid, .hat, .cooksd))</code>
  <preformat>## Simple feature collection with 45 features and 5 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -1530805 ymin: 2527111 xmax: -1503079 ymax: 2537823
## Projected CRS: USA_Contiguous_Albers_Equal_Area_Conic_USGS_version
## # A tibble: 45 x 6
##    Summer_mn .fitted .resid   .hat  .cooksd           geometry
##        &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;        &lt;POINT [m]&gt;
##  1     11.4     14.4  -3.07 0.0915 0.0962   (-1512690 2531883)
##  2     10.7     12.9  -2.20 0.114  0.00471  (-1512852 2531295)
##  3     10.4     12.7  -2.25 0.0372 0.00724  (-1513400 2530706)
##  4     10.1     12.3  -2.18 0.0251 0.00153  (-1514027 2530147)
##  5     10.1     12.3  -2.13 0.0374 0.000583 (-1514309 2529902)
##  6      9.81    12.0  -2.16 0.0602 0.0150   (-1515032 2529461)
##  7      9.76    11.6  -1.85 0.0736 0.00739  (-1515513 2528810)
##  8      9.77    11.6  -1.84 0.0648 0.00687  (-1515588 2528592)
##  9      9.53    11.4  -1.87 0.112  0.00152  (-1516440 2527899)
## 10     12.6     14.9  -2.28 0.0498 0.00964  (-1512464 2531195)
## # i 35 more rows</preformat>
  <p>Specific generic helper functions (e.g.,
  <monospace>coef()</monospace>, <monospace>AIC()</monospace>,
  <monospace>residuals()</monospace>) can be used to obtain the same
  quantities returned by <monospace>tidy()</monospace>,
  <monospace>glance()</monospace>, and
  <monospace>augment()</monospace>:</p>
  <code language="r script">coef(ssn_mod)</code>
  <preformat>## (Intercept)    ELEV_DEM   AREAWTMAP 
## 76.19504087 -0.02690478 -0.00909941</preformat>
  <code language="r script">AIC(ssn_mod)</code>
  <preformat>## [1] 73.2623</preformat>
  <code language="r script">head(residuals(ssn_mod))</code>
  <preformat>##         1         2         3         4         5         6 
## -3.066413 -2.204147 -2.252004 -2.175337 -2.131527 -2.162417</preformat>
  <p>Spatial prediction (i.e., Kriging) at the unobserved sites is
  performed using the generic functions <monospace>predict()</monospace>
  or <monospace>augment()</monospace>:</p>
  <code language="r script">aug_pred &lt;- augment(ssn_mod, newdata = &quot;pred1km&quot;, interval = &quot;prediction&quot;)
subset(aug_pred, select = c(.fitted, .lower, .upper))</code>
  <preformat>## Simple feature collection with 175 features and 3 fields
## Geometry type: POINT
## Dimension:     XY
## Bounding box:  xmin: -1530631 ymin: 2521707 xmax: -1500020 ymax: 2540253
## Projected CRS: USA_Contiguous_Albers_Equal_Area_Conic_USGS_version
## # A tibble: 175 x 4
##    .fitted .lower .upper           geometry
##      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;        &lt;POINT [m]&gt;
##  1    14.6   14.3   15.0 (-1520657 2536657)
##  2    15.0   14.7   15.4 (-1519866 2536812)
##  3    14.8   14.3   15.3 (-1521823 2536911)
##  4    15.0   14.5   15.5 (-1523183 2537256)
##  5    15.2   14.7   15.6 (-1523860 2537452)
##  6    15.1   14.8   15.5 (-1525443 2537698)
##  7    15.1   14.7   15.5 (-1526397 2537254)
##  8    15.0   14.6   15.4 (-1527436 2536803)
##  9    14.9   14.6   15.3 (-1529043 2536449)
## 10    14.9   14.5   15.3 (-1529689 2537313)
## # i 165 more rows</preformat>
  <p>Here, <monospace>.fitted</monospace> are the predictions,
  <monospace>.lower</monospace> are the lower bounds of 95% prediction
  intervals, and <monospace>.upper</monospace> are the upper bounds of
  95% prediction intervals. Utilizing <monospace>augment()</monospace>
  makes the prediction output straightforward to visualize:</p>
  <code language="r script">ggplot() +
    geom_sf(data = mf04p$edges) +
    geom_sf(data = aug_pred, aes(color = .fitted), size = 2) +
    scale_color_viridis_c(name = &quot;Pred.&quot;, option = &quot;H&quot;) +
    theme_bw()</code>
  <fig id="figU003Asteam-preds">
    <caption><p>Predicted Middle Fork 2004 mean summer temperatures
    (Celsius) spaced one kilometer apart. As expected, temperature is
    predicted to be lower in areas of higher elevation.</p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="steam-preds-1.pdf" />
  </fig>
  <p>Spatial generalized linear models for binary, count, proportion,
  and skewed data
  (<xref alt="Ver Hoef et al., 2024" rid="ref-ver2024marginal" ref-type="bibr">Ver
  Hoef et al., 2024</xref>) are applied to stream networks via the
  <monospace>ssn_glm()</monospace> function.
  <monospace>ssn_lm()</monospace> and <monospace>ssn_glm()</monospace>
  also accommodate several advanced features, which include nonspatial
  random effects as in <monospace>lme4</monospace>
  (<xref alt="Bates, Mächler, Bolker, &amp; Walker, 2015" rid="ref-bates2015lme4" ref-type="bibr">Bates,
  Mächler, Bolker, &amp; Walker, 2015</xref>) and
  <monospace>nlme</monospace>
  (<xref alt="Pinheiro &amp; Bates, 2006" rid="ref-pinheiro2006mixed" ref-type="bibr">Pinheiro
  &amp; Bates, 2006</xref>) Euclidean anisotropy
  (<xref alt="Zimmerman &amp; Ver Hoef, 2024" rid="ref-zimmerman2024spatial" ref-type="bibr">Zimmerman
  &amp; Ver Hoef, 2024</xref>), and more. In addition to modeling,
  simulating data on a stream network is performed via
  <monospace>ssn_simulate()</monospace>.</p>
</sec>
<sec id="discussion">
  <title>Discussion</title>
  <p>SSN models are valuable tools for statistical analysis of data
  collected on stream networks and help improve inference about vital
  stream ecosystems. These models have been employed to better
  understand and manage water quality
  (<xref alt="McManus et al., 2020" rid="ref-mcmanus2020variation" ref-type="bibr">McManus
  et al., 2020</xref>;
  <xref alt="Scown, McManus, Carson Jr, &amp; Nietch, 2017" rid="ref-scown2017improving" ref-type="bibr">Scown,
  McManus, Carson Jr, &amp; Nietch, 2017</xref>), ecosystem metabolism
  (<xref alt="Rodrı́guez-Castillo, Estévez, González-Ferreras, &amp; Barquı́n, 2019" rid="ref-rodriguez2019estimating" ref-type="bibr">Rodrı́guez-Castillo,
  Estévez, González-Ferreras, &amp; Barquı́n, 2019</xref>), and climate
  change impacts on freshwater ecosystems
  (<xref alt="Isaak, Wenger, et al., 2017" rid="ref-isaak2017norwest" ref-type="bibr">Isaak,
  Wenger, et al., 2017</xref>;
  <xref alt="Ruesch et al., 2012" rid="ref-ruesch2012projected" ref-type="bibr">Ruesch
  et al., 2012</xref>), as well as generate aquatic population estimates
  (<xref alt="Isaak, Ver Hoef, Peterson, Horan, &amp; Nagel, 2017" rid="ref-isaak2017scalable" ref-type="bibr">Isaak,
  Ver Hoef, Peterson, Horan, &amp; Nagel, 2017</xref>), inform
  conservation planning
  (<xref alt="Rodrı́guez-González et al., 2019" rid="ref-rodriguez2019spatial" ref-type="bibr">Rodrı́guez-González
  et al., 2019</xref>;
  <xref alt="Sharma, Dubey, Johnson, Rawal, &amp; Sivakumar, 2021" rid="ref-sharma2021dendritic" ref-type="bibr">Sharma,
  Dubey, Johnson, Rawal, &amp; Sivakumar, 2021</xref>), and assess
  restoration activities
  (<xref alt="Fuller, Leinenbach, Detenbeck, Labiosa, &amp; Isaak, 2022" rid="ref-fuller2022riparian" ref-type="bibr">Fuller,
  Leinenbach, Detenbeck, Labiosa, &amp; Isaak, 2022</xref>), among other
  applications. The breadth and applicability of SSN models are further
  enhanced by data aggregation tools like the National Hydrography
  Dataset
  (<xref alt="McKay et al., 2012" rid="ref-mckay2012nhdplus" ref-type="bibr">McKay
  et al., 2012</xref>), National Stream Internet Project
  (<xref alt="Nagel, Peterson, Isaak, Ver Hoef, &amp; Horan, 2015" rid="ref-nagel2015national" ref-type="bibr">Nagel,
  Peterson, Isaak, Ver Hoef, &amp; Horan, 2015</xref>), and StreamCat
  (<xref alt="Hill, Weber, Leibowitz, Olsen, &amp; Thornbrugh, 2016" rid="ref-hill2016stream" ref-type="bibr">Hill,
  Weber, Leibowitz, Olsen, &amp; Thornbrugh, 2016</xref>).</p>
  <p>There are several spatial modeling packages in <bold>R</bold>,
  including <monospace>geoR</monospace>
  (<xref alt="Ribeiro Jr et al., 2022" rid="ref-ribiero2022geoR" ref-type="bibr">Ribeiro
  Jr et al., 2022</xref>), <monospace>gstat</monospace>
  (<xref alt="Pebesma, 2004" rid="ref-pebesma2004gstat" ref-type="bibr">Pebesma,
  2004</xref>), <monospace>FRK</monospace>
  (<xref alt="Sainsbury-Dale, Zammit-Mangion, &amp; Cressie, 2024" rid="ref-sainsbury2024modeling" ref-type="bibr">Sainsbury-Dale,
  Zammit-Mangion, &amp; Cressie, 2024</xref>),
  <monospace>fields</monospace>
  (<xref alt="Nychka, Furrer, Paige, &amp; Sain, 2021" rid="ref-nychka2021fields" ref-type="bibr">Nychka,
  Furrer, Paige, &amp; Sain, 2021</xref>), <monospace>R-INLA</monospace>
  (<xref alt="Lindgren &amp; Rue, 2015" rid="ref-lindgren2015bayesian" ref-type="bibr">Lindgren
  &amp; Rue, 2015</xref>), and <monospace>spmodel</monospace>
  (<xref alt="Dumelle, Higham, &amp; Ver Hoef, 2023" rid="ref-dumelle2023spmodel" ref-type="bibr">Dumelle,
  Higham, &amp; Ver Hoef, 2023</xref>), among others. However, these
  aforementioned spatial modeling packages do not account for the unique
  spatial relationships found in data collected on stream networks. The
  <monospace>rtop</monospace>
  (<xref alt="Skoien et al., 2014" rid="ref-skoien2014rtop" ref-type="bibr">Skoien
  et al., 2014</xref>), <monospace>VAST</monospace>
  (<xref alt="Charsley et al., 2023" rid="ref-charsley2023catchment" ref-type="bibr">Charsley
  et al., 2023</xref>), and <monospace>SSN2</monospace> <bold>R</bold>
  packages can be used to describe spatial stream network data in
  <bold>R</bold>, but <monospace>SSN2</monospace> is unique. It not only
  provides representations of stream network data in <bold>R</bold> but
  also provides an extensive suite of functions for model fitting,
  diagnostics, and spatial prediction that integrate with the popular
  “tidy” framework
  (<xref alt="Kuhn &amp; Silge, 2022" rid="ref-kuhn2022tidy" ref-type="bibr">Kuhn
  &amp; Silge, 2022</xref>;
  <xref alt="Wickham et al., 2019" rid="ref-wickham2019welcome" ref-type="bibr">Wickham
  et al., 2019</xref>). To learn more about <monospace>SSN2</monospace>,
  visit the CRAN webpage at
  <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=SSN2">https://CRAN.R-project.org/package=SSN2</ext-link>.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>Figures were created using <monospace>ggplot2</monospace>
  (<xref alt="Wickham, 2016" rid="ref-wickham2016ggplot2" ref-type="bibr">Wickham,
  2016</xref>) and the <monospace>viridis</monospace> color palettes
  (<xref alt="Garnier et al., 2024" rid="ref-garnier2024viridis" ref-type="bibr">Garnier
  et al., 2024</xref>).</p>
  <p>We would like to sincerely thank the editor and reviewers for all
  of their helpful feedback which greatly improved both the software and
  the manuscript.</p>
  <p>The views expressed in this manuscript are those of the authors and
  do not necessarily represent the views or policies of USEPA, NOAA, or
  USFS. Any mention of trade names, products, or services does not imply
  an endorsement by the U.S. government, USEPA, NOAA, or USFS. USEPA,
  NOAA, or USFS do not endorse any commercial products, services or
  enterprises.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-bivand2013applied">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Bivand</surname><given-names>Roger</given-names></name>
        <name><surname>Pebesma</surname><given-names>Edzer</given-names></name>
        <name><surname>Gómez-Rubio</surname><given-names>Virgilio</given-names></name>
      </person-group>
      <source>Applied spatial data analysis with R</source>
      <publisher-name>Springer, NY</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <uri>https://asdar-book.org/</uri>
      <pub-id pub-id-type="doi">10.1007/978-1-4614-7618-4</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-bates2015lme4">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bates</surname><given-names>Douglas</given-names></name>
        <name><surname>Mächler</surname><given-names>Martin</given-names></name>
        <name><surname>Bolker</surname><given-names>Ben</given-names></name>
        <name><surname>Walker</surname><given-names>Steve</given-names></name>
      </person-group>
      <article-title>Fitting linear mixed-effects models using lme4</article-title>
      <source>Journal of Statistical Software</source>
      <year iso-8601-date="2015">2015</year>
      <volume>67</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.18637/jss.v067.i01</pub-id>
      <fpage>1</fpage>
      <lpage>48</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bivand2020rgeos">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Bivand</surname><given-names>Roger</given-names></name>
        <name><surname>Rundel</surname><given-names>Colin</given-names></name>
      </person-group>
      <source>rgeos: Interface to geometry engine - open source (’GEOS’)</source>
      <year iso-8601-date="2020">2020</year>
      <uri>https://CRAN.R-project.org/package=rgeos</uri>
    </element-citation>
  </ref>
  <ref id="ref-bivand2021maptools">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Bivand</surname><given-names>Roger</given-names></name>
        <name><surname>Lewin-Koh</surname><given-names>Nicholas</given-names></name>
      </person-group>
      <source>maptools: Tools for handling spatial objects</source>
      <year iso-8601-date="2021">2021</year>
      <uri>https://CRAN.R-project.org/package=maptools</uri>
    </element-citation>
  </ref>
  <ref id="ref-bivand2021rgdal">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Bivand</surname><given-names>Roger</given-names></name>
        <name><surname>Keitt</surname><given-names>Tim</given-names></name>
        <name><surname>Rowlingson</surname><given-names>Barry</given-names></name>
      </person-group>
      <source>rgdal: Bindings for the ’geospatial’ data abstraction library</source>
      <year iso-8601-date="2021">2021</year>
      <uri>https://CRAN.R-project.org/package=rgdal</uri>
    </element-citation>
  </ref>
  <ref id="ref-charsley2023catchment">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Charsley</surname><given-names>Anthony R</given-names></name>
        <name><surname>Grüss</surname><given-names>Arnaud</given-names></name>
        <name><surname>Thorson</surname><given-names>James T</given-names></name>
        <name><surname>Rudd</surname><given-names>Merrill B</given-names></name>
        <name><surname>Crow</surname><given-names>Shannan K</given-names></name>
        <name><surname>David</surname><given-names>Bruno</given-names></name>
        <name><surname>Williams</surname><given-names>Erica K</given-names></name>
        <name><surname>Hoyle</surname><given-names>Simon D</given-names></name>
      </person-group>
      <article-title>Catchment-scale stream network spatio-temporal models, applied to the freshwater stages of a diadromous fish species, longfin eel (Anguilla dieffenbachii)</article-title>
      <source>Fisheries Research</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>259</volume>
      <pub-id pub-id-type="doi">10.1016/j.fishres.2022.106583</pub-id>
      <fpage>106583</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-cressie1993statistics">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Cressie</surname><given-names>Noel</given-names></name>
      </person-group>
      <source>Statistics for spatial data (revised edition)</source>
      <publisher-name>Wiley: Hoboken, NJ</publisher-name>
      <year iso-8601-date="1993">1993</year>
      <pub-id pub-id-type="doi">10.1002/9781119115151</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-dumelle2023spmodel">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dumelle</surname><given-names>Michael</given-names></name>
        <name><surname>Higham</surname><given-names>Matt</given-names></name>
        <name><surname>Ver Hoef</surname><given-names>Jay M.</given-names></name>
      </person-group>
      <article-title>spmodel: Spatial statistical modeling and prediction in R</article-title>
      <source>PLOS ONE</source>
      <year iso-8601-date="2023">2023</year>
      <volume>18</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1371/journal.pone.0282524</pub-id>
      <fpage>1</fpage>
      <lpage>32</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fuller2022riparian">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fuller</surname><given-names>Matthew R</given-names></name>
        <name><surname>Leinenbach</surname><given-names>Peter</given-names></name>
        <name><surname>Detenbeck</surname><given-names>Naomi E</given-names></name>
        <name><surname>Labiosa</surname><given-names>Rochelle</given-names></name>
        <name><surname>Isaak</surname><given-names>Daniel J</given-names></name>
      </person-group>
      <article-title>Riparian vegetation shade restoration and loss effects on recent and future stream temperatures</article-title>
      <source>Restoration Ecology</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>30</volume>
      <issue>7</issue>
      <pub-id pub-id-type="doi">10.1111/rec.13626</pub-id>
      <fpage>e13626</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-garnier2024viridis">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>Garnier</string-name>
        <string-name>Simon</string-name>
        <string-name>Ross</string-name>
        <string-name>Noam</string-name>
        <string-name>Rudis</string-name>
        <string-name>Robert</string-name>
        <string-name>Camargo</string-name>
        <name><surname>Pedro</surname><given-names>Antônio</given-names></name>
        <string-name>Sciaini</string-name>
        <string-name>Marco</string-name>
        <string-name>Scherer</string-name>
        <string-name>Cédric</string-name>
      </person-group>
      <source>viridis(Lite) - colorblind-friendly color maps for R</source>
      <year iso-8601-date="2024">2024</year>
      <uri>https://sjmgarnier.github.io/viridis/</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.4679423</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-hill2016stream">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hill</surname><given-names>Ryan A</given-names></name>
        <name><surname>Weber</surname><given-names>Marc H</given-names></name>
        <name><surname>Leibowitz</surname><given-names>Scott G</given-names></name>
        <name><surname>Olsen</surname><given-names>Anthony R</given-names></name>
        <name><surname>Thornbrugh</surname><given-names>Darren J</given-names></name>
      </person-group>
      <article-title>The stream-catchment (StreamCat) dataset: A database of watershed metrics for the conterminous United States</article-title>
      <source>JAWRA Journal of the American Water Resources Association</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>52</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1111/1752-1688.12372</pub-id>
      <fpage>120</fpage>
      <lpage>128</lpage>
    </element-citation>
  </ref>
  <ref id="ref-isaak2017norwest">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Isaak</surname><given-names>Daniel J</given-names></name>
        <name><surname>Wenger</surname><given-names>Seth J</given-names></name>
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
        <name><surname>Nagel</surname><given-names>David E</given-names></name>
        <name><surname>Luce</surname><given-names>Charles H</given-names></name>
        <name><surname>Hostetler</surname><given-names>Steven W</given-names></name>
        <name><surname>Dunham</surname><given-names>Jason B</given-names></name>
        <name><surname>Roper</surname><given-names>Brett B</given-names></name>
        <name><surname>Wollrab</surname><given-names>Sherry P</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>The NorWeST summer stream temperature model and scenarios for the western US: A crowd-sourced database and new geospatial tools foster a user community and predict broad climate warming of rivers and streams</article-title>
      <source>Water Resources Research</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>53</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.1002/2017WR020969</pub-id>
      <fpage>9181</fpage>
      <lpage>9205</lpage>
    </element-citation>
  </ref>
  <ref id="ref-isaak2017scalable">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Isaak</surname><given-names>Daniel J</given-names></name>
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
        <name><surname>Horan</surname><given-names>Dona L</given-names></name>
        <name><surname>Nagel</surname><given-names>David E</given-names></name>
      </person-group>
      <article-title>Scalable population estimates using spatial-stream-network (SSN) models, fish density surveys, and national geospatial database frameworks for streams</article-title>
      <source>Canadian Journal of Fisheries and Aquatic Sciences</source>
      <publisher-name>NRC Research Press</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>74</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1139/cjfas-2016-0247</pub-id>
      <fpage>147</fpage>
      <lpage>156</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kattwinkel2020preparing">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kattwinkel</surname><given-names>Mira</given-names></name>
        <name><surname>Szöcs</surname><given-names>Eduard</given-names></name>
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
        <name><surname>Schäfer</surname><given-names>Ralf B</given-names></name>
      </person-group>
      <article-title>Preparing GIS data for analysis of stream monitoring data: The R package openSTARS</article-title>
      <source>PLOS ONE</source>
      <publisher-name>Public Library of Science San Francisco, CA USA</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>15</volume>
      <issue>9</issue>
      <pub-id pub-id-type="doi">10.1371/journal.pone.0239237</pub-id>
      <fpage>e0239237</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-kuhn2022tidy">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Kuhn</surname><given-names>Max</given-names></name>
        <name><surname>Silge</surname><given-names>Julia</given-names></name>
      </person-group>
      <source>Tidy modeling with R</source>
      <publisher-name>O’Reilly Media, Inc.</publisher-name>
      <year iso-8601-date="2022">2022</year>
    </element-citation>
  </ref>
  <ref id="ref-lindgren2015bayesian">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lindgren</surname><given-names>Finn</given-names></name>
        <name><surname>Rue</surname><given-names>Håvard</given-names></name>
      </person-group>
      <article-title>Bayesian spatial modelling with R-INLA</article-title>
      <source>Journal of Statistical Software</source>
      <publisher-name>University of California at Los Angeles</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>63</volume>
      <issue>19</issue>
      <pub-id pub-id-type="doi">10.18637/jss.v063.i19</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-mckay2012nhdplus">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>McKay</surname><given-names>L.</given-names></name>
        <name><surname>Bondelid</surname><given-names>T.</given-names></name>
        <name><surname>Dewald</surname><given-names>T.</given-names></name>
        <name><surname>Johnston</surname><given-names>J.</given-names></name>
        <name><surname>Moore</surname><given-names>R.</given-names></name>
        <name><surname>Reah</surname><given-names>A.</given-names></name>
      </person-group>
      <source>NHDPlus version 2: User guide</source>
      <year iso-8601-date="2012">2012</year>
      <uri>http://www.horizon-systems.com/NHDPlus/NHDPlusV2_home.php</uri>
    </element-citation>
  </ref>
  <ref id="ref-mcmanus2020variation">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>McManus</surname><given-names>Michael G</given-names></name>
        <name><surname>D’Amico</surname><given-names>Ellen</given-names></name>
        <name><surname>Smith</surname><given-names>Elizabeth M</given-names></name>
        <name><surname>Polinsky</surname><given-names>Robyn</given-names></name>
        <name><surname>Ackerman</surname><given-names>Jerry</given-names></name>
        <name><surname>Tyler</surname><given-names>Kip</given-names></name>
      </person-group>
      <article-title>Variation in stream network relationships and geospatial predictions of watershed conductivity</article-title>
      <source>Freshwater Science</source>
      <publisher-name>The University of Chicago Press Chicago, IL</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>39</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1086/710340</pub-id>
      <fpage>704</fpage>
      <lpage>721</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nagel2015national">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nagel</surname><given-names>David</given-names></name>
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
        <name><surname>Isaak</surname><given-names>Daniel J</given-names></name>
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
        <name><surname>Horan</surname><given-names>Dona</given-names></name>
      </person-group>
      <article-title>National stream internet protocol and user guide</article-title>
      <source>US Forest Service, Rocky Mountain Research Station Air, Water, and Aquatic Environments Program</source>
      <year iso-8601-date="2015">2015</year>
      <uri>https://research.fs.usda.gov/sites/default/files/2023-03/rmrs-nationalstreaminternetprotocolanduserguide.pdf</uri>
    </element-citation>
  </ref>
  <ref id="ref-nowosad2023">
    <element-citation publication-type="webpage">
      <person-group person-group-type="author">
        <name><surname>Nowosad</surname><given-names>Jakub</given-names></name>
      </person-group>
      <article-title>Upcoming Changes to Popular R Packages for Spatial Data: What You Need to Do</article-title>
      <year iso-8601-date="2023-06-04">2023</year><month>06</month><day>04</day>
      <uri>https://geocompx.org//post/2023/rgdal-retirement</uri>
    </element-citation>
  </ref>
  <ref id="ref-nychka2021fields">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Nychka</surname><given-names>Douglas</given-names></name>
        <name><surname>Furrer</surname><given-names>Reinhard</given-names></name>
        <name><surname>Paige</surname><given-names>John</given-names></name>
        <name><surname>Sain</surname><given-names>Stephan</given-names></name>
      </person-group>
      <article-title>fields: Tools for spatial data</article-title>
      <publisher-name>University Corporation for Atmospheric Research</publisher-name>
      <publisher-loc>Boulder, CO, USA</publisher-loc>
      <year iso-8601-date="2021">2021</year>
      <uri>https://github.com/dnychka/fieldsRPackage</uri>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.fields</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-pebesma2004gstat">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pebesma</surname><given-names>Edzer</given-names></name>
      </person-group>
      <article-title>Multivariable geostatistics in S: The gstat package</article-title>
      <source>Computers &amp; Geosciences</source>
      <year iso-8601-date="2004">2004</year>
      <volume>30</volume>
      <pub-id pub-id-type="doi">10.1016/j.cageo.2004.03.012</pub-id>
      <fpage>683</fpage>
      <lpage>691</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pebesma2018sf">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pebesma</surname><given-names>Edzer</given-names></name>
      </person-group>
      <article-title>Simple Features for R: Standardized Support for Spatial Vector Data</article-title>
      <source>The R Journal</source>
      <year iso-8601-date="2018">2018</year>
      <volume>10</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.32614/RJ-2018-009</uri>
      <pub-id pub-id-type="doi">10.32614/RJ-2018-009</pub-id>
      <fpage>439</fpage>
      <lpage>446</lpage>
    </element-citation>
  </ref>
  <ref id="ref-peterson2010mixed">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
      </person-group>
      <article-title>A mixed-model moving-average approach to geostatistical modeling in stream networks</article-title>
      <source>Ecology</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>91</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1890/08-1668.1</pub-id>
      <fpage>644</fpage>
      <lpage>651</lpage>
    </element-citation>
  </ref>
  <ref id="ref-peterson2014stars">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
      </person-group>
      <article-title>STARS: An ArcGIS toolset used to calculate the spatial information needed to fit spatial statistical models to stream network data</article-title>
      <source>Journal of Statistical Software</source>
      <year iso-8601-date="2014">2014</year>
      <volume>56</volume>
      <pub-id pub-id-type="doi">10.18637/jss.v056.i02</pub-id>
      <fpage>1</fpage>
      <lpage>17</lpage>
    </element-citation>
  </ref>
  <ref id="ref-peterson2024SSNbler">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
        <name><surname>Dumelle</surname><given-names>Michael</given-names></name>
        <name><surname>Pearse</surname><given-names>Alan</given-names></name>
        <name><surname>Teleki</surname><given-names>Dan</given-names></name>
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
      </person-group>
      <source>SSNbler: Assemble SSN objects in R</source>
      <year iso-8601-date="2024">2024</year>
      <uri>https://github.com/pet221/SSNbler</uri>
    </element-citation>
  </ref>
  <ref id="ref-pinheiro2006mixed">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Pinheiro</surname><given-names>José</given-names></name>
        <name><surname>Bates</surname><given-names>Douglas</given-names></name>
      </person-group>
      <source>Mixed-effects models in S and S-PLUS</source>
      <publisher-name>Springer Science &amp; Business Media: New York, NY</publisher-name>
      <year iso-8601-date="2006">2006</year>
    </element-citation>
  </ref>
  <ref id="ref-ruesch2012projected">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ruesch</surname><given-names>Aaron S</given-names></name>
        <name><surname>Torgersen</surname><given-names>Christian E</given-names></name>
        <name><surname>Lawler</surname><given-names>Joshua J</given-names></name>
        <name><surname>Olden</surname><given-names>Julian D</given-names></name>
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
        <name><surname>Volk</surname><given-names>Carol J</given-names></name>
        <name><surname>Lawrence</surname><given-names>David J</given-names></name>
      </person-group>
      <article-title>Projected climate-induced habitat loss for salmonids in the John Day River Network, Oregon, USA</article-title>
      <source>Conservation Biology</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2012">2012</year>
      <volume>26</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.1111/j.1523-1739.2012.01897.x</pub-id>
      <fpage>873</fpage>
      <lpage>882</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ribiero2022geoR">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Ribeiro Jr</surname><given-names>Paulo Justiniano</given-names></name>
        <name><surname>Diggle</surname><given-names>Peter</given-names></name>
        <name><surname>Christensen</surname><given-names>Ole</given-names></name>
        <name><surname>Schlather</surname><given-names>Martin</given-names></name>
        <name><surname>Bivand</surname><given-names>Roger</given-names></name>
        <name><surname>Ripley</surname><given-names>Brian</given-names></name>
      </person-group>
      <source>geoR: Analysis of geostatistical data</source>
      <year iso-8601-date="2022">2022</year>
      <uri>https://CRAN.R-project.org/package=geoR</uri>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.geoR</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-rodriguez2019spatial">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rodrı́guez-González</surname><given-names>Patricia Marı́a</given-names></name>
        <name><surname>Garcı́a</surname><given-names>Cristina</given-names></name>
        <name><surname>Albuquerque</surname><given-names>António</given-names></name>
        <name><surname>Monteiro-Henriques</surname><given-names>Tiago</given-names></name>
        <name><surname>Faria</surname><given-names>Carla</given-names></name>
        <name><surname>Guimarães</surname><given-names>Joana B</given-names></name>
        <name><surname>Mendonça</surname><given-names>Diogo</given-names></name>
        <name><surname>Simões</surname><given-names>Fernanda</given-names></name>
        <name><surname>Ferreira</surname><given-names>Maria Teresa</given-names></name>
        <name><surname>Mendes</surname><given-names>Ana</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>A spatial stream-network approach assists in managing the remnant genetic diversity of riparian forests</article-title>
      <source>Scientific Reports</source>
      <publisher-name>Nature Publishing Group UK London</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>9</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1038/s41598-019-43132-7</pub-id>
      <fpage>6741</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-rodriguez2019estimating">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rodrı́guez-Castillo</surname><given-names>Tamara</given-names></name>
        <name><surname>Estévez</surname><given-names>Edurne</given-names></name>
        <name><surname>González-Ferreras</surname><given-names>Alexia Marı́a</given-names></name>
        <name><surname>Barquı́n</surname><given-names>José</given-names></name>
      </person-group>
      <article-title>Estimating ecosystem metabolism to entire river networks</article-title>
      <source>Ecosystems</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>22</volume>
      <pub-id pub-id-type="doi">10.1007/s10021-018-0311-8</pub-id>
      <fpage>892</fpage>
      <lpage>911</lpage>
    </element-citation>
  </ref>
  <ref id="ref-robinson2021broom">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Robinson</surname><given-names>David</given-names></name>
        <name><surname>Hayes</surname><given-names>Alex</given-names></name>
        <name><surname>Couch</surname><given-names>Simon</given-names></name>
      </person-group>
      <source>broom: Convert statistical objects into tidy tibbles</source>
      <year iso-8601-date="2021">2021</year>
      <uri>https://CRAN.R-project.org/package=broom</uri>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.broom</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-sainsbury2024modeling">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sainsbury-Dale</surname><given-names>Matthew</given-names></name>
        <name><surname>Zammit-Mangion</surname><given-names>Andrew</given-names></name>
        <name><surname>Cressie</surname><given-names>Noel</given-names></name>
      </person-group>
      <article-title>Modeling big, heterogeneous, non-gaussian spatial and spatio-temporal data using FRK</article-title>
      <source>Journal of Statistical Software</source>
      <year iso-8601-date="2024">2024</year>
      <volume>108</volume>
      <pub-id pub-id-type="doi">10.18637/jss.v108.i10</pub-id>
      <fpage>1</fpage>
      <lpage>39</lpage>
    </element-citation>
  </ref>
  <ref id="ref-scown2017improving">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Scown</surname><given-names>Murray W</given-names></name>
        <name><surname>McManus</surname><given-names>Michael G</given-names></name>
        <name><surname>Carson Jr</surname><given-names>John H</given-names></name>
        <name><surname>Nietch</surname><given-names>Christopher T</given-names></name>
      </person-group>
      <article-title>Improving predictive models of in-stream phosphorus concentration based on nationally-available spatial data coverages</article-title>
      <source>Journal of the American Water Resources Association</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>53</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1111/1752-1688.12543</pub-id>
      <fpage>944</fpage>
      <lpage>960</lpage>
    </element-citation>
  </ref>
  <ref id="ref-sharma2021dendritic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sharma</surname><given-names>Aashna</given-names></name>
        <name><surname>Dubey</surname><given-names>Vineet K</given-names></name>
        <name><surname>Johnson</surname><given-names>Jeyaraj A</given-names></name>
        <name><surname>Rawal</surname><given-names>Yogesh K</given-names></name>
        <name><surname>Sivakumar</surname><given-names>Kuppusamy</given-names></name>
      </person-group>
      <article-title>Dendritic prioritization through spatial stream network modeling informs targeted management of Himalayan riverscapes under brown trout invasion</article-title>
      <source>Journal of Applied Ecology</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>58</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.1111/1365-2664.13997</pub-id>
      <fpage>2415</fpage>
      <lpage>2426</lpage>
    </element-citation>
  </ref>
  <ref id="ref-skoien2014rtop">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Skoien</surname><given-names>J. O.</given-names></name>
        <string-name>G. Bloschl</string-name>
        <string-name>G. Laaha</string-name>
        <string-name>E. Pebesma</string-name>
        <string-name>J. Parajka</string-name>
        <string-name>A. Viglione</string-name>
      </person-group>
      <article-title>rtop: An R package for interpolation of data with a variable spatial support, with an example from river networks</article-title>
      <source>Computers &amp; Geosciences</source>
      <year iso-8601-date="2014">2014</year>
      <pub-id pub-id-type="doi">10.1016/j.cageo.2014.02.009</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-ver2010moving">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
      </person-group>
      <article-title>A moving average approach for spatial statistical models of stream networks</article-title>
      <source>Journal of the American Statistical Association</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>105</volume>
      <issue>489</issue>
      <pub-id pub-id-type="doi">10.1198/jasa.2009.ap08248</pub-id>
      <fpage>6</fpage>
      <lpage>18</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ver2014ssn">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
        <name><surname>Peterson</surname><given-names>Erin E</given-names></name>
        <name><surname>Clifford</surname><given-names>David</given-names></name>
        <name><surname>Shah</surname><given-names>Rohan</given-names></name>
      </person-group>
      <article-title>SSN: An R package for spatial statistical modeling on stream networks</article-title>
      <source>Journal of Statistical Software</source>
      <year iso-8601-date="2014">2014</year>
      <volume>56</volume>
      <pub-id pub-id-type="doi">10.18637/jss.v056.i03</pub-id>
      <fpage>1</fpage>
      <lpage>45</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ver2024marginal">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
        <name><surname>Blagg</surname><given-names>Eryn</given-names></name>
        <name><surname>Dumelle</surname><given-names>Michael</given-names></name>
        <name><surname>Dixon</surname><given-names>Phillip M</given-names></name>
        <name><surname>Zimmerman</surname><given-names>Dale L</given-names></name>
        <name><surname>Conn</surname><given-names>Paul B</given-names></name>
      </person-group>
      <article-title>Marginal inference for hierarchical generalized linear mixed models with patterned covariance matrices using the laplace approximation</article-title>
      <source>Environmetrics</source>
      <year iso-8601-date="2024">2024</year>
      <pub-id pub-id-type="doi">10.1002/env.2872</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-wickham2016ggplot2">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Wickham</surname><given-names>Hadley</given-names></name>
      </person-group>
      <source>ggplot2: Elegant graphics for data analysis</source>
      <publisher-name>Springer-Verlag New York</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <isbn>978-3-319-24277-4</isbn>
      <uri>https://ggplot2.tidyverse.org</uri>
      <pub-id pub-id-type="doi">10.1007/978-0-387-98141-3</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-wickham2019welcome">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wickham</surname><given-names>Hadley</given-names></name>
        <name><surname>Averick</surname><given-names>Mara</given-names></name>
        <name><surname>Bryan</surname><given-names>Jennifer</given-names></name>
        <name><surname>Chang</surname><given-names>Winston</given-names></name>
        <name><surname>McGowan</surname><given-names>Lucy D’Agostino</given-names></name>
        <name><surname>François</surname><given-names>Romain</given-names></name>
        <name><surname>Grolemund</surname><given-names>Garrett</given-names></name>
        <name><surname>Hayes</surname><given-names>Alex</given-names></name>
        <name><surname>Henry</surname><given-names>Lionel</given-names></name>
        <name><surname>Hester</surname><given-names>Jim</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Welcome to the Tidyverse</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>43</issue>
      <pub-id pub-id-type="doi">10.21105/joss.01686</pub-id>
      <fpage>1686</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-zimmerman2024spatial">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Zimmerman</surname><given-names>Dale L</given-names></name>
        <name><surname>Ver Hoef</surname><given-names>Jay M</given-names></name>
      </person-group>
      <source>Spatial linear models for environmental data</source>
      <publisher-name>CRC Press</publisher-name>
      <year iso-8601-date="2024">2024</year>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
