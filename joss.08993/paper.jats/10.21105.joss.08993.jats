<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8993</article-id>
<article-id pub-id-type="doi">10.21105/joss.08993</article-id>
<title-group>
<article-title>MeDUSA: Taming your metabolic datasets using an R-package
for data processing of Direct Infusion Untarged Single-cell
Analysis</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6922-9423</contrib-id>
<name>
<surname>Castaneda</surname>
<given-names>Laura Ann</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Hetzel</surname>
<given-names>Eric</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2157-4399</contrib-id>
<name>
<surname>Ali</surname>
<given-names>Ahmed</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Leiden University, Leiden, Netherlands</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Independent Researcher, Netherlands</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-06-04">
<day>4</day>
<month>6</month>
<year>2024</year>
</pub-date>
<volume>11</volume>
<issue>118</issue>
<fpage>8993</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2026</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>Single-Cell Metabalomics</kwd>
<kwd>Mass Spectrometry</kwd>
<kwd>Metabolomics</kwd>
<kwd>Data Analytics</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Over ten trillion cells are hard at work in the human body
  (<xref alt="Bianconi, 2013" rid="ref-BU003A2013" ref-type="bibr">Bianconi,
  2013</xref>) and there can be significant heterogeneity among them
  affecting biological development, disease progression, and treatment
  response
  (<xref alt="Zhang &amp; Vertes, 2018" rid="ref-ZVU003A2018" ref-type="bibr">Zhang
  &amp; Vertes, 2018</xref>).</p>
  <p>One technique to categorize this heterogeneity is single-cell
  analysis using mass spectrometry. However this technique introduces
  new challenges. One of these is the small sample volume, which limits
  the possibilities for separation and thus makes the data
  non-compatible with traditional analysis pipelines. We introduce the R
  package <monospace>MeDUSA</monospace> for Metabolomic Direct-infusion
  Untargeted Single-cell Analysis.</p>
  <p><monospace>MeDUSA</monospace> is a start-to-finish analysis package
  allowing metabolomics researchers to focus on analytical content
  rather than R proficiency. <monospace>MeDUSA</monospace> handles the
  suggested workflow by Southam
  (<xref alt="Southam et al., 2017" rid="ref-SWEJVU003A2017" ref-type="bibr">Southam
  et al., 2017</xref>) from data extraction to filtering without a
  chromatogram, carrying the data through statistical analysis and
  identification of features for biological interpretation.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Due to the small volume of a single cell, direct infusion (DI),
  nano-electrospray ionization (nESI) is a highly suitable technique.
  However liquid chromatography mass spectrometry (LC-MS) is
  significantly more common than DI mass spectrometry, therefore most
  software is being developed for separation chromatography. For
  instance, XCMS offers filtering and statistical analysis with
  visualization; however, all of the filtering is reliant on the
  presence of a chromatogram
  (<xref alt="Smith et al., 2006" rid="ref-SWOSU003A2006" ref-type="bibr">Smith
  et al., 2006</xref>). Similarly, MetaboAnalyst has an impressive
  interface that allows for metabolomic pathway analysis, but the full
  potential is only unlocked with a chromatogram
  (<xref alt="Pang, 2021" rid="ref-PU003A2021" ref-type="bibr">Pang,
  2021</xref>). Even paid software such as Thermo Fisher Scientific’s
  Compound Discoverer is designed to align and filter peaks based on a
  chromatogram
  (<xref alt="Cooper &amp; Yang, 2024" rid="ref-CYU003A2024" ref-type="bibr">Cooper
  &amp; Yang, 2024</xref>). Furthermore, the mentioned software does not
  allow the user to define preprocessing methods such as centroiding or
  alignment. In contrast, the modularity of
  <monospace>MeDUSA</monospace> is built specifically for direct
  infusion data, and it lays the framework for method specification. The
  modularity also offers the user the ability to bypass functions,
  introduce external functions to filter, and process the data as they
  see fit, an option that other software does not offer. Currently, if
  researchers want this level of modularity and customization designed
  for single cell data, they must write their own scripts, which
  requires proficiency in a programming language and a significant time
  allotment. Therefore the metabolomic community needs a software option
  that will enable complete, modular, and customizable processing of
  mass spectra without a chromatogram.</p>
</sec>
<sec id="description">
  <title>Description</title>
  <p>The goal of <monospace>MeDUSA</monospace> is to provide a toolset
  that is modular, customizable, and user-friendly. There are five major
  sections along this standard flow as shown in
  <xref alt="[fig:summary]" rid="figU003Asummary">[fig:summary]</xref>.</p>
  <p>Modularity is achieved by using standardized interoperable data
  objects. This allows the user to choose any collection and order of
  functions that they see fit. See the README for a list and description
  of the standard objects
  (https://github.com/laura-hetzel/MeDUSA#data-structures).</p>
  <p>Customization is achieved by being greatly parameterized and
  leveraging modularity. This allows the user to dial in their
  variables, such as thresholds, aggregation methods, tolerances, etc.
  The user may also interrupt the suggested flow to perform any custom
  logic according to their needs, and reintroduce their updated data
  into the <monospace>MeDUSA</monospace> flow, so long as the data
  structure is maintained. The three primary data objects have the same
  structure and are differentiated by name for human readability along
  the suggested flow. However, they are technically interchangeable,
  thus increasing customization.</p>
  <p>User-friendliness is achieved with “magic” functions, readability,
  and containerization. The magic functions leverage suggested parameter
  values and simplify many functions within each of the five major
  sections. These methods can allow a user to go from mzML files to a
  list of compounds in few commands.
  <xref alt="[fig:detailed]" rid="figU003Adetailed">[fig:detailed]</xref>
  illustrates a detailed list of functions, and how the magic functions
  simplify them. To ease readability, files and methods are prepended
  with the expected input data-object type. This naming convention helps
  users identify what methods are available to them at different stages
  of the suggested flow. Containerization manages dependencies and
  provides HMDB and lipid data for convenient m/z to compound
  mapping.</p>
  <fig>
    <caption><p>Map of the five sections of MeDUSA and the capabilities
    of each section. The bold arrows indicate a suggested workflow. The
    dashed arrows indicate references. The circled text indicated the
    object data type. The plot symbol indicates the function may output
    a
    plot.<styled-content id="figU003Asummary"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="medusa-medusa.png" />
  </fig>
  <fig>
    <caption><p>Detailed suggested flow and function map. Note the
    “magic” functions that aggregate similar functions for user ease.
    The bold arrows indicate a suggested workflow. The circled text
    indicated the object data type. The plot symbol indicates the
    function may output a plot.
    <styled-content id="figU003Adetailed"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="medusa-medusa_detailed.png" />
  </fig>
</sec>
<sec id="research-projects-using-the-software">
  <title>Research projects using the software</title>
  <p>Current research projects relating to single-cell metabolic
  profiling of the cell cycle of FUCCI cells, stem-cell differentiation,
  hypoxic organoids, and metastatic organoids would benefit from this
  package. The projects currently use two different commercially
  available software as well as R scripts that lack robustness for the
  data analysis; shifting the analysis to MeDUSA will enable timely and
  reliable results. Upon the release of the package, it will be
  implemented lab-wide for live single-cell metabolomics.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This research was funded in part by the European Union’s Horizon
  2020 research and innovation program under the Marie Skladowska-Curie
  grant agreement number 861196.</p>
  <p>Rosa (species = Canis Familiaris, breed = Catahoula Leopard) was
  essential to the mental well-being and creativity of the authors, and
  therefore essential to the project.</p>
  <p>We would like to thank Alida Kindt and Thomas Hankemeier for their
  support and direction on this project.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-BU003A2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bianconi</surname><given-names>E. et al.</given-names></name>
      </person-group>
      <article-title>An estimation of the number of cells in the human body.</article-title>
      <source>Ann. Hum. Biol.</source>
      <year iso-8601-date="2013">2013</year>
      <volume>40</volume>
      <pub-id pub-id-type="doi">10.3109/03014460.2013.807878</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-ZVU003A2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhang</surname><given-names>L.</given-names></name>
        <name><surname>Vertes</surname><given-names>A.</given-names></name>
      </person-group>
      <article-title>Single-cell mass spectrometry approaches to explore cellular heterogeneity.</article-title>
      <source>Angew. Chem. Int.</source>
      <year iso-8601-date="2018">2018</year>
      <volume>57</volume>
      <pub-id pub-id-type="doi">10.1002/anie.201709719</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-SWEJVU003A2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Southam</surname><given-names>A. D.</given-names></name>
        <name><surname>Weber</surname><given-names>R. J. M.</given-names></name>
        <name><surname>Engel</surname><given-names>J.</given-names></name>
        <name><surname>Jones</surname><given-names>M. R.</given-names></name>
        <name><surname>Viant</surname><given-names>M. R.</given-names></name>
      </person-group>
      <article-title>A complete workflow for high-resolution spectral-stitching nanoelectrospray direct-infusion mass-spectrometry-based metabolomics and lipidomics.</article-title>
      <source>Nat. Protoc.</source>
      <year iso-8601-date="2017">2017</year>
      <volume>12</volume>
      <pub-id pub-id-type="doi">10.1038/nprot.2016.156</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-SWOSU003A2006">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Smith</surname><given-names>C. A.</given-names></name>
        <name><surname>Want</surname><given-names>E. J.</given-names></name>
        <name><surname>O’Maille</surname><given-names>G.</given-names></name>
        <name><surname>Siuzdak</surname><given-names>G.</given-names></name>
      </person-group>
      <article-title>XCMS: Processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
      <source>Anal. Chem.</source>
      <year iso-8601-date="2006">2006</year>
      <volume>78</volume>
      <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-PU003A2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pang</surname><given-names>Z. et al.</given-names></name>
      </person-group>
      <article-title>MetaboAnalyst 5.0: narrowing the gap between raw spectra and functional insights.</article-title>
      <source>Nucleic Acids Res.</source>
      <year iso-8601-date="2021">2021</year>
      <volume>49</volume>
      <pub-id pub-id-type="doi">10.1093/nar/gkab382</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-CYU003A2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cooper</surname><given-names>B</given-names></name>
        <name><surname>Yang</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>An assessment of AcquireX and Compound Discoverer software 3.3 for non-targets metabolomics.</article-title>
      <source>Sci. Rep..</source>
      <year iso-8601-date="2024">2024</year>
      <volume>14</volume>
      <pub-id pub-id-type="doi">10.1038/s41598-024-55356-3</pub-id>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
