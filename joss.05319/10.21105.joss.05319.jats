<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">5319</article-id>
<article-id pub-id-type="doi">10.21105/joss.05319</article-id>
<title-group>
<article-title>pyGeo: A geometry package for multidisciplinary design
optimization</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5103-7159</contrib-id>
<name>
<surname>Hajdik</surname>
<given-names>Hannah M.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1814-9191</contrib-id>
<name>
<surname>Yildirim</surname>
<given-names>Anil</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8856-9661</contrib-id>
<name>
<surname>Wu</surname>
<given-names>Ella</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9819-3028</contrib-id>
<name>
<surname>Brelje</surname>
<given-names>Benjamin J.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7364-0071</contrib-id>
<name>
<surname>Seraj</surname>
<given-names>Sabet</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8495-3578</contrib-id>
<name>
<surname>Mangano</surname>
<given-names>Marco</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7795-2523</contrib-id>
<name>
<surname>Anibal</surname>
<given-names>Joshua L.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5166-3889</contrib-id>
<name>
<surname>Jonsson</surname>
<given-names>Eirikur</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8716-1805</contrib-id>
<name>
<surname>Adler</surname>
<given-names>Eytan J.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2744-1151</contrib-id>
<name>
<surname>Mader</surname>
<given-names>Charles A.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1352-5458</contrib-id>
<name>
<surname>Kenway</surname>
<given-names>Gaetan K. W.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2143-1478</contrib-id>
<name>
<surname>Martins</surname>
<given-names>Joaquim R. R. A.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Aerospace Engineering, University of
Michigan</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2022-10-18">
<day>18</day>
<month>10</month>
<year>2022</year>
</pub-date>
<volume>8</volume>
<issue>87</issue>
<fpage>5319</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>geometry</kwd>
<kwd>Python</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Geometry parameterization is a key challenge in shape optimization.
  Parameterizations must accurately capture the design intent and
  perform well in optimization. In multidisciplinary design optimization
  (MDO), the parameterization must additionally represent the shape
  consistently across each discipline.</p>
  <p>pyGeo is a geometry package for three-dimensional shape
  manipulation tailored for aerodynamic and multidisciplinary design
  optimization. It provides several methods for geometry
  parameterization, geometric constraints, and utility functions for
  geometry manipulation. pyGeo computes derivatives for all
  parameterization methods and constraints, facilitating efficient
  gradient-based optimization.</p>
</sec>
<sec id="features">
  <title>Features</title>
  <sec id="integrations">
    <title>Integrations</title>
    <p>pyGeo is the geometry manipulation engine within the MDO of
    Aircraft Configurations at High Fidelity (MACH) framework
    (<xref alt="Kenway et al., 2014" rid="ref-Kenway2014a" ref-type="bibr">Kenway
    et al., 2014</xref>;
    <xref alt="Kenway &amp; Martins, 2014" rid="ref-Kenway2014c" ref-type="bibr">Kenway
    &amp; Martins, 2014</xref>), specializing in high-fidelity
    aerostructural optimization. pyGeo can be used as a stand-alone
    package and is integrated into
    MPhys<xref ref-type="fn" rid="fn1">1</xref>, a more general
    framework for high-fidelity multiphysics problems built with
    OpenMDAO
    (<xref alt="Gray et al., 2019" rid="ref-Gray2019a" ref-type="bibr">Gray
    et al., 2019</xref>). MACH and MPhys use pyOptSparse
    (<xref alt="Wu et al., 2020" rid="ref-Wu2020a" ref-type="bibr">Wu et
    al., 2020</xref>) to interface with optimization algorithms.</p>
    <p>pyGeo’s interface for design variables and constraints is
    independent of which disciplinary models access the geometry. This
    means that pyGeo can interact with different disciplines (such as
    structures and aerodynamics) in the same way. This also facilitates
    a direct comparison of the behavior or performance of two
    alternative models for a discipline using the same geometry
    parameterization
    (<xref alt="Adler et al., 2022" rid="ref-Adler2022c" ref-type="bibr">Adler
    et al., 2022</xref>).</p>
  </sec>
  <sec id="geometry-parameterization-with-pygeo">
    <title>Geometry Parameterization with pyGeo</title>
    <p>pyGeo contains several options for parameterizing geometry:
    variations on the free-form deformation (FFD) method, interfaces to
    external parametric modeling tools, and an analytic
    parameterization. Because each parameterization method uses a common
    interface for interacting with the rest of the MACH framework, any
    surface parameterization can be used in place of another within an
    optimization setup
    (<xref alt="Hajdik et al., 2023" rid="ref-Hajdik2023a" ref-type="bibr">Hajdik
    et al., 2023</xref>). The choice of parameterization depends on the
    user’s experience, the geometry details, and whether the user needs
    the final design in a specific format.</p>
    <sec id="free-form-deformation">
      <title>Free-form Deformation</title>
      <p>The FFD method
      (<xref alt="Sederberg &amp; Parry, 1986" rid="ref-Sederberg1986" ref-type="bibr">Sederberg
      &amp; Parry, 1986</xref>) is one of the most popular
      three-dimensional geometry parameterization approaches
      (<xref alt="Zhang et al., 2018" rid="ref-Zhang2018a" ref-type="bibr">Zhang
      et al., 2018</xref>). This approach embeds the entire reference
      geometry in a parameterized volume. The set of control points that
      determines the shape of the volume is displaced to manipulate the
      points inside. The user can have a high degree of control over the
      geometry by selecting different control point densities and
      locations.</p>
      <p>Individual control points can be moved to obtain local shape
      modifications. In pyGeo, these are referred to as
      <italic>local</italic> design variables because a single control
      point is affected. Conversely, it is also common to define
      geometric operations involving a collection of control points
      across the entire FFD block. These are referred to as
      <italic>global</italic> design variables in pyGeo. For example,
      wing twist variables can be defined as rotations of the control
      points about a reference axis that runs along the wing.
      <xref alt="[fig:FFD_DV]" rid="figU003AFFD_DV">[fig:FFD_DV]</xref>
      shows a few common planform design variables for an aircraft
      wing.</p>
      <p>Design variables formulated from groupings of FFD control
      points often exhibit ill-conditioning. A parameterization based on
      singular value decomposition is also possible within pyGeo to
      alleviate this issue
      (<xref alt="Wu et al., 2022" rid="ref-Wu2022b" ref-type="bibr">Wu
      et al., 2022</xref>).</p>
      <fig>
        <caption><p>Examples of common wing planform design
        variables.<styled-content id="figU003AFFD_DV"></styled-content></p></caption>
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/ffd_dvs.pdf" />
      </fig>
      <p>In addition to the basic FFD implementation, pyGeo offers two
      additional features: hierarchical FFD and multi-component FFD.</p>
      <sec id="hierarchical-ffd">
        <title>Hierarchical FFD</title>
        <p>FFD objects can be organized in a hierarchical structure
        within pyGeo. Dependent, “child” FFD blocks can be embedded in
        the main, “parent” FFD block to enable modifications on a subset
        of the entire geometry. pyGeo first propagates the parent
        deformations to both the geometry and the child control points
        and then propagates the deformations of the child control points
        to their subset of the geometry. One of the advantages of using
        this approach is that each FFD block can have its own
        independent reference axis to be used for global design
        variables such as rotations and scaling.
        <xref alt="[fig:ffd_child]" rid="figU003Affd_child">[fig:ffd_child]</xref>
        shows a case where the parent FFD block is used to manipulate
        the shape of a blended wing body aircraft while its control
        surface is deformed using a child FFD block.</p>
        <fig>
          <caption><p>Example of parameterization through parent-child
          FFD blocks
          (<xref alt="Lyu &amp; Martins, 2014" rid="ref-Lyu2014c" ref-type="bibr">Lyu
          &amp; Martins, 2014</xref>).
          <styled-content id="figU003Affd_child"></styled-content></p></caption>
          <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/child_ffd.pdf" />
        </fig>
      </sec>
      <sec id="multi-component-ffd">
        <title>Multi-component FFD</title>
        <p>The basic FFD implementation lacks flexibility when the
        geometry has intersecting components. In such cases, pyGeo can
        parameterize each component using FFD and ensure a watertight
        surface representation at the component intersections using an
        inverse-distance surface deformation method
        (<xref alt="Yildirim et al., 2021" rid="ref-Yildirim2021b" ref-type="bibr">Yildirim
        et al., 2021</xref>).
        <xref alt="[fig:ffd_multi]" rid="figU003Affd_multi">[fig:ffd_multi]</xref>
        shows an example of a component-based FFD setup for a supersonic
        transport aircraft.</p>
        <fig>
          <caption><p>Example of FFD parameterization with intersecting
          components
          (<xref alt="Seraj &amp; Martins, 2022" rid="ref-Seraj2022a" ref-type="bibr">Seraj
          &amp; Martins, 2022</xref>).
          <styled-content id="figU003Affd_multi"></styled-content></p></caption>
          <graphic mimetype="image" mime-subtype="png" xlink:href="media/ffd_multi.png" />
        </fig>
      </sec>
    </sec>
    <sec id="parametric-geometry-tools">
      <title>Parametric Geometry Tools</title>
      <p>pyGeo contains interfaces to two parametric geometry tools, the
      Engineering Sketch Pad (ESP)
      (<xref alt="Haimes &amp; Dannenhoffer, 2013" rid="ref-Haimes2013a" ref-type="bibr">Haimes
      &amp; Dannenhoffer, 2013</xref>) and OpenVSP
      (<xref alt="McDonald &amp; Gloudemans, 2022" rid="ref-McDonald2022a" ref-type="bibr">McDonald
      &amp; Gloudemans, 2022</xref>). ESP is CAD-based, while OpenVSP is
      a conceptual design tool. The two packages have different
      capabilities, but both directly define the geometry with design
      variables, and the created geometry can be used in external
      analysis tools.</p>
      <p>pyGeo interfaces with ESP and OpenVSP in similar ways. In both
      cases, pyGeo takes an instance of the model, and its points are
      associated with coordinates in a mesh from a solver in the MACH
      framework. For ESP
      (<xref alt="[fig:esp_example]" rid="figU003Aesp_example">[fig:esp_example]</xref>)
      and OpenVSP models
      (<xref alt="[fig:vsp_example]" rid="figU003Avsp_example">[fig:vsp_example]</xref>),
      the pyGeo interface to the respective software stores the model in
      a form usable within the MACH framework and updates it as design
      variables are changed throughout the optimization.</p>
      <fig>
        <caption><p>Example of ESP models of hydrogen tanks used through
        pyGeo
        (<xref alt="Brelje &amp; Martins, 2021" rid="ref-Brelje2021a" ref-type="bibr">Brelje
        &amp; Martins, 2021</xref>).
        <styled-content id="figU003Aesp_example"></styled-content></p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="media/esp_example.png" />
      </fig>
      <fig>
        <caption><p>Example of an OpenVSP aircraft model used through
        OpenVSP’s pyGeo interface
        (<xref alt="Yildirim et al., 2022" rid="ref-Yildirim2022a" ref-type="bibr">Yildirim
        et al., 2022</xref>).
        <styled-content id="figU003Avsp_example"></styled-content></p></caption>
        <graphic mimetype="image" mime-subtype="png" xlink:href="media/vsp_example.png" />
      </fig>
    </sec>
    <sec id="class-shape-transformation">
      <title>Class Shape Transformation</title>
      <p>The class shape transformation (CST)
      (<xref alt="Kulfan, 2008" rid="ref-Kulfan2008" ref-type="bibr">Kulfan,
      2008</xref>) is a popular airfoil parameterization. It generates a
      shape using Bernstein polynomials to scale a class function, which
      is most often a base airfoil shape. pyGeo contains an
      implementation of this airfoil parameterization that supports
      design variables for the Bernstein polynomial weightings, the
      class function parameters, and the airfoil chord length. pyGeo’s
      CST implementation can only be used for 2D problems, such as
      airfoil optimization
      (<xref alt="[fig:cst_example]" rid="figU003Acst_example">[fig:cst_example]</xref>).</p>
      <fig>
        <caption><p>Airfoil defined by three CST coefficients on each
        surface undergoing a perturbation in one Bernstein polynomial.
        <styled-content id="figU003Acst_example"></styled-content></p></caption>
        <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/cst_example.pdf" />
      </fig>
    </sec>
  </sec>
  <sec id="constraints">
    <title>Constraints</title>
    <p>pyGeo also includes geometric constraints to prevent
    geometrically undesirable designs. The most commonly-used class of
    geometry constraints in pyGeo involves tracking one or more linear
    dimensions on the optimized object’s surface. These constraints are
    created by specifying a single point, a line, or an array of points,
    along with a normal direction, then computing two line-surface
    intersection points. Some commonly used geometric constraints in
    shape optimization, such as thickness, area, and volume constraints
    (<xref alt="[fig:constraint]" rid="figU003Aconstraint">[fig:constraint]</xref>)
    can be computed using variations on this approach, which is
    computationally cheap and robust
    (<xref alt="Brelje et al., 2020" rid="ref-Brelje2020a" ref-type="bibr">Brelje
    et al., 2020</xref>).</p>
    <fig>
      <caption><p>Thickness and volume constraints demonstrated on an
      wing section
      (<xref alt="Brelje et al., 2020" rid="ref-Brelje2020a" ref-type="bibr">Brelje
      et al., 2020</xref>).
      <styled-content id="figU003Aconstraint"></styled-content></p></caption>
      <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/constraints_3d.pdf" />
    </fig>
    <p>If a more complex geometry needs to be integrated into an
    optimized surface, pyGeo supports an alternative geometric
    constraint formulation based on arbitrary triangulated surfaces as
    illustrated in
    <xref alt="[fig:trisurf]" rid="figU003Atrisurf">[fig:trisurf]</xref>
    (<xref alt="Brelje et al., 2020" rid="ref-Brelje2020a" ref-type="bibr">Brelje
    et al., 2020</xref>).</p>
    <fig>
      <caption><p>Triangulated surface constraint used to optimize an
      aeroshell around a complex geometry
      (<xref alt="Brelje et al., 2020" rid="ref-Brelje2020a" ref-type="bibr">Brelje
      et al.,
      2020</xref>).<styled-content id="figU003Atrisurf"></styled-content></p></caption>
      <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/trisurfcon.pdf" />
    </fig>
  </sec>
</sec>
<sec id="parallelism">
  <title>Parallelism</title>
  <p>pyGeo can optionally work under distributed memory parallelism
  using MPI (Message Passing Interface), which is required when
  interfacing with large-scale computational fluid dynamics (CFD)
  applications. For example, the computational mesh may be partitioned
  and distributed among many processors by the CFD solver, and each
  processor may be aware of only its portion of the mesh. pyGeo can
  handle such scenarios by independently manipulating the geometry on
  each processor and aggregating the constraints across all processors
  when communicating with the optimizer.</p>
</sec>
<sec id="derivative-computation">
  <title>Derivative Computation</title>
  <p>In addition to geometry manipulation and constraints, pyGeo can
  compute derivatives of these operations with respect to design
  variables. For the geometric deformation, pyGeo can compute the
  Jacobian matrix <disp-formula><alternatives>
  <tex-math><![CDATA[\frac{\mathrm{d}X_s}{\mathrm{d}x} ,]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[X_s]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>X</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the vector of surface mesh coordinates, and
  <inline-formula><alternatives>
  <tex-math><![CDATA[x]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>x</mml:mi></mml:math></alternatives></inline-formula>
  is the vector of geometric design variables.</p>
  <p>Similarly, pyGeo can compute the constraint Jacobian matrix
  <disp-formula><alternatives>
  <tex-math><![CDATA[\frac{\mathrm{d}g}{\mathrm{d}x} ,]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[g]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>g</mml:mi></mml:math></alternatives></inline-formula>
  is the vector of geometric constraints.</p>
  <p>For the FFD parameterization, these derivatives are computed using
  analytic methods
  (<xref alt="Martins &amp; Ning, 2021, sec. 6.6" rid="ref-Martins2021" ref-type="bibr">Martins
  &amp; Ning, 2021, sec. 6.6</xref>) and the complex-step method
  (<xref alt="Martins et al., 2003" rid="ref-Martins2003a" ref-type="bibr">Martins
  et al., 2003</xref>). For the interfaces to OpenVSP and ESP, the
  derivatives are computed with parallel finite differences. The CST
  derivatives are computed analytically.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Few open-source packages exist with comparable functionalities. To
  the authors’ best knowledge, the only other open-source CFD-based
  optimization framework that contains a geometry parameterization
  method is SU2
  (<xref alt="Economon et al., 2016" rid="ref-Economon2016a" ref-type="bibr">Economon
  et al., 2016</xref>). It supports Hicks–Henne bump functions
  (<xref alt="Hicks &amp; Henne, 1978" rid="ref-Hicks1978" ref-type="bibr">Hicks
  &amp; Henne, 1978</xref>) for airfoil optimizations and the FFD method
  for 3D cases. However, this geometry parameterization cannot be used
  with other solvers (aerodynamic or otherwise) because it is tightly
  integrated into SU2.</p>
  <p>While both OpenVSP and ESP can be used directly in optimization
  without using pyGeo, they lack the capabilities needed for
  high-fidelity MDO when used as stand-alone tools. pyGeo fills these
  gaps through parallelism, efficient gradients, and geometric
  constraints. It keeps OpenVSP and ESP in the optimization loop and
  provides a standard interface to these tools for use with external
  solvers.</p>
  <p>pyGeo is maintained and developed by the MDO
  Lab<xref ref-type="fn" rid="fn2">2</xref> at the University of
  Michigan and is actively used for MDO applications in research and
  industry. Having different parameterization choices in pyGeo has been
  useful because the best parameterization depends on the type of
  problem. pyGeo’s standard FFD implementation is the most commonly used
  parameterization
  (<xref alt="Bons et al., 2019" rid="ref-Bons2019a" ref-type="bibr">Bons
  et al., 2019</xref>;
  <xref alt="Kenway &amp; Martins, 2014" rid="ref-Kenway2014c" ref-type="bibr">Kenway
  &amp; Martins, 2014</xref>). The hierarchical FFD method was used to
  optimize a blended wing body aircraft
  (<xref alt="Lyu &amp; Martins, 2014" rid="ref-Lyu2014c" ref-type="bibr">Lyu
  &amp; Martins, 2014</xref>), a hydrofoil
  (<xref alt="Liao et al., 2021" rid="ref-Liao2021a" ref-type="bibr">Liao
  et al., 2021</xref>), and a wind turbine
  (<xref alt="Madsen et al., 2019" rid="ref-Madsen2019a" ref-type="bibr">Madsen
  et al., 2019</xref>). The method for using multiple FFD blocks has
  been used to optimize a conventional aircraft
  (<xref alt="Yildirim et al., 2021" rid="ref-Yildirim2021b" ref-type="bibr">Yildirim
  et al., 2021</xref>), a T-shaped hydrofoil
  (<xref alt="Liao et al., 2022" rid="ref-Liao2022" ref-type="bibr">Liao
  et al., 2022</xref>), and a supersonic transport aircraft
  (<xref alt="Seraj &amp; Martins, 2022" rid="ref-Seraj2022a" ref-type="bibr">Seraj
  &amp; Martins, 2022</xref>). The interface to ESP made it possible to
  parameterize hydrogen tanks within a combined aerostructural and
  packaging optimization
  (<xref alt="Brelje &amp; Martins, 2021" rid="ref-Brelje2021a" ref-type="bibr">Brelje
  &amp; Martins, 2021</xref>). pyGeo’s OpenVSP interface was used in
  aeropropulsive optimizations
  (<xref alt="Yildirim et al., 2022" rid="ref-Yildirim2022a" ref-type="bibr">Yildirim
  et al., 2022</xref>). The implementation of CST airfoil
  parameterization was used to compare methods for airfoil optimization
  (<xref alt="Adler et al., 2022" rid="ref-Adler2022c" ref-type="bibr">Adler
  et al., 2022</xref>).</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We are grateful to the numerous pyGeo users who have contributed
  their time to the code and its maintenance over the years.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-McDonald2022a">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>McDonald</surname><given-names>Robert A.</given-names></name>
        <name><surname>Gloudemans</surname><given-names>James R.</given-names></name>
      </person-group>
      <article-title>Open vehicle sketch pad: An open source parametric geometry and analysis tool for conceptual aircraft design</article-title>
      <source>AIAA SCITECH 2022 forum</source>
      <publisher-name>American Institute of Aeronautics; Astronautics</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <pub-id pub-id-type="doi">10.2514/6.2022-0004</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Haimes2013a">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Haimes</surname><given-names>Robert</given-names></name>
        <name><surname>Dannenhoffer</surname><given-names>John</given-names></name>
      </person-group>
      <article-title>The engineering sketch pad: A solid-modeling, feature-based, web-enabled system for building parametric geometry</article-title>
      <source>21st AIAA Computational Fluid Dynamics Conference</source>
      <publisher-name>American Institute of Aeronautics; Astronautics</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <pub-id pub-id-type="doi">10.2514/6.2013-3073</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Sederberg1986">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sederberg</surname><given-names>Thomas W.</given-names></name>
        <name><surname>Parry</surname><given-names>Scott R.</given-names></name>
      </person-group>
      <article-title>Free-form deformation of solid geometric models</article-title>
      <source>SIGGRAPH Comput. Graph.</source>
      <publisher-name>ACM</publisher-name>
      <publisher-loc>New York, NY, USA</publisher-loc>
      <year iso-8601-date="1986">1986</year>
      <volume>20</volume>
      <issue>4</issue>
      <issn>0097-8930</issn>
      <pub-id pub-id-type="doi">10.1145/15886.15903</pub-id>
      <fpage>151</fpage>
      <lpage>160</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Kulfan2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kulfan</surname><given-names>B. M.</given-names></name>
      </person-group>
      <article-title>Universal parametric geometry representation method</article-title>
      <source>Journal of Aircraft</source>
      <publisher-name>American Institute of Aeronautics; Astronautics</publisher-name>
      <year iso-8601-date="2008">2008</year>
      <volume>45</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.2514/1.29958</pub-id>
      <fpage>142</fpage>
      <lpage>158</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Gray2019a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gray</surname><given-names>Justin S.</given-names></name>
        <name><surname>Hwang</surname><given-names>John T.</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
        <name><surname>Moore</surname><given-names>Kenneth T.</given-names></name>
        <name><surname>Naylor</surname><given-names>Bret A.</given-names></name>
      </person-group>
      <article-title>OpenMDAO: An open-source framework for multidisciplinary design, analysis, and optimization</article-title>
      <source>Structural and Multidisciplinary Optimization</source>
      <year iso-8601-date="2019">2019</year>
      <volume>59</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1007/s00158-019-02211-z</pub-id>
      <fpage>1075</fpage>
      <lpage>1104</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Kenway2014c">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kenway</surname><given-names>Gaetan K. W.</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Multipoint high-fidelity aerostructural optimization of a transport aircraft configuration</article-title>
      <source>Journal of Aircraft</source>
      <year iso-8601-date="2014">2014</year>
      <volume>51</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.2514/1.C032150</pub-id>
      <fpage>144</fpage>
      <lpage>160</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Kenway2014a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kenway</surname><given-names>Gaetan K. W.</given-names></name>
        <name><surname>Kennedy</surname><given-names>Graeme J.</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Scalable parallel approach for high-fidelity steady-state aeroelastic analysis and adjoint derivative computations</article-title>
      <source>AIAA Journal</source>
      <year iso-8601-date="2014-05">2014</year><month>05</month>
      <volume>52</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.2514/1.J052255</pub-id>
      <fpage>935</fpage>
      <lpage>951</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Wu2020a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wu</surname><given-names>Ella</given-names></name>
        <name><surname>Kenway</surname><given-names>Gaetan</given-names></name>
        <name><surname>Mader</surname><given-names>Charles A.</given-names></name>
        <name><surname>Jasa</surname><given-names>John</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>pyOptSparse: A Python framework for large-scale constrained nonlinear optimization of sparse systems</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2020">2020</year>
      <volume>5</volume>
      <issue>54</issue>
      <pub-id pub-id-type="doi">10.21105/joss.02564</pub-id>
      <fpage>2564</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Brelje2021a">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Brelje</surname><given-names>Benjamin J.</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Aerostructural wing optimization for a hydrogen fuel cell aircraft</article-title>
      <source>Proceedings of the AIAA SciTech forum</source>
      <year iso-8601-date="2021">2021</year>
      <pub-id pub-id-type="doi">10.2514/6.2021-1132</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Economon2016a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Economon</surname><given-names>Thomas D.</given-names></name>
        <name><surname>Palacios</surname><given-names>Francisco</given-names></name>
        <name><surname>Copeland</surname><given-names>Sean R.</given-names></name>
        <name><surname>Lukaczyk</surname><given-names>Trent W.</given-names></name>
        <name><surname>Alonso</surname><given-names>Juan J.</given-names></name>
      </person-group>
      <article-title>SU2: An open-source suite for multiphysics simulation and design</article-title>
      <source>AIAA Journal</source>
      <year iso-8601-date="2016">2016</year>
      <volume>54</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.2514/1.j053813</pub-id>
      <fpage>828</fpage>
      <lpage>846</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Adler2022c">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Adler</surname><given-names>Eytan J.</given-names></name>
        <name><surname>Gray</surname><given-names>Alasdair Christison</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>To CFD or not to CFD? Comparing RANS and viscous panel methods for airfoil shape optimization</article-title>
      <source>33rd congress of the international council of the aeronautical sciences</source>
      <year iso-8601-date="2022">2022</year>
    </element-citation>
  </ref>
  <ref id="ref-Wu2022b">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Wu</surname><given-names>Ella</given-names></name>
        <name><surname>Mader</surname><given-names>Charles</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Sensitivity-based geometric parameterization for aerodynamic shape optimization</article-title>
      <source>AIAA AVIATION 2022 forum</source>
      <year iso-8601-date="2022">2022</year>
      <pub-id pub-id-type="doi">10.2514/6.2022-3931</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Martins2003a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
        <name><surname>Sturdza</surname><given-names>Peter</given-names></name>
        <name><surname>Alonso</surname><given-names>Juan J.</given-names></name>
      </person-group>
      <article-title>The complex-step derivative approximation</article-title>
      <source>ACM Transactions on Mathematical Software</source>
      <year iso-8601-date="2003">2003</year>
      <volume>29</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1145/838250.838251</pub-id>
      <fpage>245</fpage>
      <lpage>262</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Yildirim2021b">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yildirim</surname><given-names>Anil</given-names></name>
        <name><surname>Mader</surname><given-names>Charles A.</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>A surface mesh deformation method near component intersections for high-fidelity design optimization</article-title>
      <source>Engineering with Computers</source>
      <year iso-8601-date="2021">2021</year>
      <pub-id pub-id-type="doi">10.1007/s00366-020-01247-w</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Seraj2022a">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Seraj</surname><given-names>Sabet</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Aerodynamic shape optimization of a supersonic transport considering low-speed stability</article-title>
      <source>AIAA SciTech forum</source>
      <year iso-8601-date="2022">2022</year>
      <pub-id pub-id-type="doi">10.2514/6.2022-2177</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Liao2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Liao</surname><given-names>Yingqian</given-names></name>
        <name><surname>Yildirim</surname><given-names>Anil</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
        <name><surname>Young</surname><given-names>Yin Lu</given-names></name>
      </person-group>
      <article-title>RANS-based optimization of a T-shaped hydrofoil considering junction design</article-title>
      <source>Ocean Engineering</source>
      <year iso-8601-date="2022">2022</year>
      <volume>262</volume>
      <pub-id pub-id-type="doi">10.1016/j.oceaneng.2022.112051</pub-id>
      <fpage>112051</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Liao2021a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Liao</surname><given-names>Yingqian</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
        <name><surname>Young</surname><given-names>Yin Lu</given-names></name>
      </person-group>
      <article-title>3-D high-fidelity hydrostructural optimization of cavitation-free composite lifting surfaces</article-title>
      <source>Composite Structures</source>
      <year iso-8601-date="2021">2021</year>
      <volume>268</volume>
      <pub-id pub-id-type="doi">10.1016/j.compstruct.2021.113937</pub-id>
      <fpage>113937</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Madsen2019a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Madsen</surname><given-names>Mads H. Aa.</given-names></name>
        <name><surname>Zahle</surname><given-names>Frederik</given-names></name>
        <name><surname>Sørensen</surname><given-names>Niels N.</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Multipoint high-fidelity CFD-based aerodynamic shape optimization of a 10 MW wind turbine</article-title>
      <source>Wind Energy Science</source>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <pub-id pub-id-type="doi">10.5194/wes-4-163-2019</pub-id>
      <fpage>163</fpage>
      <lpage>192</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Yildirim2022a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yildirim</surname><given-names>Anil</given-names></name>
        <name><surname>Gray</surname><given-names>Justin S.</given-names></name>
        <name><surname>Mader</surname><given-names>Charles A.</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Boundary layer ingestion benefit for the STARC-ABL concept</article-title>
      <source>Journal of Aircraft</source>
      <year iso-8601-date="2022">2022</year>
      <volume>59</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.2514/1.C036103</pub-id>
      <fpage>896</fpage>
      <lpage>911</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Martins2021">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
        <name><surname>Ning</surname><given-names>Andrew</given-names></name>
      </person-group>
      <source>Engineering design optimization</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <publisher-loc>Cambridge, UK</publisher-loc>
      <year iso-8601-date="2021">2021</year>
      <isbn>9781108833417</isbn>
      <uri>https://mdobook.github.io</uri>
      <pub-id pub-id-type="doi">10.1017/9781108980647</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Hicks1978">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hicks</surname><given-names>R. M.</given-names></name>
        <name><surname>Henne</surname><given-names>P. A.</given-names></name>
      </person-group>
      <article-title>Wing design by numerical optimization</article-title>
      <source>Journal of Aircraft</source>
      <year iso-8601-date="1978">1978</year>
      <volume>15</volume>
      <pub-id pub-id-type="doi">10.2514/3.58379</pub-id>
      <fpage>407</fpage>
      <lpage>412</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Lyu2014c">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lyu</surname><given-names>Zhoujie</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Aerodynamic design optimization studies of a blended-wing-body aircraft</article-title>
      <source>Journal of Aircraft</source>
      <year iso-8601-date="2014">2014</year>
      <volume>51</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.2514/1.C032491</pub-id>
      <fpage>1604</fpage>
      <lpage>1617</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Brelje2020a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Brelje</surname><given-names>Benjamin J.</given-names></name>
        <name><surname>Anibal</surname><given-names>Joshua</given-names></name>
        <name><surname>Yildirim</surname><given-names>Anil</given-names></name>
        <name><surname>Mader</surname><given-names>Charles A.</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Flexible formulation of spatial integration constraints in aerodynamic shape optimization</article-title>
      <source>AIAA Journal</source>
      <year iso-8601-date="2020">2020</year>
      <volume>58</volume>
      <issue>6</issue>
      <pub-id pub-id-type="doi">10.2514/1.J058366</pub-id>
      <fpage>2571</fpage>
      <lpage>2580</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Hajdik2023a">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Hajdik</surname><given-names>Hannah M.</given-names></name>
        <name><surname>Yildirim</surname><given-names>Anil</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Aerodynamic shape optimization with CAD-based geometric parameterization</article-title>
      <source>AIAA SciTech forum</source>
      <publisher-loc>National Harbor, MD</publisher-loc>
      <year iso-8601-date="2023">2023</year>
      <pub-id pub-id-type="doi">10.2514/6.2023-0726</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Zhang2018a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhang</surname><given-names>Tian-tian</given-names></name>
        <name><surname>Wang</surname><given-names>Zhen-guo</given-names></name>
        <name><surname>Huang</surname><given-names>Wei</given-names></name>
        <name><surname>Yan</surname><given-names>Li</given-names></name>
      </person-group>
      <article-title>A review of parametric approaches specific to aerodynamic design process</article-title>
      <source>Acta Astronautica</source>
      <year iso-8601-date="2018">2018</year>
      <volume>145</volume>
      <issn>0094-5765</issn>
      <pub-id pub-id-type="doi">10.1016/j.actaastro.2018.02.011</pub-id>
      <fpage>319</fpage>
      <lpage>331</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Bons2019a">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bons</surname><given-names>Nicolas P.</given-names></name>
        <name><surname>He</surname><given-names>Xiaolong</given-names></name>
        <name><surname>Mader</surname><given-names>Charles A.</given-names></name>
        <name><surname>Martins</surname><given-names>Joaquim R. R. A.</given-names></name>
      </person-group>
      <article-title>Multimodality in aerodynamic wing design optimization</article-title>
      <source>AIAA Journal</source>
      <year iso-8601-date="2019">2019</year>
      <volume>57</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.2514/1.J057294</pub-id>
      <fpage>1004</fpage>
      <lpage>1018</lpage>
    </element-citation>
  </ref>
</ref-list>
<fn-group>
  <fn id="fn1">
    <label>1</label><p><ext-link ext-link-type="uri" xlink:href="https://github.com/OpenMDAO/mphys">https://github.com/OpenMDAO/mphys</ext-link></p>
  </fn>
  <fn id="fn2">
    <label>2</label><p><ext-link ext-link-type="uri" xlink:href="https://mdolab.engin.umich.edu">https://mdolab.engin.umich.edu</ext-link></p>
  </fn>
</fn-group>
</back>
</article>
