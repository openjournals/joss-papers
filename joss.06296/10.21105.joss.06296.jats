<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6296</article-id>
<article-id pub-id-type="doi">10.21105/joss.06296</article-id>
<title-group>
<article-title>Paicos: A Python package for analysis of (cosmological)
simulations performed with Arepo</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0466-603X</contrib-id>
<name>
<surname>Berlok</surname>
<given-names>Thomas</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0007-9039-294X</contrib-id>
<name>
<surname>Jlassi</surname>
<given-names>Léna</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8778-7587</contrib-id>
<name>
<surname>Puchwein</surname>
<given-names>Ewald</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9422-8684</contrib-id>
<name>
<surname>Haugbølle</surname>
<given-names>Troels</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Niels Bohr Institute, University of Copenhagen,
Denmark</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Leibniz-Institut für Astrophysik Potsdam,
Germany</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-01-31">
<day>31</day>
<month>1</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>96</issue>
<fpage>6296</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>astronomy</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Cosmological simulations evolve dark matter and baryons subject to
  gravitational and hydrodynamic forces
  (<xref alt="Vogelsberger et al., 2020" rid="ref-Vogelsberger2020" ref-type="bibr">Vogelsberger
  et al., 2020</xref>). The simulations start at high redshift and
  capture hierarchical structure formation where small structures form
  first and later assemble to larger structures
  (<xref alt="Springel et al., 2005" rid="ref-Springel2005" ref-type="bibr">Springel
  et al., 2005</xref>). The Arepo code is a versatile finite-volume code
  which can solve the magnetohydrodynamic equations on an unstructured
  Voronoi mesh in a cosmologically comoving frame
  (<xref alt="Springel, 2010" rid="ref-Springel2010" ref-type="bibr">Springel,
  2010</xref>;
  <xref alt="Weinberger et al., 2020" rid="ref-Weinberger2020" ref-type="bibr">Weinberger
  et al., 2020</xref>).</p>
  <p>Here we present Paicos, a new object-oriented Python package for
  analyzing simulations performed with Arepo. Paicos strives to reduce
  the learning curve for students and researchers getting started with
  Arepo simulations. As such, Paicos includes many examples in the form
  of Python scripts and Jupyter notebooks
  (<xref alt="Kluyver et al., 2016" rid="ref-Kluyver2016" ref-type="bibr">Kluyver
  et al., 2016</xref>) as well as an online documentation describing the
  installation procedure and recommended first steps.</p>
  <p>Paicos’ main features are automatic handling of cosmological and
  physical units, computation of derived variables, 2D visualization
  (slices and projections), 1D and 2D histograms, and easy saving and
  loading of derived data including units and all the relevant
  metadata.</p>
  <p>Paicos relies heavily on well-established open source software
  libraries such as NumPy
  (<xref alt="Harris et al., 2020" rid="ref-Harris2020" ref-type="bibr">Harris
  et al., 2020</xref>;
  <xref alt="van der Walt et al., 2011" rid="ref-numpy" ref-type="bibr">van
  der Walt et al., 2011</xref>), Scipy
  (<xref alt="Virtanen et al., 2020" rid="ref-Virtanen2020" ref-type="bibr">Virtanen
  et al., 2020</xref>), h5py
  (<xref alt="Collette, 2013" rid="ref-h5py" ref-type="bibr">Collette,
  2013</xref>), Cython
  (<xref alt="Behnel et al., 2011" rid="ref-Behnel2011" ref-type="bibr">Behnel
  et al., 2011</xref>) and astropy
  (<xref alt="Astropy Collaboration, 2013" rid="ref-astropy" ref-type="bibr">Astropy
  Collaboration, 2013</xref>) and contains features for interactive data
  analysis inside Ipython terminals
  (<xref alt="Perez &amp; Granger, 2007" rid="ref-Perez2007" ref-type="bibr">Perez
  &amp; Granger, 2007</xref>) and Jupyter notebooks
  (<xref alt="Kluyver et al., 2016" rid="ref-Kluyver2016" ref-type="bibr">Kluyver
  et al., 2016</xref>), e.g., tab completion of data keywords and Latex
  rendering of data units. Paicos also contains a number of tests that
  are automated using pytest
  (<xref alt="Krekel et al., 2004" rid="ref-pytest7.4" ref-type="bibr">Krekel
  et al., 2004</xref>), CircleCi and GitHub workflows.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>The Arepo code stores its data output as HDF5 files, which can
  easily be loaded as NumPy arrays using h5py. However, data
  visualization of the unstructured mesh used in Arepo is non-trivial
  and keeping track of the units used in the data outputs can also be a
  tedious task. The general purpose visualization and data analysis
  software package yt<xref ref-type="fn" rid="fn1">1</xref>
  (<xref alt="Turk et al., 2011" rid="ref-yt-Turk" ref-type="bibr">Turk
  et al., 2011</xref>) and the visualization package py-sphviewer
  (<xref alt="Benitez-Llambay, 2015" rid="ref-py-sphviewer" ref-type="bibr">Benitez-Llambay,
  2015</xref>) are both able to perform visualizations of Arepo
  simulations. Paicos provides an alternative, which is specifically
  tailored to Arepo simulations. It is in this regard similar to
  swiftsimio
  (<xref alt="Borrow &amp; Borrisov, 2020" rid="ref-Borrow2020" ref-type="bibr">Borrow
  &amp; Borrisov, 2020</xref>), which was developed specifically for
  SWIFT simulations
  (<xref alt="Schaller &amp; others, 2023" rid="ref-Schaller2023" ref-type="bibr">Schaller
  &amp; others, 2023</xref>).</p>
  <p>We have developed Paicos because we identified a need for an
  analysis code that simultaneously fulfills the following requirements:
  1) is specifically written for analysis of Arepo simulations
  discretized on a Voronoi mesh 2) provides safeguards against errors
  related to conversions of cosmological and physical units 3)
  facilitates working with large data sets by supporting the saving and
  loading of reduced/derived data including units and metadata 4)
  contains enough functionality to be useful for practical research
  tasks while still being light-weight and well-documented enough that
  it can be installed, used and understood by a junior researcher with
  little or no assistance.</p>
</sec>
<sec id="overview-of-key-paicos-features">
  <title>Overview of key Paicos features</title>
  <p>The key Paicos features, which were implemented to fulfill the
  above requirements, are as follows:</p>
  <list list-type="bullet">
    <list-item>
      <p>Functionality for reading cell/particle and group/subhalo
      catalog data as saved by Arepo in the HDF5 format.</p>
    </list-item>
    <list-item>
      <p>Unit-handling via astropy with additional support for the
      <inline-formula><alternatives>
      <tex-math><![CDATA[a]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>a</mml:mi></mml:math></alternatives></inline-formula>
      and <inline-formula><alternatives>
      <tex-math><![CDATA[h]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>h</mml:mi></mml:math></alternatives></inline-formula>
      factors that are used in cosmological
      simulations.<xref ref-type="fn" rid="fn2">2</xref></p>
    </list-item>
    <list-item>
      <p>Functionality for automatically obtaining derived variables
      from the variables present in the Arepo snapshot (e.g. the cell
      volume, temperature, or magnetic field strength). Within Jupyter
      notebooks or an Ipython terminal: Tab completion to show which
      variables are available for a given data group (either by directly
      loading from the HDF5-file or by automatically calculating a
      derived variable).</p>
    </list-item>
    <list-item>
      <p>Functionality for saving and loading data including
      cosmological and physical units in HDF5-files that automatically
      include all metadata from the original Arepo snapshot (i.e. the
      Header, Config and Param groups).</p>
    </list-item>
    <list-item>
      <p>Functionality for creating slices and projections and saving
      them in a format that additionally includes information about the
      size, center and orientation of the image.</p>
    </list-item>
    <list-item>
      <p>Functionality for creating 1D and 2D histograms (e.g. radial
      profiles and <inline-formula><alternatives>
      <tex-math><![CDATA[\rho]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ρ</mml:mi></mml:math></alternatives></inline-formula>-<inline-formula><alternatives>
      <tex-math><![CDATA[T]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>
      phase-space plots) of large data sets (using OpenMP-enabled
      Cython).</p>
    </list-item>
    <list-item>
      <p>Functionality for user customization, e.g. adding new units or
      functions for computing derived variables.</p>
    </list-item>
    <list-item>
      <p>Functionality for selecting only a part of a snapshot for
      analysis and for storing this selection as a new reduced
      snapshot.</p>
    </list-item>
  </list>
  <p>Finally, we also make public GPU implementations of projection
  functionalities, which are much faster than the OpenMP-parallel CPU
  implementations described above. The GPU implementations include a
  mass-conserving SPH-like projection and a ray tracing implementation
  using a bounding volume hierarchy (BVH) in the form of a binary radix
  tree for nearest neighbor searches. These GPU implementations use
  Numba
  (<xref alt="Lam et al., 2015" rid="ref-Numba2015" ref-type="bibr">Lam
  et al., 2015</xref>) and CuPy
  (<xref alt="Okuta et al., 2017" rid="ref-cupy_learningsys2017" ref-type="bibr">Okuta
  et al., 2017</xref>) and require that the user has a CUDA-enabled GPU.
  Our binary tree implementation follows the the GPU-optimized
  tree-construction algorithm described in
  (<xref alt="Karras, 2012" rid="ref-Karras2012" ref-type="bibr">Karras,
  2012</xref>) and the implementation of it found in the publicly
  available Cornerstone Octree GPU-library
  (<xref alt="Keller et al., 2023" rid="ref-Keller2023" ref-type="bibr">Keller
  et al., 2023</xref>). Using our SPH-like implementation on an
  <ext-link ext-link-type="uri" xlink:href="https://www.nvidia.com/en-us/data-center/a100/">Nvidia
  A100 GPU</ext-link>, it takes less than a second to project 100 mio.
  particles onto an image plane with <inline-formula><alternatives>
  <tex-math><![CDATA[4096^2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mn>4096</mml:mn><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>
  pixels. This speed enables interactive data exploration. We provide an
  example IPython widget illustrating this feature. Finally, we note
  that the returned images include physical units and can be used for
  scientific analysis.</p>
  <p>Paicos is hosted on GitHub at https://github.com/tberlok/paicos. We
  strongly encourage contributions to Paicos by opening issues and
  submitting pull requests.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We thank the JOSS referees, Kyle Oman and Terrence Tricco, and the
  editor, Josh Borrow, for constructive feedback that greatly helped
  improve Paicos. We are grateful to Christoph Pfrommer for support and
  advice. We thank Rüdiger Pakmor, Rosie Talbot and Timon Thomas for
  useful discussions as well as Matthias Weber, Lorenzo Maria Perrone,
  Arne Trabert and Joseph Whittingham for beta-testing Paicos. We are
  grateful to Volker Springel for making the Arepo code available and to
  the main developers of arepo-snap-util (Federico Marinacci and Rüdiger
  Pakmor), a non-public code which we have used for comparison of
  projections and slices. TB gratefully acknowledges funding from the
  European Union’s Horizon Europe research and innovation programme
  under the Marie Skłodowska-Curie grant agreement No 101106080. LJ
  acknowledges support by the German Science Foundation (DFG) under
  grant “DFG Research Unit FOR 5195 – Relativistic Jets in Active
  Galaxies”. LJ and TB acknowledge support by the European Research
  Council under ERC-AdG grant PICOGAL-101019746. The authors gratefully
  acknowledge the Gauss Centre for Supercomputing e.V.
  (www.gauss-centre.eu) for funding this project by providing computing
  time on the GCS Supercomputer SuperMUC at Leibniz Supercomputing
  Centre (www.lrz.de). The Tycho supercomputer hosted at the SCIENCE HPC
  center at the University of Copenhagen was used for supporting this
  work.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-astropy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Astropy Collaboration</string-name>
      </person-group>
      <article-title>Astropy: A community Python package for astronomy</article-title>
      <source>Astronomy and Astrophysics</source>
      <year iso-8601-date="2013-10">2013</year><month>10</month>
      <volume>558</volume>
      <uri>http://adsabs.harvard.edu/abs/2013A%26A...558A..33A</uri>
      <pub-id pub-id-type="doi">10.1051/0004-6361/201322068</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-py-sphviewer">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Benitez-Llambay</surname><given-names>Alejandro</given-names></name>
      </person-group>
      <article-title>Py-sphviewer: Py-SPHViewer v1.0.0</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2015-07">2015</year><month>07</month>
      <uri>https://doi.org/10.5281/zenodo.21703</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.21703</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Schaller2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schaller</surname><given-names>Matthieu</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Swift: A modern highly-parallel gravity and smoothed particle hydrodynamics solver for astrophysical and cosmological applications</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2023-05">2023</year><month>05</month>
      <uri>https://arxiv.org/abs/2305.13380</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2305.13380</pub-id>
      <fpage>arXiv:2305.13380</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-yt-Turk">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Turk</surname><given-names>M. J.</given-names></name>
        <name><surname>Smith</surname><given-names>B. D.</given-names></name>
        <name><surname>Oishi</surname><given-names>J. S.</given-names></name>
        <name><surname>Skory</surname><given-names>S.</given-names></name>
        <name><surname>Skillman</surname><given-names>S. W.</given-names></name>
        <name><surname>Abel</surname><given-names>T.</given-names></name>
        <name><surname>Norman</surname><given-names>M. L.</given-names></name>
      </person-group>
      <article-title>yt: A Multi-code Analysis Toolkit for Astrophysical Simulation Data</article-title>
      <source>The Astrophysical Journal Supplement Series</source>
      <year iso-8601-date="2011-01">2011</year><month>01</month>
      <volume>192</volume>
      <uri>https://arxiv.org/abs/1011.3514</uri>
      <pub-id pub-id-type="doi">10.1088/0067-0049/192/1/9</pub-id>
      <fpage>9</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Borrow2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Borrow</surname><given-names>Josh</given-names></name>
        <name><surname>Borrisov</surname><given-names>Alexei</given-names></name>
      </person-group>
      <article-title>Swiftsimio: A python library for reading SWIFT data</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>5</volume>
      <issue>52</issue>
      <uri>https://doi.org/10.21105/joss.02430</uri>
      <pub-id pub-id-type="doi">10.21105/joss.02430</pub-id>
      <fpage>2430</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Numba2015">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Lam</surname><given-names>Siu Kwan</given-names></name>
        <name><surname>Pitrou</surname><given-names>Antoine</given-names></name>
        <name><surname>Seibert</surname><given-names>Stanley</given-names></name>
      </person-group>
      <article-title>Numba: A LLVM-based python JIT compiler</article-title>
      <source>Proceedings of the second workshop on the LLVM compiler infrastructure in HPC</source>
      <publisher-name>Association for Computing Machinery</publisher-name>
      <publisher-loc>New York, NY, USA</publisher-loc>
      <year iso-8601-date="2015">2015</year>
      <isbn>9781450340052</isbn>
      <uri>https://doi.org/10.1145/2833157.2833162</uri>
      <pub-id pub-id-type="doi">10.1145/2833157.2833162</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-cupy_learningsys2017">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Okuta</surname><given-names>Ryosuke</given-names></name>
        <name><surname>Unno</surname><given-names>Yuya</given-names></name>
        <name><surname>Nishino</surname><given-names>Daisuke</given-names></name>
        <name><surname>Hido</surname><given-names>Shohei</given-names></name>
        <name><surname>Loomis</surname><given-names>Crissman</given-names></name>
      </person-group>
      <article-title>CuPy: A NumPy-compatible library for NVIDIA GPU calculations</article-title>
      <source>Proceedings of workshop on machine learning systems (LearningSys) in the thirty-first annual conference on neural information processing systems (NIPS)</source>
      <year iso-8601-date="2017">2017</year>
      <uri>http://learningsys.org/nips17/assets/papers/paper_16.pdf</uri>
    </element-citation>
  </ref>
  <ref id="ref-Karras2012">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Karras</surname><given-names>Tero</given-names></name>
      </person-group>
      <article-title>Maximizing parallelism in the construction of BVHs, octrees, and k-d trees</article-title>
      <source>Proceedings of the fourth ACM SIGGRAPH / eurographics conference on high-performance graphics</source>
      <publisher-name>Eurographics Association</publisher-name>
      <publisher-loc>Goslar, DEU</publisher-loc>
      <year iso-8601-date="2012">2012</year>
      <isbn>9783905674415</isbn>
      <pub-id pub-id-type="doi">10.2312/EGGH/HPG12/033-037</pub-id>
      <fpage>33</fpage>
      <lpage>37</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Keller2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Keller</surname><given-names>Sebastian</given-names></name>
        <name><surname>Cavelan</surname><given-names>Aurélien</given-names></name>
        <name><surname>Cabezon</surname><given-names>Rubén</given-names></name>
        <name><surname>Mayer</surname><given-names>Lucio</given-names></name>
        <name><surname>Ciorba</surname><given-names>Florina M.</given-names></name>
      </person-group>
      <article-title>Cornerstone: Octree Construction Algorithms for Scalable Particle Simulations</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2023-07">2023</year><month>07</month>
      <uri>https://arxiv.org/abs/2307.06345</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2307.06345</pub-id>
      <fpage>arXiv:2307.06345</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Springel2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Springel</surname><given-names>Volker</given-names></name>
      </person-group>
      <article-title>E pur si muove: Galilean-invariant cosmological hydrodynamical simulations on a moving mesh</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2010-01">2010</year><month>01</month>
      <volume>401</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/0901.4107</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-2966.2009.15715.x</pub-id>
      <fpage>791</fpage>
      <lpage>851</lpage>
    </element-citation>
  </ref>
  <ref id="ref-numpy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>van der Walt</surname><given-names>Stéfan</given-names></name>
        <name><surname>Colbert</surname><given-names>S. Chris</given-names></name>
        <name><surname>Varoquaux</surname><given-names>Gaël</given-names></name>
      </person-group>
      <article-title>The NumPy Array: A Structure for Efficient Numerical Computation</article-title>
      <source>Computing in Science and Engineering</source>
      <year iso-8601-date="2011-03">2011</year><month>03</month>
      <volume>13</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/1102.1523</uri>
      <pub-id pub-id-type="doi">10.1109/MCSE.2011.37</pub-id>
      <fpage>22</fpage>
      <lpage>30</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Harris2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harris</surname><given-names>Charles R.</given-names></name>
        <name><surname>Millman</surname><given-names>K. Jarrod</given-names></name>
        <name><surname>van der Walt</surname><given-names>Stéfan J.</given-names></name>
        <name><surname>Gommers</surname><given-names>Ralf</given-names></name>
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>Cournapeau</surname><given-names>David</given-names></name>
        <name><surname>Wieser</surname><given-names>Eric</given-names></name>
        <name><surname>Taylor</surname><given-names>Julian</given-names></name>
        <name><surname>Berg</surname><given-names>Sebastian</given-names></name>
        <name><surname>Smith</surname><given-names>Nathaniel J.</given-names></name>
        <name><surname>Kern</surname><given-names>Robert</given-names></name>
        <name><surname>Picus</surname><given-names>Matti</given-names></name>
        <name><surname>Hoyer</surname><given-names>Stephan</given-names></name>
        <name><surname>van Kerkwijk</surname><given-names>Marten H.</given-names></name>
        <name><surname>Brett</surname><given-names>Matthew</given-names></name>
        <name><surname>Haldane</surname><given-names>Allan</given-names></name>
        <name><surname>del Rı́o</surname><given-names>Jaime Fernández</given-names></name>
        <name><surname>Wiebe</surname><given-names>Mark</given-names></name>
        <name><surname>Peterson</surname><given-names>Pearu</given-names></name>
        <name><surname>Gérard-Marchant</surname><given-names>Pierre</given-names></name>
        <name><surname>Sheppard</surname><given-names>Kevin</given-names></name>
        <name><surname>Reddy</surname><given-names>Tyler</given-names></name>
        <name><surname>Weckesser</surname><given-names>Warren</given-names></name>
        <name><surname>Abbasi</surname><given-names>Hameer</given-names></name>
        <name><surname>Gohlke</surname><given-names>Christoph</given-names></name>
        <name><surname>Oliphant</surname><given-names>Travis E.</given-names></name>
      </person-group>
      <article-title>Array programming with NumPy</article-title>
      <source>Nature</source>
      <year iso-8601-date="2020-09">2020</year><month>09</month>
      <volume>585</volume>
      <issue>7825</issue>
      <uri>https://arxiv.org/abs/2006.10256</uri>
      <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
      <fpage>357</fpage>
      <lpage>362</lpage>
    </element-citation>
  </ref>
  <ref id="ref-h5py">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Collette</surname><given-names>Andrew</given-names></name>
      </person-group>
      <source>Python and HDF5</source>
      <publisher-name>O’Reilly</publisher-name>
      <year iso-8601-date="2013">2013</year>
    </element-citation>
  </ref>
  <ref id="ref-Pakmor2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pakmor</surname><given-names>Rüdiger</given-names></name>
        <name><surname>Springel</surname><given-names>Volker</given-names></name>
      </person-group>
      <article-title>Simulations of magnetic fields in isolated disc galaxies</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2013-06">2013</year><month>06</month>
      <volume>432</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1212.1452</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stt428</pub-id>
      <fpage>176</fpage>
      <lpage>193</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Springel2005">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Springel</surname><given-names>Volker</given-names></name>
        <name><surname>White</surname><given-names>Simon D. M.</given-names></name>
        <name><surname>Jenkins</surname><given-names>Adrian</given-names></name>
        <name><surname>Frenk</surname><given-names>Carlos S.</given-names></name>
        <name><surname>Yoshida</surname><given-names>Naoki</given-names></name>
        <name><surname>Gao</surname><given-names>Liang</given-names></name>
        <name><surname>Navarro</surname><given-names>Julio</given-names></name>
        <name><surname>Thacker</surname><given-names>Robert</given-names></name>
        <name><surname>Croton</surname><given-names>Darren</given-names></name>
        <name><surname>Helly</surname><given-names>John</given-names></name>
        <name><surname>Peacock</surname><given-names>John A.</given-names></name>
        <name><surname>Cole</surname><given-names>Shaun</given-names></name>
        <name><surname>Thomas</surname><given-names>Peter</given-names></name>
        <name><surname>Couchman</surname><given-names>Hugh</given-names></name>
        <name><surname>Evrard</surname><given-names>August</given-names></name>
        <name><surname>Colberg</surname><given-names>Jörg</given-names></name>
        <name><surname>Pearce</surname><given-names>Frazer</given-names></name>
      </person-group>
      <article-title>Simulations of the formation, evolution and clustering of galaxies and quasars</article-title>
      <source>Nature</source>
      <year iso-8601-date="2005-06">2005</year><month>06</month>
      <volume>435</volume>
      <issue>7042</issue>
      <uri>https://arxiv.org/abs/astro-ph/0504097</uri>
      <pub-id pub-id-type="doi">10.1038/nature03597</pub-id>
      <fpage>629</fpage>
      <lpage>636</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Weinberger2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Weinberger</surname><given-names>Rainer</given-names></name>
        <name><surname>Springel</surname><given-names>Volker</given-names></name>
        <name><surname>Pakmor</surname><given-names>Rüdiger</given-names></name>
      </person-group>
      <article-title>The AREPO Public Code Release</article-title>
      <source>Astrophysical Journal, Supplement</source>
      <year iso-8601-date="2020-06">2020</year><month>06</month>
      <volume>248</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/1909.04667</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4365/ab908c</pub-id>
      <fpage>32</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Behnel2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Behnel</surname><given-names>Stefan</given-names></name>
        <name><surname>Bradshaw</surname><given-names>Robert</given-names></name>
        <name><surname>Citro</surname><given-names>Craig</given-names></name>
        <name><surname>Dalcin</surname><given-names>Lisandro</given-names></name>
        <name><surname>Seljebotn</surname><given-names>Dag Sverre</given-names></name>
        <name><surname>Smith</surname><given-names>Kurt</given-names></name>
      </person-group>
      <article-title>Cython: The Best of Both Worlds</article-title>
      <source>Computing in Science and Engineering</source>
      <year iso-8601-date="2011-03">2011</year><month>03</month>
      <volume>13</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1109/MCSE.2010.118</pub-id>
      <fpage>31</fpage>
      <lpage>39</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Virtanen2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>Gommers</surname><given-names>Ralf</given-names></name>
        <name><surname>Oliphant</surname><given-names>Travis E.</given-names></name>
        <name><surname>Haberland</surname><given-names>Matt</given-names></name>
        <name><surname>Reddy</surname><given-names>Tyler</given-names></name>
        <name><surname>Cournapeau</surname><given-names>David</given-names></name>
        <name><surname>Burovski</surname><given-names>Evgeni</given-names></name>
        <name><surname>Peterson</surname><given-names>Pearu</given-names></name>
        <name><surname>Weckesser</surname><given-names>Warren</given-names></name>
        <name><surname>Bright</surname><given-names>Jonathan</given-names></name>
        <name><surname>van der Walt</surname><given-names>Stéfan J.</given-names></name>
        <name><surname>Brett</surname><given-names>Matthew</given-names></name>
        <name><surname>Wilson</surname><given-names>Joshua</given-names></name>
        <name><surname>Millman</surname><given-names>K. Jarrod</given-names></name>
        <name><surname>Mayorov</surname><given-names>Nikolay</given-names></name>
        <name><surname>Nelson</surname><given-names>Andrew R. J.</given-names></name>
        <name><surname>Jones</surname><given-names>Eric</given-names></name>
        <name><surname>Kern</surname><given-names>Robert</given-names></name>
        <name><surname>Larson</surname><given-names>Eric</given-names></name>
        <name><surname>Carey</surname><given-names>C. J.</given-names></name>
        <name><surname>Polat</surname><given-names>İlhan</given-names></name>
        <name><surname>Feng</surname><given-names>Yu</given-names></name>
        <name><surname>Moore</surname><given-names>Eric W.</given-names></name>
        <name><surname>VanderPlas</surname><given-names>Jake</given-names></name>
        <name><surname>Laxalde</surname><given-names>Denis</given-names></name>
        <name><surname>Perktold</surname><given-names>Josef</given-names></name>
        <name><surname>Cimrman</surname><given-names>Robert</given-names></name>
        <name><surname>Henriksen</surname><given-names>Ian</given-names></name>
        <name><surname>Quintero</surname><given-names>E. A.</given-names></name>
        <name><surname>Harris</surname><given-names>Charles R.</given-names></name>
        <name><surname>Archibald</surname><given-names>Anne M.</given-names></name>
        <name><surname>Ribeiro</surname><given-names>Antônio H.</given-names></name>
        <name><surname>Pedregosa</surname><given-names>Fabian</given-names></name>
        <name><surname>van Mulbregt</surname><given-names>Paul</given-names></name>
        <string-name>SciPy 1. 0 Contributors</string-name>
      </person-group>
      <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>
      <source>Nature Methods</source>
      <year iso-8601-date="2020-02">2020</year><month>02</month>
      <volume>17</volume>
      <uri>https://arxiv.org/abs/1907.10121</uri>
      <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
      <fpage>261</fpage>
      <lpage>272</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pytest7.4">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Krekel</surname><given-names>Holger</given-names></name>
        <name><surname>Oliveira</surname><given-names>Bruno</given-names></name>
        <name><surname>Pfannschmidt</surname><given-names>Ronny</given-names></name>
        <name><surname>Bruynooghe</surname><given-names>Floris</given-names></name>
        <name><surname>Laugher</surname><given-names>Brianna</given-names></name>
        <name><surname>Bruhin</surname><given-names>Florian</given-names></name>
      </person-group>
      <article-title>Pytest 7.4</article-title>
      <year iso-8601-date="2004">2004</year>
      <uri>https://github.com/pytest-dev/pytest</uri>
    </element-citation>
  </ref>
  <ref id="ref-Kluyver2016">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Kluyver</surname><given-names>Thomas</given-names></name>
        <name><surname>Ragan-Kelley</surname><given-names>Benjamin</given-names></name>
        <name><surname>Pérez</surname><given-names>Fernando</given-names></name>
        <name><surname>Granger</surname><given-names>Brian</given-names></name>
        <name><surname>Bussonnier</surname><given-names>Matthias</given-names></name>
        <name><surname>Frederic</surname><given-names>Jonathan</given-names></name>
        <name><surname>Kelley</surname><given-names>Kyle</given-names></name>
        <name><surname>Hamrick</surname><given-names>Jessica</given-names></name>
        <name><surname>Grout</surname><given-names>Jason</given-names></name>
        <name><surname>Corlay</surname><given-names>Sylvain</given-names></name>
        <name><surname>Ivanov</surname><given-names>Paul</given-names></name>
        <name><surname>Avila</surname><given-names>Damián</given-names></name>
        <name><surname>Abdalla</surname><given-names>Safia</given-names></name>
        <name><surname>Willing</surname><given-names>Carol</given-names></name>
        <name><surname>team</surname><given-names>Jupyter development</given-names></name>
      </person-group>
      <article-title>Jupyter notebooks – a publishing format for reproducible computational workflows</article-title>
      <source>Positioning and power in academic publishing: Players, agents and agendas</source>
      <person-group person-group-type="editor">
        <name><surname>Loizides</surname><given-names>Fernando</given-names></name>
        <name><surname>Scmidt</surname><given-names>Birgit</given-names></name>
      </person-group>
      <publisher-name>IOS Press</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <uri>https://eprints.soton.ac.uk/403913/</uri>
      <pub-id pub-id-type="doi">10.3233/978-1-61499-649-1-87</pub-id>
      <fpage>87</fpage>
      <lpage>90</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Perez2007">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Perez</surname><given-names>Fernando</given-names></name>
        <name><surname>Granger</surname><given-names>Brian E.</given-names></name>
      </person-group>
      <article-title>IPython: A System for Interactive Scientific Computing</article-title>
      <source>Computing in Science and Engineering</source>
      <year iso-8601-date="2007-01">2007</year><month>01</month>
      <volume>9</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1109/MCSE.2007.53</pub-id>
      <fpage>21</fpage>
      <lpage>29</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Vogelsberger2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vogelsberger</surname><given-names>Mark</given-names></name>
        <name><surname>Marinacci</surname><given-names>Federico</given-names></name>
        <name><surname>Torrey</surname><given-names>Paul</given-names></name>
        <name><surname>Puchwein</surname><given-names>Ewald</given-names></name>
      </person-group>
      <article-title>Cosmological simulations of galaxy formation</article-title>
      <source>Nature Reviews Physics</source>
      <year iso-8601-date="2020-01">2020</year><month>01</month>
      <volume>2</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1909.07976</uri>
      <pub-id pub-id-type="doi">10.1038/s42254-019-0127-2</pub-id>
      <fpage>42</fpage>
      <lpage>66</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Berlok2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Berlok</surname><given-names>Thomas</given-names></name>
      </person-group>
      <article-title>Hydromagnetic waves in an expanding universe - cosmological MHD code tests using analytic solutions</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="2022-09">2022</year><month>09</month>
      <volume>515</volume>
      <issue>3</issue>
      <uri>https://arxiv.org/abs/2203.11887</uri>
      <pub-id pub-id-type="doi">10.1093/mnras/stac1882</pub-id>
      <fpage>3492</fpage>
      <lpage>3511</lpage>
    </element-citation>
  </ref>
</ref-list>
<fn-group>
  <fn id="fn1">
    <label>1</label><p>See http://yt-project.org/.</p>
  </fn>
  <fn id="fn2">
    <label>2</label><p>See e.g. Pakmor &amp; Springel
    (<xref alt="2013" rid="ref-Pakmor2013" ref-type="bibr">2013</xref>)
    and Berlok
    (<xref alt="2022" rid="ref-Berlok2022" ref-type="bibr">2022</xref>)
    for detailed discussions and a derivation of the comoving
    magnetohydrodynamic equations used in cosmological simulations
    including magnetic fields.</p>
  </fn>
</fn-group>
</back>
</article>
