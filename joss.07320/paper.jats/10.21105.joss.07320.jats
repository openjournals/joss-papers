<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7320</article-id>
<article-id pub-id-type="doi">10.21105/joss.07320</article-id>
<title-group>
<article-title>sleev: An R Package for Semiparametric Likelihood
Estimation with Errors in Variables</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7481-765X</contrib-id>
<name>
<surname>Xiong</surname>
<given-names>Jiangmei</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5380-2427</contrib-id>
<name>
<surname>Lotspeich</surname>
<given-names>Sarah C.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0002-2741-0475</contrib-id>
<name>
<surname>Sherrill</surname>
<given-names>Joey B.</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2941-5360</contrib-id>
<name>
<surname>Amorim</surname>
<given-names>Gustavo</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3758-5992</contrib-id>
<name>
<surname>Shepherd</surname>
<given-names>Bryan E.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1106-2923</contrib-id>
<name>
<surname>Tao</surname>
<given-names>Ran</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Biostatistics, Vanderbilt University Medical
Center, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Department of Statistical Sciences, Wake Forest University,
USA</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Brigham Young University, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Vanderbilt Genetics Institute, Vanderbilt University
Medical Center, USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-04-24">
<day>24</day>
<month>4</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>112</issue>
<fpage>7320</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>measurement error</kwd>
<kwd>two-phase sampling</kwd>
<kwd>nonparametric statistics</kwd>
<kwd>B-splines</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Data with measurement error in the outcome, covariates, or both are
  not uncommon, particularly with the increased use of routinely
  collected data for biomedical research. With error-prone data, often
  only a subsample of study data is validated; such settings are known
  as two-phase studies. The sieve maximum likelihood estimator (SMLE),
  which combines the error-prone data on all records with the validated
  data on a subsample, is a highly efficient and robust method to
  analyze such data. However, given their complexity, a computationally
  efficient and user-friendly tool is needed to obtain the SMLEs. The R
  package <monospace>sleev</monospace> fills this gap by making
  semiparametric likelihood-based inference using the SMLEs for
  error-prone two-phase data in settings with binary and continuous
  outcomes. Functions from this package can be used to analyze data with
  error-prone binary or continuous responses and error-prone
  covariates.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Routinely collected data are being used frequently in biomedical
  research, such as electronic health records. However, these data tend
  to be error-prone, and using these data without correcting for their
  error-prone nature could lead to biased estimates and misleading
  research findings
  (<xref alt="Duan et al., 2016" rid="ref-duan2016empirical" ref-type="bibr">Duan
  et al., 2016</xref>). To avoid such invalid study results, trained
  experts carefully verify and extract data elements. However, it is
  usually only feasible to validate data for a subset of records or
  variables. After validation, researchers have error-prone,
  pre-validation data for all records (phase one) and error-free
  validated data on a subset of records (phase two). Analyses aim to
  combine the two types of data to obtain estimates that have low bias
  and are as robust and efficient as possible.</p>
  <p>There are several packages for
  <ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/">R</ext-link>
  (<xref alt="R Core Team, 2024" rid="ref-Rlanguage" ref-type="bibr">R
  Core Team, 2024</xref>) that address measurement error, including
  <monospace>augSIMEX</monospace>
  (<xref alt="Zhang &amp; Yi, 2019" rid="ref-augSIMEX" ref-type="bibr">Zhang
  &amp; Yi, 2019</xref>), <monospace>attenuation</monospace>
  (<xref alt="Moss, 2019" rid="ref-attenuation" ref-type="bibr">Moss,
  2019</xref>), <monospace>decon</monospace>
  (<xref alt="Wang &amp; Wang, 2011" rid="ref-decon" ref-type="bibr">Wang
  &amp; Wang, 2011</xref>), <monospace>eivtools</monospace>
  (<xref alt="Lockwood, 2018" rid="ref-eivtools" ref-type="bibr">Lockwood,
  2018</xref>), <monospace>GLSME</monospace>
  (<xref alt="Hansen &amp; Bartoszek, 2012" rid="ref-GLSME" ref-type="bibr">Hansen
  &amp; Bartoszek, 2012</xref>), <monospace>mecor</monospace>
  (<xref alt="Nab et al., 2021" rid="ref-mecor" ref-type="bibr">Nab et
  al., 2021</xref>), <monospace>meerva</monospace>
  (<xref alt="Kremers, 2021" rid="ref-meerva" ref-type="bibr">Kremers,
  2021</xref>), <monospace>mmc</monospace>
  (<xref alt="Song, 2015" rid="ref-mmc" ref-type="bibr">Song,
  2015</xref>), <monospace>refitME</monospace>
  (<xref alt="Stoklosa et al., 2021" rid="ref-refitME" ref-type="bibr">Stoklosa
  et al., 2021</xref>), and <monospace>simex</monospace>
  (<xref alt="Lederer &amp; Seibold, 2019" rid="ref-SIMEX" ref-type="bibr">Lederer
  &amp; Seibold, 2019</xref>). The various R packages reflect many
  different approaches, such as regression calibration
  (<xref alt="Wang &amp; Wang, 2011" rid="ref-decon" ref-type="bibr">Wang
  &amp; Wang, 2011</xref>), SIMEX (i.e., simulation-extrapolation)
  (<xref alt="Lederer &amp; Seibold, 2019" rid="ref-SIMEX" ref-type="bibr">Lederer
  &amp; Seibold, 2019</xref>), and moment-based corrections
  (<xref alt="Nab et al., 2021" rid="ref-mecor" ref-type="bibr">Nab et
  al., 2021</xref>), to mention a few. Nearly all of these existing R
  packages deal with errors in either the outcome or covariates, but not
  both, and none of these packages permits efficient inference that
  incorporates both the error-prone phase-one data and the validated
  phase-two data.</p>
  <p>The sieve maximum likelihood estimator (SMLE) is an estimator that
  analyzes two-phase data by combining the error-prone data on all
  records with the validated data on a subsample. By leveraging all
  available data, the SMLE operates with high efficiency
  (<xref alt="Lotspeich et al., 2022" rid="ref-lotspeich2022efficient" ref-type="bibr">Lotspeich
  et al., 2022</xref>;
  <xref alt="Tao et al., 2021" rid="ref-tao2021efficient" ref-type="bibr">Tao
  et al., 2021</xref>). Since it does not make any parametric
  assumptions on the error model, the SMLE is also robust. For example,
  Tao et al.
  (<xref alt="2021" rid="ref-tao2021efficient" ref-type="bibr">2021</xref>)
  performed a set of simulations highlighting the SMLEâ€™s robustness to
  different error mechanisms including settings where the errors had
  non-zero mean or were multiplicative. Moreover, the SMLE allows
  error-prone outcome and error-prone covariates in the same model.
  Still, in practice these estimators can be difficult to implement, as
  they involve approximating nuisance conditional densities using
  B-splines
  (<xref alt="Schumaker, 2007" rid="ref-schumaker2007spline" ref-type="bibr">Schumaker,
  2007</xref>) and then maximizing the semiparametric likelihood via a
  sophisticated EM algorithm
  (<xref alt="Tao et al., 2017" rid="ref-tao2017efficient" ref-type="bibr">Tao
  et al., 2017</xref>). Here, we present the R package
  <monospace>sleev</monospace>, which makes the SMLE readily applicable
  for practitioners in a user-friendly way. <monospace>sleev</monospace>
  integrates and extends primitive R packages,
  <monospace>logreg2ph</monospace> and
  <monospace>TwoPhaseReg</monospace>, developed with the original
  methods papers
  (<xref alt="Lotspeich et al., 2022" rid="ref-lotspeich2022efficient" ref-type="bibr">Lotspeich
  et al., 2022</xref>;
  <xref alt="Tao et al., 2021" rid="ref-tao2021efficient" ref-type="bibr">Tao
  et al., 2021</xref>). These two packages lacked proper documentation
  and were difficult to use. <monospace>logreg2ph</monospace> was also
  computationally slow.</p>
  <p>To promote the use of the SMLE, extensive work has been done to
  create <monospace>sleev</monospace>, a computationally efficient and
  user-friendly R package to analyze two-phase, error-prone data.
  Specifically, in <monospace>sleev</monospace> we rewrote the core
  algorithms of <monospace>logreg2ph</monospace> in C++ to speed up the
  computation, and we unified the syntax across functions. To compare
  the computational times, we set up simulations with the same code in
  the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/dragontaoran/sleev/blob/main/inst/article/sleev_vignette.pdf">package
  vignette</ext-link>. The simulations included phase-one and phase-two
  sample sizes of 2087 and 835, respectively, and were performed on a
  64-bit Linux OS machine with 8G memory. Across 100 simulations, the
  previous <monospace>logreg2ph</monospace> took an average of 289.44
  seconds with a standard deviation of 8.83 seconds to perform the
  analysis, while the corresponding new function in
  <monospace>sleev</monospace> only took an average of 122.32 seconds
  with a standard deviation of 8.18 seconds.</p>
</sec>
<sec id="smle-for-linear-regression">
  <title>SMLE for Linear Regression</title>
  <p>In this section, we briefly introduce the SMLE for linear
  regression. Suppose that we want to fit a standard linear regression
  model for a continuous outcome <inline-formula><alternatives>
  <tex-math><![CDATA[Y]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Y</mml:mi></mml:math></alternatives></inline-formula>
  and covariates <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{X}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ—</mml:mi></mml:math></alternatives></inline-formula>:
  <inline-formula><alternatives>
  <tex-math><![CDATA[Y = \alpha + \boldsymbol{\beta}^\mathrm{T}\pmb{X} + \epsilon]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mi>Î±</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mi>ğ›ƒ</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:mi>ğ—</mml:mi><mml:mo>+</mml:mo><mml:mi>Ïµ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\epsilon\sim N({0,\sigma}^{2})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ïµ</mml:mi><mml:mo>âˆ¼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>Ïƒ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  Our goal is to obtain estimates of <inline-formula><alternatives>
  <tex-math><![CDATA[{\pmb{\theta} = (\alpha,\boldsymbol{\beta}^\mathrm{T},\sigma^{2})}^\mathrm{T}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mrow><mml:mi>ğ›‰</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Î±</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>ğ›ƒ</mml:mi><mml:mi mathvariant="normal">T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>Ïƒ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:msup></mml:math></alternatives></inline-formula>.
  When we have error-prone data, <inline-formula><alternatives>
  <tex-math><![CDATA[Y]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Y</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{X}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ—</mml:mi></mml:math></alternatives></inline-formula>
  are unobserved except for a subset of validated records. For
  unvalidated records (the majority), only the error-prone outcome
  <inline-formula><alternatives>
  <tex-math><![CDATA[Y^{*} = Y + W]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>Y</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>Y</mml:mi><mml:mo>+</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  and covariates <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{X}^{*} = \pmb{X} + \pmb{U}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>ğ—</mml:mi><mml:mo>+</mml:mo><mml:mi>ğ”</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  are observed in place of <inline-formula><alternatives>
  <tex-math><![CDATA[Y]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Y</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{X}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ—</mml:mi></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[W]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{U}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ”</mml:mi></mml:math></alternatives></inline-formula>
  are the errors for the outcome and covariates, respectively. We assume
  that <inline-formula><alternatives>
  <tex-math><![CDATA[W]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{U}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ”</mml:mi></mml:math></alternatives></inline-formula>
  are independent of <inline-formula><alternatives>
  <tex-math><![CDATA[\epsilon]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ïµ</mml:mi></mml:math></alternatives></inline-formula>
  . With potential errors in our data, a naive regression analysis using
  error-prone variables <inline-formula><alternatives>
  <tex-math><![CDATA[Y^{*}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>Y</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{X}^{*}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula>
  could render misleading results
  (<xref alt="Fuller, 2009" rid="ref-fuller2009measurement" ref-type="bibr">Fuller,
  2009</xref>).</p>
  <p>We assume that the joint density of the complete data
  <inline-formula><alternatives>
  <tex-math><![CDATA[\left( Y^{*},\pmb{X}^{*},W,\pmb{U} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ”</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  takes the form</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[P\left( Y^{*},\pmb{X}^{*},\ W,\ \pmb{U} \right) = P\left( Y^{*}|\pmb{X}^{*},\ W,\ \pmb{U} \right)P\left( W,\ \pmb{U|}\pmb{X}^{*}\right)P\left( \pmb{X}^{*} \right)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mi>ğ”</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mi>ğ”</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mi>ğ”</mml:mi><mml:mo stretchy="false" form="prefix" mathvariant="bold">|</mml:mo></mml:mrow><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[= P_{\pmb{\theta}}\left( Y|X \right)P\left( W,\ \pmb{U}|\pmb{X}^{*} \right)P\left( \pmb{X}^{*} \right),]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>ğ›‰</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mi>ğ”</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[P( \cdot )]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>â‹…</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[P\left( \cdot | \cdot \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>â‹…</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mi>â‹…</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  denote density and conditional density functions, respectively.
  Specifically, <inline-formula><alternatives>
  <tex-math><![CDATA[P_{\pmb{\theta}}\left( Y|\pmb{X} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>ğ›‰</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:mi>ğ—</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  then refers to the conditional density function of the linear
  regression model of <inline-formula><alternatives>
  <tex-math><![CDATA[Y]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Y</mml:mi></mml:math></alternatives></inline-formula>
  given <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{X}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ—</mml:mi></mml:math></alternatives></inline-formula>.
  Denote the validation indicator variable by
  <inline-formula><alternatives>
  <tex-math><![CDATA[V]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>V</mml:mi></mml:math></alternatives></inline-formula>,
  with <inline-formula><alternatives>
  <tex-math><![CDATA[V = 1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  indicating that a record was validated and
  <inline-formula><alternatives>
  <tex-math><![CDATA[V = 0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  otherwise. For records with <inline-formula><alternatives>
  <tex-math><![CDATA[V = 0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  their measurement errors <inline-formula><alternatives>
  <tex-math><![CDATA[\left( W,\pmb{U} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ”</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  are missing, and therefore their contributions to the log-likelihood
  can be obtained by integrating out <inline-formula><alternatives>
  <tex-math><![CDATA[W]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{U}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ”</mml:mi></mml:math></alternatives></inline-formula>.</p>
  <p>Let <inline-formula><alternatives>
  <tex-math><![CDATA[\left( Y_{i}^{*},\pmb{X}_{i}^{*},W_{i},\pmb{U}_{i},V_{i},Y_{i},\pmb{X}_{i} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ”</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  for <inline-formula><alternatives>
  <tex-math><![CDATA[i = 1,\ldots,n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  denote independent and identically distributed realizations of
  <inline-formula><alternatives>
  <tex-math><![CDATA[\left( Y^{*},\pmb{X}^{*},W,\pmb{U},V,Y,\pmb{X} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>Y</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ”</mml:mi><mml:mo>,</mml:mo><mml:mi>V</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ—</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  in a sample of <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>
  subjects. Then, the observed-data log-likelihood is proportional
  to</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[\sum_{i = 1}^{n}{V_{i}\{\log P_{\pmb{\theta}}\left( Y_{i} \middle| \pmb{X}_{i} \right) + \log{P(W_{i},\pmb{U}_{i}|\pmb{X}_{i}^{*})\}}}]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>ğ›‰</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="infix">|</mml:mo><mml:msub><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo>log</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ”</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[+ \sum_{i = 1}^{n}{\left( 1 - V_{i} \right)\log\left\{ \int\int P_{\pmb{\theta}}\left( Y_{i}^{*} - w|\pmb{X}_{i}^{*} - \pmb{u} \right)P\left( w,\pmb{u} \middle| \pmb{X}_{i}^{*} \right)dwd\pmb{u} \right\}},\ \ \ \ \ \ \ \ (1)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>+</mml:mi><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>âˆ’</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:mo>âˆ«</mml:mo><mml:mo>âˆ«</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>ğ›‰</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>âˆ’</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>âˆ’</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="infix">|</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>w</mml:mi><mml:mi>d</mml:mi><mml:mi>ğ®</mml:mi><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[P(\pmb{X}^*)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is left out, because the error-prone covariates are fully observed and
  thus <inline-formula><alternatives>
  <tex-math><![CDATA[P(\pmb{X}^*)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msup><mml:mi>ğ—</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  can simply be estimated empirically. We estimate the unknown
  measurement error model, <inline-formula><alternatives>
  <tex-math><![CDATA[P\left( W_{i},\pmb{U}_{i}|\pmb{X}_{i}^{*} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ”</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  using B-spline sieves. Specifically, we approximate
  <inline-formula><alternatives>
  <tex-math><![CDATA[P\left( w,\pmb{u}|\pmb{X}_{i}^{*} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\log P\left( W_{i},\pmb{U}_{i}|\pmb{X}_{i}^{*} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>log</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ”</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  by <inline-formula><alternatives>
  <tex-math><![CDATA[\sum_{k = 1}^{m}\mathrm{I}\left( w = w_{k},\pmb{u} = \pmb{u}_{k} \right)\sum_{j = 1}^{s_{n}}B_{j}^{q}\left( \pmb{X}_{i}^{*} \right)p_{kj}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>ğ®</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\sum_{k = 1}^{m}\mathrm{I}\left( W_{i} = w_{k},\pmb{U}_{i} = \pmb{u}_{k} \right)\sum_{j = 1}^{s_{n}}B_{j}^{q}\left( \pmb{X}_{i}^{*} \right)\log p_{kj}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ”</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:msubsup><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
  respectively. Here, <inline-formula><alternatives>
  <tex-math><![CDATA[\{ \left( w_{1},\pmb{u}_{1} \right),...,]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ®</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mi>.</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  <inline-formula><alternatives>
  <tex-math><![CDATA[\left( w_{m},\pmb{u}_{m} \right) \}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  are the <inline-formula><alternatives>
  <tex-math><![CDATA[m]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>m</mml:mi></mml:math></alternatives></inline-formula>
  distinct observed <inline-formula><alternatives>
  <tex-math><![CDATA[\left( W,\pmb{U} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>W</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ”</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  values from the validation study, <inline-formula><alternatives>
  <tex-math><![CDATA[B_{j}^{q}\left( \pmb{X}_{i}^{*} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is the <inline-formula><alternatives>
  <tex-math><![CDATA[j]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>th
  B-spline basis function of order <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>
  evaluated at <inline-formula><alternatives>
  <tex-math><![CDATA[\pmb{X}_{i}^{*}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>,
  <inline-formula><alternatives>
  <tex-math><![CDATA[s_{n}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the dimension of the B-spline basis, and
  <inline-formula><alternatives>
  <tex-math><![CDATA[p_{kj}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  is the coefficient associated with <inline-formula><alternatives>
  <tex-math><![CDATA[B_{j}^{q}\left( \pmb{X}_{i}^{*} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\left( w_{k},\pmb{u}_{k} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.
  The expression (1) is now approximated by</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[\sum_{i = 1}^{n}V_{i}\left[\log P_{\pmb{\theta}}\left(Y_{i} \middle| \pmb{X}_{i} \right) +\sum_{k = 1}^{m}\left\{{\mathrm{I}(W_{i}=w_{k},\pmb{U}_{i}= \pmb{u}_{k})\sum_{j=1}^{s_{n}}{B_{j}^{q}(\pmb{X}_{i}^{*})}}\log{p_{kj}}\right\}\right]]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mo>log</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>ğ›‰</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="infix">|</mml:mo><mml:msub><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:mrow><mml:mi mathvariant="normal">I</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>ğ”</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:munderover><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>log</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[+ \sum_{i = 1}^{n}\log{\left[\sum_{k = 1}^{m}\left\{P_{\pmb{\theta}}\left( Y_{i}^{*} - w_{k}|\pmb{X}_{i}^{*} - \pmb{u}_{k} \right)\sum_{j = 1}^{s_{n}}B_{j}^{q}(\pmb{X}_{i}^{*})\log{p_{kj}}\right\}\right]}. \ \ \ \ \ \ \ \ (2)]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>+</mml:mi><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mo>log</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy="true" form="prefix">{</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>ğ›‰</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>âˆ’</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false" form="prefix">|</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>âˆ’</mml:mo><mml:msub><mml:mi>ğ®</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:munderover><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:munderover><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>log</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">}</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mi>.</mml:mi><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mspace width="0.222em"></mml:mspace><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>The maximization of expression (2) is carried out through an EM
  algorithm to find the SMLEs <inline-formula><alternatives>
  <tex-math><![CDATA[\widehat{\pmb{\theta}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>ğ›‰</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[{\widehat{p}}_{kj}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mover><mml:mi>p</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.
  The covariance matrix of the SMLE <inline-formula><alternatives>
  <tex-math><![CDATA[\widehat{\pmb{\theta}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>ğ›‰</mml:mi><mml:mo accent="true">Ì‚</mml:mo></mml:mover></mml:math></alternatives></inline-formula>
  is obtained through the method of profile likelihood
  (<xref alt="Murphy &amp; Van der Vaart, 2000" rid="ref-murphy2000profile" ref-type="bibr">Murphy
  &amp; Van der Vaart, 2000</xref>).</p>
  <p>The SMLEs for logistic regression are similar to linear regression
  and described in the
  <ext-link ext-link-type="uri" xlink:href="https://github.com/dragontaoran/sleev/blob/main/inst/article/sleev_vignette.pdf">package
  vignette</ext-link>, and the theoretical properties can be found in
  Lotspeich et al.
  (<xref alt="2022" rid="ref-lotspeich2022efficient" ref-type="bibr">2022</xref>).</p>
</sec>
<sec id="functionalities-of-the-sleev-r-package">
  <title>Functionalities of the <monospace>sleev</monospace> R
  Package</title>
  <p>The <monospace>sleev</monospace> package provides a user-friendly
  way to obtain the SMLEs and their standard errors. The package can be
  installed from
  <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/sleev/index.html">CRAN</ext-link>
  or
  <ext-link ext-link-type="uri" xlink:href="https://github.com/dragontaoran/sleev">GitHub</ext-link>.
  The <monospace>sleev</monospace> package includes two main functions:
  <monospace>linear2ph()</monospace> and
  <monospace>logistic2ph()</monospace>, to fit linear and logistic
  regressions, respectively, under two-phase sampling with an
  error-prone outcome and covariates. The input arguments are similar
  for the two functions and listed in Table 1. In addition to the
  arguments for error-prone and error-free outcome and covariates, the
  user needs to specify the B-spline matrix
  <inline-formula><alternatives>
  <tex-math><![CDATA[B_{j}^{q}\left( \pmb{X}_{i}^{*} \right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>B</mml:mi><mml:mi>j</mml:mi><mml:mi>q</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msubsup><mml:mi>ğ—</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  to be used in the estimation of the error densities.</p>
  <sec id="table-1-main-arguments-for-the-linear2ph-and-logistic2ph-functions">
    <title>Table 1: Main arguments for the
    <monospace>linear2ph()</monospace> and
    <monospace>logistic2ph()</monospace> functions</title>
    <table-wrap>
      <table>
        <colgroup>
          <col width="16%" />
          <col width="84%" />
        </colgroup>
        <thead>
          <tr>
            <th align="left">Argument</th>
            <th align="left">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">y_unval</td>
            <td align="left">Column name of unvalidated outcome in the
            input dataset.</td>
          </tr>
          <tr>
            <td align="left">y</td>
            <td align="left">Column name of validated outcome in the
            input dataset. <monospace>NA</monospace>s in the input will
            be counted as individuals not selected in phase two.</td>
          </tr>
          <tr>
            <td align="left">x_unval</td>
            <td align="left">Column names of unvalidated covariates in
            the input dataset.</td>
          </tr>
          <tr>
            <td align="left">x</td>
            <td align="left">Column names of validated covariates in the
            input dataset. <monospace>NA</monospace>s in the input will
            be counted as individuals not selected in phase two.</td>
          </tr>
          <tr>
            <td align="left">z</td>
            <td align="left">Column names of error-free covariates in
            the input dataset.</td>
          </tr>
          <tr>
            <td align="left">data</td>
            <td align="left">Dataset generated from
            <monospace>sleev::spline2ph()</monospace>.</td>
          </tr>
          <tr>
            <td align="left">hn_scale</td>
            <td align="left">Scale of the perturbation constant in the
            variance estimation via the method of profile likelihood.
            The default is <monospace>1</monospace>.</td>
          </tr>
          <tr>
            <td align="left">se</td>
            <td align="left">Standard errors of the parameter estimators
            will be estimated when set to <monospace>TRUE</monospace>.
            The default is <monospace>TRUE</monospace>.</td>
          </tr>
          <tr>
            <td align="left">tol</td>
            <td align="left">Convergence criterion. The default is
            <monospace>0.0001</monospace>.</td>
          </tr>
          <tr>
            <td align="left">max_iter</td>
            <td align="left">Maximum number of iterations in the EM
            algorithm. The default is <monospace>1000</monospace>.</td>
          </tr>
          <tr>
            <td align="left">verbose</td>
            <td align="left">Print analysis details when set to
            <monospace>TRUE</monospace>. The default is
            <monospace>FALSE</monospace>.</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
</sec>
<sec id="example-case-study-with-mock-data">
  <title>Example: Case study with mock data</title>
  <p>For demonstration, the <monospace>sleev</monospace> package
  includes a dataset constructed to mimic data from the Vanderbilt
  Comprehensive Care Clinic (VCCC) patient records from Giganti et al.
  (<xref alt="2020" rid="ref-giganti2020accounting" ref-type="bibr">2020</xref>).
  Table 2 describes the variables in this dataset.</p>
  <sec id="table-2-data-dictionary-for-mock.vccc">
    <title>Table 2: Data dictionary for
    <monospace>mock.vccc</monospace></title>
    <table-wrap>
      <table>
        <colgroup>
          <col width="14%" />
          <col width="14%" />
          <col width="13%" />
          <col width="58%" />
        </colgroup>
        <thead>
          <tr>
            <th align="left">Name</th>
            <th align="left">Status</th>
            <th align="left">Type</th>
            <th align="left">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">ID</td>
            <td align="left">error-free</td>
            <td align="left"></td>
            <td align="left">Patient ID</td>
          </tr>
          <tr>
            <td align="left">VL_unval</td>
            <td align="left">error-prone</td>
            <td align="left">continuous</td>
            <td align="left">Viral load (VL) at antiretroviral therapy
            (ART)</td>
          </tr>
          <tr>
            <td align="left">VL_val</td>
            <td align="left">validated</td>
            <td align="left">continuous</td>
            <td align="left">initiation</td>
          </tr>
          <tr>
            <td align="left">ADE_unval</td>
            <td align="left">error-prone</td>
            <td align="left">binary</td>
            <td align="left">Had an AIDS-defining event (ADE) within
            one</td>
          </tr>
          <tr>
            <td align="left">ADE_val</td>
            <td align="left">validated</td>
            <td align="left">binary</td>
            <td align="left">year of ART initiation: 1 - yes, 0 â€“
            no</td>
          </tr>
          <tr>
            <td align="left">CD4_unval</td>
            <td align="left">error-prone</td>
            <td align="left">continuous</td>
            <td align="left">CD4 count at ART initiation</td>
          </tr>
          <tr>
            <td align="left">CD4_val</td>
            <td align="left">validated</td>
            <td align="left">continuous</td>
            <td align="left"></td>
          </tr>
          <tr>
            <td align="left">Prior_ART</td>
            <td align="left">error-free</td>
            <td align="left">binary</td>
            <td align="left">Experienced ART before enrollment: 1 - yes,
            0 - no</td>
          </tr>
          <tr>
            <td align="left">Sex</td>
            <td align="left">error-free</td>
            <td align="left">binary</td>
            <td align="left">Sex at birth of patient: 1 - male, 0 -
            female</td>
          </tr>
          <tr>
            <td align="left">Age</td>
            <td align="left">error-free</td>
            <td align="left">continuous</td>
            <td align="left">Age of patient</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>We now illustrate how to obtain the SMLEs using the
    <monospace>sleev</monospace> package with the
    <monospace>mock.vccc</monospace> dataset. Specifically, we show how
    to fit a linear regression model in the presence of errors in both
    the outcome and covariates using the
    <monospace>linear2ph()</monospace> function. Situations with more
    covariates and examples with logistic regression are included in the
    <ext-link ext-link-type="uri" xlink:href="https://github.com/dragontaoran/sleev/blob/main/inst/article/sleev_vignette.pdf">package
    vignette</ext-link>.</p>
    <p>This example fits a linear regression model with CD4 count at
    antiretroviral therapy (ART) initiation regressed on viral load (VL)
    at ART initiation, adjusting for sex at birth. Both CD4 and VL are
    error-prone, partially validated variables, whereas sex is
    error-free. Because of skewness, we often transform both CD4 and VL.
    In our analysis, CD4 was divided by 10 and square root transformed,
    and VL was <inline-formula><alternatives>
    <tex-math><![CDATA[\log_{10}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
    transformed:</p>
    <code language="r script">library(&quot;sleev&quot;)
data(&quot;mock.vccc&quot;)
mock.vccc$CD4_val_sq10 &lt;- sqrt(mock.vccc$CD4_val / 10)
mock.vccc$CD4_unval_sq10 &lt;- sqrt(mock.vccc$CD4_unval / 10)
mock.vccc$VL_val_l10 &lt;- log10(mock.vccc$VL_val)
mock.vccc$VL_unval_l10 &lt;- log10(mock.vccc$VL_unval)</code>
    <p>To obtain the SMLEs, we first need to set up the B-spline basis
    for the error-prone covariate <monospace>VL_unval_l10</monospace>
    (the transformed VL variable from phase one) and
    <monospace>Sex</monospace>. The <monospace>spline2ph()</monospace>
    function in the <monospace>sleev</monospace> package can set up the
    B-spline basis, and combine it with the input data for the final
    analysis. Here, we use a cubic B-spline basis with the
    <monospace>degree = 3</monospace> argument. The size of the basis
    <inline-formula><alternatives>
    <tex-math><![CDATA[s_{n}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>s</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is set to be 20, specified through the
    <monospace>size = 20</monospace> argument. More details regarding
    order and size selection, as well as run time comparison of B-spline
    basis, are discussed in the
    <ext-link ext-link-type="uri" xlink:href="https://github.com/dragontaoran/sleev/blob/main/inst/article/sleev_vignette.pdf">package
    vignette</ext-link>. To allow possible heterogeneity in error
    distribution between males and females, we can set up B-spline basis
    separately and proportionally for the two <monospace>Sex</monospace>
    groups by specifying argument
    <monospace>group = &quot;Sex&quot;</monospace>. The described
    B-spline basis is constructed as follows.</p>
    <code language="r script">sn &lt;- 20
data.linear &lt;- spline2ph(x = &quot;VL_unval_l10&quot;, data = mock.vccc, size = sn,
                         degree = 3, group = &quot;Sex&quot;)</code>
    <p>Alternatively, if the investigator has prior knowledge that the
    errors in <monospace>VL_unval_l10</monospace> are likely to be
    homogeneous, one may fit a simpler model by not stratifying the
    B-spline basis by <monospace>Sex</monospace>.</p>
    <p>Having constructed the B-spline basis, the SMLEs can be obtained
    by running the <monospace>linear2ph()</monospace> function on
    <monospace>data.linear</monospace>, as shown in the code below.
    Again, the inputs are explained in Table 1. The fitted SMLEs are
    stored in a list object of class <monospace>linear2ph</monospace>.
    Here, we assign the fitted SMLEs to the variable name
    <monospace>res_linear</monospace>. The list of class
    <monospace>linear2ph</monospace> contains five components:
    <monospace>coefficient</monospace>,
    <monospace>covariance</monospace>, <monospace>sigma</monospace>,
    <monospace>converge</monospace>, and
    <monospace>converge_cov</monospace>.</p>
    <code language="r script">res_linear &lt;- linear2ph(y_unval = &quot;CD4_unval_sq10&quot;, y = &quot;CD4_val_sq10&quot;,
                        x_unval = &quot;VL_unval_l10&quot;, x = &quot;VL_val_l10&quot;, 
                        z = &quot;Sex&quot;, data = data.linear,
                        hn_scale = 1, se = TRUE, tol = 1e-04, 
                        max_iter = 1000, verbose = FALSE)</code>
    <p>We should first check if the EM algorithms for estimating the
    regression coefficients and their covariance matrix converged by
    using the <monospace>print()</monospace> for class
    <monospace>linear2ph</monospace> directly.</p>
    <code language="r script">&gt; res_linear

Call:
linear2ph(y_unval = &quot;CD4_unval_sq10&quot;, y = &quot;CD4_val_sq10&quot;,
          x_unval = &quot;VL_unval_l10&quot;, x = &quot;VL_val_l10&quot;, z = &quot;Sex&quot;, 
          data = data.linear, hn_scale = 1, se = TRUE, 
          tol = 1e-04, max_iter = 1000, verbose = FALSE)

The parameter estimation has converged.

Coefficients:
 Intercept VL_val_l10        Sex 
 4.8209166 -0.1413168  0.2727984 </code>
    <p>The <monospace>summary()</monospace> function for the object of
    class <monospace>linear2ph</monospace> returns the estimated
    coefficients, their standard errors, test statistics, and
    <inline-formula><alternatives>
    <tex-math><![CDATA[p]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>p</mml:mi></mml:math></alternatives></inline-formula>-values
    as follows:</p>
    <code language="r script">&gt; summary(res_linear)

Call:
linear2ph(y_unval = &quot;CD4_unval_sq10&quot;, y = &quot;CD4_val_sq10&quot;,
          x_unval = &quot;VL_unval_l10&quot;, x = &quot;VL_val_l10&quot;, z = &quot;Sex&quot;, 
          data = data.linear, hn_scale = 1, se = TRUE, 
          tol = 1e-04, max_iter = 1000, verbose = FALSE)

Coefficients:
             Estimate         SE Statistic      p-value
Intercept   4.8209166 0.15865204 30.386729 0.0000000000
VL_val_l10 -0.1413168 0.03983406 -3.547636 0.0003887047
Sex         0.2727984 0.10888178  2.505455 0.0122294098</code>
  </sec>
</sec>
<sec id="acknowledgement">
  <title>Acknowledgement</title>
  <p>This research was supported by the National Institute of Health
  grants R01AI131771, R01HL094786, and P30AI110527 and the 2022
  Biostatistics Faculty Development Award from the Department of
  Biostatistics at Vanderbilt University Medical Center. This work
  leveraged the resources provided by the Vanderbilt Advanced Computing
  Center for Research and Education (ACCRE), a collaboratory operated by
  and for Vanderbilt faculty.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-duan2016empirical">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Duan</surname><given-names>Rui</given-names></name>
        <name><surname>Cao</surname><given-names>Ming</given-names></name>
        <name><surname>Wu</surname><given-names>Yonghui</given-names></name>
        <name><surname>Huang</surname><given-names>Jing</given-names></name>
        <name><surname>Denny</surname><given-names>Joshua C</given-names></name>
        <name><surname>Xu</surname><given-names>Hua</given-names></name>
        <name><surname>Chen</surname><given-names>Yong</given-names></name>
      </person-group>
      <article-title>An empirical study for impacts of measurement errors on EHR based association studies</article-title>
      <source>AMIA annual symposium proceedings</source>
      <publisher-name>American Medical Informatics Association</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>2016</volume>
      <fpage>1764</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-tao2021efficient">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tao</surname><given-names>Ran</given-names></name>
        <name><surname>Lotspeich</surname><given-names>Sarah C</given-names></name>
        <name><surname>Amorim</surname><given-names>Gustavo</given-names></name>
        <name><surname>Shaw</surname><given-names>Pamela A</given-names></name>
        <name><surname>Shepherd</surname><given-names>Bryan E</given-names></name>
      </person-group>
      <article-title>Efficient semiparametric inference for two-phase studies with outcome and covariate measurement errors</article-title>
      <source>Statistics in medicine</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>40</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1002/sim.8799</pub-id>
      <fpage>725</fpage>
      <lpage>738</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lotspeich2022efficient">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lotspeich</surname><given-names>Sarah C</given-names></name>
        <name><surname>Shepherd</surname><given-names>Bryan E</given-names></name>
        <name><surname>Amorim</surname><given-names>Gustavo GC</given-names></name>
        <name><surname>Shaw</surname><given-names>Pamela A</given-names></name>
        <name><surname>Tao</surname><given-names>Ran</given-names></name>
      </person-group>
      <article-title>Efficient odds ratio estimation under two-phase sampling using error-prone data from a multi-national HIV research cohort</article-title>
      <source>Biometrics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>78</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1111/biom.13512</pub-id>
      <fpage>1674</fpage>
      <lpage>1685</lpage>
    </element-citation>
  </ref>
  <ref id="ref-schumaker2007spline">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Schumaker</surname><given-names>Larry</given-names></name>
      </person-group>
      <source>Spline functions: Basic theory</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2007">2007</year>
      <pub-id pub-id-type="doi">10.1017/CBO9780511618994</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-tao2017efficient">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tao</surname><given-names>Ran</given-names></name>
        <name><surname>Zeng</surname><given-names>Donglin</given-names></name>
        <name><surname>Lin</surname><given-names>Dan Yu</given-names></name>
      </person-group>
      <article-title>Efficient semiparametric inference under two-phase sampling, with applications to genetic association studies</article-title>
      <source>Journal of the American Statistical Association</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>112</volume>
      <issue>520</issue>
      <pub-id pub-id-type="doi">10.1080/01621459.2017.1295864</pub-id>
      <fpage>1468</fpage>
      <lpage>1476</lpage>
    </element-citation>
  </ref>
  <ref id="ref-murphy2000profile">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Murphy</surname><given-names>Susan A</given-names></name>
        <name><surname>Van der Vaart</surname><given-names>Aad W</given-names></name>
      </person-group>
      <article-title>On profile likelihood</article-title>
      <source>Journal of the American Statistical Association</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2000">2000</year>
      <volume>95</volume>
      <issue>450</issue>
      <pub-id pub-id-type="doi">10.2307/2669386</pub-id>
      <fpage>449</fpage>
      <lpage>465</lpage>
    </element-citation>
  </ref>
  <ref id="ref-giganti2020accounting">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Giganti</surname><given-names>Mark J</given-names></name>
        <name><surname>Shaw</surname><given-names>Pamela A</given-names></name>
        <name><surname>Chen</surname><given-names>Guanhua</given-names></name>
        <name><surname>Bebawy</surname><given-names>Sally S</given-names></name>
        <name><surname>Turner</surname><given-names>Megan M</given-names></name>
        <name><surname>Sterling</surname><given-names>Timothy R</given-names></name>
        <name><surname>Shepherd</surname><given-names>Bryan E</given-names></name>
      </person-group>
      <article-title>Accounting for dependent errors in predictors and time-to-event outcomes using electronic health records, validation samples, and multiple imputation</article-title>
      <source>The annals of applied statistics</source>
      <publisher-name>NIH Public Access</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>14</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1214/20-aoas1343</pub-id>
      <fpage>1045</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-decon">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wang</surname><given-names>Xiao Feng</given-names></name>
        <name><surname>Wang</surname><given-names>Bin</given-names></name>
      </person-group>
      <article-title>Deconvolution estimation in measurement error models: The R package decon</article-title>
      <source>Journal of statistical software</source>
      <year iso-8601-date="2011">2011</year>
      <volume>39</volume>
      <pub-id pub-id-type="doi">10.18637/jss.v039.i10</pub-id>
      <fpage>1</fpage>
      <lpage>24</lpage>
    </element-citation>
  </ref>
  <ref id="ref-mecor">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nab</surname><given-names>Linda</given-names></name>
        <name><surname>Smeden</surname><given-names>Maarten van</given-names></name>
        <name><surname>Keogh</surname><given-names>Ruth H</given-names></name>
        <name><surname>Groenwold</surname><given-names>Rolf HH</given-names></name>
      </person-group>
      <article-title>Mecor: An R package for measurement error correction in linear regression models with a continuous outcome</article-title>
      <source>Computer methods and programs in biomedicine</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>208</volume>
      <pub-id pub-id-type="doi">10.1016/j.cmpb.2021.106238</pub-id>
      <fpage>106238</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-SIMEX">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Lederer</surname><given-names>Wolfgang</given-names></name>
        <name><surname>Seibold</surname><given-names>Heidi</given-names></name>
      </person-group>
      <source>Simex: SIMEX- and MCSIMEX-algorithm for measurement error models</source>
      <year iso-8601-date="2019">2019</year>
      <uri>https://CRAN.R-project.org/package=simex</uri>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.simex</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Rlanguage">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>R Core Team</string-name>
      </person-group>
      <source>R: A language and environment for statistical computing</source>
      <publisher-name>R Foundation for Statistical Computing</publisher-name>
      <publisher-loc>Vienna, Austria</publisher-loc>
      <year iso-8601-date="2024">2024</year>
      <uri>https://www.R-project.org/</uri>
      <pub-id pub-id-type="doi">10.32614/r.manuals</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-augSIMEX">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhang</surname><given-names>Qihuang</given-names></name>
        <name><surname>Yi</surname><given-names>Grace Y</given-names></name>
      </person-group>
      <article-title>R package for analysis of data with mixed measurement error and misclassification in covariates: augSIMEX</article-title>
      <source>Journal of Statistical Computation and Simulation</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>89</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1080/00949655.2019.1615911</pub-id>
      <fpage>2293</fpage>
      <lpage>2315</lpage>
    </element-citation>
  </ref>
  <ref id="ref-attenuation">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Moss</surname><given-names>Jonas</given-names></name>
      </person-group>
      <source>Attenuation: Correcting for attenuation due to measurement error</source>
      <year iso-8601-date="2019">2019</year>
      <uri>https://CRAN.R-project.org/package=attenuation</uri>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.attenuation</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-GLSME">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hansen</surname><given-names>Thomas F.</given-names></name>
        <name><surname>Bartoszek</surname><given-names>Krzysztof</given-names></name>
      </person-group>
      <article-title>Interpreting the evolutionary regression: The interplay between observational and biological errors in phylogenetic comparative studies</article-title>
      <source>Systematic Biology</source>
      <year iso-8601-date="2012">2012</year>
      <volume>61</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1093/sysbio/syr122</pub-id>
      <fpage>413</fpage>
      <lpage>425</lpage>
    </element-citation>
  </ref>
  <ref id="ref-meerva">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Kremers</surname><given-names>Walter K</given-names></name>
      </person-group>
      <source>meerva: Analysis of data with measurement error using a validation subsample</source>
      <year iso-8601-date="2021">2021</year>
      <uri>https://CRAN.R-project.org/package=meerva</uri>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.meerva</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-mmc">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Song</surname><given-names>Jaejoon</given-names></name>
      </person-group>
      <source>mmc: Multivariate measurement error correction</source>
      <year iso-8601-date="2015">2015</year>
      <uri>https://CRAN.R-project.org/package=mmc</uri>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.mmc</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-refitME">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Stoklosa</surname><given-names>Jakub</given-names></name>
        <name><surname>Hwang</surname><given-names>Wenhan</given-names></name>
        <name><surname>Warton</surname><given-names>David</given-names></name>
      </person-group>
      <source>refitME: Measurement error modelling using MCEM</source>
      <year iso-8601-date="2021">2021</year>
      <uri>https://CRAN.R-project.org/package=refitME</uri>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.refitME</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-eivtools">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Lockwood</surname><given-names>J. R.</given-names></name>
      </person-group>
      <source>eivtools: Measurement error modeling tools</source>
      <year iso-8601-date="2018">2018</year>
      <uri>https://cran.r-project.org/web/packages/eivtools/</uri>
      <pub-id pub-id-type="doi">10.32614/CRAN.package.eivtools</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-fuller2009measurement">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Fuller</surname><given-names>Wayne A</given-names></name>
      </person-group>
      <source>Measurement error models</source>
      <publisher-name>John Wiley &amp; Sons</publisher-name>
      <year iso-8601-date="2009">2009</year>
      <pub-id pub-id-type="doi">10.1002/9780470316665</pub-id>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
