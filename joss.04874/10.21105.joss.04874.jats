<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">4874</article-id>
<article-id pub-id-type="doi">10.21105/joss.04874</article-id>
<title-group>
<article-title>ThermoCodegen: a python/C++ package for the generation of
custom thermodynamic models</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5218-7466</contrib-id>
<name>
<surname>Spiegelman</surname>
<given-names>Marc</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Evans</surname>
<given-names>Owen</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0489-0018</contrib-id>
<name>
<surname>Ghiorso</surname>
<given-names>Mark</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0009-4506-2110</contrib-id>
<name>
<surname>Tweed</surname>
<given-names>Lucy</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4083-6529</contrib-id>
<name>
<surname>Wilson</surname>
<given-names>Cian</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Dept. of Applied Physics and Applied Math, Columbia
University</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Dept. of Earth and Environmental Science, Columbia
University</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Now at Google</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>OFM Research</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Earth and Planets Laboratory, Carnegie Institution for
Science</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2022-03-23">
<day>23</day>
<month>3</month>
<year>2022</year>
</pub-date>
<volume>8</volume>
<issue>86</issue>
<fpage>4874</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python/C++</kwd>
<kwd>computational thermodynamics</kwd>
<kwd>geodynamics</kwd>
<kwd>geochemistry</kwd>
<kwd></kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Many important problems in solid-Earth science require a consistent
  coupling between thermodynamics and geodynamics. Examples include
  global mantle convection with thermodynamically consistent phase
  changes, the generation and flow of magma in the mantle, reactive
  fluid flow and geological carbon sequestration in the crust and even
  the coupled flow of water and ice in glaciers and ice sheets. Given
  the complexity of these systems, it is important that the individual
  user/scientist have considerable control over the formulation and
  computational choices involved for both the thermodynamic and
  geodynamic components of models while maintaining transparency and
  reproducibility. Access to flexible open-source software for the
  creation and exploration of thermodynamic models and their
  incorporation into large scale reactive flow simulations is essential
  for these endeavors.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>ThermoCodegen is a software package for the reproducible generation
  of custom thermodynamic and kinetic reaction models for minerals,
  melts and some aqueous fluids commonly encountered in the solid-Earth
  sciences. It is part of the larger
  <ext-link ext-link-type="uri" xlink:href="http://enki-portal.org">ENKI</ext-link>
  project for thermodynamic modeling whose flagship code
  <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/ENKI-portal/ThermoEngine">ThermoEngine</ext-link>
  (<xref alt="Ghiorso &amp; Wolf, 2019" rid="ref-ghiorso_thermodynamic_2019" ref-type="bibr">Ghiorso
  &amp; Wolf, 2019</xref>;
  <xref alt="Wolf &amp; Ghiorso, 2019" rid="ref-wolf_thermodynamic_2019" ref-type="bibr">Wolf
  &amp; Ghiorso, 2019</xref>) provides a
  <ext-link ext-link-type="uri" xlink:href="https://jupyter.org/hub">JupyterHub</ext-link>,
  cloud-based environment for the interactive generation and exploration
  of thermodynamic models in Earth sciences. In particular, ThermoEngine
  provides a critical code-generation module,
  <monospace>coder.py</monospace> for generating high-performance C code
  from
  <ext-link ext-link-type="uri" xlink:href="https://www.sympy.org">SymPy</ext-link>
  expressions for the free energies of thermodynamic endmembers and
  phases.</p>
  <p>ThermoCodegen shares the same underlying code-generation
  infrastructure as ThermoEngine however its design is driven more by
  the need for ready incorporation of thermodynamics into large scale
  geodynamics simulation codes for both equilibrium and disequilibrium
  transport.
  Key additional features of ThermoCodegen include:</p>
  <list list-type="bullet">
    <list-item>
      <p><italic>Portable model storage</italic>: Thermodynamic model
      generation for endmembers and phases are described in detailed
      <ext-link ext-link-type="uri" xlink:href="https://jupyter.org">Jupyter</ext-link>
      notebooks using coder.py and
      <ext-link ext-link-type="uri" xlink:href="https://www.sympy.org">SymPy</ext-link>,
      however, the final models are stored in structured xml files that
      contain all the information required to describe and auto-generate
      code for thermodynamic databases of endmembers and phases.</p>
    </list-item>
    <list-item>
      <p><italic>Kinetic modeling</italic>: ThermoCodegen also provides
      code generation and storage of custom kinetic reaction models
      built on the phase databases.</p>
    </list-item>
    <list-item>
      <p><italic>C++ support</italic>: The code also generates C++
      libraries for inclusion in other modeling systems such as
      <ext-link ext-link-type="uri" xlink:href="https://terraferma.github.io">TerraFERMA</ext-link>
      (<xref alt="Wilson et al., 2017" rid="ref-wilson_terrafermaU003A_2017" ref-type="bibr">Wilson
      et al., 2017</xref>;
      <xref alt="Wilson &amp; Spiegelman, 2015" rid="ref-wilson_softwareU003A_2015" ref-type="bibr">Wilson
      &amp; Spiegelman, 2015</xref>) or
      <ext-link ext-link-type="uri" xlink:href="https://aspect.geodynamics.org">ASPECT</ext-link>
      (<xref alt="Bangerth et al., 2021" rid="ref-bangerth_aspect_2021" ref-type="bibr">Bangerth
      et al., 2021</xref>;
      <xref alt="Heister et al., 2017" rid="ref-heister_high_2017" ref-type="bibr">Heister
      et al., 2017</xref>;
      <xref alt="Kronbichler et al., 2012" rid="ref-kronbichler_high_2012" ref-type="bibr">Kronbichler
      et al., 2012</xref>).</p>
    </list-item>
    <list-item>
      <p><italic>Python bindings</italic>: Python bindings of the C++
      classes are generated using pybind11
      (<xref alt="Wenkel et al., 2017" rid="ref-wenkel_pybind11_2017" ref-type="bibr">Wenkel
      et al., 2017</xref>) for direct import into python
      applications.</p>
    </list-item>
    <list-item>
      <p><italic>ThermoEngine support</italic>: Python bindings of
      ThermoCodegen objects can also be imported back into ThermoEngine
      as a custom database for use in equilibration or calibration
      calculations (requires installing the
      <monospace>tcg_model_integration</monospace> branch of
      <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/ENKI-portal/ThermoEngine">ThermoEngine</ext-link>).</p>
    </list-item>
  </list>
  <sec id="relationship-to-other-software-packages-for-solid-earth-thermodynamic-modeling">
    <title>Relationship to other Software packages for Solid-Earth
    Thermodynamic modeling</title>
    <p>Computational thermodynamic software has been a central tool for
    solid-Earth science for over 40 years and has focused primarily on
    calculating phase equilibrium for several distinct self-consistent
    “Thermodynamic Datasets” such as those for solid mineral phases
    (<xref alt="Berman, 1988" rid="ref-berman_internally-consistent_1988" ref-type="bibr">Berman,
    1988</xref>;
    <xref alt="Holland &amp; Powell, 1998" rid="ref-holland_internally_1998" ref-type="bibr">Holland
    &amp; Powell, 1998</xref>,
    <xref alt="2011" rid="ref-holland_improved_2011" ref-type="bibr">2011</xref>;
    <xref alt="Stixrude &amp; Lithgow-Bertelloni, 2005" rid="ref-stixrude_thermodynamics_2005" ref-type="bibr">Stixrude
    &amp; Lithgow-Bertelloni, 2005</xref>,
    <xref alt="2011" rid="ref-stixrude_thermodynamics_2011" ref-type="bibr">2011</xref>),
    silicate liquids
    (<xref alt="Ghiorso et al., 2002" rid="ref-ghiorso_pmeltsU003A_2002" ref-type="bibr">Ghiorso
    et al., 2002</xref>;
    <xref alt="Ghiorso &amp; Sack, 1995" rid="ref-ghiorso_chemical_1995" ref-type="bibr">Ghiorso
    &amp; Sack, 1995</xref>;
    <xref alt="Holland et al., 2018" rid="ref-holland_melting_2018" ref-type="bibr">Holland
    et al., 2018</xref>), and ionic species in aqueous solutions
    (<xref alt="Shock et al., 1992" rid="ref-shock_calculation_1992" ref-type="bibr">Shock
    et al., 1992</xref>;
    <xref alt="Tanger &amp; Helgeson, 1988" rid="ref-tanger_calculation_1988" ref-type="bibr">Tanger
    &amp; Helgeson, 1988</xref>).</p>
    <p>Many of these datasets are associated with specific software for
    calculating equilibrium assemblages using a range of Gibbs free
    energy minimization algorithms. Some of the most commonly used
    software includes the MELTs family of models
    (<xref alt="Asimow &amp; Ghiorso, 1998" rid="ref-asimow_algorithmic_1998" ref-type="bibr">Asimow
    &amp; Ghiorso, 1998</xref>;
    <xref alt="Ghiorso et al., 2002" rid="ref-ghiorso_pmeltsU003A_2002" ref-type="bibr">Ghiorso
    et al., 2002</xref>;
    <xref alt="Ghiorso &amp; Gualda, 2015" rid="ref-ghiorso_h2oco2_2015" ref-type="bibr">Ghiorso
    &amp; Gualda, 2015</xref>;
    <xref alt="Ghiorso &amp; Sack, 1995" rid="ref-ghiorso_chemical_1995" ref-type="bibr">Ghiorso
    &amp; Sack, 1995</xref>;
    <xref alt="Gualda et al., 2012" rid="ref-gualda_rhyolite-melts_2012" ref-type="bibr">Gualda
    et al., 2012</xref>) for equilibration of silicate minerals and
    melts, which has also been repackaged as alphaMELTS
    (<xref alt="Antoshechkina &amp; Ghiorso, 2018" rid="ref-antoshechkina_melts_2018" ref-type="bibr">Antoshechkina
    &amp; Ghiorso, 2018</xref>;
    <xref alt="Smith &amp; Asimow, 2005" rid="ref-smith_adiabat_1ph_2005" ref-type="bibr">Smith
    &amp; Asimow, 2005</xref>) as well as in its current incarnation
    within the
    <ext-link ext-link-type="uri" xlink:href="http://enki-portal.org">ENKI</ext-link>
    project. Primarily used for metamorphic petrology,
    <ext-link ext-link-type="uri" xlink:href="https://hpxeosandthermocalc.org/the-thermocalc-software/">THERMOCALC</ext-link><xref ref-type="fn" rid="fn1">1</xref>
    (<xref alt="Powell et al., 1998" rid="ref-powell_calculating_1998" ref-type="bibr">Powell
    et al., 1998</xref>) is closely associated with the thermodynamic
    models of Holland and Powell
    (<xref alt="Holland &amp; Powell, 1998" rid="ref-holland_internally_1998" ref-type="bibr">Holland
    &amp; Powell, 1998</xref>,
    <xref alt="2011" rid="ref-holland_improved_2011" ref-type="bibr">2011</xref>),
    while
    <ext-link ext-link-type="uri" xlink:href="https://github.com/stixrude/HeFESToRepository">HeFESTo</ext-link>
    is used for the calculation of phase equilibria of the high
    pressure/temperature solid-state models of Stixrude and
    Lithgow-Bertelloni
    (<xref alt="Stixrude &amp; Lithgow-Bertelloni, 2005" rid="ref-stixrude_thermodynamics_2005" ref-type="bibr">Stixrude
    &amp; Lithgow-Bertelloni, 2005</xref>,
    <xref alt="2011" rid="ref-stixrude_thermodynamics_2011" ref-type="bibr">2011</xref>).
    Note that not all of these packages have open-source licenses. In
    addition, there are several more general Gibbs free energy
    minimization packages that can be used with multiple data sets.
    <ext-link ext-link-type="uri" xlink:href="https://github.com/jadconnolly/Perple_X/">Perple_X</ext-link>
    (<xref alt="Connolly, 1990" rid="ref-connolly_multivariable_1990" ref-type="bibr">Connolly,
    1990</xref>,
    <xref alt="2005" rid="ref-connolly_computation_2005" ref-type="bibr">2005</xref>,
    <xref alt="2009" rid="ref-connolly_geodynamic_2009" ref-type="bibr">2009</xref>)
    is one of the most widely used. More recent additions include
    <ext-link ext-link-type="uri" xlink:href="https://titan.minpet.unibas.ch/minpet/theriak/theruser.html">THERIAK-DOMINO</ext-link>
    (<xref alt="Capitani &amp; Petrakakis, 2010" rid="ref-capitani_computation_2010" ref-type="bibr">Capitani
    &amp; Petrakakis, 2010</xref>) which also supports the models of
    Holland and Powell,
    <ext-link ext-link-type="uri" xlink:href="https://hansjcv.github.io/Thermolab/">Thermolab</ext-link>
    (<xref alt="Vrijmoed &amp; Podladchikov, 2022" rid="ref-vrijmoed_thermolab_2022" ref-type="bibr">Vrijmoed
    &amp; Podladchikov, 2022</xref>) a MATLAB based toolkit, and
    <ext-link ext-link-type="uri" xlink:href="https://github.com/ComputationalThermodynamics/MAGEMin">MAGEMin</ext-link>
    (<xref alt="Riel et al., 2022" rid="ref-riel_magemin_2022" ref-type="bibr">Riel
    et al., 2022</xref>) an open-source Gibbs energy minimization
    package written in C (with
    <ext-link ext-link-type="uri" xlink:href="https://julialang.org">julia</ext-link>
    and
    <ext-link ext-link-type="uri" xlink:href="https://www.mathworks.com/products/matlab.html">MATLAB</ext-link>
    bindings) for adaptive phase-diagram generation with a range of
    modern optimization techniques. In particular,
    <ext-link ext-link-type="uri" xlink:href="https://github.com/ComputationalThermodynamics/MAGEMin">MAGEMin</ext-link>
    includes the igneous thermodynamic database of Holland et al.
    (<xref alt="2018" rid="ref-holland_melting_2018" ref-type="bibr">2018</xref>).</p>
    <p>These packages provide critical thermodynamic modeling
    infrastructure for solid-Earth science but are complementary and
    distinct in design and applicability to ThermoCodegen. In
    particular, the primary features added by ThermoCodegen are:</p>
    <list list-type="bullet">
      <list-item>
        <p>the ability to more easily create and explore custom,
        consistent models of all thermodynamic parameters through the
        use of symbolic differentiation and automatic code
        generation</p>
      </list-item>
      <list-item>
        <p>the ability to generate code for disequilibrium reaction
        kinetics</p>
      </list-item>
      <list-item>
        <p>the ability to create custom C++ and python libraries for
        direct inclusion in geodynamics models.</p>
      </list-item>
    </list>
    <p>Given the complexity of these high-dimensional open-system
    problems, having effective open-source software for reproducible
    exploration of both equilibrium phase diagrams and disequilibrium
    transport remains a central challenge and goal in geodynamics and
    ThermoCodegen is designed to address several of these critical
    challenges.</p>
  </sec>
</sec>
<sec id="software-designoverview">
  <title>Software design/overview</title>
  <p>The design of ThermoCodegen follows the hierarchical structure of
  thermodynamic modeling commonly used in Earth Sciences and illustrated
  in
  <xref alt="[fig:thermo_model]" rid="figU003Athermo_model">[fig:thermo_model]</xref>.</p>
  <fig>
    <caption><p>The hierarchical structure of thermodynamic modeling.
    <inline-formula><alternatives>
    <tex-math><![CDATA[\mu_i^k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
    is an endmember’s chemical potential model and
    <inline-formula><alternatives>
    <tex-math><![CDATA[M_i^k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>M</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
    its mass. <inline-formula><alternatives>
    <tex-math><![CDATA[G_i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    is a phase’s Gibbs free energy model and
    <inline-formula><alternatives>
    <tex-math><![CDATA[\rho_i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives>
    <tex-math><![CDATA[C_{Pi}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
    <inline-formula><alternatives>
    <tex-math><![CDATA[s_i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\alpha_i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    are (for example) its density, heat capacity, specific entropy, and
    thermal expansivity, derived consistently by symbolic
    differentiation of <inline-formula><alternatives>
    <tex-math><![CDATA[G_i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
    <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{\nu}_j]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>𝛎</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    describes the stoichiometry of reactions between the endmembers of
    the phases, <inline-formula><alternatives>
    <tex-math><![CDATA[A_j]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    the resulting reaction affinities, <inline-formula><alternatives>
    <tex-math><![CDATA[R_j]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>R</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    their rates, and <inline-formula><alternatives>
    <tex-math><![CDATA[\Gamma_i^k]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mi>Γ</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[\Gamma_i]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Γ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    the resulting endmember and phase source terms. The Thermodynamic
    Database and Reactive System are functions of the temperature,
    <inline-formula><alternatives>
    <tex-math><![CDATA[T]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>,
    pressure <inline-formula><alternatives>
    <tex-math><![CDATA[P]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>P</mml:mi></mml:math></alternatives></inline-formula>,
    the number of moles, <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{n}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐧</mml:mi></mml:math></alternatives></inline-formula>,
    or mass fractions, <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{C}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝐂</mml:mi></mml:math></alternatives></inline-formula>,
    of the endmembers, and presence (e.g. volume fraction) of the
    phases, <inline-formula><alternatives>
    <tex-math><![CDATA[\boldsymbol{\phi}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>𝛟</mml:mi></mml:math></alternatives></inline-formula>.
    These can be supplied by coupling to a dynamic model that may
    additionally calculate phase velocities, e.g.,
    <inline-formula><alternatives>
    <tex-math><![CDATA[v_s]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>v</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[v_f]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>v</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
    Image adapted from Tweed
    (<xref alt="2021" rid="ref-tweed_coupling_2021" ref-type="bibr">2021</xref>).<styled-content id="figU003Athermo_model"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="media/figures/hierarchical_thermodynamics.png" />
  </fig>
  <p>At the lowest level are thermodynamic <bold>Endmembers</bold> which
  provide chemical potentials, <inline-formula><alternatives>
  <tex-math><![CDATA[\mu_i^k(T,P)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  for stoichiometric chemical components. The actual components can be
  arbitrary (e.g., oxides, minerals, ionic species) but have fixed
  chemical composition and thermodynamic properties that only depend on
  temperature and pressure (or temperature and volume, for models of the
  Helmholtz free energy).</p>
  <p>Given a space of thermodynamic endmembers, we can construct
  homogeneous <bold>Phases</bold> as combinations of endmembers and
  develop thermodynamic models for their Gibbs free energy,
  <inline-formula><alternatives>
  <tex-math><![CDATA[G_i(T,P,\boldsymbol{n}_i)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>𝐧</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  that depend on temperature, pressure and the number of moles of each
  endmember <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{n}_i = n_i^k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>𝐧</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p>Given <inline-formula><alternatives>
  <tex-math><![CDATA[G_i(T,P,\boldsymbol{n}_i)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>𝐧</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  for each phase, all of the other thermodynamic properties (and their
  derivatives) can be derived by partial differentiation of
  <inline-formula><alternatives>
  <tex-math><![CDATA[G_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  For example, entropy <inline-formula><alternatives>
  <tex-math><![CDATA[S_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  volume <inline-formula><alternatives>
  <tex-math><![CDATA[V_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  chemical potentials <inline-formula><alternatives>
  <tex-math><![CDATA[\bar{\mu}_i^k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msubsup><mml:mover><mml:mi>μ</mml:mi><mml:mo accent="true">‾</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>,
  heat capacity <inline-formula><alternatives>
  <tex-math><![CDATA[C_{Pi}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  and thermal expansivity <inline-formula><alternatives>
  <tex-math><![CDATA[\alpha_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  are all related to <inline-formula><alternatives>
  <tex-math><![CDATA[G_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  by:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[
      \begin{matrix}
      S_i = -\frac{\partial G_i}{\partial T} & V_i = \frac{\partial G_i}{\partial P} & \bar{\mu}_i^k = \frac{\partial G_i}{\partial n_i^k}\\
      C_{Pi} = T\frac{\partial S_i}{\partial T}=-T\frac{\partial^2 G_i}{\partial T^2} & &
      \alpha_i = \frac{1}{V_i}\frac{\partial V_i}{\partial T} = \frac{1}{V_i}\frac{\partial^2 G_i}{\partial P^2}\\
    \end{matrix}
  ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:msubsup><mml:mover><mml:mi>μ</mml:mi><mml:mo accent="true">‾</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msubsup><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>T</mml:mi><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mtd><mml:mtd columnalign="center" style="text-align: center"></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>∂</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:msup><mml:mi>P</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
  <p>Thus if we can define an analytic model for
  <inline-formula><alternatives>
  <tex-math><![CDATA[G_i(T,P,\boldsymbol{n}_i)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>𝐧</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  for any phase, we can use symbolic differentiation and code-generation
  to provide custom routines to generate all thermodynamic properties
  consistently.</p>
  <p>We define a set of phases, together with their constituent
  thermodynamic endmembers as a <bold>Thermodynamic Database</bold>
  corresponding to the blue box in
  <xref alt="[fig:thermo_model]" rid="figU003Athermo_model">[fig:thermo_model]</xref>.
  Standard databases available in the literature include the mineral
  database of Berman
  (<xref alt="1988" rid="ref-berman_internally-consistent_1988" ref-type="bibr">1988</xref>)
  and its extension to silicate liquids through the MELTs family of
  models
  (<xref alt="Ghiorso et al., 2002" rid="ref-ghiorso_pmeltsU003A_2002" ref-type="bibr">Ghiorso
  et al., 2002</xref>;
  <xref alt="Ghiorso &amp; Sack, 1995" rid="ref-ghiorso_chemical_1995" ref-type="bibr">Ghiorso
  &amp; Sack, 1995</xref>), as well as the high-pressure mineral phases
  of Stixrude and Lithgow-Bertelloni
  (<xref alt="Stixrude &amp; Lithgow-Bertelloni, 2005" rid="ref-stixrude_thermodynamics_2005" ref-type="bibr">Stixrude
  &amp; Lithgow-Bertelloni, 2005</xref>,
  <xref alt="2011" rid="ref-stixrude_thermodynamics_2011" ref-type="bibr">2011</xref>)
  or metamorphic phases of, for example, Holland &amp; Powell
  (<xref alt="2011" rid="ref-holland_improved_2011" ref-type="bibr">2011</xref>).
  All of these are currently available through python bindings to
  ObjectiveC code in ThermoEngine. However, the ObjectiveC objects are
  not readily incorporated within other codes.</p>
  <p>ThermoEngine also provides support for generating custom
  thermodynamic models of endmembers and phases through the
  <monospace>thermoengine.coder</monospace> module written by Mark
  Ghiorso. <monospace>coder</monospace> uses
  <ext-link ext-link-type="uri" xlink:href="https://www.sympy.org">SymPy</ext-link>
  to describe the free energies of endmembers and phases and then uses
  automatic differentiation and code-generation to write efficient C
  source code (and wrap it in
  <ext-link ext-link-type="uri" xlink:href="https://cython.org">Cython</ext-link>)
  for all thermodynamic properties of phases. Our extensions in
  <monospace>thermocodegen.coder</monospace> generate the same
  underlying C code and interfaces as
  <monospace>thermoengine.coder</monospace> but extend its functionality
  in several critical ways for better integration with large-scale
  geodynamic modeling.</p>
  <sec id="thermocodegen">
    <title>ThermoCodegen</title>
    <p>ThermoCodegen is designed to produce code for just the colored
    boxes in
    <xref alt="[fig:thermo_model]" rid="figU003Athermo_model">[fig:thermo_model]</xref>.</p>
    <sec id="custom-thermodynamic-databases">
      <title>Custom Thermodynamic Databases</title>
      <p>For <bold>Thermodynamic Databases</bold> of endmembers and
      phases, ThermoCodegen extends
      <monospace>thermoengine.coder</monospace> to record the internal
      state of each thermodynamic model as a python dictionary in order
      to store and generate code from xml files that completely describe
      all variables, parameters and SymPy models for endmembers and
      phases. These xml files are parsed using the science neutral
      options package
      <ext-link ext-link-type="uri" xlink:href="https://github.com/FluidityProject/spud">Spud</ext-link>
      (<xref alt="Ham et al., 2009" rid="ref-ham_spud_2009" ref-type="bibr">Ham
      et al., 2009</xref>). Endmembers are stored with the extension
      <monospace>.emml</monospace> and phases are stored as
      <monospace>.phml</monospace> files, which can be viewed with the
      Spud GUI <monospace>diamond</monospace>. Given a set of consistent
      endmember and phase description files, the ThermoCodegen script
      <monospace>tcg_builddb</monospace> can be used to inspect,
      validate and autogenerate code for a custom Thermodynamic Database
      as well as provide C++ wrappers and python bindings using
      <ext-link ext-link-type="uri" xlink:href="https://pybind11.readthedocs.io">pybind11</ext-link>.</p>
      <p>At this point, all source code, together with
      <monospace>.emml</monospace> and <monospace>.phml</monospace>
      files describing the full thermodynamic models, and optionally
      compiled C++ and python libraries are made available as a
      compressed tar-ball. This object is considered a Thermodynamic
      Database and can be used locally or made available as a
      web-accessible URL, for example with a
      <ext-link ext-link-type="uri" xlink:href="https://zenodo.org">zenodo</ext-link>
      DOI.</p>
      <p>Given a custom thermodynamic database, these can then be used
      in optimization codes such as
      <monospace>thermoengine.equilibrate</monospace> to find
      equilibrium assemblages that minimize the global Gibbs free
      energy.</p>
    </sec>
    <sec id="reaction-kinetic-objects">
      <title>Reaction Kinetic Objects</title>
      <p>For better integration with open-system geodynamics codes that
      do not assume equilibrium, ThermoCodegen also provides code for
      generating C++ libraries and python bindings for custom kinetics
      models that describe a set of reactions between endmembers and
      phases within a given thermodynamic database. The software
      provides interfaces for calculating affinities, reaction rates,
      and thermodynamic properties of phases as well as their exact
      derivatives for use in non-linear solvers that take Jacobians.
      These reaction kinetic models are stored as xml files with the
      extension <monospace>.rxml</monospace> from which custom C++
      libraries and python bindings are generated using the build script
      <monospace>tcg_buildrx</monospace>.</p>
      <p>These reaction libraries, along with the underlying database
      objects can then be incorporated in external modeling software
      such as ThermoEngine, TerraFERMA, ASPECT, Jupyter notebooks and
      general python or C++ codes. Inclusion in dynamic models is
      considered external to ThermoCodegen, however, the ThermoCodegen
      distribution also provides containers that include a complete
      installation of TerraFERMA along with some example test cases.</p>
      <p>Detailed
      <ext-link ext-link-type="uri" xlink:href="https://enki-portal.gitlab.io/ThermoCodegen">documentation</ext-link>
      for ThermoCodegen is available that includes a more detailed
      description of the software design as well as instructions for
      using the package through the provided docker and singularity
      containers (local installation guidelines are also available).
      Most importantly, the documentation also includes fully worked out
      examples illustrating the work flow for using ThermoCodegen
      including a set of Jupyter notebooks for constructing and
      exploring a range of thermodynamic models.</p>
    </sec>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work was supported by NSF SI<inline-formula><alternatives>
  <tex-math><![CDATA[^2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi></mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></alternatives></inline-formula>
  award NSF-ACI1550337, NSF-EAR1520732, NSF-EAR1049905 and the Sloan
  Foundation project on Net-Zero and Negative Emissions
  Technologies.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-ham_spud_2009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ham</surname><given-names>D. A.</given-names></name>
        <name><surname>Farrell</surname><given-names>P. E.</given-names></name>
        <name><surname>Gorman</surname><given-names>G. J.</given-names></name>
        <name><surname>Maddison</surname><given-names>J. R.</given-names></name>
        <name><surname>Wilson</surname><given-names>C. R.</given-names></name>
        <name><surname>Kramer</surname><given-names>S. C.</given-names></name>
        <name><surname>Shipton</surname><given-names>J.</given-names></name>
        <name><surname>Collins</surname><given-names>G. S.</given-names></name>
        <name><surname>Cotter</surname><given-names>C. J.</given-names></name>
        <name><surname>Piggott</surname><given-names>M. D.</given-names></name>
      </person-group>
      <article-title>Spud 1.0: Generalising and automating the user interfaces of scientific computer models</article-title>
      <source>Geoscientific Model Development</source>
      <year iso-8601-date="2009-03">2009</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2011-03-06">2011</year><month>03</month><day>06</day></date-in-citation>
      <volume>2</volume>
      <issue>1</issue>
      <issn>1991-9603</issn>
      <uri>http://www.geosci-model-dev.net/2/33/2009/gmd-2-33-2009.html</uri>
      <pub-id pub-id-type="doi">10.5194/gmd-2-33-2009</pub-id>
      <fpage>33</fpage>
      <lpage>42</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ghiorso_pmeltsU003A_2002">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ghiorso</surname><given-names>M. S.</given-names></name>
        <name><surname>Hirschmann</surname><given-names>M. M.</given-names></name>
        <name><surname>Reiners</surname><given-names>P. W.</given-names></name>
        <name><surname>Kress</surname><given-names>V. C.</given-names></name>
      </person-group>
      <article-title>The pMELTS: A revision of MELTS for improved calculation of phase relations and major element partitioning related to partial melting of the mantle to 3 GPa</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2002">2002</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2013-02-17">2013</year><month>02</month><day>17</day></date-in-citation>
      <volume>3</volume>
      <issue>5</issue>
      <issn>1525-2027</issn>
      <uri>http://onlinelibrary.wiley.com/doi/10.1029/2001GC000217/abstract</uri>
      <pub-id pub-id-type="doi">10.1029/2001GC000217</pub-id>
      <fpage>1</fpage>
      <lpage>35</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wilson_softwareU003A_2015">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Wilson</surname><given-names>C. R.</given-names></name>
        <name><surname>Spiegelman</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>Software: TerraFERMA v1.0 — The Transparent Finite Element Rapid Model Assembler, open-source repository: terraferma.github.io</article-title>
      <year iso-8601-date="2015">2015</year>
      <uri>terraferma.github.io</uri>
    </element-citation>
  </ref>
  <ref id="ref-holland_internally_1998">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Holland</surname><given-names>T. J. B.</given-names></name>
        <name><surname>Powell</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>An internally consistent thermodynamic data set for phases of petrological interest</article-title>
      <source>Journal of Metamorphic Geology</source>
      <year iso-8601-date="1998-05">1998</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2017-01-09">2017</year><month>01</month><day>09</day></date-in-citation>
      <volume>16</volume>
      <issue>3</issue>
      <issn>1525-1314</issn>
      <uri>http://onlinelibrary.wiley.com/doi/10.1111/j.1525-1314.1998.00140.x/abstract</uri>
      <pub-id pub-id-type="doi">10.1111/j.1525-1314.1998.00140.x</pub-id>
      <fpage>309</fpage>
      <lpage>343</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wilson_terrafermaU003A_2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wilson</surname><given-names>C. R.</given-names></name>
        <name><surname>Spiegelman</surname><given-names>M.</given-names></name>
        <name><surname>Keken</surname><given-names>P. E. van</given-names></name>
      </person-group>
      <article-title>TerraFERMA: The Transparent Finite Element Rapid Model Assembler for multiphysics problems in Earth sciences</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2017-02">2017</year><month>02</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2017-03-22">2017</year><month>03</month><day>22</day></date-in-citation>
      <volume>18</volume>
      <issue>2</issue>
      <issn>1525-2027</issn>
      <uri>http://onlinelibrary.wiley.com/doi/10.1002/2016GC006702/abstract</uri>
      <pub-id pub-id-type="doi">10.1002/2016GC006702</pub-id>
      <fpage>769</fpage>
      <lpage>810</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ghiorso_chemical_1995">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ghiorso</surname><given-names>M. S.</given-names></name>
        <name><surname>Sack</surname><given-names>R. O.</given-names></name>
      </person-group>
      <article-title>Chemical mass transfer in magmatic processes IV. A revised and internally consistent thermodynamic model for the interpolation and extrapolation of liquid-solid equilibria in magmatic systems at elevated temperatures and pressures</article-title>
      <source>Contributions to Mineralogy and Petrology</source>
      <year iso-8601-date="1995-03">1995</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2017-06-13">2017</year><month>06</month><day>13</day></date-in-citation>
      <volume>119</volume>
      <issue>2-3</issue>
      <issn>0010-7999</issn>
      <uri>https://link.springer.com/article/10.1007/BF00307281</uri>
      <pub-id pub-id-type="doi">10.1007/BF00307281</pub-id>
      <fpage>197</fpage>
      <lpage>212</lpage>
    </element-citation>
  </ref>
  <ref id="ref-holland_improved_2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Holland</surname><given-names>T. J. B.</given-names></name>
        <name><surname>Powell</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>An improved and extended internally consistent thermodynamic dataset for phases of petrological interest, involving a new equation of state for solids</article-title>
      <source>Journal of Metamorphic Geology</source>
      <year iso-8601-date="2011-04">2011</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2018-08-07">2018</year><month>08</month><day>07</day></date-in-citation>
      <volume>29</volume>
      <issue>3</issue>
      <issn>1525-1314</issn>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1525-1314.2010.00923.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1525-1314.2010.00923.x</pub-id>
      <fpage>333</fpage>
      <lpage>383</lpage>
    </element-citation>
  </ref>
  <ref id="ref-berman_internally-consistent_1988">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Berman</surname><given-names>R. G.</given-names></name>
      </person-group>
      <article-title>Internally-Consistent Thermodynamic Data for Minerals in the System Na2O-K2O-CaO-MgO-FeO-Fe2O3-Al2O3-SiO2-TiO2-H2O-CO2</article-title>
      <source>Journal of Petrology</source>
      <year iso-8601-date="1988-04">1988</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2019-08-22">2019</year><month>08</month><day>22</day></date-in-citation>
      <volume>29</volume>
      <issue>2</issue>
      <issn>0022-3530</issn>
      <uri>https://academic-oup-com.ezproxy.cul.columbia.edu/petrology/article/29/2/445/1560597</uri>
      <pub-id pub-id-type="doi">10.1093/petrology/29.2.445</pub-id>
      <fpage>445</fpage>
      <lpage>522</lpage>
    </element-citation>
  </ref>
  <ref id="ref-stixrude_thermodynamics_2005">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Stixrude</surname><given-names>Lars</given-names></name>
        <name><surname>Lithgow-Bertelloni</surname><given-names>Carolina</given-names></name>
      </person-group>
      <article-title>Thermodynamics of mantle minerals - I. Physical properties</article-title>
      <source>Geophysical Journal International</source>
      <year iso-8601-date="2005-08">2005</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2020-09-22">2020</year><month>09</month><day>22</day></date-in-citation>
      <volume>162</volume>
      <issue>2</issue>
      <uri>https://academic.oup.com/gji/article-lookup/doi/10.1111/j.1365-246X.2005.02642.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-246X.2005.02642.x</pub-id>
      <fpage>610</fpage>
      <lpage>632</lpage>
    </element-citation>
  </ref>
  <ref id="ref-stixrude_thermodynamics_2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Stixrude</surname><given-names>Lars</given-names></name>
        <name><surname>Lithgow-Bertelloni</surname><given-names>Carolina</given-names></name>
      </person-group>
      <article-title>Thermodynamics of mantle minerals - II. Phase equilibria</article-title>
      <source>Geophysical Journal International</source>
      <year iso-8601-date="2011-03">2011</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2020-09-22">2020</year><month>09</month><day>22</day></date-in-citation>
      <volume>184</volume>
      <issue>3</issue>
      <issn>1365-246X</issn>
      <uri>https://academic.oup.com/gji/article/184/3/1180/625783</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-246X.2010.04890.x</pub-id>
      <fpage>1180</fpage>
      <lpage>1213</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kronbichler_high_2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kronbichler</surname><given-names>Martin</given-names></name>
        <name><surname>Heister</surname><given-names>Timo</given-names></name>
        <name><surname>Bangerth</surname><given-names>Wolfgang</given-names></name>
      </person-group>
      <article-title>High accuracy mantle convection simulation through modern numerical methods: High accuracy mantle convection simulation</article-title>
      <source>Geophysical Journal International</source>
      <year iso-8601-date="2012-10">2012</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-04-16">2022</year><month>04</month><day>16</day></date-in-citation>
      <volume>191</volume>
      <issue>1</issue>
      <uri>https://academic.oup.com/gji/article-lookup/doi/10.1111/j.1365-246X.2012.05609.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1365-246X.2012.05609.x</pub-id>
      <fpage>12</fpage>
      <lpage>29</lpage>
    </element-citation>
  </ref>
  <ref id="ref-heister_high_2017">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Heister</surname><given-names>Timo</given-names></name>
        <name><surname>Dannberg</surname><given-names>Juliane</given-names></name>
        <name><surname>Gassmöller</surname><given-names>Rene</given-names></name>
        <name><surname>Bangerth</surname><given-names>Wolfgang</given-names></name>
      </person-group>
      <article-title>High accuracy mantle convection simulation through modern numerical methods – II: Realistic models and problems</article-title>
      <source>Geophysical Journal International</source>
      <year iso-8601-date="2017-08">2017</year><month>08</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-04-16">2022</year><month>04</month><day>16</day></date-in-citation>
      <volume>210</volume>
      <issue>2</issue>
      <issn>0956-540X</issn>
      <uri>https://academic.oup.com/gji/article-lookup/doi/10.1093/gji/ggx195</uri>
      <pub-id pub-id-type="doi">10.1093/gji/ggx195</pub-id>
      <fpage>833</fpage>
      <lpage>851</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bangerth_aspect_2021">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Bangerth</surname><given-names>Wolfgang</given-names></name>
        <name><surname>Dannberg</surname><given-names>Juliane</given-names></name>
        <name><surname>Fraters</surname><given-names>Menno</given-names></name>
        <name><surname>Gassmoeller</surname><given-names>Rene</given-names></name>
        <name><surname>Glerum</surname><given-names>Anne</given-names></name>
        <name><surname>Heister</surname><given-names>Timo</given-names></name>
        <name><surname>Naliboff</surname><given-names>John</given-names></name>
      </person-group>
      <article-title>ASPECT v2.3.0</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2021-07">2021</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-04-16">2022</year><month>04</month><day>16</day></date-in-citation>
      <uri>https://zenodo.org/record/5131909</uri>
      <pub-id pub-id-type="doi">10.5281/ZENODO.5131909</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-wenkel_pybind11_2017">
    <element-citation publication-type="manuscript">
      <person-group person-group-type="author">
        <name><surname>Wenkel</surname><given-names>Jacob</given-names></name>
        <name><surname>Rhinelander</surname><given-names>Jason</given-names></name>
        <name><surname>Moldovan</surname><given-names>Dean</given-names></name>
      </person-group>
      <article-title>pybind11 – Seamless operability between C++11 and Python</article-title>
      <year iso-8601-date="2017">2017</year>
      <uri>https://github.com/pybind/pybind11</uri>
    </element-citation>
  </ref>
  <ref id="ref-ghiorso_thermodynamic_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ghiorso</surname><given-names>M. S.</given-names></name>
        <name><surname>Wolf</surname><given-names>A. S.</given-names></name>
      </person-group>
      <article-title>Thermodynamic Modeling Using ENKI: 1. Overview and Phase Equilibrium Applications</article-title>
      <year iso-8601-date="2019-12">2019</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-04-16">2022</year><month>04</month><day>16</day></date-in-citation>
      <volume>2019</volume>
      <uri>https://ui.adsabs.harvard.edu/abs/2019AGUFMED53F0897G</uri>
      <fpage>ED53F</fpage>
      <lpage>0897</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wolf_thermodynamic_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wolf</surname><given-names>A. S.</given-names></name>
        <name><surname>Ghiorso</surname><given-names>M. S.</given-names></name>
      </person-group>
      <article-title>Thermodynamic Modeling Using ENKI: 2. Extending Existing Models</article-title>
      <year iso-8601-date="2019-12">2019</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-04-16">2022</year><month>04</month><day>16</day></date-in-citation>
      <volume>2019</volume>
      <uri>https://ui.adsabs.harvard.edu/abs/2019AGUFMED52A..05W</uri>
      <fpage>ED52A</fpage>
      <lpage>05</lpage>
    </element-citation>
  </ref>
  <ref id="ref-tweed_coupling_2021">
    <element-citation publication-type="thesis">
      <person-group person-group-type="author">
        <name><surname>Tweed</surname><given-names>Lucy Emily Langran</given-names></name>
      </person-group>
      <article-title>Coupling the Thermodynamics, Kinetics and Geodynamics of Multiphase Reactive Transport in Earth’s Interior</article-title>
      <publisher-name>Columbia University</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-04-17">2022</year><month>04</month><day>17</day></date-in-citation>
      <uri>https://doi.org/10.7916/d8-wh72-vb08</uri>
      <pub-id pub-id-type="doi">10.7916/d8-wh72-vb08</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-holland_melting_2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Holland</surname><given-names>T. J. B.</given-names></name>
        <name><surname>Green</surname><given-names>E. C. R.</given-names></name>
        <name><surname>Powell</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>Melting of Peridotites through to Granites: A Simple Thermodynamic Model in the System KNCFMASHTOCr</article-title>
      <source>Journal of Petrology</source>
      <year iso-8601-date="2018-05">2018</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-04-16">2023</year><month>04</month><day>16</day></date-in-citation>
      <volume>59</volume>
      <issue>5</issue>
      <issn>0022-3530</issn>
      <uri>https://doi.org/10.1093/petrology/egy048</uri>
      <pub-id pub-id-type="doi">10.1093/petrology/egy048</pub-id>
      <fpage>881</fpage>
      <lpage>900</lpage>
    </element-citation>
  </ref>
  <ref id="ref-shock_calculation_1992">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Shock</surname><given-names>Everett L.</given-names></name>
        <name><surname>Oelkers</surname><given-names>Eric H.</given-names></name>
        <name><surname>Johnson</surname><given-names>James W.</given-names></name>
        <name><surname>Sverjensky</surname><given-names>Dimitri A.</given-names></name>
        <name><surname>Helgeson</surname><given-names>Harold C.</given-names></name>
      </person-group>
      <article-title>Calculation of the thermodynamic properties of aqueous species at high pressures and temperatures. Effective electrostatic radii, dissociation constants and standard partial molal properties to 1000^\circC and 5 kbar</article-title>
      <source>Journal of the Chemical Society, Faraday Transactions</source>
      <year iso-8601-date="1992-01">1992</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-04-17">2023</year><month>04</month><day>17</day></date-in-citation>
      <volume>88</volume>
      <issue>6</issue>
      <issn>1364-5455</issn>
      <uri>https://pubs.rsc.org/en/content/articlelanding/1992/ft/ft9928800803</uri>
      <pub-id pub-id-type="doi">10.1039/FT9928800803</pub-id>
      <fpage>803</fpage>
      <lpage>826</lpage>
    </element-citation>
  </ref>
  <ref id="ref-tanger_calculation_1988">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tanger</surname><given-names>John C.</given-names></name>
        <name><surname>Helgeson</surname><given-names>Harold C.</given-names></name>
      </person-group>
      <article-title>Calculation of the thermodynamic and transport properties of aqueous species at high pressures and temperatures; revised equations of state for the standard partial molal properties of ions and electrolytes</article-title>
      <source>American Journal of Science</source>
      <year iso-8601-date="1988-01">1988</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-04-17">2023</year><month>04</month><day>17</day></date-in-citation>
      <volume>288</volume>
      <issue>1</issue>
      <uri>https://ajs.scholasticahq.com/article/60435</uri>
      <pub-id pub-id-type="doi">10.2475/ajs.288.1.19</pub-id>
      <fpage>19</fpage>
      <lpage>98</lpage>
    </element-citation>
  </ref>
  <ref id="ref-asimow_algorithmic_1998">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Asimow</surname><given-names>P. D.</given-names></name>
        <name><surname>Ghiorso</surname><given-names>M. S.</given-names></name>
      </person-group>
      <article-title>Algorithmic modifications extending MELTS to calculate subsolidus phase relations</article-title>
      <source>American Mineralogist</source>
      <year iso-8601-date="1998-09">1998</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-27">2023</year><month>05</month><day>27</day></date-in-citation>
      <volume>83</volume>
      <issue>9-10</issue>
      <issn>1945-3027</issn>
      <uri>https://www.degruyter.com/document/doi/10.2138/am-1998-9-1022/html?lang=en</uri>
      <pub-id pub-id-type="doi">10.2138/am-1998-9-1022</pub-id>
      <fpage>1127</fpage>
      <lpage>1132</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gualda_rhyolite-melts_2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gualda</surname><given-names>G. A. R.</given-names></name>
        <name><surname>Ghiorso</surname><given-names>M. S.</given-names></name>
        <name><surname>Lemons</surname><given-names>R. V.</given-names></name>
        <name><surname>Carley</surname><given-names>T. L.</given-names></name>
      </person-group>
      <article-title>Rhyolite-MELTS: A Modified Calibration of MELTS Optimized for Silica-rich, Fluid-bearing Magmatic Systems</article-title>
      <source>Journal of Petrology</source>
      <year iso-8601-date="2012-05">2012</year><month>05</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-27">2023</year><month>05</month><day>27</day></date-in-citation>
      <volume>53</volume>
      <issue>5</issue>
      <issn>0022-3530</issn>
      <uri>https://doi.org/10.1093/petrology/egr080</uri>
      <pub-id pub-id-type="doi">10.1093/petrology/egr080</pub-id>
      <fpage>875</fpage>
      <lpage>890</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ghiorso_h2oco2_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ghiorso</surname><given-names>M. S.</given-names></name>
        <name><surname>Gualda</surname><given-names>Guilherme A. R.</given-names></name>
      </person-group>
      <article-title>An H2O–CO2 mixed fluid saturation model compatible with rhyolite-MELTS</article-title>
      <source>Contributions to Mineralogy and Petrology</source>
      <year iso-8601-date="2015-06">2015</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-27">2023</year><month>05</month><day>27</day></date-in-citation>
      <volume>169</volume>
      <issue>6</issue>
      <issn>1432-0967</issn>
      <uri>https://doi.org/10.1007/s00410-015-1141-8</uri>
      <pub-id pub-id-type="doi">10.1007/s00410-015-1141-8</pub-id>
      <fpage>53</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-connolly_multivariable_1990">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Connolly</surname><given-names>J. A. D.</given-names></name>
      </person-group>
      <article-title>Multivariable phase diagrams; an algorithm based on generalized thermodynamics</article-title>
      <source>American Journal of Science</source>
      <year iso-8601-date="1990-06">1990</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-27">2023</year><month>05</month><day>27</day></date-in-citation>
      <volume>290</volume>
      <issue>6</issue>
      <issn>0002-9599</issn>
      <uri>https://www.ajsonline.org/content/290/6/666</uri>
      <pub-id pub-id-type="doi">10.2475/ajs.290.6.666</pub-id>
      <fpage>666</fpage>
      <lpage>718</lpage>
    </element-citation>
  </ref>
  <ref id="ref-connolly_computation_2005">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Connolly</surname><given-names>J. A. D.</given-names></name>
      </person-group>
      <article-title>Computation of phase equilibria by linear programming: A tool for geodynamic modeling and its application to subduction zone decarbonation</article-title>
      <source>Earth and Planetary Science Letters</source>
      <year iso-8601-date="2005-07">2005</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-27">2023</year><month>05</month><day>27</day></date-in-citation>
      <volume>236</volume>
      <issue>1-2</issue>
      <uri>https://linkinghub.elsevier.com/retrieve/pii/S0012821X05002839</uri>
      <pub-id pub-id-type="doi">10.1016/j.epsl.2005.04.033</pub-id>
      <fpage>524</fpage>
      <lpage>541</lpage>
    </element-citation>
  </ref>
  <ref id="ref-connolly_geodynamic_2009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Connolly</surname><given-names>J. A. D.</given-names></name>
      </person-group>
      <article-title>The geodynamic equation of state: What and how</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2009-10">2009</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-27">2023</year><month>05</month><day>27</day></date-in-citation>
      <volume>10</volume>
      <issue>10</issue>
      <uri>http://doi.wiley.com/10.1029/2009GC002540</uri>
      <pub-id pub-id-type="doi">10.1029/2009GC002540</pub-id>
      <fpage>Q10014</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-powell_calculating_1998">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Powell</surname><given-names>R</given-names></name>
        <name><surname>Holland</surname><given-names>T.</given-names></name>
        <name><surname>Worley</surname><given-names>B.</given-names></name>
      </person-group>
      <article-title>Calculating phase diagrams involving solid solutions via non-linear equations, with examples using THERMOCALC</article-title>
      <source>Journal of Metamorphic Geology</source>
      <year iso-8601-date="1998">1998</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-27">2023</year><month>05</month><day>27</day></date-in-citation>
      <volume>16</volume>
      <issue>4</issue>
      <issn>1525-1314</issn>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1525-1314.1998.00157.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1525-1314.1998.00157.x</pub-id>
      <fpage>577</fpage>
      <lpage>588</lpage>
    </element-citation>
  </ref>
  <ref id="ref-capitani_computation_2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Capitani</surname><given-names>Christian de</given-names></name>
        <name><surname>Petrakakis</surname><given-names>Konstantin</given-names></name>
      </person-group>
      <article-title>The computation of equilibrium assemblage diagrams with Theriak/Domino software</article-title>
      <source>American Mineralogist</source>
      <year iso-8601-date="2010-07">2010</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-27">2023</year><month>05</month><day>27</day></date-in-citation>
      <volume>95</volume>
      <issue>7</issue>
      <issn>1945-3027</issn>
      <uri>https://www.degruyter.com/document/doi/10.2138/am.2010.3354/html?lang=en</uri>
      <pub-id pub-id-type="doi">10.2138/am.2010.3354</pub-id>
      <fpage>1006</fpage>
      <lpage>1016</lpage>
    </element-citation>
  </ref>
  <ref id="ref-vrijmoed_thermolab_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vrijmoed</surname><given-names>J. C.</given-names></name>
        <name><surname>Podladchikov</surname><given-names>Y. Y.</given-names></name>
      </person-group>
      <article-title>Thermolab: A Thermodynamics Laboratory for Nonlinear Transport Processes in Open Systems</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2022">2022</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-27">2023</year><month>05</month><day>27</day></date-in-citation>
      <volume>23</volume>
      <issue>4</issue>
      <issn>1525-2027</issn>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1029/2021GC010303</uri>
      <pub-id pub-id-type="doi">10.1029/2021GC010303</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-smith_adiabat_1ph_2005">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Smith</surname><given-names>Paula M.</given-names></name>
        <name><surname>Asimow</surname><given-names>Paul D.</given-names></name>
      </person-group>
      <article-title>Adiabat_1ph: A new public front-end to the MELTS, pMELTS, and pHMELTS models</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2005">2005</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-28">2023</year><month>05</month><day>28</day></date-in-citation>
      <volume>6</volume>
      <issue>2</issue>
      <issn>1525-2027</issn>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1029/2004GC000816</uri>
      <pub-id pub-id-type="doi">10.1029/2004GC000816</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-antoshechkina_melts_2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Antoshechkina</surname><given-names>P. M.</given-names></name>
        <name><surname>Ghiorso</surname><given-names>M. S.</given-names></name>
      </person-group>
      <article-title>MELTS for MATLAB: A new Educational and Research Tool for Computational Thermodynamics</article-title>
      <year iso-8601-date="2018-12">2018</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-28">2023</year><month>05</month><day>28</day></date-in-citation>
      <volume>2018</volume>
      <uri>https://ui.adsabs.harvard.edu/abs/2018AGUFMED44B..23A</uri>
      <fpage>ED44B</fpage>
      <lpage>23</lpage>
    </element-citation>
  </ref>
  <ref id="ref-riel_magemin_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Riel</surname><given-names>N.</given-names></name>
        <name><surname>Kaus</surname><given-names>B. J. P.</given-names></name>
        <name><surname>Green</surname><given-names>E. C. R.</given-names></name>
        <name><surname>Berlie</surname><given-names>N.</given-names></name>
      </person-group>
      <article-title>MAGEMin, an Efficient Gibbs Energy Minimizer: Application to Igneous Systems</article-title>
      <source>Geochemistry, Geophysics, Geosystems</source>
      <year iso-8601-date="2022-07">2022</year><month>07</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-05-28">2023</year><month>05</month><day>28</day></date-in-citation>
      <volume>23</volume>
      <issue>7</issue>
      <issn>1525-2027</issn>
      <uri>https://onlinelibrary.wiley.com/doi/10.1029/2022GC010427</uri>
      <pub-id pub-id-type="doi">10.1029/2022GC010427</pub-id>
    </element-citation>
  </ref>
</ref-list>
<fn-group>
  <fn id="fn1">
    <label>1</label><p>Not to be confused with the commercial package
    <ext-link ext-link-type="uri" xlink:href="https://thermocalc.com/">Thermo-Calc</ext-link></p>
  </fn>
</fn-group>
</back>
</article>
