<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">4522</article-id>
<article-id pub-id-type="doi">10.21105/joss.04522</article-id>
<title-group>
<article-title><monospace>haldensify</monospace>: Highly adaptive lasso
conditional density estimation in
<monospace>R</monospace></article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-7127-2789</contrib-id>
<name>
<surname>Hejazi</surname>
<given-names>Nima S.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-1019-8343</contrib-id>
<name>
<surname>van der Laan</surname>
<given-names>Mark J.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0002-1019-8343</contrib-id>
<name>
<surname>Benkeser</surname>
<given-names>David</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Biostatistics, T.H. Chan School of Public
Health, Harvard University</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Division of Biostatistics, School of Public Health,
University of California, Berkeley</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Department of Statistics, University of California,
Berkeley</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Department of Biostatistics and Bioinformatics, Rollins
School of Public Health, Emory University</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2022-09-07">
<day>7</day>
<month>9</month>
<year>2022</year>
</pub-date>
<volume>7</volume>
<issue>77</issue>
<fpage>4522</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>machine learning</kwd>
<kwd>causal inference</kwd>
<kwd>conditional density estimation</kwd>
<kwd>generalized propensity score</kwd>
<kwd>inverse probability weighting</kwd>
<kwd>semiparametric inference</kwd>
<kwd>R</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>The <monospace>haldensify</monospace> <monospace>R</monospace>
  package serves as a toolbox for nonparametric conditional density
  estimation based on the highly adaptive lasso, a flexible
  nonparametric algorithm for the estimation of functional statistical
  parameters (e.g., conditional mean, hazard, density). Building upon an
  earlier proposal
  (<xref alt="Dı́az &amp; van der Laan, 2011" rid="ref-diaz2011super" ref-type="bibr">Dı́az
  &amp; van der Laan, 2011</xref>), <monospace>haldensify</monospace>
  leverages the relationship between the hazard and density functions to
  estimate the latter by applying pooled hazard regression to a
  synthetic repeated measures dataset created from the input data,
  relying upon the framework of cross-validated loss-based estimation to
  yield an optimal estimator
  (<xref alt="Dudoit &amp; van der Laan, 2005" rid="ref-dudoit2005asymptotics" ref-type="bibr">Dudoit
  &amp; van der Laan, 2005</xref>;
  <xref alt="van der Laan et al., 2004" rid="ref-vdl2004asymptotic" ref-type="bibr">van
  der Laan et al., 2004</xref>). While conditional density estimation is
  a fundamental problem in statistics, arising naturally in a variety of
  applications (including machine learning), it plays a critical role in
  estimating the causal effects of continuous- or ordinal-valued
  treatments. In such settings this covariate-conditional treatment
  density has been termed the <italic>generalized propensity
  score</italic>
  (<xref alt="Hirano &amp; Imbens, 2004" rid="ref-hirano2004propensity" ref-type="bibr">Hirano
  &amp; Imbens, 2004</xref>;
  <xref alt="Imai &amp; Van Dyk, 2004" rid="ref-imai2004causal" ref-type="bibr">Imai
  &amp; Van Dyk, 2004</xref>), and, like its analog for binary
  treatments
  (<xref alt="Rosenbaum &amp; Rubin, 1983" rid="ref-rosenbaum1983central" ref-type="bibr">Rosenbaum
  &amp; Rubin, 1983</xref>), serves as a key ingredient in developing
  both inverse probability weighted and doubly robust estimators of
  causal effects
  (<xref alt="Dı́az &amp; van der Laan, 2012" rid="ref-diaz2012population" ref-type="bibr">Dı́az
  &amp; van der Laan, 2012</xref>,
  <xref alt="2018" rid="ref-diaz2018stochastic" ref-type="bibr">2018</xref>;
  <xref alt="Haneuse &amp; Rotnitzky, 2013" rid="ref-haneuse2013estimation" ref-type="bibr">Haneuse
  &amp; Rotnitzky, 2013</xref>;
  <xref alt="Hejazi et al., 2022" rid="ref-hejazi2022efficient" ref-type="bibr">Hejazi
  et al., 2022</xref>).</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Conditional density estimation is an important fundamental problem
  in the computational sciences and statistics, having garnered
  (independent) attention in machine learning
  (<xref alt="Sugiyama et al., 2012" rid="ref-sugiyama2012density" ref-type="bibr">Sugiyama
  et al., 2012</xref>;
  <xref alt="Takeuchi et al., 2009" rid="ref-takeuchi2009nonparametric" ref-type="bibr">Takeuchi
  et al., 2009</xref>), semiparametric estimation
  (<xref alt="Cheng &amp; Chu, 2004" rid="ref-cheng2004semiparametric" ref-type="bibr">Cheng
  &amp; Chu, 2004</xref>;
  <xref alt="Qin, 1998" rid="ref-qin1998inferences" ref-type="bibr">Qin,
  1998</xref>), and causal inference
  (<xref alt="Dı́az &amp; van der Laan, 2011" rid="ref-diaz2011super" ref-type="bibr">Dı́az
  &amp; van der Laan, 2011</xref>;
  <xref alt="Hirano &amp; Imbens, 2004" rid="ref-hirano2004propensity" ref-type="bibr">Hirano
  &amp; Imbens, 2004</xref>;
  <xref alt="Zhu et al., 2015" rid="ref-zhu2015boosting" ref-type="bibr">Zhu
  et al., 2015</xref>). Techniques for the nonparametric estimation of
  this quantity, complete with asymptotic optimality guarantees, have
  received comparatively limited attention. Similarly, despite the
  critical role of the generalized propensity score in the estimation of
  the causal effects of continuous treatments, this nuisance parameter
  is usually estimated with restrictive parametric modeling strategies,
  ultimately sharply limiting the quality of downstream point estimates
  and corresponding statistical inference (e.g., hypothesis tests,
  confidence intervals). Approaches for flexibly estimating the
  generalized propensity score have received limited attention
  (<xref alt="Dı́az &amp; van der Laan, 2011" rid="ref-diaz2011super" ref-type="bibr">Dı́az
  &amp; van der Laan, 2011</xref>;
  <xref alt="Zhu et al., 2015" rid="ref-zhu2015boosting" ref-type="bibr">Zhu
  et al., 2015</xref>), and software implementations of these techniques
  are, to the best of our knowledge, exceedingly rare, compared to, for
  example, regression algorithms for estimating conditional means.
  <monospace>haldensify</monospace> aims to partially fill this gap by
  implementing a flexible, nonparametric estimator of a conditional (or
  marginal) density, appropriate for estimation of the generalized
  propensity score and useful for the construction of inverse
  probability weighted or doubly robust estimators of a class of causal
  effect parameters tailored to continuous treatments.</p>
</sec>
<sec id="conditional-density-estimation-and-modern-causal-inference">
  <title>Conditional Density Estimation and Modern Causal
  Inference</title>
  <p>Conditional density estimation is a challenging and fundamental
  problem in statistical learning theory. Owing to the high frequency
  with which conditional density estimation arises in statistics and
  machine learning, a wide range of techniques have been proposed –
  under a correspondingly wide range of assumptions. Some techniques are
  based in kernel smoothing (e.g.,
  <xref alt="Takeuchi et al., 2009" rid="ref-takeuchi2009nonparametric" ref-type="bibr">Takeuchi
  et al., 2009</xref>), others in specialized neural network
  architectures (e.g.,
  <xref alt="Neuneier et al., 1994" rid="ref-neuneier1994estimation" ref-type="bibr">Neuneier
  et al., 1994</xref>), and others still in the direct estimation of
  ratios of conditional densities (e.g.,
  <xref alt="Sugiyama et al., 2012" rid="ref-sugiyama2012density" ref-type="bibr">Sugiyama
  et al., 2012</xref>). Most approaches make restrictive (parametric)
  assumptions about the form of the underlying density functional or
  fail to achieve convergence rates (of the estimator to the true,
  underlying conditional density) necessary for semiparametric
  inference. As such, analysts must often negotiate a difficult tradeoff
  between tractability, ease of implementation, and optimality
  properties of the chosen estimator. To partially resolve this open
  challenge, <monospace>haldensify</monospace> implements a
  nonparametric conditional density estimation procedure, making few
  assumptions regarding the underlying form of the density functional,
  with rate-convergence guarantees compatible with modern semiparametric
  inference and causal machine learning.</p>
  <p>The algorithm implemented in <monospace>haldensify</monospace> is
  an improved and tailored version of the proposal of Dı́az &amp; van der
  Laan
  (<xref alt="2011" rid="ref-diaz2011super" ref-type="bibr">2011</xref>),
  who formulated a nonparametric conditional density estimator based on
  the relationship between the density and hazard functions. This
  algorithm proceeds by, first, partitioning the support of the
  dependent variable into a user-specified number of bins and recasting
  the input dataset into a repeated measures structure, in which each
  observational unit is represented by a variable number of records
  (with the terminal record corresponding to the position of the bin
  over the discretized support into which the observed value of the
  dependent variable falls). Next, the hazard probability, conditional
  on any covariates, of the dependent variable falling in a given bin
  along the discretized support is estimated by applying the highly
  adaptive lasso (HAL) algorithm
  (<xref alt="Benkeser &amp; van der Laan, 2016" rid="ref-benkeser2016highly" ref-type="bibr">Benkeser
  &amp; van der Laan, 2016</xref>;
  <xref alt="van der Laan, 2015" rid="ref-vdl2015generally" ref-type="bibr">van
  der Laan, 2015</xref>,
  <xref alt="2017" rid="ref-vdl2017generally" ref-type="bibr">2017</xref>)
  (in this case, for binary regression), via the
  <monospace>hal9001</monospace> package
  (<xref alt="Coyle et al., 2022" rid="ref-coyle2022hal9001-rpkg" ref-type="bibr">Coyle
  et al., 2022</xref>;
  <xref alt="Hejazi, Coyle, et al., 2020" rid="ref-hejazi2020hal9001-joss" ref-type="bibr">Hejazi,
  Coyle, et al., 2020</xref>); this step is often labeled “pooled
  hazards” regression. Under plausible assumptions on the global
  variation of the target functional, HAL has been shown to converge at
  a suitable rate (<inline-formula><alternatives>
  <tex-math><![CDATA[\approx n^{-1/3}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo>≈</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  per Bibaut &amp; Laan
  (<xref alt="2019" rid="ref-bibaut2019fast" ref-type="bibr">2019</xref>))
  for standard semiparametric efficiency theory to apply to any
  estimators incorporating this conditional density estimator; however,
  in this application, the <inline-formula><alternatives>
  <tex-math><![CDATA[\ell_1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mo>ℓ</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  (i.e., lasso) penalty of the HAL estimator is updated to utilize a
  loss function suitable for density estimation
  (<xref alt="Dudoit &amp; van der Laan, 2005" rid="ref-dudoit2005asymptotics" ref-type="bibr">Dudoit
  &amp; van der Laan, 2005</xref>;
  <xref alt="van der Laan et al., 2004" rid="ref-vdl2004asymptotic" ref-type="bibr">van
  der Laan et al., 2004</xref>). In a final step, the conditional hazard
  estimates are rescaled to conditional density estimates by dividing
  the estimated hazard probabilities by the respective bin widths.</p>
  <p>The advantages derived from the flexibility and rate-convergence
  properties of this algorithm are especially apparent in causal
  inference problems with continuous treatments. In such problems, a key
  nuisance parameter is the generalized propensity score (GPS), the
  conditional density of the treatment, given covariates. This nuisance
  parameter is required to be well-estimated (in a rate-convergence
  sense) for the construction of asymptotically efficient estimators
  (e.g., of treatment effects), which attain the minimal possible
  variance in a given regularity class. Such estimators are desirable
  since, theoretically speaking, they admit the tightest confidence
  intervals and most sensitive hypothesis tests, making inference based
  upon these more informative for downstream decision making. For
  example, the GPS is a nuisance parameter required for estimation of
  the counterfactual mean of a modified treatment policy (MTP)
  (<xref alt="Dı́az &amp; van der Laan, 2018" rid="ref-diaz2018stochastic" ref-type="bibr">Dı́az
  &amp; van der Laan, 2018</xref>;
  <xref alt="Haneuse &amp; Rotnitzky, 2013" rid="ref-haneuse2013estimation" ref-type="bibr">Haneuse
  &amp; Rotnitzky, 2013</xref>), a type of intervention that perturbs
  the natural (or observed) value of the treatment. Doubly robust
  estimators of this counterfactual quantity are implemented in the
  <monospace>txshift</monospace> <monospace>R</monospace> package
  (<xref alt="Hejazi &amp; Benkeser, 2020" rid="ref-hejazi2020txshift-joss" ref-type="bibr">Hejazi
  &amp; Benkeser, 2020</xref>,
  <xref alt="2022" rid="ref-hejazi2022txshift-rpkg" ref-type="bibr">2022</xref>),
  which relies upon <monospace>haldensify</monospace> for estimation of
  the GPS and has been used in estimating counterfactual vaccine
  efficacy based on MTPs interpretable as corresponding to hypothetical
  (next-generation) vaccines that modulate the activity of target
  immunologic biomarkers in vaccine efficacy clinical trials
  (<xref alt="Hejazi, van der Laan, et al., 2020" rid="ref-hejazi2020efficient" ref-type="bibr">Hejazi,
  van der Laan, et al., 2020</xref>). Alternative, asymptotically
  efficient and nonparametric inverse probability weighted (IPW)
  estimators
  (<xref alt="Ertefaie et al., 2022" rid="ref-ertefaie2020nonparametric" ref-type="bibr">Ertefaie
  et al., 2022</xref>) of such counterfactual mean parameters are
  implemented in <monospace>haldensify</monospace>’s
  <monospace>ipw_shift()</monospace> function, which constructs these
  IPW estimators by combining <monospace>haldensify</monospace>’s GPS
  estimator (implemented in the eponymous
  <monospace>haldensify()</monospace> function) with the sieve
  estimation framework to select an asymptotically optimal IPW estimator
  with respect to criteria rooted in semiparametric efficiency theory;
  Hejazi et al.
  (<xref alt="2022" rid="ref-hejazi2022efficient" ref-type="bibr">2022</xref>)
  give a formal description of these novel IPW estimators.</p>
</sec>
<sec id="haldensifys-scope">
  <title><monospace>haldensify</monospace>’s Scope</title>
  <p>The <monospace>haldensify</monospace> <monospace>R</monospace>
  package combines the binning and hazard estimation strategy of Dı́az
  &amp; van der Laan
  (<xref alt="2011" rid="ref-diaz2011super" ref-type="bibr">2011</xref>)
  with HAL regression
  (<xref alt="Benkeser &amp; van der Laan, 2016" rid="ref-benkeser2016highly" ref-type="bibr">Benkeser
  &amp; van der Laan, 2016</xref>), resulting in a flexible,
  nonparametric conditional density estimator. This procedure –
  accessible via the eponymous <monospace>haldensify()</monospace>
  function – relies upon the <monospace>hal9001</monospace>
  <monospace>R</monospace> package
  (<xref alt="Coyle et al., 2022" rid="ref-coyle2022hal9001-rpkg" ref-type="bibr">Coyle
  et al., 2022</xref>;
  <xref alt="Hejazi, Coyle, et al., 2020" rid="ref-hejazi2020hal9001-joss" ref-type="bibr">Hejazi,
  Coyle, et al., 2020</xref>) for the HAL regression step and upon the
  <monospace>origami</monospace> <monospace>R</monospace> package
  (<xref alt="Coyle &amp; Hejazi, 2018" rid="ref-coyle2018origami" ref-type="bibr">Coyle
  &amp; Hejazi, 2018</xref>) for cross-validated selection of tuning
  parameters (e.g., number of bins, <inline-formula><alternatives>
  <tex-math><![CDATA[\ell_1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mo>ℓ</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  regularization) so as to empirically minimize the negative log-density
  loss
  (<xref alt="Dudoit &amp; van der Laan, 2005" rid="ref-dudoit2005asymptotics" ref-type="bibr">Dudoit
  &amp; van der Laan, 2005</xref>). <monospace>haldensify</monospace>
  additionally adjusts the proposal of Dı́az &amp; van der Laan
  (<xref alt="2011" rid="ref-diaz2011super" ref-type="bibr">2011</xref>)
  to (1) incorporate sample-level weights and (2) apply HAL regression
  to the repeated measures data structure in a manner tailored for
  density estimation on the hazard scale. The nonparametric IPW
  estimators of Hejazi et al.
  (<xref alt="2022" rid="ref-hejazi2022efficient" ref-type="bibr">2022</xref>)
  have been implemented in the <monospace>ipw_shift()</monospace>
  function.</p>
  <p>In order to ensure a simplified and minimal API, the
  <monospace>haldensify</monospace> package exposes only a limited set
  of functions: (1) the <monospace>haldensify()</monospace> function,
  which facilitates the estimation of conditional (or marginal)
  densities as described above, and (2) the
  <monospace>ipw_shift()</monospace> function, which implements
  nonparametric IPW estimators of the causal effect of an additive
  modified treatment policy. As IPW estimators require estimation of the
  generalized propensity score as an intermediate (nuisance) step, this
  latter function internally calls the former; moreover, the
  <monospace>ipw_shift()</monospace> function and the various selectors
  to which it provides access (e.g.,
  <monospace>selector_gcv()</monospace> for estimator selection based on
  “global” cross-validation) have been studied from a
  theoretical-methodological perspective in Hejazi et al.
  (<xref alt="2022" rid="ref-hejazi2022efficient" ref-type="bibr">2022</xref>).
  The <monospace>haldensify()</monospace> function is complemented by
  appropriate <monospace>predict()</monospace> and
  <monospace>plot()</monospace> methods, the former to allow for the
  estimated conditional density to be evaluated at new values of the
  variable of interest and its conditioning set and the latter to
  visualize the resultant estimators along the regularization
  trajectory. The <monospace>ipw_shift()</monospace> function is
  accompanied by a corresponding <monospace>confint()</monospace> method
  to easily generate confidence intervals around the IPW point
  estimates. The S3 classes returned by both of these functions have
  custom <monospace>print()</monospace> methods to allow for their
  results to be easily inspected. Several internal utility functions,
  including, for example, <monospace>cv_haldensify()</monospace>,
  <monospace>map_hazard_to_density()</monospace>, and
  <monospace>selector_dcar()</monospace>, implement core aspects of the
  conditional density estimation and nonparametric IPW estimation
  methodology.</p>
</sec>
<sec id="availability">
  <title>Availability</title>
  <p>Future software development efforts will be focused primarily along
  two avenues: (1) improving the computational aspects of the
  conditional density estimation procedure, possibly to include random
  sampling from the internally generated repeated measures dataset, and
  (2) further adjustments to the undersmoothing estimator selection
  strategies implemented for nonparametric IPW estimation, to be based
  on future methodological progress. Software maintenance efforts will
  focus on ensuring that the package remains compatible with future
  versions of the <monospace>hal9001</monospace> package
  (<xref alt="Coyle et al., 2022" rid="ref-coyle2022hal9001-rpkg" ref-type="bibr">Coyle
  et al., 2022</xref>;
  <xref alt="Hejazi, Coyle, et al., 2020" rid="ref-hejazi2020hal9001-joss" ref-type="bibr">Hejazi,
  Coyle, et al., 2020</xref>). Currently, stable releases of the
  <monospace>haldensify</monospace> package are made available via the
  Comprehensive <monospace>R</monospace> Archive Network (CRAN,
  <xref alt="R Core Team, 2022" rid="ref-R" ref-type="bibr">R Core Team,
  2022</xref>) at https://CRAN.R-project.org/package=haldensify, while
  development efforts are carried out on the package’s
  version-controlled repository, publicly hosted at
  https://github.com/nhejazi/haldensify. To date (mid-September 2022),
  CRAN records indicate that <monospace>haldensify</monospace> has been
  downloaded over 14,400 times.</p>
</sec>
<sec id="acknowledgments">
  <title>Acknowledgments</title>
  <p>NSH’s contributions to this work were supported in part by a grant
  from the National Science Foundation (award number
  <ext-link ext-link-type="uri" xlink:href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2102840">DMS
  2102840</ext-link>).</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-diaz2018stochastic">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Dı́az</surname><given-names>Iván</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>Stochastic treatment regimes</article-title>
      <source>Targeted learning in data science: Causal inference for complex longitudinal studies</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <uri>https://doi.org/10.1007/978-3-319-65304-4_14</uri>
      <pub-id pub-id-type="doi">10.1007/978-3-319-65304-4_14</pub-id>
      <fpage>167</fpage>
      <lpage>180</lpage>
    </element-citation>
  </ref>
  <ref id="ref-diaz2012population">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dı́az</surname><given-names>Iván</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>Population intervention causal effects based on stochastic interventions</article-title>
      <source>Biometrics</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2012">2012</year>
      <volume>68</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1111/j.1541-0420.2011.01685.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.1541-0420.2011.01685.x</pub-id>
      <fpage>541</fpage>
      <lpage>549</lpage>
    </element-citation>
  </ref>
  <ref id="ref-diaz2011super">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dı́az</surname><given-names>Iván</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>Super learner based conditional density estimation with application to marginal structural models</article-title>
      <source>International Journal of Biostatistics</source>
      <publisher-name>De Gruyter</publisher-name>
      <year iso-8601-date="2011">2011</year>
      <volume>7</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.2202/1557-4679.1356</uri>
      <pub-id pub-id-type="doi">10.2202/1557-4679.1356</pub-id>
      <fpage>1</fpage>
      <lpage>20</lpage>
    </element-citation>
  </ref>
  <ref id="ref-vdl2017generally">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>A generally efficient targeted minimum loss-based estimator based on the highly adaptive lasso</article-title>
      <source>International Journal of Biostatistics</source>
      <publisher-name>De Gruyter</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>13</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1515/ijb-2015-0097</uri>
      <pub-id pub-id-type="doi">10.1515/ijb-2015-0097</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-coyle2022hal9001-rpkg">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Coyle</surname><given-names>Jeremy R</given-names></name>
        <name><surname>Hejazi</surname><given-names>Nima S</given-names></name>
        <name><surname>Phillips</surname><given-names>Rachael V</given-names></name>
        <name><surname>van der Laan</surname><given-names>Lars WP</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <source>hal9001: The scalable highly adaptive lasso</source>
      <year iso-8601-date="2022">2022</year>
      <uri>https://CRAN.R-project.org/package=hal9001</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.3558313</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-hejazi2020hal9001-joss">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hejazi</surname><given-names>Nima S</given-names></name>
        <name><surname>Coyle</surname><given-names>Jeremy R</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>hal9001: Scalable highly adaptive lasso regression in R</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <uri>https://doi.org/10.21105/joss.02526</uri>
      <pub-id pub-id-type="doi">10.21105/joss.02526</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-benkeser2016highly">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Benkeser</surname><given-names>David</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>The highly adaptive lasso estimator</article-title>
      <source>Proceedings of the international conference on data science and advanced analytics</source>
      <publisher-name>NIH Public Access</publisher-name>
      <year iso-8601-date="2016">2016</year>
      <volume>2016</volume>
      <uri>https://doi.org/10.1109/dsaa.2016.93</uri>
      <pub-id pub-id-type="doi">10.1109/dsaa.2016.93</pub-id>
      <fpage>689</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-hirano2004propensity">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hirano</surname><given-names>Keisuke</given-names></name>
        <name><surname>Imbens</surname><given-names>Guido W</given-names></name>
      </person-group>
      <article-title>The propensity score with continuous treatments</article-title>
      <source>Applied Bayesian Modeling and Causal Inference from Incomplete-data Perspectives</source>
      <year iso-8601-date="2004">2004</year>
      <volume>226164</volume>
      <fpage>73</fpage>
      <lpage>84</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zhu2015boosting">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhu</surname><given-names>Yeying</given-names></name>
        <name><surname>Coffman</surname><given-names>Donna L</given-names></name>
        <name><surname>Ghosh</surname><given-names>Debashis</given-names></name>
      </person-group>
      <article-title>A boosting algorithm for estimating generalized propensity scores with continuous treatments</article-title>
      <source>Journal of Causal Inference</source>
      <publisher-name>De Gruyter</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>3</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1515/jci-2014-0022</uri>
      <pub-id pub-id-type="doi">10.1515/jci-2014-0022</pub-id>
      <fpage>25</fpage>
      <lpage>40</lpage>
    </element-citation>
  </ref>
  <ref id="ref-imai2004causal">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Imai</surname><given-names>Kosuke</given-names></name>
        <name><surname>Van Dyk</surname><given-names>David A</given-names></name>
      </person-group>
      <article-title>Causal inference with general treatment regimes: Generalizing the propensity score</article-title>
      <source>Journal of the American Statistical Association</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2004">2004</year>
      <volume>99</volume>
      <issue>467</issue>
      <fpage>854</fpage>
      <lpage>866</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ertefaie2020nonparametric">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ertefaie</surname><given-names>Ashkan</given-names></name>
        <name><surname>Hejazi</surname><given-names>Nima S</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>Nonparametric inverse-probability-weighted estimators based on the highly adaptive lasso</article-title>
      <source>Biometrics</source>
      <year iso-8601-date="2022">2022</year>
      <volume>(in press)</volume>
      <issue></issue>
      <uri>https://doi.org/10.1111/biom.13719</uri>
      <pub-id pub-id-type="doi">10.1111/biom.13719</pub-id>
      <fpage></fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-hejazi2022efficient">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hejazi</surname><given-names>Nima S</given-names></name>
        <name><surname>Benkeser</surname><given-names>David</given-names></name>
        <name><surname>Dı́az</surname><given-names>Iván</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>Efficient estimation of modified treatment policy effects based on the generalized propensity score</article-title>
      <source></source>
      <year iso-8601-date="2022">2022</year>
      <volume></volume>
      <issue></issue>
      <uri>https://arxiv.org/abs/2205.05777</uri>
      <pub-id pub-id-type="doi"></pub-id>
      <fpage></fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-takeuchi2009nonparametric">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Takeuchi</surname><given-names>Ichiro</given-names></name>
        <name><surname>Nomura</surname><given-names>Kaname</given-names></name>
        <name><surname>Kanamori</surname><given-names>Takafumi</given-names></name>
      </person-group>
      <article-title>Nonparametric conditional density estimation using piecewise-linear solution path of kernel quantile regression</article-title>
      <source>Neural Computation</source>
      <publisher-name>MIT Press</publisher-name>
      <year iso-8601-date="2009">2009</year>
      <volume>21</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1162/neco.2008.10-07-628</uri>
      <pub-id pub-id-type="doi">10.1162/neco.2008.10-07-628</pub-id>
      <fpage>533</fpage>
      <lpage>559</lpage>
    </element-citation>
  </ref>
  <ref id="ref-neuneier1994estimation">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Neuneier</surname><given-names>R</given-names></name>
        <name><surname>Hergert</surname><given-names>F</given-names></name>
        <name><surname>Finnoff</surname><given-names>W</given-names></name>
        <name><surname>Ormoneit</surname><given-names>D</given-names></name>
      </person-group>
      <article-title>Estimation of conditional densities: A comparison of neural network approaches</article-title>
      <source>International conference on artificial neural networks</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="1994">1994</year>
      <uri>https://doi.org/10.1007/978-1-4471-2097-1_162</uri>
      <pub-id pub-id-type="doi">10.1007/978-1-4471-2097-1_162</pub-id>
      <fpage>689</fpage>
      <lpage>692</lpage>
    </element-citation>
  </ref>
  <ref id="ref-R">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>R Core Team</string-name>
      </person-group>
      <source>: A language and environment for statistical computing</source>
      <publisher-name>R Foundation for Statistical Computing</publisher-name>
      <publisher-loc>Vienna, Austria</publisher-loc>
      <year iso-8601-date="2022">2022</year>
      <uri>https://www.R-project.org/</uri>
    </element-citation>
  </ref>
  <ref id="ref-coyle2018origami">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Coyle</surname><given-names>Jeremy R</given-names></name>
        <name><surname>Hejazi</surname><given-names>Nima S</given-names></name>
      </person-group>
      <article-title>origami: A generalized framework for cross-validation in R</article-title>
      <source>The Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>3</volume>
      <issue>21</issue>
      <uri>https://doi.org/10.21105/joss.00512</uri>
      <pub-id pub-id-type="doi">10.21105/joss.00512</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-vdl2015generally">
    <element-citation publication-type="report">
      <person-group person-group-type="author">
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>A generally efficient targeted minimum loss based estimator</article-title>
      <publisher-name>University of California, Berkeley</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <uri>https://biostats.bepress.com/ucbbiostat/paper343/</uri>
    </element-citation>
  </ref>
  <ref id="ref-vdl2004asymptotic">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
        <name><surname>Dudoit</surname><given-names>Sandrine</given-names></name>
        <name><surname>Keles</surname><given-names>Sunduz</given-names></name>
      </person-group>
      <article-title>Asymptotic optimality of likelihood-based cross-validation</article-title>
      <source>Statistical Applications in Genetics and Molecular Biology</source>
      <year iso-8601-date="2004">2004</year>
      <volume>3</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.2202/1544-6115.1036</uri>
      <pub-id pub-id-type="doi">10.2202/1544-6115.1036</pub-id>
      <fpage>1</fpage>
      <lpage>23</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dudoit2005asymptotics">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dudoit</surname><given-names>Sandrine</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
      </person-group>
      <article-title>Asymptotics of cross-validated risk estimation in estimator selection and performance assessment</article-title>
      <source>Statistical Methodology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2005">2005</year>
      <volume>2</volume>
      <issue>2</issue>
      <uri>https://doi.org/10.1016/j.stamet.2005.02.003</uri>
      <pub-id pub-id-type="doi">10.1016/j.stamet.2005.02.003</pub-id>
      <fpage>131</fpage>
      <lpage>154</lpage>
    </element-citation>
  </ref>
  <ref id="ref-bibaut2019fast">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bibaut</surname><given-names>Aurélien F</given-names></name>
        <name><surname>Laan</surname><given-names>Mark J van der</given-names></name>
      </person-group>
      <article-title>Fast rates for empirical risk minimization with cadlag losses with bounded sectional variation norm</article-title>
      <source>arXiv preprint arXiv:1907.09244</source>
      <year iso-8601-date="2019">2019</year>
      <uri>https://arxiv.org/abs/1907.09244</uri>
    </element-citation>
  </ref>
  <ref id="ref-hejazi2020efficient">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hejazi</surname><given-names>Nima S</given-names></name>
        <name><surname>van der Laan</surname><given-names>Mark J</given-names></name>
        <name><surname>Janes</surname><given-names>Holly E</given-names></name>
        <name><surname>Gilbert</surname><given-names>Peter B</given-names></name>
        <name><surname>Benkeser</surname><given-names>David C</given-names></name>
      </person-group>
      <article-title>Efficient nonparametric inference on the effects of stochastic interventions under two-phase sampling, with applications to vaccine efficacy trials</article-title>
      <source>Biometrics</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <volume>77</volume>
      <issue>4</issue>
      <uri>https://doi.org/10.1111/biom.13375</uri>
      <pub-id pub-id-type="doi">10.1111/biom.13375</pub-id>
      <fpage>1241</fpage>
      <lpage>1253</lpage>
    </element-citation>
  </ref>
  <ref id="ref-haneuse2013estimation">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Haneuse</surname><given-names>Sebastian</given-names></name>
        <name><surname>Rotnitzky</surname><given-names>A</given-names></name>
      </person-group>
      <article-title>Estimation of the effect of interventions that modify the received treatment</article-title>
      <source>Statistics in Medicine</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>32</volume>
      <issue>30</issue>
      <uri>https://doi.org/10.1002/sim.5907</uri>
      <pub-id pub-id-type="doi">10.1002/sim.5907</pub-id>
      <fpage>5260</fpage>
      <lpage>5277</lpage>
    </element-citation>
  </ref>
  <ref id="ref-rosenbaum1983central">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rosenbaum</surname><given-names>Paul R</given-names></name>
        <name><surname>Rubin</surname><given-names>Donald B</given-names></name>
      </person-group>
      <article-title>The central role of the propensity score in observational studies for causal effects</article-title>
      <source>Biometrika</source>
      <publisher-name>Biometrika Trust</publisher-name>
      <year iso-8601-date="1983">1983</year>
      <volume>70</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1017/cbo9780511810725.016</uri>
      <pub-id pub-id-type="doi">10.1017/cbo9780511810725.016</pub-id>
      <fpage>41</fpage>
      <lpage>55</lpage>
    </element-citation>
  </ref>
  <ref id="ref-cheng2004semiparametric">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Cheng</surname><given-names>Kuang Fu</given-names></name>
        <name><surname>Chu</surname><given-names>Chih-Kang</given-names></name>
      </person-group>
      <article-title>Semiparametric density estimation under a two-sample density ratio model</article-title>
      <source>Bernoulli</source>
      <publisher-name>Bernoulli Society for Mathematical Statistics; Probability</publisher-name>
      <year iso-8601-date="2004">2004</year>
      <volume>10</volume>
      <issue>4</issue>
      <uri>https://doi.org/10.3150/bj/1093265631</uri>
      <pub-id pub-id-type="doi">10.3150/bj/1093265631</pub-id>
      <fpage>583</fpage>
      <lpage>604</lpage>
    </element-citation>
  </ref>
  <ref id="ref-qin1998inferences">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Qin</surname><given-names>Jing</given-names></name>
      </person-group>
      <article-title>Inferences for case-control and semiparametric two-sample density ratio models</article-title>
      <source>Biometrika</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="1998">1998</year>
      <volume>85</volume>
      <issue>3</issue>
      <uri>https://doi.org/10.1093/biomet/85.3.619</uri>
      <pub-id pub-id-type="doi">10.1093/biomet/85.3.619</pub-id>
      <fpage>619</fpage>
      <lpage>630</lpage>
    </element-citation>
  </ref>
  <ref id="ref-sugiyama2012density">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Sugiyama</surname><given-names>Masashi</given-names></name>
        <name><surname>Suzuki</surname><given-names>Taiji</given-names></name>
        <name><surname>Kanamori</surname><given-names>Takafumi</given-names></name>
      </person-group>
      <source>Density ratio estimation in machine learning</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2012">2012</year>
    </element-citation>
  </ref>
  <ref id="ref-hejazi2022txshift-rpkg">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Hejazi</surname><given-names>Nima S</given-names></name>
        <name><surname>Benkeser</surname><given-names>David C</given-names></name>
      </person-group>
      <source>txshift: Efficient estimation of the causal effects of stochastic interventions</source>
      <year iso-8601-date="2022">2022</year>
      <uri>https://github.com/nhejazi/txshift</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.4070042</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-hejazi2020txshift-joss">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hejazi</surname><given-names>Nima S</given-names></name>
        <name><surname>Benkeser</surname><given-names>David C</given-names></name>
      </person-group>
      <article-title>txshift: Efficient estimation of the causal effects of stochastic interventions in R</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2020-10">2020</year><month>10</month>
      <volume>5</volume>
      <issue>54</issue>
      <pub-id pub-id-type="doi">10.21105/joss.02447</pub-id>
      <fpage>2447</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
