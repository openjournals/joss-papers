<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8836</article-id>
<article-id pub-id-type="doi">10.21105/joss.08836</article-id>
<title-group>
<article-title>ml4gw: PyTorch utilities for training neural networks in
gravitational wave physics applications</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4750-9413</contrib-id>
<name>
<surname>Benoit</surname>
<given-names>William</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0000-4183-7876</contrib-id>
<name>
<surname>Marx</surname>
<given-names>Ethan</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0038-5468</contrib-id>
<name>
<surname>Chatterjee</surname>
<given-names>Deep</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kumar</surname>
<given-names>Ravi</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gunny</surname>
<given-names>Alec</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>University of Minnesota, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Massachusetts Institute of Technology, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>MIT LIGO Laboratory, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Indian Institute of Technology Bombay, India</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-04-01">
<day>1</day>
<month>4</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>114</issue>
<fpage>8836</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>PyTorch</kwd>
<kwd>machine learning</kwd>
<kwd>gravitational waves</kwd>
<kwd>signal processing</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>ml4gw</monospace> is a lightweight, PyTorch-based
  library designed to support the development, scaling, and deployment
  of machine learning (ML) models for gravitational-wave (GW) data
  analysis. Built to provide familiar functionality to anyone used to
  working with standard CPU-based GW libraries,
  <monospace>ml4gw</monospace> lowers the barrier to entry for GW
  researchers who want to incorporate ML into their work and take
  advantage of optimized hardware. Its design focuses on bridging the
  gap between domain-specific GW signal processing and general-purpose
  ML development, allowing researchers to build the tools needed to
  accomplish their scientific goals without getting stuck on
  infrastructure overhead. By simplifying the interface between domain
  science and model training, <monospace>ml4gw</monospace> accelerates
  the creation of robust, physically-informed ML pipelines for
  gravitational-wave astrophysics.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Machine-learning algorithms are well-suited for applications in GW
  astrophysics due to the field’s abundance of high-quality data. The
  existence of multiple independent GW detectors allows for effectively
  unlimited combinations of noise samples via time-shifts, and, for the
  most common signal morphologies, the high-fidelity simulations
  provided by General Relativity allow as many signal samples as
  desired. However, the standard GW libraries are not designed for the
  scale or speed desired for ML development; conversely, standard ML
  libraries lack the domain-specific preprocessing functions and
  waveform handling tools required to train models for GW
  applications.</p>
  <sec id="key-features">
    <title>Key Features</title>
    <p><monospace>ml4gw</monospace> addresses this gap by re-writing
    common GW processing steps as PyTorch
    (<xref alt="Paszke et al., 2019" rid="ref-paszke2019pytorch" ref-type="bibr">Paszke
    et al., 2019</xref>) modules, taking advantage of the natural
    parallelization that comes with PyTorch’s batch processing, and
    adding the option to accelerate these steps using GPUs and other
    coprocessors supported by the PyTorch framework. From libraries such
    as GWpy
    (<xref alt="Macleod et al., 2021" rid="ref-gwpy" ref-type="bibr">Macleod
    et al., 2021</xref>), <monospace>ml4gw</monospace> re-implements
    power spectral density estimation, signal-to-noise ratio
    calculation, whitening filters, and Q-transforms. Like bilby
    (<xref alt="Ashton et al., 2019" rid="ref-bilby" ref-type="bibr">Ashton
    et al., 2019</xref>), <monospace>ml4gw</monospace> provides the
    functionality to sample from astrophysical parameter distributions,
    which can then be used to simulate waveforms, mimicking the
    simulation features of lalsuite
    (<xref alt="LIGO Scientific Collaboration et al., 2018" rid="ref-lalsuite" ref-type="bibr">LIGO
    Scientific Collaboration et al., 2018</xref>).
    <monospace>ml4gw</monospace> has available basic compact binary
    merger waveform families used in online searches and inference
    (TaylorF2, IMRPhenomD, and IMRPhenomPv2), as well as sine-Gaussian
    waveforms for capturing unmodeled GW signals, with more complex
    waveforms planned for the future. All of these modules have been
    designed to work with batches of multi-channel time-series data, run
    on accelerated hardware, and be composable so that the output of one
    function can easily become the input of another.</p>
    <p>Additionally, <monospace>ml4gw</monospace> contains a number of
    general utility features:</p>
    <list list-type="bullet">
      <list-item>
        <p>Efficient out-of-memory dataloading to scale the quantity of
        data used for training</p>
      </list-item>
      <list-item>
        <p>Random sampling of windows from batches of multi-channel
        time-series data</p>
      </list-item>
      <list-item>
        <p>On-the-fly signal generation for efficient scaling of
        training data</p>
      </list-item>
      <list-item>
        <p>Cubic spline interpolation to supplement PyTorch’s existing
        interpolation functions</p>
      </list-item>
      <list-item>
        <p>Basic out-of-the-box neural network architectures to
        streamline the startup process for new users</p>
      </list-item>
      <list-item>
        <p>Stateful modules for handling streaming data</p>
      </list-item>
    </list>
    <p>All implementations are fully differentiable, allowing algorithms
    to employ physically-motivated loss functions. These features make
    it possible to train models on large quantities realistic detector
    data, perform data augmentation consistent with physical priors, and
    evaluate results in a way that is directly comparable with existing
    pipelines.</p>
  </sec>
  <sec id="downstream-applications">
    <title>Downstream Applications</title>
    <p><monospace>ml4gw</monospace> is used to support the development
    of multiple GW analyses. It has been integrated into
    <monospace>DeepClean</monospace>
    (<xref alt="Saleem et al., 2024" rid="ref-deepclean" ref-type="bibr">Saleem
    et al., 2024</xref>), a noise-subtraction pipeline;
    <monospace>Aframe</monospace>
    (<xref alt="Marx et al., 2025" rid="ref-aframe" ref-type="bibr">Marx
    et al., 2025</xref>), a search pipeline for gravitational waves from
    compact binary mergers; GWAK
    (<xref alt="Raikman et al., 2024" rid="ref-gwak" ref-type="bibr">Raikman
    et al., 2024</xref>), a gravitational-wave anomaly detection
    pipeline; and AMPLFI
    (<xref alt="Chatterjee et al., 2024" rid="ref-amplfi" ref-type="bibr">Chatterjee
    et al., 2024</xref>), a gravitational-wave parameter estimation
    pipelines. <monospace>ml4gw</monospace> has enabled these algorithms
    to efficiently train ML models at scale and deploy models on
    real-time streaming data, while the use of a standardized tool set
    has allowed for easier communication between developers. The library
    is actively developed and maintained, with thorough unit testing,
    and the authors welcome contributions and collaborations for other
    possible use-cases.</p>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work was supported by the U.S. National Science Foundation
  (NSF) Harnessing the Data Revolution (HDR) Institute for Accelerating
  AI Algorithms for Data Driven Discovery (A3D3) under Cooperative
  Agreement No. PHY-2117997.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-bilby">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ashton</surname><given-names>Gregory</given-names></name>
        <name><surname>Hübner</surname><given-names>Moritz</given-names></name>
        <name><surname>Lasky</surname><given-names>Paul D.</given-names></name>
        <name><surname>Talbot</surname><given-names>Colm</given-names></name>
        <name><surname>Ackley</surname><given-names>Kendall</given-names></name>
        <name><surname>Biscoveanu</surname><given-names>Sylvia</given-names></name>
        <name><surname>Chu</surname><given-names>Qi</given-names></name>
        <name><surname>Divakarla</surname><given-names>Atul</given-names></name>
        <name><surname>Easter</surname><given-names>Paul J.</given-names></name>
        <name><surname>Goncharov</surname><given-names>Boris</given-names></name>
        <name><surname>Hernandez Vivanco</surname><given-names>Francisco</given-names></name>
        <name><surname>Harms</surname><given-names>Jan</given-names></name>
        <name><surname>Lower</surname><given-names>Marcus E.</given-names></name>
        <name><surname>Meadors</surname><given-names>Grant D.</given-names></name>
        <name><surname>Melchor</surname><given-names>Denyz</given-names></name>
        <name><surname>Payne</surname><given-names>Ethan</given-names></name>
        <name><surname>Pitkin</surname><given-names>Matthew D.</given-names></name>
        <name><surname>Powell</surname><given-names>Jade</given-names></name>
        <name><surname>Sarin</surname><given-names>Nikhil</given-names></name>
        <name><surname>Smith</surname><given-names>Rory J. E.</given-names></name>
        <name><surname>Thrane</surname><given-names>Eric</given-names></name>
      </person-group>
      <article-title>BILBY: A User-friendly Bayesian Inference Library for Gravitational-wave Astronomy</article-title>
      <source></source>
      <year iso-8601-date="2019-04">2019</year><month>04</month>
      <volume>241</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/1811.02042</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4365/ab06fc</pub-id>
      <fpage>27</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-gwpy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Macleod</surname><given-names>D. M.</given-names></name>
        <name><surname>Areeda</surname><given-names>J. S.</given-names></name>
        <name><surname>Coughlin</surname><given-names>S. B.</given-names></name>
        <name><surname>Massinger</surname><given-names>T. J.</given-names></name>
        <name><surname>Urban</surname><given-names>A. L.</given-names></name>
      </person-group>
      <article-title>GWpy: A Python package for gravitational-wave astrophysics</article-title>
      <source>SoftwareX</source>
      <year iso-8601-date="2021">2021</year>
      <volume>13</volume>
      <issn>2352-7110</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S2352711021000029</uri>
      <pub-id pub-id-type="doi">10.1016/j.softx.2021.100657</pub-id>
      <fpage>100657</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-lalsuite">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>LIGO Scientific Collaboration</string-name>
        <string-name>Virgo Collaboration</string-name>
        <string-name>KAGRA Collaboration</string-name>
      </person-group>
      <article-title>LVK Algorithm Library - LALSuite</article-title>
      <publisher-name>Free software (GPL)</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <pub-id pub-id-type="doi">10.7935/GT1W-FZ16</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-paszke2019pytorch">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Paszke</surname><given-names>Adam</given-names></name>
        <name><surname>Gross</surname><given-names>Sam</given-names></name>
        <name><surname>Massa</surname><given-names>Francisco</given-names></name>
        <name><surname>Lerer</surname><given-names>Adam</given-names></name>
        <name><surname>Bradbury</surname><given-names>James</given-names></name>
        <name><surname>Chanan</surname><given-names>Gregory</given-names></name>
        <name><surname>Killeen</surname><given-names>Trevor</given-names></name>
        <name><surname>Lin</surname><given-names>Zeming</given-names></name>
        <name><surname>Gimelshein</surname><given-names>Natalia</given-names></name>
        <name><surname>Antiga</surname><given-names>Luca</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Pytorch: An imperative style, high-performance deep learning library</article-title>
      <source>Advances in neural information processing systems</source>
      <year iso-8601-date="2019">2019</year>
      <volume>32</volume>
    </element-citation>
  </ref>
  <ref id="ref-amplfi">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chatterjee</surname><given-names>D</given-names></name>
        <name><surname>Marx</surname><given-names>E</given-names></name>
        <name><surname>Benoit</surname><given-names>W</given-names></name>
        <name><surname>Kumar</surname><given-names>R</given-names></name>
        <name><surname>Desai</surname><given-names>M</given-names></name>
        <name><surname>Govorkova</surname><given-names>E</given-names></name>
        <name><surname>Gunny</surname><given-names>A</given-names></name>
        <name><surname>Moreno</surname><given-names>E</given-names></name>
        <name><surname>Omer</surname><given-names>R</given-names></name>
        <name><surname>Raikman</surname><given-names>R</given-names></name>
        <name><surname>Saleem</surname><given-names>M</given-names></name>
        <name><surname>Aggarwal</surname><given-names>S</given-names></name>
        <name><surname>Coughlin</surname><given-names>M W</given-names></name>
        <name><surname>Harris</surname><given-names>P</given-names></name>
        <name><surname>Katsavounidis</surname><given-names>E</given-names></name>
      </person-group>
      <article-title>Rapid likelihood free inference of compact binary coalescences using accelerated hardware</article-title>
      <source>Machine Learning: Science and Technology</source>
      <publisher-name>IOP Publishing</publisher-name>
      <year iso-8601-date="2024-10">2024</year><month>10</month>
      <volume>5</volume>
      <issue>4</issue>
      <uri>https://dx.doi.org/10.1088/2632-2153/ad8982</uri>
      <pub-id pub-id-type="doi">10.1088/2632-2153/ad8982</pub-id>
      <fpage>045030</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-aframe">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Marx</surname><given-names>Ethan</given-names></name>
        <name><surname>Benoit</surname><given-names>William</given-names></name>
        <name><surname>Gunny</surname><given-names>Alec</given-names></name>
        <name><surname>Omer</surname><given-names>Rafia</given-names></name>
        <name><surname>Chatterjee</surname><given-names>Deep</given-names></name>
        <name><surname>Venterea</surname><given-names>Ricco C.</given-names></name>
        <name><surname>Wills</surname><given-names>Lauren</given-names></name>
        <name><surname>Saleem</surname><given-names>Muhammed</given-names></name>
        <name><surname>Moreno</surname><given-names>Eric</given-names></name>
        <name><surname>Raikman</surname><given-names>Ryan</given-names></name>
        <name><surname>Govorkova</surname><given-names>Ekaterina</given-names></name>
        <name><surname>Desai</surname><given-names>Malina</given-names></name>
        <name><surname>Krupa</surname><given-names>Jeffrey</given-names></name>
        <name><surname>Rankin</surname><given-names>Dylan</given-names></name>
        <name><surname>Coughlin</surname><given-names>Michael W.</given-names></name>
        <name><surname>Harris</surname><given-names>Philip</given-names></name>
        <name><surname>Katsavounidis</surname><given-names>Erik</given-names></name>
      </person-group>
      <article-title>Machine-learning pipeline for real-time detection of gravitational waves from compact binary coalescences</article-title>
      <source>Phys. Rev. D</source>
      <publisher-name>American Physical Society</publisher-name>
      <year iso-8601-date="2025-02">2025</year><month>02</month>
      <volume>111</volume>
      <uri>https://link.aps.org/doi/10.1103/PhysRevD.111.042010</uri>
      <pub-id pub-id-type="doi">10.1103/PhysRevD.111.042010</pub-id>
      <fpage>042010</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-gwak">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Raikman</surname><given-names>Ryan</given-names></name>
        <name><surname>Moreno</surname><given-names>Eric A</given-names></name>
        <name><surname>Govorkova</surname><given-names>Ekaterina</given-names></name>
        <name><surname>Marx</surname><given-names>Ethan J</given-names></name>
        <name><surname>Gunny</surname><given-names>Alec</given-names></name>
        <name><surname>Benoit</surname><given-names>William</given-names></name>
        <name><surname>Chatterjee</surname><given-names>Deep</given-names></name>
        <name><surname>Omer</surname><given-names>Rafia</given-names></name>
        <name><surname>Saleem</surname><given-names>Muhammed</given-names></name>
        <name><surname>Rankin</surname><given-names>Dylan S</given-names></name>
        <name><surname>Coughlin</surname><given-names>Michael W</given-names></name>
        <name><surname>Harris</surname><given-names>Philip C</given-names></name>
        <name><surname>Katsavounidis</surname><given-names>Erik</given-names></name>
      </person-group>
      <article-title>GWAK: Gravitational-wave anomalous knowledge with recurrent autoencoders</article-title>
      <source>Machine Learning: Science and Technology</source>
      <publisher-name>IOP Publishing</publisher-name>
      <year iso-8601-date="2024-04">2024</year><month>04</month>
      <volume>5</volume>
      <issue>2</issue>
      <uri>https://dx.doi.org/10.1088/2632-2153/ad3a31</uri>
      <pub-id pub-id-type="doi">10.1088/2632-2153/ad3a31</pub-id>
      <fpage>025020</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deepclean">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Saleem</surname><given-names>Muhammed</given-names></name>
        <name><surname>Gunny</surname><given-names>Alec</given-names></name>
        <name><surname>Chou</surname><given-names>Chia-Jui</given-names></name>
        <name><surname>Yang</surname><given-names>Li-Cheng</given-names></name>
        <name><surname>Yeh</surname><given-names>Shu-Wei</given-names></name>
        <name><surname>Chen</surname><given-names>Andy H Y</given-names></name>
        <name><surname>Magee</surname><given-names>Ryan</given-names></name>
        <name><surname>Benoit</surname><given-names>William</given-names></name>
        <name><surname>Nguyen</surname><given-names>Tri</given-names></name>
        <name><surname>Fan</surname><given-names>Pinchen</given-names></name>
        <name><surname>Chatterjee</surname><given-names>Deep</given-names></name>
        <name><surname>Marx</surname><given-names>Ethan</given-names></name>
        <name><surname>Moreno</surname><given-names>Eric</given-names></name>
        <name><surname>Omer</surname><given-names>Rafia</given-names></name>
        <name><surname>Raikman</surname><given-names>Ryan</given-names></name>
        <name><surname>Rankin</surname><given-names>Dylan</given-names></name>
        <name><surname>Sharma</surname><given-names>Ritwik</given-names></name>
        <name><surname>Coughlin</surname><given-names>Michael</given-names></name>
        <name><surname>Harris</surname><given-names>Philip</given-names></name>
        <name><surname>Katsavounidis</surname><given-names>Erik</given-names></name>
      </person-group>
      <article-title>Demonstration of machine learning-assisted low-latency noise regression in gravitational wave detectors</article-title>
      <source>Classical and Quantum Gravity</source>
      <publisher-name>IOP Publishing</publisher-name>
      <year iso-8601-date="2024-09">2024</year><month>09</month>
      <volume>41</volume>
      <issue>19</issue>
      <uri>https://dx.doi.org/10.1088/1361-6382/ad708a</uri>
      <pub-id pub-id-type="doi">10.1088/1361-6382/ad708a</pub-id>
      <fpage>195024</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
