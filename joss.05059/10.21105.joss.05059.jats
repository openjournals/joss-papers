<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">5059</article-id>
<article-id pub-id-type="doi">10.21105/joss.05059</article-id>
<title-group>
<article-title>TopoPyScale: A Python Package for Hillslope Climate
Downscaling</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1282-7307</contrib-id>
<name>
<surname>Filhol</surname>
<given-names>Simon</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2870-6972</contrib-id>
<name>
<surname>Fiddes</surname>
<given-names>Joel</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2475-3731</contrib-id>
<name>
<surname>Aalstad</surname>
<given-names>Kristoffer</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Geosciences, University of Oslo,
Norway</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>WSL Institute for Snow and Avalanche Research SLF,
Switzerland</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2023-06-15">
<day>15</day>
<month>6</month>
<year>2023</year>
</pub-date>
<volume>8</volume>
<issue>86</issue>
<fpage>5059</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>climate science</kwd>
<kwd>downscaling</kwd>
<kwd>xarray</kwd>
<kwd>dem segmentation</kwd>
<kwd>snow</kwd>
<kwd>permafrost</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Global climate reanalyses and projections are available worldwide
  for the past and coming century. However, model grids remain too
  coarse to be directly relevant at the hillslope-scale
  (<xref alt="Fan et al., 2019" rid="ref-fanetal2019" ref-type="bibr">Fan
  et al., 2019</xref>), requiring adapted downscaling tools to account
  for the effects of local topography. Mountain regions are experiencing
  accelerated warming with the cryosphere rapidly responding to climate
  change. To understand and study geomorphological, hydrological, and
  glaciological changes, we need tools to downscale meteorological
  timeseries for the basic atmospheric variables used to solve surface
  energy and mass balance in process-based models. Advanced dynamical
  downscaling methods exist, though they come with a high computational
  cost and complex technical setup
  (<xref alt="Kruyt et al., 2022" rid="ref-Kruyt2022" ref-type="bibr">Kruyt
  et al., 2022</xref>). <monospace>TopoPyScale</monospace> uses a
  pragmatic approach to downscaling by minimizing complexity, reducing
  computational cost, simplifying interoperability with land surface
  models, while retaining physical coherence and allowing the primary
  drivers of land surface-atmosphere interaction to be considered. The
  toolbox is designed to be flexible in its usage and development.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p><monospace>TopoPyScale</monospace> is a community supported
  open-source Python package for performing climate downscaling
  following the initial work of Fiddes &amp; Gruber
  (<xref alt="2014" rid="ref-fiddesTopoSCALEDownscalingGridded2014" ref-type="bibr">2014</xref>)
  and Fiddes &amp; Gruber
  (<xref alt="2012" rid="ref-fiddesTopoSUBToolEfficient2012" ref-type="bibr">2012</xref>).
  It is designed as a toolbox combining computationally efficient
  methods to downscale climate reanalysis and projections
  (<xref alt="Hersbach et al., 2020" rid="ref-hersbachERA5GlobalReanalysis2020" ref-type="bibr">Hersbach
  et al., 2020</xref>). At the moment, atmospheric climate models are
  typically run at a coarse spatial resolution (25 km for ERA5), missing
  the heterogeneity imposed by the topography of mountain ranges on
  atmospheric variables.
  <xref alt="[fig:temp_comp]" rid="figU003Atemp_comp">[fig:temp_comp]</xref>
  shows an example of a downscaled temperature field for January 1, 2020
  at 12:00 computed with <monospace>TopoPyScale</monospace> using ERA5
  data as input. <monospace>TopoPyScale</monospace> allows one to
  reconstruct the variability of temperatures observed in between
  valleys and mountain tops within one single ERA5 grid cell. This
  method is now used in a number of studies to investigate geophysical
  processes such as geomorphological dynamics of permafrost
  (<xref alt="Renette et al., 2022" rid="ref-esurf-2022-39" ref-type="bibr">Renette
  et al., 2022</xref>), the hydrology of mountain catchments
  (<xref alt="Fiddes et al., 2019" rid="ref-hess-23-4717-2019" ref-type="bibr">Fiddes
  et al., 2019</xref>), mountain glaciers
  (<xref alt="Kronenberg et al., 2022" rid="ref-tc-2021-380" ref-type="bibr">Kronenberg
  et al., 2022</xref>) and downscaling hillslope-scale climate
  projections
  (<xref alt="Fiddes et al., 2022" rid="ref-gmd-15-1753-2022" ref-type="bibr">Fiddes
  et al., 2022</xref>). The ease of use as well as the low computational
  cost help scientists to quickly obtain hillslope-scale atmospheric
  forcing data that is representative for their study domain. This new
  implementation of TopoSCALE into <monospace>TopoPyScale</monospace>
  brings a new software architecture facilitating development and usage.
  It is fully developed within the Python ecosystem of scientific
  computing libraries, thereby integrating every processing steps into a
  single workflow.</p>
  <fig>
    <caption><p>Comparison of the 2 m air temperature on January 1, 2020
    at 12:00 UTC over the Southern Carpathians, Romania, between the
    ERA5 surface product (top) and the downscaled result using
    TopoPyScale (middle). The DEM (bottom) was segmented using 2000
    clusters.<styled-content id="figU003Atemp_comp"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="jpeg" xlink:href="media/temperature_comparison_crop_scaled.jpg" />
  </fig>
</sec>
<sec id="toolbox-methods-and-structure">
  <title>Toolbox methods and structure</title>
  <p><monospace>TopoPyScale</monospace> is built on keystone pythonic
  libraries like
  <ext-link ext-link-type="uri" xlink:href="https://pandas.pydata.org/">pandas</ext-link>
  (<xref alt="The pandas development team, 2020" rid="ref-reback2020pandas" ref-type="bibr">The
  pandas development team, 2020</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://docs.xarray.dev/en/stable/">xarray</ext-link>
  (<xref alt="Hoyer &amp; Hamman, 2017" rid="ref-hoyer2017xarray" ref-type="bibr">Hoyer
  &amp; Hamman, 2017</xref>) with parallelization thanks to
  <ext-link ext-link-type="uri" xlink:href="https://docs.dask.org/en/stable/">dask</ext-link>
  (<xref alt="Dask Development Team, 2016" rid="ref-dask_library" ref-type="bibr">Dask
  Development Team, 2016</xref>) and Python multiprocessing,
  <ext-link ext-link-type="uri" xlink:href="https://github.com/USDA-ARS-NWRC/topocalc">topocalc</ext-link>
  and
  <ext-link ext-link-type="uri" xlink:href="https://pvlib-python.readthedocs.io/en/stable/index.html">pvlib</ext-link>
  (<xref alt="Holmgren et al., 2018" rid="ref-Holmgren2018" ref-type="bibr">Holmgren
  et al., 2018</xref>) for computation of metrics related to topography
  and solar position,
  <ext-link ext-link-type="uri" xlink:href="https://scikit-learn.org/stable/">scikit-learn</ext-link>
  (<xref alt="Pedregosa et al., 2011" rid="ref-scikit-learn" ref-type="bibr">Pedregosa
  et al., 2011</xref>) for the clustering algorithm,
  <ext-link ext-link-type="uri" xlink:href="https://rasterio.readthedocs.io/en/latest/index.html">rasterio</ext-link>
  (<xref alt="Gillies &amp; others, 2013" rid="ref-gillies_2019" ref-type="bibr">Gillies
  &amp; others, 2013</xref>) and
  <ext-link ext-link-type="uri" xlink:href="https://pyproj4.github.io/pyproj/stable/">pyproj</ext-link>
  for handling geospatial data.</p>
  <fig>
    <caption><p>Workflow of TopoPyScale processing
    pipeline.<styled-content id="figU003Afigure2"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="media/figure2.png" />
  </fig>
  <p><monospace>TopoPyScale</monospace> consists of a set of tools to be
  run in a processing pipeline following the diagram of
  <xref alt="[fig:figure2]" rid="figU003Afigure2">[fig:figure2]</xref>.
  First, it takes a Digital Elevation Model (DEM), and climate data as
  inputs. The climate data must include air temperature, pressure,
  specific humidity, and meridional and zonal wind components from
  atmospheric pressure levels ranging from mean sea level to above the
  highest elevation of the DEM, as well as incoming shortwave radiation,
  incoming longwave radiation, and precipitation from the surface level.
  The next step is to compute terrain morphometrics such as slope,
  aspect, and sky view factor. Then, downscaling can be run in two
  modes, 1) <italic>point</italic>, or 2) <italic>TopoSUB</italic>
  downscaling. <italic>Point</italic> downscaling is used for a list of
  specific points (<italic>e.g.</italic> weather station locations), for
  which meteorological variables are downscaled only at the coordinates
  of given points. The <italic>TopoSUB</italic> approach
  (<xref alt="Fiddes &amp; Gruber, 2012" rid="ref-fiddesTopoSUBToolEfficient2012" ref-type="bibr">Fiddes
  &amp; Gruber, 2012</xref>) is instead executed for semi-distributed
  spatial downscaling
  (<xref alt="[fig:figure2]" rid="figU003Afigure2">[fig:figure2]</xref>).
  The DEM is clustered based on morphometrics.
  <italic>Toposcale</italic>, the downscaling routine, is then run only
  for the centroid of each cluster or the list of given points. This
  method efficiently abstracts the DEM into a limited number of
  representative points as opposed to all the DEM grid cells, with
  potentially several orders of magnitude of computational effort saved.
  <monospace>Toposcale</monospace> uses 3D spatial interpolation and
  geometrical corrections to downscale the meteorological variables (see
  Table 1). The results can then be exported in a number of formats that
  can be used as forcing for specialized land surface models for snow,
  permafrost or hydrology via readily extendable plugins. Currently,
  this includes the models Cryogrid
  (<xref alt="Westermann et al., 2023" rid="ref-gmd-16-2607-2023" ref-type="bibr">Westermann
  et al., 2023</xref>), Crocus
  (<xref alt="Vionnet et al., 2012" rid="ref-gmd-5-773-2012" ref-type="bibr">Vionnet
  et al., 2012</xref>), SNOWPACK
  (<xref alt="Bartelt &amp; Lehning, 2002" rid="ref-BARTELT2002123" ref-type="bibr">Bartelt
  &amp; Lehning, 2002</xref>), Snowmodel
  (<xref alt="Liston &amp; Elder, 2006" rid="ref-ADistributedSnowEvolutionModelingSystemSnowModel" ref-type="bibr">Liston
  &amp; Elder, 2006</xref>), Geotop
  (<xref alt="Endrizzi et al., 2014" rid="ref-gmd-7-2831-2014" ref-type="bibr">Endrizzi
  et al., 2014</xref>), and the data assimilation toolkit MuSA
  (<xref alt="Alonso-González et al., 2022" rid="ref-gmd-15-9127-2022" ref-type="bibr">Alonso-González
  et al., 2022</xref>). Finally, 1D results can be mapped back to the
  full DEM in order to generate spatially complete results.
  <monospace>TopoPyScale</monospace> also includes a toolbox to perform
  snow simulations with
  <ext-link ext-link-type="uri" xlink:href="https://github.com/RichardEssery/FSM">FSM</ext-link>
  (<xref alt="Essery, 2015" rid="ref-gmd-8-3867-2015" ref-type="bibr">Essery,
  2015</xref>), and data assimilation of fractional snow-covered area
  (<xref alt="Fiddes et al., 2019" rid="ref-hess-23-4717-2019" ref-type="bibr">Fiddes
  et al., 2019</xref>).</p>
  <p><bold>Table 1:</bold> Default output variables of
  <monospace>TopoPyScale</monospace> (based on ERA5).</p>
  <table-wrap>
    <table>
      <colgroup>
        <col width="24%" />
        <col width="8%" />
        <col width="16%" />
        <col width="52%" />
      </colgroup>
      <thead>
        <tr>
          <th>Name</th>
          <th>Variable</th>
          <th>Unit</th>
          <th>Downscaling type</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>2 m Air Temperature</td>
          <td>t</td>
          <td>K</td>
          <td>Horizontal and vertical interpolation</td>
        </tr>
        <tr>
          <td>2 m Air atmospheric pressure</td>
          <td>p</td>
          <td>bar</td>
          <td>Horizontal and vertical interpolation</td>
        </tr>
        <tr>
          <td>10 m Wind speed</td>
          <td>ws</td>
          <td>m.s-1</td>
          <td>Horizontal and vertical interpolation</td>
        </tr>
        <tr>
          <td>10 m Wind direction</td>
          <td>wd</td>
          <td>degree</td>
          <td>Horizontal and vertical interpolation</td>
        </tr>
        <tr>
          <td>10 m Wind U-component</td>
          <td>u</td>
          <td>m.s-1</td>
          <td>Horizontal and vertical interpolation</td>
        </tr>
        <tr>
          <td>10 m Wind V-component</td>
          <td>v</td>
          <td>m.s-1</td>
          <td>Horizontal and vertical interpolation</td>
        </tr>
        <tr>
          <td>2 m Specific air humidity</td>
          <td>q</td>
          <td>kg.kg-1</td>
          <td>Horizontal and vertical interpolation</td>
        </tr>
        <tr>
          <td>Precipitation rate</td>
          <td>tp</td>
          <td>mm.hr-1</td>
          <td>Horizontal and vertical interpolation (optional:
          lapse-rate)</td>
        </tr>
        <tr>
          <td>Longwave radiation</td>
          <td>LW</td>
          <td>W.m-2</td>
          <td>Geometrical and atmospheric correction</td>
        </tr>
        <tr>
          <td>Shortwave radiation</td>
          <td>SW</td>
          <td>W.m-2</td>
          <td>Geometrical and atmospheric correction</td>
        </tr>
        <tr>
          <td>Direct shortwave radiation</td>
          <td>SW_direct</td>
          <td>W.m-2</td>
          <td>Geometrical and atmospheric correction</td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="working-examples">
  <title>Working examples</title>
  <p>The repository
  <ext-link ext-link-type="uri" xlink:href="https://github.com/ArcticSnow/TopoPyScale_examples">TopoPyScale_examples</ext-link>
  provides applications of <monospace>TopoPyScale</monospace> to three
  independent regions:</p>
  <list list-type="bullet">
    <list-item>
      <p>The site of
      <ext-link ext-link-type="uri" xlink:href="https://www.mn.uio.no/geo/english/research/groups/latice/infrastructure/">Finse</ext-link>
      in Southern Norway. Located at 1200 m above sea level, Finse is
      equipped with a wide range of instruments for atmospheric and
      hydrological studies since 2016. In this example
      <monospace>TopoPyScale</monospace> is run for the weather station
      location.</p>
    </list-item>
    <list-item>
      <p>The mountain range of Retezat in the Romanian Carpathian
      mountains. This is an example for applying the
      <italic>TopoSUB</italic> subroutine for spatialized
      downscaling.</p>
    </list-item>
    <list-item>
      <p>The area of Davos, Switzerland, specifically selected for
      studies on snow distribution and avalanches. This example shows
      how <monospace>TopoPyScale</monospace> can be combined within the
      same workflow as the snow model FSM.</p>
    </list-item>
  </list>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>SF was funded from ClimaLand, an EEA/EU collaboration grant between
  Norway and Romania 2014-2021, project code RO-NO-2019-0415,1290
  contract no. 30/2020. JF was funded by the Swiss National Science
  Foundation (grant no. 179130). KA was funded by ESA Permafrost_CCI
  (https://climate.esa.int/en/projects/permafrost/) and the Spot-On
  project (Research Council of Norway #301552), and acknowledges support
  from the LATICE strategic research area at the University of Oslo.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-Kruyt2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kruyt</surname><given-names>Bert</given-names></name>
        <name><surname>Mott</surname><given-names>Rebecca</given-names></name>
        <name><surname>Fiddes</surname><given-names>Joel</given-names></name>
        <name><surname>Gerber</surname><given-names>Franziska</given-names></name>
        <name><surname>Sharma</surname><given-names>Varun</given-names></name>
        <name><surname>Reynolds</surname><given-names>Dylan</given-names></name>
      </person-group>
      <article-title>A downscaling intercomparison study: The representation of slope- and ridge-scale processes in models of different complexity</article-title>
      <source>Frontiers in Earth Science</source>
      <year iso-8601-date="2022">2022</year>
      <volume>10</volume>
      <issn>2296-6463</issn>
      <uri>https://www.frontiersin.org/articles/10.3389/feart.2022.789332</uri>
      <pub-id pub-id-type="doi">10.3389/feart.2022.789332</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-hess-23-4717-2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fiddes</surname><given-names>J.</given-names></name>
        <name><surname>Aalstad</surname><given-names>K.</given-names></name>
        <name><surname>Westermann</surname><given-names>S.</given-names></name>
      </person-group>
      <article-title>Hyper-resolution ensemble-based snow reanalysis in mountain regions using clustering</article-title>
      <source>Hydrology and Earth System Sciences</source>
      <year iso-8601-date="2019">2019</year>
      <volume>23</volume>
      <issue>11</issue>
      <uri>https://hess.copernicus.org/articles/23/4717/2019/</uri>
      <pub-id pub-id-type="doi">10.5194/hess-23-4717-2019</pub-id>
      <fpage>4717</fpage>
      <lpage>4736</lpage>
    </element-citation>
  </ref>
  <ref id="ref-tc-2021-380">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kronenberg</surname><given-names>M.</given-names></name>
        <name><surname>Pelt</surname><given-names>W. van</given-names></name>
        <name><surname>Machguth</surname><given-names>H.</given-names></name>
        <name><surname>Fiddes</surname><given-names>J.</given-names></name>
        <name><surname>Hoelzle</surname><given-names>M.</given-names></name>
        <name><surname>Pertziger</surname><given-names>F.</given-names></name>
      </person-group>
      <article-title>Long-term firn and mass balance modelling for Abramov glacier, Pamir Alay</article-title>
      <source>The Cryosphere Discussions</source>
      <year iso-8601-date="2022">2022</year>
      <volume>2022</volume>
      <uri>https://tc.copernicus.org/preprints/tc-2021-380/</uri>
      <pub-id pub-id-type="doi">10.5194/tc-2021-380</pub-id>
      <fpage>1</fpage>
      <lpage>33</lpage>
    </element-citation>
  </ref>
  <ref id="ref-esurf-2022-39">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Renette</surname><given-names>C.</given-names></name>
        <name><surname>Aalstad</surname><given-names>K.</given-names></name>
        <name><surname>Aga</surname><given-names>J.</given-names></name>
        <name><surname>Zweigel</surname><given-names>R. B.</given-names></name>
        <name><surname>Etzelmüller</surname><given-names>B.</given-names></name>
        <name><surname>Lilleøren</surname><given-names>K. S.</given-names></name>
        <name><surname>Isaksen</surname><given-names>K.</given-names></name>
        <name><surname>Westermann</surname><given-names>S.</given-names></name>
      </person-group>
      <article-title>Simulating the effect of subsurface drainage on the thermal regime and ground ice in blocky terrain, Norway</article-title>
      <source>Earth Surface Dynamics Discussions</source>
      <year iso-8601-date="2022">2022</year>
      <volume>2022</volume>
      <uri>https://esurf.copernicus.org/preprints/esurf-2022-39/</uri>
      <pub-id pub-id-type="doi">10.5194/esurf-2022-39</pub-id>
      <fpage>1</fpage>
      <lpage>28</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gmd-15-9127-2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Alonso-González</surname><given-names>E.</given-names></name>
        <name><surname>Aalstad</surname><given-names>K.</given-names></name>
        <name><surname>Baba</surname><given-names>M. W.</given-names></name>
        <name><surname>Revuelto</surname><given-names>J.</given-names></name>
        <name><surname>López-Moreno</surname><given-names>J. I.</given-names></name>
        <name><surname>Fiddes</surname><given-names>J.</given-names></name>
        <name><surname>Essery</surname><given-names>R.</given-names></name>
        <name><surname>Gascoin</surname><given-names>S.</given-names></name>
      </person-group>
      <article-title>The Multiple Snow Data Assimilation System (MuSA v1.0)</article-title>
      <source>Geoscientific Model Development</source>
      <year iso-8601-date="2022">2022</year>
      <volume>15</volume>
      <issue>24</issue>
      <uri>https://gmd.copernicus.org/articles/15/9127/2022/</uri>
      <pub-id pub-id-type="doi">10.5194/gmd-15-9127-2022</pub-id>
      <fpage>9127</fpage>
      <lpage>9155</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gmd-8-3867-2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Essery</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>A factorial snowpack model (FSM 1.0)</article-title>
      <source>Geoscientific Model Development</source>
      <year iso-8601-date="2015">2015</year>
      <volume>8</volume>
      <issue>12</issue>
      <uri>https://gmd.copernicus.org/articles/8/3867/2015/</uri>
      <pub-id pub-id-type="doi">10.5194/gmd-8-3867-2015</pub-id>
      <fpage>3867</fpage>
      <lpage>3876</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fanetal2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fan</surname><given-names>Y.</given-names></name>
        <name><surname>Clark</surname><given-names>M.</given-names></name>
        <name><surname>Lawrence</surname><given-names>D. M.</given-names></name>
        <name><surname>Swenson</surname><given-names>S.</given-names></name>
        <name><surname>Band</surname><given-names>L. E.</given-names></name>
        <name><surname>Brantley</surname><given-names>S. L.</given-names></name>
        <name><surname>Brooks</surname><given-names>P. D.</given-names></name>
        <name><surname>Dietrich</surname><given-names>W. E.</given-names></name>
        <name><surname>Flores</surname><given-names>A.</given-names></name>
        <name><surname>Grant</surname><given-names>G.</given-names></name>
        <name><surname>Kirchner</surname><given-names>J. W.</given-names></name>
        <name><surname>Mackay</surname><given-names>D. S.</given-names></name>
        <name><surname>McDonnell</surname><given-names>J. J.</given-names></name>
        <name><surname>Milly</surname><given-names>P. C. D.</given-names></name>
        <name><surname>Sullivan</surname><given-names>P. L.</given-names></name>
        <name><surname>Tague</surname><given-names>C.</given-names></name>
        <name><surname>Ajami</surname><given-names>H.</given-names></name>
        <name><surname>Chaney</surname><given-names>N.</given-names></name>
        <name><surname>Hartmann</surname><given-names>A.</given-names></name>
        <name><surname>Hazenberg</surname><given-names>P.</given-names></name>
        <name><surname>McNamara</surname><given-names>J.</given-names></name>
        <name><surname>Pelletier</surname><given-names>J.</given-names></name>
        <name><surname>Perket</surname><given-names>J.</given-names></name>
        <name><surname>Rouholahnejad-Freund</surname><given-names>E.</given-names></name>
        <name><surname>Wagener</surname><given-names>T.</given-names></name>
        <name><surname>Zeng</surname><given-names>X.</given-names></name>
        <name><surname>Beighley</surname><given-names>E.</given-names></name>
        <name><surname>Buzan</surname><given-names>J.</given-names></name>
        <name><surname>Huang</surname><given-names>M.</given-names></name>
        <name><surname>Livneh</surname><given-names>B.</given-names></name>
        <name><surname>Mohanty</surname><given-names>B. P.</given-names></name>
        <name><surname>Nijssen</surname><given-names>B.</given-names></name>
        <name><surname>Safeeq</surname><given-names>M.</given-names></name>
        <name><surname>Shen</surname><given-names>C.</given-names></name>
        <name><surname>Verseveld</surname><given-names>W. van</given-names></name>
        <name><surname>Volk</surname><given-names>J.</given-names></name>
        <name><surname>Yamazaki</surname><given-names>D.</given-names></name>
      </person-group>
      <article-title>Hillslope hydrology in global change research and earth system modeling</article-title>
      <source>Water Resources Research</source>
      <year iso-8601-date="2019">2019</year>
      <volume>55</volume>
      <issue>2</issue>
      <uri>https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2018WR023903</uri>
      <pub-id pub-id-type="doi">10.1029/2018WR023903</pub-id>
      <fpage>1737</fpage>
      <lpage>1772</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fiddesTopoSCALEDownscalingGridded2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fiddes</surname><given-names>J.</given-names></name>
        <name><surname>Gruber</surname><given-names>S.</given-names></name>
      </person-group>
      <article-title>TopoSCALE v.1.0: Downscaling gridded climate data in complex terrain</article-title>
      <source>Geoscientific Model Development</source>
      <publisher-name>Copernicus GmbH</publisher-name>
      <year iso-8601-date="2014-02">2014</year><month>02</month>
      <volume>7</volume>
      <issue>1</issue>
      <issn>1991-959X</issn>
      <pub-id pub-id-type="doi">10.5194/gmd-7-387-2014</pub-id>
      <fpage>387</fpage>
      <lpage>405</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fiddesTopoSUBToolEfficient2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fiddes</surname><given-names>J.</given-names></name>
        <name><surname>Gruber</surname><given-names>S.</given-names></name>
      </person-group>
      <article-title>TopoSUB: A tool for efficient large area numerical modelling in complex topography at sub-grid scales</article-title>
      <source>Geoscientific Model Development</source>
      <publisher-name>Copernicus GmbH</publisher-name>
      <year iso-8601-date="2012-10">2012</year><month>10</month>
      <volume>5</volume>
      <issue>5</issue>
      <issn>1991-959X</issn>
      <pub-id pub-id-type="doi">10.5194/gmd-5-1245-2012</pub-id>
      <fpage>1245</fpage>
      <lpage>1257</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gmd-15-1753-2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fiddes</surname><given-names>J.</given-names></name>
        <name><surname>Aalstad</surname><given-names>K.</given-names></name>
        <name><surname>Lehning</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>TopoCLIM: Rapid topography-based downscaling of regional climate model output in complex terrain v1.1</article-title>
      <source>Geoscientific Model Development</source>
      <year iso-8601-date="2022">2022</year>
      <volume>15</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.5194/gmd-15-1753-2022</pub-id>
      <fpage>1753</fpage>
      <lpage>1768</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gmd-5-773-2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Vionnet</surname><given-names>V.</given-names></name>
        <name><surname>Brun</surname><given-names>E.</given-names></name>
        <name><surname>Morin</surname><given-names>S.</given-names></name>
        <name><surname>Boone</surname><given-names>A.</given-names></name>
        <name><surname>Faroux</surname><given-names>S.</given-names></name>
        <name><surname>Le Moigne</surname><given-names>P.</given-names></name>
        <name><surname>Martin</surname><given-names>E.</given-names></name>
        <name><surname>Willemet</surname><given-names>J.-M.</given-names></name>
      </person-group>
      <article-title>The detailed snowpack scheme Crocus and its implementation in SURFEX v7.2</article-title>
      <source>Geoscientific Model Development</source>
      <year iso-8601-date="2012">2012</year>
      <volume>5</volume>
      <issue>3</issue>
      <uri>https://gmd.copernicus.org/articles/5/773/2012/</uri>
      <pub-id pub-id-type="doi">10.5194/gmd-5-773-2012</pub-id>
      <fpage>773</fpage>
      <lpage>791</lpage>
    </element-citation>
  </ref>
  <ref id="ref-BARTELT2002123">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bartelt</surname><given-names>Perry</given-names></name>
        <name><surname>Lehning</surname><given-names>Michael</given-names></name>
      </person-group>
      <article-title>A physical SNOWPACK model for the Swiss avalanche warning: Part i: Numerical model</article-title>
      <source>Cold Regions Science and Technology</source>
      <year iso-8601-date="2002">2002</year>
      <volume>35</volume>
      <issue>3</issue>
      <issn>0165-232X</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0165232X02000745</uri>
      <pub-id pub-id-type="doi">10.1016/S0165-232X(02)00074-5</pub-id>
      <fpage>123</fpage>
      <lpage>145</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hersbachERA5GlobalReanalysis2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hersbach</surname><given-names>Hans</given-names></name>
        <name><surname>Bell</surname><given-names>Bill</given-names></name>
        <name><surname>Berrisford</surname><given-names>Paul</given-names></name>
        <name><surname>Hirahara</surname><given-names>Shoji</given-names></name>
        <name><surname>Horányi</surname><given-names>András</given-names></name>
        <name><surname>Muñoz-Sabater</surname><given-names>Joaquín</given-names></name>
        <name><surname>Nicolas</surname><given-names>Julien</given-names></name>
        <name><surname>Peubey</surname><given-names>Carole</given-names></name>
        <name><surname>Radu</surname><given-names>Raluca</given-names></name>
        <name><surname>Schepers</surname><given-names>Dinand</given-names></name>
        <name><surname>Simmons</surname><given-names>Adrian</given-names></name>
        <name><surname>Soci</surname><given-names>Cornel</given-names></name>
        <name><surname>Abdalla</surname><given-names>Saleh</given-names></name>
        <name><surname>Abellan</surname><given-names>Xavier</given-names></name>
        <name><surname>Balsamo</surname><given-names>Gianpaolo</given-names></name>
        <name><surname>Bechtold</surname><given-names>Peter</given-names></name>
        <name><surname>Biavati</surname><given-names>Gionata</given-names></name>
        <name><surname>Bidlot</surname><given-names>Jean</given-names></name>
        <name><surname>Bonavita</surname><given-names>Massimo</given-names></name>
        <name><surname>De Chiara</surname><given-names>Giovanna</given-names></name>
        <name><surname>Dahlgren</surname><given-names>Per</given-names></name>
        <name><surname>Dee</surname><given-names>Dick</given-names></name>
        <name><surname>Diamantakis</surname><given-names>Michail</given-names></name>
        <name><surname>Dragani</surname><given-names>Rossana</given-names></name>
        <name><surname>Flemming</surname><given-names>Johannes</given-names></name>
        <name><surname>Forbes</surname><given-names>Richard</given-names></name>
        <name><surname>Fuentes</surname><given-names>Manuel</given-names></name>
        <name><surname>Geer</surname><given-names>Alan</given-names></name>
        <name><surname>Haimberger</surname><given-names>Leo</given-names></name>
        <name><surname>Healy</surname><given-names>Sean</given-names></name>
        <name><surname>Hogan</surname><given-names>Robin J.</given-names></name>
        <name><surname>Hólm</surname><given-names>Elías</given-names></name>
        <name><surname>Janisková</surname><given-names>Marta</given-names></name>
        <name><surname>Keeley</surname><given-names>Sarah</given-names></name>
        <name><surname>Laloyaux</surname><given-names>Patrick</given-names></name>
        <name><surname>Lopez</surname><given-names>Philippe</given-names></name>
        <name><surname>Lupu</surname><given-names>Cristina</given-names></name>
        <name><surname>Radnoti</surname><given-names>Gabor</given-names></name>
        <name><surname>de Rosnay</surname><given-names>Patricia</given-names></name>
        <name><surname>Rozum</surname><given-names>Iryna</given-names></name>
        <name><surname>Vamborg</surname><given-names>Freja</given-names></name>
        <name><surname>Villaume</surname><given-names>Sebastien</given-names></name>
        <name><surname>Thépaut</surname><given-names>Jean-Noël</given-names></name>
      </person-group>
      <article-title>The ERA5 global reanalysis</article-title>
      <source>Quarterly Journal of the Royal Meteorological Society</source>
      <year iso-8601-date="2020">2020</year>
      <volume>146</volume>
      <issue>730</issue>
      <issn>1477-870X</issn>
      <pub-id pub-id-type="doi">10.1002/qj.3803</pub-id>
      <fpage>1999</fpage>
      <lpage>2049</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ADistributedSnowEvolutionModelingSystemSnowModel">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Liston</surname><given-names>Glen E.</given-names></name>
        <name><surname>Elder</surname><given-names>Kelly</given-names></name>
      </person-group>
      <article-title>A distributed snow-evolution modeling system (SnowModel)</article-title>
      <source>Journal of Hydrometeorology</source>
      <publisher-name>American Meteorological Society</publisher-name>
      <publisher-loc>Boston MA, USA</publisher-loc>
      <year iso-8601-date="2006">2006</year>
      <volume>7</volume>
      <issue>6</issue>
      <uri>https://journals.ametsoc.org/view/journals/hydr/7/6/jhm548_1.xml</uri>
      <pub-id pub-id-type="doi">10.1175/JHM548.1</pub-id>
      <fpage>1259 </fpage>
      <lpage> 1276</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gmd-7-2831-2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Endrizzi</surname><given-names>S.</given-names></name>
        <name><surname>Gruber</surname><given-names>S.</given-names></name>
        <name><surname>Dall’Amico</surname><given-names>M.</given-names></name>
        <name><surname>Rigon</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>GEOtop 2.0: Simulating the combined energy and water balance at and below the land surface accounting for soil freezing, snow cover and terrain effects</article-title>
      <source>Geoscientific Model Development</source>
      <year iso-8601-date="2014">2014</year>
      <volume>7</volume>
      <issue>6</issue>
      <uri>https://gmd.copernicus.org/articles/7/2831/2014/</uri>
      <pub-id pub-id-type="doi">10.5194/gmd-7-2831-2014</pub-id>
      <fpage>2831</fpage>
      <lpage>2857</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gmd-16-2607-2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Westermann</surname><given-names>S.</given-names></name>
        <name><surname>Ingeman-Nielsen</surname><given-names>T.</given-names></name>
        <name><surname>Scheer</surname><given-names>J.</given-names></name>
        <name><surname>Aalstad</surname><given-names>K.</given-names></name>
        <name><surname>Aga</surname><given-names>J.</given-names></name>
        <name><surname>Chaudhary</surname><given-names>N.</given-names></name>
        <name><surname>Etzelmüller</surname><given-names>B.</given-names></name>
        <name><surname>Filhol</surname><given-names>S.</given-names></name>
        <name><surname>Kääb</surname><given-names>A.</given-names></name>
        <name><surname>Renette</surname><given-names>C.</given-names></name>
        <name><surname>Schmidt</surname><given-names>L. S.</given-names></name>
        <name><surname>Schuler</surname><given-names>T. V.</given-names></name>
        <name><surname>Zweigel</surname><given-names>R. B.</given-names></name>
        <name><surname>Martin</surname><given-names>L.</given-names></name>
        <name><surname>Morard</surname><given-names>S.</given-names></name>
        <name><surname>Ben-Asher</surname><given-names>M.</given-names></name>
        <name><surname>Angelopoulos</surname><given-names>M.</given-names></name>
        <name><surname>Boike</surname><given-names>J.</given-names></name>
        <name><surname>Groenke</surname><given-names>B.</given-names></name>
        <name><surname>Miesner</surname><given-names>F.</given-names></name>
        <name><surname>Nitzbon</surname><given-names>J.</given-names></name>
        <name><surname>Overduin</surname><given-names>P.</given-names></name>
        <name><surname>Stuenzi</surname><given-names>S. M.</given-names></name>
        <name><surname>Langer</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>The CryoGrid community model (version 1.0) – a multi-physics toolbox for climate-driven simulations in the terrestrial cryosphere</article-title>
      <source>Geoscientific Model Development</source>
      <year iso-8601-date="2023">2023</year>
      <volume>16</volume>
      <issue>9</issue>
      <uri>https://gmd.copernicus.org/articles/16/2607/2023/</uri>
      <pub-id pub-id-type="doi">10.5194/gmd-16-2607-2023</pub-id>
      <fpage>2607</fpage>
      <lpage>2647</lpage>
    </element-citation>
  </ref>
  <ref id="ref-scikit-learn">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pedregosa</surname><given-names>F.</given-names></name>
        <name><surname>Varoquaux</surname><given-names>G.</given-names></name>
        <name><surname>Gramfort</surname><given-names>A.</given-names></name>
        <name><surname>Michel</surname><given-names>V.</given-names></name>
        <name><surname>Thirion</surname><given-names>B.</given-names></name>
        <name><surname>Grisel</surname><given-names>O.</given-names></name>
        <name><surname>Blondel</surname><given-names>M.</given-names></name>
        <name><surname>Prettenhofer</surname><given-names>P.</given-names></name>
        <name><surname>Weiss</surname><given-names>R.</given-names></name>
        <name><surname>Dubourg</surname><given-names>V.</given-names></name>
        <name><surname>Vanderplas</surname><given-names>J.</given-names></name>
        <name><surname>Passos</surname><given-names>A.</given-names></name>
        <name><surname>Cournapeau</surname><given-names>D.</given-names></name>
        <name><surname>Brucher</surname><given-names>M.</given-names></name>
        <name><surname>Perrot</surname><given-names>M.</given-names></name>
        <name><surname>Duchesnay</surname><given-names>E.</given-names></name>
      </person-group>
      <article-title>Scikit-learn: Machine learning in Python</article-title>
      <source>Journal of Machine Learning Research</source>
      <year iso-8601-date="2011">2011</year>
      <volume>12</volume>
      <fpage>2825</fpage>
      <lpage>2830</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gillies_2019">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Gillies</surname><given-names>Sean</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Rasterio: Geospatial raster i/o for Python programmers</article-title>
      <publisher-name>Mapbox</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <uri>https://github.com/rasterio/rasterio</uri>
    </element-citation>
  </ref>
  <ref id="ref-hoyer2017xarray">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hoyer</surname><given-names>S.</given-names></name>
        <name><surname>Hamman</surname><given-names>J.</given-names></name>
      </person-group>
      <article-title>Xarray: N-D labeled arrays and datasets in Python</article-title>
      <source>Journal of Open Research Software</source>
      <publisher-name>Ubiquity Press</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>5</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.5334/jors.148</uri>
      <pub-id pub-id-type="doi">10.5334/jors.148</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-reback2020pandas">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <string-name>The pandas development team</string-name>
      </person-group>
      <article-title>Pandas-dev/pandas: pandas</article-title>
      <publisher-name>Zenodo</publisher-name>
      <year iso-8601-date="2020-02">2020</year><month>02</month>
      <uri>https://doi.org/10.5281/zenodo.3509134</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.3509134</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-dask_library">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>Dask Development Team</string-name>
      </person-group>
      <source>Dask: Library for dynamic task scheduling</source>
      <year iso-8601-date="2016">2016</year>
      <uri>https://dask.org</uri>
    </element-citation>
  </ref>
  <ref id="ref-Holmgren2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Holmgren</surname><given-names>William F.</given-names></name>
        <name><surname>Hansen</surname><given-names>Clifford W.</given-names></name>
        <name><surname>Mikofski</surname><given-names>Mark A.</given-names></name>
      </person-group>
      <article-title>Pvlib python: A python package for modeling solar energy systems</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>3</volume>
      <issue>29</issue>
      <uri>https://doi.org/10.21105/joss.00884</uri>
      <pub-id pub-id-type="doi">10.21105/joss.00884</pub-id>
      <fpage>884</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
