<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6469</article-id>
<article-id pub-id-type="doi">10.21105/joss.06469</article-id>
<title-group>
<article-title>Contextualized: Heterogeneous Modeling
Toolbox</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7029-8023</contrib-id>
<name>
<surname>Ellington</surname>
<given-names>Caleb N.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8690-9554</contrib-id>
<name>
<surname>Lengerich</surname>
<given-names>Benjamin J.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
<xref ref-type="corresp" rid="cor-2"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lo</surname>
<given-names>Wesley</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Alvarez</surname>
<given-names>Aaron</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rubbi</surname>
<given-names>Andrea</given-names>
</name>
<xref ref-type="aff" rid="aff-6"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kellis</surname>
<given-names>Manolis</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Xing</surname>
<given-names>Eric P.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-7"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Carnegie Mellon University, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Massachusetts Institute of Technology, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Broad Institute of MIT and Harvard, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Worcester Polytechnic Institute, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>University of Cincinnati, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-6">
<institution-wrap>
<institution>Cambridge University, UK</institution>
</institution-wrap>
</aff>
<aff id="aff-7">
<institution-wrap>
<institution>Mohamed bin Zayed University of Artificial Intelligence,
UAE</institution>
</institution-wrap>
</aff>
<aff id="aff-8">
<institution-wrap>
<institution>Petuum Inc., USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
<corresp id="cor-2">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-01-26">
<day>26</day>
<month>1</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>97</issue>
<fpage>6469</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>Machine Learning</kwd>
<kwd>Modeling</kwd>
<kwd>Heterogeneous</kwd>
<kwd>Context</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<graphic mimetype="image" mime-subtype="png" xlink:href="media/figs/contextualized_logo.png" />
<sec id="summary">
  <title>Summary</title>
  <p>Heterogeneous and context-dependent systems are common in
  real-world processes, such as those in biology, medicine, finance, and
  the social sciences. However, learning accurate and interpretable
  models of these heterogeneous systems remains an unsolved problem.
  Most statistical modeling approaches make strict assumptions about
  data homogeneity, leading to inaccurate models, while more flexible
  approaches are often too complex to interpret directly. Fundamentally,
  existing modeling tools force users to choose between accuracy and
  interpretability. Recent work on Contextualized Machine Learning
  (<xref alt="Lengerich et al., 2023" rid="ref-lengerich_contextualized_2023" ref-type="bibr">Lengerich
  et al., 2023</xref>) has introduced a new paradigm for modeling
  heterogeneous and context-dependent systems, which uses contextual
  metadata to generate sample-specific models, providing
  context-specific model-based insights and representing data
  heterogeneity with context-dependent model parameters.</p>
  <p>Here, we present
  <ext-link ext-link-type="uri" xlink:href="https://contextualized.ml/"><monospace>Contextualized</monospace></ext-link>,
  a SKLearn-style Python package for estimating and analyzing
  personalized context-dependent models based on Contextualized Machine
  Learning. <monospace>Contextualized</monospace> implements two
  reusable and extensible concepts: <italic>a context encoder</italic>
  which translates sample context or metadata into model parameters, and
  <italic>sample-specific model</italic> which is defined by the
  context-specific parameters. With the flexibility of context-dependent
  parameters, each context-specific model can be a simple model class,
  such as a linear or Gaussian model, providing direct model-based
  interpretability without sacrificing overall accuracy.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>“Personalized modeling” is a statistical method that has started to
  gain popularity in recent years for representing complex and
  heterogeneous systems exhibiting individual, sample-specific effects,
  such as those prevalent in complex diseases, financial markets, and
  social systems. In its basic form: <inline-formula><alternatives>
  <tex-math><![CDATA[x_i \sim P(X_i ;θ_i)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  indexes a sample, <inline-formula><alternatives>
  <tex-math><![CDATA[θ_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  is the parameters defining the sample-specific distribution, and
  <inline-formula><alternatives>
  <tex-math><![CDATA[x_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  corresponds to the observation drawn from this sample-specific
  distribution, where understanding sample heterogeneity is equivalent
  to estimating data distributions with sample-specific parameters. Some
  methods, such as sample-left-out models
  (<xref alt="Kuijjer et al., 2019" rid="ref-kuijjer_estimating_2019" ref-type="bibr">Kuijjer
  et al., 2019</xref>), provide sample-specific estimators without
  additional information but lack desirable statistical properties such
  as the ability to generalize to new samples or test model performance
  on held-out data. Due to the difficulty of estimating sample-specific
  parameters, most methods make use of side information, covariates or
  “context,” as an indicator of sample-to-sample variation
  (<xref alt="Fan &amp; Zhang, 1999" rid="ref-fan_statistical_1999" ref-type="bibr">Fan
  &amp; Zhang, 1999</xref>;
  <xref alt="Hastie &amp; Tibshirani, 1993" rid="ref-hastie_varying-coefficient_1993" ref-type="bibr">Hastie
  &amp; Tibshirani, 1993</xref>;
  <xref alt="Kolar et al., 2010" rid="ref-kolar_estimating_2010" ref-type="bibr">Kolar
  et al., 2010</xref>;
  <xref alt="Parikh et al., 2011" rid="ref-parikh_treegl_2011" ref-type="bibr">Parikh
  et al., 2011</xref>;
  <xref alt="Wang et al., 2022" rid="ref-wang_bayesian_2022" ref-type="bibr">Wang
  et al., 2022</xref>). However, prior methods only permit limited use
  of contextual side information, allowing models to vary over a few
  continuous covariates
  (<xref alt="Fan &amp; Zhang, 1999" rid="ref-fan_statistical_1999" ref-type="bibr">Fan
  &amp; Zhang, 1999</xref>;
  <xref alt="Hastie &amp; Tibshirani, 1993" rid="ref-hastie_varying-coefficient_1993" ref-type="bibr">Hastie
  &amp; Tibshirani, 1993</xref>;
  <xref alt="Wang et al., 2022" rid="ref-wang_bayesian_2022" ref-type="bibr">Wang
  et al., 2022</xref>), or a small number of groups
  (<xref alt="Kolar et al., 2010" rid="ref-kolar_estimating_2010" ref-type="bibr">Kolar
  et al., 2010</xref>;
  <xref alt="Parikh et al., 2011" rid="ref-parikh_treegl_2011" ref-type="bibr">Parikh
  et al., 2011</xref>;
  <xref alt="Zeileis et al., 2008" rid="ref-zeileis_model-based_2008" ref-type="bibr">Zeileis
  et al., 2008</xref>), and do not scale to high-dimensional, complex,
  and sample-specific variation. <monospace>partykit</monospace>
  (<xref alt="Hothorn &amp; Zeileis, 2015" rid="ref-hothorn_partykit_2015" ref-type="bibr">Hothorn
  &amp; Zeileis, 2015</xref>) goes beyond this by enabling random
  forests of model-based recursive partitioning
  (<xref alt="Zeileis et al., 2008" rid="ref-zeileis_model-based_2008" ref-type="bibr">Zeileis
  et al., 2008</xref>) on contextual information, learning complex
  non-linear relationships between contextual information and linear
  regression parameters. However, <monospace>partykit</monospace> is
  limited to linear models and the relationship between linear
  coefficients and contextual information must be represented using
  tree-based methods, which struggle with high-dimensional and
  non-tabular data types. Recently, the contextual explanation network
  (CEN) was developed to learn this context-model relationship using a
  deep neural network, benefiting from a wide range of architectures
  targeting high-dimensional non-tabular data
  (<xref alt="Al-Shedivat et al., 2020" rid="ref-al-shedivat_contextual_2020" ref-type="bibr">Al-Shedivat
  et al., 2020</xref>). However, like model-based partitioning, the CEN
  is designed only for linear model personalization. Contextualized
  Machine Learning generalizes the CEN method, reframing the
  sample-specific parameter estimation problem as a more flexible and
  generalizable latent variable inference problem which provides a
  unified mathematical framework for inferring and estimating
  personalized models of heterogeneous and context-dependent systems
  using a wide range of model types
  (<xref alt="Lengerich et al., 2023" rid="ref-lengerich_contextualized_2023" ref-type="bibr">Lengerich
  et al., 2023</xref>).</p>
  <p>Formally, Contextualized Machine Learning uses subject data
  <inline-formula><alternatives>
  <tex-math><![CDATA[X = \{X_i\}_{i=1}^N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>
  and context data <inline-formula><alternatives>
  <tex-math><![CDATA[C = \{C_i\}_{i=1}^N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  indexes samples. We can express the likelihood of all data in the form
  of <disp-formula><alternatives>
  <tex-math><![CDATA[P(X,C) \propto \int_{\theta} d\theta P_M (X \mid \theta) P ( \theta \mid C)\,]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msub><mml:mo>∫</mml:mo><mml:mi>θ</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:msub><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>X</mml:mi><mml:mo>∣</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mspace width="0.167em"></mml:mspace></mml:mrow></mml:math></alternatives></disp-formula>
  where we call <inline-formula><alternatives>
  <tex-math><![CDATA[P ( \theta \mid C)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  the context encoder, and <inline-formula><alternatives>
  <tex-math><![CDATA[P_M (X \mid \theta)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>X</mml:mi><mml:mo>∣</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  the sample-specific model, where <inline-formula><alternatives>
  <tex-math><![CDATA[M]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>M</mml:mi></mml:math></alternatives></inline-formula>
  denotes model class or type. So long as the choice for both the
  context encoder and sample-specific model are differentiable, we can
  learn to estimate parameters <inline-formula><alternatives>
  <tex-math><![CDATA[\theta_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  for each sample <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>
  via end-to-end backpropagation with gradient-based algorithms such
  that <inline-formula><alternatives>
  <tex-math><![CDATA[P(X \mid C)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>X</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is maximized. Conveniently, <inline-formula><alternatives>
  <tex-math><![CDATA[C]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula>
  can contain any multivariate or real features that are relevant to the
  study, such as clinical, genetic, textual, or image data, and the
  context encoder can be any differentiable function, such as a neural
  network, that maps <inline-formula><alternatives>
  <tex-math><![CDATA[C_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  to <inline-formula><alternatives>
  <tex-math><![CDATA[\theta_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.</p>
  <p><monospace>Contextualized</monospace> implements this framework for
  key types of context encoders and sample-specific models, opening up
  new avenues for quantitative analysis of complex and heterogeneous
  data, and simplifying the process of transforming this data into
  results with plug-and-play analysis tools. In particular,
  <monospace>Contextualized</monospace>:</p>
  <list list-type="order">
    <list-item>
      <p><bold>Unifies Modeling Frameworks:</bold>
      <monospace>Contextualized</monospace> unifies modeling approaches
      for both homogeneous and heterogeneous data, including population
      models, varying-coefficient models
      (<xref alt="Fan &amp; Zhang, 1999" rid="ref-fan_statistical_1999" ref-type="bibr">Fan
      &amp; Zhang, 1999</xref>;
      <xref alt="Hastie &amp; Tibshirani, 1993" rid="ref-hastie_varying-coefficient_1993" ref-type="bibr">Hastie
      &amp; Tibshirani, 1993</xref>;
      <xref alt="Wang et al., 2022" rid="ref-wang_bayesian_2022" ref-type="bibr">Wang
      et al., 2022</xref>), and partition-based models
      (<xref alt="Kolar et al., 2010" rid="ref-kolar_estimating_2010" ref-type="bibr">Kolar
      et al., 2010</xref>;
      <xref alt="Parikh et al., 2011" rid="ref-parikh_treegl_2011" ref-type="bibr">Parikh
      et al., 2011</xref>;
      <xref alt="Zeileis et al., 2008" rid="ref-zeileis_model-based_2008" ref-type="bibr">Zeileis
      et al., 2008</xref>) via context encoding, learning parameter
      variation over both continuous contexts and discrete groups.
      Additionally, <monospace>Contextualized</monospace> naturally
      falls back to these classic modeling frameworks when complex
      heterogeneity is not present. Not only is this convenient, but it
      limits the number of modeling decisions and validation tests
      required by users, reducing the risk of misspecification and false
      discoveries
      (<xref alt="Lengerich et al., 2023" rid="ref-lengerich_contextualized_2023" ref-type="bibr">Lengerich
      et al., 2023</xref>).</p>
    </list-item>
    <list-item>
      <p><bold>Models High-resolution Heterogeneity:</bold>
      Contextualized models adapt to the context of each sample by using
      a context encoder, naturally accounting for high-dimensional,
      continuous, and fine-grained variation between samples
      (<xref alt="Ellington et al., 2023" rid="ref-ellington_contextualized_2023" ref-type="bibr">Ellington
      et al., 2023</xref>).</p>
    </list-item>
    <list-item>
      <p><bold>Quantifies Heterogeneity in Data:</bold> Context-specific
      models quantify the randomness and structure of the systems
      underlying each data point, and variation in context-specific
      model parameters quantifies the heterogeneity between data points
      (<xref alt="Al-Shedivat et al., 2018" rid="ref-al-shedivat_personalized_2018" ref-type="bibr">Al-Shedivat
      et al., 2018</xref>;
      <xref alt="Deuschel et al., 2023" rid="ref-deuschel_contextualized_2023" ref-type="bibr">Deuschel
      et al., 2023</xref>). <monospace>Contextualized</monospace>
      provides tools to analyze, test, and validate contextualized
      models, unlocking new studies of structured heterogeneity.</p>
    </list-item>
    <list-item>
      <p><bold>Interpolates and Extrapolates to Unseen Contexts:</bold>
      By using context encoders to translate between contextual
      information and model parameters,
      <monospace>Contextualized</monospace> learns meta-relationships
      between metadata and data. At test time,
      <monospace>Contextualized</monospace> can adapt to contexts which
      were never observed in the training data
      (<xref alt="Ellington et al., 2023" rid="ref-ellington_contextualized_2023" ref-type="bibr">Ellington
      et al., 2023</xref>).</p>
    </list-item>
    <list-item>
      <p><bold>Analyzes Latent Processes:</bold> By associating
      structured models with each sample,
      <monospace>Contextualized</monospace> enables analysis of samples
      with latent processes. These latent processes can be inferred from
      patterns in context-specific models, and can be used to identify
      latent subgroups, latent trajectories, and latent features that
      explain heterogeneity
      (<xref alt="Lengerich, Al-Shedivat, et al., 2022" rid="ref-lengerich_discriminative_2022" ref-type="bibr">Lengerich,
      Al-Shedivat, et al., 2022</xref>).</p>
    </list-item>
    <list-item>
      <p><bold>Provides Direct Interpretability:</bold>
      <monospace>Contextualized</monospace> estimates and analyzes
      context-specific statistical models. These statistical models are
      mathematically-constrained such that each parameter has specific
      meaning, permitting direct interpretation and immediate results
      (<xref alt="Lengerich, Nunnally, et al., 2022" rid="ref-lengerich_automated_2022" ref-type="bibr">Lengerich,
      Nunnally, et al., 2022</xref>).</p>
    </list-item>
    <list-item>
      <p><bold>Incorporates Multi-modal Data:</bold> Context is a
      general and flexible concept, and context-encoders can be used to
      instill any type of contextual information into contextualized
      models, including images, text, tabular data, and more
      (<xref alt="Al-Shedivat et al., 2020" rid="ref-al-shedivat_contextual_2020" ref-type="bibr">Al-Shedivat
      et al., 2020</xref>;
      <xref alt="Lengerich et al., 2021" rid="ref-lengerich_notmad_2021" ref-type="bibr">Lengerich
      et al., 2021</xref>;
      <xref alt="Lengerich, Al-Shedivat, et al., 2022" rid="ref-lengerich_discriminative_2022" ref-type="bibr">Lengerich,
      Al-Shedivat, et al., 2022</xref>;
      <xref alt="Stoica et al., 2020" rid="ref-stoica_contextual_2020" ref-type="bibr">Stoica
      et al., 2020</xref>).</p>
    </list-item>
    <list-item>
      <p><bold>Enables Modular Development:</bold> The context encoder
      and sample-specific model within
      <monospace>Contextualized</monospace> are both highly adaptable;
      the context encoder can be replaced with any differentiable
      function, and any statistical model with a differentiable
      likelihood or log-likelihood can be contextualized and made
      sample-specific, benefiting from a rich ecosystem of statistical
      models and deep learning methods.</p>
    </list-item>
  </list>
</sec>
<sec id="usage">
  <title>Usage</title>
  <p>The <monospace>Contextualized</monospace> software is structured
  through three primary resources:</p>
  <list list-type="order">
    <list-item>
      <p>A simple plug-and-play interface to learn contextualized
      versions of popular model classes (e.g. classifiers, linear
      regression, graphical models, Gaussians).</p>
    </list-item>
    <list-item>
      <p>A suite of context encoders to incorporate any modality of
      contextual data (e.g. continuous, categorical, images, text)
      and/or impose restrictions on context-dependent relationships
      (e.g. feature independence, interaction effects).</p>
    </list-item>
    <list-item>
      <p>Intuitive analysis tools to understand, quantify, test, and
      visualize data with heterogeneous and context-dependent behavior.
      These tools focus on visualizing heterogeneity, automatic
      hypothesis testing, and feature selection for context-dependent
      and context-invariant features.</p>
    </list-item>
  </list>
  <p>Installation instructions, tutorials, API reference, and
  open-source code are all available at
  <ext-link ext-link-type="uri" xlink:href="https://contextualized.ml">contextualized.ml</ext-link>.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We are grateful for early user input from Juwayni Lucman, Alyssa
  Lee, and Jannik Deuschel.</p>
</sec>
<sec id="funding">
  <title>Funding</title>
  <p>C.E., B.L., and E.X. were supported by National Institutes of
  Health R01GM140467.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-lengerich_automated_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lengerich</surname><given-names>Benjamin J.</given-names></name>
        <name><surname>Nunnally</surname><given-names>Mark E.</given-names></name>
        <name><surname>Aphinyanaphongs</surname><given-names>Yin</given-names></name>
        <name><surname>Ellington</surname><given-names>Caleb</given-names></name>
        <name><surname>Caruana</surname><given-names>Rich</given-names></name>
      </person-group>
      <article-title>Automated Interpretable Discovery of Heterogeneous Treatment Effectiveness: A COVID-19 Case Study</article-title>
      <source>J. Biomed. Inform.</source>
      <year iso-8601-date="2022-04">2022</year><month>04</month>
      <issn>1532-0464</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S1532046422001022</uri>
      <pub-id pub-id-type="doi">10.1016/j.jbi.2022.104086</pub-id>
      <fpage>104086</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-stoica_contextual_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Stoica</surname><given-names>George</given-names></name>
        <name><surname>Stretcu</surname><given-names>Otilia</given-names></name>
        <name><surname>Platanios</surname><given-names>Emmanouil Antonios</given-names></name>
        <name><surname>Mitchell</surname><given-names>Tom</given-names></name>
        <name><surname>Póczos</surname><given-names>Barnabás</given-names></name>
      </person-group>
      <article-title>Contextual Parameter Generation for Knowledge Graph Link Prediction</article-title>
      <source>Proceedings of the AAAI Conference on Artificial Intelligence</source>
      <year iso-8601-date="2020-04">2020</year><month>04</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-09-24">2022</year><month>09</month><day>24</day></date-in-citation>
      <volume>34</volume>
      <issue>03</issue>
      <issn>2374-3468</issn>
      <uri>https://ojs.aaai.org/index.php/AAAI/article/view/5693</uri>
      <pub-id pub-id-type="doi">10.1609/aaai.v34i03.5693</pub-id>
      <fpage>3000</fpage>
      <lpage>3008</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lengerich_contextualized_2023">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Lengerich</surname><given-names>Benjamin J.</given-names></name>
        <name><surname>Ellington</surname><given-names>Caleb N.</given-names></name>
        <name><surname>Rubbi</surname><given-names>Andrea</given-names></name>
        <name><surname>Kellis</surname><given-names>Manolis</given-names></name>
        <name><surname>Xing</surname><given-names>Eric P.</given-names></name>
      </person-group>
      <article-title>Contextualized Machine Learning</article-title>
      <publisher-name>arXiv</publisher-name>
      <year iso-8601-date="2023-10">2023</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-11-02">2023</year><month>11</month><day>02</day></date-in-citation>
      <uri>http://arxiv.org/abs/2310.11340</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2310.11340</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-ellington_contextualized_2023">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Ellington</surname><given-names>Caleb N.</given-names></name>
        <name><surname>Lengerich</surname><given-names>Benjamin J.</given-names></name>
        <name><surname>Watkins</surname><given-names>Thomas BK</given-names></name>
        <name><surname>Yang</surname><given-names>Jiekun</given-names></name>
        <name><surname>Xiao</surname><given-names>Hanxi</given-names></name>
        <name><surname>Kellis</surname><given-names>Manolis</given-names></name>
        <name><surname>Xing</surname><given-names>Eric P.</given-names></name>
      </person-group>
      <article-title>Contextualized Networks Reveal Heterogeneous Transcriptomic Regulation in Tumors at Sample-Specific Resolution</article-title>
      <publisher-name>bioRxiv</publisher-name>
      <year iso-8601-date="2023-12">2023</year><month>12</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-12-06">2023</year><month>12</month><day>06</day></date-in-citation>
      <uri>https://www.biorxiv.org/content/10.1101/2023.12.01.569658v1</uri>
      <pub-id pub-id-type="doi">10.1101/2023.12.01.569658</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-lengerich_notmad_2021">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Lengerich</surname><given-names>Benjamin J.</given-names></name>
        <name><surname>Ellington</surname><given-names>Caleb N.</given-names></name>
        <name><surname>Aragam</surname><given-names>Bryon</given-names></name>
        <name><surname>Xing</surname><given-names>Eric P.</given-names></name>
        <name><surname>Kellis</surname><given-names>Manolis</given-names></name>
      </person-group>
      <article-title>NOTMAD: Estimating Bayesian Networks with Sample-Specific Structures and Parameters</article-title>
      <publisher-name>arXiv</publisher-name>
      <year iso-8601-date="2021-11">2021</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-14">2024</year><month>03</month><day>14</day></date-in-citation>
      <uri>http://arxiv.org/abs/2111.01104</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2111.01104</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-hastie_varying-coefficient_1993">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hastie</surname><given-names>Trevor</given-names></name>
        <name><surname>Tibshirani</surname><given-names>Robert</given-names></name>
      </person-group>
      <article-title>Varying-Coefficient Models</article-title>
      <source>Journal of the Royal Statistical Society: Series B (Methodological)</source>
      <year iso-8601-date="1993">1993</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-14">2024</year><month>03</month><day>14</day></date-in-citation>
      <volume>55</volume>
      <issue>4</issue>
      <issn>2517-6161</issn>
      <uri>https://onlinelibrary.wiley.com/doi/abs/10.1111/j.2517-6161.1993.tb01939.x</uri>
      <pub-id pub-id-type="doi">10.1111/j.2517-6161.1993.tb01939.x</pub-id>
      <fpage>757</fpage>
      <lpage>779</lpage>
    </element-citation>
  </ref>
  <ref id="ref-al-shedivat_contextual_2020">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Al-Shedivat</surname><given-names>Maruan</given-names></name>
        <name><surname>Dubey</surname><given-names>Avinava</given-names></name>
        <name><surname>Xing</surname><given-names>Eric P.</given-names></name>
      </person-group>
      <article-title>Contextual Explanation Networks</article-title>
      <publisher-name>arXiv</publisher-name>
      <year iso-8601-date="2020-09">2020</year><month>09</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-14">2024</year><month>03</month><day>14</day></date-in-citation>
      <uri>http://arxiv.org/abs/1705.10301</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.1705.10301</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-lengerich_discriminative_2022">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Lengerich</surname><given-names>Benjamin J.</given-names></name>
        <name><surname>Al-Shedivat</surname><given-names>Maruan</given-names></name>
        <name><surname>Alavi</surname><given-names>Amir</given-names></name>
        <name><surname>Williams</surname><given-names>Jennifer</given-names></name>
        <name><surname>Labbaki</surname><given-names>Sami</given-names></name>
        <name><surname>Xing</surname><given-names>Eric P.</given-names></name>
      </person-group>
      <article-title>Discriminative Subtyping of Lung Cancers from Histopathology Images via Contextual Deep Learning</article-title>
      <publisher-name>medRxiv</publisher-name>
      <year iso-8601-date="2022-11">2022</year><month>11</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-14">2024</year><month>03</month><day>14</day></date-in-citation>
      <uri>https://www.medrxiv.org/content/10.1101/2020.06.25.20140053v2</uri>
      <pub-id pub-id-type="doi">10.1101/2020.06.25.20140053</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-al-shedivat_personalized_2018">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Al-Shedivat</surname><given-names>Maruan</given-names></name>
        <name><surname>Dubey</surname><given-names>Avinava</given-names></name>
        <name><surname>Xing</surname><given-names>Eric P.</given-names></name>
      </person-group>
      <article-title>Personalized Survival Prediction with Contextual Explanation Networks</article-title>
      <publisher-name>arXiv</publisher-name>
      <year iso-8601-date="2018-01">2018</year><month>01</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-14">2024</year><month>03</month><day>14</day></date-in-citation>
      <uri>http://arxiv.org/abs/1801.09810</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.1801.09810</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-deuschel_contextualized_2023">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Deuschel</surname><given-names>Jannik</given-names></name>
        <name><surname>Ellington</surname><given-names>Caleb N.</given-names></name>
        <name><surname>Lengerich</surname><given-names>Benjamin J.</given-names></name>
        <name><surname>Luo</surname><given-names>Yingtao</given-names></name>
        <name><surname>Friederich</surname><given-names>Pascal</given-names></name>
        <name><surname>Xing</surname><given-names>Eric P.</given-names></name>
      </person-group>
      <article-title>Contextualized Policy Recovery: Modeling and Interpreting Medical Decisions with Adaptive Imitation Learning</article-title>
      <publisher-name>arXiv</publisher-name>
      <year iso-8601-date="2023-10">2023</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2023-11-02">2023</year><month>11</month><day>02</day></date-in-citation>
      <uri>http://arxiv.org/abs/2310.07918</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.2310.07918</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-fan_statistical_1999">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fan</surname><given-names>Jianqing</given-names></name>
        <name><surname>Zhang</surname><given-names>Wenyang</given-names></name>
      </person-group>
      <article-title>Statistical estimation in varying coefficient models</article-title>
      <source>The Annals of Statistics</source>
      <year iso-8601-date="1999-10">1999</year><month>10</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2022-06-27">2022</year><month>06</month><day>27</day></date-in-citation>
      <volume>27</volume>
      <issue>5</issue>
      <issn>0090-5364</issn>
      <uri>https://projecteuclid.org/journals/annals-of-statistics/volume-27/issue-5/Statistical-estimation-in-varying-coefficient-models/10.1214/aos/1017939139.full</uri>
      <pub-id pub-id-type="doi">10.1214/aos/1017939139</pub-id>
      <fpage>1491</fpage>
      <lpage>1518</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kuijjer_estimating_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kuijjer</surname><given-names>Marieke Lydia</given-names></name>
        <name><surname>Tung</surname><given-names>Matthew George</given-names></name>
        <name><surname>Yuan</surname><given-names>GuoCheng</given-names></name>
        <name><surname>Quackenbush</surname><given-names>John</given-names></name>
        <name><surname>Glass</surname><given-names>Kimberly</given-names></name>
      </person-group>
      <article-title>Estimating Sample-Specific Regulatory Networks</article-title>
      <source>iScience</source>
      <year iso-8601-date="2019-04">2019</year><month>04</month>
      <volume>14</volume>
      <issn>2589-0042</issn>
      <pub-id pub-id-type="doi">10.1016/j.isci.2019.03.021</pub-id>
      <pub-id pub-id-type="pmid">30981959</pub-id>
      <fpage>226</fpage>
      <lpage>240</lpage>
    </element-citation>
  </ref>
  <ref id="ref-wang_bayesian_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wang</surname><given-names>Zeya</given-names></name>
        <name><surname>Kaseb</surname><given-names>Ahmed O.</given-names></name>
        <name><surname>Amin</surname><given-names>Hesham M.</given-names></name>
        <name><surname>Hassan</surname><given-names>Manal M.</given-names></name>
        <name><surname>Wang</surname><given-names>Wenyi</given-names></name>
        <name><surname>Morris</surname><given-names>Jeffrey S.</given-names></name>
      </person-group>
      <article-title>Bayesian Edge Regression in Undirected Graphical Models to Characterize Interpatient Heterogeneity in Cancer</article-title>
      <source>Journal of the American Statistical Association</source>
      <year iso-8601-date="2022">2022</year>
      <volume>117</volume>
      <issue>538</issue>
      <issn>0162-1459</issn>
      <pub-id pub-id-type="doi">10.1080/01621459.2021.2000866</pub-id>
      <pub-id pub-id-type="pmid">36090952</pub-id>
      <fpage>533</fpage>
      <lpage>546</lpage>
    </element-citation>
  </ref>
  <ref id="ref-parikh_treegl_2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Parikh</surname><given-names>Ankur P</given-names></name>
        <name><surname>Wu</surname><given-names>Wei</given-names></name>
        <name><surname>Curtis</surname><given-names>Ross E</given-names></name>
        <name><surname>Xing</surname><given-names>Eric P</given-names></name>
      </person-group>
      <article-title>TREEGL: Reverse engineering tree-evolving gene networks underlying developing biological lineages</article-title>
      <source>Bioinformatics</source>
      <year iso-8601-date="2011-07">2011</year><month>07</month>
      <volume>27</volume>
      <issue>13</issue>
      <issn>1367-4803</issn>
      <uri>http://dx.doi.org/10.1093/bioinformatics/btr239</uri>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/btr239</pub-id>
      <fpage>i196</fpage>
      <lpage>204</lpage>
    </element-citation>
  </ref>
  <ref id="ref-kolar_estimating_2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kolar</surname><given-names>Mladen</given-names></name>
        <name><surname>Song</surname><given-names>Le</given-names></name>
        <name><surname>Ahmed</surname><given-names>Amr</given-names></name>
        <name><surname>Xing</surname><given-names>Eric P.</given-names></name>
      </person-group>
      <article-title>Estimating time-varying networks</article-title>
      <source>The Annals of Applied Statistics</source>
      <year iso-8601-date="2010-03">2010</year><month>03</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-26">2024</year><month>03</month><day>26</day></date-in-citation>
      <volume>4</volume>
      <issue>1</issue>
      <issn>1932-6157</issn>
      <uri>http://arxiv.org/abs/0812.5087</uri>
      <pub-id pub-id-type="doi">10.1214/09-AOAS308</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-zeileis_model-based_2008">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zeileis</surname><given-names>Achim</given-names></name>
        <name><surname>Hothorn</surname><given-names>Torsten</given-names></name>
        <name><surname>Hornik</surname><given-names>Kurt</given-names></name>
      </person-group>
      <article-title>Model-Based Recursive Partitioning</article-title>
      <source>Journal of Computational and Graphical Statistics</source>
      <year iso-8601-date="2008-06">2008</year><month>06</month>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-26">2024</year><month>03</month><day>26</day></date-in-citation>
      <volume>17</volume>
      <issue>2</issue>
      <issn>1061-8600</issn>
      <uri>https://doi.org/10.1198/106186008X319331</uri>
      <pub-id pub-id-type="doi">10.1198/106186008X319331</pub-id>
      <fpage>492</fpage>
      <lpage>514</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hothorn_partykit_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hothorn</surname><given-names>Torsten</given-names></name>
        <name><surname>Zeileis</surname><given-names>Achim</given-names></name>
      </person-group>
      <article-title>Partykit: A Modular Toolkit for Recursive Partytioning in R</article-title>
      <source>Journal of Machine Learning Research</source>
      <year iso-8601-date="2015">2015</year>
      <date-in-citation content-type="access-date"><year iso-8601-date="2024-03-23">2024</year><month>03</month><day>23</day></date-in-citation>
      <volume>16</volume>
      <issue>118</issue>
      <issn>1533-7928</issn>
      <uri>http://jmlr.org/papers/v16/hothorn15a.html</uri>
      <fpage>3905</fpage>
      <lpage>3909</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
