<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">9480</article-id>
<article-id pub-id-type="doi">10.21105/joss.09480</article-id>
<title-group>
<article-title>YetAnotherSimulationSuite.jl: An Atomic Simulation Suite
in Julia</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7416-8629</contrib-id>
<name>
<surname>Ferrari</surname>
<given-names>Brian C.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Leiden Institute of Chemistry, Leiden University, Leiden
2300 RA, The Netherlands</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-09-22">
<day>22</day>
<month>9</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>116</issue>
<fpage>9480</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Julia</kwd>
<kwd>Atomic Simulations</kwd>
<kwd>Molecular Dynamics</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>YetAnotherSimulationSuite.jl</monospace> (YASS) is
  software for atomic simulations in Julia. YASS aims to be highly
  performant, memory efficient, flexible, and extensible. YASS was
  developed with a focus on making it incredibly easy to add or
  customize anything within the package, making niche research methods
  more accessible to the average user.</p>
  <p>YASS features a wide variety of capabilities useful for molecular
  simulations including: reading and writing over 20 different file
  types, basic manipulation of atomic structures, geometry and cell
  optimization, harmonic frequency calculation, calculation of velocity
  autocorrelation, molecular dynamics simulation, evaluation of radial
  and angular distribution functions.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>There exists a vast number of software packages for performing
  atomic scale simulations. There are those that focus on ease of use
  and flexibility, such as ASE
  (<xref alt="Larsen et al., 2017" rid="ref-ase" ref-type="bibr">Larsen
  et al., 2017</xref>), and those that focus on speed and memory
  efficiency, such as LAMMPS
  (<xref alt="Thompson et al., 2022" rid="ref-lammps" ref-type="bibr">Thompson
  et al., 2022</xref>), GROMACS
  (<xref alt="Abraham et al., 2015" rid="ref-gromacs4" ref-type="bibr">Abraham
  et al., 2015</xref>;
  <xref alt="Lindahl et al., 2001" rid="ref-gromacs2" ref-type="bibr">Lindahl
  et al., 2001</xref>;
  <xref alt="Pronk et al., 2013" rid="ref-gromacs3" ref-type="bibr">Pronk
  et al., 2013</xref>;
  <xref alt="Van Der Spoel et al., 2005" rid="ref-gromacs1" ref-type="bibr">Van
  Der Spoel et al., 2005</xref>), and JaxMD
  (<xref alt="Schoenholz &amp; Cubuk, 2020" rid="ref-jaxmd" ref-type="bibr">Schoenholz
  &amp; Cubuk, 2020</xref>). In an effort to offer both ease of use and
  speed, ASE offers interfaces to many of the performance- focused
  simulation suites. However, using these interfaces limits the
  flexibility originally offered by ASE and can reduce the memory
  efficiency offered by the faster simulation suite. The Julia
  programming language
  (<xref alt="Bezanson et al., 2017" rid="ref-julia" ref-type="bibr">Bezanson
  et al., 2017</xref>) offers the perfect solution to this problem, as
  it can be as performant as C++ with the simplicity of Python.</p>
  <p>YASS offers users a similarly simple and easy-to-use interface as
  ASE, while also offering significant speedups. JaxMD can also offer a
  simple interface and high performance, but is limited in the available
  optimization algorithms. YASS, through <monospace>Optim.jl</monospace>
  (<xref alt="Mogensen &amp; Riseth, 2018" rid="ref-optim" ref-type="bibr">Mogensen
  &amp; Riseth, 2018</xref>), offers a wide variety of optimization
  algorithms for geometry and cell optimizations. Within the Julia
  ecosystem, <monospace>Molly.jl</monospace>
  (<xref alt="Greener, 2024" rid="ref-molly" ref-type="bibr">Greener,
  2024</xref>) and <monospace>NQCDynamics.jl</monospace>
  (<xref alt="Gardner et al., 2022" rid="ref-nqcdynamics" ref-type="bibr">Gardner
  et al., 2022</xref>) are the dominant packages for performing
  molecular dynamics (MD) simulations. However, YASS not only performs
  MD simulations but also geometry/cell optimizations and harmonic
  frequency calculations. A major shortcoming of the current state of
  YASS is a lack of support for parallelisation and GPU acceleration.
  Future versions of YASS will aim to offer these features to further
  improve performance.</p>
</sec>
<sec id="examples">
  <title>Examples</title>
  <p>Two simple examples are shown here to illustrate how YASS can be
  used for vibrational frequency analysis of molecular systems. The
  examples focus only on this topic, as the process also utilizes many
  additional YASS features. For both examples the necessary xyz file can
  be found in the YASS
  <ext-link ext-link-type="uri" xlink:href="https://github.com/Cavenfish/YetAnotherSimulationSuite.jl/tree/main/test/testingFiles/xyzFiles">repo</ext-link>.
  The first example below shows the steps required to calculate the
  harmonic frequencies of a water molecule.</p>
  <code language="julia">using Optim
using YetAnotherSimulationSuite

# Read initial structure
molecule = readSystem(&quot;h2o.xyz&quot;)

# Run geometry optimization
optimized = opt(TIP4Pf(), LBFGS(), molecule)

# Save optimized structure
write(&quot;optimized.xyz&quot;, optimized)

# Calculate frequencies and normal modes
freqs, modes = getHarmonicFreqs(TIP4Pf(), optimized)</code>
  <p>The second example, shown below, calculates the vibrational density
  of states (VDOS) using the velocity autocorrelation function
  (VACF).</p>
  <code language="julia">using YetAnotherSimulationSuite

# Read initial structure
iceIh = readSystem(&quot;iceIh_small.xyz&quot;)

# Initialize calculator
calc = TIP4Pf()

# Create NVT ensemble with the
# Canonical Velocity Rescaling thermostat
# set to 50 Kelvin temp and 100 fs time constant
nvt_ensemble = NVT(iceIh, CVR(50.0u&quot;K&quot;, 100u&quot;fs&quot;, calc))

# Run 2 picosecond NVT simulation
nvt_traj = run(calc, iceIh, 2u&quot;ps&quot;, 1u&quot;fs&quot;, nvt_ensemble)

# Get last frame from NVT
bdys = makeBdys(nvt_traj, length(nvt_traj.images))

# Make it periodic
iceIh_50K = makeCell(bdys, iceIh.lattice)

# Create NVE ensemble
nve_ensemble = NVE(iceIh)

# Run 10 picosecond simulation with 0.1 fs timestep
nve_traj = run(calc, iceIh_50K, 10u&quot;ps&quot;, 0.1u&quot;fs&quot;, nve_ensemble)

# Extract velocities and masses
vel, mas = getVelMas(nve_traj)

# Configure VACF calculation
inp = vacfInps(
    vel,       # Velocity trajectories
    mas,       # Atomic masses
    1e16u&quot;Hz&quot;, # Sampling frequency (1/fs = 1e15 Hz)
    true,      # Normalize VACF
    Hann,      # Window function
    4,         # FFT padding factor
    true       # Mirror the data
)

# Calculate VDOS
out = VDOS(inp)</code>
  <p>More examples and detailed explanations can be found in the YASS
  <ext-link ext-link-type="uri" xlink:href="https://cavenfish.github.io/YetAnotherSimulationSuite.jl/stable/">documentation</ext-link>.</p>
</sec>
<sec id="dependencies">
  <title>Dependencies</title>
  <p>YASS relies on several packages and libraries that deserve to be
  credited.</p>
  <list list-type="bullet">
    <list-item>
      <p><monospace>Chemfiles</monospace> is used for I/O
      operations.</p>
    </list-item>
    <list-item>
      <p><monospace>Optim.jl</monospace>
      (<xref alt="Mogensen &amp; Riseth, 2018" rid="ref-optim" ref-type="bibr">Mogensen
      &amp; Riseth, 2018</xref>) is used for geometry and cell
      optimization.</p>
    </list-item>
    <list-item>
      <p><monospace>OrdinaryDiffEq.jl</monospace>
      (<xref alt="Rackauckas &amp; Nie, 2017" rid="ref-diffeq" ref-type="bibr">Rackauckas
      &amp; Nie, 2017</xref>) is used as the integrator for MD
      simulations.</p>
    </list-item>
    <list-item>
      <p><monospace>FiniteDifferences.jl</monospace> is used for
      computing Jacobians for harmonic frequency analysis.</p>
    </list-item>
    <list-item>
      <p><monospace>FFTW</monospace>
      (<xref alt="Frigo &amp; Johnson, 1998" rid="ref-fftw" ref-type="bibr">Frigo
      &amp; Johnson, 1998</xref>) is used for fast Fourier
      transforms.</p>
    </list-item>
    <list-item>
      <p><monospace>StaticArrays.jl</monospace> is used for memory
      efficiency.</p>
    </list-item>
    <list-item>
      <p><monospace>JLD2.jl</monospace> is used to store complex data
      structures.</p>
    </list-item>
    <list-item>
      <p><monospace>Clustering.jl</monospace> is used for molecular
      identification.</p>
    </list-item>
  </list>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>BCF thanks Katie Slavicinska for creating the YASS logo.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-julia">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bezanson</surname><given-names>Jeff</given-names></name>
        <name><surname>Edelman</surname><given-names>Alan</given-names></name>
        <name><surname>Karpinski</surname><given-names>Stefan</given-names></name>
        <name><surname>Shah</surname><given-names>Viral B</given-names></name>
      </person-group>
      <article-title>Julia: A fresh approach to numerical computing</article-title>
      <source>SIAM Review</source>
      <publisher-name>SIAM</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>59</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1137/141000671</pub-id>
      <fpage>65</fpage>
      <lpage>98</lpage>
    </element-citation>
  </ref>
  <ref id="ref-lammps">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Thompson</surname><given-names>Aidan P</given-names></name>
        <name><surname>Aktulga</surname><given-names>H Metin</given-names></name>
        <name><surname>Berger</surname><given-names>Richard</given-names></name>
        <name><surname>Bolintineanu</surname><given-names>Dan S</given-names></name>
        <name><surname>Brown</surname><given-names>W Michael</given-names></name>
        <name><surname>Crozier</surname><given-names>Paul S</given-names></name>
        <name><surname>In’t Veld</surname><given-names>Pieter J</given-names></name>
        <name><surname>Kohlmeyer</surname><given-names>Axel</given-names></name>
        <name><surname>Moore</surname><given-names>Stan G</given-names></name>
        <name><surname>Nguyen</surname><given-names>Trung Dac</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>LAMMPS - a flexible simulation tool for particle-based materials modeling at the atomic, meso, and continuum scales</article-title>
      <source>Computer physics communications</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>271</volume>
      <pub-id pub-id-type="doi">10.1016/j.cpc.2021.108171</pub-id>
      <fpage>108171</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-gromacs1">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Van Der Spoel</surname><given-names>David</given-names></name>
        <name><surname>Lindahl</surname><given-names>Erik</given-names></name>
        <name><surname>Hess</surname><given-names>Berk</given-names></name>
        <name><surname>Groenhof</surname><given-names>Gerrit</given-names></name>
        <name><surname>Mark</surname><given-names>Alan E</given-names></name>
        <name><surname>Berendsen</surname><given-names>Herman JC</given-names></name>
      </person-group>
      <article-title>GROMACS: Fast, flexible, and free</article-title>
      <source>Journal of computational chemistry</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2005">2005</year>
      <volume>26</volume>
      <issue>16</issue>
      <pub-id pub-id-type="doi">10.1002/jcc.20291</pub-id>
      <fpage>1701</fpage>
      <lpage>1718</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gromacs4">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Abraham</surname><given-names>Mark James</given-names></name>
        <name><surname>Murtola</surname><given-names>Teemu</given-names></name>
        <name><surname>Schulz</surname><given-names>Roland</given-names></name>
        <name><surname>Páll</surname><given-names>Szilárd</given-names></name>
        <name><surname>Smith</surname><given-names>Jeremy C</given-names></name>
        <name><surname>Hess</surname><given-names>Berk</given-names></name>
        <name><surname>Lindahl</surname><given-names>Erik</given-names></name>
      </person-group>
      <article-title>GROMACS: High performance molecular simulations through multi-level parallelism from laptops to supercomputers</article-title>
      <source>SoftwareX</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>1</volume>
      <pub-id pub-id-type="doi">10.1016/j.softx.2015.06.001</pub-id>
      <fpage>19</fpage>
      <lpage>25</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gromacs3">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pronk</surname><given-names>Sander</given-names></name>
        <name><surname>Páll</surname><given-names>Szilárd</given-names></name>
        <name><surname>Schulz</surname><given-names>Roland</given-names></name>
        <name><surname>Larsson</surname><given-names>Per</given-names></name>
        <name><surname>Bjelkmar</surname><given-names>Pär</given-names></name>
        <name><surname>Apostolov</surname><given-names>Rossen</given-names></name>
        <name><surname>Shirts</surname><given-names>Michael R</given-names></name>
        <name><surname>Smith</surname><given-names>Jeremy C</given-names></name>
        <name><surname>Kasson</surname><given-names>Peter M</given-names></name>
        <name><surname>Van Der Spoel</surname><given-names>David</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>GROMACS 4.5: A high-throughput and highly parallel open source molecular simulation toolkit</article-title>
      <source>Bioinformatics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>29</volume>
      <issue>7</issue>
      <pub-id pub-id-type="doi">10.1093/bioinformatics/btt055</pub-id>
      <fpage>845</fpage>
      <lpage>854</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gromacs2">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lindahl</surname><given-names>Erik</given-names></name>
        <name><surname>Hess</surname><given-names>Berk</given-names></name>
        <name><surname>Van Der Spoel</surname><given-names>David</given-names></name>
      </person-group>
      <article-title>GROMACS 3.0: A package for molecular simulation and trajectory analysis</article-title>
      <source>Molecular modeling annual</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2001">2001</year>
      <volume>7</volume>
      <issue>8</issue>
      <pub-id pub-id-type="doi">10.1007/s008940100045</pub-id>
      <fpage>306</fpage>
      <lpage>317</lpage>
    </element-citation>
  </ref>
  <ref id="ref-optim">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mogensen</surname><given-names>P</given-names></name>
        <name><surname>Riseth</surname><given-names>A</given-names></name>
      </person-group>
      <article-title>Optim: A mathematical optimization package for Julia</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>Open Journals</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>3</volume>
      <issue>24</issue>
      <pub-id pub-id-type="doi">10.21105/joss.00615</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-diffeq">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rackauckas</surname><given-names>Christopher</given-names></name>
        <name><surname>Nie</surname><given-names>Qing</given-names></name>
      </person-group>
      <article-title>Differentialequations.jl – a performant and feature-rich ecosystem for solving differential equations in Julia</article-title>
      <source>Journal of open research software</source>
      <year iso-8601-date="2017">2017</year>
      <volume>5</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.5334/jors.151</pub-id>
      <fpage>15</fpage>
      <lpage>15</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fftw">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Frigo</surname><given-names>Matteo</given-names></name>
        <name><surname>Johnson</surname><given-names>Steven G</given-names></name>
      </person-group>
      <article-title>FFTW: An adaptive software architecture for the FFT</article-title>
      <source>Proceedings of the 1998 IEEE international conference on acoustics, speech and signal processing, ICASSP’98 (cat. No. 98CH36181)</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="1998">1998</year>
      <volume>3</volume>
      <pub-id pub-id-type="doi">10.1109/icassp.1998.681704</pub-id>
      <fpage>1381</fpage>
      <lpage>1384</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ase">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Larsen</surname><given-names>Ask Hjorth</given-names></name>
        <name><surname>Mortensen</surname><given-names>Jens Jørgen</given-names></name>
        <name><surname>Blomqvist</surname><given-names>Jakob</given-names></name>
        <name><surname>Castelli</surname><given-names>Ivano E</given-names></name>
        <name><surname>Christensen</surname><given-names>Rune</given-names></name>
        <name><surname>Dułak</surname><given-names>Marcin</given-names></name>
        <name><surname>Friis</surname><given-names>Jesper</given-names></name>
        <name><surname>Groves</surname><given-names>Michael N</given-names></name>
        <name><surname>Hammer</surname><given-names>Bjørk</given-names></name>
        <name><surname>Hargus</surname><given-names>Cory</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>The atomic simulation environment—a Python library for working with atoms</article-title>
      <source>Journal of Physics: Condensed Matter</source>
      <publisher-name>IOP Publishing</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>29</volume>
      <issue>27</issue>
      <pub-id pub-id-type="doi">10.1088/1361-648X/aa680e</pub-id>
      <fpage>273002</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-jaxmd">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Schoenholz</surname><given-names>Samuel S.</given-names></name>
        <name><surname>Cubuk</surname><given-names>Ekin D.</given-names></name>
      </person-group>
      <article-title>JAX, M.D.: A framework for differentiable physics</article-title>
      <year iso-8601-date="2020">2020</year>
      <uri>https://arxiv.org/abs/1912.04232</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.1912.04232</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-molly">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Greener</surname><given-names>Joe G</given-names></name>
      </person-group>
      <article-title>Differentiable simulation to develop molecular dynamics force fields for disordered proteins</article-title>
      <source>Chemical Science</source>
      <year iso-8601-date="2024">2024</year>
      <volume>15</volume>
      <uri>https://doi.org/10.1039/D3SC05230C</uri>
      <pub-id pub-id-type="doi">10.1039/D3SC05230C</pub-id>
      <fpage>4897</fpage>
      <lpage>4909</lpage>
    </element-citation>
  </ref>
  <ref id="ref-nqcdynamics">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gardner</surname><given-names>James</given-names></name>
        <name><surname>Douglas-Gallardo</surname><given-names>Oscar A</given-names></name>
        <name><surname>Stark</surname><given-names>Wojciech G</given-names></name>
        <name><surname>Westermayr</surname><given-names>Julia</given-names></name>
        <name><surname>Janke</surname><given-names>Svenja M</given-names></name>
        <name><surname>Habershon</surname><given-names>Scott</given-names></name>
        <name><surname>Maurer</surname><given-names>Reinhard J</given-names></name>
      </person-group>
      <article-title>NQCDynamics.jl: A Julia package for nonadiabatic quantum classical molecular dynamics in the condensed phase</article-title>
      <source>The Journal of Chemical Physics</source>
      <publisher-name>AIP Publishing</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>156</volume>
      <issue>17</issue>
      <pub-id pub-id-type="doi">10.1063/5.0089436</pub-id>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
