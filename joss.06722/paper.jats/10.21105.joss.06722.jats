<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6722</article-id>
<article-id pub-id-type="doi">10.21105/joss.06722</article-id>
<title-group>
<article-title>TREvoSim v3: An individual based simulation for
generating trees and character data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2803-9471</contrib-id>
<name>
<surname>Garwood</surname>
<given-names>Russell J.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-6590-405X</contrib-id>
<name>
<surname>Spencer</surname>
<given-names>Alan R. T.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0000-8444-6322</contrib-id>
<name>
<surname>Bates</surname>
<given-names>Charles T. M.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5870-1964</contrib-id>
<name>
<surname>Callender-Crowe</surname>
<given-names>Leah M.</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7080-5283</contrib-id>
<name>
<surname>Dunn</surname>
<given-names>Frances S.</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4077-732X</contrib-id>
<name>
<surname>Halliday</surname>
<given-names>Thomas J. D.</given-names>
</name>
<xref ref-type="aff" rid="aff-6"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2667-7795</contrib-id>
<name>
<surname>Keating</surname>
<given-names>Joseph N.</given-names>
</name>
<xref ref-type="aff" rid="aff-7"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-6317-5869</contrib-id>
<name>
<surname>Mongiardino Koch</surname>
<given-names>Nicolás</given-names>
</name>
<xref ref-type="aff" rid="aff-8"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3910-0346</contrib-id>
<name>
<surname>Parry</surname>
<given-names>Luke A.</given-names>
</name>
<xref ref-type="aff" rid="aff-9"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1926-2556</contrib-id>
<name>
<surname>Sansom</surname>
<given-names>Robert S.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2083-7452</contrib-id>
<name>
<surname>Smith</surname>
<given-names>Thomas J.</given-names>
</name>
<xref ref-type="aff" rid="aff-9"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7137-7572</contrib-id>
<name>
<surname>Sutton</surname>
<given-names>Mark D.</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0003-3513-8448</contrib-id>
<name>
<surname>Vanteghem</surname>
<given-names>Thomas</given-names>
</name>
<xref ref-type="aff" rid="aff-10"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Earth and Environmental Sciences, University
of Manchester, Manchester, M13 9PL, United Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Natural History Museum, London, SW7 5BD, United
Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Department of Earth Science and Engineering, Imperial
College, London, SW7 2AZ, United Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>School of Biological Sciences, University of Reading,
Reading, United Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Oxford University Museum of Natural History, University of
Oxford, Oxford, OX1 3PW, United Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-6">
<institution-wrap>
<institution>School of Geography, Earth and Environmental Sciences,
University of Birmingham, Birmingham B15 2TT, United
Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-7">
<institution-wrap>
<institution>School of Earth Sciences, University of Bristol, Life
Sciences Building, Tyndall Avenue, Bristol, BS8 1TQ, United
Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-8">
<institution-wrap>
<institution>Scripps Institution of Oceanography, UC San Diego, La
Jolla, CA 92122, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-9">
<institution-wrap>
<institution>Department of Earth Sciences, University of Oxford, Oxford,
OX1 3AN, United Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-10">
<institution-wrap>
<institution>Erasmus Mundus Joint Master Degree PANGEA, Université de
Lille, France</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-03-24">
<day>24</day>
<month>3</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>101</issue>
<fpage>6722</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>evolution</kwd>
<kwd>simulation</kwd>
<kwd>phylogenetics</kwd>
<kwd>ecology</kwd>
<kwd>palaeontology</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Simulations provide valuable insights into the patterns and
  processes of evolution, and the performance of analytical methods used
  to investigate empirical data
  (<xref alt="Barido-Sottani et al., 2020" rid="ref-Barido-Sottani_Saupe_Smiley_Soul_Wright_Warnock_2020" ref-type="bibr">Barido-Sottani
  et al., 2020</xref>;
  <xref alt="Dolson &amp; Ofria, 2021" rid="ref-Dolson_Ofria_2021" ref-type="bibr">Dolson
  &amp; Ofria, 2021</xref>;
  <xref alt="Wright &amp; Hillis, 2014" rid="ref-Wright_Hillis_2014" ref-type="bibr">Wright
  &amp; Hillis, 2014</xref>). Here we present TREvoSim v3.0.0: an
  agent-/individual-based model written in C++, in which digital
  organisms evolve, creating phylogenetic character data and trees.
  Trees inferred from empirical data always carry uncertainty, but
  TREvoSim can create a known tree alongside associated character data,
  allowing – for example – assessment of phylogenetic inference methods
  (<xref alt="Keating et al., 2020" rid="ref-Keating_Sansom_Sutton_Knight_Garwood_2020" ref-type="bibr">Keating
  et al., 2020</xref>;
  <xref alt="Mongiardino Koch et al., 2021" rid="ref-Mongiardino_Koch_Garwood_Parry_2021" ref-type="bibr">Mongiardino
  Koch et al., 2021</xref>,
  <xref alt="2023" rid="ref-Mongiardino_Koch_Garwood_Parry_2023" ref-type="bibr">2023</xref>).
  The v3.0.0 release adds a range of features to allow greater
  flexibility in simulating phylogenetic trees and character data (more
  logging options, finer control over character character and simulation
  parameters), and to facilitate the study of broader evolutionary
  topics (e.g. ecosystem engineering, adaptive landscapes,
  selection).</p>
</sec>
<sec id="background">
  <title>Background</title>
  <p>A range of digital platforms to study evolution and ecology exist,
  with varied approaches and levels of abstraction
  (<xref alt="Dolson &amp; Ofria, 2021" rid="ref-Dolson_Ofria_2021" ref-type="bibr">Dolson
  &amp; Ofria, 2021</xref>). TREvoSim is a sister-package to the
  spatially explicit eco-evolutionary simulation REvoSim
  (<xref alt="Furness et al., 2023" rid="ref-Furness_Garwood_Sutton_2023" ref-type="bibr">Furness
  et al., 2023</xref>;
  <xref alt="Garwood et al., 2019" rid="ref-Garwood_Spencer_Sutton_2019" ref-type="bibr">Garwood
  et al., 2019</xref>). v1.0.0 was developed to investigate the accuracy
  and precision of phylogenetic inference methods
  (<xref alt="Keating et al., 2020" rid="ref-Keating_Sansom_Sutton_Knight_Garwood_2020" ref-type="bibr">Keating
  et al., 2020</xref>). After further development, TREvoSim v2.0.0 was
  used to investigate the impact fossils have on phylogenetic inference
  and evolutionary timescales
  (<xref alt="Mongiardino Koch et al., 2021" rid="ref-Mongiardino_Koch_Garwood_Parry_2021" ref-type="bibr">Mongiardino
  Koch et al., 2021</xref>,
  <xref alt="2023" rid="ref-Mongiardino_Koch_Garwood_Parry_2023" ref-type="bibr">2023</xref>).
  In brief, TREvoSim is a non spatially-explicit model in which
  organisms – which consist of a genome of binary characters – compete
  within a structure called the playing-field to echo natural selection
  (Figure 1). Their chance of replication is dictated by a fitness
  algorithm that assesses organismal fit against a series of random
  numbers (masks, constituting an environment). On replication,
  organisms have a chance of mutation, and descendents overwrite a
  current member of the playing field. The simulation has a
  lineage-based species concept, and at the end of a simulation the
  software can output trees and characters (species genomes), as well as
  logging the simulation state as the model runs.</p>
  <fig>
    <caption><p>Figure 1 - A simplified overview of TREvoSim. Green text
    represents a user-defined variable and the given value is default.
    The figure is split into data structures, the fitness calculation,
    the algorithm, and the tree. In the tree, character change is
    represented by change on the Y axis, time on the X. Any lineage is
    likely to comprise multiple individuals: modal genomes are shown in
    solid lines, and non-modal via dashed lines. By default, genomes for
    each species are recorded on their extinction. A full description of
    the algorithm is available in the
    <ext-link ext-link-type="uri" xlink:href="https://trevosim.readthedocs.io/en/latest/">TREvoSim
    documentation</ext-link>.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="./Figure_01.png" />
  </fig>
</sec>
<sec id="new-features">
  <title>New features</title>
  <p>TREvoSim v3.0.0 includes a suite of new features that allow the
  investigation of an expanded range of evolutionary processes. These
  new features are briefly introduced (in alphabetical order) below, and
  fully described in the
  <ext-link ext-link-type="uri" xlink:href="https://trevosim.readthedocs.io/en/latest/">TREvoSim
  documentation</ext-link>.</p>
  <sec id="model-enhancements">
    <title>Model enhancements</title>
    <sec id="ecosystem-engineering">
      <title>Ecosystem engineering</title>
      <p>A new ecosystem engineering system allows the impact of
      organism-environment feedback to be investigated
      (<xref alt="Jones et al., 1994" rid="ref-Jones_Lawton_Shachak_1994" ref-type="bibr">Jones
      et al., 1994</xref>). When the ecosystem engineering option is
      enabled (it is disabled in default settings), a species is
      assigned ecosystem engineering status halfway through a run, and
      passes this status to descendents. When this occurs, the genome of
      that organism is either used to overwrite an environmental mask,
      or added to the environment as an additional mask. Overwriting a
      mask reduces the Hamming distance between engineers and masks, and
      – assuming a low fitness target – thus directly improves their
      fitness relative to non-engineers. In contrast, adding a mask
      changes the nature of the fitness landscape for all organisms, but
      with a weaker direct benefit to ecosystem engineers. Ecosystem
      engineering can occur just once (‘one-shot’ ecosystem engineering)
      or can be repeated after the first application (‘persistent’).
      When a mask is added in the first application, it is overwritten
      in subsequent applications when ecosystem engineers are
      persistent. A new facility to log the ecosystem-engineering status
      of individuals is provided.</p>
    </sec>
    <sec id="expanding-playing-field">
      <title>Expanding playing field</title>
      <p>This new option alters competition such that it occurs between
      species rather than between individuals. When enabled (disabled by
      default), this is achieved by allowing only one individual from
      each species to be present in the playing field at any time. As
      such, the playing field grows to accommodate new species, which
      appear following the standard speciation rules. On duplication of
      an individual, juveniles overwrite the previous member of their
      species in the playing field. Otherwise, the playing field
      operates as normal, i.e. it is ordered by fitness and duplication
      of an individual selected using a geometric distribution links
      fitness to fecundity. Enabling the expanding playing field removes
      intra-species competition from the simulation: this can be used to
      investigate the impact that intra- vs. inter-species competition
      has on evolutionary processes during a run, and on the
      phylogenetic outcomes of a simulation.</p>
    </sec>
    <sec id="match-peaks">
      <title>Match peaks</title>
      <p>When there are multiple environments for any given playing
      field, by default masks are seeded with random numbers, and may
      thus have different peak fitness values. This new option (disabled
      by default) instead seeds each playing field with environments
      that have the same peak fitness. This is achieved by doing a
      site-wise randomisation of the sequence of zeros and ones across
      masks, between environments. For example, with three masks in a
      given environment, the first site may be 1,0,0 for masks 1,2 and 3
      respectively – when this option is enabled, the pattern from site
      one may be moved to site seven between the first and second
      environment, and this is repeated for all sites. This operation
      ensures that the best achievable fitness at the start of a
      simulation will remain the same, but will be achieved by a
      different genome across environments. In v3.0.0, as the simulation
      progresses and mutations to the masks occur, matching peaks are no
      longer guaranteed (it is possible this will change in future
      releases). Additionally, the simulation uses a heuristic algorithm
      to generate an initial seed organism that has the same fitness in
      each environment (in &gt;99% of cases) when this option is
      selected. In general, this option allows finer control of the
      fitness landscape, and its impact on evolution to be
      investigated.</p>
    </sec>
    <sec id="no-selection">
      <title>No selection</title>
      <p>Another new addition is a no selection mode – when this is
      enabled (disabled by default), organisms for replication are
      chosen from the playing field at random, rather than using fitness
      to determine replication probability. When this option is enabled,
      the simulation functions under drift, allowing study of
      e.g. neutral vs. selective regimes.</p>
    </sec>
    <sec id="playing-field-mixing">
      <title>Playing field mixing</title>
      <p>By default TREvoSim playing fields are independent data
      structures, and organisms in one playing field do not compete with
      those in others during a simulation. This new option allows
      configurable mixing of organisms between playing fields, which can
      be asymmetrical if desired. Playing field mixing can facilitate
      the study of, for example, the dynamics of invasive species or
      biotic interchanges.</p>
    </sec>
    <sec id="stochastic-layer">
      <title>Stochastic layer</title>
      <p>Provides a layer of abstraction between an organism’s genome
      and the bits used for the fitness calculation (this option is
      disabled by default). It achieves this using many-to-one mapping
      (i.e. using a sequence of multiple bits to define the value of a
      single bit), the map being defined by the user. For example, the
      sequence of bits 0110 in a genome might map to a 1 bit in the
      genome calculation, whilst are 1100 may map to 0. As such, any
      individual bit does not necessarily have an impact on the fitness
      of an organism as a whole, allowing e.g. neutral mutations and
      less strongly adaptationist dynamics.</p>
    </sec>
    <sec id="perturbations">
      <title>Perturbations</title>
      <p>When enabled (disabled by default), this implements a limited
      period of increased rates of environmental change that occurs
      halfway through a run (when half the requested species have
      evolved, or at half the requested iteration number). This is
      intended for study of scenarios where evolutionary dynamics are
      driven by variations in the rate of environmental
      change(<xref alt="Condamine et al., 2013" rid="ref-Condamine_Rolland_Morlon_2013" ref-type="bibr">Condamine
      et al., 2013</xref>). There is an option to also increase mixing
      between playing fields during a perturbation. This system can
      provide insights into the impact of disturbance and rapid
      environmental change, for example, on evolution in a non-spatially
      explicit setting.</p>
    </sec>
  </sec>
  <sec id="software-modifications">
    <title>Software modifications</title>
    <sec id="character-limits">
      <title>Character limits</title>
      <p>New options allow finer control of TREvoSim functions that
      employ genome characters. Characters in TREvoSim are used in
      several portions of the algorithm – they form the basis of
      calculating fitness of organisms, and are also employed in the
      identification of species. In previous versions of TREvoSim, all
      characters were used for both functions, through a user-defined
      total character number. From v3, a separate limit on the character
      count used for species selection and/or the fitness calculation
      can be applied (in the default settings, all are the same). When
      either – or both – differ from the total character number, only a
      subset of characters (those from zero to the limit) are included
      in the defined operations, and others can evolve independent of
      these processes (i.e., in the absence of selective forces, akin to
      more neutral drift-like processes).</p>
    </sec>
    <sec id="default-simulation-parameters">
      <title>Default simulation parameters</title>
      <p>New default values for simulation parameters are introduced
      with this release. Outputs created using these default variables
      have been compared against twelve empirical, total evidence
      analyses (following the approach of, and using empirical data
      sourced from,
      <xref alt="Mongiardino Koch et al., 2021" rid="ref-Mongiardino_Koch_Garwood_Parry_2021" ref-type="bibr">Mongiardino
      Koch et al., 2021</xref>) for three measures of tree shape and
      homoplasy. The empirical data, analysis script, and resulting
      graphs have been placed within the source code repository, and the
      results are presented in the documentation.</p>
    </sec>
    <sec id="running-log">
      <title>Running log</title>
      <p>In previous versions, TREvoSim only allowed outputs at the end
      of a run. From v3, an additional logging system has been added,
      called the running log, that allows the user to create a
      customised file recording many aspects of the simulation state –
      for example, the tree and the character data – during a run. The
      user can define all log outputs using the logging options (which
      are outlined in the documentation), and can also dictate the
      frequency with which the running log is written.</p>
    </sec>
    <sec id="simulation-modes">
      <title>Simulation modes</title>
      <p>Simulation-termination can now be configured to occur after
      either a user-defined number of iterations, or when a user-defined
      number of species have evolved; only the latter was previously
      available. This provides increased flexibility in experimental
      design.</p>
    </sec>
    <sec id="codebase-tests">
      <title>Codebase Tests</title>
      <p>TREvoSim v3.0.0 introduces a test suite covering all aspects of
      the simulation mechanics. These can be accessed by the user,
      through the graphical user interface, by developers through an
      integrated development environment such as Qt Creator, and by both
      through running the test binary, as outlined in the
      documentation.</p>
    </sec>
  </sec>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>TREvoSim employs a selection-driven, agent-based approach: it
  incorporates key elements of biological evolution (selection,
  reproduction, heritability and mutation). The (true) phylogenetic
  trees and character data are an emergent property of a TREvoSim
  simulation, and as such the software is particularly well suited to
  simulation studies that can be analysed through phylogenetic trees and
  character data matrices. These include, for example: the impact of
  missing data on phylogenetic inference; the impact of rates of
  environmental change on character evolution; and the nature of
  evolution under different fitness landscapes. This complements other
  simulation approaches where, typically, phylogenetic trees or
  character data are simulated using stochastic tools such as
  birth-death models (e.g.
  <xref alt="Guillerme, 2024" rid="ref-Guillerme_2024" ref-type="bibr">Guillerme,
  2024</xref>) or data based on random numbers (e.g.
  <xref alt="Puttick et al., 2019" rid="ref-Puttick_O_Reilly_Pisani_Donoghue_2019" ref-type="bibr">Puttick
  et al., 2019</xref>) that do not incorporate, for example, selection
  acting on individuals. The data TREvoSim generates are different in a
  number of ways to those created using stochastic models
  (<xref alt="Keating et al., 2020" rid="ref-Keating_Sansom_Sutton_Knight_Garwood_2020" ref-type="bibr">Keating
  et al., 2020</xref>), and are also likely to violate the assumptions
  of models commonly used in phylogenetic inference. Incorporating a
  level of model misspecification resembling that expected from
  empirical datasets is desirable in simulation studies that assess the
  efficacy of inference methods. Given the complexity of morphological
  evolution, the subsequent impact of character coding, and our current
  understanding of the patterns present in empirical character data, it
  is challenging to demonstrate, beyond the inclusion of empirically
  grounded concepts in its generation, the naturalism of TREvoSim data.
  The default settings have been chosen to reflect a number of features
  of empirical data matrices and trees to try and minimise the mismatch
  between TREvoSim and real world data, however, there are a broad range
  of potential alternative means of quantifying outputs. Which of these
  is most appropriate is likely to depend on the area of study and
  specific question at hand, and as such, TREvoSim provides granular
  control over the simulation parameters, allowing users to generate
  data that best serve their needs. TREvoSim is intended as a versatile
  platform that might be used to study a broad range of topics.</p>
</sec>
<sec id="current-associated-projects">
  <title>Current associated projects</title>
  <p>In addition to the published studies, cited previously, future
  directions include:</p>
  <list list-type="bullet">
    <list-item>
      <p>TJS, FSD, LAP, RJG - The Macroevolutionary consequences of
      ecosystem engineering.</p>
    </list-item>
    <list-item>
      <p>CTMB, TJS, LAP, RJG, FSD - Fitness landscapes and
      disparity.</p>
    </list-item>
    <list-item>
      <p>TJDH, RJG - Mixing and perturbations.</p>
    </list-item>
    <list-item>
      <p>RSS, ARTS, RJG, JNK - Impact of character number and correlated
      characters in a phylogenetic context.</p>
    </list-item>
    <list-item>
      <p>NMK, LAP, RJG - Phylogenetic method development.</p>
    </list-item>
    <list-item>
      <p>JNK, RJG - Impact of evolutionary mode on phylogenetic
      character data.</p>
    </list-item>
    <list-item>
      <p>MDS, RJG - Fossilisation and phylogenetic inference.</p>
    </list-item>
  </list>
</sec>
<sec id="author-contributions">
  <title>Author contributions</title>
  <p>RJG developed and coded TREvoSim, with support on testing and
  releasing from ARTS. RSS, LMC-C, MDS, and JNK contributed ideas during
  the initial phases and continued development of the software, and JNK
  proposed the stochastic layer. Peak matching and associated features
  were developed in collaboration with CTMB, FSD, LAP and TJS, and
  ecosystem engineering was developed in collaboration with LAP, FSD and
  TJS. Mixing and perturbations were proposed by TJDH. Development of
  many of the features released in v2.0.0 was conducted in collaboration
  with, and empirical benchmarking was led by, NMK. The expanding
  playing field was developed with and analysed by TV.</p>
</sec>
<sec id="availability">
  <title>Availability</title>
  <p>TREvoSim v3.0.0 source code and binaries are freely available from
  <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.13358420">Zenodo</ext-link>
  and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/palaeoware/trevosim/releases/tag/v3.0.0">GitHub</ext-link>.
  Newer releases of the TREvoSim software will be available on GitHub.
  Full documentation is available from
  <ext-link ext-link-type="uri" xlink:href="https://trevosim.readthedocs.io/en/latest/">ReadTheDocs</ext-link>.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>RJG and RSS were supported by the NERC award NE/T000813/1 and
  development began during the BBSRC grant BB/N015827/1 awarded to RSS
  and RJG. RJG is supported by the Alexander von Humboldt Foundation;
  RJG, LAP, and RSS by Leverhulme Trust Research Project Grant
  (RPG-2023-234); FSD by NERC fellowship NE/W00786X/1; and LAP by NERC
  fellowship NE/W007878/1. We are grateful to the reviewers of this
  contribution, Martin R. Smith and Alison T. Cribb, for suggestions
  that significantly improved the quality of this publication and the
  TREvoSim documentation, and to Martin R. Smith for additional auditing
  of our code.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-Barido-Sottani_Saupe_Smiley_Soul_Wright_Warnock_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Barido-Sottani</surname><given-names>Joëlle</given-names></name>
        <name><surname>Saupe</surname><given-names>Erin E.</given-names></name>
        <name><surname>Smiley</surname><given-names>Tara M.</given-names></name>
        <name><surname>Soul</surname><given-names>Laura C.</given-names></name>
        <name><surname>Wright</surname><given-names>April M.</given-names></name>
        <name><surname>Warnock</surname><given-names>Rachel C. M.</given-names></name>
      </person-group>
      <article-title>Seven rules for simulations in paleobiology</article-title>
      <source>Paleobiology</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2020-11">2020</year><month>11</month>
      <volume>46</volume>
      <issue>4</issue>
      <issn>0094-8373</issn>
      <pub-id pub-id-type="doi">10.1017/pab.2020.30</pub-id>
      <fpage>435</fpage>
      <lpage>444</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Condamine_Rolland_Morlon_2013">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Condamine</surname><given-names>Fabien L.</given-names></name>
        <name><surname>Rolland</surname><given-names>Jonathan</given-names></name>
        <name><surname>Morlon</surname><given-names>Hélène</given-names></name>
      </person-group>
      <article-title>Macroevolutionary perspectives to environmental change</article-title>
      <source>Ecology Letters</source>
      <publisher-name>John Wiley &amp; Sons, Ltd</publisher-name>
      <year iso-8601-date="2013-01">2013</year><month>01</month>
      <volume>16</volume>
      <issn>1461-0248</issn>
      <pub-id pub-id-type="doi">10.1111/ele.12062</pub-id>
      <fpage>72</fpage>
      <lpage>85</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Dolson_Ofria_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dolson</surname><given-names>Emily</given-names></name>
        <name><surname>Ofria</surname><given-names>Charles</given-names></name>
      </person-group>
      <article-title>Digital evolution for ecology research: A review</article-title>
      <source>Frontiers in Ecology and Evolution</source>
      <year iso-8601-date="2021">2021</year>
      <volume>9</volume>
      <issn>2296-701X</issn>
      <uri>https://www.frontiersin.org/articles/10.3389/fevo.2021.750779</uri>
      <pub-id pub-id-type="doi">10.3389/fevo.2021.750779</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-Furness_Garwood_Sutton_2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Furness</surname><given-names>Euan N.</given-names></name>
        <name><surname>Garwood</surname><given-names>Russell J.</given-names></name>
        <name><surname>Sutton</surname><given-names>Mark D.</given-names></name>
      </person-group>
      <article-title>REvoSim v3: A fast evolutionary simulation tool with ecological processes</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2023-09">2023</year><month>09</month>
      <volume>8</volume>
      <issue>89</issue>
      <issn>2475-9066</issn>
      <pub-id pub-id-type="doi">10.21105/joss.05284</pub-id>
      <fpage>5284</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Garwood_Spencer_Sutton_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Garwood</surname><given-names>Russell J.</given-names></name>
        <name><surname>Spencer</surname><given-names>Alan R. T.</given-names></name>
        <name><surname>Sutton</surname><given-names>Mark D.</given-names></name>
      </person-group>
      <article-title>REvoSim: Organism-level simulation of macro and microevolution</article-title>
      <source>Palaeontology</source>
      <year iso-8601-date="2019">2019</year>
      <volume>62</volume>
      <issue>3</issue>
      <issn>1475-4983</issn>
      <pub-id pub-id-type="doi">10.1111/pala.12420</pub-id>
      <fpage>339</fpage>
      <lpage>355</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Guillerme_2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Guillerme</surname><given-names>Thomas</given-names></name>
      </person-group>
      <article-title>Treats: A modular r package for simulating trees and traits</article-title>
      <source>Methods in Ecology and Evolution</source>
      <year iso-8601-date="2024">2024</year>
      <volume>15</volume>
      <issue>4</issue>
      <issn>2041-210X</issn>
      <pub-id pub-id-type="doi">10.1111/2041-210X.14306</pub-id>
      <fpage>647</fpage>
      <lpage>656</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Jones_Lawton_Shachak_1994">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jones</surname><given-names>Clive G.</given-names></name>
        <name><surname>Lawton</surname><given-names>John H.</given-names></name>
        <name><surname>Shachak</surname><given-names>Moshe</given-names></name>
      </person-group>
      <article-title>Organisms as ecosystem engineers</article-title>
      <source>Oikos</source>
      <publisher-name>[Nordic Society Oikos, Wiley]</publisher-name>
      <year iso-8601-date="1994">1994</year>
      <volume>69</volume>
      <issue>3</issue>
      <issn>0030-1299</issn>
      <pub-id pub-id-type="doi">10.2307/3545850</pub-id>
      <fpage>373</fpage>
      <lpage>386</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Keating_Sansom_Sutton_Knight_Garwood_2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Keating</surname><given-names>Joseph N.</given-names></name>
        <name><surname>Sansom</surname><given-names>Robert S.</given-names></name>
        <name><surname>Sutton</surname><given-names>Mark D.</given-names></name>
        <name><surname>Knight</surname><given-names>Christopher G.</given-names></name>
        <name><surname>Garwood</surname><given-names>Russell J.</given-names></name>
      </person-group>
      <article-title>Morphological phylogenetics evaluated using novel evolutionary simulations</article-title>
      <source>Systematic Biology</source>
      <publisher-name>Oxford Academic</publisher-name>
      <year iso-8601-date="2020-09">2020</year><month>09</month>
      <volume>69</volume>
      <issue>5</issue>
      <issn>1063-5157</issn>
      <pub-id pub-id-type="doi">10.1093/sysbio/syaa012</pub-id>
      <fpage>897</fpage>
      <lpage>912</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Mongiardino_Koch_Garwood_Parry_2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mongiardino Koch</surname><given-names>Nicolás</given-names></name>
        <name><surname>Garwood</surname><given-names>Russell J.</given-names></name>
        <name><surname>Parry</surname><given-names>Luke A.</given-names></name>
      </person-group>
      <article-title>Fossils improve phylogenetic analyses of morphological characters</article-title>
      <source>Proceedings of the Royal Society B: Biological Sciences</source>
      <publisher-name>Royal Society</publisher-name>
      <year iso-8601-date="2021-05">2021</year><month>05</month>
      <volume>288</volume>
      <issue>1950</issue>
      <pub-id pub-id-type="doi">10.1098/rspb.2021.0044</pub-id>
      <fpage>20210044</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Mongiardino_Koch_Garwood_Parry_2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mongiardino Koch</surname><given-names>Nicolás</given-names></name>
        <name><surname>Garwood</surname><given-names>Russell J.</given-names></name>
        <name><surname>Parry</surname><given-names>Luke A.</given-names></name>
      </person-group>
      <article-title>Inaccurate fossil placement does not compromise tip-dated divergence times</article-title>
      <source>Palaeontology</source>
      <year iso-8601-date="2023">2023</year>
      <volume>66</volume>
      <issue>6</issue>
      <issn>1475-4983</issn>
      <pub-id pub-id-type="doi">10.1111/pala.12680</pub-id>
      <fpage>e12680</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Puttick_O_Reilly_Pisani_Donoghue_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Puttick</surname><given-names>Mark N.</given-names></name>
        <name><surname>O’Reilly</surname><given-names>Joseph E.</given-names></name>
        <name><surname>Pisani</surname><given-names>Davide</given-names></name>
        <name><surname>Donoghue</surname><given-names>Philip C. J.</given-names></name>
      </person-group>
      <article-title>Probabilistic methods outperform parsimony in the phylogenetic analysis of data simulated without a probabilistic model</article-title>
      <source>Palaeontology</source>
      <person-group person-group-type="editor">
        <name><surname>Rahman</surname><given-names>Imran</given-names></name>
      </person-group>
      <year iso-8601-date="2019">2019</year>
      <volume>62</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1111/pala.12388</pub-id>
      <fpage>1</fpage>
      <lpage>17</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Wright_Hillis_2014">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wright</surname><given-names>April M.</given-names></name>
        <name><surname>Hillis</surname><given-names>David M.</given-names></name>
      </person-group>
      <article-title>Bayesian analysis using a simple likelihood model outperforms parsimony for estimation of phylogeny from discrete morphological data</article-title>
      <source>PLoS ONE</source>
      <person-group person-group-type="editor">
        <name><surname>Poon</surname><given-names>Art F. Y.</given-names></name>
      </person-group>
      <year iso-8601-date="2014-10">2014</year><month>10</month>
      <volume>9</volume>
      <issue>10</issue>
      <issn>1932-6203</issn>
      <pub-id pub-id-type="doi">10.1371/journal.pone.0109210</pub-id>
      <fpage>e109210</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
