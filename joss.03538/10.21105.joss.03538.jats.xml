<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">3538</article-id>
<article-id pub-id-type="doi">10.21105/joss.03538</article-id>
<title-group>
<article-title>daiR: an R package for OCR with Google Document
AI</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">0000-0001-6253-1518</contrib-id>
<string-name>Thomas Hegghammer</string-name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Senior Research Fellow, Norwegian Defence Research
Establishment (FFI)</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2021-08-31">
<day>31</day>
<month>8</month>
<year>2021</year>
</pub-date>
<volume>6</volume>
<issue>68</issue>
<fpage>3538</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2021</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>optical character recognition</kwd>
<kwd>cloud computing</kwd>
<kwd>text mining</kwd>
<kwd>natural language processing</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Optical character recognition (OCR) promises to open up centuries
  worth of text to computational analysis. But OCR software has long
  been sensitive to visual noise and weak on non-Western languages. In
  April 2021, Google launched Document AI (DAI), a server-based
  processor offering high-accuracy OCR for over sixty languages
  (<xref alt="Vanguri, 2021" rid="ref-vanguriU003A2021" ref-type="bibr">Vanguri,
  2021</xref>). The <monospace>daiR</monospace>
  (<xref alt="Hegghammer, 2021b" rid="ref-hegghammerU003A2021" ref-type="bibr">Hegghammer,
  2021b</xref>) package provides an R interface to the Document AI API
  along with additional tools for output parsing and visualization.</p>
</sec>
<sec id="summary">
  <title>Summary</title>
  <p>Text as data is a growing field in the social sciences and digital
  humanities, but computational access to text produced before the late
  20th century has been limited by the difficulty of extracting text
  from document scans. Established OCR libraries such as Tesseract
  (<xref alt="Tesseract, 2021" rid="ref-tesseractU003A2021" ref-type="bibr">Tesseract,
  2021</xref>) are highly sensitive to noise and often require extensive
  corpus-specific adaptations to render text accurately.</p>
  <p>The past two years have seen the introduction of server-based OCR
  processors, such as Amazon Textract
  (<xref alt="Amazon, 2021" rid="ref-amazonU003A2021" ref-type="bibr">Amazon,
  2021</xref>) and Google Document AI (DAI), which offer very high
  accuracy out of the box
  (<xref alt="Hegghammer, 2021a" rid="ref-hegghammerU003A2021b" ref-type="bibr">Hegghammer,
  2021a</xref>). Of the two, DAI performs better in benchmarking tests
  and offers broader language support.</p>
  <p>In R, where many scholars do their text analysis work, there are
  packages for Tesseract
  (<xref alt="Ooms, 2021" rid="ref-oomsU003A2021" ref-type="bibr">Ooms,
  2021</xref>) and Amazon Textract
  (<xref alt="Kretch &amp; Banker, 2021" rid="ref-kretchU003A2021" ref-type="bibr">Kretch
  &amp; Banker, 2021</xref>), but not for Document AI. The primary
  objective of <monospace>daiR</monospace> is therefore to provide
  access, from within R, to all the main functionalities of the Document
  AI API. The secondary aim is to offer tools to help parse the output
  returned by the DAI processor.</p>
  <p>DAI is part of Google Cloud Services (GCS), a suite of cloud
  computing services for storage, analytics, and machine learning.
  <monospace>daiR</monospace> joins a family of existing R packages that
  interface with GCS, such as <monospace>googleLanguageR</monospace>
  (<xref alt="Edmondson, 2020" rid="ref-edmondsonU003A2020" ref-type="bibr">Edmondson,
  2020</xref>) and <monospace>googleCloudStorageR</monospace>
  (<xref alt="Edmondson, 2021" rid="ref-edmondsonU003A2021" ref-type="bibr">Edmondson,
  2021</xref>), that together allow for the implementation of multiple
  GCS tools into an R-based text mining workflow.</p>
  <p><monospace>daiR</monospace> also includes a range of tools to
  process DAI’s output, which comes in complex JSON files. One set of
  functions extracts text and table data from the JSON files and brings
  them into R as character vectors or data frames. Another set draws
  block, paragraph, line, and token boundary boxes on images of the
  submitted documents, to help with visual inspection. A third group of
  functions helps rearrange text blocks in the cases where Document AI
  has misread their order. Document AI has near-perfect character
  recognition, but its parsing of complex page layouts is fallible. This
  problem is likely to diminish over time as Document AI’s algorithm
  trains on ever larger document data sets. In the meantime,
  <monospace>daiR</monospace> makes it relatively easy to correct DAI’s
  errors and obtain an accurately rendered text.</p>
  <p><monospace>daiR</monospace> is the first R tool to offer
  high-accuracy text extraction from noisy historical documents out of
  the box. Until now, scholars have often dealt with Tesseract’s high
  error rates by treating error as noise and using bag-of-words
  techniques such as topic modeling. Low-error OCR opens up for wider
  use of natural language processing and other methods that require
  correctly parsed and ordered text. DAI’s improved language coverage
  may also help reduce the prevalence of English-language data in
  computational text analysis.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>I am grateful to Mark Edmondson, Trond Arne Sørby, Neil Ketchley,
  and Hallvar Gisnås for contributions to this project and to
  Christopher Barrie for valuable reviewer comments.</p>
</sec>
</body>
<back>
<ref-list>
  <ref-list>
    <ref id="ref-amazonU003A2021">
      <element-citation>
        <person-group person-group-type="author">
          <string-name>Amazon</string-name>
        </person-group>
        <article-title>Amazon Textract: Easily extract printed text, handwriting, and data from virtually any document</article-title>
        <year iso-8601-date="2021">2021</year>
        <uri>https://aws.amazon.com/textract/</uri>
      </element-citation>
    </ref>
    <ref id="ref-edmondsonU003A2020">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>Edmondson</surname><given-names>M.</given-names></name>
        </person-group>
        <article-title>googleCloudLanguageR: Call Google’s ’Natural Language’ API, ’Cloud Translation’ API, ’Cloud Speech’ API and ’Cloud Text-to-Speech’ API</article-title>
        <year iso-8601-date="2020">2020</year>
        <uri>https://cran.r-project.org/package=googleLanguageR</uri>
      </element-citation>
    </ref>
    <ref id="ref-edmondsonU003A2021">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>Edmondson</surname><given-names>M.</given-names></name>
        </person-group>
        <article-title>googleCloudStorageR: Interface with Google Cloud Storage API</article-title>
        <year iso-8601-date="2021">2021</year>
        <uri>https://cran.r-project.org/package=googleCloudStorageR</uri>
      </element-citation>
    </ref>
    <ref id="ref-hegghammerU003A2021">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>Hegghammer</surname><given-names>T.</given-names></name>
        </person-group>
        <article-title>daiR: An R package for OCR in Google Document AI</article-title>
        <year iso-8601-date="2021">2021</year>
        <uri>https://cran.r-project.org/package=daiR</uri>
      </element-citation>
    </ref>
    <ref id="ref-hegghammerU003A2021b">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Hegghammer</surname><given-names>T.</given-names></name>
        </person-group>
        <article-title>OCR with Tesseract, Amazon Textract, and Google Document AI: A Benchmarking Experiment</article-title>
        <source>Socarxiv</source>
        <year iso-8601-date="2021-06">2021</year><month>06</month>
        <uri>https://osf.io/preprints/socarxiv/6zfvs</uri>
        <pub-id pub-id-type="doi">10.31235/osf.io/6zfvs</pub-id>
      </element-citation>
    </ref>
    <ref id="ref-kretchU003A2021">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>Kretch</surname><given-names>M.</given-names></name>
          <name><surname>Banker</surname><given-names>A.</given-names></name>
        </person-group>
        <article-title>paws: Amazon Web Services Software Development Kit</article-title>
        <year iso-8601-date="2021">2021</year>
        <uri>https://cran.r-project.org/package=paws</uri>
      </element-citation>
    </ref>
    <ref id="ref-oomsU003A2021">
      <element-citation>
        <person-group person-group-type="author">
          <name><surname>Ooms</surname><given-names>J.</given-names></name>
        </person-group>
        <article-title>tesseract: Open Source OCR Engine</article-title>
        <year iso-8601-date="2021">2021</year>
        <uri>https://cloud.r-project.org/web/packages/tesseract/index.html</uri>
      </element-citation>
    </ref>
    <ref id="ref-tesseractU003A2021">
      <element-citation>
        <person-group person-group-type="author">
          <string-name>Tesseract</string-name>
        </person-group>
        <article-title>Tesseract OCR</article-title>
        <source>GitHub repository</source>
        <publisher-name>GitHub</publisher-name>
        <year iso-8601-date="2021">2021</year>
        <uri>https://github.com/tesseract-ocr/tesseract</uri>
      </element-citation>
    </ref>
    <ref id="ref-vanguriU003A2021">
      <element-citation publication-type="article-journal">
        <person-group person-group-type="author">
          <name><surname>Vanguri</surname><given-names>S.</given-names></name>
        </person-group>
        <article-title>Customers cut document processing time and costs with DocAI solutions, now generally available</article-title>
        <source>Google Cloud Blog</source>
        <year iso-8601-date="2021">2021</year>
      </element-citation>
    </ref>
  </ref-list>
</ref-list>
</back>
</article>
