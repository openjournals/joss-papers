<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7275</article-id>
<article-id pub-id-type="doi">10.21105/joss.07275</article-id>
<title-group>
<article-title>A MATLAB-based Instrument Control (MIC) package for
fluorescence imaging</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6910-5199</contrib-id>
<name>
<surname>Khan</surname>
<given-names>Sajjad A.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0003-0400-6389</contrib-id>
<name>
<surname>Pallikkuth</surname>
<given-names>Sandeep</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8986-2736</contrib-id>
<name>
<surname>Schodt</surname>
<given-names>David J.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9965-1342</contrib-id>
<name>
<surname>Meddens</surname>
<given-names>Marjolein B. M.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2571-0418</contrib-id>
<name>
<surname>Mazloom-Farsibaf</surname>
<given-names>Hanieh</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3520-7605</contrib-id>
<name>
<surname>Wester</surname>
<given-names>Michael J.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1225-0763</contrib-id>
<name>
<surname>Liu</surname>
<given-names>Sheng</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0006-7269-2271</contrib-id>
<name>
<surname>Taylor</surname>
<given-names>Ellyse</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6215-1336</contrib-id>
<name>
<surname>Fazel</surname>
<given-names>Mohamadreza</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9939-1923</contrib-id>
<name>
<surname>Farzam</surname>
<given-names>Farzin</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9328-4318</contrib-id>
<name>
<surname>Lidke</surname>
<given-names>Keith A.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Department of Physics and Astronomy, University of New
Mexico, Albuquerque, New Mexico, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Nanoscience and Microsystems Engineering, University of New
Mexico, Albuquerque, New Mexico, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Department of Mathematics and Statistics, University of New
Mexico, Albuquerque, New Mexico, USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<volume>10</volume>
<issue>105</issue>
<fpage>7275</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>MATLAB</kwd>
<kwd>super resolution microscopy</kwd>
<kwd>instrument control</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>MATLAB Instrument Control (MIC) is a software package designed to
  facilitate data collection for custom-built microscopes. Utilizing
  object-oriented programming, MIC provides a class for each low-level
  instrument. These classes inherit from a common MIC abstract class,
  ensuring a uniform interface across different instruments. Key
  components such as lasers, stages, power meter and cameras are grouped
  under abstract subclasses, which standardize interfaces and simplify
  the development of control classes for new instruments. Both simple
  and complex systems can be built from these lower level tools. Since
  the interoperation is developed by the end user, the modes or sequence
  of operations can be flexibly designed with interactive or automated
  data collection and integrated analysis. MATLAB provides the ability
  to create GUIs and therefore MIC allows for both rapid prototyping and
  for building custom, high-level user interfaces that can be used for
  production instruments.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>Development of new microscopy methods often require integration of
  novel components and/or novel workflows between low-level hardware.
  Creating such software solutions for each new instrument or for
  prototyping can significantly slow down the development cycle. It is
  also often desirable to be able to quickly analyze incoming data
  during development. To address this critical need, we have developed
  the MATLAB Instrument Control (MIC) software package, freely available
  and specifically tailored for the customization and automation of
  complex, multi-component microscopy systems
  (<xref alt="Pallikkuth et al., 2018" rid="ref-Pallikkuth_articleU003A2018" ref-type="bibr">Pallikkuth
  et al., 2018</xref>). MIC leverages MATLAB’s (MathWorks Inc.) robust
  environment for object-oriented programming, allowing users to control
  diverse instrumentation through a unified interface. Each instrument
  class within MIC inherits from a common abstract class, ensuring
  consistency while enabling flexibility to accommodate a variety of
  components like lasers, stages, and cameras. The source code for MIC
  has been archived to GitHub:
  <ext-link ext-link-type="uri" xlink:href="https://github.com/LidkeLab/matlab-instrument-control">https://github.com/LidkeLab/matlab-instrument-control</ext-link>.</p>
  <p>MIC not only supports the development and control of new
  instruments but also integrates seamlessly with MATLAB’s comprehensive
  data and image analysis tools, as well as with Single Molecule Imaging
  Toolbox Extraordinaire (SMITE)
  (<xref alt="Schodt, Wester, et al., 2023" rid="ref-SchodtWester2023" ref-type="bibr">Schodt,
  Wester, et al., 2023</xref>) allowing researchers to process data in
  real-time during experiments. This capability is crucial for iterative
  testing and development in experimental setups. For example, the
  single molecule localization microscopy/single particle tracking
  (SMLM/SPT) analysis software suite SMITE was developed in sync with
  MIC, so acquiring data and performing analyses flow smoothly.
  Additionally, MIC is designed to be user-friendly for those familiar
  with MATLAB, offering customizable control classes, extensive export
  methods, functional tests, and graphical user interfaces for each
  instrument component.</p>
  <p>An example of MIC’s utility is demonstrated through a custom-built
  Sequential microscope available on
  <ext-link ext-link-type="uri" xlink:href="https://github.com/LidkeLab/microscopes-seqsr">Sequential
  SR Microscope</ext-link>
  (<xref alt="Schodt, Farzam, et al., 2023" rid="ref-SchodtU003A23" ref-type="bibr">Schodt,
  Farzam, et al., 2023</xref>) specifically designed for direct
  STochastic Optical Reconstruction Microscopy (dSTORM) and DNA Point
  Accumulation for Imaging in Nanoscale Topography (DNA-PAINT) based
  super-resolution. Another usage of MIC is demonstrated through a class
  designed for Total Internal Reflection Fluorescence (TIRF) based
  super-resolution imaging
  <ext-link ext-link-type="uri" xlink:href="https://github.com/LidkeLab/microscope-tirf">TIRF
  SR Microscope</ext-link>
  (<xref alt="Fazel et al., 2022" rid="ref-Fazel2022" ref-type="bibr">Fazel
  et al., 2022</xref>). Each of these classes includes an intuitive
  graphical user interface that manages multiple excitation lasers and
  camera settings, simplifying complex data collection tasks. Several
  MIC GUIs are presented in Figure-1.
  <inline-graphic mimetype="image" mime-subtype="png" xlink:href="MIC_overview2.png">
    <alt-text>MIC GUIs</alt-text>
  </inline-graphic> <italic>Figure-1: MIC Graphical User Interfaces
  (GUIs); (a) Camera control GUI (b) Light source (TIRF Laser488) GUI
  (c) Linear stage (TCubePiezo X) GUI (d) 3D stage (NanoMax Stage
  Control) GUI (e) Power meter GUI</italic>.</p>
  <p>MIC is designed to operate with Hierarchical Data Format (HDF5)
  files which efficiently store very large datasets. The HDF5 format is
  particularly useful for storing large datasets, as it allows for
  efficient data storage and retrieval. This is especially important for
  single molecule fluorescence imaging, where large amounts of data are
  generated during experiments. The HDF5 format is also supported by
  MATLAB, which makes it easy to import and analyze data stored in this
  format.</p>
  <p>There are a few other software packages that allow users to control
  and synchronize multiple hardware components for microscopy
  applications. Notable examples include Micro-Manager
  (<xref alt="Edelstein et al., 2010" rid="ref-Edelstein2010" ref-type="bibr">Edelstein
  et al., 2010</xref>), based in Java, PYME (the PYthon Microscopy
  Environment)
  (<xref alt="PYME Developer Community, 2020" rid="ref-PYME2020" ref-type="bibr">PYME
  Developer Community, 2020</xref>), based in the Python environment,
  and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/danionella/lsmaq">LSMAQ</ext-link>
  which is a lightweight and flexible laser scanning microscope
  acquisition software written in MATLAB. It supports National
  Instruments hardware for galvo-based scanning. Potential users of MIC
  are encouraged to compare and contrast MIC with these packages to
  assess what might be best for their particular development
  environment. Micro-Manager is a customizable platform for controlling
  microscopy systems, supporting a wide range of hardware devices, and
  is primarily built on Java. Micro-Manager comes with its own GUI.
  Micro-Manager can save files in three formats: separate image files,
  Image file stack (OME-Tiffs) and NDTiff. Micro-Manager may be a good
  choice for those who primarily use ImageJ/Fiji for image analysis.
  PYME is designed to facilitate image acquisition and data analysis in
  microscopy, with a focus on super-resolution techniques like
  PhotoActivated Localization Microscopy (PALM), STORM, and PAINT. It
  runs on multiple platforms, including Windows, Linux, and OSX. PYME
  comprises several key components: PYMEAcquire for microscope and
  camera control, PYMEVisualize for visualizing localization data sets,
  and PYMEImage for viewing and processing raster images. PYME is
  compatible with a variety of data formats, including its proprietary
  .pzf format as well as standard formats such as .tif. Additionally,
  PYME supports metadata in multiple formats, including .json, .md, and
  .xml.</p>
</sec>
<sec id="author-contributions">
  <title>Author Contributions</title>
  <p>KAL conceived and supervised the development of MIC. SAK wrote the
  manuscript. SAK &amp; MJW added GitHub documentation and converted MIC
  to a hierarchical organization. SAK added the example classes with
  their GUIs, and added functional tests. KAL added AndorCamera and
  KCubePiezo. SP added AndorCameraZyla and various laser classes. SAK
  tested the laser classes. SL added DCAM4Camera to control Hamamatsu
  cameras using the DCAM4 API. MBMM added DynamixelServo, GalvoAnalog,
  and HamamatsuLCOS classes. DJS added 3D registration, BiochemValve,
  CavroSyringePump, H5, and MCLMicroDrive. MF added Attenuator and
  StepperMotor. HMF added stage3D.abstract, CoherentLaser561,
  GalvoDigital, IRSyringPump, and MCLNanoDrive. ET added DMP40 and
  updated Triggerscope. FF added FlipMountTTL, ShutterTTL. SP &amp; SAK
  added NanoMax. All authors reviewed the manuscript.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work was supported by NIH grants 1R01GM140284, K12GM088021
  (ASERT-IRACDA program), NCI P30CA118100, NCI R01CA248166, NIGMS
  R01GM109888, NIGMS R21GM104691, NIGMS R21GM132716, NIGMS R35GM126934,
  NCRR RR024438, NIGMS 1R01GM140284, NIBIB 1R21EB019589, NIGMS
  5P50GM085273 (New Mexico Spatiotemporal Modeling Center); NSF grants
  0954836 and 2039517; DOE grant DE-SC0019267; support from the
  University of New Mexico Office of the Vice President for Research
  Program for Enhancing Research Capacity; and supported by grants from
  NVIDIA while utilizing an NVIDIA A6000 GPU.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-Pallikkuth_articleU003A2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pallikkuth</surname><given-names>Sandeep</given-names></name>
        <name><surname>Meddens</surname><given-names>Marjolein</given-names></name>
        <name><surname>Fazel</surname><given-names>Mohamad</given-names></name>
        <name><surname>Farsibaf</surname><given-names>Hanieh</given-names></name>
        <name><surname>Farzam</surname><given-names>Farzin</given-names></name>
        <name><surname>Wester</surname><given-names>Michael</given-names></name>
        <name><surname>Lidke</surname><given-names>Keith</given-names></name>
      </person-group>
      <article-title>A MATLAB-based Instrument Control Package for Fluorescence Imaging</article-title>
      <source>Biophysical Journal</source>
      <year iso-8601-date="2018">2018</year>
      <volume>114</volume>
      <issue>3, Supplement 1</issue>
      <pub-id pub-id-type="doi">10.1016/j.bpj.2017.11.2912</pub-id>
      <fpage>532a</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-SchodtWester2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schodt</surname><given-names>David J.</given-names></name>
        <name><surname>Wester</surname><given-names>Michael J.</given-names></name>
        <name><surname>Fazel</surname><given-names>Mohamadreza</given-names></name>
        <name><surname>Khan</surname><given-names>Sajjad</given-names></name>
        <name><surname>Mazloom-Farsibaf</surname><given-names>Hanieh</given-names></name>
        <name><surname>Pallikkuth</surname><given-names>Sandeep</given-names></name>
        <name><surname>Meddens</surname><given-names>Marjolein B. M.</given-names></name>
        <name><surname>Farzam</surname><given-names>Farzin</given-names></name>
        <name><surname>Burns</surname><given-names>Eric A.</given-names></name>
        <name><surname>Kanagy</surname><given-names>William K.</given-names></name>
        <name><surname>Rinaldi</surname><given-names>Derek A.</given-names></name>
        <name><surname>Jhamba</surname><given-names>Elton</given-names></name>
        <name><surname>Liu</surname><given-names>Sheng</given-names></name>
        <name><surname>Relich</surname><given-names>Peter K.</given-names></name>
        <name><surname>Olah</surname><given-names>Mark J.</given-names></name>
        <name><surname>Steinberg</surname><given-names>Stanly L.</given-names></name>
        <name><surname>Lidke</surname><given-names>Keith A.</given-names></name>
      </person-group>
      <article-title>SMITE: Single Molecule Imaging Toolbox Extraordinaire (MATLAB)</article-title>
      <source>Journal of Open Source Software</source>
      <year iso-8601-date="2023">2023</year>
      <volume>8</volume>
      <issue>90</issue>
      <uri>https://doi.org/10.21105/joss.05563</uri>
      <pub-id pub-id-type="doi">10.21105/joss.05563</pub-id>
      <fpage>5563</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-SchodtU003A23">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Schodt</surname><given-names>David J.</given-names></name>
        <name><surname>Farzam</surname><given-names>Farzin</given-names></name>
        <name><surname>Liu</surname><given-names>Sheng</given-names></name>
        <name><surname>Lidke</surname><given-names>Keith A.</given-names></name>
      </person-group>
      <article-title>Automated multi-target super-resolution microscopy with trust regions</article-title>
      <source>Biomed. Opt. Express</source>
      <publisher-name>Optica Publishing Group</publisher-name>
      <year iso-8601-date="2023-01">2023</year><month>01</month>
      <volume>14</volume>
      <issue>1</issue>
      <uri>https://opg.optica.org/boe/abstract.cfm?URI=boe-14-1-429</uri>
      <pub-id pub-id-type="doi">10.1364/BOE.477501</pub-id>
      <fpage>429</fpage>
      <lpage>440</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Fazel2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fazel</surname><given-names>Mohamadreza</given-names></name>
        <name><surname>Wester</surname><given-names>Michael J.</given-names></name>
        <name><surname>Schodt</surname><given-names>David J.</given-names></name>
        <name><surname>Cruz</surname><given-names>Sebastian Restrepo</given-names></name>
        <name><surname>Strauss</surname><given-names>Sebastian</given-names></name>
        <name><surname>Schueder</surname><given-names>Florian</given-names></name>
        <name><surname>Schlichthaerle</surname><given-names>Thomas</given-names></name>
        <name><surname>Gillette</surname><given-names>Jennifer M.</given-names></name>
        <name><surname>Lidke</surname><given-names>Diane S.</given-names></name>
        <name><surname>Rieger</surname><given-names>Bernd</given-names></name>
        <name><surname>Jungmann</surname><given-names>Ralf</given-names></name>
        <name><surname>Lidke</surname><given-names>Keith A.</given-names></name>
      </person-group>
      <article-title>High-precision estimation of emitter positions using bayesian grouping of localizations</article-title>
      <source>Nature Communications</source>
      <year iso-8601-date="2022">2022</year>
      <volume>13</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1038/s41467-022-34894-2</uri>
      <pub-id pub-id-type="doi">10.1038/s41467-022-34894-2</pub-id>
      <fpage>7152</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Edelstein2010">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Edelstein</surname><given-names>Arthur</given-names></name>
        <name><surname>Amodaj</surname><given-names>Nenad</given-names></name>
        <name><surname>Hoover</surname><given-names>Karl</given-names></name>
        <name><surname>Vale</surname><given-names>Ron</given-names></name>
        <name><surname>Stuurman</surname><given-names>Nico</given-names></name>
      </person-group>
      <article-title>Computer control of microscopes using µManager</article-title>
      <source>Current Protocols in Molecular Biology</source>
      <year iso-8601-date="2010">2010</year>
      <volume>92</volume>
      <issue>1</issue>
      <uri>https://currentprotocols.onlinelibrary.wiley.com/doi/abs/10.1002/0471142727.mb1420s92</uri>
      <pub-id pub-id-type="doi">10.1002/0471142727.mb1420s92</pub-id>
      <fpage>14.20.1</fpage>
      <lpage>14.20.17</lpage>
    </element-citation>
  </ref>
  <ref id="ref-PYME2020">
    <element-citation>
      <person-group person-group-type="author">
        <string-name>PYME Developer Community</string-name>
      </person-group>
      <article-title>The PYthon Microscopy Environment</article-title>
      <publisher-name>https://www.python-microscopy.org/</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <uri>https://www.python-microscopy.org/</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.4289803</pub-id>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
