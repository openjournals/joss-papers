<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6536</article-id>
<article-id pub-id-type="doi">10.21105/joss.06536</article-id>
<title-group>
<article-title>PourPy - A python package to generate potential-pH
diagrams</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Korber</surname>
<given-names>Anja</given-names>
</name>
<email>akorber@student.ethz.ch</email>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0003-9420-058X</contrib-id>
<name>
<surname>Furcas</surname>
<given-names>Fabio E.</given-names>
</name>
<email>ffurcas@ethz.ch</email>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-7244-7416</contrib-id>
<name>
<surname>Pundir</surname>
<given-names>Mohit</given-names>
</name>
<email>mpundir@ethz.ch</email>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3782-9368</contrib-id>
<name>
<surname>Kammer</surname>
<given-names>David S.</given-names>
</name>
<email>dkammer@ethz.ch</email>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2603-4757</contrib-id>
<name>
<surname>Angst</surname>
<given-names>Ueli M.</given-names>
</name>
<email>uangst@ethz.ch</email>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Institute for Building Materials, ETH Zrich,
Laura-Hezner-Weg 7, Zrich, 8093, Switzerland</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email>mpundir@ethz.ch</email></corresp>
</author-notes>
<volume>9</volume>
<issue>97</issue>
<fpage>6536</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Pourbaix diagrams</kwd>
<kwd>thermodynamics</kwd>
<kwd>potential</kwd>
<kwd>pH</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><italic>PourPy</italic> is an open-source Python package for
  generating thermodynamic stability diagrams of solid phases and
  complexes in aqueous electrolytes. These so-called Pourbaix diagrams
  provide valuable information about the reactivity of chemical elements
  and compounds as a function of the electrochemical potential and the
  pH. In the context of corrosion science, environmental and process
  engineering, Pourbaix diagrams are useful to predict the reactivity of
  aqueous complexes, the passivation behaviour of metals, and the
  electrochemical stability of the aqueous electrolyte.
  <italic>PourPy</italic> is a tool enabling users to inspect the
  reactivity of aqueous systems under full control of all chemical
  species considered. Users can define custom reactive systems
  containing multiple solid, aqueous and gaseous species thereof and
  build all (electro)chemical reactions to be considered. The package
  provides additional functionality to perform basic manipulations on
  the thermodynamic parameters associated with each chemical component,
  change the system’s reference electrode as well as calculate the
  number of phases stable across a given potential-pH space or at
  discrete values. Future releases are planned to retrieve thermodynamic
  parameters from established databases including SUPCRT92
  (<xref alt="Johnson et al., 1992" rid="ref-johnson1992supcrt92" ref-type="bibr">Johnson
  et al., 1992</xref>) and PHREEQC
  (<xref alt="Parkhurst et al., 1999" rid="ref-parkhurst1999user" ref-type="bibr">Parkhurst
  et al., 1999</xref>,
  <xref alt="2013" rid="ref-parkhurst2013description" ref-type="bibr">2013</xref>).</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>In 1963, Marcel Pourbaix submitted his PhD thesis titled
  <italic>Atlas d’Équilibres Électrochimiques</italic>, comprising a
  collection of thermodynamic equilibrium relationships that describe
  the electrochemical stability of chemical elements
  (<xref alt="Pedeferri &amp; Ormellese, 2018" rid="ref-pedeferri_corrosion" ref-type="bibr">Pedeferri
  &amp; Ormellese, 2018</xref>;
  <xref alt="Pourbaix &amp; Zoubov, 1963" rid="ref-pourbaix_atlas_corrosion" ref-type="bibr">Pourbaix
  &amp; Zoubov, 1963</xref>). Over the course of the last century,
  graphical representations of these equilibrium relationships, the
  so-called Pourbaix diagrams, also known as potential-pH diagrams, have
  emerged as an invaluable tool to predict the corrosion bevaviour of
  materials. Pourbaix diagrams are widely used in corrosion science to
  assess the stability of a metal and its possible different metal
  (hydr)oxides
  (<xref alt="McCafferty, 2010" rid="ref-corrosion_science_intro" ref-type="bibr">McCafferty,
  2010</xref>). In this context, Pourbaix diagrams provide maps of three
  different regions of interest, namely <italic>corrosion</italic>,
  <italic>passivity</italic>, and <italic>immunity</italic>. The
  corrosion region is the potential-pH domain in which dissolution of
  the metal is possible and where it is thermodynamically stable in the
  form of dissolved aqueous species. The immunity domain designates the
  conditions in which the metal is stable in its unreacted
  Me<inline-formula><alternatives>
  <tex-math><![CDATA[^0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi></mml:mi><mml:mn>0</mml:mn></mml:msup></mml:math></alternatives></inline-formula>
  form. Finally, a domain of tremendous technological relevance for many
  metals, especially iron-based alloys, is the passivity domain, in
  which oxides are stable and can <inline-formula><alternatives>
  <tex-math><![CDATA[–]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>–</mml:mi></mml:math></alternatives></inline-formula>
  under some conditions <inline-formula><alternatives>
  <tex-math><![CDATA[–]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>–</mml:mi></mml:math></alternatives></inline-formula>
  offer protective properties to the underlying metal. In addition, in
  many cases, scales incorporating both metal (hydr)oxide phases and
  substances stemming from the exposure environment (carbonate ions,
  sulphur species, phosphate species, etc.) can form on the surface as
  well and affect the corrosion process. Such cases can also be
  investigated by means of Pourbaix diagrams, provided that the relevant
  species are incorporated in the thermodynamic calculations carried out
  to construct the Pourbaix diagram. While Pourbaix diagrams for simple
  cases such as metal-water systems can often be found in the
  literature, diagrams for more complex situations or cases deviating
  from standard conditions (e.g. in terms of temperature, electrolyte
  composition, and/or ionic activity), scholars may face challenges in
  obtaining the required Pourbaix diagrams. It should be mentioned here
  that Pourbaix diagrams also have limitations. For instance, the
  thermodynamically stable phase may not always be the relevant in
  practical situations, as intermediates may dominate the behavior over
  considerable time scales. Though not energetically favorable, these
  intermediate species may also be plotted in the Pourbaix diagram by
  excluding other, thermodynamically more stable species and compounds.
  Moreover, the lines depicted in Pourbaix diagrams represent the
  predominance boundaries, which means that different species / phases
  may be stable and present on both sides of these lines. Such
  information, although not visible from classical Pourbaix diagrams,
  may impact the behavior of the system. Another (well-known) limitation
  of Pourbaix diagrams is that they do not provide information on the
  kinetics of reactions.</p>
  <p>Pourbaix diagrams are two-dimensional and Cartesian, plotting the
  electrochemical redox potential of e.g. a metal or an alloy versus the
  solution pH in contact with the material. Any electrochemical and/or
  pH-dependent reaction can be drawn on such a diagram in the form of a
  straight line, provided the standard molar Gibbs free energy of
  formation <inline-formula><alternatives>
  <tex-math><![CDATA[\Delta G_f^\circ]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mi>f</mml:mi><mml:mo>∘</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>
  of all reactants are known. Despite their simplicity and widespread
  use in engineering and science, there are few software packages that
  generate correct Pourbaix diagrams, without hiding some of their
  essential features behind a staggering paywall. Other packages
  including <italic>pymatgen</italic>
  (<xref alt="Persson et al., 2012" rid="ref-pymatgen1" ref-type="bibr">Persson
  et al., 2012</xref>;
  <xref alt="Singh et al., 2017" rid="ref-singh2017electrochemical" ref-type="bibr">Singh
  et al., 2017</xref>) part of the <italic>The Materials Project
  API</italic>
  (<xref alt="Jain et al., 2013" rid="ref-jain2013commentary" ref-type="bibr">Jain
  et al., 2013</xref>) and the <italic>Atomic Simulation Environment
  (ASE)</italic>
  (<xref alt="Larsen et al., 2017" rid="ref-ase" ref-type="bibr">Larsen
  et al., 2017</xref>) are available free of charge, but the diagrams
  generated are not customisable and involve DFT modelling methods and
  energy minimisation routines far more complicated than the set of
  thermodynamic equilibrium relationships originally published. As the
  underlying minimisation routines are further performed at each
  discrete pH-potential coordinate considered, the generation of
  Pourbaix diagrams via the pymatgen or ASE package is also
  computationally expensive. <italic>PourPy</italic> is developed to
  address this accessability gap. The package provides a set of seven
  classes that handle user-defined chemical reactants and reactions to
  be included in a completely customisable Pourbaix diagram. Classes
  include functionality to change the reference electrode scale of the
  system, control the activity of all aqueous species of a particular
  chemical element and interact with the diagram to extract the stable
  phase(s) predominant at a given potential and pH coordinate. Lastly,
  the provision of a web application eliminates the need to set up a
  local installation environment, making the package more accessible to
  scholars and engineering professionals.</p>
</sec>
<sec id="brief-software-description">
  <title>Brief software description</title>
  <p>The <italic>PourPy</italic> package distinguishes between 3 main
  line types drawn on the Pourbaix diagram. The first type represents
  reactions that are vertical, pH-dependent and involve the exchange of
  protons (<inline-formula><alternatives>
  <tex-math><![CDATA[\text{H}^+]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:math></alternatives></inline-formula>).
  The assigned pH can be calculated based on the equilibrium constant of
  the chemical reaction. The second type represent potential-dependent
  reactions, involving the generation or consumption of electrons
  (<inline-formula><alternatives>
  <tex-math><![CDATA[e^-]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msup><mml:mi>e</mml:mi><mml:mo>−</mml:mo></mml:msup></mml:math></alternatives></inline-formula>).
  They appear as horizontal lines on the diagram. The third archetype of
  Pourbaix lines is a combination of the first two, i.e. involving the
  exchange of protons and electrons, resulting in a sloped line on the
  potential-pH diagram. Consider the formation and consumption of
  reactants, products <inline-formula><alternatives>
  <tex-math><![CDATA[A_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  and protons H<sup>+</sup> according to the general chemical reaction
  <disp-formula><alternatives>
  <tex-math><![CDATA[\sum_i \nu_{a,i} A_i + \nu_{\text{H}^+}\text{H}^+ = 0,]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:msub><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\nu_{a,i}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\nu_{\text{H}^+}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>ν</mml:mi><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula>
  are the stoichiometric coefficients of reactants, products and protons
  involved. The reaction equilibrium constant
  <inline-formula><alternatives>
  <tex-math><![CDATA[\beta]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>β</mml:mi></mml:math></alternatives></inline-formula>
  can be computed from the Gibbs free energy change of the reaction
  <inline-formula><alternatives>
  <tex-math><![CDATA[\Delta G_r^\circ]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mo>∘</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>
  according to <disp-formula><alternatives>
  <tex-math><![CDATA[\beta = \text{exp}(-\Delta G_r^\circ/(R\cdot T)),]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">exp</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mo>−</mml:mo><mml:mi>Δ</mml:mi><mml:msubsup><mml:mi>G</mml:mi><mml:mi>r</mml:mi><mml:mo>∘</mml:mo></mml:msubsup><mml:mi>/</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>R</mml:mi><mml:mo>⋅</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[R = 8.31446262]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mn>8.31446262</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  <inline-formula><alternatives>
  <tex-math><![CDATA[\text{J} \ \text{mol}^{-1} \ \text{K}^{-1}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">J</mml:mtext><mml:mspace width="0.222em"></mml:mspace><mml:msup><mml:mtext mathvariant="normal">mol</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.222em"></mml:mspace><mml:msup><mml:mtext mathvariant="normal">K</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  is the ideal gas constant and <inline-formula><alternatives>
  <tex-math><![CDATA[T]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>
  is the temperature in degree K. It also relates to the activity of all
  reactants <disp-formula><alternatives>
  <tex-math><![CDATA[K = \prod_i \{A_i\}^{\nu_{a,i}}\times\{\text{H}^+\}^{\nu_{\text{H}^+}}.]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mo>×</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup><mml:msup><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:msub></mml:msup><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>
  Provided the Gibbs free energy of the reaction is known, the pH above
  which the formation of products is favoured can be computed as
  <disp-formula><alternatives>
  <tex-math><![CDATA[\text{pH} = -\text{log}_{10}\{\text{H}^+\} = \frac{1}{\nu_{\text{H}^+}}\bigg[ \text{log}_{10}\prod_i \{A_i\}^{\nu_{a,i}} - \text{log}_{10}K \bigg].]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">pH</mml:mtext><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mtext mathvariant="normal">log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>ν</mml:mi><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:msub></mml:mfrac><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="prefix">[</mml:mo><mml:msub><mml:mtext mathvariant="normal">log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mtext mathvariant="normal">log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:mi>K</mml:mi><mml:mo minsize="2.4" maxsize="2.4" stretchy="false" form="postfix">]</mml:mo><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>
  Reactions that additionally consume or generate electrons (horizontal
  or inclined lines), i.e. <disp-formula><alternatives>
  <tex-math><![CDATA[\sum_i \nu_{a,i} A_i + \nu_{\text{H}^+}\text{H}^+ + ne^-= 0,]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:msub><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mo>−</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  are plotted by computing the potential at which the formation of
  products becomes favourable via the Nernst Equation
  <named-content id="eqU003Anernst" content-type="equation"><disp-formula><alternatives>
  <tex-math><![CDATA[
      E_{\text{rev}} = E_{\text{rev}}^\circ + 2.303\times\frac{RT}{nF}\times\text{log}_{10}\prod_i \{A_i\}^{\nu_{a,i}} + 2.303\times\nu_{\text{H}^+}\times\frac{RT}{nF}\times\text{pH},]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mtext mathvariant="normal">rev</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>E</mml:mi><mml:mtext mathvariant="normal">rev</mml:mtext><mml:mo>∘</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:mn>2.303</mml:mn><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:msub><mml:mtext mathvariant="normal">log</mml:mtext><mml:mn>10</mml:mn></mml:msub><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:msup><mml:mo>+</mml:mo><mml:mn>2.303</mml:mn><mml:mo>×</mml:mo><mml:msub><mml:mi>ν</mml:mi><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:msub><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi>R</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:mfrac><mml:mo>×</mml:mo><mml:mtext mathvariant="normal">pH</mml:mtext><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></named-content>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>
  is the number of electrons transferred and
  <inline-formula><alternatives>
  <tex-math><![CDATA[F = 96485.3321]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mn>96485.3321</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  <inline-formula><alternatives>
  <tex-math><![CDATA[\text{A} \ \text{mol}^{-1} \ \text{s}^{-1}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">A</mml:mtext><mml:mspace width="0.222em"></mml:mspace><mml:msup><mml:mtext mathvariant="normal">mol</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.222em"></mml:mspace><mml:msup><mml:mtext mathvariant="normal">s</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
  refers to the Faraday constant. For a reaction including the exchange
  of protons <inline-formula><alternatives>
  <tex-math><![CDATA[\nu_{\text{H}^+}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>ν</mml:mi><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula>,
  Equation 6 corresponds to the third (inclined) line type and for
  <inline-formula><alternatives>
  <tex-math><![CDATA[\nu_{\text{H}^+} = 0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ν</mml:mi><mml:msup><mml:mtext mathvariant="normal">H</mml:mtext><mml:mo>+</mml:mo></mml:msup></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  the second (horizontal) line type is generated. The intersections of
  multiple of these line types define regions in the potential-pH space
  in which various chemical species <inline-formula><alternatives>
  <tex-math><![CDATA[A_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  are stable. For all <inline-formula><alternatives>
  <tex-math><![CDATA[A_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  these thermodynamic stability regions are determined based on the sign
  of the stoichiometric coefficient <inline-formula><alternatives>
  <tex-math><![CDATA[\nu_{a,i}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>ν</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
  relative to the stoichiometric coefficients of the protons and
  electrons involved in their formation.</p>
</sec>
<sec id="availability-usage-and-documentation">
  <title>Availability, usage and documentation</title>
  <p><italic>PourPy</italic> is written in Python and hosted on
  <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/cmbm-ethz/pourbaix-diagrams">GitLab</ext-link>
  and can be accessed via a Mercury-powered
  <ext-link ext-link-type="uri" xlink:href="https://pourpy-webapp.runmercury.com/app/pourpy-mercury">web
  application</ext-link>. It has been uploaded to the Python Packaging
  Index under the name ‘PourPy’ and can be installed using the
  <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/PourPy/">pip
  package manager</ext-link>. Users are guided through the functionality
  of the package via a set of tutorials available
  <ext-link ext-link-type="uri" xlink:href="https://pourbaix-diagrams.readthedocs.io/en/latest/">here</ext-link>.
  We encourage collaborative efforts to improve the functionality of
  <italic>PourPy</italic> via the Git repository and appreciate any
  suggestions for future features and showcase tutorials.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>The authors thank the European Research Council (ERC) for the
  financial support provided for Fabio Enrico Furcas under the European
  Union Horizon 2020 research and innovation program (grant agreement
  no. 848794).</p>
</sec>
<sec id="contributions">
  <title>Contributions</title>
  <p>F.E.F, D.K. and U.M.A conceived the study, all authors contributed
  to the study design. A.K., M.P. and F.E.F. conducted the programming.
  F.E.F. wrote the main draft of the manuscript, all authors co-wrote
  and approved the final manuscript.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-pourbaix_atlas_corrosion">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Pourbaix</surname><given-names>M.</given-names></name>
        <name><surname>Zoubov</surname><given-names>N. de</given-names></name>
      </person-group>
      <source>Atlas d’Équilibres Électrochimiques: Eau oxygénée</source>
      <publisher-name>Paris: Gauthier-Villars</publisher-name>
      <year iso-8601-date="1963">1963</year>
    </element-citation>
  </ref>
  <ref id="ref-jain2013commentary">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Jain</surname><given-names>Anubhav</given-names></name>
        <name><surname>Ong</surname><given-names>Shyue Ping</given-names></name>
        <name><surname>Hautier</surname><given-names>Geoffroy</given-names></name>
        <name><surname>Chen</surname><given-names>Wei</given-names></name>
        <name><surname>Richards</surname><given-names>William Davidson</given-names></name>
        <name><surname>Dacek</surname><given-names>Stephen</given-names></name>
        <name><surname>Cholia</surname><given-names>Shreyas</given-names></name>
        <name><surname>Gunter</surname><given-names>Dan</given-names></name>
        <name><surname>Skinner</surname><given-names>David</given-names></name>
        <name><surname>Ceder</surname><given-names>Gerbrand</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Commentary: The Materials Project: A materials genome approach to accelerating materials innovation</article-title>
      <source>APL materials</source>
      <publisher-name>AIP Publishing</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>1</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1063/1.4812323</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-johnson1992supcrt92">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>James W</given-names></name>
        <name><surname>Oelkers</surname><given-names>Eric H</given-names></name>
        <name><surname>Helgeson</surname><given-names>Harold C</given-names></name>
      </person-group>
      <article-title>SUPCRT92: A software package for calculating the standard molal thermodynamic properties of minerals, gases, aqueous species, and reactions from 1 to 5000 bar and 0 to 1000 C</article-title>
      <source>Computers &amp; Geosciences</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="1992">1992</year>
      <volume>18</volume>
      <issue>7</issue>
      <pub-id pub-id-type="doi">10.1016/0098-3004(92)90029-Q</pub-id>
      <fpage>899</fpage>
      <lpage>947</lpage>
    </element-citation>
  </ref>
  <ref id="ref-parkhurst1999user">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Parkhurst</surname><given-names>David L</given-names></name>
        <name><surname>Appelo</surname><given-names>CAJ</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>User’s guide to PHREEQC (Version 2): A computer program for speciation, batch-reaction, one-dimensional transport, and inverse geochemical calculations</article-title>
      <source>Water-resources Investigations Report</source>
      <year iso-8601-date="1999">1999</year>
      <volume>99</volume>
      <issue>4259</issue>
      <pub-id pub-id-type="doi">10.3133/wri994259</pub-id>
      <fpage>312</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-parkhurst2013description">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Parkhurst</surname><given-names>David L</given-names></name>
        <name><surname>Appelo</surname><given-names>CAJ</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Description of input and examples for PHREEQC version 3 — a computer program for speciation, batch-reaction, one-dimensional transport, and inverse geochemical calculations</article-title>
      <source>US Geological Survey Techniques and Methods</source>
      <publisher-name>US Geological Survey Denver, CO, USA</publisher-name>
      <year iso-8601-date="2013">2013</year>
      <volume>6</volume>
      <issue>A43</issue>
      <pub-id pub-id-type="doi">10.3133/tm6a43</pub-id>
      <fpage>497</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-corrosion_science_intro">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>McCafferty</surname><given-names>Edward</given-names></name>
      </person-group>
      <source>Introduction to Corrosion Science</source>
      <publisher-name>Springer Science &amp; Business Media</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <isbn>1441904549</isbn>
      <pub-id pub-id-type="doi">10.1007/978-1-4419-0455-3</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-pedeferri_corrosion">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Pedeferri</surname><given-names>Pietro</given-names></name>
        <name><surname>Ormellese</surname><given-names>Marco</given-names></name>
      </person-group>
      <source>Corrosion Science and Engineering</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2018">2018</year>
      <volume>720</volume>
      <pub-id pub-id-type="doi">10.1007/978-3-319-97625-9</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-pymatgen1">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Persson</surname><given-names>Kristin A.</given-names></name>
        <name><surname>Waldwick</surname><given-names>Bryn</given-names></name>
        <name><surname>Lazic</surname><given-names>Predrag</given-names></name>
        <name><surname>Ceder</surname><given-names>Gerbrand</given-names></name>
      </person-group>
      <article-title>Prediction of solid-aqueous equilibria: Scheme to combine first-principles calculations of solids with experimental aqueous states</article-title>
      <source>Phys. Rev. B</source>
      <publisher-name>American Physical Society</publisher-name>
      <year iso-8601-date="2012">2012</year>
      <volume>85</volume>
      <pub-id pub-id-type="doi">10.1103/physrevb.85.235438</pub-id>
      <fpage>235438</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-singh2017electrochemical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Singh</surname><given-names>Arunima K</given-names></name>
        <name><surname>Zhou</surname><given-names>Lan</given-names></name>
        <name><surname>Shinde</surname><given-names>Aniketa</given-names></name>
        <name><surname>Suram</surname><given-names>Santosh K</given-names></name>
        <name><surname>Montoya</surname><given-names>Joseph H</given-names></name>
        <name><surname>Winston</surname><given-names>Donald</given-names></name>
        <name><surname>Gregoire</surname><given-names>John M</given-names></name>
        <name><surname>Persson</surname><given-names>Kristin A</given-names></name>
      </person-group>
      <article-title>Electrochemical stability of metastable materials</article-title>
      <source>Chemistry of Materials</source>
      <publisher-name>ACS Publications</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>29</volume>
      <issue>23</issue>
      <pub-id pub-id-type="doi">10.1021/acs.chemmater.7b03980</pub-id>
      <fpage>10159</fpage>
      <lpage>10167</lpage>
    </element-citation>
  </ref>
  <ref id="ref-ase">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Larsen</surname><given-names>Ask Hjorth</given-names></name>
        <name><surname>Mortensen</surname><given-names>Jens Jørgen</given-names></name>
        <name><surname>Blomqvist</surname><given-names>Jakob</given-names></name>
        <name><surname>Castelli</surname><given-names>Ivano E</given-names></name>
        <name><surname>Christensen</surname><given-names>Rune</given-names></name>
        <name><surname>Dułak</surname><given-names>Marcin</given-names></name>
        <name><surname>Friis</surname><given-names>Jesper</given-names></name>
        <name><surname>Groves</surname><given-names>Michael N</given-names></name>
        <name><surname>Hammer</surname><given-names>Bjørk</given-names></name>
        <name><surname>Hargus</surname><given-names>Cory</given-names></name>
        <name><surname>Hermes</surname><given-names>Eric D</given-names></name>
        <name><surname>Jennings</surname><given-names>Paul C</given-names></name>
        <name><surname>Jensen</surname><given-names>Peter Bjerre</given-names></name>
        <name><surname>Kermode</surname><given-names>James</given-names></name>
        <name><surname>Kitchin</surname><given-names>John R</given-names></name>
        <name><surname>Kolsbjerg</surname><given-names>Esben Leonhard</given-names></name>
        <name><surname>Kubal</surname><given-names>Joseph</given-names></name>
        <name><surname>Kaasbjerg</surname><given-names>Kristen</given-names></name>
        <name><surname>Lysgaard</surname><given-names>Steen</given-names></name>
        <name><surname>Maronsson</surname><given-names>Jón Bergmann</given-names></name>
        <name><surname>Maxson</surname><given-names>Tristan</given-names></name>
        <name><surname>Olsen</surname><given-names>Thomas</given-names></name>
        <name><surname>Pastewka</surname><given-names>Lars</given-names></name>
        <name><surname>Peterson</surname><given-names>Andrew</given-names></name>
        <name><surname>Rostgaard</surname><given-names>Carsten</given-names></name>
        <name><surname>Schiøtz</surname><given-names>Jakob</given-names></name>
        <name><surname>Schütt</surname><given-names>Ole</given-names></name>
        <name><surname>Strange</surname><given-names>Mikkel</given-names></name>
        <name><surname>Thygesen</surname><given-names>Kristian S</given-names></name>
        <name><surname>Vegge</surname><given-names>Tejs</given-names></name>
        <name><surname>Vilhelmsen</surname><given-names>Lasse</given-names></name>
        <name><surname>Walter</surname><given-names>Michael</given-names></name>
        <name><surname>Zeng</surname><given-names>Zhenhua</given-names></name>
        <name><surname>Jacobsen</surname><given-names>Karsten W</given-names></name>
      </person-group>
      <article-title>The atomic simulation environment — a Python library for working with atoms</article-title>
      <source>Journal of Physics: Condensed Matter</source>
      <publisher-name>IOP Publishing</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>29</volume>
      <issue>27</issue>
      <pub-id pub-id-type="doi">10.1021/acs.chemmater.7b03980.s001</pub-id>
      <fpage>273002</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
