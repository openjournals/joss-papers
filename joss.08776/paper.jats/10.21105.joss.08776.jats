<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8776</article-id>
<article-id pub-id-type="doi">10.21105/joss.08776</article-id>
<title-group>
<article-title>C4DYNAMICS: The Python framework for state-space modeling
and algorithm development</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7932-0562</contrib-id>
<name>
<surname>Meri</surname>
<given-names>Ziv</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Independent Researcher, Israel</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-12-17">
<day>17</day>
<month>12</month>
<year>2024</year>
</pub-date>
<volume>10</volume>
<issue>116</issue>
<fpage>8776</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>dynamics</kwd>
<kwd>state space</kwd>
<kwd>sensors</kwd>
<kwd>filters</kwd>
<kwd>detectors</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Dynamic systems play a central role across robotics, aerospace, and
  guidance, navigation, and control (GNC). The state-space model,
  introduced by Kalman in the mid-20th century, is the most common way
  to describe dynamic systems over time using internal variables
  (<xref alt="Kalman, 1959" rid="ref-Kalman1104873" ref-type="bibr">Kalman,
  1959</xref>). While Python provides robust numerical tools, it lacks a
  dedicated framework specifically designed for state-space modeling.
  <bold>C4DYNAMICS</bold> bridges this gap by introducing a Python-based
  platform designed for state-space modeling and analysis. The
  framework’s modular architecture, with “state objects” at its core,
  simplifies the development of algorithms for sensors, filters, and
  detectors. This allows researchers, engineers, and students to
  effectively design, simulate, and analyze dynamic systems. By
  integrating state objects with a scientific library,
  <italic>c4dynamics</italic> provides a scalable and efficient
  foundation for modeling dynamic systems.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Modeling and simulation of dynamical systems are essential across
  robotics, aerospace, and control engineering. In these fields,
  engineers design state-space level algorithms, algorithms that operate
  directly on the mathematical representation of system states (e.g.,
  position, velocity, or attitude). While Python provides powerful
  numerical libraries (e.g., NumPy
  (<xref alt="Harris, 2020" rid="ref-numpy2020" ref-type="bibr">Harris,
  2020</xref>), SciPy
  (<xref alt="Virtanen et al., 2020" rid="ref-SciPy2020" ref-type="bibr">Virtanen
  et al., 2020</xref>)) and several domain-specific frameworks (for
  example, robot simulators and control toolboxes), none directly
  support low-level algorithm development, where the state vector is
  explicitly modeled and manipulated.</p>
  <p><italic>c4dynamics</italic> is designed for engineers who prefer
  code-based modeling and want to explicitly define the variables
  encapsulated in the system’s state vector. It streamlines mathematical
  operations (e.g. scalar multiplication or dot products), and data
  operations (state storage, history retrieval, plotting).</p>
  <p>For example, in a guidance or control system, engineers can
  directly model the position and velocity of a vehicle, apply Kalman
  filters to estimate its motion, and visualize results. All within a
  unified, Python-native workflow.</p>
</sec>
<sec id="comparison-with-existing-software">
  <title>Comparison with Existing Software</title>
  <p>Existing tools generally fall into two categories:</p>
  <list list-type="order">
    <list-item>
      <label>1)</label>
      <p>Block-diagram frameworks (e.g., SimuPy
      (<xref alt="Margolis, 2017" rid="ref-Margolis2017simupy" ref-type="bibr">Margolis,
      2017</xref>), BdSim
      (<xref alt="Nevay et al., 2020" rid="ref-NEVAY2020107200" ref-type="bibr">Nevay
      et al., 2020</xref>)) mimic Simulink and simplify model building
      through graphical interfaces, but they abstract away the state
      vector and limit direct mathematical manipulation.</p>
    </list-item>
    <list-item>
      <label>2)</label>
      <p>High-level simulators (e.g.,
      <ext-link ext-link-type="uri" xlink:href="https://ir-sim.readthedocs.io/en/stable/">IR-Sim</ext-link>,
      RobotDART
      (<xref alt="Chatzilygeroudis et al., 2024" rid="ref-Chatzilygeroudis2024" ref-type="bibr">Chatzilygeroudis
      et al., 2024</xref>)) allow algorithm testing in predefined
      environments but lack flexibility for low-level system modeling
      and algorithm design.</p>
    </list-item>
  </list>
  <p>Both operate at higher abstraction levels, concealing the
  underlying state-space formulation. In block-diagram frameworks, users
  connect functional blocks, while individual state variables remain
  implicit. In high-level simulators, states are often predefined by the
  environment (e.g., robot position, velocity) rather than exposed to
  the user.</p>
  <p>In contrast, <italic>c4dynamics</italic> brings the state-space
  representation back into focus, allowing engineers to define,
  manipulate, and analyze the system’s state vector directly — bridging
  the gap between physical modeling and algorithm design.</p>
  <p>For illustration, consider the modeling and simulation of a
  pendulum:</p>
  <list list-type="bullet">
    <list-item>
      <p>In a block-diagram framework, the user connects integrators and
      functional blocks, focusing on signal flow rather than the
      physical meaning of the state variables.
      </p>
    </list-item>
    <list-item>
      <p>High-level simulators abstract the system even further: users
      define parameters in configuration files and observe the resulting
      motion at the behavioral level, rather than interacting with the
      underlying mathematical or algorithmic model.
      </p>
    </list-item>
    <list-item>
      <p>In a stateful approach, the user explicitly defines the state
      variables and their initial conditions, performing algorithmic
      operations — both mathematical and data-related — within the main
      loop.</p>
    </list-item>
  </list>
  <p><italic>c4dynamics</italic> adopts this stateful approach and
  extends it into a modular, Python-native framework for state-space
  modeling of dynamical systems. Built around explicit state
  representations and complemented by a scientific library of filters
  and sensor models, it enables reproducible modeling, testing, and
  optimization of dynamic systems within the scientific Python
  ecosystem.</p>
</sec>
<sec id="example">
  <title>Example</title>
  <p>The following example demonstrates how to model a simple pendulum
  using <italic>c4dynamics</italic>. The state of the pendulum consists
  of two variables: <inline-formula><alternatives>
  <tex-math><![CDATA[X = [θ, q]]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[θ]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>θ</mml:mi></mml:math></alternatives></inline-formula>
  is the angular displacement (rod angle), and
  <inline-formula><alternatives>
  <tex-math><![CDATA[q]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>q</mml:mi></mml:math></alternatives></inline-formula>
  is the angular rate.</p>
  <p>Initial conditions: <inline-formula><alternatives>
  <tex-math><![CDATA[X_0 = [50, 0]]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  (degrees, degrees per second, respectively).</p>
  <fig id="fig-pendulum">
    <caption><p>Simplified pendulum configuration.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="rod_and_bob.png" />
  </fig>
  <p>The pendulum dynamics in state-space form is given by:</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[ \dot{\theta} = q ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mover><mml:mi>θ</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>q</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>
  <disp-formula><alternatives>
  <tex-math><![CDATA[ \dot{q} = \frac{g}{L}\sin\theta ]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mover><mml:mi>q</mml:mi><mml:mo accent="true">̇</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mi>g</mml:mi><mml:mi>L</mml:mi></mml:mfrac><mml:mo>sin</mml:mo><mml:mi>θ</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p><xref alt="Figure 1" rid="fig-pendulum">Figure 1</xref> shows a
  schematic of the simple pendulum, and the system parameters are listed
  below:
  - Rod length: <inline-formula><alternatives>
  <tex-math><![CDATA[L = 1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  [m] (rigid, massless)
  - Gravity: <inline-formula><alternatives>
  <tex-math><![CDATA[g = 9.8]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mn>9.8</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  [m/s²]
  - Time step: <inline-formula><alternatives>
  <tex-math><![CDATA[0.01]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>0.01</mml:mn></mml:math></alternatives></inline-formula>
  [s]
  - Simulation duration: <inline-formula><alternatives>
  <tex-math><![CDATA[5]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mn>5</mml:mn></mml:math></alternatives></inline-formula>
  [s]
  - Integration function: <monospace>solve_ivp</monospace> (SciPy)</p>
  <p>The expected result is an oscillatory motion of the angle
  <inline-formula><alternatives>
  <tex-math><![CDATA[θ(t)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  in <xref alt="Figure 2" rid="fig-theta">Figure 2</xref>, representing
  the pendulum swinging back and forth.</p>
  <p>Import required packages:</p>
  <code language="python">from scipy.integrate import solve_ivp
from matplotlib import pyplot as plt 
import c4dynamics as c4d
import numpy as np </code>
  <p>Define the state object and initial conditions:</p>
  <code language="python">pend  = c4d.state(theta = 50 * c4d.d2r, q = 0)</code>
  <p>Run the simulation loop and store the state at each step:</p>
  <code language="python">dt = 0.01 
for ti in np.arange(0, 5, dt): 
  pend.store(ti)
  pend.X = solve_ivp(lambda t, y: [y[1], -9.8 * c4d.sin(y[0])]
            , [ti, ti + dt], pend.X).y[:, -1]</code>
  <p>Plot the angular displacement history:</p>
  <code language="python">pend.plot('theta', scale = c4d.r2d, darkmode = False)
plt.show()</code>
  <fig id="fig-theta">
    <caption><p>Pendulum angle <inline-formula><alternatives>
    <tex-math><![CDATA[\theta(t)]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>θ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
    over time.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="pendulum.png" />
  </fig>
  <p>Through this example, we see how <italic>c4dynamics</italic> lets
  users describe a system’s physics directly, run the simulation, and
  visualize results — all within a consistent, state-based framework.
  The same workflow applies seamlessly to more advanced dynamic
  models.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-Kalman1104873">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kalman</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>On the general theory of control systems</article-title>
      <source>IRE Transactions on Automatic Control</source>
      <year iso-8601-date="1959">1959</year>
      <volume>4</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1109/TAC.1959.1104873</pub-id>
      <fpage>110</fpage>
      <lpage>110</lpage>
    </element-citation>
  </ref>
  <ref id="ref-numpy2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Harris</surname><given-names>Millman</given-names><suffix>C. R.</suffix></name>
      </person-group>
      <article-title>Array programming with NumPy</article-title>
      <source>Nature</source>
      <year iso-8601-date="2020">2020</year>
      <volume>585</volume>
      <issue>7825</issue>
      <uri>https://doi.org/10.1038/s41586-020-2649-2</uri>
      <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>
      <fpage>357</fpage>
      <lpage>362</lpage>
    </element-citation>
  </ref>
  <ref id="ref-SciPy2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Virtanen</surname><given-names>Pauli</given-names></name>
        <name><surname>Gommers</surname><given-names>Ralf</given-names></name>
        <name><surname>Oliphant</surname><given-names>Travis E.</given-names></name>
        <name><surname>Haberland</surname><given-names>Matt</given-names></name>
        <name><surname>Reddy</surname><given-names>Tyler</given-names></name>
        <name><surname>Cournapeau</surname><given-names>David</given-names></name>
        <name><surname>Burovski</surname><given-names>Evgeni</given-names></name>
        <name><surname>Peterson</surname><given-names>Pearu</given-names></name>
        <name><surname>Weckesser</surname><given-names>Warren</given-names></name>
        <name><surname>Bright</surname><given-names>Jonathan</given-names></name>
        <name><surname>van der Walt</surname><given-names>Stéfan J.</given-names></name>
        <name><surname>Brett</surname><given-names>Matthew</given-names></name>
        <name><surname>Wilson</surname><given-names>Joshua</given-names></name>
        <name><surname>Millman</surname><given-names>K. Jarrod</given-names></name>
        <name><surname>Mayorov</surname><given-names>Nikolay</given-names></name>
        <name><surname>Nelson</surname><given-names>Andrew R. J.</given-names></name>
        <name><surname>Jones</surname><given-names>Eric</given-names></name>
        <name><surname>Kern</surname><given-names>Robert</given-names></name>
        <name><surname>Larson</surname><given-names>Eric</given-names></name>
        <name><surname>Carey</surname><given-names>C J</given-names></name>
        <name><surname>Polat</surname><given-names>İlhan</given-names></name>
        <name><surname>Feng</surname><given-names>Yu</given-names></name>
        <name><surname>Moore</surname><given-names>Eric W.</given-names></name>
        <name><surname>VanderPlas</surname><given-names>Jake</given-names></name>
        <name><surname>Laxalde</surname><given-names>Denis</given-names></name>
        <name><surname>Perktold</surname><given-names>Josef</given-names></name>
        <name><surname>Cimrman</surname><given-names>Robert</given-names></name>
        <name><surname>Henriksen</surname><given-names>Ian</given-names></name>
        <name><surname>Quintero</surname><given-names>E. A.</given-names></name>
        <name><surname>Harris</surname><given-names>Charles R.</given-names></name>
        <name><surname>Archibald</surname><given-names>Anne M.</given-names></name>
        <name><surname>Ribeiro</surname><given-names>Antônio H.</given-names></name>
        <name><surname>Pedregosa</surname><given-names>Fabian</given-names></name>
        <name><surname>van Mulbregt</surname><given-names>Paul</given-names></name>
        <string-name>SciPy 1.0 Contributors</string-name>
      </person-group>
      <article-title>SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python</article-title>
      <source>Nature Methods</source>
      <year iso-8601-date="2020">2020</year>
      <volume>17</volume>
      <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
      <fpage>261</fpage>
      <lpage>272</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Margolis2017simupy">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Margolis</surname><given-names>Benjamin WL</given-names></name>
      </person-group>
      <article-title>SimuPy: A Python framework for modeling and simulating dynamical systems</article-title>
      <source>J. Open Source Software</source>
      <year iso-8601-date="2017">2017</year>
      <volume>2</volume>
      <issue>17</issue>
      <pub-id pub-id-type="doi">10.21105/joss.00396</pub-id>
      <fpage>396</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-NEVAY2020107200">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nevay</surname><given-names>L. J.</given-names></name>
        <name><surname>Boogert</surname><given-names>S. T.</given-names></name>
        <name><surname>Snuverink</surname><given-names>J.</given-names></name>
        <name><surname>Abramov</surname><given-names>A.</given-names></name>
        <name><surname>Deacon</surname><given-names>L. C.</given-names></name>
        <name><surname>Garcia-Morales</surname><given-names>H.</given-names></name>
        <name><surname>Lefebvre</surname><given-names>H.</given-names></name>
        <name><surname>Gibson</surname><given-names>S. M.</given-names></name>
        <name><surname>Kwee-Hinzmann</surname><given-names>R.</given-names></name>
        <name><surname>Shields</surname><given-names>W.</given-names></name>
        <name><surname>Walker</surname><given-names>S. D.</given-names></name>
      </person-group>
      <article-title>BDSIM: An accelerator tracking code with particle–matter interactions</article-title>
      <source>Computer Physics Communications</source>
      <year iso-8601-date="2020">2020</year>
      <volume>252</volume>
      <issn>0010-4655</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0010465520300400</uri>
      <pub-id pub-id-type="doi">10.1016/j.cpc.2020.107200</pub-id>
      <fpage>107200</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Chatzilygeroudis2024">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chatzilygeroudis</surname><given-names>Konstantinos</given-names></name>
        <name><surname>Totsila</surname><given-names>Dionis</given-names></name>
        <name><surname>Mouret</surname><given-names>Jean-Baptiste</given-names></name>
      </person-group>
      <article-title>RobotDART: A versatile robot simulator for robotics and machine learning researchers</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>9</volume>
      <issue>102</issue>
      <uri>https://doi.org/10.21105/joss.06771</uri>
      <pub-id pub-id-type="doi">10.21105/joss.06771</pub-id>
      <fpage>6771</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
