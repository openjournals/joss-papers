<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6934</article-id>
<article-id pub-id-type="doi">10.21105/joss.06934</article-id>
<title-group>
<article-title>alchemlyb: the simple alchemistry library</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7615-7851</contrib-id>
<name>
<surname>Wu</surname>
<given-names>Zhiyi</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5879-2942</contrib-id>
<name>
<surname>Dotson</surname>
<given-names>David L.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5787-9130</contrib-id>
<name>
<surname>Alibay</surname>
<given-names>Irfan</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0804-8127</contrib-id>
<name>
<surname>Allen</surname>
<given-names>Bryce K.</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8226-7347</contrib-id>
<name>
<surname>Barhaghi</surname>
<given-names>Mohammad Soroush</given-names>
</name>
<xref ref-type="aff" rid="aff-6"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-2540-4098</contrib-id>
<name>
<surname>Hénin</surname>
<given-names>Jérôme</given-names>
</name>
<xref ref-type="aff" rid="aff-7"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1323-3244</contrib-id>
<name>
<surname>Joseph</surname>
<given-names>Thomas T.</given-names>
</name>
<xref ref-type="aff" rid="aff-8"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9749-8866</contrib-id>
<name>
<surname>Kenney</surname>
<given-names>Ian M.</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4221-7094</contrib-id>
<name>
<surname>Lee</surname>
<given-names>Hyungro</given-names>
</name>
<xref ref-type="aff" rid="aff-9"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0004-8369-1042</contrib-id>
<name>
<surname>Li</surname>
<given-names>Haoxi</given-names>
</name>
<xref ref-type="aff" rid="aff-10"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4030-9312</contrib-id>
<name>
<surname>Lim</surname>
<given-names>Victoria</given-names>
</name>
<xref ref-type="aff" rid="aff-11"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-8632-633X</contrib-id>
<name>
<surname>Liu</surname>
<given-names>Shuai</given-names>
</name>
<xref ref-type="aff" rid="aff-12"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1839-9868</contrib-id>
<name>
<surname>Marson</surname>
<given-names>Domenico</given-names>
</name>
<xref ref-type="aff" rid="aff-13"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7045-8725</contrib-id>
<name>
<surname>Merz</surname>
<given-names>Pascal T.</given-names>
</name>
<xref ref-type="aff" rid="aff-14"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4250-363X</contrib-id>
<name>
<surname>Schlaich</surname>
<given-names>Alexander</given-names>
</name>
<xref ref-type="aff" rid="aff-15"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1083-5533</contrib-id>
<name>
<surname>Mobley</surname>
<given-names>David</given-names>
</name>
<xref ref-type="aff" rid="aff-11"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3249-1097</contrib-id>
<name>
<surname>Shirts</surname>
<given-names>Michael R.</given-names>
</name>
<xref ref-type="aff" rid="aff-16"/>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1340-0831</contrib-id>
<name>
<surname>Beckstein</surname>
<given-names>Oliver</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-17"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Exscientia plc, Schroedinger Building, Oxford, United
Kingdom</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Department of Physics, Arizona State University, Tempe,
Arizona, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>Datryllic LLC, Phoenix, Arizona, United States of America
(present affiliation)</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Open Free Energy, Open Molecular Software Foundation,
Davis, California, United States</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Differentiated Therapeutics, San Diego, CA</institution>
</institution-wrap>
</aff>
<aff id="aff-6">
<institution-wrap>
<institution>Department of Chemical Engineering and Materials Science,
Wayne State University, Detroit, Michigan, United States of
America</institution>
</institution-wrap>
</aff>
<aff id="aff-7">
<institution-wrap>
<institution>Université Paris Cité, CNRS, Laboratoire de Biochimie
Théorique, Paris, France</institution>
</institution-wrap>
</aff>
<aff id="aff-8">
<institution-wrap>
<institution>Department of Anesthesiology and Critical Care, Perelman
School of Medicine, University of Pennsylvania, Philadelphia,
Pennsylvania, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-9">
<institution-wrap>
<institution>Pacific Northwest National Laboratory, Richland,
Washington, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-10">
<institution-wrap>
<institution>UNC Eshelman School of Pharmacy, University of North
Carolina, Chapel Hill, NC, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-11">
<institution-wrap>
<institution>Departments of Pharmaceutical Sciences and Chemistry,
University of California Irvine, Irvine, California, United States of
America</institution>
</institution-wrap>
</aff>
<aff id="aff-12">
<institution-wrap>
<institution>Silicon Therapeutics LLC, Boston, United States of
America</institution>
</institution-wrap>
</aff>
<aff id="aff-13">
<institution-wrap>
<institution>Molecular Biology and Nanotechnology Laboratory
(MolBNL@UniTS), DEA, University of Trieste, Trieste, Italy</institution>
</institution-wrap>
</aff>
<aff id="aff-14">
<institution-wrap>
<institution>PM Scientific Consulting, Basel, Switzerland</institution>
</institution-wrap>
</aff>
<aff id="aff-15">
<institution-wrap>
<institution>Stuttgart Center for Simulation Science (SC SimTech) &amp;
Institute for Computational Physics, University of Stuttgart, Stuttgart,
Germany</institution>
</institution-wrap>
</aff>
<aff id="aff-16">
<institution-wrap>
<institution>University of Colorado Boulder, Boulder, Colorado, United
States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-17">
<institution-wrap>
<institution>Center for Biological Physics, Arizona State University,
Tempe, AZ, United States of America</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-06-04">
<day>4</day>
<month>6</month>
<year>2024</year>
</pub-date>
<volume>9</volume>
<issue>101</issue>
<fpage>6934</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>alchemistry</kwd>
<kwd>molecular dynamics</kwd>
<kwd>free energy</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><italic>alchemlyb</italic> is an open-source Python software
  package for the analysis of alchemical free energy calculations, an
  important method in computational chemistry and biology, most notably
  in the field of drug discovery
  (<xref alt="Merz et al., 2010" rid="ref-merz2010drug" ref-type="bibr">Merz
  et al., 2010</xref>). Its functionality contains individual composable
  building blocks for all aspects of a full typical free energy analysis
  workflow, starting with the extraction of raw data from the output of
  diverse molecular simulation packages, moving on to data preprocessing
  tasks such as decorrelation of time series, using various estimators
  to derive free energy estimates from simulation samples, and finally
  providing quality analysis tools for data convergence checking and
  visualization. <italic>alchemlyb</italic> also contains high-level
  end-to-end workflows that combine multiple building blocks into a
  user-friendly analysis pipeline from the initial data input stage to
  the final results. This workflow functionality enhances accessibility
  by enabling researchers from diverse scientific backgrounds, and not
  solely computational chemistry specialists, to use
  <italic>alchemlyb</italic> effectively.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>In the pharmaceutical sector, computational chemistry techniques
  are integral for evaluating potential drug compounds based on their
  protein binding affinity
  (<xref alt="Deng &amp; Roux, 2009" rid="ref-deng2009computations" ref-type="bibr">Deng
  &amp; Roux, 2009</xref>). Notably, absolute binding free energy
  calculations between proteins and ligands or relative binding affinity
  of ligands to the same protein are routinely employed for this purpose
  (<xref alt="Merz et al., 2010" rid="ref-merz2010drug" ref-type="bibr">Merz
  et al., 2010</xref>). The resultant estimates of these free energies
  are essential for understanding binding affinity throughout various
  stages of drug discovery, such as hit identification and lead
  optimization
  (<xref alt="Merz et al., 2010" rid="ref-merz2010drug" ref-type="bibr">Merz
  et al., 2010</xref>). Other free energies extracted from simulations
  are useful in solution thermodynamics, chemical engineering,
  environmental science, and material science
  (<xref alt="Schlaich et al., 2015" rid="ref-Schlaich2015aa" ref-type="bibr">Schlaich
  et al., 2015</xref>).</p>
  <p>Molecular simulation packages such as
  <ext-link ext-link-type="uri" xlink:href="https://www.gromacs.org/">GROMACS</ext-link>
  (<xref alt="Abraham et al., 2015" rid="ref-Abraham2015aa" ref-type="bibr">Abraham
  et al., 2015</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://ambermd.org/">Amber</ext-link>
  (<xref alt="Case et al., 2005" rid="ref-Case2005uq" ref-type="bibr">Case
  et al., 2005</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://www.ks.uiuc.edu/Research/namd/">NAMD</ext-link>
  (<xref alt="Phillips et al., 2020" rid="ref-phillips2020scalable" ref-type="bibr">Phillips
  et al., 2020</xref>),
  <ext-link ext-link-type="uri" xlink:href="https://lammps.org/">LAMMPS</ext-link>
  (<xref alt="Thompson et al., 2022" rid="ref-Thompson2022aa" ref-type="bibr">Thompson
  et al., 2022</xref>), and
  <ext-link ext-link-type="uri" xlink:href="https://gomc-wsu.org/">GOMC</ext-link>
  (<xref alt="Nejahi et al., 2021" rid="ref-Nejahi2021aa" ref-type="bibr">Nejahi
  et al., 2021</xref>) are used to run free energy simulations and many
  of these packages also contain tools for the subsequent processing of
  simulation data into free energies. However, there are no standard
  output formats and analysis tools implement different algorithms for
  the different stages of the free energy data processing pipeline.
  Therefore, it is very difficult to analyze data from different
  simulation packages in a consistent manner. Furthermore, the native
  analysis tools do not always implement current best practices
  (<xref alt="Klimovich et al., 2015" rid="ref-klimovich2015guidelines" ref-type="bibr">Klimovich
  et al., 2015</xref>;
  <xref alt="Mey et al., 2020" rid="ref-Mey2020aa" ref-type="bibr">Mey
  et al., 2020</xref>) or are out of date. Overall, the coupling between
  data generation and analysis in most simulation packages hinders
  seamless collaboration and comparison of results across different
  implementations of data generation for free energy calculations.</p>
  <p><italic>alchemlyb</italic> addresses this problem by focusing only
  on the data analysis portion of this process with the goal to provide
  a unified interface for working with free energy data generated from
  different software packages. In an initial step data are read from the
  native package file formats and then organized into a common standard
  data structure, organized as a
  <ext-link ext-link-type="uri" xlink:href="https://pandas.pydata.org"><italic>pandas</italic></ext-link>
  <monospace>DataFrame</monospace>
  (<xref alt="McKinney, 2010" rid="ref-mckinney-proc-scipy-2010" ref-type="bibr">McKinney,
  2010</xref>). Functions are provided for pre-processing data by
  subsampling or decorrelation. Statistical mechanical estimators are
  available to extract free energies and thermodynamic expectations as
  well associated metrics of quality; these estimators are implemented
  as classes with the same API as estimators in
  <ext-link ext-link-type="uri" xlink:href="https://scikit-learn.org">scikit-learn</ext-link>
  (<xref alt="Buitinck et al., 2013" rid="ref-sklearn2013api" ref-type="bibr">Buitinck
  et al., 2013</xref>;
  <xref alt="Pedregosa et al., 2011" rid="ref-scikitlearn2011" ref-type="bibr">Pedregosa
  et al., 2011</xref>). <italic>alchemlyb</italic> implements modular
  building blocks to simplify the process of extracting crucial
  thermodynamic insights from molecular simulations in a uniform
  manner.</p>
  <p><italic>alchemlyb</italic> succeeds the widely-used but now
  deprecated
  <ext-link ext-link-type="uri" xlink:href="https://github.com/MobleyLab/alchemical-analysis"><monospace>alchemical-analysis.py</monospace>
  tool</ext-link>
  (<xref alt="Klimovich et al., 2015" rid="ref-klimovich2015guidelines" ref-type="bibr">Klimovich
  et al., 2015</xref>), which combined pre-processing, free energy
  estimation, and plotting in a single script.
  <monospace>alchemical-analysis.py</monospace> was not thoroughly
  tested and hard to integrate into modern workflows due to its
  monolithic design, and only supported (now outdated) Python 2.
  <italic>alchemlyb</italic> improves over its predecessor with a
  modular, function based design and thorough testing of all components
  using continuous integration. Thus, <italic>alchemlyb</italic> is a
  library that enables users to easily use well-tested building blocks
  within their own tools while additionally providing examples of
  complete end-to-end workflows. This innovation enables consistent
  processing of free energy data from diverse simulation packages,
  facilitating streamlined comparison and combination of results.</p>
  <p>Notably, <italic>alchemlyb</italic>’s robust and user-friendly
  nature has led to its integration into other automated workflow
  libraries such as BioSimSpace
  (<xref alt="Hedges et al., 2019" rid="ref-Hedges2019aa" ref-type="bibr">Hedges
  et al., 2019</xref>) or MDPOW
  (<xref alt="Fan et al., 2020" rid="ref-fan2020aa" ref-type="bibr">Fan
  et al., 2020</xref>), demonstrating its accessibility and usability
  within broader scientific workflows and reinforcing its position as a
  versatile tool in the field of computational chemistry.</p>
</sec>
<sec id="background-alchemical-free-energy-calculations">
  <title>Background: Alchemical free energy calculations</title>
  <p>Free energy differences are fundamental to understand many
  different processes at the molecular scale, ranging from the binding
  of drug molecules to their receptor proteins or nucleic acids through
  the partitioning of molecules into different solvents or phases to the
  stability of crystals and biomolecules
  (<xref alt="Deng &amp; Roux, 2009" rid="ref-deng2009computations" ref-type="bibr">Deng
  &amp; Roux, 2009</xref>). The calculation of such transfer free
  energies involves constructing two end states where a target molecule
  interacts with different environments. For example, in a solvation
  free energy calculation, in one state (the coupled state) the target
  molecule interacts with a solvent (in the case of hydration free
  energies, water), while in the other state (the decoupled state) the
  ligand has no intermolecular interactions, which mimics the transfer
  of a ligand from infinite dilution in the solvent to the gas phase.
  The solvation free energy is then obtained by calculating the free
  energy difference between these two end states, but it is crucial to
  ensure sufficient overlap in phase space between the coupled and
  decoupled states, a condition often challenging to achieve.</p>
  <p>Stratified alchemical free energy calculations have emerged as a
  de-facto standard approach whereby non-physical intermediate states
  are introduced to bridge between the physical end states of the
  process
  (<xref alt="Mey et al., 2020" rid="ref-Mey2020aa" ref-type="bibr">Mey
  et al., 2020</xref>). In such free energy calculations, overlapping
  states are created by the introduction of a parameter
  <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
  that continuously connects the functional form (the Hamiltonian of the
  system) of the two end-states, resulting in a series of intermediate
  states each with a different <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
  value between 0 and 1 and with the physically realizable end states at
  <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda=0]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda=1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
  In general, <inline-formula><alternatives>
  <tex-math><![CDATA[N]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula>
  alchemical parameters are used to describe the alchemical
  transformation with a parameter vector <inline-formula><alternatives>
  <tex-math><![CDATA[\vec{\lambda}=(\lambda_1, \lambda_2, \dots, \lambda_N)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mover><mml:mi>λ</mml:mi><mml:mo accent="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mi>N</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  so that <inline-formula><alternatives>
  <tex-math><![CDATA[\vec{\lambda}=(0, 0, \dots, 0)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mover><mml:mi>λ</mml:mi><mml:mo accent="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  indicates the initial and <inline-formula><alternatives>
  <tex-math><![CDATA[\vec{\lambda} = (1, 1, \dots, 1)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mover><mml:mi>λ</mml:mi><mml:mo accent="true">→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>…</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  the final state. The intermediate states are non-physical but required
  for converging the calculations. At each
  <inline-formula><alternatives>
  <tex-math><![CDATA[\vec{\lambda}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mover><mml:mi>λ</mml:mi><mml:mo accent="true">→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>-value
  (or “window”), the system configurations are sampled in the relevant
  thermodynamic ensemble, typically using Molecular Dynamics (MD) or
  Monte Carlo (MC) simulations, while generating and accumulating free
  energy data discussed below. Estimators are then applied to these data
  to compute free energy differences between states, including the
  difference between the final and initial state, thus yielding the
  desired free energy difference of the physical process of
  interest.</p>
</sec>
<sec id="implementation">
  <title>Implementation</title>
  <sec id="core-design-principles">
    <title>Core design principles</title>
    <p><italic>alchemlyb</italic> is a Python library that seeks to make
    alchemical free energy calculations easier and less error prone. It
    includes functionality for parsing data from file formats of widely
    used simulation packages, subsampling these data, and fitting these
    data with an estimator to obtain free energies. Functions are simple
    in usage and pure in scope, and can be chained together to build
    customized analyses of data while estimators are implemented as
    classes that follow the tried-and-tested scikit-learn API
    (<xref alt="Buitinck et al., 2013" rid="ref-sklearn2013api" ref-type="bibr">Buitinck
    et al., 2013</xref>). General and robust workflows following best
    practices are also provided, which can be used as reference
    implementations and examples.</p>
    <p>First and foremost, scientific code must be correct and we try to
    ensure this requirement by following best software engineering
    practices during development, close to full test coverage of all
    code in the library (currently 99%), and providing citations to
    published papers for included algorithms. We use a curated, public
    data set
    (<ext-link ext-link-type="uri" xlink:href="https://github.com/alchemistry/alchemtest"><italic>alchemtest</italic></ext-link>)
    for automated testing; code in <italic>alchemtest</italic> is
    published under the open source BSD-3 clause license while all data
    are included under an
    <ext-link ext-link-type="uri" xlink:href="https://opendefinition.org/licenses/#recommended-conformant-licenses">open
    license</ext-link> such as
    <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</ext-link>
    (public domain) or
    <ext-link ext-link-type="uri" xlink:href="http://opendefinition.org/licenses/cc-by/">CC-BY</ext-link>
    (attribution required).</p>
    <p>The guiding design principles are summarized as:</p>
    <list list-type="order">
      <list-item>
        <p>Use functions when possible, classes only when necessary (or
        for estimators, see (2)).</p>
      </list-item>
      <list-item>
        <p>For estimators, mimic the object-oriented scikit-learn API as
        much as possible.</p>
      </list-item>
      <list-item>
        <p>Aim for a consistent interface throughout, e.g. all parsers
        take similar inputs and yield a common set of outputs, using the
        <monospace>pandas.DataFrame</monospace> as the underlying data
        structure.</p>
      </list-item>
      <list-item>
        <p>Have <italic>all</italic> functionality tested.</p>
      </list-item>
    </list>
    <p><italic>alchemlyb</italic> supports recent versions of Python 3
    and follows the
    <ext-link ext-link-type="uri" xlink:href="https://scientific-python.org/specs/spec-0000/">SPEC
    0 (Minimum Supported Dependencies)</ext-link> Scientific Python
    Ecosystem Coordination community standard for deciding on when to
    drop support for older versions of Python and dependencies. Releases
    are numbered following the
    <ext-link ext-link-type="uri" xlink:href="https://semver.org/">Semantic
    Versioning 2.0.0</ext-link> standard of MAJOR.MINOR.PATCHLEVEL,
    which ensures that users immediately understand if a release may
    break backwards compatibility (increase of the major version), adds
    new features (increase of minor version), or only contains bug fixes
    or other changes that do not directly affect users. All code is
    published under the open source BSD-3 clause license.</p>
  </sec>
  <sec id="library-structure">
    <title>Library structure</title>
    <p><italic>alchemlyb</italic> offers specific parsers in
    <monospace>alchemlyb.parsing</monospace> to load raw free energy
    data from various molecular simulation packages
    (<ext-link ext-link-type="uri" xlink:href="https://www.gromacs.org/">GROMACS</ext-link>
    (<xref alt="Abraham et al., 2015" rid="ref-Abraham2015aa" ref-type="bibr">Abraham
    et al., 2015</xref>),
    <ext-link ext-link-type="uri" xlink:href="https://ambermd.org/">Amber</ext-link>
    (<xref alt="Case et al., 2005" rid="ref-Case2005uq" ref-type="bibr">Case
    et al., 2005</xref>),
    <ext-link ext-link-type="uri" xlink:href="https://www.ks.uiuc.edu/Research/namd/">NAMD</ext-link>
    (<xref alt="Phillips et al., 2020" rid="ref-phillips2020scalable" ref-type="bibr">Phillips
    et al., 2020</xref>), and
    <ext-link ext-link-type="uri" xlink:href="https://gomc-wsu.org/">GOMC</ext-link>
    (<xref alt="Nejahi et al., 2021" rid="ref-Nejahi2021aa" ref-type="bibr">Nejahi
    et al., 2021</xref>)) and provides a general structure for
    implementing parsers for other packages that are not yet supported.
    The raw data are converted into a standard format as a
    <monospace>pandas.DataFrame</monospace>
    (<xref alt="McKinney, 2010" rid="ref-mckinney-proc-scipy-2010" ref-type="bibr">McKinney,
    2010</xref>) and converted from the energy of the software to units
    of <inline-formula><alternatives>
    <tex-math><![CDATA[k T]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
    where <inline-formula><alternatives>
    <tex-math><![CDATA[k = 1.380649 \times 10^{-23}\,\text{J}\,\text{K}^{-1}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1.380649</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mrow><mml:mi>−</mml:mi><mml:mn>23</mml:mn></mml:mrow></mml:msup><mml:mspace width="0.167em"></mml:mspace><mml:mtext mathvariant="normal">J</mml:mtext><mml:mspace width="0.167em"></mml:mspace><mml:msup><mml:mtext mathvariant="normal">K</mml:mtext><mml:mrow><mml:mi>−</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>
    is Boltzmann’s constant and <inline-formula><alternatives>
    <tex-math><![CDATA[T]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>
    is the temperature at which the simulation was performed. Metadata
    such as <inline-formula><alternatives>
    <tex-math><![CDATA[T]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>T</mml:mi></mml:math></alternatives></inline-formula>
    and the energy unit are stored in <monospace>DataFrame</monospace>
    attributes and propagated through <italic>alchemlyb</italic>, which
    enables seamless unit conversion with functions in the
    <monospace>alchemlyb.postprocessing</monospace> module. Two types of
    free energy data are considered: Hamiltonian gradients
    (<monospace>dHdl</monospace>, <inline-formula><alternatives>
    <tex-math><![CDATA[dH/d\lambda]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>d</mml:mi><mml:mi>H</mml:mi><mml:mi>/</mml:mi><mml:mi>d</mml:mi><mml:mi>λ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>)
    at all lambda states, suitable for thermodynamic integration (TI)
    estimators
    (<xref alt="Kirkwood, 1935" rid="ref-kirkwood1935statistical" ref-type="bibr">Kirkwood,
    1935</xref>), and reduced potential energy differences between
    lambda states (<monospace>u_nk</monospace>,
    <inline-formula><alternatives>
    <tex-math><![CDATA[u_{nk}]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>),
    which are used for free energy perturbation (FEP) estimators
    (<xref alt="Zwanzig, 1954" rid="ref-zwanzig1954high" ref-type="bibr">Zwanzig,
    1954</xref>).</p>
    <p>Both types of estimators assume uncorrelated samples in order to
    give unbiased estimates of the uncertainties, which requires
    subsampling of the raw data. The
    <monospace>alchemlyb.preprocessing.subsampling</monospace> module
    provides tools for data subsampling based on autocorrelation times
    (<xref alt="Chodera et al., 2007" rid="ref-chodera2007use" ref-type="bibr">Chodera
    et al., 2007</xref>;
    <xref alt="Chodera, 2016" rid="ref-Chodera2016aa" ref-type="bibr">Chodera,
    2016</xref>) as well as simple slicing of the
    <monospace>dHdl</monospace> and <monospace>u_nk</monospace>
    DataFrames.</p>
    <p>The two major classes of commonly used estimators are implemented
    in <monospace>alchemlyb.estimators</monospace>. Unlike other
    components of <italic>alchemlyb</italic> that are implemented as
    pure functions, estimators are implemented as classes and follow the
    well-known scikit-learn API
    (<xref alt="Buitinck et al., 2013" rid="ref-sklearn2013api" ref-type="bibr">Buitinck
    et al., 2013</xref>) where instantiation sets the parameters (e.g.,
    <monospace>estimator = MBAR(maximum_iterations=10000)</monospace>)
    and calling of the <monospace>fit()</monospace> method (e.g.,
    <monospace>estimator.fit(u_nk)</monospace>) applies the estimator to
    the data and populates output attributes of the class; these results
    attributes are customarily indicated with a trailing underscore
    (e.g., <monospace>estimator.delta_f_</monospace> for the matrix of
    free energy differences between all states). In
    <italic>alchemlyb</italic>, TI
    (<xref alt="Paliwal &amp; Shirts, 2011" rid="ref-paliwal2011benchmark" ref-type="bibr">Paliwal
    &amp; Shirts, 2011</xref>) and TI with Gaussian quadrature
    (<xref alt="Gusev et al., 2023" rid="ref-gusev2023active" ref-type="bibr">Gusev
    et al., 2023</xref>) estimators are implemented in the TI category
    of estimators (module
    <monospace>alchemlyb.estimators.TI</monospace>). FEP category
    estimators (module <monospace>alchemlyb.estimators.FEP</monospace>)
    include Bennett Acceptance Ratio (BAR)
    (<xref alt="Bennett, 1976" rid="ref-bennett1976efficient" ref-type="bibr">Bennett,
    1976</xref>) and Multistate BAR (MBAR)
    (<xref alt="Shirts &amp; Chodera, 2008" rid="ref-shirts2008statistically" ref-type="bibr">Shirts
    &amp; Chodera, 2008</xref>), which are implemented in the
    <ext-link ext-link-type="uri" xlink:href="https://github.com/choderalab/pymbar"><italic>pymbar</italic></ext-link>
    package
    (<xref alt="Shirts &amp; Chodera, 2008" rid="ref-shirts2008statistically" ref-type="bibr">Shirts
    &amp; Chodera, 2008</xref>) and called from
    <italic>alchemlyb</italic>.</p>
    <p>To evaluate the accuracy of the free energy estimate,
    <italic>alchemlyb</italic> offers a range of assessment tools. The
    error of the TI method is correlated with the average curvature
    (<xref alt="Pham &amp; Shirts, 2011" rid="ref-pham2011identifying" ref-type="bibr">Pham
    &amp; Shirts, 2011</xref>), while the error of FEP estimators
    depends on the overlap in sampled energy distributions
    (<xref alt="Pohorille et al., 2010" rid="ref-pohorille2010good" ref-type="bibr">Pohorille
    et al., 2010</xref>). <italic>alchemlyb</italic> creates
    visualizations of the smoothness of the integrand for TI estimators
    and the overlap matrix for FEP estimators, which can be
    qualitatively and quantitatively analyzed to determine the degree of
    overlap between simulated alchemical states, and suggest whether
    additional simulations should be run. For statistical validity, the
    accumulated samples should be collected from equilibrated
    simulations and <italic>alchemlyb</italic> contains tools for
    assessing (<monospace>alchemlyb.convergence</monospace>) and
    plotting (<monospace>alchemlyb.visualisation</monospace>) the
    convergence of the free energy estimate as a function of simulation
    time
    (<xref alt="Yang et al., 2004" rid="ref-yang2004free" ref-type="bibr">Yang
    et al., 2004</xref>) and means to compute the “fractional
    equilibration time”
    (<xref alt="Fan et al., 2020" rid="ref-fan2020aa" ref-type="bibr">Fan
    et al., 2020</xref>) to detect potentially non-equilibrated
    data.</p>
    <p><italic>alchemlyb</italic> offers all these tools as a library
    for users to customize each stage of the analysis
    (<xref alt="[fig:buildingblocks]" rid="figU003Abuildingblocks">[fig:buildingblocks]</xref>).</p>
    <fig>
      <caption><p>The building blocks of <italic>alchemlyb</italic>. Raw
      data from simulation packages are parsed into common data
      structures depending on the free energy quantities, pre-processed,
      and processed with a free energy estimator. The resulting free
      energy differences are analyzed for convergence and plotted for
      quality
      assessment.<styled-content id="figU003Abuildingblocks"></styled-content></p></caption>
      <graphic mimetype="application" mime-subtype="pdf" xlink:href="Fig1.pdf" />
    </fig>
  </sec>
  <sec id="workflows">
    <title>Workflows</title>
    <p>The building blocks are sufficient to compute free energies from
    alchemical free energy simulations and assess their reliability.
    This functionality is used, for example, by the Streamlined
    Alchemical Free Energy Perturbation (SAFEP) analysis scripts
    (<xref alt="Salari et al., 2018" rid="ref-Salari2018" ref-type="bibr">Salari
    et al., 2018</xref>;
    <xref alt="Santiago-McRae et al., 2023" rid="ref-santiagomcrae2023" ref-type="bibr">Santiago-McRae
    et al., 2023</xref>).</p>
    <p><italic>alchemlyb</italic> also provides a structure to combine
    the building blocks into full end-to-end workflows (module
    <monospace>alchemlyb.workflows</monospace>). As an example, the
    <monospace>ABFE</monospace> workflow for absolute binding free
    energy estimation reads in the raw input data and performs
    decorrelation, estimation, and quality plotting of the estimate. It
    can directly estimate quantities such as solvation free energies and
    makes it easy to calculate more complex quantities such as absolute
    binding free energies (as the difference between the solvation free
    energy of the ligand in water and the solvation free energy of the
    ligand in the protein’s binding pocket).</p>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>Some work on <italic>alchemlyb</italic> was supported by grants
  from the National Institutes of Health (Award No R01GM118772 to O.B.,
  R35GM148236 to D.M., K08GM139031 to T.T.J.) and the National Science
  Foundation (award ACI-1443054 to O.B.). A.S. acknowledges funding by
  Deutsche Forschungsgemeinschaft (DFG, German Research Foundation)
  under Germany’s Excellence Strategy - EXC 2075 – 390740016 and support
  by the Stuttgart Center for Simulation Science (SimTech). The sponsors
  were not involved in any aspects of the research or the writing of the
  manuscript.</p>
  <p>We thank Dominik Wille, Travis Jensen, and Jennifer A. Clark for
  substantial code contributions, Helmut Carter and Wei-Tse Hsu for
  small fixes, Shujie Fan for initial code for fractional equilibration
  time calculation, and Jan Janssen for creating the initial conda-forge
  package.</p>
</sec>
<sec id="author-contributions">
  <title>Author contributions</title>
  <p>D.L.D., M.R.S., D.M., and O.B. designed the project. Z.W., D.L.D.,
  I.A., B.K.A., M.S.B, J.H., T.T.J., I.M.K., H.L., H.L., V.L., S.L.,
  D.M., P.T.M, A.S. contributed to new features. Z.W., D.L.D., O.B.
  maintained the code base. Z.W., D.L.D., M.R.S, A.S., P.T.M., O.B.
  wrote the manuscript.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-bennett1976efficient">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bennett</surname><given-names>C. H.</given-names></name>
      </person-group>
      <article-title>Efficient estimation of free energy differences from monte carlo data</article-title>
      <source>Journal of Computational Physics</source>
      <year iso-8601-date="1976">1976</year>
      <volume>22</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1016/0021-9991(76)90078-4</pub-id>
      <fpage>245</fpage>
      <lpage>268</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Case2005uq">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Case</surname><given-names>David A</given-names></name>
        <name><surname>Cheatham</surname><given-names>Thomas E</given-names><suffix>3rd</suffix></name>
        <name><surname>Darden</surname><given-names>Tom</given-names></name>
        <name><surname>Gohlke</surname><given-names>Holger</given-names></name>
        <name><surname>Luo</surname><given-names>Ray</given-names></name>
        <name><surname>Merz</surname><given-names>Kenneth M</given-names><suffix>Jr</suffix></name>
        <name><surname>Onufriev</surname><given-names>Alexey</given-names></name>
        <name><surname>Simmerling</surname><given-names>Carlos</given-names></name>
        <name><surname>Wang</surname><given-names>Bing</given-names></name>
        <name><surname>Woods</surname><given-names>Robert J</given-names></name>
      </person-group>
      <article-title>The Amber biomolecular simulation programs</article-title>
      <source>Journal of Computational Chemistry</source>
      <year iso-8601-date="2005">2005</year>
      <volume>26</volume>
      <issue>16</issue>
      <pub-id pub-id-type="doi">10.1002/jcc.20290</pub-id>
      <fpage>1668</fpage>
      <lpage>1688</lpage>
    </element-citation>
  </ref>
  <ref id="ref-chodera2007use">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chodera</surname><given-names>J. D.</given-names></name>
        <name><surname>Swope</surname><given-names>W. C.</given-names></name>
        <name><surname>Pitera</surname><given-names>J. W.</given-names></name>
        <name><surname>Seok</surname><given-names>C.</given-names></name>
        <name><surname>Dill</surname><given-names>K. A.</given-names></name>
      </person-group>
      <article-title>Use of the weighted histogram analysis method for the analysis of simulated and parallel tempering simulations</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2007">2007</year>
      <volume>3</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1021/ct0502864</pub-id>
      <fpage>26</fpage>
      <lpage>41</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Nejahi2021aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Nejahi</surname><given-names>Younes</given-names></name>
        <name><surname>Barhaghi</surname><given-names>Mohammad Soroush</given-names></name>
        <name><surname>Schwing</surname><given-names>Gregory</given-names></name>
        <name><surname>Schwiebert</surname><given-names>Loren</given-names></name>
        <name><surname>Potoff</surname><given-names>Jeffrey</given-names></name>
      </person-group>
      <article-title>Update 2.70 to “GOMC: GPU optimized Monte Carlo for the simulation of phase equilibria and physical properties of complex fluids”</article-title>
      <source>SoftwareX</source>
      <year iso-8601-date="2021">2021</year>
      <volume>13</volume>
      <pub-id pub-id-type="doi">10.1016/j.softx.2020.100627</pub-id>
      <fpage>100627</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-deng2009computations">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Deng</surname><given-names>Y.</given-names></name>
        <name><surname>Roux</surname><given-names>B.</given-names></name>
      </person-group>
      <article-title>Computations of standard binding free energies with molecular dynamics simulations</article-title>
      <source>The Journal of Physical Chemistry B</source>
      <year iso-8601-date="2009">2009</year>
      <volume>113</volume>
      <issue>8</issue>
      <pub-id pub-id-type="doi">10.1021/jp807701h</pub-id>
      <fpage>2234</fpage>
      <lpage>2246</lpage>
    </element-citation>
  </ref>
  <ref id="ref-gusev2023active">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gusev</surname><given-names>F.</given-names></name>
        <name><surname>Gutkin</surname><given-names>E.</given-names></name>
        <name><surname>Kurnikova</surname><given-names>M. G.</given-names></name>
        <name><surname>Isayev</surname><given-names>O.</given-names></name>
      </person-group>
      <article-title>Active learning guided drug design lead optimization based on relative binding free energy modeling</article-title>
      <source>Journal of Chemical Information and Modeling</source>
      <year iso-8601-date="2023">2023</year>
      <volume>63</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1021/acs.jcim.2c01052</pub-id>
      <fpage>583</fpage>
      <lpage>594</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Hedges2019aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hedges</surname><given-names>Lester O.</given-names></name>
        <name><surname>Mey</surname><given-names>Antonia S. J. S.</given-names></name>
        <name><surname>Laughton</surname><given-names>Charles A.</given-names></name>
        <name><surname>Gervasio</surname><given-names>Francesco L.</given-names></name>
        <name><surname>Mulholland</surname><given-names>Adrian J.</given-names></name>
        <name><surname>Woods</surname><given-names>Christopher J.</given-names></name>
        <name><surname>Michel</surname><given-names>Julien</given-names></name>
      </person-group>
      <article-title>BioSimSpace: An interoperable Python framework for biomolecular simulation</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>43</issue>
      <pub-id pub-id-type="doi">10.21105/joss.01831</pub-id>
      <fpage>1831</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-kirkwood1935statistical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Kirkwood</surname><given-names>J. G.</given-names></name>
      </person-group>
      <article-title>Statistical mechanics of fluid mixtures</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="1935">1935</year>
      <volume>3</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.1063/1.1749657</pub-id>
      <fpage>300</fpage>
      <lpage>313</lpage>
    </element-citation>
  </ref>
  <ref id="ref-klimovich2015guidelines">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Klimovich</surname><given-names>P. V.</given-names></name>
        <name><surname>Shirts</surname><given-names>M. R.</given-names></name>
        <name><surname>Mobley</surname><given-names>D. L.</given-names></name>
      </person-group>
      <article-title>Guidelines for the analysis of free energy calculations</article-title>
      <source>Journal of Computer-Aided Molecular Design</source>
      <year iso-8601-date="2015">2015</year>
      <volume>29</volume>
      <issue>5</issue>
      <pub-id pub-id-type="doi">10.1007/s10822-015-9840-9</pub-id>
      <fpage>397</fpage>
      <lpage>411</lpage>
    </element-citation>
  </ref>
  <ref id="ref-merz2010drug">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Merz</surname><given-names>K. M.</given-names><suffix>Jr</suffix></name>
        <name><surname>Ringe</surname><given-names>D.</given-names></name>
        <name><surname>Reynolds</surname><given-names>C. H.</given-names></name>
      </person-group>
      <source>Drug design: Structure-and ligand-based approaches</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <pub-id pub-id-type="doi">10.48550/arXiv.1309.0238</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-paliwal2011benchmark">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Paliwal</surname><given-names>H.</given-names></name>
        <name><surname>Shirts</surname><given-names>M. R.</given-names></name>
      </person-group>
      <article-title>A benchmark test set for alchemical free energy transformations and its use to quantify error in common free energy methods</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2011">2011</year>
      <volume>7</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1021/ct2003995</pub-id>
      <fpage>4115</fpage>
      <lpage>4134</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pham2011identifying">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pham</surname><given-names>T. T.</given-names></name>
        <name><surname>Shirts</surname><given-names>M. R.</given-names></name>
      </person-group>
      <article-title>Identifying low variance pathways for free energy calculations of molecular transformations in solution phase</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2011">2011</year>
      <volume>135</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1063/1.3607597</pub-id>
      <fpage>034114</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-phillips2020scalable">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Phillips</surname><given-names>James C.</given-names></name>
        <name><surname>Hardy</surname><given-names>David J.</given-names></name>
        <name><surname>Maia</surname><given-names>Julio D. C.</given-names></name>
        <name><surname>Stone</surname><given-names>John E.</given-names></name>
        <name><surname>Ribeiro</surname><given-names>João V.</given-names></name>
        <name><surname>Bernardi</surname><given-names>Rafael C.</given-names></name>
        <name><surname>Buch</surname><given-names>Ronak</given-names></name>
        <name><surname>Fiorin</surname><given-names>Giacomo</given-names></name>
        <name><surname>Hénin</surname><given-names>Jérôme</given-names></name>
        <name><surname>Jiang</surname><given-names>Wei</given-names></name>
        <name><surname>McGreevy</surname><given-names>Ryan</given-names></name>
        <name><surname>Melo</surname><given-names>Marcelo C. R.</given-names></name>
        <name><surname>Radak</surname><given-names>Brian K.</given-names></name>
        <name><surname>Skeel</surname><given-names>Robert D.</given-names></name>
        <name><surname>Singharoy</surname><given-names>Abhishek</given-names></name>
        <name><surname>Wang</surname><given-names>Yi</given-names></name>
        <name><surname>Roux</surname><given-names>Benoı̂t</given-names></name>
        <name><surname>Aksimentiev</surname><given-names>Aleksei</given-names></name>
        <name><surname>Luthey-Schulten</surname><given-names>Zaida</given-names></name>
        <name><surname>Kalé</surname><given-names>Laxmikant V.</given-names></name>
        <name><surname>Schulten</surname><given-names>Klaus</given-names></name>
        <name><surname>Chipot</surname><given-names>Christophe</given-names></name>
        <name><surname>Tajkhorshid</surname><given-names>Emad</given-names></name>
      </person-group>
      <article-title>Scalable molecular dynamics on CPU and GPU architectures with NAMD</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2020">2020</year>
      <volume>153</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1063/5.0014475</pub-id>
      <fpage>044130</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-pohorille2010good">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pohorille</surname><given-names>A.</given-names></name>
        <name><surname>Jarzynski</surname><given-names>C.</given-names></name>
        <name><surname>Chipot</surname><given-names>C.</given-names></name>
      </person-group>
      <article-title>Good practices in free-energy calculations</article-title>
      <source>The Journal of Physical Chemistry B</source>
      <year iso-8601-date="2010">2010</year>
      <volume>114</volume>
      <issue>32</issue>
      <pub-id pub-id-type="doi">10.1021/jp102971x</pub-id>
      <fpage>10235</fpage>
      <lpage>10253</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Abraham2015aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Abraham</surname><given-names>Mark James</given-names></name>
        <name><surname>Murtola</surname><given-names>Teemu</given-names></name>
        <name><surname>Schulz</surname><given-names>Roland</given-names></name>
        <name><surname>Páll</surname><given-names>Szilárd</given-names></name>
        <name><surname>Smith</surname><given-names>Jeremy C.</given-names></name>
        <name><surname>Hess</surname><given-names>Berk</given-names></name>
        <name><surname>Lindahl</surname><given-names>Erik</given-names></name>
      </person-group>
      <article-title>GROMACS: High performance molecular simulations through multi-level parallelism from laptops to supercomputers</article-title>
      <source>SoftwareX</source>
      <year iso-8601-date="2015">2015</year>
      <volume>1–2</volume>
      <pub-id pub-id-type="doi">10.1016/j.softx.2015.06.001</pub-id>
      <fpage>19 </fpage>
      <lpage> 25</lpage>
    </element-citation>
  </ref>
  <ref id="ref-shirts2008statistically">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Shirts</surname><given-names>M. R.</given-names></name>
        <name><surname>Chodera</surname><given-names>J. D.</given-names></name>
      </person-group>
      <article-title>Statistically optimal analysis of samples from multiple equilibrium states</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2008">2008</year>
      <volume>129</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1063/1.2978177</pub-id>
      <fpage>124105</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-yang2004free">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yang</surname><given-names>W.</given-names></name>
        <name><surname>Bitetti-Putzer</surname><given-names>R.</given-names></name>
        <name><surname>Karplus</surname><given-names>M.</given-names></name>
      </person-group>
      <article-title>Free energy simulations: Use of reverse cumulative averaging to determine the equilibrated region and the time required for convergence</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="2004">2004</year>
      <volume>120</volume>
      <issue>6</issue>
      <pub-id pub-id-type="doi">10.1063/1.1638996</pub-id>
      <fpage>2618</fpage>
      <lpage>2628</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zwanzig1954high">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zwanzig</surname><given-names>R. W.</given-names></name>
      </person-group>
      <article-title>High‐temperature equation of state by a perturbation method. I. Nonpolar gases</article-title>
      <source>The Journal of Chemical Physics</source>
      <year iso-8601-date="1954">1954</year>
      <volume>22</volume>
      <issue>8</issue>
      <pub-id pub-id-type="doi">10.1063/1.1740409</pub-id>
      <fpage>1420</fpage>
      <lpage>1426</lpage>
    </element-citation>
  </ref>
  <ref id="ref-fan2020aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fan</surname><given-names>Shujie</given-names></name>
        <name><surname>Iorga</surname><given-names>Bogdan I.</given-names></name>
        <name><surname>Beckstein</surname><given-names>Oliver</given-names></name>
      </person-group>
      <article-title>Prediction of octanol-water partition coefficients for the SAMPL6-\log P molecules using molecular dynamics simulations with OPLS-AA, AMBER and CHARMM force fields</article-title>
      <source>Journal of Computer-Aided Molecular Design</source>
      <year iso-8601-date="2020">2020</year>
      <volume>34</volume>
      <pub-id pub-id-type="doi">10.1007/s10822-019-00267-z</pub-id>
      <fpage>543</fpage>
      <lpage>560</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Mey2020aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Mey</surname><given-names>Antonia S. J. S.</given-names></name>
        <name><surname>Allen</surname><given-names>Bryce</given-names></name>
        <name><surname>Macdonald</surname><given-names>Hannah E. Bruce</given-names></name>
        <name><surname>Chodera</surname><given-names>John D.</given-names></name>
        <name><surname>Kuhn</surname><given-names>Maximilian</given-names></name>
        <name><surname>Michel</surname><given-names>Julien</given-names></name>
        <name><surname>Mobley</surname><given-names>David L.</given-names></name>
        <name><surname>Naden</surname><given-names>Levi N.</given-names></name>
        <name><surname>Prasad</surname><given-names>Samarjeet</given-names></name>
        <name><surname>Rizzi</surname><given-names>Andrea</given-names></name>
        <name><surname>Scheen</surname><given-names>Jenke</given-names></name>
        <name><surname>Shirts</surname><given-names>Michael R.</given-names></name>
        <name><surname>Tresadern</surname><given-names>Gary</given-names></name>
        <name><surname>Xu</surname><given-names>Huafeng</given-names></name>
      </person-group>
      <article-title>Best practices for alchemical free energy calculations</article-title>
      <source>Living Journal of Computational Molecular Science</source>
      <year iso-8601-date="2020">2020</year>
      <volume>2</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.33011/livecoms.2.1.18378</pub-id>
      <fpage>18378</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Chodera2016aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Chodera</surname><given-names>J. D.</given-names></name>
      </person-group>
      <article-title>A simple method for automated equilibration detection in molecular simulations</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2016-04">2016</year><month>04</month>
      <volume>12</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1021/acs.jctc.5b00784</pub-id>
      <fpage>1799</fpage>
      <lpage>1805</lpage>
    </element-citation>
  </ref>
  <ref id="ref-mckinney-proc-scipy-2010">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>McKinney</surname></name>
      </person-group>
      <article-title>Data Structures for Statistical Computing in Python</article-title>
      <source>Proceedings of the 9th Python in Science Conference</source>
      <person-group person-group-type="editor">
        <name><surname>Walt</surname></name>
        <name><surname>Millman</surname></name>
      </person-group>
      <year iso-8601-date="2010">2010</year>
      <pub-id pub-id-type="doi">10.25080/Majora-92bf1922-00a</pub-id>
      <fpage>56 </fpage>
      <lpage> 61</lpage>
    </element-citation>
  </ref>
  <ref id="ref-scikitlearn2011">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pedregosa</surname><given-names>F.</given-names></name>
        <name><surname>Varoquaux</surname><given-names>G.</given-names></name>
        <name><surname>Gramfort</surname><given-names>A.</given-names></name>
        <name><surname>Michel</surname><given-names>V.</given-names></name>
        <name><surname>Thirion</surname><given-names>B.</given-names></name>
        <name><surname>Grisel</surname><given-names>O.</given-names></name>
        <name><surname>Blondel</surname><given-names>M.</given-names></name>
        <name><surname>Prettenhofer</surname><given-names>P.</given-names></name>
        <name><surname>Weiss</surname><given-names>R.</given-names></name>
        <name><surname>Dubourg</surname><given-names>V.</given-names></name>
        <name><surname>Vanderplas</surname><given-names>J.</given-names></name>
        <name><surname>Passos</surname><given-names>A.</given-names></name>
        <name><surname>Cournapeau</surname><given-names>D.</given-names></name>
        <name><surname>Brucher</surname><given-names>M.</given-names></name>
        <name><surname>Perrot</surname><given-names>M.</given-names></name>
        <name><surname>Duchesnay</surname><given-names>E.</given-names></name>
      </person-group>
      <article-title>Scikit-learn: Machine learning in Python</article-title>
      <source>Journal of Machine Learning Research</source>
      <year iso-8601-date="2011">2011</year>
      <volume>12</volume>
      <fpage>2825</fpage>
      <lpage>2830</lpage>
    </element-citation>
  </ref>
  <ref id="ref-sklearn2013api">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Buitinck</surname><given-names>Lars</given-names></name>
        <name><surname>Louppe</surname><given-names>Gilles</given-names></name>
        <name><surname>Blondel</surname><given-names>Mathieu</given-names></name>
        <name><surname>Pedregosa</surname><given-names>Fabian</given-names></name>
        <name><surname>Mueller</surname><given-names>Andreas</given-names></name>
        <name><surname>Grisel</surname><given-names>Olivier</given-names></name>
        <name><surname>Niculae</surname><given-names>Vlad</given-names></name>
        <name><surname>Prettenhofer</surname><given-names>Peter</given-names></name>
        <name><surname>Gramfort</surname><given-names>Alexandre</given-names></name>
        <name><surname>Grobler</surname><given-names>Jaques</given-names></name>
        <name><surname>Layton</surname><given-names>Robert</given-names></name>
        <name><surname>VanderPlas</surname><given-names>Jake</given-names></name>
        <name><surname>Joly</surname><given-names>Arnaud</given-names></name>
        <name><surname>Holt</surname><given-names>Brian</given-names></name>
        <name><surname>Varoquaux</surname><given-names>Gaël</given-names></name>
      </person-group>
      <article-title>API design for machine learning software: Experiences from the scikit-learn project</article-title>
      <source>ECML PKDD workshop: Languages for data mining and machine learning</source>
      <year iso-8601-date="2013">2013</year>
      <pub-id pub-id-type="doi">10.48550/arXiv.1309.0238</pub-id>
      <fpage>108</fpage>
      <lpage>122</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Schlaich2015aa">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Schlaich</surname><given-names>A</given-names></name>
        <name><surname>Kowalik</surname><given-names>B</given-names></name>
        <name><surname>Kanduč</surname><given-names>M</given-names></name>
        <name><surname>Schneck</surname><given-names>Emanuel</given-names></name>
        <name><surname>Netz</surname><given-names>RR</given-names></name>
      </person-group>
      <article-title>Simulation techniques for solvation-induced surface-interactions at prescribed water chemical potential</article-title>
      <source>Computational trends in solvation and transport in liquids-lecture notes (IAS series 28)</source>
      <person-group person-group-type="editor">
        <name><surname>Sutmann</surname><given-names>G.</given-names></name>
        <name><surname>Grotendorst</surname><given-names>J.</given-names></name>
        <name><surname>Gompper</surname><given-names>G.</given-names></name>
        <name><surname>Marx</surname><given-names>D.</given-names></name>
      </person-group>
      <publisher-name>Forschungszentrum Jülich GmbH</publisher-name>
      <publisher-loc>Jülich</publisher-loc>
      <year iso-8601-date="2015">2015</year>
      <volume>28</volume>
      <fpage>155</fpage>
      <lpage>185</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Thompson2022aa">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Thompson</surname><given-names>Aidan P.</given-names></name>
        <name><surname>Aktulga</surname><given-names>H. Metin</given-names></name>
        <name><surname>Berger</surname><given-names>Richard</given-names></name>
        <name><surname>Bolintineanu</surname><given-names>Dan S.</given-names></name>
        <name><surname>Brown</surname><given-names>W. Michael</given-names></name>
        <name><surname>Crozier</surname><given-names>Paul S.</given-names></name>
        <name><surname>in ’t Veld</surname><given-names>Pieter J.</given-names></name>
        <name><surname>Kohlmeyer</surname><given-names>Axel</given-names></name>
        <name><surname>Moore</surname><given-names>Stan G.</given-names></name>
        <name><surname>Nguyen</surname><given-names>Trung Dac</given-names></name>
        <name><surname>Shan</surname><given-names>Ray</given-names></name>
        <name><surname>Stevens</surname><given-names>Mark J.</given-names></name>
        <name><surname>Tranchida</surname><given-names>Julien</given-names></name>
        <name><surname>Trott</surname><given-names>Christian</given-names></name>
        <name><surname>Plimpton</surname><given-names>Steven J.</given-names></name>
      </person-group>
      <article-title>LAMMPS - a flexible simulation tool for particle-based materials modeling at the atomic, meso, and continuum scales</article-title>
      <source>Computer Physics Communications</source>
      <year iso-8601-date="2022">2022</year>
      <volume>271</volume>
      <pub-id pub-id-type="doi">10.1016/j.cpc.2021.108171</pub-id>
      <fpage>108171</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Salari2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Salari</surname><given-names>Reza</given-names></name>
        <name><surname>Joseph</surname><given-names>Thomas</given-names></name>
        <name><surname>Lohia</surname><given-names>Ruchi</given-names></name>
        <name><surname>Hénin</surname><given-names>Jérôme</given-names></name>
        <name><surname>Brannigan</surname><given-names>Grace</given-names></name>
      </person-group>
      <article-title>A streamlined, general approach for computing ligand binding free energies and its application to GPCR-bound cholesterol.</article-title>
      <source>Journal of Chemical Theory and Computation</source>
      <year iso-8601-date="2018">2018</year>
      <volume>14</volume>
      <issue>12</issue>
      <pub-id pub-id-type="doi">10.1021/acs.jctc.8b00447</pub-id>
      <fpage>6560</fpage>
      <lpage>6573</lpage>
    </element-citation>
  </ref>
  <ref id="ref-santiagomcrae2023">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Santiago-McRae</surname><suffix>E.</suffix></name>
        <name><surname>Ebrahimi</surname><given-names>M.</given-names></name>
        <name><surname>Sandberg</surname><given-names>J. W.</given-names></name>
        <name><surname>Brannigan</surname><given-names>G.</given-names></name>
        <name><surname>Hénin</surname><given-names>J.</given-names></name>
      </person-group>
      <article-title>Computing absolute binding affinities by streamlined alchemical free energy perturbation (SAFEP) [article v1.0]</article-title>
      <source>Living Journal of Computational Molecular Science</source>
      <year iso-8601-date="2023">2023</year>
      <volume>5</volume>
      <issue>1</issue>
      <uri>https://livecomsjournal.org/index.php/livecoms/article/view/v5i1e2067</uri>
      <pub-id pub-id-type="doi">10.33011/livecoms.5.1.2067</pub-id>
      <fpage>2067</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
