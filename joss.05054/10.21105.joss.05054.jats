<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">5054</article-id>
<article-id pub-id-type="doi">10.21105/joss.05054</article-id>
<title-group>
<article-title>PhaseTypeR: an R package for phase-type distributions in
population genetics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0515-0628</contrib-id>
<name>
<surname>Rivas-GonzÃ¡lez</surname>
<given-names>Iker</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-6196-8427</contrib-id>
<name>
<surname>Andersen</surname>
<given-names>Lars NÃ¸rvang</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4056-1286</contrib-id>
<name>
<surname>Hobolth</surname>
<given-names>Asger</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Bioinformatics Research Centre, Aarhus University,
Denmark</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Department of Mathematics, Aarhus University,
Denmark</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2022-09-16">
<day>16</day>
<month>9</month>
<year>2022</year>
</pub-date>
<volume>8</volume>
<issue>82</issue>
<fpage>5054</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2022</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>R</kwd>
<kwd>phase-type distributions</kwd>
<kwd>population genetics</kwd>
<kwd>ancestral process</kwd>
<kwd>coalescent theory</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Phase-type distributions describe the time until absorption of a
  continuous or discrete-time Markov chain
  (<xref alt="Bladt &amp; Nielsen, 2017" rid="ref-bladt2017matrix" ref-type="bibr">Bladt
  &amp; Nielsen, 2017</xref>). The probabilistic properties of
  phase-type distributions (i.e., the probability density function,
  cumulative distribution function, quantile function, moments and
  generating functions) are well-described and analytically tractable
  using matrix manipulations.</p>
  <p>Phase-type distributions have traditionally been used in actuarial
  sciences and queuing theory, and, more recently, in population
  genetics. In order to facilitate the use of phase-type theory in
  population genetics, we present <monospace>PhaseTypeR</monospace>, a
  general-purpose and user-friendly R
  (<xref alt="R Core Team, 2021" rid="ref-Rcitation" ref-type="bibr">R
  Core Team, 2021</xref>) package which contains all key functions
  â€”mean, (co)variance, probability density function, cumulative
  distribution function, quantile function and random samplingâ€” for both
  continuous and discrete phase-type distributions. Importantly,
  univariate and multivariate reward transformations are implemented for
  continuous and discrete phase-type distributions. Multivariate reward
  transformations have great potential for applications in population
  genetics, and we have included two examples. The first is concerned
  with the easy calculation of the variance-covariance matrix for the
  site frequency spectrum (SFS) of the <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>-coalescent,
  and the second is concerned with the correlation between tree heights
  in the two-locus ancestral recombination graph.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>In recent years, the usefulness of phase-type theory in population
  genetics has become evident. Important quantities in population
  genetics such as the time until the most recent ancestor, the total
  tree length, the total number of segregating sites, and the site
  frequency spectrum follow phase-type distributions
  (<xref alt="Hobolth et al., 2019" rid="ref-hobolth2019phase" ref-type="bibr">Hobolth
  et al., 2019</xref>). There are already several other R packages that
  model phase-type distributions, such as <monospace>actuar</monospace>
  (<xref alt="Dutang et al., 2008" rid="ref-dutang2008actuar" ref-type="bibr">Dutang
  et al., 2008</xref>), <monospace>mapfit</monospace>
  (<xref alt="Hiroyuki Okamura, 2015" rid="ref-okamura2015mapfit" ref-type="bibr">Hiroyuki
  Okamura, 2015</xref>;
  <xref alt="Hiroyuki Okamura &amp; Dohi, 2015" rid="ref-okamura_dohi_2015" ref-type="bibr">Hiroyuki
  Okamura &amp; Dohi, 2015</xref>;
  <xref alt="H. Okamura &amp; Dohi, 2016" rid="ref-okamura_dohi_2016" ref-type="bibr">H.
  Okamura &amp; Dohi, 2016</xref>) or <monospace>matrixdist</monospace>
  (<xref alt="Albrecher et al., 2022" rid="ref-AlbrecherBladtYslas2020" ref-type="bibr">Albrecher
  et al., 2022</xref>;
  <xref alt="Albrecher &amp; Bladt, 2019" rid="ref-albrecher_bladt_2019" ref-type="bibr">Albrecher
  &amp; Bladt, 2019</xref>). However, these packages only model
  univariate continuous phase-type distributions, do not include reward
  transformations, and are tailored to actuarial sciences and queuing
  theory.</p>
  <p>To overcome these limitations, we present
  <monospace>PhaseTypeR</monospace>, an R package with easy-to-use,
  general-purpose phase-type functions, which is particularly well
  suited for population genetics. The package has already been used in
  Hobolth et al.
  (<xref alt="2021" rid="ref-HBA2021" ref-type="bibr">2021</xref>) to
  model the site frequency spectrum using multivariate phase-type
  theory, and we believe that its intuitive implementation will
  encourage more population geneticists to use phase-type theory.</p>
</sec>
<sec id="overview">
  <title>Overview</title>
  <p><monospace>PhaseTypeR</monospace> contains general implementations
  of core functions for continuous and discrete phase-type
  distributions, for both the univariate and multivariate cases. These
  include the mean and (co)variance of phase-type distributions; their
  density, probability and quantile functions; functions for random
  draws; and functions for reward transformations.</p>
  <p><xref alt="TableÂ 1" rid="tabU003Atab1">TableÂ 1</xref> provides an
  overview of the <monospace>PhaseTypeR</monospace> functions for a
  univariate continuous phase-type distribution
  <inline-formula><alternatives>
  <tex-math><![CDATA[\tau \sim \text{PH}(\boldsymbol{\alpha},\boldsymbol{T})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ï„</mml:mi><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">PH</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ›‚</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ“</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{\alpha}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ›‚</mml:mi></mml:math></alternatives></inline-formula>
  is the initial distribution and <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{T}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ“</mml:mi></mml:math></alternatives></inline-formula>
  the sub-intensity matrix. Let <inline-formula><alternatives>
  <tex-math><![CDATA[\{X(t):t\geq 0\}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>â‰¥</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  denote the corresponding continuous-time Markov chain (CTMC). The
  reward transformation is then given by <inline-formula><alternatives>
  <tex-math><![CDATA[Y=\int_0^\tau r(X(t)) dt]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>âˆ«</mml:mo><mml:mn>0</mml:mn><mml:mi>Ï„</mml:mi></mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\tau]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ï„</mml:mi></mml:math></alternatives></inline-formula>
  is the time to absorption, and <inline-formula><alternatives>
  <tex-math><![CDATA[Y]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Y</mml:mi></mml:math></alternatives></inline-formula>
  is also phase-type distributed
  (<xref alt="Bladt &amp; Nielsen, 2017" rid="ref-bladt2017matrix" ref-type="bibr">Bladt
  &amp; Nielsen, 2017</xref>). If the CTMC has
  <inline-formula><alternatives>
  <tex-math><![CDATA[p]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>p</mml:mi></mml:math></alternatives></inline-formula>
  transient states, then the reward function
  <inline-formula><alternatives>
  <tex-math><![CDATA[r(i), i=1,\ldots,p]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
  is a vector of length <inline-formula><alternatives>
  <tex-math><![CDATA[p]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>p</mml:mi></mml:math></alternatives></inline-formula>.</p>
  <table-wrap>
    <caption>
      <p>formulas and corresponding <monospace>PhaseTypeR</monospace>
      functions for univariate continuous phase-type distributions. The
      vector <inline-formula><alternatives>
      <tex-math><![CDATA[\boldsymbol{a}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğš</mml:mi></mml:math></alternatives></inline-formula>
      determines the initial probabilities,
      <inline-formula><alternatives>
      <tex-math><![CDATA[\boldsymbol{T}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ“</mml:mi></mml:math></alternatives></inline-formula>
      is the sub-intensity matrix, <inline-formula><alternatives>
      <tex-math><![CDATA[\boldsymbol{e}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      is a vector with 1 in every entry, and <monospace>r</monospace> is
      the reward
      vector.<styled-content id="tabU003Atab1"></styled-content></p>
    </caption>
    <table>
      <colgroup>
        <col width="33%" />
        <col width="33%" />
        <col width="33%" />
      </colgroup>
      <thead>
        <tr>
          <th>Quantity</th>
          <th>Formula</th>
          <th>Function</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>PH object</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[\tau\sim\text{PH}(\boldsymbol{a}, \boldsymbol{T})]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ï„</mml:mi><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">PH</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğš</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ“</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>PH(T, a)</monospace></td>
        </tr>
        <tr>
          <td>Mean</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[\text{E}[\tau]=\boldsymbol{a} (-\boldsymbol{T})^{-1}\boldsymbol{e}]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">E</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>Ï„</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>ğš</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mo>âˆ’</mml:mo><mml:mi>ğ“</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mo>âˆ’</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>ğ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>mean(PH)</monospace></td>
        </tr>
        <tr>
          <td>Variance</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[\text{V}[\tau]=\text{E}[\tau^2]-\text{E}[\tau]^2]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">V</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>Ï„</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">E</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msup><mml:mi>Ï„</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>âˆ’</mml:mo><mml:mtext mathvariant="normal">E</mml:mtext><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>Ï„</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>var(PH)</monospace></td>
        </tr>
        <tr>
          <td>Density</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[f(x)=\boldsymbol{a}\exp(\boldsymbol{T}x)(\boldsymbol{-T}\boldsymbol{e})]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>ğš</mml:mi><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ“</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mrow><mml:mo mathvariant="bold">âˆ’</mml:mo><mml:mi>ğ“</mml:mi></mml:mrow><mml:mi>ğ</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
          <inline-formula><alternatives>
          <tex-math><![CDATA[x\geq 0]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>x</mml:mi><mml:mo>â‰¥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>dPH(x, PH)</monospace></td>
        </tr>
        <tr>
          <td>Cumulative distribution</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[F(x)=1-\boldsymbol{a}\exp(\boldsymbol{T}x)\boldsymbol{e}]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>âˆ’</mml:mo><mml:mi>ğš</mml:mi><mml:mo>exp</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ“</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>ğ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
          <inline-formula><alternatives>
          <tex-math><![CDATA[x\geq 0]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>x</mml:mi><mml:mo>â‰¥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>pPH(x, PH)</monospace></td>
        </tr>
        <tr>
          <td>Quantile function</td>
          <td></td>
          <td><monospace>qPH(p, PH)</monospace></td>
        </tr>
        <tr>
          <td>Random sampling</td>
          <td></td>
          <td><monospace>rPH(n, PH)</monospace></td>
        </tr>
        <tr>
          <td>Random sampling of full path</td>
          <td></td>
          <td><monospace>rFullPH(n, PH)</monospace></td>
        </tr>
        <tr>
          <td>Reward transformation</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[Y=\int_0^\tau r(X(t))dt]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>âˆ«</mml:mo><mml:mn>0</mml:mn><mml:mi>Ï„</mml:mi></mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>reward_phase_type(PH, r)</monospace></td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <p><xref alt="TableÂ 2" rid="tabU003Atab2">TableÂ 2</xref> provides an
  overview of the <monospace>PhaseTypeR</monospace> functions for the
  univariate discrete phase-type distribution. Here, the reward
  transformation is given by Campillo Navarro
  (<xref alt="2018" rid="ref-navarro2019discrete" ref-type="bibr">2018</xref>).
  <xref alt="TableÂ 3" rid="tabU003Atab3">TableÂ 3</xref> gives an
  overview of the multivariate phase-type distribution. A multivariate
  phase-type distribution is the joint distribution of
  <inline-formula><alternatives>
  <tex-math><![CDATA[(Y_1,\ldots,Y_k)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[Y_j=\int_0^\tau r_j(X(t)) dt]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>âˆ«</mml:mo><mml:mn>0</mml:mn><mml:mi>Ï„</mml:mi></mml:msubsup><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  for <inline-formula><alternatives>
  <tex-math><![CDATA[j=1,\ldots,k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>.
  We summarize the rewards <inline-formula><alternatives>
  <tex-math><![CDATA[r_j(i)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  in a matrix <inline-formula><alternatives>
  <tex-math><![CDATA[R]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>R</mml:mi></mml:math></alternatives></inline-formula>
  with <inline-formula><alternatives>
  <tex-math><![CDATA[p]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>p</mml:mi></mml:math></alternatives></inline-formula>
  rows (corresponding to the transient states) and
  <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
  columns (corresponding to the <inline-formula><alternatives>
  <tex-math><![CDATA[k]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>k</mml:mi></mml:math></alternatives></inline-formula>
  reward functions) with entries <inline-formula><alternatives>
  <tex-math><![CDATA[R_{ij}=r_j(i)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <table-wrap>
    <caption>
      <p>Formulas and corresponding <monospace>PhaseTypeR</monospace>
      functions for univariate discrete phase-type distributions. The
      vector <inline-formula><alternatives>
      <tex-math><![CDATA[\boldsymbol{a}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğš</mml:mi></mml:math></alternatives></inline-formula>
      determines the initial probabilities,
      <inline-formula><alternatives>
      <tex-math><![CDATA[\boldsymbol{T}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ“</mml:mi></mml:math></alternatives></inline-formula>
      is the sub-transition matrix, <inline-formula><alternatives>
      <tex-math><![CDATA[\boldsymbol{e}]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ</mml:mi></mml:math></alternatives></inline-formula>
      is a vector with one in every entry,
      <inline-formula><alternatives>
      <tex-math><![CDATA[I]]></tex-math>
      <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>I</mml:mi></mml:math></alternatives></inline-formula>
      is the identity matrix, and <monospace>r</monospace> is the reward
      vector.<styled-content id="tabU003Atab2"></styled-content></p>
    </caption>
    <table>
      <colgroup>
        <col width="33%" />
        <col width="32%" />
        <col width="35%" />
      </colgroup>
      <thead>
        <tr>
          <th>Quantity</th>
          <th>Formula</th>
          <th>Function</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>DPH object</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[\tau\sim\text{DPH}(\boldsymbol{a}, \boldsymbol{T})]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ï„</mml:mi><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">DPH</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğš</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ“</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>DPH(T, a)</monospace></td>
        </tr>
        <tr>
          <td>Mean</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[\text{E}[\tau]=\boldsymbol{\pi} (\boldsymbol{I}-\boldsymbol{T})^{-1}\boldsymbol{e}]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">E</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>Ï„</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>ğ›‘</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğˆ</mml:mi><mml:mo>âˆ’</mml:mo><mml:mi>ğ“</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mrow><mml:mo>âˆ’</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>ğ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>mean(DPH)</monospace></td>
        </tr>
        <tr>
          <td>Variance</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[\text{V}[\tau]= \text{E}[\tau^2]-\text{E}[\tau]^2]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">V</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>Ï„</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">E</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msup><mml:mi>Ï„</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>âˆ’</mml:mo><mml:mtext mathvariant="normal">E</mml:mtext><mml:msup><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>Ï„</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>var(DPH)</monospace></td>
        </tr>
        <tr>
          <td>Density</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[f(x)=\boldsymbol{\pi T}^{\: x-1}\boldsymbol{t}]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>ğ›‘</mml:mi><mml:mi>ğ“</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.222em"></mml:mspace><mml:mi>x</mml:mi><mml:mo>âˆ’</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>ğ­</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
          <inline-formula><alternatives>
          <tex-math><![CDATA[x\geq 1]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>x</mml:mi><mml:mo>â‰¥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>dDPH(x, DPH)</monospace></td>
        </tr>
        <tr>
          <td>Cumulative distribution</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[F(x)=1-\boldsymbol{\pi T}^{\: x}\boldsymbol{e}]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>F</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>âˆ’</mml:mo><mml:msup><mml:mrow><mml:mi>ğ›‘</mml:mi><mml:mi>ğ“</mml:mi></mml:mrow><mml:mrow><mml:mspace width="0.222em"></mml:mspace><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mi>ğ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
          <inline-formula><alternatives>
          <tex-math><![CDATA[x\geq 1]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>x</mml:mi><mml:mo>â‰¥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>pDPH(x, DPH)</monospace></td>
        </tr>
        <tr>
          <td>Quantile function</td>
          <td></td>
          <td><monospace>qDPH(p, DPH)</monospace></td>
        </tr>
        <tr>
          <td>Random sampling</td>
          <td></td>
          <td><monospace>rDPH(n, DPH)</monospace></td>
        </tr>
        <tr>
          <td>Random sampling of full path</td>
          <td></td>
          <td><monospace>rFullDPH(n, DPH)</monospace></td>
        </tr>
        <tr>
          <td>Reward transformation</td>
          <td><inline-formula><alternatives>
          <tex-math><![CDATA[Y=\sum_{m=0}^{\tau-1} r(X_m)]]></tex-math>
          <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>âˆ‘</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>Ï„</mml:mi><mml:mo>âˆ’</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mi>r</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula></td>
          <td><monospace>reward_phase_type(DPH, r)</monospace></td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
  <table-wrap>
    <caption>
      <p><monospace>PhaseTypeR</monospace> functions for multivariate
      continuous and multivariate discrete phase-type distributions.
      <monospace>a</monospace> is the vector of initial probabilities,
      <monospace>T</monospace> is the sub-intensity matrix and
      <monospace>R</monospace> is the reward matrix. For information
      about the formulas for calculating the covariances, please see
      Bladt &amp; Nielsen
      (<xref alt="2017" rid="ref-bladt2017matrix" ref-type="bibr">2017</xref>).<styled-content id="tabU003Atab3"></styled-content></p>
    </caption>
    <table>
      <colgroup>
        <col width="35%" />
        <col width="32%" />
        <col width="32%" />
      </colgroup>
      <thead>
        <tr>
          <th>Quantity</th>
          <th>Continuous</th>
          <th>Discrete</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Multivariate PH object</td>
          <td><monospace>MPH(T, a, R)</monospace></td>
          <td><monospace>MDPH(T, a, R)</monospace></td>
        </tr>
        <tr>
          <td>Mean</td>
          <td><monospace>mean(MPH)</monospace></td>
          <td><monospace>mean(MDPH)</monospace></td>
        </tr>
        <tr>
          <td>(Co)variance</td>
          <td><monospace>var(MPH)</monospace></td>
          <td><monospace>var(MDPH)</monospace></td>
        </tr>
        <tr>
          <td>Density</td>
          <td><monospace>dMPH(x, MPH)</monospace></td>
          <td><monospace>dMDPH(x, MDPH)</monospace></td>
        </tr>
        <tr>
          <td>Cumulative distribution</td>
          <td><monospace>pMPH(x, MPH)</monospace></td>
          <td><monospace>pMDPH(x, MDPH)</monospace></td>
        </tr>
        <tr>
          <td>Quantile function</td>
          <td><monospace>qMPH(p, MPH)</monospace></td>
          <td><monospace>qMDPH(p, MDPH)</monospace></td>
        </tr>
        <tr>
          <td>Random sampling</td>
          <td><monospace>rMPH(n, MPH)</monospace></td>
          <td><monospace>rMDPH(n, MDPH)</monospace></td>
        </tr>
        <tr>
          <td>Random sampling of full path</td>
          <td><monospace>rFullMPH(n, MPH)</monospace></td>
          <td><monospace>rFullMDPH(n, MDPH)</monospace></td>
        </tr>
      </tbody>
    </table>
  </table-wrap>
</sec>
<sec id="example-1-variance-covariance-matrix-of-the-sfs">
  <title>Example 1: variance-covariance matrix of the SFS</title>
  <p>This section concerns reproducing the table associated with Theorem
  2.2 in Durrett
  (<xref alt="2008" rid="ref-durrett2008probability" ref-type="bibr">2008</xref>),
  which can be used to derive the variance of the elements of the site
  frequency spectrum (SFS) and the covariance between pairs of elements
  of the SFS.</p>
  <p>Let <inline-formula><alternatives>
  <tex-math><![CDATA[\xi_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Î¾</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>
  be the <inline-formula><alternatives>
  <tex-math><![CDATA[i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>â€™th
  element of the site frequency spectrum, i.e.,
  <inline-formula><alternatives>
  <tex-math><![CDATA[\xi_1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Î¾</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  is the number of singletons, <inline-formula><alternatives>
  <tex-math><![CDATA[\xi_2]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Î¾</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math></alternatives></inline-formula>
  is the number of doubletons, etc. Letâ€™s also define
  <inline-formula><alternatives>
  <tex-math><![CDATA[L_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>,
  which is the total branch length leading to
  <inline-formula><alternatives>
  <tex-math><![CDATA[\xi_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Î¾</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.
  Theorem 3.1 in Hobolth et al.
  (<xref alt="2019" rid="ref-hobolth2019phase" ref-type="bibr">2019</xref>)
  states that the vector <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{L} = (L_1,\dots,L_{n-1})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ‹</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>âˆ’</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  has a multivariate phase-type distribution
  <disp-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{L} \sim \text{MPH}(\boldsymbol{e_1},\boldsymbol{T},\boldsymbol{R}),]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ‹</mml:mi><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">MPH</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>ğ</mml:mi><mml:mn>ğŸ</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>ğ“</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ‘</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{R}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ‘</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{T}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ“</mml:mi></mml:math></alternatives></inline-formula>
  are respectively the state-space and the sub-transition matrix of the
  so-called â€œblock-counting processâ€, and <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{e_1}=(1, 0, \dots, 0)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ğ</mml:mi><mml:mn>ğŸ</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  Conditionally on <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{L}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ‹</mml:mi></mml:math></alternatives></inline-formula>,
  the <inline-formula><alternatives>
  <tex-math><![CDATA[\xi_i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>Î¾</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula>â€™s
  are independent and Poisson distributed,
  <inline-formula><alternatives>
  <tex-math><![CDATA[\xi_i \mid L_i \sim \text{Poisson}\left(L_i \frac{\theta}{2}\right)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>Î¾</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>âˆ£</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">Poisson</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfrac><mml:mi>Î¸</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\theta]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Î¸</mml:mi></mml:math></alternatives></inline-formula>
  is the underlying mutation rate
  (<xref alt="Wakeley, 2009" rid="ref-wakeley2009coalescent" ref-type="bibr">Wakeley,
  2009</xref>). By the law of total variance, we have
  <disp-formula><alternatives>
  <tex-math><![CDATA[\text{Var}[\boldsymbol{\xi}] =\frac{\theta^2}{4} \boldsymbol{\Sigma}+ \frac{\theta}{2} \text{diag}(\text{E}[\boldsymbol{L}]).]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">Var</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>ğ›</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:msup><mml:mi>Î¸</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mn>4</mml:mn></mml:mfrac><mml:mi>ğšº</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mi>Î¸</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mtext mathvariant="normal">diag</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtext mathvariant="normal">E</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>ğ‹</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>.</mml:mi></mml:mrow></mml:math></alternatives></disp-formula>
  where <inline-formula><alternatives>
  <tex-math><![CDATA[\text{diag}(\cdot)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">diag</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mo>â‹…</mml:mo><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is the diagonal matrix whose entries are given by
  <inline-formula><alternatives>
  <tex-math><![CDATA[\text{E}[\boldsymbol{L}]]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">E</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>ğ‹</mml:mi><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  It is well-known that <inline-formula><alternatives>
  <tex-math><![CDATA[\text{E}[L_i] = 1/i]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">E</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:msub><mml:mi>L</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mi>/</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>,
  but the expressions for the entries of <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{\Sigma}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğšº</mml:mi></mml:math></alternatives></inline-formula>
  are fairly complicated
  (<xref alt="Durrett, 2008" rid="ref-durrett2008probability" ref-type="bibr">Durrett,
  2008</xref>;
  <xref alt="Fu, 1995" rid="ref-fu1995statistical" ref-type="bibr">Fu,
  1995</xref>). However as seen below, numeric calculation of
  <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{\Sigma}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğšº</mml:mi></mml:math></alternatives></inline-formula>
  is straightforward using phase-type theory, since we just need to
  specify the subintensity matrix <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{T}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ“</mml:mi></mml:math></alternatives></inline-formula>
  and the reward matrix <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{R}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ‘</mml:mi></mml:math></alternatives></inline-formula>
  for the block-counting process.</p>
  <p>Accompanying our package are a number of vignettes, which
  illustrate the use of phase-type distribution in population genetics.
  As part of one of these vignettes, we include a function that
  calculates <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{R}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ‘</mml:mi></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{T}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>ğ“</mml:mi></mml:math></alternatives></inline-formula>
  for the block-counting process with sample size
  <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>,
  which is shown below:</p>
  <code language="r script">RateMAndStateSpace &lt;- function(n){
  ## --------- State space ---------
  # Size of the state space (number of states)
  nSt &lt;- partitions::P(n)
  # Definition of the state space
  StSpM &lt;- matrix(ncol=n,nrow=nSt)
  # Set of partitions of [n]
  x &lt;- partitions::parts(n)
  # Rewriting the partitions as (a1,...,an)
  for (i in 1:nSt) {
    st &lt;- x[,i]
    StSpM[i,] &lt;- tabulate(x[,i],nbins=n)
  }
  # Reordering
  StSpM &lt;- StSpM[order(rowSums(StSpM),decreasing=TRUE),]
  # Below the diagonal the entries are always zero
  ## --------- Intensity matrix ---------
  RateM &lt;- matrix(0,ncol=nSt,nrow=nSt)
  for (i in 1:(nSt-1)){
    for (j in (i+1):nSt){
      cvec &lt;- StSpM[i,]-StSpM[j,]
      # Two branches are merged, i.e. removed from state i
      check1 &lt;- sum(cvec[cvec&gt;0])==2
      # One new branch is created, i.e. added in state from j
      check2 &lt;- sum(cvec[cvec&lt;0])==-1
      if (check1 &amp; check2){
        # Size(s) of the block(s) and the corresponding rates
        tmp &lt;- StSpM[i,which(cvec&gt;0)]
        RateM[i,j] &lt;- ifelse(length(tmp)==1,tmp*(tmp-1)/2,prod(tmp))
      }
    }
  }
  # Diagonal part of the rate matrix
  for (i in 1:nSt){
    RateM[i,i] &lt;- -sum(RateM[i,])
  }
  list(RateM=RateM,StSpM=StSpM)
}</code>
  <p>We can now define a multivariate phase-type distribution such that
  <inline-formula><alternatives>
  <tex-math><![CDATA[L\sim\text{MPH}(\boldsymbol{\alpha},\boldsymbol{T},\boldsymbol{R})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>L</mml:mi><mml:mo>âˆ¼</mml:mo><mml:mtext mathvariant="normal">MPH</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>ğ›‚</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ“</mml:mi><mml:mo>,</mml:mo><mml:mi>ğ‘</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  This is straightforward to build in <monospace>PhaseTypeR</monospace>
  with the <monospace>MPH()</monospace> function. For
  <inline-formula><alternatives>
  <tex-math><![CDATA[n=8]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>8</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>:</p>
  <code language="r script">n &lt;- 8
RMASS &lt;- RateMAndStateSpace(n)
m &lt;- dim(RMASS$RateM)[1] 
# Obtain subintensity matrix
subintensity_matrix &lt;- RMASS$RateM[1:(m-1),1:(m-1)]
# The reward matrix is the state space matrix of the block counting process
rew_mat &lt;- RMASS$StSpM[1:(m-1),1:(n-1)]
# The initial probability vector
init_probs &lt;- c(1, rep(0, n-2))
# Define MPH object
ph_rew_obj &lt;- MPH(subintensity_matrix, init_probs, rew_mat)</code>
  <p><inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{\Sigma}/4]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğšº</mml:mi><mml:mi>/</mml:mi><mml:mn>4</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
  can now be directly calculated using <monospace>var()</monospace>:</p>
  <code language="r script">var_covar_mat &lt;- var(ph_rew_obj)
round(0.25*var_covar_mat, 4) </code>
  <preformat>        [,1]    [,2]    [,3]    [,4]    [,5]    [,6]    [,7]
[1,]  0.3211 -0.0358 -0.0210 -0.0141 -0.0103 -0.0079  0.1384
[2,] -0.0358  0.2495 -0.0210 -0.0141 -0.0103  0.1328 -0.0356
[3,] -0.0210 -0.0210  0.2076 -0.0141  0.1283 -0.0346 -0.0267
[4,] -0.0141 -0.0141 -0.0141  0.3173 -0.0359 -0.0275 -0.0216
[5,] -0.0103 -0.0103  0.1283 -0.0359  0.1394 -0.0230 -0.0183
[6,] -0.0079  0.1328 -0.0346 -0.0275 -0.0230  0.1310 -0.0159
[7,]  0.1384 -0.0356 -0.0267 -0.0216 -0.0183 -0.0159  0.1224</preformat>
  <p>This yields the same variance-covariance matrix as in Theorem 2.2
  in Durrett
  (<xref alt="2008" rid="ref-durrett2008probability" ref-type="bibr">2008</xref>)
  without the need for analytical derivations.</p>
</sec>
<sec id="example-2-the-coalescent-with-recombination">
  <title>Example 2: the coalescent with recombination</title>
  <p>The traditional procedure for deriving the correlation between the
  branch lengths in two loci for a sample of size two is by a first-step
  analysis (e.g., section 7 in
  <xref alt="Wakeley, 2009" rid="ref-wakeley2009coalescent" ref-type="bibr">Wakeley,
  2009</xref>). In this section, we exemplify the easy use of
  <monospace>PhaseTypeR</monospace> to obtain the same result.</p>
  <p>The state space and transition rates for the two-locus ancestral
  recombination graph is shown in
  <xref alt="[fig:fig1]" rid="figU003Afig1">[fig:fig1]</xref>. The
  filled circles represent material ancestral to the sample, and the
  crosses indicate that the most recent common ancestor has been found.
  The lines between the circles or crosses indicate if the ancestral
  material is present on the same chromosome. The starting state is
  state 1 at present day with two samples from the same chromosome.</p>
  <p>The time <inline-formula><alternatives>
  <tex-math><![CDATA[\tau]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ï„</mml:mi></mml:math></alternatives></inline-formula>
  when both loci have found their common ancestor is
  <inline-formula><alternatives>
  <tex-math><![CDATA[\text{PH}(\boldsymbol{e_1}, \boldsymbol{S})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">PH</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>ğ</mml:mi><mml:mn>ğŸ</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>ğ’</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  distributed with <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{e_1}=(1, 0,\dots,0)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ğ</mml:mi><mml:mn>ğŸ</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>â€¦</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  and</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{S} = \left( \begin{array}{ccccc}
   -(1+2\rho/2) & 2\rho/2 & 0 & 0 & 0 \\
   1 & -(3+\rho/2) & \rho/2 & 1 & 1 \\
   0 & 4 & -6 & 1 & 1 \\
   0 & 0 & 0 & -1 & 0 \\
   0 & 0 & 0 & 0 & -1 \\
  \end{array} \right),]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ğ’</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mo>âˆ’</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mi>Ï</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>2</mml:mn><mml:mi>Ï</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mo>âˆ’</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>3</mml:mn><mml:mo>+</mml:mo><mml:mi>Ï</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mi>Ï</mml:mi><mml:mi>/</mml:mi><mml:mn>2</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>4</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mo>âˆ’</mml:mo><mml:mn>6</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mo>âˆ’</mml:mo><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center" style="text-align: center"><mml:mo>âˆ’</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>where <inline-formula><alternatives>
  <tex-math><![CDATA[\rho]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>
  is the recombination rate.</p>
  <p>The tree height <inline-formula><alternatives>
  <tex-math><![CDATA[T_{\text{left}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
  in the left locus is the first time the ancestral process
  <inline-formula><alternatives>
  <tex-math><![CDATA[\{X(t):t\geq 0\}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>:</mml:mo><mml:mi>t</mml:mi><mml:mo>â‰¥</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false" form="postfix">}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  enters state 4 or state 6 or, equivalently, the time spent in state 1,
  2, 3 and 5 before absorption in state 6. We therefore have</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[T_{\text{left}}=\min \bigl\{ t\geq 0 :X(t)\in\{4,6\} \bigr\}=\int_0^{\tau}\boldsymbol{r_{\text{left}}}(X_t)dt]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mml:mo><mml:mi>t</mml:mi><mml:mo>â‰¥</mml:mo><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>âˆˆ</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>âˆ«</mml:mo><mml:mn>0</mml:mn><mml:mi>Ï„</mml:mi></mml:msubsup><mml:msub><mml:mi>ğ«</mml:mi><mml:mtext mathvariant="bold">ğ¥ğğŸğ­</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>with the reward vector <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{r_{\text{left}}}=(1,1,1,0,1)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ğ«</mml:mi><mml:mtext mathvariant="bold">ğ¥ğğŸğ­</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  Similarly, the tree height <inline-formula><alternatives>
  <tex-math><![CDATA[T_{\text{right}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
  in the right locus is the first time the ancestral process enters
  state 5 or state 6 or, equivalently, the time spent in state 1, 2, 3
  and 4 before absorption in state 6. We therefore have</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[T_{\text{right}}=\min \bigl\{ t\geq 0 :X(t)\in\{5,6\} \bigr\}=\int_0^{\tau}\boldsymbol{r_{\text{right}}}(X_t)dt]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">{</mml:mo><mml:mi>t</mml:mi><mml:mo>â‰¥</mml:mo><mml:mn>0</mml:mn><mml:mo>:</mml:mo><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>âˆˆ</mml:mo><mml:mo stretchy="false" form="prefix">{</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false" form="postfix">}</mml:mo><mml:mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">}</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mo>âˆ«</mml:mo><mml:mn>0</mml:mn><mml:mi>Ï„</mml:mi></mml:msubsup><mml:msub><mml:mi>ğ«</mml:mi><mml:mtext mathvariant="bold">ğ«ğ¢ğ ğ¡ğ­</mml:mtext></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>with the reward vector <inline-formula><alternatives>
  <tex-math><![CDATA[\boldsymbol{r_{\text{right}}}=(1,1,1,1,0)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>ğ«</mml:mi><mml:mtext mathvariant="bold">ğ«ğ¢ğ ğ¡ğ­</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  A classical result in population genetics gives the covariance between
  the two tree heights</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[\text{Cov}(T_{\text{left}},T_{\text{right}})=\frac{\rho+18}{\rho^2+13\rho+18},]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">Cov</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>+</mml:mo><mml:mn>18</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mi>Ï</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>13</mml:mn><mml:mi>Ï</mml:mi><mml:mo>+</mml:mo><mml:mn>18</mml:mn></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>and we note that for large recombination rates
  <inline-formula><alternatives>
  <tex-math><![CDATA[\text{Cov}(T_{\text{left}},T_{\text{right}})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">Cov</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is close to zero, and for small recombination rates it is close to
  one. Also note that <inline-formula><alternatives>
  <tex-math><![CDATA[T_{\text{left}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
  and <inline-formula><alternatives>
  <tex-math><![CDATA[T_{\text{right}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub></mml:math></alternatives></inline-formula>
  are both exponentially distributed with a rate of 1, so
  <inline-formula><alternatives>
  <tex-math><![CDATA[\text{Var}(T_{\text{left}})=\text{Var}(T_{\text{right}})=1]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">Var</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">Var</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>,
  and, consequently, <inline-formula><alternatives>
  <tex-math><![CDATA[\text{Cor}(T_{\text{left}}, T_{\text{right}})=\text{Cov}(T_{\text{left}}, T_{\text{right}})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mtext mathvariant="normal">Cor</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">Cov</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  (see also equation 3.10 in
  <xref alt="Wakeley, 2009" rid="ref-wakeley2009coalescent" ref-type="bibr">Wakeley,
  2009</xref>). Moreover, as shown by a simple proof in Wilton et al.
  (<xref alt="2015" rid="ref-wilton2015smc" ref-type="bibr">2015</xref>),
  we have that <inline-formula><alternatives>
  <tex-math><![CDATA[P(T_{\text{left}}=T_{\text{right}})=\text{Cov}(T_{\text{left}}, T_{\text{right}})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext mathvariant="normal">Cov</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <fig>
    <caption><p>Two-locus ancestral recombination graph. Filled circles
    represent uncoalesced sites, while crosses represent coalesced
    sites. <inline-formula><alternatives>
    <tex-math><![CDATA[\rho]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>
    is the recombination rate.
    <styled-content id="figU003Afig1"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/recomb_graph.pdf" />
  </fig>
  <p>An implementation using <monospace>PhaseTypeR</monospace> simply
  consists of specifying the initial distribution, rate matrix for the
  ancestral process, rewards for the two tree heights, and calling the
  variance function <monospace>var()</monospace> for the multivariate
  phase-type distribution.</p>
  <code language="r script">recomb_rate &lt;- 0.3
ARG_subint_mat &lt;- function(recomb_rate) {
  matrix(
    c(-(1+2*recomb_rate/2),   2*recomb_rate/2,   0,             0,  0,
        1,                  -(3+recomb_rate/2),  recomb_rate/2, 1,  1,
        0,                    4,                -6,             1,  1,
        0,                    0,                 0,            -1,  0,
        0,                    0,                 0,             0, -1),
    nrow=5, byrow=TRUE)
}
subintensity_matrix &lt;- ARG_subint_mat(recomb_rate)
initial_probabilities &lt;- c(1, 0, 0, 0, 0)
# T_left: T_MRCA in left locus
reward_left &lt;- c(1, 1, 1, 0, 1)
# T_right: T_MRCA in right locus
reward_right &lt;- c(1, 1, 1, 1, 0)
# Joint distribution T_joint of T_left and T_right
T_joint &lt;- MPH(subintensity_matrix,
               initial_probabilities,
               matrix(c(reward_left, reward_right), nrow = 5))
var(T_joint)[1, 2]</code>
  <preformat>[1] 0.8321965</preformat>
  <p>We can see that the phase-type result is equal to the classical
  formula provided above when <inline-formula><alternatives>
  <tex-math><![CDATA[\rho=0.3]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p>From this multivariate phase-type representation of the ancestral
  recombination graph (ARG), we can simulate, for example, 1,000 samples
  from the joint distribution of <inline-formula><alternatives>
  <tex-math><![CDATA[(T_{\text{left}}, T_{\text{right}})]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>
  using <monospace>rMPH(1000, T_joint)</monospace> in
  <monospace>PhaseTypeR</monospace>. If the recombination rate
  <inline-formula><alternatives>
  <tex-math><![CDATA[\rho]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>
  is set to a small value, then most of the samples will result in
  <inline-formula><alternatives>
  <tex-math><![CDATA[T_{\text{left}}=T_{\text{right}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>,
  and the joint density will concentrate along the diagonal, as shown in
  <xref alt="[fig:fig2]" rid="figU003Afig2">[fig:fig2]</xref>, left
  (<xref alt="Simonsen &amp; Churchill, 1997" rid="ref-simonsen1997markov" ref-type="bibr">Simonsen
  &amp; Churchill, 1997</xref>). If instead
  <inline-formula><alternatives>
  <tex-math><![CDATA[\rho]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>Ï</mml:mi></mml:math></alternatives></inline-formula>
  is large, then most of the samples will result in
  <inline-formula><alternatives>
  <tex-math><![CDATA[T_{\text{left}}\neq T_{\text{right}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>â‰ </mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>
  (<xref alt="[fig:fig2]" rid="figU003Afig2">[fig:fig2]</xref>,
  right).</p>
  <code language="r script"># Simulation from the joint distribution
subintensity_matrix_09 &lt;- ARG_subint_mat(0.166)
Tab_09 &lt;- MPH(subintensity_matrix_09, initial_probabilities,
              matrix(c(reward_left, reward_right), nrow=5))
subintensity_matrix_01 &lt;- ARG_subint_mat(11.316)
Tab_01 &lt;- MPH(subintensity_matrix_01, initial_probabilities,
              matrix(c(reward_left, reward_right), nrow=5))
set.seed(3)
rTab_09 &lt;- rMPH(1000, Tab_09)
rTab_01 &lt;- rMPH(1000, Tab_01)</code>
  <fig>
    <caption><p>Random samples from the two-locus ancestral
    recombination graph. Left: recombination rate
    <inline-formula><alternatives>
    <tex-math><![CDATA[\rho=0.166]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>0.166</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[P(T_{\text{left}}=T_{\text{right}})=0.9]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
    Right: recombination rate <inline-formula><alternatives>
    <tex-math><![CDATA[\rho=11.316]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>Ï</mml:mi><mml:mo>=</mml:mo><mml:mn>11.316</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>
    and <inline-formula><alternatives>
    <tex-math><![CDATA[P(T_{\text{left}}=T_{\text{right}})=0.1]]></tex-math>
    <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">left</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mtext mathvariant="normal">right</mml:mtext></mml:msub><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.
    <styled-content id="figU003Afig2"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="media/fig_simonsen_cor.pdf" />
  </fig>
</sec>
<sec id="conclusion">
  <title>Conclusion</title>
  <p>We have described <monospace>PhaseTypeR</monospace>, an easy-to-use
  package for the analysis of time-homogeneous evolutionary models in
  population genetics. We have included two examples: (1) the mean and
  variance for the SFS of the <inline-formula><alternatives>
  <tex-math><![CDATA[n]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>n</mml:mi></mml:math></alternatives></inline-formula>-coalescent
  with mutation, and (2) the correlation for the tree height in the
  two-locus coalescent with recombination. The multiple merger
  coalescent
  (<xref alt="Birkner &amp; Blath, 2021" rid="ref-birkner2021genealogies" ref-type="bibr">Birkner
  &amp; Blath, 2021</xref>), the two-island model
  (<xref alt="Legried &amp; Terhorst, 2022" rid="ref-legried2022rates" ref-type="bibr">Legried
  &amp; Terhorst, 2022</xref>) and the seed bank coalescent
  (<xref alt="Casanova et al., 2022" rid="ref-casanova2022shape" ref-type="bibr">Casanova
  et al., 2022</xref>) constitute other coalescent models where
  phase-type analyses have been useful. We hope that population
  geneticists will take advantage of <monospace>PhaseTypeR</monospace>
  in future analyses of coalescent models.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We are grateful to Emil Dare, MoisÃ¨s Coll MaciÃ , Kasper Munch and
  Mikkel Heide Schierup for valuable comments and suggestions that
  helped improve the manuscript.</p>
</sec>
</body>
<back>
<ref-list>
  <ref id="ref-bladt2017matrix">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Bladt</surname><given-names>Mogens</given-names></name>
        <name><surname>Nielsen</surname><given-names>Bo Friis</given-names></name>
      </person-group>
      <source>Matrix-exponential distributions in applied probability</source>
      <publisher-name>Springer-Verlag</publisher-name>
      <year iso-8601-date="2017">2017</year>
      <volume>81</volume>
      <isbn>978-1-4939-8377-3</isbn>
      <pub-id pub-id-type="doi">10.1007/978-1-4939-7049-0</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-hobolth2019phase">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hobolth</surname><given-names>Asger</given-names></name>
        <name><surname>Siri-Jegousse</surname><given-names>Arno</given-names></name>
        <name><surname>Bladt</surname><given-names>Mogens</given-names></name>
      </person-group>
      <article-title>Phase-type distributions in population genetics</article-title>
      <source>Theoretical population biology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>127</volume>
      <pub-id pub-id-type="doi">10.1016/j.tpb.2019.02.001</pub-id>
      <fpage>16</fpage>
      <lpage>32</lpage>
    </element-citation>
  </ref>
  <ref id="ref-dutang2008actuar">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Dutang</surname><given-names>Christophe</given-names></name>
        <name><surname>Goulet</surname><given-names>Vincent</given-names></name>
        <name><surname>Pigeon</surname><given-names>Mathieu</given-names></name>
      </person-group>
      <article-title>Actuar: An r package for actuarial science</article-title>
      <source>Journal of Statistical software</source>
      <year iso-8601-date="2008">2008</year>
      <volume>25</volume>
      <pub-id pub-id-type="doi">10.18637/jss.v025.i07</pub-id>
      <fpage>1</fpage>
      <lpage>37</lpage>
    </element-citation>
  </ref>
  <ref id="ref-AlbrecherBladtYslas2020">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Albrecher</surname><given-names>HansjÃ¶rg</given-names></name>
        <name><surname>Bladt</surname><given-names>Mogens</given-names></name>
        <name><surname>Yslas</surname><given-names>Jorge</given-names></name>
      </person-group>
      <article-title>Fitting inhomogeneous phase-type distributions to data: The univariate and the multivariate case</article-title>
      <source>Scandinavian Journal of Statistics</source>
      <publisher-name>Wiley Online Library</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>49</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1111/sjos.12505</pub-id>
      <fpage>44</fpage>
      <lpage>77</lpage>
    </element-citation>
  </ref>
  <ref id="ref-albrecher_bladt_2019">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Albrecher</surname><given-names>HansjÃ¶rg</given-names></name>
        <name><surname>Bladt</surname><given-names>Mogens</given-names></name>
      </person-group>
      <article-title>Inhomogeneous phase-type distributions and heavy tails</article-title>
      <source>Journal of Applied Probability</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>56</volume>
      <issue>4</issue>
      <pub-id pub-id-type="doi">10.1017/jpr.2019.60</pub-id>
      <fpage>1044</fpage>
      <lpage>1064</lpage>
    </element-citation>
  </ref>
  <ref id="ref-okamura_dohi_2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Okamura</surname><given-names>H</given-names></name>
        <name><surname>Dohi</surname><given-names>T</given-names></name>
      </person-group>
      <article-title>PH fitting algorithm and its application to reliability engineering</article-title>
      <source>Journal of the Operations Research Society of Japan</source>
      <year iso-8601-date="2016">2016</year>
      <volume>59</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.15807/jorsj.59.72</pub-id>
      <fpage>72</fpage>
      <lpage>109</lpage>
    </element-citation>
  </ref>
  <ref id="ref-okamura_dohi_2015">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Okamura</surname><given-names>Hiroyuki</given-names></name>
        <name><surname>Dohi</surname><given-names>Tadashi</given-names></name>
      </person-group>
      <article-title>Mapfit: An r-based tool for PH/MAP parameter estimation</article-title>
      <source>Quantitative evaluation of systems</source>
      <person-group person-group-type="editor">
        <name><surname>Campos</surname><given-names>Javier</given-names></name>
        <name><surname>Haverkort</surname><given-names>Boudewijn R.</given-names></name>
      </person-group>
      <publisher-name>Springer International Publishing</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <isbn>978-3-319-22263-9</isbn>
      <pub-id pub-id-type="doi">10.1007/978-3-319-22264-6_7</pub-id>
      <fpage>105</fpage>
      <lpage>112</lpage>
    </element-citation>
  </ref>
  <ref id="ref-okamura2015mapfit">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Okamura</surname><given-names>Hiroyuki</given-names></name>
      </person-group>
      <source>Mapfit: A tool for PH/MAP parameter estimation</source>
      <year iso-8601-date="2015">2015</year>
      <uri>https://CRAN.R-project.org/package=mapfit</uri>
    </element-citation>
  </ref>
  <ref id="ref-HBA2021">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hobolth</surname><given-names>Asger</given-names></name>
        <name><surname>Bladt</surname><given-names>Mogens</given-names></name>
        <name><surname>Andersen</surname><given-names>Lars NÃ¸rvang</given-names></name>
      </person-group>
      <article-title>Multivariate phase-type theory for the site frequency spectrum</article-title>
      <source>Journal of Mathematical Biology</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <volume>83</volume>
      <issue>6</issue>
      <pub-id pub-id-type="doi">10.1007/s00285-021-01689-w</pub-id>
      <fpage>1</fpage>
      <lpage>28</lpage>
    </element-citation>
  </ref>
  <ref id="ref-navarro2019discrete">
    <element-citation publication-type="thesis">
      <person-group person-group-type="author">
        <name><surname>Campillo Navarro</surname><given-names>Azucena</given-names></name>
      </person-group>
      <article-title>Order statistics and multivariate discrete phase-type distributions.</article-title>
      <publisher-name>Technical University of Denmark (Copenhagen, Denmark). Department of Applied Mathematics; Computer Science. DTU Compute</publisher-name>
      <year iso-8601-date="2018">2018</year>
    </element-citation>
  </ref>
  <ref id="ref-durrett2008probability">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Durrett</surname><given-names>Richard</given-names></name>
      </person-group>
      <source>Probability models for DNA sequence evolution</source>
      <publisher-name>Springer</publisher-name>
      <year iso-8601-date="2008">2008</year>
      <volume>2</volume>
      <pub-id pub-id-type="doi">10.1007/978-0-387-78168-6</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-wakeley2009coalescent">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <name><surname>Wakeley</surname><given-names>John</given-names></name>
      </person-group>
      <source>Coalescent Theory: An Introduction</source>
      <publisher-name>W. H. Freeman</publisher-name>
      <publisher-loc>New York, NY</publisher-loc>
      <year iso-8601-date="2009">2009</year>
      <isbn>078-0-9747077-5-4</isbn>
      <pub-id pub-id-type="doi">10.1093/schbul/syp004</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-wilton2015smc">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Wilton</surname><given-names>Peter R</given-names></name>
        <name><surname>Carmi</surname><given-names>Shai</given-names></name>
        <name><surname>Hobolth</surname><given-names>Asger</given-names></name>
      </person-group>
      <article-title>The SMCâ€™ is a highly accurate approximation to the ancestral recombination graph</article-title>
      <source>Genetics</source>
      <publisher-name>Oxford University Press</publisher-name>
      <year iso-8601-date="2015">2015</year>
      <volume>200</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1534/genetics.114.173898</pub-id>
      <fpage>343</fpage>
      <lpage>355</lpage>
    </element-citation>
  </ref>
  <ref id="ref-simonsen1997markov">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Simonsen</surname><given-names>Katy L</given-names></name>
        <name><surname>Churchill</surname><given-names>Gary A</given-names></name>
      </person-group>
      <article-title>A markov chain model of coalescence with recombination</article-title>
      <source>Theoretical population biology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="1997">1997</year>
      <volume>52</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1006/tpbi.1997.1307</pub-id>
      <fpage>43</fpage>
      <lpage>59</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Rcitation">
    <element-citation publication-type="book">
      <person-group person-group-type="author">
        <string-name>R Core Team</string-name>
      </person-group>
      <source>R: A language and environment for statistical computing</source>
      <publisher-name>R Foundation for Statistical Computing</publisher-name>
      <publisher-loc>Vienna, Austria</publisher-loc>
      <year iso-8601-date="2021">2021</year>
      <uri>https://www.R-project.org/</uri>
    </element-citation>
  </ref>
  <ref id="ref-fu1995statistical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Fu</surname><given-names>Yun-Xin</given-names></name>
      </person-group>
      <article-title>Statistical properties of segregating sites</article-title>
      <source>Theoretical population biology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="1995">1995</year>
      <volume>48</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1006/tpbi.1995.1025</pub-id>
      <fpage>172</fpage>
      <lpage>197</lpage>
    </element-citation>
  </ref>
  <ref id="ref-birkner2021genealogies">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Birkner</surname><given-names>Matthias</given-names></name>
        <name><surname>Blath</surname><given-names>Jochen</given-names></name>
      </person-group>
      <article-title>Genealogies and inference for populations with highly skewed offspring distributions</article-title>
      <source>Probabilistic structures in evolution</source>
      <person-group person-group-type="editor">
        <name><surname>Baake</surname><given-names>Ellen</given-names></name>
        <name><surname>Wakolbinger</surname><given-names>Anton</given-names></name>
      </person-group>
      <publisher-name>EMS Press</publisher-name>
      <year iso-8601-date="2021">2021</year>
      <pub-id pub-id-type="doi">10.4171/ECR/17-1/8</pub-id>
      <fpage>151</fpage>
      <lpage>178</lpage>
    </element-citation>
  </ref>
  <ref id="ref-casanova2022shape">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Casanova</surname><given-names>AdriÃ¡n GonzÃ¡lez</given-names></name>
        <name><surname>PeÃ±aloza</surname><given-names>Lizbeth</given-names></name>
        <name><surname>Siri-JÃ©gousse</surname><given-names>Arno</given-names></name>
      </person-group>
      <article-title>The shape of a seed bank tree</article-title>
      <source>Journal of Applied Probability</source>
      <publisher-name>Cambridge University Press</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>59</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1017/jpr.2021.79</pub-id>
      <fpage>631</fpage>
      <lpage>651</lpage>
    </element-citation>
  </ref>
  <ref id="ref-legried2022rates">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Legried</surname><given-names>Brandon</given-names></name>
        <name><surname>Terhorst</surname><given-names>Jonathan</given-names></name>
      </person-group>
      <article-title>Rates of convergence in the two-island and isolation-with-migration models</article-title>
      <source>Theoretical Population Biology</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>147</volume>
      <pub-id pub-id-type="doi">10.1016/j.tpb.2022.08.001</pub-id>
      <fpage>16</fpage>
      <lpage>27</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
