<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8296</article-id>
<article-id pub-id-type="doi">10.21105/joss.08296</article-id>
<title-group>
<article-title>aiida-aimall: A Python package for automating workflows
for AIMAll software</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-5291-1795</contrib-id>
<name>
<surname>Lefrancois-Gagnon</surname>
<given-names>Kevin M.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-6077-2403</contrib-id>
<name>
<surname>Mawhinney</surname>
<given-names>Robert C.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Lakehead University, Thunder Bay, ON, Canada</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-07-14">
<day>14</day>
<month>7</month>
<year>2024</year>
</pub-date>
<volume>10</volume>
<issue>116</issue>
<fpage>8296</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>AiiDA</kwd>
<kwd>Quantum Theory of Atoms in Molecules</kwd>
<kwd>AIMAll</kwd>
<kwd>Computational chemistry</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Since its introduction by Richard Bader, the Quantum Theory of
  Atoms in Molecules (QTAIM) has become a useful tool for computational
  chemists. This Python package provides plugins for a common QTAIM
  software, AIMAll, for the AiiDA Python infrastructure.
  <monospace>aiida-aimall</monospace> is an essential tool for ensuring
  reproducible calculations, with full generation history. Workflows are
  also provided to interface <monospace>AIMAll</monospace> software with
  any quantum chemistry package that can be run through the command
  line, so long as it generates the input files required by
  <monospace>AIMAll</monospace>.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p><monospace>aiida-aimall</monospace> is a Python package based on
  the AiiDA
  (<xref alt="Talirz et al., 2020" rid="ref-aiida" ref-type="bibr">Talirz
  et al., 2020</xref>) infrastructure designed to assist users with
  generating inputs for AIMAll software
  (<xref alt="Keith, 2019" rid="ref-AIMAll" ref-type="bibr">Keith,
  2019</xref>). The goal of the AiiDA infrastructure is, in part, to
  ensure data provenance and calculation reproducibility. While
  <monospace>aiida-aimall</monospace> has been developed primarily for
  interface with Gaussian software outputs
  (<xref alt="Frisch et al., 2016" rid="ref-gaussian" ref-type="bibr">Frisch
  et al., 2016</xref>), a versatile workflow enabling interface with
  other quantum chemistry packages is also made available. To the best
  of the authors’ knowledge, no tool for automatically linking the
  output of quantum chemistry packages with AIMAll while tracking data
  provenance exists. This tool significantly simplifies complex
  multi-step workflows such as substituent parameter generation into one
  simple step, easing the burden on the end user and allowing for
  high-throughput calculations.</p>
  <p>Through a variety of workflows that can start with an .xyz file,
  AiiDA <monospace>StructureData</monospace>, or even with a SMILES
  string of a molecule, <monospace>aiida-aimall</monospace> provides a
  variety of use cases for automating complex workflows. Additionally,
  tools to ensure that computers are not overloaded through too many
  simultaneous processes are made availabe through classes of
  <monospace>FromGroupSubmissionController</monospace>s from
  <monospace>aiida-submission-controller</monospace> to limit active
  processes.</p>
</sec>
<sec id="features">
  <title>Features</title>
  <p><monospace>aiida-aimall</monospace> contains many different classes
  from <monospace>aiida</monospace> tailored to ensure ease of use of
  AIMAll calculations. Numerous features provided by
  <monospace>aiida-aimall</monospace> are described in full on the
  <ext-link ext-link-type="uri" xlink:href="https://aiida-aimall.readthedocs.io/en/latest/">documentation
  webpage hosted on ReadTheDocs</ext-link>. A brief description of main
  features is provided here. For each of the types of workflows and
  calculations that follow, the inputs, outputs, and all processes (such
  as <monospace>calcfunctions</monospace> or
  <monospace>CalcJobs</monospace>) that occured in generating the
  results are added to a database to provide a record of the full
  calculation history and ensure reproducibility.</p>
  <sec id="running-simple-aimall-calculations">
    <title>Running Simple AIMAll Calculations</title>
    <p>The simplest functionality provided by
    <monospace>aiida-aimall</monospace> is running AIMAll calculations.
    All AIMAll calculations utilize the
    <monospace>AimqbParameters</monospace> datatype provided by
    <monospace>aiida-aimall</monospace>. The
    <monospace>AimqbParameters</monospace> datatype is a validator for
    <monospace>AIMAll</monospace> command line input. Command line
    parameters are to be provided as a dictionary, then
    <monospace>AimqbParameters</monospace> ensures that the parameters
    match options available for AIMAll software as
    <ext-link ext-link-type="uri" xlink:href="https://aim.tkgristmill.com/manual/aimqb/aimqb.html">defined
    on the software website</ext-link>, and that the correct data type
    is provided for each parameter. In this way,
    <monospace>AimqbParameters</monospace> verifies the provided input
    to AIMAll calculations prior to launch of the calculation. These
    parameters, along with <monospace>SinglefileData</monospace> of a
    valid AIMAll input file, a <monospace>Code</monospace> object for
    AIMAll software, and relevant metadata are provided to an
    <monospace>AimqbCalculation</monospace>.</p>
    <p>This functionality in itself is an overcomplication of the simple
    process of running the software normally. However, it does have some
    benefits. The output is already extracted and stored in the database
    in a readily usable manner through the use of the
    <monospace>AimqbBaseParser</monospace>. It is now simple to see the
    history of the calculation.</p>
  </sec>
  <sec id="substituent-properties">
    <title>Substituent Properties</title>
    <p>Some of the workflows in <monospace>aiida-aimall</monospace>
    automate calculation of substituent properties from AIMAll output.
    These substituent properties have been developed by the
    authors.(<xref alt="Lefrancois-Gagnon &amp; Mawhinney, 2023" rid="ref-klg" ref-type="bibr">Lefrancois-Gagnon
    &amp; Mawhinney, 2023</xref>) The
    <monospace>SubstituentParameterWorkChain</monospace> does this
    automatically, and any routine AIMAll calculation can make use of
    this by using the <monospace>AimqbGroupParser</monospace>, which can
    be provided in metadata input to
    <monospace>AimqbCalculation</monospace> as an entry in the metadata
    dictionary:
    <monospace>metadata.options.parser_name:'aimall.group'</monospace>.
    A detailed description of the calculated substituent properties is
    available
    <ext-link ext-link-type="uri" xlink:href="https://aiida-aimall.readthedocs.io/en/latest/tutorials/aimqbgroupcalculation.html">in
    a tutorial in the documentation.</ext-link> AIMAll integrated and
    graph properties are obtained.</p>
  </sec>
  <sec id="integrations-with-computational-chemistry-software">
    <title>Integrations with Computational Chemistry Software</title>
    <p><monospace>aiida-aimall</monospace>’s main draw is that it
    enables automation to link the outputs of standard computational
    chemistry software directly to an AIMAll calculation. A list of
    provided workflows is shown in Table 1. The software with the most
    robust implementation is Gaussian
    software,(<xref alt="Frisch et al., 2016" rid="ref-gaussian" ref-type="bibr">Frisch
    et al., 2016</xref>) as Gaussian already has an implemented
    <monospace>aiida</monospace> package. Other computational chemistry
    software like ORCA can be run through the
    <monospace>QMToAIMWorkchain</monospace>, which uses
    <monospace>aiida-shell</monospace> to run software than can be run
    through the command line. These workflow inputs, outputs and
    processes aer illustrated in the provenance graph in
    <xref alt="[fig:qmwf]" rid="figU003Aqmwf">[fig:qmwf]</xref>. If
    .molden or .cp2k.out output formats are available, one could
    alternatively use these to generate the needed .wfx files for
    AIMAll, and automatically run AIMAll through the
    <monospace>GenerateWFXToAIMWorkchain</monospace>.</p>
    <fig>
      <caption><p>Database inputs, outputs, and process of the
      <monospace>GaussianToAimWorkchain</monospace>.<styled-content id="figU003Aqmwf"></styled-content></p></caption>
      <graphic mimetype="image" mime-subtype="png" xlink:href="tutorials_quantumsoftware_3_0.png" />
    </fig>
    <p>Table 1: Main workflows provided by
    <monospace>aiida-aimall</monospace>, their
    <monospace>aiida</monospace> entry points that can be used to load
    them by <monospace>aiida.plugins.WorkflowFactory</monospace>, and a
    brief description. These workflows all end with the output of an
    <monospace>AimqbCalculation</monospace> as their main output.</p>
    <table-wrap>
      <table>
        <colgroup>
          <col width="40%" />
          <col width="21%" />
          <col width="37%" />
        </colgroup>
        <thead>
          <tr>
            <th align="center">Workflow</th>
            <th align="center">Entry Point</th>
            <th align="center">Purpose</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td align="center"><monospace>QMToAIMWorkchain</monospace></td>
            <td align="center">aimall.qmtoaim</td>
            <td align="center">Run a general
            computational<break/>chemistry software and link<break/>it
            to an AIMAll<break/>calculation</td>
          </tr>
          <tr>
            <td align="center"><monospace>GenerateWFXToAIMWorkchain</monospace></td>
            <td align="center">aimall.wfxtoaim</td>
            <td align="center">Take non-standard AIMAlll<break/>input
            files, and run AIMAll</td>
          </tr>
          <tr>
            <td align="center"><monospace>GaussianToAIMWorkChain</monospace></td>
            <td align="center">aimall.g16toaim</td>
            <td align="center">Run a Gaussian calculationl<break/>and
            automatically run<break/>an AIMAll calculation on<break/>its
            outputs</td>
          </tr>
          <tr>
            <td align="center"><monospace>SubstituentParameterWorkChain</monospace></td>
            <td align="center">aimall.subparam</td>
            <td align="center">Compute substituent<break/>properties
            defined by<break/>the authors automatically</td>
          </tr>
        </tfoot>
        <tbody>
        </tbody>
      </table>
    </table-wrap>
  </sec>
  <sec id="controllers-to-limit-computer-burden-when-running-large-numbers-of-jobs">
    <title>Controllers to limit computer burden when running large
    numbers of jobs</title>
    <p>The last main contribution of <monospace>aiida-aimall</monospace>
    is through the definition of controllers from the
    <monospace>aiida-submission-controller</monospace> package. These
    controllers limit active processes and can be used together as
    demonstrated in
    <ext-link ext-link-type="uri" xlink:href="https://aiida-aimall.readthedocs.io/en/latest/tutorials/controllers.html">a
    tutorial notebook</ext-link> to automate the entire
    <monospace>SubstituentParameterWorkchain</monospace>. These use a
    number of <monospace>Workchains</monospace> developed just for their
    use in these controllers. The process flows as
    <monospace>SmilesToGaussianController</monospace> -&gt;
    <monospace>AIMAllReorController</monospace> -&gt;
    <monospace>GaussianController</monospace> -&gt;
    <monospace>AIMAllController</monospace>. The latter two controllers
    can also be seen and used as general use controllers wrapping
    <monospace>GaussianCalculations</monospace> and
    <monospace>AimqbCalculations</monospace></p>
  </sec>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We acknowledge the National Science and Engineering Research
  Council of Canada (grant RGPIN-2022-05060), and the Northern Ontario
  Heritage Fund Corporation (grant 7401278) for financial support.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-aiida">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Talirz</surname><given-names>Leopold</given-names></name>
        <name><surname>Kahle</surname><given-names>Leonid</given-names></name>
        <name><surname>Häuselmann</surname><given-names>Rico</given-names></name>
        <name><surname>Gresch</surname><given-names>Dominik</given-names></name>
        <name><surname>Müller</surname><given-names>Tiziano</given-names></name>
        <name><surname>Yakutovich</surname><given-names>Aliaksandr V.</given-names></name>
        <name><surname>Andersen</surname><given-names>Casper W.</given-names></name>
        <name><surname>Ramirez</surname><given-names>Francisco F.</given-names></name>
        <name><surname>Adorf</surname><given-names>Carl S.</given-names></name>
        <name><surname>Gargiulo</surname><given-names>Fernando</given-names></name>
        <name><surname>Kumbhar</surname><given-names>Snehal</given-names></name>
        <name><surname>Passaro</surname><given-names>Elsa</given-names></name>
        <name><surname>Johnston</surname><given-names>Conrad</given-names></name>
        <name><surname>Merkys</surname><given-names>Andrius</given-names></name>
        <name><surname>Cepellotti</surname><given-names>Andrea</given-names></name>
        <name><surname>Mounet</surname><given-names>Nicolas</given-names></name>
        <name><surname>Marzari</surname><given-names>Nicola</given-names></name>
        <name><surname>Kozinsky</surname><given-names>Boris</given-names></name>
        <name><surname>Pizzi</surname><given-names>Giovanni</given-names></name>
      </person-group>
      <article-title>AiiDA 1.0, a scalable computational infrastructure for automated reproducible workflows and data provenance </article-title>
      <source>Scientific Data</source>
      <year iso-8601-date="2020">2020</year>
      <volume>7</volume>
      <pub-id pub-id-type="doi">10.1038/s41597-020-00638-4</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-klg">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Lefrancois-Gagnon</surname><given-names>Kevin M.</given-names></name>
        <name><surname>Mawhinney</surname><given-names>Robert C.</given-names></name>
      </person-group>
      <article-title>Toward Universal Substituent Constants: Relating QTAIM Functional Group Descriptors to Substituent Effect Proxies</article-title>
      <source>Journal of Chemical Information and Modeling</source>
      <year iso-8601-date="2023">2023</year>
      <volume>63</volume>
      <pub-id pub-id-type="doi">10.1021/acs.jcim.3c00987</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-AIMAll">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <name><surname>Keith</surname><given-names>Todd A.</given-names></name>
      </person-group>
      <article-title>AIMAll</article-title>
      <publisher-name>TK Gristmill Software</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <uri>aim.tkgristmill.com</uri>
    </element-citation>
  </ref>
  <ref id="ref-gaussian">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Frisch</surname><given-names>M. J.</given-names></name>
        <name><surname>Trucks</surname><given-names>G. W.</given-names></name>
        <name><surname>Schlegel</surname><given-names>H. B.</given-names></name>
        <name><surname>Scuseria</surname><given-names>G. E.</given-names></name>
        <name><surname>Robb</surname><given-names>M. A.</given-names></name>
        <name><surname>Cheeseman</surname><given-names>J. R.</given-names></name>
        <name><surname>Scalmani</surname><given-names>G.</given-names></name>
        <name><surname>Barone</surname><given-names>V.</given-names></name>
        <name><surname>Petersson</surname><given-names>G. A.</given-names></name>
        <name><surname>Nakatsuji</surname><given-names>H.</given-names></name>
        <name><surname>Li</surname><given-names>X.</given-names></name>
        <name><surname>Caricato</surname><given-names>M.</given-names></name>
        <name><surname>Marenich</surname><given-names>A. V.</given-names></name>
        <name><surname>Bloino</surname><given-names>J.</given-names></name>
        <name><surname>Janesko</surname><given-names>B. G.</given-names></name>
        <name><surname>Gomperts</surname><given-names>R.</given-names></name>
        <name><surname>Mennucci</surname><given-names>B.</given-names></name>
        <name><surname>Hratchian</surname><given-names>H. P.</given-names></name>
        <name><surname>Ortiz</surname><given-names>J. V.</given-names></name>
        <name><surname>Izmaylov</surname><given-names>A. F.</given-names></name>
        <name><surname>Sonnenberg</surname><given-names>J. L.</given-names></name>
        <name><surname>Williams-Young</surname><given-names>D.</given-names></name>
        <name><surname>Ding</surname><given-names>F.</given-names></name>
        <name><surname>Lipparini</surname><given-names>F.</given-names></name>
        <name><surname>Egidi</surname><given-names>F.</given-names></name>
        <name><surname>Goings</surname><given-names>J.</given-names></name>
        <name><surname>Peng</surname><given-names>B.</given-names></name>
        <name><surname>Petrone</surname><given-names>A.</given-names></name>
        <name><surname>Henderson</surname><given-names>T.</given-names></name>
        <name><surname>Ranasinghe</surname><given-names>D.</given-names></name>
        <name><surname>Zakrzewski</surname><given-names>V. G.</given-names></name>
        <name><surname>Gao</surname><given-names>J.</given-names></name>
        <name><surname>Rega</surname><given-names>N.</given-names></name>
        <name><surname>Zheng</surname><given-names>G.</given-names></name>
        <name><surname>Liang</surname><given-names>W.</given-names></name>
        <name><surname>Hada</surname><given-names>M.</given-names></name>
        <name><surname>Ehara</surname><given-names>M.</given-names></name>
        <name><surname>Toyota</surname><given-names>K.</given-names></name>
        <name><surname>Fukuda</surname><given-names>R.</given-names></name>
        <name><surname>Hasegawa</surname><given-names>J.</given-names></name>
        <name><surname>Ishida</surname><given-names>M.</given-names></name>
        <name><surname>Nakajima</surname><given-names>T.</given-names></name>
        <name><surname>Honda</surname><given-names>Y.</given-names></name>
        <name><surname>Kitao</surname><given-names>O.</given-names></name>
        <name><surname>Nakai</surname><given-names>H.</given-names></name>
        <name><surname>Vreven</surname><given-names>T.</given-names></name>
        <name><surname>Throssell</surname><given-names>K.</given-names></name>
        <name><surname>Montgomery</surname><given-names>J. A.</given-names><suffix>Jr.</suffix></name>
        <name><surname>Peralta</surname><given-names>J. E.</given-names></name>
        <name><surname>Ogliaro</surname><given-names>F.</given-names></name>
        <name><surname>Bearpark</surname><given-names>M. J.</given-names></name>
        <name><surname>Heyd</surname><given-names>J. J.</given-names></name>
        <name><surname>Brothers</surname><given-names>E. N.</given-names></name>
        <name><surname>Kudin</surname><given-names>K. N.</given-names></name>
        <name><surname>Staroverov</surname><given-names>V. N.</given-names></name>
        <name><surname>Keith</surname><given-names>T. A.</given-names></name>
        <name><surname>Kobayashi</surname><given-names>R.</given-names></name>
        <name><surname>Normand</surname><given-names>J.</given-names></name>
        <name><surname>Raghavachari</surname><given-names>K.</given-names></name>
        <name><surname>Rendell</surname><given-names>A. P.</given-names></name>
        <name><surname>Burant</surname><given-names>J. C.</given-names></name>
        <name><surname>Iyengar</surname><given-names>S. S.</given-names></name>
        <name><surname>Tomasi</surname><given-names>J.</given-names></name>
        <name><surname>Cossi</surname><given-names>M.</given-names></name>
        <name><surname>Millam</surname><given-names>J. M.</given-names></name>
        <name><surname>Klene</surname><given-names>M.</given-names></name>
        <name><surname>Adamo</surname><given-names>C.</given-names></name>
        <name><surname>Cammi</surname><given-names>R.</given-names></name>
        <name><surname>Ochterski</surname><given-names>J. W.</given-names></name>
        <name><surname>Martin</surname><given-names>R. L.</given-names></name>
        <name><surname>Morokuma</surname><given-names>K.</given-names></name>
        <name><surname>Farkas</surname><given-names>O.</given-names></name>
        <name><surname>Foresman</surname><given-names>J. B.</given-names></name>
        <name><surname>Fox</surname><given-names>D. J.</given-names></name>
      </person-group>
      <article-title>Gaussian˜16 Revision C.01</article-title>
      <year iso-8601-date="2016">2016</year>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
