<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">6354</article-id>
<article-id pub-id-type="doi">10.21105/joss.06354</article-id>
<title-group>
<article-title>ScatteringOptics.jl: An Interstellar Scattering Framework
in the Julia Programming Language</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9229-8833</contrib-id>
<name>
<surname>Tartaglia</surname>
<given-names>Anna</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-9475-4254</contrib-id>
<name>
<surname>Akiyama</surname>
<given-names>Kazunori</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
<xref ref-type="aff" rid="aff-4"/>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3826-5648</contrib-id>
<name>
<surname>Tiede</surname>
<given-names>Paul</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Center for Astrophysics | Harvard &amp;
Smithsonian</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Massachusetts Institute of Technology Haystack
Observatory</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>The Pennsylvania State University</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>National Astronomical Observatory of Japan</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>Black Hole Initiative at Harvard University</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2023-12-14">
<day>14</day>
<month>12</month>
<year>2023</year>
</pub-date>
<volume>10</volume>
<issue>105</issue>
<fpage>6354</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Julia</kwd>
<kwd>Astronomy</kwd>
<kwd>VLBI</kwd>
<kwd>Black Holes</kwd>
<kwd>Radio Astronomy</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p><monospace>ScatteringOptics.jl</monospace> is an astronomy software
  package developed in the Julia programming language
  (<xref alt="Bezanson et al., 2012" rid="ref-Bezanson_2012" ref-type="bibr">Bezanson
  et al., 2012</xref>). It implements physical models for the
  anisotropic scattering of radio waves, which arise from turbulence in
  the ionized interstellar medium. This toolkit excels in simulating and
  modeling the temporal, spatial, and spectral effects of interstellar
  scintillation in the strong scattering regime, taking advantage of
  Julia’s speed and composability. The package provides essential
  functionalities for modeling, analyzing, and interpreting the images
  of the Galactic Center’s supermassive black hole, Sagittarius A*,
  especially with the Event Horizon Telescope, as well as the images of
  extremely high brightness temperature emissions in active galactic
  nuclei using space very long baseline interferometry.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of Need</title>
  <p>Scintillation is a well-known phenomenon in astronomy. In radio
  wavelengths, electron density fluctuations in the ionized interstellar
  plasma cause scattering of radio waves, resulting in the scintillation
  of compact radio sources in the sky
  (<xref alt="Narayan, 1992" rid="ref-Narayan_1992" ref-type="bibr">Narayan,
  1992</xref>;
  <xref alt="Rickett, 1990" rid="ref-Rickett_1990" ref-type="bibr">Rickett,
  1990</xref>). The interstellar scintillation produces temporal and
  spectral modulations (i.e., twinkling) in the brightness of objects,
  as well as distortion of the source images. Interstellar scattering of
  radio emission typically occurs in the strong scattering regime,
  dominated by two distinct effects: diffractive and refractive
  scattering. Diffractive scattering, arising from small-scale
  fluctuations, typically causes angular broadening of the source image.
  Conversely, refractive scattering, resulting from large-scale
  fluctuations, introduces 'refractive substructures' into the observed
  image
  (<xref alt="Goodman &amp; Narayan, 1989" rid="ref-GN_1989" ref-type="bibr">Goodman
  &amp; Narayan, 1989</xref>;
  <xref alt="Johnson &amp; Gwinn, 2015" rid="ref-Johnson_2015" ref-type="bibr">Johnson
  &amp; Gwinn, 2015</xref>;
  <xref alt="Narayan &amp; Goodman, 1989" rid="ref-NG_1989" ref-type="bibr">Narayan
  &amp; Goodman, 1989</xref>).</p>
  <p>Scattering has become increasingly important in
  high-angular-resolution studies of compact radio sources at
  micro-arcsecond scales using very long baseline interferometry (VLBI).
  Notable examples include event-horizon-scale imaging of the Milky
  Way’s supermassive black hole, Sagittarius A* (Sgr A*), with the Event
  Horizon Telescope
  (<xref alt="Event Horizon Telescope Collaboration et al., 2022a" rid="ref-EHTSgrAPaper1" ref-type="bibr">Event
  Horizon Telescope Collaboration et al., 2022a</xref>,
  <xref alt="2022c" rid="ref-EHTSgrAPaper3" ref-type="bibr">2022c</xref>,
  <xref alt="2022d" rid="ref-EHTSgrAPaper4" ref-type="bibr">2022d</xref>),
  and studies of extremely high brightness temperature emissions in
  active galactic nuclei (AGNs) using space VLBI, exemplified by
  projects like RadioAstron
  (<xref alt="Johnson et al., 2016" rid="ref-Johnson_2016_3C273" ref-type="bibr">Johnson
  et al., 2016</xref>). In both scenarios, the observed interferometric
  data is influenced by both diffractive and refractive scattering
  effects. This has driven the development of a theoretical framework
  (<xref alt="Johnson, 2016" rid="ref-Johnson_2016" ref-type="bibr">Johnson,
  2016</xref>;
  <xref alt="Johnson et al., 2018" rid="ref-Johnson_2018" ref-type="bibr">Johnson
  et al., 2018</xref>;
  <xref alt="Johnson &amp; Narayan, 2016" rid="ref-Johnson_Narayan_2016" ref-type="bibr">Johnson
  &amp; Narayan, 2016</xref>;
  <xref alt="Psaltis et al., 2018" rid="ref-Psaltis_2018" ref-type="bibr">Psaltis
  et al., 2018</xref>) that can model, simulate, and assess these
  effects on both the sky images and the interferometric
  measurements.</p>
  <p><monospace>ScatteringOptics.jl</monospace> implements physical
  models for anisotropic interstellar scattering, based on the fast
  'stochastic optics' framework, using a single thin-phase screen
  (<xref alt="Johnson &amp; Gwinn, 2015" rid="ref-Johnson_2015" ref-type="bibr">Johnson
  &amp; Gwinn, 2015</xref>;
  <xref alt="Johnson &amp; Narayan, 2016" rid="ref-Johnson_Narayan_2016" ref-type="bibr">Johnson
  &amp; Narayan, 2016</xref>). The package offers capabilities to
  simulate diffractive and refractive scattering effects on sky images
  and interferometric measurements. It provides reference
  implementations of three different analytic, probabilistic models for
  the phase screen, as introduced in Psaltis et al.
  (<xref alt="2018" rid="ref-Psaltis_2018" ref-type="bibr">2018</xref>)
  and widely used in the community. Additionally,
  <monospace>ScatteringOptics.jl</monospace> includes a set of abstract
  types that enable users to define other phase screen models. Designed
  for seamless integration, the package natively works with sky models
  and interferometric data types from the advanced Bayesian radio
  interferometric modeling package <monospace>Comrade.jl</monospace>
  (<xref alt="Tiede, 2022" rid="ref-Tiede_2022" ref-type="bibr">Tiede,
  2022</xref>). This integration allows for the incorporation of
  advanced scattering models into radio interferometric imaging of Sgr
  A* and other AGNs using the EHT and other VLBI arrays.</p>
  <p>The package leverages the strengths of the Julia programming
  language, which is designed for high-performance computing. A major
  advantage of Julia is its speed. Programs written in Julia are
  compiled into efficient native machine code, offering speed comparable
  to optimized C/C++ or Fortran, and often achieving performance more
  than a hundred times faster than Python. This speed provides a factor
  of 10-100 acceleration compared to the current standard implementation
  of scattering models in Python. This acceleration significantly
  enhances current state-of-the-art techniques for deriving the maximum
  posteriori estimate of joint models, including the sky model and phase
  screens
  (<xref alt="Johnson, 2016" rid="ref-Johnson_2016" ref-type="bibr">Johnson,
  2016</xref>), and also enables the utilization of novel Bayesian
  inference techniques (available in <monospace>Comrade.jl</monospace>
  and related libraries) for deriving full posterior distributions of
  scattering parameters.</p>
</sec>
<sec id="mathematics">
  <title>Mathematics</title>
  <p><monospace>ScatteringOptics.jl</monospace> implements a single
  thin-screen scattering model described in Johnson et al.
  (<xref alt="2018" rid="ref-Johnson_2018" ref-type="bibr">2018</xref>)
  and Psaltis et al.
  (<xref alt="2018" rid="ref-Psaltis_2018" ref-type="bibr">2018</xref>)
  that simulates both diffractive and refractive scattering. In many
  instances, the properties of the interstellar scattering can be well
  described by a single, thin phase-changing screen
  <inline-formula><alternatives>
  <tex-math><![CDATA[\phi(r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  where <inline-formula><alternatives>
  <tex-math><![CDATA[r]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>r</mml:mi></mml:math></alternatives></inline-formula>
  is a two-dimensional transverse coordinate on the screen. The
  statistical characteristics of scattering can be described by those of
  the phase screen through its spatial structure function
  <inline-formula><alternatives>
  <tex-math><![CDATA[D_\phi(r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
  <p>Diffractive scattering causes the angular broadening of the source
  image. The diffractively scattered image
  <inline-formula><alternatives>
  <tex-math><![CDATA[{I_{ea}}(r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is mathematically given by the convolution of the source image
  <inline-formula><alternatives>
  <tex-math><![CDATA[{I_{src}}(r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  with a blurring scattering kernel, <inline-formula><alternatives>
  <tex-math><![CDATA[{G}(r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[{I_{ea}}(r) = {I_{src}}(r) * {G}(r),]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>*</mml:mo><mml:mi>G</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>In radio interferometry, each set of measurements, so-called
  visibilities, obtained with a pair of antennas at different time and
  frequency segments, samples a Fourier component of the sky image. The
  source visibilities, <inline-formula><alternatives>
  <tex-math><![CDATA[V_{src}(b)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  are related to the diffractively scattered visibilities,
  <inline-formula><alternatives>
  <tex-math><![CDATA[V_{ea}(b)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  by</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[V_{ea}(b) = V_{src}(b)\,\text{exp}\left[-\frac{1}{2} D_\phi\left(\frac{b}{1+M}\right)\right],]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>r</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mspace width="0.167em"></mml:mspace><mml:mtext mathvariant="normal">exp</mml:mtext><mml:mrow><mml:mo stretchy="true" form="prefix">[</mml:mo><mml:mi>−</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>D</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mfrac><mml:mi>b</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>in which <inline-formula><alternatives>
  <tex-math><![CDATA[b]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>b</mml:mi></mml:math></alternatives></inline-formula>
  is the baseline vector between observing stations. The magnification
  <inline-formula><alternatives>
  <tex-math><![CDATA[M=D/R]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>M</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>/</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>
  is the ratio of earth-scattering distance
  <inline-formula><alternatives>
  <tex-math><![CDATA[D]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>D</mml:mi></mml:math></alternatives></inline-formula>
  (i.e., the distance between earth and the scattering material) to
  scattering-source distance <inline-formula><alternatives>
  <tex-math><![CDATA[R]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>R</mml:mi></mml:math></alternatives></inline-formula>.
  While convolution is performed through the above equation in Fourier
  space, where the kernel is analytically described, Comrade.jl provides
  a tool kit to compute the kernel on the image domain through FFT, and
  blur arbitral sky models with this kernel.</p>
  <p>Refractive scattering further introduces compact substructures on
  the diffractively-scattered, angular-broadened images. The compact
  substructures arise from phase gradients on the scattering screen
  <inline-formula><alternatives>
  <tex-math><![CDATA[\nabla \phi(r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>∇</mml:mi><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  The refractively scattered image <inline-formula><alternatives>
  <tex-math><![CDATA[{I_{a}}(r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
  is given by</p>
  <p><disp-formula><alternatives>
  <tex-math><![CDATA[{I_{a}}(r) \approx {I_{ea}}(r + r_F^2 \nabla \phi(r)),]]></tex-math>
  <mml:math display="block" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo>+</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mi>∇</mml:mi><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula></p>
  <p>in which the Fresnel scale, <inline-formula><alternatives>
  <tex-math><![CDATA[r_F = \sqrt{\frac{DR}{D+R}\frac{\lambda}{2\pi}}]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>F</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mi>D</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>
  is dependent on the observing wavelength
  <inline-formula><alternatives>
  <tex-math><![CDATA[\lambda]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mi>λ</mml:mi></mml:math></alternatives></inline-formula>
  (<xref alt="Johnson &amp; Narayan, 2016" rid="ref-Johnson_Narayan_2016" ref-type="bibr">Johnson
  &amp; Narayan, 2016</xref>).</p>
  <p><monospace>ScatteringOptics.jl</monospace> implements three
  analytic probabilistic models for the phase screen
  <inline-formula><alternatives>
  <tex-math><![CDATA[\phi(r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>,
  named Dipole, Periodic Boxcar, and Von Mises models in Psaltis et al.
  (<xref alt="2018" rid="ref-Psaltis_2018" ref-type="bibr">2018</xref>),
  providing the corresponding semi-analytic descriptions of the phase
  structure function <inline-formula><alternatives>
  <tex-math><![CDATA[D_\phi(r)]]></tex-math>
  <mml:math display="inline" xmlns:mml="http://www.w3.org/1998/Math/MathML"><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="true" form="prefix">(</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="true" form="postfix">)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.
  The default model is the Dipole model, known to be consistent with
  multi-frequency measurements of Sgr A*
  (<xref alt="Johnson et al., 2018" rid="ref-Johnson_2018" ref-type="bibr">Johnson
  et al., 2018</xref>) and being used as the standard model in the Event
  Horizon Telescope Collaboration
  (<xref alt="Event Horizon Telescope Collaboration et al., 2022b" rid="ref-EHTSgrAPaper2" ref-type="bibr">Event
  Horizon Telescope Collaboration et al., 2022b</xref>,
  <xref alt="2022c" rid="ref-EHTSgrAPaper3" ref-type="bibr">2022c</xref>,
  <xref alt="2022d" rid="ref-EHTSgrAPaper4" ref-type="bibr">2022d</xref>).</p>
</sec>
<sec id="example-usage">
  <title>Example Usage</title>
  <p>This example code segment uses ScatteringOptics.jl to simulate
  interstellar scattering on an input skymodel of
  <ext-link ext-link-type="uri" xlink:href="https://github.com/ptiede/Comrade.jl">Comrade.jl</ext-link>
  (<xref alt="Tiede, 2022" rid="ref-Tiede_2022" ref-type="bibr">Tiede,
  2022</xref>). More detailed tutorials are available in the software
  documentation.</p>
  <preformat>using CairoMakie
using ScatteringOptics 
using StableRNGs
using VLBISkyModels

# Load a image model from an image FITS file
# This FITS file is available in the tutorial pages of the
# software documentation.
im = load_fits(&quot;data/jason_mad_eofn.fits&quot;, IntensityMap)

# Plot source image
imageviz(im, size=(600, 500), colormap=:afmhot)</preformat>
  <fig>
    <caption><p>Output of above code plotting an example unscattered
    source image (obtained from
    <xref alt="Dexter, 2014" rid="ref-Dexter_2014" ref-type="bibr">Dexter,
    2014</xref>).</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="src.png" />
  </fig>
  <preformat># Initialize a scattering model (the default is a Dipole model)
# The default model is a Dipole model with the best-fit parameters
# for the Milky Way supermassive black hole Sgr A*
sm = ScatteringModel()

# Here using StableRNG for the reproducibility
rng = StableRNG(123)

# Create a refractive phase screen model from scattering model
# and image dimensions
# Produce the scattered image
im_sc = scatter_image(sm, im; rng=rng)

# Plot source image
imageviz(im_sc, size=(600, 500), colormap=:afmhot)</preformat>
  <fig>
    <caption><p>Output of above code plotting the output scattered
    image.</p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="avg.png" />
  </fig>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We thank Dongjin Kim and Vincent Fish for their helpful discussions
  related to the development of this package. This work was made
  possible by grants from the National Science Foundation (NSF;
  AST-1950348 and AST-2034306). K.A. and P.T. have been financially
  supported also by other NSF grants (AST-1935980, OMA-2029670,
  AST-2107681, AST-2132700). The Black Hole Initiative at Harvard
  University is funded by grants from the John Templeton Foundation and
  the Gordon and Betty Moore Foundation to Harvard University.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-Johnson_2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>Michael D.</given-names></name>
        <name><surname>Gwinn</surname><given-names>Carl R.</given-names></name>
      </person-group>
      <article-title>Theory and Simulations of Refractive Substructure in Resolved Scatter-broadened Images</article-title>
      <source>Astrophysical Journal</source>
      <year iso-8601-date="2015-06">2015</year><month>06</month>
      <volume>805</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/1502.05722</uri>
      <pub-id pub-id-type="doi">10.1088/0004-637X/805/2/180</pub-id>
      <fpage>180</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Johnson_2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>Michael D.</given-names></name>
      </person-group>
      <article-title>Stochastic Optics: A Scattering Mitigation Framework for Radio Interferometric Imaging</article-title>
      <source>Astrophysical Journal</source>
      <year iso-8601-date="2016-12">2016</year><month>12</month>
      <volume>833</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1610.05326</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/833/1/74</pub-id>
      <fpage>74</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Johnson_2016_3C273">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>Michael D.</given-names></name>
        <name><surname>Kovalev</surname><given-names>Yuri Y.</given-names></name>
        <name><surname>Gwinn</surname><given-names>Carl R.</given-names></name>
        <name><surname>Gurvits</surname><given-names>Leonid I.</given-names></name>
        <name><surname>Narayan</surname><given-names>Ramesh</given-names></name>
        <name><surname>Macquart</surname><given-names>Jean-Pierre</given-names></name>
        <name><surname>Jauncey</surname><given-names>David L.</given-names></name>
        <name><surname>Voitsik</surname><given-names>Peter A.</given-names></name>
        <name><surname>Anderson</surname><given-names>James M.</given-names></name>
        <name><surname>Sokolovsky</surname><given-names>Kirill V.</given-names></name>
        <name><surname>Lisakov</surname><given-names>Mikhail M.</given-names></name>
      </person-group>
      <article-title>Extreme Brightness Temperatures and Refractive Substructure in 3C273 with RadioAstron</article-title>
      <source>Astrophysical Journal, Letters</source>
      <year iso-8601-date="2016-03">2016</year><month>03</month>
      <volume>820</volume>
      <issue>1</issue>
      <uri>https://arxiv.org/abs/1601.05810</uri>
      <pub-id pub-id-type="doi">10.3847/2041-8205/820/1/L10</pub-id>
      <fpage>L10</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Johnson_Narayan_2016">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>Michael D.</given-names></name>
        <name><surname>Narayan</surname><given-names>Ramesh</given-names></name>
      </person-group>
      <article-title>The Optics of Refractive Substructure</article-title>
      <source>Astrophysical Journal</source>
      <year iso-8601-date="2016-08">2016</year><month>08</month>
      <volume>826</volume>
      <issue>2</issue>
      <uri>https://arxiv.org/abs/1606.06315</uri>
      <pub-id pub-id-type="doi">10.3847/0004-637X/826/2/170</pub-id>
      <fpage>170</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Johnson_2018">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Johnson</surname><given-names>Michael D.</given-names></name>
        <name><surname>Narayan</surname><given-names>Ramesh</given-names></name>
        <name><surname>Psaltis</surname><given-names>Dimitrios</given-names></name>
        <name><surname>Blackburn</surname><given-names>Lindy</given-names></name>
        <name><surname>Kovalev</surname><given-names>Yuri Y.</given-names></name>
        <name><surname>Gwinn</surname><given-names>Carl R.</given-names></name>
        <name><surname>Zhao</surname><given-names>Guang-Yao</given-names></name>
        <name><surname>Bower</surname><given-names>Geoffrey C.</given-names></name>
        <name><surname>Moran</surname><given-names>James M.</given-names></name>
        <name><surname>Kino</surname><given-names>Motoki</given-names></name>
        <name><surname>Kramer</surname><given-names>Michael</given-names></name>
        <name><surname>Akiyama</surname><given-names>Kazunori</given-names></name>
        <name><surname>Dexter</surname><given-names>Jason</given-names></name>
        <name><surname>Broderick</surname><given-names>Avery E.</given-names></name>
        <name><surname>Sironi</surname><given-names>Lorenzo</given-names></name>
      </person-group>
      <article-title>The scattering and intrinsic structure of sagittarius a* at radio wavelengths</article-title>
      <source>The Astrophysical Journal</source>
      <publisher-name>The American Astronomical Society</publisher-name>
      <year iso-8601-date="2018-09">2018</year><month>09</month>
      <volume>865</volume>
      <issue>2</issue>
      <uri>https://dx.doi.org/10.3847/1538-4357/aadcff</uri>
      <pub-id pub-id-type="doi">10.3847/1538-4357/aadcff</pub-id>
      <fpage>104</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-EHTSgrAPaper1">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Event Horizon Telescope Collaboration et al.</string-name>
      </person-group>
      <article-title>First Sagittarius A* Event Horizon Telescope Results. I. The Shadow of the Supermassive Black Hole in the Center of the Milky Way</article-title>
      <source>Astrophysical Journal, Letters</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <volume>930</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.3847/2041-8213/ac6674</pub-id>
      <fpage>L12</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-EHTSgrAPaper2">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Event Horizon Telescope Collaboration et al.</string-name>
      </person-group>
      <article-title>First Sagittarius A* Event Horizon Telescope Results. II. EHT and Multiwavelength Observations, Data Processing, and Calibration</article-title>
      <source>Astrophysical Journal, Letters</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <volume>930</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.3847/2041-8213/ac6675</pub-id>
      <fpage>L13</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-EHTSgrAPaper3">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Event Horizon Telescope Collaboration et al.</string-name>
      </person-group>
      <article-title>First Sagittarius A* Event Horizon Telescope Results. III. Imaging of the Galactic Center Supermassive Black Hole</article-title>
      <source>Astrophysical Journal, Letters</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <volume>930</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.3847/2041-8213/ac6429</pub-id>
      <fpage>L14</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-EHTSgrAPaper4">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <string-name>Event Horizon Telescope Collaboration et al.</string-name>
      </person-group>
      <article-title>First Sagittarius A* Event Horizon Telescope Results. IV. Variability, Morphology, and Black Hole Mass</article-title>
      <source>Astrophysical Journal, Letters</source>
      <year iso-8601-date="2022-05">2022</year><month>05</month>
      <volume>930</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.3847/2041-8213/ac6736</pub-id>
      <fpage>L15</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Tiede_2022">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Tiede</surname><given-names>Paul</given-names></name>
      </person-group>
      <article-title>Comrade: Composable modeling of radio emission</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>7</volume>
      <issue>76</issue>
      <uri>https://doi.org/10.21105/joss.04457</uri>
      <pub-id pub-id-type="doi">10.21105/joss.04457</pub-id>
      <fpage>4457</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Psaltis_2018">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>Psaltis</surname><given-names>Dimitrios</given-names></name>
        <name><surname>Johnson</surname><given-names>Michael</given-names></name>
        <name><surname>Narayan</surname><given-names>Ramesh</given-names></name>
        <name><surname>Medeiros</surname><given-names>Lia</given-names></name>
        <name><surname>Blackburn</surname><given-names>Lindy</given-names></name>
        <name><surname>Bower</surname><given-names>Geoff</given-names></name>
      </person-group>
      <article-title>A model for anisotropic interstellar scattering and its application to sgr a*</article-title>
      <year iso-8601-date="2018">2018</year>
      <uri>https://arxiv.org/abs/1805.01242</uri>
    </element-citation>
  </ref>
  <ref id="ref-Bezanson_2012">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Bezanson</surname><given-names>Jeff</given-names></name>
        <name><surname>Karpinski</surname><given-names>Stefan</given-names></name>
        <name><surname>Shah</surname><given-names>Viral B.</given-names></name>
        <name><surname>Edelman</surname><given-names>Alan</given-names></name>
      </person-group>
      <article-title>Julia: A Fast Dynamic Language for Technical Computing</article-title>
      <source>arXiv e-prints</source>
      <year iso-8601-date="2012-09">2012</year><month>09</month>
      <uri>https://arxiv.org/abs/1209.5145</uri>
      <pub-id pub-id-type="doi">10.48550/arXiv.1209.5145</pub-id>
      <fpage>arXiv:1209.5145</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Rickett_1990">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Rickett</surname><given-names>B. J.</given-names></name>
      </person-group>
      <article-title>Radio propagation through the turbulent interstellar plasma.</article-title>
      <source>Annual Review of Astronomy and Astrophysics</source>
      <year iso-8601-date="1990-01">1990</year><month>01</month>
      <volume>28</volume>
      <pub-id pub-id-type="doi">10.1146/annurev.aa.28.090190.003021</pub-id>
      <fpage>561</fpage>
      <lpage>605</lpage>
    </element-citation>
  </ref>
  <ref id="ref-Narayan_1992">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Narayan</surname><given-names>Ramesh</given-names></name>
      </person-group>
      <article-title>The Physics of Pulsar Scintillation</article-title>
      <source>Philosophical Transactions of the Royal Society of London Series A</source>
      <year iso-8601-date="1992-10">1992</year><month>10</month>
      <volume>341</volume>
      <issue>1660</issue>
      <pub-id pub-id-type="doi">10.1098/rsta.1992.0090</pub-id>
      <fpage>151</fpage>
      <lpage>165</lpage>
    </element-citation>
  </ref>
  <ref id="ref-NG_1989">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Narayan</surname><given-names>Ramesh</given-names></name>
        <name><surname>Goodman</surname><given-names>Jeremy</given-names></name>
      </person-group>
      <article-title>The shape of a scatter-broadened image. I - Numerical simulations and physical principles.</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="1989-06">1989</year><month>06</month>
      <volume>238</volume>
      <pub-id pub-id-type="doi">10.1093/mnras/238.3.963</pub-id>
      <fpage>963</fpage>
      <lpage>1028</lpage>
    </element-citation>
  </ref>
  <ref id="ref-GN_1989">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Goodman</surname><given-names>J.</given-names></name>
        <name><surname>Narayan</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>The Shape of a Scatter Broadened Image - Part Two - Interferometric Visibilities</article-title>
      <source>Monthly Notices of the RAS</source>
      <year iso-8601-date="1989-06">1989</year><month>06</month>
      <volume>238</volume>
      <pub-id pub-id-type="doi">10.1093/mnras/238.3.995</pub-id>
      <fpage>995</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Dexter_2014">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Dexter</surname><given-names>J.</given-names></name>
      </person-group>
      <article-title>Event horizon scale emission models for Sagittarius A*</article-title>
      <source>The galactic center: Feeding and feedback in a normal galactic nucleus</source>
      <person-group person-group-type="editor">
        <name><surname>Sjouwerman</surname><given-names>L. O.</given-names></name>
        <name><surname>Lang</surname><given-names>C. C.</given-names></name>
        <name><surname>Ott</surname><given-names>J.</given-names></name>
      </person-group>
      <year iso-8601-date="2014-05">2014</year><month>05</month>
      <volume>303</volume>
      <pub-id pub-id-type="doi">10.1017/S1743921314000775</pub-id>
      <fpage>298</fpage>
      <lpage>302</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
