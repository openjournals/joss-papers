<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">9149</article-id>
<article-id pub-id-type="doi">10.21105/joss.09149</article-id>
<title-group>
<article-title>SpectralUnmixing: A general Julia package for unmixing
spectroscopy data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9497-7661</contrib-id>
<name>
<surname>Brodrick</surname>
<given-names>Philip G.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-3363-2496</contrib-id>
<name>
<surname>Ochoa</surname>
<given-names>Francisco</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0484-3537</contrib-id>
<name>
<surname>Okin</surname>
<given-names>Gregory</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-0866-0858</contrib-id>
<name>
<surname>Jhalani</surname>
<given-names>Vatsal A.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4210-0283</contrib-id>
<name>
<surname>Olson-Duvall</surname>
<given-names>Winston</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lundeen</surname>
<given-names>Sarah R.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1100-7550</contrib-id>
<name>
<surname>Thompson</surname>
<given-names>David R.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9447-3076</contrib-id>
<name>
<surname>Green</surname>
<given-names>Robert O.</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Jet Propulsion Laboratory, California Institute of
Technology, United States of America</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>University of California, Los Angeles, United States of
America</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2022-07-15">
<day>15</day>
<month>7</month>
<year>2022</year>
</pub-date>
<volume>10</volume>
<issue>116</issue>
<fpage>9149</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Julia</kwd>
<kwd>imaging spectroscopy</kwd>
<kwd>EMIT</kwd>
<kwd>remote sensing</kwd>
<kwd>Earth science</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>On the Earth’s surface, mixtures are the norm rather than the
  exception. Taken to the limit, virtually every surface can be split
  into multiple constituents. Spectral unmixing is the retrieval process
  that attempts to quantitatively determine the relative fractions of
  various components that make up a surface based on remotely-sensed
  optical data. Imaging spectroscopy, in particular, has demonstrated
  the capacity for robust fractional retrievals across a wide range of
  domains, including mineralogical maps
  (<xref alt="Combe et al., 2008" rid="ref-combe2008analysis" ref-type="bibr">Combe
  et al., 2008</xref>;
  <xref alt="Yan et al., 2010" rid="ref-yan2010minerals" ref-type="bibr">Yan
  et al., 2010</xref>), urban land cover
  (<xref alt="Myint &amp; Okin, 2009" rid="ref-myint2009modelling" ref-type="bibr">Myint
  &amp; Okin, 2009</xref>), and vegetation
  (<xref alt="Okin et al., 2001" rid="ref-okin2001practical" ref-type="bibr">Okin
  et al., 2001</xref>).</p>
  <p>Spectral unmixing is typically performed under the assumption of
  linear mixtures. Some set of candidate ‘endmembers’ - constituents
  with known absolute (often pure) quantities and spectral signatures -
  are provided, and each pixel within an image is linearly unmixed with
  these endmembers to retrieve the relative contribution of each
  constituent. In essence, this reduces to a simple linear algebra
  inversion where the known reference library can be inverted and
  multiplied by the target signatures to produce mixture fractions. This
  routine is commonly performed on reflectance spectra, but can also be
  applied to radiance data with appropriate consideration of atmospheric
  and illumination / topographic effects. However, details arise
  regarding the nature of the selection of endmembers, with strategies
  ranging from dimensionality reduction of endmember ‘classes’
  (<xref alt="Roberts et al., 1998" rid="ref-roberts1998mapping" ref-type="bibr">Roberts
  et al., 1998</xref>), bootstrapping
  (<xref alt="Asner &amp; Lobell, 2000" rid="ref-asner2000biogeophysical" ref-type="bibr">Asner
  &amp; Lobell, 2000</xref>), combinatorial selection
  (<xref alt="Franke et al., 2009" rid="ref-franke2009hierarchical" ref-type="bibr">Franke
  et al., 2009</xref>;
  <xref alt="Roberts et al., 1998" rid="ref-roberts1998mapping" ref-type="bibr">Roberts
  et al., 1998</xref>), and spectral brightness normalization
  (<xref alt="Asner &amp; Lobell, 2000" rid="ref-asner2000biogeophysical" ref-type="bibr">Asner
  &amp; Lobell, 2000</xref>). The exact matrix inversion strategy to use
  is also an open and problem-specific decision, with candidates ranging
  from direct algebraic inversion to a constrained and regularized
  optimization
  (<xref alt="Hastie et al., 2015" rid="ref-hastie2015statistical" ref-type="bibr">Hastie
  et al., 2015</xref>).</p>
  <p><monospace>SpectralUnmixing</monospace> is a Julia package that
  brings together a wide variety of these unmixing strategies into a
  single, flexible codebase that operates efficiently in order to
  support real deployment. Designed as a package, users have the option
  to experiment with individual functions, use a front-end script to
  deploy a fractional cover retrieval of choice over a given image, or
  to build out a new unmixing strategy leveraging the core functions and
  inversion methods established here.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p><monospace>SpectralUnmixing</monospace> is a one-stop-shop Julia
  package for all types of spectral unmixing strategies, focused on
  imaging spectroscopy data. The code was designed for NASA’s Earth
  Surface Mineral Dust Source Investigation (EMIT)
  (<xref alt="Green et al., 2020" rid="ref-emit2020" ref-type="bibr">Green
  et al., 2020</xref>) mission when, during the algorithm design phase,
  it became evident that there did not yet exist an optimized codebase
  that provided parallelized and flexible spectral unmixing strategies.
  In particular, no central framework exists in which different unmixing
  strategies could be efficiently tested against one another.
  <monospace>SpectralUnmixing</monospace> addresses this issue by
  drawing on a vast amount of existing literature and bringing the
  various proposed strategies together into a single codebase. The
  framework also leverages a rich set of Julia packages for linear
  algebra, optimization, data IO and more, resulting in a highly
  flexible and scalable unmixing package.
  <monospace>SpectralUnmixing</monospace> has already supported the
  development of new unmixing strategies by accelerating the process of
  combining different components of the overall unmixing problem in
  novel ways
  (<xref alt="Ochoa et al., n.d." rid="ref-OchoaQuantifying" ref-type="bibr">Ochoa
  et al., n.d.</xref>) The package’s scalability and breadth will allow
  it to continue providing this kind of coupled flexibility and
  operational capacity into the future.</p>
  <fig>
    <caption><p>Example usage of
    <monospace>SpectralUnmixing</monospace>: fractional cover from an
    EMIT spectral image. A) Red-green-blue (RGB) image of sample EMIT
    reflectance data observed near Sacramento, CA, USA with zoom-ins
    around labeled points (left). B) Fractional cover output of
    <monospace>SpectralUnmixing</monospace> driver script
    <monospace>unmix.jl</monospace> on EMIT reflectance image with
    zoom-ins around labeled points (right). The RGB values in the
    fractional cover correspond to fractions of endmember library
    classes: non-photosynthetic vegetation (npv), photosynthetic
    vegetation (pv), and soil, respectively. C) EMIT reflectance spectra
    of sample points labeled in A) and B), chosen to each have high
    fractions of each of the 3 classes. Each spectra is colored by the
    RGB value corresponding to their class fraction. Here,
    <monospace>unmix.jl</monospace> was run using the included example
    endmember library and with the arguments
    <monospace>--normalization brightness --mode sma-best --n_mc 20 --num_endmembers 30</monospace><styled-content id="figU003Aunmixing"></styled-content></p></caption>
    <graphic mimetype="application" mime-subtype="pdf" xlink:href="fig.pdf" />
  </fig>
  <p>While <monospace>SpectralUnmixing</monospace> was originally
  created to be used operationally for the EMIT mission, it was also
  designed to be quickly adaptable for different researchers’ needs. The
  package currently supports the industry standard ENVI file format for
  unmixing raster maps, with support for more formats planned for the
  future. The code is fully documented, including an example notebook,
  and features a script front-end that allows for arguments to be easily
  passed in and different options and datasets to be coupled together
  for rapid testing. The package ultimately aims to benefit students,
  educators, professional researchers, and operational missions
  alike.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>EMIT is supported by the National Aeronautics and Space
  Administration Earth Venture Instrument program, USA, under the Earth
  Science Division of the Science Mission Directorate. A portion of this
  research was carried out at the Jet Propulsion Laboratory, California
  Institute of Technology, under a contract with the National
  Aeronautics and Space Administration, USA (80NM0018D0004). We
  acknowledge the support and assistance of NASA’s International Space
  Station Program, USA. Any use of trade, firm, or product names is for
  descriptive purposes only and does not imply endorsement by the U.S.
  Government. Copyright 2024 California Institute of Technology. All
  rights reserved. US Government Support Acknowledged.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-franke2009hierarchical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Franke</surname><given-names>Jonas</given-names></name>
        <name><surname>Roberts</surname><given-names>Dar A.</given-names></name>
        <name><surname>Halligan</surname><given-names>Kerry</given-names></name>
        <name><surname>Menz</surname><given-names>Gunter</given-names></name>
      </person-group>
      <article-title>Hierarchical multiple endmember spectral mixture analysis (MESMA) of hyperspectral imagery for urban environments</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2009">2009</year>
      <volume>113</volume>
      <issue>8</issue>
      <issn>0034-4257</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0034425709001163</uri>
      <pub-id pub-id-type="doi">10.1016/j.rse.2009.03.018</pub-id>
      <fpage>1712</fpage>
      <lpage>1723</lpage>
    </element-citation>
  </ref>
  <ref id="ref-roberts1998mapping">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Roberts</surname><given-names>D. A.</given-names></name>
        <name><surname>Gardner</surname><given-names>M.</given-names></name>
        <name><surname>Church</surname><given-names>R.</given-names></name>
        <name><surname>Ustin</surname><given-names>S.</given-names></name>
        <name><surname>Scheer</surname><given-names>G.</given-names></name>
        <name><surname>Green</surname><given-names>R. O.</given-names></name>
      </person-group>
      <article-title>Mapping chaparral in the Santa Monica mountains using multiple endmember spectral mixture models</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="1998">1998</year>
      <volume>65</volume>
      <issue>3</issue>
      <issn>0034-4257</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0034425798000376</uri>
      <pub-id pub-id-type="doi">10.1016/S0034-4257(98)00037-6</pub-id>
      <fpage>267</fpage>
      <lpage>279</lpage>
    </element-citation>
  </ref>
  <ref id="ref-asner2000biogeophysical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Asner</surname><given-names>Gregory P</given-names></name>
        <name><surname>Lobell</surname><given-names>David B</given-names></name>
      </person-group>
      <article-title>A biogeophysical approach for automated SWIR unmixing of soils and vegetation</article-title>
      <source>Remote Sensing of Environment</source>
      <year iso-8601-date="2000">2000</year>
      <volume>74</volume>
      <issue>1</issue>
      <issn>0034-4257</issn>
      <uri>https://www.sciencedirect.com/science/article/pii/S0034425700001267</uri>
      <pub-id pub-id-type="doi">10.1016/S0034-4257(00)00126-7</pub-id>
      <fpage>99</fpage>
      <lpage>112</lpage>
    </element-citation>
  </ref>
  <ref id="ref-OchoaQuantifying">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Ochoa</surname><given-names>Francisco</given-names></name>
        <name><surname>Brodrick</surname><given-names>Philip G.</given-names></name>
        <name><surname>Okin</surname><given-names>Gregory S.</given-names></name>
        <name><surname>Ben-Dor</surname><given-names>Eyal</given-names></name>
        <name><surname>Meyer</surname><given-names>Thoralf</given-names></name>
        <name><surname>Thompson</surname><given-names>David R.</given-names></name>
        <name><surname>Green</surname><given-names>Robert O.</given-names></name>
      </person-group>
      <article-title>Optimal soil and vegetation cover estimation for global imaging spectroscopy using spectral mixture analysis</article-title>
      <source>In review</source>
      <uri>https://essopenarchive.org/users/850248/articles/1241110-optimal-soil-and-vegetation-cover-estimation-for-global-imaging-spectroscopy-using-spectral-mixture-analysis</uri>
      <pub-id pub-id-type="doi">10.22541/essoar.173193387.79878484/v1</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-emit2020">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>Green</surname><given-names>Robert O</given-names></name>
        <name><surname>Mahowald</surname><given-names>Natalie</given-names></name>
        <name><surname>Ung</surname><given-names>Charlene</given-names></name>
        <name><surname>Thompson</surname><given-names>David R</given-names></name>
        <name><surname>Bator</surname><given-names>Lori</given-names></name>
        <name><surname>Bennet</surname><given-names>Matthew</given-names></name>
        <name><surname>Bernas</surname><given-names>Michael</given-names></name>
        <name><surname>Blackway</surname><given-names>Natalie</given-names></name>
        <name><surname>Bradley</surname><given-names>Christine</given-names></name>
        <name><surname>Cha</surname><given-names>Jeff</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>The Earth surface mineral dust source investigation: An Earth science imaging spectroscopy mission</article-title>
      <source>2020 IEEE aerospace conference</source>
      <publisher-name>IEEE</publisher-name>
      <year iso-8601-date="2020">2020</year>
      <pub-id pub-id-type="doi">10.1109/AERO47225.2020.9172731</pub-id>
      <fpage>1</fpage>
      <lpage>15</lpage>
    </element-citation>
  </ref>
  <ref id="ref-yan2010minerals">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Yan</surname><given-names>Bokun</given-names></name>
        <name><surname>Wang</surname><given-names>Runsheng</given-names></name>
        <name><surname>Gan</surname><given-names>Fuping</given-names></name>
        <name><surname>Wang</surname><given-names>Zhenchao</given-names></name>
      </person-group>
      <article-title>Minerals mapping of the lunar surface with Clementine UVVIS/NIR data based on spectra unmixing method and Hapke model</article-title>
      <source>Icarus</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2010">2010</year>
      <volume>208</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1016/j.icarus.2010.01.030</pub-id>
      <fpage>11</fpage>
      <lpage>19</lpage>
    </element-citation>
  </ref>
  <ref id="ref-combe2008analysis">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Combe</surname><given-names>J-Ph</given-names></name>
        <name><surname>Le Mouélic</surname><given-names>Stéphane</given-names></name>
        <name><surname>Sotin</surname><given-names>C</given-names></name>
        <name><surname>Gendrin</surname><given-names>A</given-names></name>
        <name><surname>Mustard</surname><given-names>JF</given-names></name>
        <name><surname>Le Deit</surname><given-names>L</given-names></name>
        <name><surname>Launeau</surname><given-names>P</given-names></name>
        <name><surname>Bibring</surname><given-names>J-P</given-names></name>
        <name><surname>Gondet</surname><given-names>B</given-names></name>
        <name><surname>Langevin</surname><given-names>Y</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>Analysis of OMEGA/Mars express data hyperspectral data using a multiple-endmember linear spectral unmixing model (MELSUM): Methodology and first results</article-title>
      <source>Planetary and Space Science</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2008">2008</year>
      <volume>56</volume>
      <issue>7</issue>
      <pub-id pub-id-type="doi">10.1016/j.pss.2007.12.007</pub-id>
      <fpage>951</fpage>
      <lpage>975</lpage>
    </element-citation>
  </ref>
  <ref id="ref-myint2009modelling">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Myint</surname><given-names>Soe W</given-names></name>
        <name><surname>Okin</surname><given-names>Gregory S</given-names></name>
      </person-group>
      <article-title>Modelling land-cover types using multiple endmember spectral mixture analysis in a desert city</article-title>
      <source>International Journal of Remote Sensing</source>
      <publisher-name>Taylor &amp; Francis</publisher-name>
      <year iso-8601-date="2009">2009</year>
      <volume>30</volume>
      <issue>9</issue>
      <pub-id pub-id-type="doi">10.1080/01431160802549328</pub-id>
      <fpage>2237</fpage>
      <lpage>2257</lpage>
    </element-citation>
  </ref>
  <ref id="ref-okin2001practical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Okin</surname><given-names>Gregory S</given-names></name>
        <name><surname>Roberts</surname><given-names>Dar A</given-names></name>
        <name><surname>Murray</surname><given-names>Bruce</given-names></name>
        <name><surname>Okin</surname><given-names>William J</given-names></name>
      </person-group>
      <article-title>Practical limits on hyperspectral vegetation discrimination in arid and semiarid environments</article-title>
      <source>Remote Sensing of Environment</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2001">2001</year>
      <volume>77</volume>
      <issue>2</issue>
      <pub-id pub-id-type="doi">10.1016/s0034-4257(01)00207-3</pub-id>
      <fpage>212</fpage>
      <lpage>225</lpage>
    </element-citation>
  </ref>
  <ref id="ref-hastie2015statistical">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hastie</surname><given-names>Trevor</given-names></name>
        <name><surname>Tibshirani</surname><given-names>Robert</given-names></name>
        <name><surname>Wainwright</surname><given-names>Martin</given-names></name>
      </person-group>
      <article-title>Statistical learning with sparsity</article-title>
      <source>Monographs on statistics and applied probability</source>
      <year iso-8601-date="2015">2015</year>
      <volume>143</volume>
      <issue>143</issue>
      <pub-id pub-id-type="doi">10.1201/b18401</pub-id>
      <fpage>8</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
