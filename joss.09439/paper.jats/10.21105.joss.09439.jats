<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">9439</article-id>
<article-id pub-id-type="doi">10.21105/joss.09439</article-id>
<title-group>
<article-title>pyDARTdiags: A Python package for manipulating
observation sequences and calculating observation-space diagnostics for
the Data Assimilation Research Testbed (DART)</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0002-3755-9978</contrib-id>
<name>
<surname>Kershaw</surname>
<given-names>Helen</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0008-7616-9060</contrib-id>
<name>
<surname>Smith</surname>
<given-names>Marlee</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4170-7734</contrib-id>
<name>
<surname>Arseneau</surname>
<given-names>Isaac</given-names>
</name>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-4537-3164</contrib-id>
<name>
<surname>Kugler</surname>
<given-names>Lukas</given-names>
</name>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>NSF National Center for Atmospheric Research, Boulder CO,
United States of America</institution>
<institution-id institution-id-type="ROR">05cvfcr44</institution-id>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>Texas Tech University, United States of
America</institution>
<institution-id institution-id-type="ROR">0405mnx93</institution-id>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>University of Vienna, Austria</institution>
<institution-id institution-id-type="ROR">03prydq77</institution-id>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-07-31">
<day>31</day>
<month>7</month>
<year>2025</year>
</pub-date>
<volume>11</volume>
<issue>118</issue>
<fpage>9439</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2026</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>data assimilation</kwd>
<kwd>diagnostics</kwd>
<kwd>atmospheric science</kwd>
<kwd>observational data</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>pyDARTdiags is a Python package for manipulating observation
  sequences and calculating observation-space diagnostics for the Data
  Assimilation Research Testbed (DART)
  (<xref alt="J. Anderson et al., 2009" rid="ref-DART2009" ref-type="bibr">J.
  Anderson et al., 2009</xref>;
  <xref alt="Gharamti et al., 2025" rid="ref-DART2025" ref-type="bibr">Gharamti
  et al., 2025</xref>;
  <xref alt="UCAR/NSF NCAR/CISL/DAReS, 2025" rid="ref-DARTcode" ref-type="bibr">UCAR/NSF
  NCAR/CISL/DAReS, 2025</xref>).</p>
  <p>Data assimilation is a scientific technique that combines
  observations (such as measurements from weather satellites, buoys,
  radar, or other sensors) with predictions from numerical models to
  produce an improved estimate of the state of a system
  (<xref alt="J. L. Anderson, 2009" rid="ref-AndersonU003A2009" ref-type="bibr">J.
  L. Anderson, 2009</xref>;
  <xref alt="Evensen, 2003" rid="ref-EvensenU003A2003" ref-type="bibr">Evensen,
  2003</xref>). It is widely used in fields like meteorology,
  oceanography, hydrology, and environmental science.</p>
  <p>During assimilation, the model state is transformed into
  observation space by interpolating the model state to each observation
  location. Observation space diagnostics are used to visualize
  observations and model predictions (in observation space), and compare
  their statistical properties both before and after assimilation.
  Thereby, these diagnostics are key tools to model evaluation and
  prediction tasks.</p>
  <p>The Data Assimilation Research Testbed (DART) is a widely used
  community software facility for ensemble data assimilation.
  pyDARTdiags is a Python package for manipulating observation sequences
  and calculating observation-space diagnostics for DART. It provides
  tools to read, manipulate,and analyze DART observation sequence files
  using familiar, modern Python libraries. With pyDARTdiags, users can
  extract data, compute diagnostics, and create visualizations, all
  within reproducible Python workflows that integrate seamlessly with
  the broader scientific ecosystem.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>DART merges diverse and complex observations into an internal data
  format called “observation sequence” files, which inherit metadata
  from each observation. Observation sequence files including the model
  states are also generated, wherein the model states have been
  transformed into the observation space for direct comparisons and
  analysis. While DART provides robust tools for data assimilation, its
  observation sequence files are not easily accessible for users wishing
  to perform custom diagnostics or integrate with Python-based
  workflows.</p>
  <p>DART’s observation sequence files are central to its workflow, but
  their format and complexity can make them challenging to manipulate
  and analyze outside of the DART ecosystem. Existing DART tools for
  calculation of observation-space diagnostics are written in Fortran
  with visualization in MATLAB, which may not be freely accessible to
  all users. To manipulate and analyze the data using open-source tools
  a converter/interface is required. pyDARTdiags is a Python package
  created to address this need by providing a single package to process
  and visualize observation space diagnostics.</p>
  <p>PyDARTdiags ingests observation sequences into an ObsSequence
  object which contains the metadata about an observation sequence and a
  pandas DataFrame
  (<xref alt="The pandas development team, 2025" rid="ref-pandas" ref-type="bibr">The
  pandas development team, 2025</xref>) containing all the data for the
  observations.</p>
  <p>This provides several advantages over the existing Fortran+MATLAB
  DART software:</p>
  <list list-type="bullet">
    <list-item>
      <p>Providing Python routines for reading and writing DART
      observation sequence files allows for the manipulation of
      observation sequences interactively via DataFrames using popular,
      open-source data science libraries.</p>
    </list-item>
    <list-item>
      <p>Synthesizing the manipulation, analysis, and visualization of
      observation sequence files into a single Python workflow improves
      portability and flexibility over the fractured Fortran/MATLAB
      workflow.</p>
    </list-item>
    <list-item>
      <p>Enabling calculation of observation-space statistics (e.g.,
      RMSE, bias, total spread) on a DataFrame enables Data Assimilation
      researchers and users to write custom diagnostics based on
      DataFrames. By decoupling the observation sequence file format
      from the DataFrame-based analysis, pyDARTdiags ensures that
      updates to the DART file format do not disrupt user-created
      diagnostic routines.</p>
    </list-item>
    <list-item>
      <p>Supporting both static (via Matplotlib,
      <xref alt="Hunter, 2007" rid="ref-HunterU003A2007" ref-type="bibr">Hunter,
      2007</xref>;
      <xref alt="McKinney, 2010" rid="ref-mckinney-proc-scipy-2010" ref-type="bibr">McKinney,
      2010</xref>) and interactive (via Plotly,
      <xref alt="Plotly Technologies Inc., 2015" rid="ref-plotly" ref-type="bibr">Plotly
      Technologies Inc., 2015</xref>) plotting, facilitates the
      processing of observational datasets, quality control, and gaining
      insights about the spatial distribution of outliers or other
      (technical) anomalies.</p>
    </list-item>
    <list-item>
      <p>Facilitating reproducible, scriptable workflows for
      observation-space diagnostics enables the inclusion in Jupyter
      notebook workflows. A concrete use case is its integration into
      the the CESM Regional Ocean and Carbon Configurator with Data
      Assimilation and Embedding (CROCODILE,
      <xref alt="CROCODILE-CESM, 2025" rid="ref-CROCODILE-CESM" ref-type="bibr">CROCODILE-CESM,
      2025</xref>) project, which is a community platform for
      accelerating observationally-constrained regional ocean modeling.
      pyDARTdiags is used for observation space diagnostics and
      model-to-observation comparison in the Jupyter notebook workflows
      for this project.</p>
    </list-item>
  </list>
  <p>Examples for manipulating observation sequences, visualizing
  observational data, and generating diagnostic plots can be found in
  the
  <ext-link ext-link-type="uri" xlink:href="https://ncar.github.io/pyDARTdiags/examples/index.html">pyDARTdiags
  examples gallery</ext-link>. A detailed description of the available
  diagnostic statistics and available plotting functions is provided in
  the
  <ext-link ext-link-type="uri" xlink:href="https://ncar.github.io/pyDARTdiags/userguide/index.html">user
  guide</ext-link>. The pyDARTdiags source code is available at
  <ext-link ext-link-type="uri" xlink:href="https://github.com/NCAR/pyDARTdiags">https://github.com/NCAR/pyDARTdiags</ext-link>.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>We thank the DART team, Enrico Milanese (Woods Hole Oceanographic
  Institution), and the broader data assimilation community for their
  feedback and contributions.</p>
  <p>This material is based upon work supported by the U.S. National
  Science Foundation under Grant No. 2311382, “Collaborative Research:
  Frameworks: A community platform for accelerating
  observationally-constrained regional oceanographic modeling”, and by
  the NSF National Center for Atmospheric Research, which is a major
  facility sponsored by the U.S. National Science Foundation under
  Cooperative Agreement No. 1852977.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-DARTcode">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <string-name>UCAR/NSF NCAR/CISL/DAReS</string-name>
      </person-group>
      <article-title>The Data Assimilation Research Testbed</article-title>
      <year iso-8601-date="2025-07">2025</year><month>07</month>
      <pub-id pub-id-type="doi">10.5065/D6WQ0202</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-DART2009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Anderson</surname><given-names>Jeffrey</given-names></name>
        <name><surname>Hoar</surname><given-names>Tim</given-names></name>
        <name><surname>Raeder</surname><given-names>Kevin</given-names></name>
        <name><surname>Liu</surname><given-names>Hui</given-names></name>
        <name><surname>Collins</surname><given-names>Nancy</given-names></name>
        <name><surname>Torn</surname><given-names>Ryan</given-names></name>
        <name><surname>Avellano</surname><given-names>Avelino</given-names></name>
      </person-group>
      <article-title>The Data Assimilation Research Testbed: A community facility</article-title>
      <source>Bulletin of the American Meteorological Society</source>
      <publisher-name>American Meteorological Society</publisher-name>
      <publisher-loc>Boston MA, USA</publisher-loc>
      <year iso-8601-date="2009">2009</year>
      <volume>90</volume>
      <issue>9</issue>
      <uri>https://journals.ametsoc.org/view/journals/bams/90/9/2009bams2618_1.xml</uri>
      <pub-id pub-id-type="doi">10.1175/2009BAMS2618.1</pub-id>
      <fpage>1283</fpage>
      <lpage>1296</lpage>
    </element-citation>
  </ref>
  <ref id="ref-DART2025">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Gharamti</surname><given-names>Mohamad El</given-names></name>
        <name><surname>Kershaw</surname><given-names>Helen</given-names></name>
        <name><surname>Raeder</surname><given-names>Kevin</given-names></name>
        <name><surname>Raczka</surname><given-names>Brett</given-names></name>
        <name><surname>Johnson</surname><given-names>Benjamin</given-names></name>
        <name><surname>Smith</surname><given-names>Marlena</given-names></name>
        <name><surname>Anderson</surname><given-names>Jeffrey</given-names></name>
        <name><surname>Amrhein</surname><given-names>Daniel</given-names></name>
        <name><surname>Collins</surname><given-names>Nancy</given-names></name>
        <name><surname>Hoar</surname><given-names>Timothy</given-names></name>
        <name><surname>Gaubert</surname><given-names>Benjamin</given-names></name>
        <name><surname>Grooms</surname><given-names>Ian</given-names></name>
        <name><surname>Kugler</surname><given-names>Lukas</given-names></name>
      </person-group>
      <article-title>The Data Assimilation Research Testbed: A robust, scalable software facility with groundbreaking capabilities for model-data integration</article-title>
      <source>Bulletin of the American Meteorological Society</source>
      <publisher-name>American Meteorological Society</publisher-name>
      <publisher-loc>Boston MA, USA</publisher-loc>
      <year iso-8601-date="2025">2025</year>
      <volume>106</volume>
      <issue>11</issue>
      <uri>https://journals.ametsoc.org/view/journals/bams/106/11/BAMS-D-24-0214.1.xml</uri>
      <pub-id pub-id-type="doi">10.1175/BAMS-D-24-0214.1</pub-id>
      <fpage>E2328 </fpage>
      <lpage> E2345</lpage>
    </element-citation>
  </ref>
  <ref id="ref-pandas">
    <element-citation publication-type="software">
      <person-group person-group-type="author">
        <string-name>The pandas development team</string-name>
      </person-group>
      <article-title>pandas-dev/pandas: Pandas</article-title>
      <year iso-8601-date="2025">2025</year>
      <uri>https://github.com/pandas-dev/pandas</uri>
      <pub-id pub-id-type="doi">10.5281/zenodo.3509134</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-mckinney-proc-scipy-2010">
    <element-citation publication-type="paper-conference">
      <person-group person-group-type="author">
        <name><surname>McKinney</surname><given-names>Wes</given-names></name>
      </person-group>
      <article-title>Data structures for statistical computing in Python</article-title>
      <source>Proceedings of the 9th Python in Science Conference (SciPy 2010)</source>
      <person-group person-group-type="editor">
        <name><surname>Walt</surname><given-names>Stéfan van der</given-names></name>
        <name><surname>Millman</surname><given-names>Jarrod</given-names></name>
      </person-group>
      <year iso-8601-date="2010">2010</year>
      <pub-id pub-id-type="doi">10.25080/Majora-92bf1922-00a</pub-id>
      <fpage>56 </fpage>
      <lpage> 61</lpage>
    </element-citation>
  </ref>
  <ref id="ref-HunterU003A2007">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hunter</surname><given-names>J. D.</given-names></name>
      </person-group>
      <article-title>Matplotlib: A 2D graphics environment</article-title>
      <source>Computing in Science &amp; Engineering</source>
      <publisher-name>IEEE COMPUTER SOC</publisher-name>
      <year iso-8601-date="2007">2007</year>
      <volume>9</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>
      <fpage>90</fpage>
      <lpage>95</lpage>
    </element-citation>
  </ref>
  <ref id="ref-plotly">
    <element-citation publication-type="webpage">
      <person-group person-group-type="author">
        <name><surname>Plotly Technologies Inc.</surname></name>
      </person-group>
      <article-title>Collaborative data science</article-title>
      <publisher-name>Plotly Technologies Inc.</publisher-name>
      <publisher-loc>Montreal, QC</publisher-loc>
      <year iso-8601-date="2015">2015</year>
      <uri>https://plot.ly</uri>
    </element-citation>
  </ref>
  <ref id="ref-CROCODILE-CESM">
    <element-citation>
      <person-group person-group-type="author">
        <name><surname>CROCODILE-CESM</surname></name>
      </person-group>
      <article-title>CROCODILE: Regional ocean and carbon cycle modeling and data assimilation within the community earth system model</article-title>
      <publisher-name>GitHub repository</publisher-name>
      <year iso-8601-date="2025">2025</year>
      <uri>https://github.com/CROCODILE-CESM</uri>
    </element-citation>
  </ref>
  <ref id="ref-EvensenU003A2003">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Evensen</surname><given-names>G.</given-names></name>
      </person-group>
      <article-title>The ensemble Kalman filter: Theoretical formulation and practical implementation</article-title>
      <source>Ocean Dyn.</source>
      <year iso-8601-date="2003">2003</year>
      <volume>53</volume>
      <pub-id pub-id-type="doi">10.1007/s10236-003-0036-9</pub-id>
      <fpage>343</fpage>
      <lpage>367</lpage>
    </element-citation>
  </ref>
  <ref id="ref-AndersonU003A2009">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Anderson</surname><given-names>J. L.</given-names></name>
      </person-group>
      <article-title>Ensemble Kalman filters for large geophysical applications</article-title>
      <source>IEEE Control Syst. Mag.</source>
      <year iso-8601-date="2009">2009</year>
      <volume>29</volume>
      <pub-id pub-id-type="doi">10.1109/MCS.2009.932222</pub-id>
      <fpage>66</fpage>
      <lpage>82</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
