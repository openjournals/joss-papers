body = <<-EOF
<meta name="citation_title" content="SaffronTree: Fast, reference-free pseudo-phylogenomic trees from reads or contigs.">
<meta name="citation_author" content="J. Page, Andrew"><meta name="citation_author" content="Hunt, Martin"><meta name="citation_author" content="Seemann, Torsten"><meta name="citation_author" content="A. Keane, Jacqueline">
<meta name="citation_publication_date" content="2017/05/03">
<meta name="citation_journal_title" content="The Journal of Open Source Software">
<meta name="citation_pdf_url" content="http://www.theoj.org/joss-papers/joss.00243/10.21105.joss.00243.pdf">
<meta name="citation_doi" content="10.21105/joss.00243">
<meta name="citation_issn" content="2475-9066">
<div class="accepted-paper">
  <h1>SaffronTree: Fast, reference-free pseudo-phylogenomic trees from reads or contigs.</h1>
  <div class="columns links">
    <div class="column four-fifths" style="padding-bottom: 10px;">
      <strong>Authors</strong>
      <ul class="author-list">
            <li><a href="http://orcid.org/0000-0001-6919-6062" target="_blank">Andrew J. Page</a></li>
            <li><a href="http://orcid.org/0000-0002-8060-4335" target="_blank">Martin Hunt</a></li>
            <li><a href="http://orcid.org/0000-0001-6046-610X" target="_blank">Torsten Seemann</a></li>
            <li><a href="http://orcid.org/0000-0002-2021-1863" target="_blank">Jacqueline A. Keane</a></li>
            </ul>
    </div>
    <div class="one-third column">
      <span class="repo">Repository:<br /><a href="https://github.com/sanger-pathogens/saffrontree">Repository link &raquo;</a></span>
    </div>
    <div class="one-third column">
      <span class="paper">Paper:<br /><a href="http://www.theoj.org/joss-papers/joss.00243/10.21105.joss.00243.pdf">PDF link &raquo;</a></span>
    </div>
    <div class="one-third column">
      <span class="paper">Review:<br /><a href="https://github.com/openjournals/joss-reviews/issues/243">View review issue &raquo;</a></span>
    </div>

    <div class="one-third column" style="padding-top: 20px;">
      <span class="repo">DOI:<br /><a href="https://doi.org/10.21105/joss.00243">https://doi.org/10.21105/joss.00243</a></span>
    </div>
    <div class="one-third column" style="padding-top: 20px;">
      <span class="paper">Status badge:<br /><img src="http://joss.theoj.org/papers/10.21105/joss.00243/status.svg"></span>
    </div>
    <div class="one-third column" style="padding-top: 20px;">
      <span class="paper">Citation:<br />
      <small>Page <em>et al.</em>, (2017), <em>Journal of Open Source Software</em>, 2(13), 243, doi:10.21105/joss.00243</small>
    </div>
  </div>
  <div class="paper-body">
  <h1 id="summary">Summary</h1>
  <p>When defining bacterial populations through whole genome sequencing (WGS) the samples often have unknown evolutionary histories. With the increased use of next generation WGS in routine diagnostics, surveillance and epidemiology a vast amount of short read data is available, with phylogenetic trees (dendograms) used to visualise the relationships and similarities between samples. Standard reference and assembly based methods can take substantial amounts of time to generate these phylogenetic relationships, with the computation time often exceeding the time to sequence the samples in the first place. Faster methods <span class="citation">(Ondov et al. 2016; Wood and Salzberg 2014)</span> can loosely classify samples into known taxonomic categories, however the loss of granularity means the relationships between samples is reduced. This can be the difference between ruling a sample in or out of an outbreak, which is a clinically important finding for genomic epidemiologists. Other methods <span class="citation">(Boratyn et al. 2014)</span> are closed source which prevents independent scrutiny. SaffronTree utilises the k-mer profiles between samples to rapidly construct a tree, directly from raw reads in FASTQ format or contigs in FASTA format. It supports NGS data (such as Illumina), 3rd generation long read data (Pacbio/Nanopore) and assembled sequences (FASTA). Firstly, a k-mer count database is constructed for each sample using KMC <span class="citation">(Kokot, D&#322;ugosz, and Deorowicz 2017)</span>. Next, the intersection of the k-mer databases is found for each pair of samples, with the number of k-mers in common recorded in a distance matrix. Finally, the distance matrix is used to construct a UPGMA tree <span class="citation">(Sokal and Michener 1958)</span> in Newick format. This tree method was chosen as it is fast, however the final result is lower quality than slower methods which perform ancestral sequence reconstructions <span class="citation">(Stamatakis 2014)</span>. The computational complexity of the algorithm is O(N^2), so is best suited to datasets of less than 50 samples. This can give rapid insights into small datasets in minutes, rather than hours. SaffonTree provides better granularity than MLST as it uses more of the underlying genome, can operate at low depth of coverage, is reference free, species agnostic, and has a low memory requirement.</p>
  <h1 id="references" class="unnumbered">References</h1>
  <div id="refs" class="references">
  <div id="ref-Boratyn2014">
  <p>Boratyn, Greg, Christiam Camacho, Scott Federhen, Yuri Merezhuk, Tom Madden, Conrad Schoch, and Irena Zaretskaya. 2014. &#8220;MOLE-Blast a New Tool to Search and Classify Multiple Sequences.&#8221; <a href="ftp://ftp.ncbi.nlm.nih.gov/blast/documents/moleblast_poster2014.pdf" class="uri">ftp://ftp.ncbi.nlm.nih.gov/blast/documents/moleblast_poster2014.pdf</a>.</p>
  </div>
  <div id="ref-Kokot2017">
  <p>Kokot, M., M. D&#322;ugosz, and S. Deorowicz. 2017. &#8220;KMC 3: counting and manipulating k-mer statistics.&#8221; <em>ArXiv E-Prints</em>, January.</p>
  </div>
  <div id="ref-Ondov2016">
  <p>Ondov, Brian D, Todd J Treangen, P&#225;ll Melsted, Adam B Mallonee, Nicholas H Bergman, Sergey Koren, and Adam M Phillippy. 2016. &#8220;Mash: fast genome and metagenome distance estimation using MinHash.&#8221; <em>Genome Biology</em> 17 (1): 1&#8211;14. doi:<a href="https://doi.org/10.1186/s13059-016-0997-x">10.1186/s13059-016-0997-x</a>.</p>
  </div>
  <div id="ref-Sokal1958">
  <p>Sokal, Robert R., and Charles D. Michener. 1958. &#8220;A Statistical Method for Evaluating Systematic Relationships.&#8221; <em>The University of Kansas Science Bulletin</em> 38: 1409&#8211;38. <a href="http://ci.nii.ac.jp/naid/10011579647/en/" class="uri">http://ci.nii.ac.jp/naid/10011579647/en/</a>.</p>
  </div>
  <div id="ref-Stamatakis2014">
  <p>Stamatakis, Alexandros. 2014. &#8220;RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies.&#8221; <em>Bioinformatics (Oxford, England)</em> 30 (9): 1312&#8211;3. doi:<a href="https://doi.org/10.1093/bioinformatics/btu033">10.1093/bioinformatics/btu033</a>.</p>
  </div>
  <div id="ref-Wood2014">
  <p>Wood, Derrick E, and Steven L Salzberg. 2014. &#8220;Kraken: ultrafast metagenomic sequence classification using exact alignments.&#8221; <em>Genome Biology</em> 15 (3): R46. doi:<a href="https://doi.org/10.1186/gb-2014-15-3-r46">10.1186/gb-2014-15-3-r46</a>.</p>
  </div>
  </div>
  </div>
</div>
EOF
