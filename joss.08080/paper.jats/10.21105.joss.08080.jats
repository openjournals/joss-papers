<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">8080</article-id>
<article-id pub-id-type="doi">10.21105/joss.08080</article-id>
<title-group>
<article-title>IAMReX: an adaptive framework for the multiphase flow and
fluid-particle interaction problems</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0001-6081-5450</contrib-id>
<name>
<surname>Li</surname>
<given-names>Chun</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-2"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0007-5348-4159</contrib-id>
<name>
<surname>Li</surname>
<given-names>Xuzhu</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
<xref ref-type="aff" rid="aff-3"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0156-2203</contrib-id>
<name>
<surname>Wang</surname>
<given-names>Yiliang</given-names>
</name>
<xref ref-type="aff" rid="aff-4"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0006-2728-421X</contrib-id>
<name>
<surname>Liu</surname>
<given-names>Dewen</given-names>
</name>
<xref ref-type="aff" rid="aff-5"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0004-7754-8346</contrib-id>
<name>
<surname>He</surname>
<given-names>Shuai</given-names>
</name>
<xref ref-type="aff" rid="aff-6"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0003-5928-3244</contrib-id>
<name>
<surname>Huang</surname>
<given-names>Boqiao</given-names>
</name>
<xref ref-type="aff" rid="aff-7"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0002-7636-038X</contrib-id>
<name>
<surname>Cheng</surname>
<given-names>Haoran</given-names>
</name>
<xref ref-type="aff" rid="aff-8"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0001-6639-0473</contrib-id>
<name>
<surname>Li</surname>
<given-names>Xiaokai</given-names>
</name>
<xref ref-type="aff" rid="aff-9"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0001-7608-2992</contrib-id>
<name>
<surname>Li</surname>
<given-names>Wenzhuo</given-names>
</name>
<xref ref-type="aff" rid="aff-10"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0007-4194-9908</contrib-id>
<name>
<surname>Tang</surname>
<given-names>Mingze</given-names>
</name>
<xref ref-type="aff" rid="aff-11"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-1315-3554</contrib-id>
<name>
<surname>Zhu</surname>
<given-names>Zhengping</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0001-7944-3597</contrib-id>
<name>
<surname>Zeng</surname>
<given-names>Yadong</given-names>
</name>
<xref ref-type="aff" rid="aff-12"/>
<xref ref-type="corresp" rid="cor-1"><sup>*</sup></xref>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>Research Center for Astronomical Computing, Zhejiang
Laboratory, Hangzhou, 311100, China</institution>
</institution-wrap>
</aff>
<aff id="aff-2">
<institution-wrap>
<institution>School of Energy and Power Engineering, Lanzhou University
of Technology, Lanzhou, 730050, China</institution>
</institution-wrap>
</aff>
<aff id="aff-3">
<institution-wrap>
<institution>School of Mechanical Engineering, Hefei University of
Technology, Hefei, 230009, China</institution>
</institution-wrap>
</aff>
<aff id="aff-4">
<institution-wrap>
<institution>Independent Researcher, Loveland, 45140, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-5">
<institution-wrap>
<institution>School of Civil Engineering, Southwest Jiaotong University,
Chengdu, 611756, China</institution>
</institution-wrap>
</aff>
<aff id="aff-6">
<institution-wrap>
<institution>School of Power and Energy, Northwestern Polytechnical
University, Xi’an, 710129, China</institution>
</institution-wrap>
</aff>
<aff id="aff-7">
<institution-wrap>
<institution>Paris Elite Institute of Technology, Shanghai Jiao Tong
University, Shanghai, 200240, China</institution>
</institution-wrap>
</aff>
<aff id="aff-8">
<institution-wrap>
<institution>Department of Electrical Engineering and Computer Science,
University of Michigan, Ann Arbor, 48104, USA</institution>
</institution-wrap>
</aff>
<aff id="aff-9">
<institution-wrap>
<institution>School of Physical Science and Technology, ShanghaiTech
University, Shanghai, 201210, China</institution>
</institution-wrap>
</aff>
<aff id="aff-10">
<institution-wrap>
<institution>Advanced Propulsion Laboratory, Department of Modern
Mechanics, University of Science and Technology of China, Hefei, 230026,
China</institution>
</institution-wrap>
</aff>
<aff id="aff-11">
<institution-wrap>
<institution>School of Aeronautics, Northwestern Polytechnical
University, Xi’an, 710072, China</institution>
</institution-wrap>
</aff>
<aff id="aff-12">
<institution-wrap>
<institution>Department of Computer Science, University of Texas at
Austin, Austin, 78712, USA</institution>
</institution-wrap>
</aff>
</contrib-group>
<author-notes>
<corresp id="cor-1">* E-mail: <email></email></corresp>
</author-notes>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2025-01-17">
<day>17</day>
<month>1</month>
<year>2025</year>
</pub-date>
<volume>10</volume>
<issue>115</issue>
<fpage>8080</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>C++</kwd>
<kwd>Computational Fluid Dynamics</kwd>
<kwd>Adaptive Mesh Refinement</kwd>
<kwd>Immersed Boundary Method</kwd>
<kwd>Multiphase Flow</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>IAMReX is an adaptive C++ solver designed for multiphase flow and
  fluid-particle interaction problems. It is built in an object-oriented
  style and capable of high-performance massively parallel computing for
  complex systems (e.g., gas-fluid interaction, clusters of
  particles).</p>
  <p>The original goal of IAMReX is to extend the capabilities of IAMR
  codes
  (<xref alt="Almgren et al., 1998" rid="ref-almgren1998conservative" ref-type="bibr">Almgren
  et al., 1998</xref>), which only use a density-based solver to capture
  the diffuse interface of the two-phase flow. IAMReX offers a level set
  (LS) method and reinitialization techniques for accurately capturing
  the two-phase interface
  (<xref alt="Zeng et al., 2022" rid="ref-zeng2022parallel" ref-type="bibr">Zeng
  et al., 2022</xref>), which increase the robustness of simulations
  with high Reynolds numbers
  (<xref alt="Zeng et al., 2023" rid="ref-zeng2023consistent" ref-type="bibr">Zeng
  et al., 2023</xref>). In IAMR codes, particles are only treated as
  passive scalars. In IAMReX, however, both passive scalars and fully
  resolved particle cases are supported. To simulate the resolved
  particles, IAMReX employs the multidirect forcing immersed boundary
  method
  (<xref alt="Li et al., 2024" rid="ref-li2024open" ref-type="bibr">Li
  et al., 2024</xref>). The associated Lagrangian markers used to
  resolve fluid-particle interfaces only exist on the finest-level grid,
  which greatly reduces memory cost. Both the subcycling and
  non-subcycling time advancement methods are implemented, and these
  methods help to decouple the time advancement at different levels.
  Like its predecessor, the IAMR library, IAMReX is also a publicly
  accessible platform designed specifically for developing massively
  parallel block-structured adaptive mesh refinement (BSAMR)
  applications. With the help of the AMReX framework, both IAMR and
  IAMReX support hybrid parallelization using either pure MPI or MPI
  &amp; OpenMP for multicore machines
  (<xref alt="Zhang et al., 2019" rid="ref-zhang2019amrex" ref-type="bibr">Zhang
  et al., 2019</xref>), and we have ensured that new features introduced
  in IAMReX do not compromise this cross-platform support.</p>
  <p>The IAMReX code has undergone considerable development since 2023
  and gained a few new contributors in the past two years. Although the
  projection-based flow solver is inherited from IAMR, IAMReX has added
  over 3,000 lines of new code, introduced 10 new test cases, and
  contributed approximately 60 new commits on GitHub. The key
  differences between IAMR and IAMReX are summarized in this
  <ext-link ext-link-type="uri" xlink:href="https://ruohai0925.github.io/IAMReX/IAMRandIAMReX.html">webpage</ext-link>.
  The versatility, accuracy, and efficiency of the present IAMReX
  framework are demonstrated by simulating two-phase flow and
  fluid-particle interaction problems with various types of kinematic
  constraints. We carefully designed the document such that users can
  easily compile and run cases. Input files, profiling scripts, and raw
  post-processing data are also available for reproducing all
  results.</p>
</sec>
<sec id="scholarly-effort">
  <title>Scholarly effort</title>
  <p>IAMReX’s scholarly effort lies in its transformation from a
  standard incompressible flow solver into a unified, high-performance,
  multi-physics framework for complex interfacial and particulate flows.
  This is achieved through several key contributions. First, IAMReX
  introduces a modular architecture that supports distinct and advanced
  physics modules within a single platform. This includes a
  sharp-interface model for immiscible two-phase flows using an advanced
  level set method, complete with conservative advection and
  mass-preserving reinitialization schemes. Simultaneously, it offers a
  robust framework for particle-resolved fluid-structure interaction
  (FSI) by implementing a diffused immersed boundary method (DIBM).
  Second, a significant effort was dedicated to developing a
  comprehensive system for particle-resolved simulations. This system
  features a DIBM implementation for handling the motion of 6-DOF rigid
  bodies without requiring mesh conformity. It is further enhanced with
  a particle-particle collision model using spatial hashing for
  efficient detection and a repulsive potential model for resolution.
  Last but not least, IAMReX leverages the GPU acceleration capabilities
  to ensure efficiency for particle-resolved simulations. All major
  particle operations, including fluid-solid coupling, force spreading,
  and collision detection, are designed to be GPU-compatible. A key
  optimization for memory efficiency involves constraining the
  Lagrangian markers used for the fluid-particle interface to exist only
  on the finest grid level.</p>
</sec>
<sec id="relation-to-previous-work">
  <title>Relation to previous work</title>
  <p>IAMReX is built upon the foundations established in three of our
  previous publications. The implementation of the level set method is
  adapted from Zeng et al.
  (<xref alt="2022" rid="ref-zeng2022parallel" ref-type="bibr">2022</xref>),
  with a key distinction: IAMReX employs a semi-staggered grid rather
  than a collocated grid, which strengthens the pressure-velocity
  coupling during the solution process. Furthermore, the Diffused
  Immersed Boundary Method is derived from Li et al.
  (<xref alt="2024" rid="ref-li2024open" ref-type="bibr">2024</xref>);
  while the original work was limited to CPU-based parallelism and a
  basic particle collision model, IAMReX has been tested on GPUs for
  select cases and is designed to accommodate more advanced collision
  models. Finally, our approach to optimizing computational efficiency
  through the adaptive mesh refinement (AMR) technique, particularly the
  selection of simulation parameters, was informed by the guidance
  provided by Liu et al.
  (<xref alt="2025" rid="ref-liu2025investigate" ref-type="bibr">2025</xref>).</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>IAMReX is suitable for modeling multiphase flow problems and
  fluid-structure interaction problems. Its level set-based interface
  capturing technique can be beneficial for researchers studying
  phenomena such as wind over waves, breaking waves, and simulating the
  formation and disappearance of bubbles and droplets. Additionally, the
  immersed boundary method along with the collision models can
  parallelly resolve large-scale particles and capture their motions.
  Researchers working on studies of biological particle aggregation,
  sandstorms, wind erosion of ground surfaces, and seawater erosion of
  riverbeds are also among the target audience for this software.</p>
</sec>
<sec id="state-of-the-field">
  <title>State of the field</title>
  <p>We made great efforts to simulate more complex multiphase flows at
  higher resolution using IAMReX. One effort is to combine the AMR
  technique with the multidirect forcing immersed boundary method to
  resolve particles only on the finest-level grid. It significantly
  reduces the grid requirements for particle-resolved simulations
  compared with commonly used uniform grid solvers like
  <ext-link ext-link-type="uri" xlink:href="https://github.com/xcompact3d/Incompact3d">Incompact3d</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="https://github.com/CaNS-World/CaNS">CaNS</ext-link>,
  and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/GongZheng-Justin/CP3d">CP3d</ext-link>.
  Additionally, we utilized a subcycling technique to alleviate the time
  step constraint on coarser levels. It minimizes the total number of
  time steps needed for time advancement compared with the
  non-subcycling technique used in other AMR-related packages, such as
  <ext-link ext-link-type="uri" xlink:href="https://github.com/IBAMR/IBAMR.git">IBAMR</ext-link>,
  <ext-link ext-link-type="uri" xlink:href="http://basilisk.fr/">Basilisk</ext-link>,
  and
  <ext-link ext-link-type="uri" xlink:href="https://github.com/AMReX-Fluids/incflo.git">incflo</ext-link>.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>C.L., X.L., Y.Z., and Z.Z. are grateful to Ann Almgren, John Bell,
  Andy Nonaka, Candace Gilet, Andrew Myers, Axel Huebl, Marc Day, and
  Weiqun Zhang in the Lawrence Berkeley National Laboratory (LBNL) for
  their discussions related to AMReX and IAMR. We sincerely thank all
  the developers who have contributed to the original IAMR repository,
  although this paper focuses on the newly added features and does not
  include the names of all contributors. Y.Z. and Z.Z. also thank
  Prof. Lian Shen, Prof. Ruifeng Hu, and Prof. Xiaojing Zheng during
  their Ph.D. studies.</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-almgren1998conservative">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Almgren</surname><given-names>Ann S</given-names></name>
        <name><surname>Bell</surname><given-names>John B</given-names></name>
        <name><surname>Colella</surname><given-names>Phillip</given-names></name>
        <name><surname>Howell</surname><given-names>Louis H</given-names></name>
        <name><surname>Welcome</surname><given-names>Michael L</given-names></name>
      </person-group>
      <article-title>A conservative adaptive projection method for the variable density incompressible Navier–Stokes equations</article-title>
      <source>Journal of Computational Physics</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="1998">1998</year>
      <volume>142</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1006/jcph.1998.5890</pub-id>
      <fpage>1</fpage>
      <lpage>46</lpage>
    </element-citation>
  </ref>
  <ref id="ref-zeng2022parallel">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zeng</surname><given-names>Yadong</given-names></name>
        <name><surname>Xuan</surname><given-names>Anqing</given-names></name>
        <name><surname>Blaschke</surname><given-names>Johannes</given-names></name>
        <name><surname>Shen</surname><given-names>Lian</given-names></name>
      </person-group>
      <article-title>A parallel cell-centered adaptive level set framework for efficient simulation of two-phase flows with subcycling and non-subcycling</article-title>
      <source>Journal of Computational Physics</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2022">2022</year>
      <volume>448</volume>
      <pub-id pub-id-type="doi">10.1016/j.jcp.2021.110740</pub-id>
      <fpage>110740</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-zeng2023consistent">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zeng</surname><given-names>Yadong</given-names></name>
        <name><surname>Liu</surname><given-names>Han</given-names></name>
        <name><surname>Gao</surname><given-names>Qiang</given-names></name>
        <name><surname>Almgren</surname><given-names>Ann</given-names></name>
        <name><surname>Bhalla</surname><given-names>Amneet Pal Singh</given-names></name>
        <name><surname>Shen</surname><given-names>Lian</given-names></name>
      </person-group>
      <article-title>A consistent adaptive level set framework for incompressible two-phase flows with high density ratios and high Reynolds numbers</article-title>
      <source>Journal of Computational Physics</source>
      <publisher-name>Elsevier</publisher-name>
      <year iso-8601-date="2023">2023</year>
      <volume>478</volume>
      <pub-id pub-id-type="doi">10.1016/j.jcp.2023.111971</pub-id>
      <fpage>111971</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-li2024open">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Li</surname><given-names>Xuzhu</given-names></name>
        <name><surname>Li</surname><given-names>Chun</given-names></name>
        <name><surname>Li</surname><given-names>Xiaokai</given-names></name>
        <name><surname>Li</surname><given-names>Wenzhuo</given-names></name>
        <name><surname>Tang</surname><given-names>Mingze</given-names></name>
        <name><surname>Zeng</surname><given-names>Yadong</given-names></name>
        <name><surname>Zhu</surname><given-names>Zhengping</given-names></name>
      </person-group>
      <article-title>An open-source, adaptive solver for particle-resolved simulations with both subcycling and non-subcycling methods</article-title>
      <source>Physics of Fluids</source>
      <publisher-name>AIP Publishing</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>36</volume>
      <issue>11</issue>
      <pub-id pub-id-type="doi">10.1063/5.0236509</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-zhang2019amrex">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Zhang</surname><given-names>Weiqun</given-names></name>
        <name><surname>Almgren</surname><given-names>Ann</given-names></name>
        <name><surname>Beckner</surname><given-names>Vince</given-names></name>
        <name><surname>Bell</surname><given-names>John</given-names></name>
        <name><surname>Blaschke</surname><given-names>Johannes</given-names></name>
        <name><surname>Chan</surname><given-names>Cy</given-names></name>
        <name><surname>Day</surname><given-names>Marcus</given-names></name>
        <name><surname>Friesen</surname><given-names>Brian</given-names></name>
        <name><surname>Gott</surname><given-names>Kevin</given-names></name>
        <name><surname>Graves</surname><given-names>Daniel</given-names></name>
        <name><surname>others</surname></name>
      </person-group>
      <article-title>AMReX: a framework for block-structured adaptive mesh refinement</article-title>
      <source>Journal of Open Source Software</source>
      <publisher-name>The Open Journal</publisher-name>
      <year iso-8601-date="2019">2019</year>
      <volume>4</volume>
      <issue>37</issue>
      <pub-id pub-id-type="doi">10.21105/joss.01370</pub-id>
    </element-citation>
  </ref>
  <ref id="ref-liu2025investigate">
    <element-citation publication-type="chapter">
      <person-group person-group-type="author">
        <name><surname>Liu</surname><given-names>Dewen</given-names></name>
        <name><surname>He</surname><given-names>Shuai</given-names></name>
        <name><surname>Cheng</surname><given-names>Haoran</given-names></name>
        <name><surname>Zeng</surname><given-names>Yadong</given-names></name>
      </person-group>
      <article-title>Investigate the efficiency of incompressible flow simulations on CPUs and GPUs with BSAMR</article-title>
      <source>AIAA SCITECH 2025 forum</source>
      <publisher-name>American Institute of Aeronautics and Astronautics</publisher-name>
      <year iso-8601-date="2025">2025</year>
      <pub-id pub-id-type="doi">10.2514/6.2025-1865</pub-id>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
