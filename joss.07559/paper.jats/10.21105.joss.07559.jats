<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN"
                  "JATS-publishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="1.2" article-type="other">
<front>
<journal-meta>
<journal-id></journal-id>
<journal-title-group>
<journal-title>Journal of Open Source Software</journal-title>
<abbrev-journal-title>JOSS</abbrev-journal-title>
</journal-title-group>
<issn publication-format="electronic">2475-9066</issn>
<publisher>
<publisher-name>Open Journals</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">7559</article-id>
<article-id pub-id-type="doi">10.21105/joss.07559</article-id>
<title-group>
<article-title>cdsaxs: A model fitting package for CD-SAXS data
analysis</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0009-0007-8982-424X</contrib-id>
<name>
<surname>Dhungana</surname>
<given-names>Nischal</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8406-798X</contrib-id>
<name>
<surname>Freychet</surname>
<given-names>Guillaume</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-9134-384X</contrib-id>
<name>
<surname>Bryan</surname>
<given-names>Matthew</given-names>
</name>
<xref ref-type="aff" rid="aff-1"/>
</contrib>
<aff id="aff-1">
<institution-wrap>
<institution>CEA, Leti, F-38000 Grenoble, France</institution>
</institution-wrap>
</aff>
</contrib-group>
<pub-date date-type="pub" publication-format="electronic" iso-8601-date="2024-08-28">
<day>28</day>
<month>8</month>
<year>2024</year>
</pub-date>
<volume>11</volume>
<issue>118</issue>
<fpage>7559</fpage>
<permissions>
<copyright-statement>Authors of papers retain copyright and release the
work under a Creative Commons Attribution 4.0 International License (CC
BY 4.0)</copyright-statement>
<copyright-year>2026</copyright-year>
<copyright-holder>The article authors</copyright-holder>
<license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
<license-p>Authors of papers retain copyright and release the work under
a Creative Commons Attribution 4.0 International License (CC BY
4.0)</license-p>
</license>
</permissions>
<kwd-group kwd-group-type="author">
<kwd>Python</kwd>
<kwd>CD-Saxs</kwd>
<kwd>X-ray scattering</kwd>
</kwd-group>
</article-meta>
</front>
<body>
<sec id="summary">
  <title>Summary</title>
  <p>Miniaturizing transistors, the fundamental components of integrated
  circuits, poses significant challenges for the semiconductor industry.
  Accurate measurements of these features during production are
  essential to ensure the creation of high-quality chips. However,
  conventional in-line metrology techniques are approaching their
  limits. To address these challenges, the industry is turning to
  advanced X-ray-based metrology
  (<xref alt="D. Sunday et al., 2015" rid="ref-sunday2015" ref-type="bibr">D.
  Sunday et al., 2015</xref>).</p>
  <p>CD-SAXS (Critical Dimension Small Angle X-ray Scattering) is an
  emerging and promising technique in this field. Studies conducted by
  (<xref alt="D. Sunday et al., 2015" rid="ref-sunday2015" ref-type="bibr">D.
  Sunday et al., 2015</xref>) have demonstrated the effectiveness of
  CD-SAXS in accurately characterizing the shape and spacing of
  nanometer-scale patterns. The <monospace>cdsaxs</monospace> package is
  designed to offer comprehensive simulation and fitting tools for
  CD-SAXS synchrotron data, supporting researchers in advancing this
  innovative technology.</p>
</sec>
<sec id="statement-of-need">
  <title>Statement of need</title>
  <p>CD-SAXS is a powerful and evolving technique for the
  characterization of nano-components in the semiconductor industry.
  Community efforts have explored different combinations of algorithms
  to model CD-SAXS data, as described by
  (<xref alt="Hannon et al., 2016" rid="ref-hannon2016advancing" ref-type="bibr">Hannon
  et al., 2016</xref>;
  <xref alt="D. F. Sunday et al., 2016" rid="ref-sunday2016mcmc" ref-type="bibr">D.
  F. Sunday et al., 2016</xref>). However, there is a lack of
  open-source software for comprehensive data analysis. Xi-cam
  (<xref alt="Pandolfi et al., 2018" rid="ref-Xi-cam" ref-type="bibr">Pandolfi
  et al., 2018</xref>) is the only publicly available Python package
  that includes CD-SAXS data analysis, although the code is no longer
  maintained. While there are a few other proprietary software packages,
  they are not freely accessible to the community. Thus, developing
  models and analysis tools for CD-SAXS often requires researchers to
  create their own solutions for simulation and fitting. Moreover, the
  diversity of samples analyzed using CD-SAXS requires versatile
  software that can accommodate different types of models and
  experimental conditions.</p>
  <p>The <monospace>cdsaxs</monospace> package is designed to address
  this critical gap by providing a modular, open-source solution
  tailored for CD-SAXS data analysis. It includes two robust models for
  simulating CD-SAXS data, while also allowing researchers to integrate
  their own models. This flexibility is crucial for testing and
  validating models against experimental data, making the development
  process more streamlined and accessible.</p>
  <p>A key feature of this package is its separation of the simulation
  and fitting processes, enabling users to concentrate on model
  development and data analysis without being encumbered by technical
  complexities. The package is optimized for performance, with support
  for vectorized fitting on both CPUs and GPUs, significantly enhancing
  the speed and efficiency of data processing. The fitting process in
  <monospace>cdsaxs</monospace> is powered by the CMA-ES (Covariance
  Matrix Adaptation Evolution Strategy) algorithm, known for its rapid
  convergence in X-ray fitting
  (<xref alt="Hannon et al., 2016" rid="ref-hannon2016advancing" ref-type="bibr">Hannon
  et al., 2016</xref>). This efficiency allows for real-time data
  fitting during experiments, empowering researchers to dynamically
  adjust experimental parameters based on immediate feedback from the
  analysis.</p>
  <p>Additionally, the package incorporates uncertainty estimation in
  the fitted parameters using the MCMC (Markov Chain Monte Carlo)
  algorithm, providing researchers with more reliable and nuanced
  results
  (<xref alt="D. F. Sunday et al., 2016" rid="ref-sunday2016mcmc" ref-type="bibr">D.
  F. Sunday et al., 2016</xref>).</p>
  <p>By aiming to fill the current void in CD-SAXS data analysis tools,
  <monospace>cdsaxs</monospace> seeks to accelerate research workflows
  and make advanced analytical techniques more accessible.</p>
</sec>
<sec id="description">
  <title>Description</title>
  <p>The <monospace>cdsaxs</monospace> package provides a comprehensive
  framework for analyzing CD-SAXS data, focusing on the systematic
  workflow of candidate generation, evaluation, and uncertainty
  estimation. It is also flexible enough to accommodate user-defined
  models, making it a versatile tool for researchers working with
  diverse nanostructures.</p>
  <list list-type="order">
    <list-item>
      <p><bold>Candidate Generation and Evaluation</bold>:</p>
      <list list-type="bullet">
        <list-item>
          <p>The core of the <monospace>cdsaxs</monospace> fitting
          process begins with generating a series of candidate
          parameters. Each set of parameters represents a possible
          nanostructure configuration, defined by a set of features
          (e.g., widths, heights, etc.).</p>
        </list-item>
        <list-item>
          <p>These candidate models are then transformed into reciprocal
          space through a Fourier Transform, allowing direct comparison
          with the experimental CD-SAXS data.</p>
        </list-item>
        <list-item>
          <p>The package utilizes an optimization algorithm,
          specifically the Covariance Matrix Adaptation Evolution
          Strategy (CMA-ES), to iteratively refine the model parameters.
          This algorithm excels in high-dimensional optimization,
          rapidly converging on a solution that minimizes the error
          between the simulated and experimental scattering
          intensities.</p>
        </list-item>
      </list>
    </list-item>
    <list-item>
      <p><bold>Simulation and Comparison</bold>:</p>
      <list list-type="bullet">
        <list-item>
          <p>The simulation process can also function independently,
          generating CD-SAXS data based on user-defined parameters
          without the need for experimental data. This is particularly
          useful for testing and validating models in a controlled
          setting.</p>
        </list-item>
        <list-item>
          <p>In addition to the two built-in models, users can define
          their own models, allowing for a wide range of nanostructure
          configurations to be tested.</p>
        </list-item>
        <list-item>
          <p>When experimental data is available, the package simulates
          scattering profiles for each candidate model and calculates a
          goodness-of-fit metric by comparing the simulated data with
          the experimental measurements. The optimization algorithm
          adjusts the model parameters to minimize this metric, ensuring
          the best possible match.</p>
        </list-item>
      </list>
    </list-item>
    <list-item>
      <p><bold>Uncertainty Estimation</bold>:</p>
      <list list-type="bullet">
        <list-item>
          <p>After determining the best-fit model,
          <monospace>cdsaxs</monospace> employs a Markov Chain Monte
          Carlo (MCMC) algorithm to estimate the uncertainties
          associated with the model parameters. This step is crucial for
          understanding the robustness of the fit and identifying
          potential alternative structures that could produce similar
          scattering data.</p>
        </list-item>
        <list-item>
          <p>The MCMC method generates a distribution of possible
          parameter sets, from which the package calculates confidence
          intervals, providing a quantitative measure of uncertainty for
          each parameter.</p>
        </list-item>
      </list>
    </list-item>
  </list>
  <p>The following diagram illustrates the overall workflow of the
  CMA-ES algorithm in the <monospace>cdsaxs</monospace> package:</p>
  <fig>
    <caption><p>Workflow of the CMA-ES algorithm in the cdsaxs
    package.<styled-content id="figU003Aworkflow_cmaes"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="cmaes_overall.png" />
  </fig>
  <p>The overall workflow of the MCMC algorithm:</p>
  <fig>
    <caption><p>Workflow of the MCMC algorithm in the cdsaxs
    package.<styled-content id="figU003Aworkflow_mcmc"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="mcmc_overall.png" />
  </fig>
  <p>This workflow ensures that the <monospace>cdsaxs</monospace>
  package not only identifies the optimal model configuration but also
  quantifies confidence in the results, making it a powerful tool for
  CD-SAXS data analysis in both research and industrial
  applications.</p>
</sec>
<sec id="comparison">
  <title>Comparison</title>
  <p>Xi-cam
  (<xref alt="Pandolfi et al., 2018" rid="ref-Xi-cam" ref-type="bibr">Pandolfi
  et al., 2018</xref>) is the open-source software used for CD-SAXS
  simulations described by Choisnet et al.
  (<xref alt="Choisnet et al., 2024" rid="ref-timothee" ref-type="bibr">Choisnet
  et al., 2024</xref>). Notably, they use a six-stacked trapezoid model
  and a rounded trapezoid model for the simulations. The experimental
  dataset used by Choisnet et al. in their study was also used here to
  test our model. We fitted the dataset with a six-stacked trapezoid
  model, enabling a direct comparison between Xi-cam and this package.
  The results are shown in the figure below:</p>
  <fig>
    <caption><p>Comparison of fits obtained by Xi-cam and the cdsaxs
    package in Fourier space. Experimental results are also
    plotted.<styled-content id="figU003Acompare_profile"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="compare_xicam.png" />
  </fig>
  <fig>
    <caption><p>Comparison of fits obtained by Xi-cam and the cdsaxs
    package in real
    space.<styled-content id="figU003Acompare_profile_real"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="compare_xicam_profile.png" />
  </fig>
  <p>Under the same initial conditions and search criteria, we
  demonstrate that the fits are remarkably similar, validating the
  accuracy of our modeling approach.</p>
  <p>Using the same dataset, execution time was also measured. The
  number of generations was kept constant at 100, and different
  population sizes were tested. The tests were performed on an Ubuntu
  server with 64 logical processors (Intel® Xeon® Platinum 8362 CPU @
  2.80 GHz) and an NVIDIA A100 80GB PCIe GPU.</p>
  <fig>
    <caption><p>Execution time for the two versions of the code (CPU and
    GPU performance
    comparison).<styled-content id="figU003Acompare_time"></styled-content></p></caption>
    <graphic mimetype="image" mime-subtype="png" xlink:href="compare_time.png" />
  </fig>
  <p>We observe that the <monospace>cdsaxs</monospace> package shows
  significant improvements in execution time (more than 10× for CPU
  execution and 100× for GPU execution) compared to the previous
  code.</p>
</sec>
<sec id="conclusion">
  <title>Conclusion</title>
  <p>In this work, we presented the <monospace>cdsaxs</monospace>
  package, a comprehensive and modular open-source framework for CD-SAXS
  data analysis. By integrating CMA-ES for fast optimization and MCMC
  for robust uncertainty estimation, the package offers both speed and
  reliability for fitting synchrotron data. Benchmark comparisons
  demonstrate significant improvements over previous tools, both in
  accuracy and execution time. We believe <monospace>cdsaxs</monospace>
  will accelerate research workflows in the semiconductor industry and
  provide a foundation for future developments in X-ray-based
  metrology.</p>
</sec>
<sec id="acknowledgements">
  <title>Acknowledgements</title>
  <p>This work, carried out on the Platform for Nanocharacterisation
  (PFNC), was supported by the “Recherche Technologique de Base” and
  “France 2030 - ANR-22-PEEL-0014” programs of the French National
  Research Agency (ANR).</p>
</sec>
</body>
<back>
<ref-list>
  <title></title>
  <ref id="ref-sunday2015">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sunday</surname><given-names>Daniel</given-names></name>
        <name><surname>List</surname><given-names>Scott</given-names></name>
        <name><surname>Chawla</surname><given-names>Jasmeet</given-names></name>
        <name><surname>Kline</surname><given-names>R.</given-names></name>
      </person-group>
      <article-title>Determining the shape and periodicity of nanostructures using small-angle x-ray scattering</article-title>
      <source>Journal of Applied Crystallography</source>
      <year iso-8601-date="2015-10">2015</year><month>10</month>
      <volume>48</volume>
      <pub-id pub-id-type="doi">10.1107/S1600576715013369</pub-id>
      <fpage></fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-sunday2016mcmc">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Sunday</surname><given-names>Daniel F</given-names></name>
        <name><surname>List</surname><given-names>Scott</given-names></name>
        <name><surname>Chawla</surname><given-names>Jasmeet S</given-names></name>
        <name><surname>Kline</surname><given-names>R Joseph</given-names></name>
      </person-group>
      <article-title>Evaluation of the effect of data quality on the profile uncertainty of critical dimension small angle x-ray scattering</article-title>
      <source>Journal of Micro/Nanolithography, MEMS, and MOEMS</source>
      <year iso-8601-date="2016">2016</year>
      <volume>15</volume>
      <issue>1</issue>
      <pub-id pub-id-type="doi">10.1117/1.JMM.15.1.014001</pub-id>
      <fpage>014001</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-hannon2016advancing">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Hannon</surname><given-names>Adam F</given-names></name>
        <name><surname>Sunday</surname><given-names>Daniel F</given-names></name>
        <name><surname>Windover</surname><given-names>Donald</given-names></name>
        <name><surname>Kline</surname><given-names>R Joseph</given-names></name>
      </person-group>
      <article-title>Advancing x-ray scattering metrology using inverse genetic algorithms</article-title>
      <source>Journal of micro/nanolithography, MEMS, and MOEMS : JM3</source>
      <year iso-8601-date="2016">2016</year>
      <volume>15</volume>
      <issue>3</issue>
      <pub-id pub-id-type="doi">10.1117/1.JMM.15.3.034001</pub-id>
      <fpage>034001</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-timothee">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Choisnet</surname><given-names>Timothée</given-names></name>
        <name><surname>Hammouti</surname><given-names>Abdelali</given-names></name>
        <name><surname>Gagneur</surname><given-names>Vincent</given-names></name>
        <name><surname>Reche</surname><given-names>Jérôme</given-names></name>
        <name><surname>Rademaker</surname><given-names>Guido</given-names></name>
        <name><surname>Freychet</surname><given-names>Guillaume</given-names></name>
        <name><surname>Jullien</surname><given-names>Guillaume</given-names></name>
        <name><surname>Ducoté</surname><given-names>Julien</given-names></name>
        <name><surname>Gergaud</surname><given-names>Patrice</given-names></name>
        <name><surname>Cunff</surname><given-names>Delphine Le</given-names></name>
      </person-group>
      <article-title>Cross-evaluation of critical dimension measurement techniques</article-title>
      <source>Journal of Micro/Nanopatterning, Materials, and Metrology</source>
      <publisher-name>SPIE</publisher-name>
      <year iso-8601-date="2024">2024</year>
      <volume>23</volume>
      <issue>1</issue>
      <uri>https://doi.org/10.1117/1.JMM.23.1.014002</uri>
      <pub-id pub-id-type="doi">10.1117/1.JMM.23.1.014002</pub-id>
      <fpage>014002</fpage>
      <lpage></lpage>
    </element-citation>
  </ref>
  <ref id="ref-Xi-cam">
    <element-citation publication-type="article-journal">
      <person-group person-group-type="author">
        <name><surname>Pandolfi</surname><given-names>Ronald J.</given-names></name>
        <name><surname>Allan</surname><given-names>Daniel B.</given-names></name>
        <name><surname>Arenholz</surname><given-names>Elke</given-names></name>
        <name><surname>Barroso-Luque</surname><given-names>Luis</given-names></name>
        <name><surname>Campbell</surname><given-names>Stuart I.</given-names></name>
        <name><surname>Caswell</surname><given-names>Thomas A.</given-names></name>
        <name><surname>Blair</surname><given-names>Austin</given-names></name>
        <name><surname>De Carlo</surname><given-names>Francesco</given-names></name>
        <name><surname>Fackler</surname><given-names>Sean</given-names></name>
        <name><surname>Fournier</surname><given-names>Amanda P.</given-names></name>
        <name><surname>Freychet</surname><given-names>Guillaume</given-names></name>
        <name><surname>Fukuto</surname><given-names>Masafumi</given-names></name>
        <name><surname>Gürsoy</surname><given-names>Doǧa</given-names></name>
        <name><surname>Jiang</surname><given-names>Zhang</given-names></name>
        <name><surname>Krishnan</surname><given-names>Harinarayan</given-names></name>
        <name><surname>Kumar</surname><given-names>Dinesh</given-names></name>
        <name><surname>Kline</surname><given-names>R. Joseph</given-names></name>
        <name><surname>Li</surname><given-names>Ruipeng</given-names></name>
        <name><surname>Liman</surname><given-names>Christopher</given-names></name>
        <name><surname>Marchesini</surname><given-names>Stefano</given-names></name>
        <name><surname>Mehta</surname><given-names>Apurva</given-names></name>
        <name><surname>N’Diaye</surname><given-names>Alpha T.</given-names></name>
        <name><surname>Parkinson</surname><given-names>Dilworth Y.</given-names></name>
        <name><surname>Parks</surname><given-names>Holden</given-names></name>
        <name><surname>Pellouchoud</surname><given-names>Lenson A.</given-names></name>
        <name><surname>Perciano</surname><given-names>Talita</given-names></name>
        <name><surname>Ren</surname><given-names>Fang</given-names></name>
        <name><surname>Sahoo</surname><given-names>Shreya</given-names></name>
        <name><surname>Strzalka</surname><given-names>Joseph</given-names></name>
        <name><surname>Sunday</surname><given-names>Daniel</given-names></name>
        <name><surname>Tassone</surname><given-names>Christopher J.</given-names></name>
        <name><surname>Ushizima</surname><given-names>Daniela</given-names></name>
        <name><surname>Venkatakrishnan</surname><given-names>Singanallur</given-names></name>
        <name><surname>Yager</surname><given-names>Kevin G.</given-names></name>
        <name><surname>Zwart</surname><given-names>Peter</given-names></name>
        <name><surname>Sethian</surname><given-names>James A.</given-names></name>
        <name><surname>Hexemer</surname><given-names>Alexander</given-names></name>
      </person-group>
      <article-title>Xi-cam: a versatile interface for data visualization and analysis</article-title>
      <source>Journal of Synchrotron Radiation</source>
      <year iso-8601-date="2018-07">2018</year><month>07</month>
      <volume>25</volume>
      <issue>4</issue>
      <uri>https://doi.org/10.1107/S1600577518005787</uri>
      <pub-id pub-id-type="doi">10.1107/S1600577518005787</pub-id>
      <fpage>1261</fpage>
      <lpage>1270</lpage>
    </element-citation>
  </ref>
</ref-list>
</back>
</article>
